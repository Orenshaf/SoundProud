webpackJsonp([0],[,function(e,t,n){var r=n(5),i=n(30),a=n(20),o=n(21),s=n(27),c=function(e,t,n){var l,u,d,p,f=e&c.F,g=e&c.G,m=e&c.S,h=e&c.P,b=e&c.B,v=g?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,E=g?i:i[t]||(i[t]={}),S=E.prototype||(E.prototype={});g&&(n=t);for(l in n)u=!f&&v&&void 0!==v[l],d=(u?v:n)[l],p=b&&u?s(d,r):h&&"function"==typeof d?s(Function.call,d):d,v&&o(v,l,d,e&c.U),E[l]!=d&&a(E,l,p),h&&S[l]!=d&&(S[l]=d)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},,function(e,t,n){"use strict";(function(e){function r(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return o(this,e,t,n)}function o(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,n,r):"string"==typeof t?u(e,t,n):f(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return s(t),t<=0?i(e,t):void 0!==n?"string"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}function l(e,t){if(s(t),e=i(e,t<0?0:0|g(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n);e=i(e,r);var o=e.write(t,n);return o!==r&&(e=e.slice(0,o)),e}function d(e,t){var n=t.length<0?0:0|g(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=d(e,t),e}function f(e,t){if(a.isBuffer(t)){var n=0|g(t.length);return e=i(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||q(t.length)?i(e,0):d(e,t);if("Buffer"===t.type&&Z(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),a.alloc(+e)}function h(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return Y(e).length;t=(""+t).toLowerCase(),r=!0}}function b(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function E(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:S(e,t,n,r,i);if("number"==typeof t)return t&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,r,i){function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}var l;if(i){var u=-1;for(l=n;l<s;l++)if(a(e,l)===a(t,-1===u?0:l-u)){if(-1===u&&(u=l),l-u+1===c)return u*o}else-1!==u&&(l-=l-u),u=-1}else for(n+c>s&&(n=s-c),l=n;l>=0;l--){for(var d=!0,p=0;p<c;p++)if(a(e,l+p)!==a(t,p)){d=!1;break}if(d)return l}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function A(e,t,n,r){return H(Y(t,e.length-n),e,n,r)}function C(e,t,n,r){return H(W(t),e,n,r)}function _(e,t,n,r){return C(e,t,n,r)}function w(e,t,n,r){return H($(t),e,n,r)}function T(e,t,n,r){return H(z(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=n){var c,l,u,d;switch(s){case 1:a<128&&(o=a);break;case 2:128==(192&(c=e[i+1]))&&(d=(31&a)<<6|63&c)>127&&(o=d);break;case 3:c=e[i+1],l=e[i+2],128==(192&c)&&128==(192&l)&&(d=(15&a)<<12|(63&c)<<6|63&l)>2047&&(d<55296||d>57343)&&(o=d);break;case 4:c=e[i+1],l=e[i+2],u=e[i+3],128==(192&c)&&128==(192&l)&&128==(192&u)&&(d=(15&a)<<18|(63&c)<<12|(63&l)<<6|63&u)>65535&&d<1114112&&(o=d)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return k(r)}function k(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Q));return n}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=G(e[a]);return i}function M(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function L(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function B(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,i){return i||B(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,i){return i||B(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,n,r,52,8),n+8}function K(e){if(e=V(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function V(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var n,r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function W(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function z(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}function $(e){return J.toByteArray(K(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function q(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var J=n(579),X=n(580),Z=n(581);t.Buffer=a,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return o(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return c(null,e,t,n)},a.allocUnsafe=function(e){return l(null,e)},a.allocUnsafeSlow=function(e){return l(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=h,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):b.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,i){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,c=Math.min(o,s),l=this.slice(r,i),u=e.slice(t,n),d=0;d<c;++d)if(l[d]!==u[d]){o=l[d],s=u[d];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return A(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=a.prototype;else{var i=t-e;r=new a(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},a.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},a.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),X.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),X.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),X.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),X.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=a.isBuffer(e)?e:Y(new a(e,r).toString()),c=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%c]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(36))},function(e,t,n){var r=n(8);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},,function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r=n(78)("wks"),i=n(43),a=n(5).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t,n){e.exports=!n(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(4),i=n(155),a=n(31),o=Object.defineProperty;t.f=n(11)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(33),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function a(e,t,n){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}function o(e,t,n){for(var r=0,i=Math.min(e.length,n),a=t;a<i;a++){var o=e.charCodeAt(a)-48;r<<=4,r|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return r}function s(e,t,n,r){for(var i=0,a=Math.min(e.length,n),o=t;o<a;o++){var s=e.charCodeAt(o)-48;i*=r,i+=s>=49?s-49+10:s>=17?s-17+10:s}return i}function c(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=(e.words[r]&1<<i)>>>i}return t}function l(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],a=0|t.words[0],o=i*a,s=67108863&o,c=o/67108864|0;n.words[0]=s;for(var l=1;l<r;l++){for(var u=c>>>26,d=67108863&c,p=Math.min(l,t.length-1),f=Math.max(0,l-e.length+1);f<=p;f++){var g=l-f|0;i=0|e.words[g],a=0|t.words[f],o=i*a+d,u+=o/67108864|0,d=67108863&o}n.words[l]=0|d,c=0|u}return 0!==c?n.words[l]=0|c:n.length--,n.strip()}function u(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,a=0;a<n.length-1;a++){var o=i;i=0;for(var s=67108863&r,c=Math.min(a,t.length-1),l=Math.max(0,a-e.length+1);l<=c;l++){var u=a-l,d=0|e.words[u],p=0|t.words[l],f=d*p,g=67108863&f;o=o+(f/67108864|0)|0,g=g+s|0,s=67108863&g,o=o+(g>>>26)|0,i+=o>>>26,o&=67108863}n.words[a]=s,r=o,o=i}return 0!==r?n.words[a]=r:n.length--,n.strip()}function d(e,t,n){return(new p).mulp(e,t,n)}function p(e,t){this.x=e,this.y=t}function f(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function g(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function m(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function h(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function b(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function v(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function E(e){v.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var S;try{S=n(611).Buffer}catch(e){}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36),e=e.toString().replace(/\s+/g,"");var i=0;"-"===e[0]&&i++,16===t?this._parseHex(e,i):this._parseBase(e,t,i),"-"===e[0]&&(this.negative=1),this.strip(),"le"===n&&this._initArray(this.toArray(),t,n)},a.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},a.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var a,o,s=0;if("be"===n)for(i=e.length-1,a=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[a]|=o<<s&67108863,this.words[a+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,a++);else if("le"===n)for(i=0,a=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[a]|=o<<s&67108863,this.words[a+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,i,a=0;for(n=e.length-6,r=0;n>=t;n-=6)i=o(e,n,n+6),this.words[r]|=i<<a&67108863,this.words[r+1]|=i>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);n+6!==t&&(i=o(e,t,n+6),this.words[r]|=i<<a&67108863,this.words[r+1]|=i>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var a=e.length-n,o=a%r,c=Math.min(a,a-o)+n,l=0,u=n;u<c;u+=r)l=s(e,u,u+r,t),this.imuln(i),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==o){var d=1;for(l=s(e,u,e.length,t),u=0;u<o;u++)d*=t;this.imuln(d),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],A=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],C=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(e,t){e=e||10,t=0|t||1;var n;if(16===e||"hex"===e){n="";for(var i=0,a=0,o=0;o<this.length;o++){var s=this.words[o],c=(16777215&(s<<i|a)).toString(16);a=s>>>24-i&16777215,n=0!==a||o!==this.length-1?y[6-c.length]+c+n:c+n,(i+=2)>=26&&(i-=26,o--)}for(0!==a&&(n=a.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var l=A[e],u=C[e];n="";var d=this.clone();for(d.negative=0;!d.isZero();){var p=d.modn(u).toString(e);d=d.idivn(u),n=d.isZero()?p+n:y[l-p.length]+p+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==S),this.toArrayLike(S,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,n){var i=this.byteLength(),a=n||Math.max(1,i);r(i<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var o,s,c="le"===t,l=new e(a),u=this.clone();if(c){for(s=0;!u.isZero();s++)o=u.andln(255),u.iushrn(8),l[s]=o;for(;s<a;s++)l[s]=0}else{for(s=0;s<a-i;s++)l[s]=0;for(s=0;!u.isZero();s++)o=u.andln(255),u.iushrn(8),l[a-s-1]=o}return l},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<i:this.words[n]&~(1<<i),this.strip()},a.prototype.iadd=function(e){var t;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();var n,r;this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,a=0;a<r.length;a++)t=(0|n.words[a])+(0|r.words[a])+i,this.words[a]=67108863&t,i=t>>>26;for(;0!==i&&a<n.length;a++)t=(0|n.words[a])+i,this.words[a]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;var r,i;n>0?(r=this,i=e):(r=e,i=this);for(var a=0,o=0;o<i.length;o++)t=(0|r.words[o])-(0|i.words[o])+a,a=t>>26,this.words[o]=67108863&t;for(;0!==a&&o<r.length;o++)t=(0|r.words[o])+a,a=t>>26,this.words[o]=67108863&t;if(0===a&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var _=function(e,t,n){var r,i,a,o=e.words,s=t.words,c=n.words,l=0,u=0|o[0],d=8191&u,p=u>>>13,f=0|o[1],g=8191&f,m=f>>>13,h=0|o[2],b=8191&h,v=h>>>13,E=0|o[3],S=8191&E,y=E>>>13,A=0|o[4],C=8191&A,_=A>>>13,w=0|o[5],T=8191&w,R=w>>>13,O=0|o[6],k=8191&O,I=O>>>13,P=0|o[7],N=8191&P,M=P>>>13,L=0|o[8],x=8191&L,D=L>>>13,j=0|o[9],B=8191&j,F=j>>>13,U=0|s[0],K=8191&U,V=U>>>13,G=0|s[1],Y=8191&G,W=G>>>13,z=0|s[2],$=8191&z,H=z>>>13,q=0|s[3],J=8191&q,X=q>>>13,Z=0|s[4],Q=8191&Z,ee=Z>>>13,te=0|s[5],ne=8191&te,re=te>>>13,ie=0|s[6],ae=8191&ie,oe=ie>>>13,se=0|s[7],ce=8191&se,le=se>>>13,ue=0|s[8],de=8191&ue,pe=ue>>>13,fe=0|s[9],ge=8191&fe,me=fe>>>13;n.negative=e.negative^t.negative,n.length=19,r=Math.imul(d,K),i=Math.imul(d,V),i=i+Math.imul(p,K)|0,a=Math.imul(p,V);var he=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(he>>>26)|0,he&=67108863,r=Math.imul(g,K),i=Math.imul(g,V),i=i+Math.imul(m,K)|0,a=Math.imul(m,V),r=r+Math.imul(d,Y)|0,i=i+Math.imul(d,W)|0,i=i+Math.imul(p,Y)|0,a=a+Math.imul(p,W)|0;var be=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(b,K),i=Math.imul(b,V),i=i+Math.imul(v,K)|0,a=Math.imul(v,V),r=r+Math.imul(g,Y)|0,i=i+Math.imul(g,W)|0,i=i+Math.imul(m,Y)|0,a=a+Math.imul(m,W)|0,r=r+Math.imul(d,$)|0,i=i+Math.imul(d,H)|0,i=i+Math.imul(p,$)|0,a=a+Math.imul(p,H)|0;var ve=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(S,K),i=Math.imul(S,V),i=i+Math.imul(y,K)|0,a=Math.imul(y,V),r=r+Math.imul(b,Y)|0,i=i+Math.imul(b,W)|0,i=i+Math.imul(v,Y)|0,a=a+Math.imul(v,W)|0,r=r+Math.imul(g,$)|0,i=i+Math.imul(g,H)|0,i=i+Math.imul(m,$)|0,a=a+Math.imul(m,H)|0,r=r+Math.imul(d,J)|0,i=i+Math.imul(d,X)|0,i=i+Math.imul(p,J)|0,a=a+Math.imul(p,X)|0;var Ee=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(C,K),i=Math.imul(C,V),i=i+Math.imul(_,K)|0,a=Math.imul(_,V),r=r+Math.imul(S,Y)|0,i=i+Math.imul(S,W)|0,i=i+Math.imul(y,Y)|0,a=a+Math.imul(y,W)|0,r=r+Math.imul(b,$)|0,i=i+Math.imul(b,H)|0,i=i+Math.imul(v,$)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(g,J)|0,i=i+Math.imul(g,X)|0,i=i+Math.imul(m,J)|0,a=a+Math.imul(m,X)|0,r=r+Math.imul(d,Q)|0,i=i+Math.imul(d,ee)|0,i=i+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(T,K),i=Math.imul(T,V),i=i+Math.imul(R,K)|0,a=Math.imul(R,V),r=r+Math.imul(C,Y)|0,i=i+Math.imul(C,W)|0,i=i+Math.imul(_,Y)|0,a=a+Math.imul(_,W)|0,r=r+Math.imul(S,$)|0,i=i+Math.imul(S,H)|0,i=i+Math.imul(y,$)|0,a=a+Math.imul(y,H)|0,r=r+Math.imul(b,J)|0,i=i+Math.imul(b,X)|0,i=i+Math.imul(v,J)|0,a=a+Math.imul(v,X)|0,r=r+Math.imul(g,Q)|0,i=i+Math.imul(g,ee)|0,i=i+Math.imul(m,Q)|0,a=a+Math.imul(m,ee)|0,r=r+Math.imul(d,ne)|0,i=i+Math.imul(d,re)|0,i=i+Math.imul(p,ne)|0,a=a+Math.imul(p,re)|0;var ye=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(k,K),i=Math.imul(k,V),i=i+Math.imul(I,K)|0,a=Math.imul(I,V),r=r+Math.imul(T,Y)|0,i=i+Math.imul(T,W)|0,i=i+Math.imul(R,Y)|0,a=a+Math.imul(R,W)|0,r=r+Math.imul(C,$)|0,i=i+Math.imul(C,H)|0,i=i+Math.imul(_,$)|0,a=a+Math.imul(_,H)|0,r=r+Math.imul(S,J)|0,i=i+Math.imul(S,X)|0,i=i+Math.imul(y,J)|0,a=a+Math.imul(y,X)|0,r=r+Math.imul(b,Q)|0,i=i+Math.imul(b,ee)|0,i=i+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(g,ne)|0,i=i+Math.imul(g,re)|0,i=i+Math.imul(m,ne)|0,a=a+Math.imul(m,re)|0,r=r+Math.imul(d,ae)|0,i=i+Math.imul(d,oe)|0,i=i+Math.imul(p,ae)|0,a=a+Math.imul(p,oe)|0;var Ae=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,K),i=Math.imul(N,V),i=i+Math.imul(M,K)|0,a=Math.imul(M,V),r=r+Math.imul(k,Y)|0,i=i+Math.imul(k,W)|0,i=i+Math.imul(I,Y)|0,a=a+Math.imul(I,W)|0,r=r+Math.imul(T,$)|0,i=i+Math.imul(T,H)|0,i=i+Math.imul(R,$)|0,a=a+Math.imul(R,H)|0,r=r+Math.imul(C,J)|0,i=i+Math.imul(C,X)|0,i=i+Math.imul(_,J)|0,a=a+Math.imul(_,X)|0,r=r+Math.imul(S,Q)|0,i=i+Math.imul(S,ee)|0,i=i+Math.imul(y,Q)|0,a=a+Math.imul(y,ee)|0,r=r+Math.imul(b,ne)|0,i=i+Math.imul(b,re)|0,i=i+Math.imul(v,ne)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(g,ae)|0,i=i+Math.imul(g,oe)|0,i=i+Math.imul(m,ae)|0,a=a+Math.imul(m,oe)|0,r=r+Math.imul(d,ce)|0,i=i+Math.imul(d,le)|0,i=i+Math.imul(p,ce)|0,a=a+Math.imul(p,le)|0;var Ce=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(x,K),i=Math.imul(x,V),i=i+Math.imul(D,K)|0,a=Math.imul(D,V),r=r+Math.imul(N,Y)|0,i=i+Math.imul(N,W)|0,i=i+Math.imul(M,Y)|0,a=a+Math.imul(M,W)|0,r=r+Math.imul(k,$)|0,i=i+Math.imul(k,H)|0,i=i+Math.imul(I,$)|0,a=a+Math.imul(I,H)|0,r=r+Math.imul(T,J)|0,i=i+Math.imul(T,X)|0,i=i+Math.imul(R,J)|0,a=a+Math.imul(R,X)|0,r=r+Math.imul(C,Q)|0,i=i+Math.imul(C,ee)|0,i=i+Math.imul(_,Q)|0,a=a+Math.imul(_,ee)|0,r=r+Math.imul(S,ne)|0,i=i+Math.imul(S,re)|0,i=i+Math.imul(y,ne)|0,a=a+Math.imul(y,re)|0,r=r+Math.imul(b,ae)|0,i=i+Math.imul(b,oe)|0,i=i+Math.imul(v,ae)|0,a=a+Math.imul(v,oe)|0,r=r+Math.imul(g,ce)|0,i=i+Math.imul(g,le)|0,i=i+Math.imul(m,ce)|0,a=a+Math.imul(m,le)|0,r=r+Math.imul(d,de)|0,i=i+Math.imul(d,pe)|0,i=i+Math.imul(p,de)|0,a=a+Math.imul(p,pe)|0;var _e=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(B,K),i=Math.imul(B,V),i=i+Math.imul(F,K)|0,a=Math.imul(F,V),r=r+Math.imul(x,Y)|0,i=i+Math.imul(x,W)|0,i=i+Math.imul(D,Y)|0,a=a+Math.imul(D,W)|0,r=r+Math.imul(N,$)|0,i=i+Math.imul(N,H)|0,i=i+Math.imul(M,$)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(k,J)|0,i=i+Math.imul(k,X)|0,i=i+Math.imul(I,J)|0,a=a+Math.imul(I,X)|0,r=r+Math.imul(T,Q)|0,i=i+Math.imul(T,ee)|0,i=i+Math.imul(R,Q)|0,a=a+Math.imul(R,ee)|0,r=r+Math.imul(C,ne)|0,i=i+Math.imul(C,re)|0,i=i+Math.imul(_,ne)|0,a=a+Math.imul(_,re)|0,r=r+Math.imul(S,ae)|0,i=i+Math.imul(S,oe)|0,i=i+Math.imul(y,ae)|0,a=a+Math.imul(y,oe)|0,r=r+Math.imul(b,ce)|0,i=i+Math.imul(b,le)|0,i=i+Math.imul(v,ce)|0,a=a+Math.imul(v,le)|0,r=r+Math.imul(g,de)|0,i=i+Math.imul(g,pe)|0,i=i+Math.imul(m,de)|0,a=a+Math.imul(m,pe)|0,r=r+Math.imul(d,ge)|0,i=i+Math.imul(d,me)|0,i=i+Math.imul(p,ge)|0,a=a+Math.imul(p,me)|0;var we=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(B,Y),i=Math.imul(B,W),i=i+Math.imul(F,Y)|0,a=Math.imul(F,W),r=r+Math.imul(x,$)|0,i=i+Math.imul(x,H)|0,i=i+Math.imul(D,$)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(N,J)|0,i=i+Math.imul(N,X)|0,i=i+Math.imul(M,J)|0,a=a+Math.imul(M,X)|0,r=r+Math.imul(k,Q)|0,i=i+Math.imul(k,ee)|0,i=i+Math.imul(I,Q)|0,a=a+Math.imul(I,ee)|0,r=r+Math.imul(T,ne)|0,i=i+Math.imul(T,re)|0,i=i+Math.imul(R,ne)|0,a=a+Math.imul(R,re)|0,r=r+Math.imul(C,ae)|0,i=i+Math.imul(C,oe)|0,i=i+Math.imul(_,ae)|0,a=a+Math.imul(_,oe)|0,r=r+Math.imul(S,ce)|0,i=i+Math.imul(S,le)|0,i=i+Math.imul(y,ce)|0,a=a+Math.imul(y,le)|0,r=r+Math.imul(b,de)|0,i=i+Math.imul(b,pe)|0,i=i+Math.imul(v,de)|0,a=a+Math.imul(v,pe)|0,r=r+Math.imul(g,ge)|0,i=i+Math.imul(g,me)|0,i=i+Math.imul(m,ge)|0,a=a+Math.imul(m,me)|0;var Te=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(B,$),i=Math.imul(B,H),i=i+Math.imul(F,$)|0,a=Math.imul(F,H),r=r+Math.imul(x,J)|0,i=i+Math.imul(x,X)|0,i=i+Math.imul(D,J)|0,a=a+Math.imul(D,X)|0,r=r+Math.imul(N,Q)|0,i=i+Math.imul(N,ee)|0,i=i+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(k,ne)|0,i=i+Math.imul(k,re)|0,i=i+Math.imul(I,ne)|0,a=a+Math.imul(I,re)|0,r=r+Math.imul(T,ae)|0,i=i+Math.imul(T,oe)|0,i=i+Math.imul(R,ae)|0,a=a+Math.imul(R,oe)|0,r=r+Math.imul(C,ce)|0,i=i+Math.imul(C,le)|0,i=i+Math.imul(_,ce)|0,a=a+Math.imul(_,le)|0,r=r+Math.imul(S,de)|0,i=i+Math.imul(S,pe)|0,i=i+Math.imul(y,de)|0,a=a+Math.imul(y,pe)|0,r=r+Math.imul(b,ge)|0,i=i+Math.imul(b,me)|0,i=i+Math.imul(v,ge)|0,a=a+Math.imul(v,me)|0;var Re=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(B,J),i=Math.imul(B,X),i=i+Math.imul(F,J)|0,a=Math.imul(F,X),r=r+Math.imul(x,Q)|0,i=i+Math.imul(x,ee)|0,i=i+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(N,ne)|0,i=i+Math.imul(N,re)|0,i=i+Math.imul(M,ne)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(k,ae)|0,i=i+Math.imul(k,oe)|0,i=i+Math.imul(I,ae)|0,a=a+Math.imul(I,oe)|0,r=r+Math.imul(T,ce)|0,i=i+Math.imul(T,le)|0,i=i+Math.imul(R,ce)|0,a=a+Math.imul(R,le)|0,r=r+Math.imul(C,de)|0,i=i+Math.imul(C,pe)|0,i=i+Math.imul(_,de)|0,a=a+Math.imul(_,pe)|0,r=r+Math.imul(S,ge)|0,i=i+Math.imul(S,me)|0,i=i+Math.imul(y,ge)|0,a=a+Math.imul(y,me)|0;var Oe=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(B,Q),i=Math.imul(B,ee),i=i+Math.imul(F,Q)|0,a=Math.imul(F,ee),r=r+Math.imul(x,ne)|0,i=i+Math.imul(x,re)|0,i=i+Math.imul(D,ne)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(N,ae)|0,i=i+Math.imul(N,oe)|0,i=i+Math.imul(M,ae)|0,a=a+Math.imul(M,oe)|0,r=r+Math.imul(k,ce)|0,i=i+Math.imul(k,le)|0,i=i+Math.imul(I,ce)|0,a=a+Math.imul(I,le)|0,r=r+Math.imul(T,de)|0,i=i+Math.imul(T,pe)|0,i=i+Math.imul(R,de)|0,a=a+Math.imul(R,pe)|0,r=r+Math.imul(C,ge)|0,i=i+Math.imul(C,me)|0,i=i+Math.imul(_,ge)|0,a=a+Math.imul(_,me)|0;var ke=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(B,ne),i=Math.imul(B,re),i=i+Math.imul(F,ne)|0,a=Math.imul(F,re),r=r+Math.imul(x,ae)|0,i=i+Math.imul(x,oe)|0,i=i+Math.imul(D,ae)|0,a=a+Math.imul(D,oe)|0,r=r+Math.imul(N,ce)|0,i=i+Math.imul(N,le)|0,i=i+Math.imul(M,ce)|0,a=a+Math.imul(M,le)|0,r=r+Math.imul(k,de)|0,i=i+Math.imul(k,pe)|0,i=i+Math.imul(I,de)|0,a=a+Math.imul(I,pe)|0,r=r+Math.imul(T,ge)|0,i=i+Math.imul(T,me)|0,i=i+Math.imul(R,ge)|0,a=a+Math.imul(R,me)|0;var Ie=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(B,ae),i=Math.imul(B,oe),i=i+Math.imul(F,ae)|0,a=Math.imul(F,oe),r=r+Math.imul(x,ce)|0,i=i+Math.imul(x,le)|0,i=i+Math.imul(D,ce)|0,a=a+Math.imul(D,le)|0,r=r+Math.imul(N,de)|0,i=i+Math.imul(N,pe)|0,i=i+Math.imul(M,de)|0,a=a+Math.imul(M,pe)|0,r=r+Math.imul(k,ge)|0,i=i+Math.imul(k,me)|0,i=i+Math.imul(I,ge)|0,a=a+Math.imul(I,me)|0;var Pe=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(B,ce),i=Math.imul(B,le),i=i+Math.imul(F,ce)|0,a=Math.imul(F,le),r=r+Math.imul(x,de)|0,i=i+Math.imul(x,pe)|0,i=i+Math.imul(D,de)|0,a=a+Math.imul(D,pe)|0,r=r+Math.imul(N,ge)|0,i=i+Math.imul(N,me)|0,i=i+Math.imul(M,ge)|0,a=a+Math.imul(M,me)|0;var Ne=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,r=Math.imul(B,de),i=Math.imul(B,pe),i=i+Math.imul(F,de)|0,a=Math.imul(F,pe),r=r+Math.imul(x,ge)|0,i=i+Math.imul(x,me)|0,i=i+Math.imul(D,ge)|0,a=a+Math.imul(D,me)|0;var Me=(l+r|0)+((8191&i)<<13)|0;l=(a+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(B,ge),i=Math.imul(B,me),i=i+Math.imul(F,ge)|0,a=Math.imul(F,me);var Le=(l+r|0)+((8191&i)<<13)|0;return l=(a+(i>>>13)|0)+(Le>>>26)|0,Le&=67108863,c[0]=he,c[1]=be,c[2]=ve,c[3]=Ee,c[4]=Se,c[5]=ye,c[6]=Ae,c[7]=Ce,c[8]=_e,c[9]=we,c[10]=Te,c[11]=Re,c[12]=Oe,c[13]=ke,c[14]=Ie,c[15]=Pe,c[16]=Ne,c[17]=Me,c[18]=Le,0!==l&&(c[19]=l,n.length++),n};Math.imul||(_=l),a.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?_(this,e,t):n<63?l(this,e,t):n<1024?u(this,e,t):d(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),n=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},p.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},p.prototype.permute=function(e,t,n,r,i,a){for(var o=0;o<a;o++)r[o]=t[e[o]],i[o]=n[e[o]]},p.prototype.transform=function(e,t,n,r,i,a){this.permute(a,e,t,n,r,i);for(var o=1;o<i;o<<=1)for(var s=o<<1,c=Math.cos(2*Math.PI/s),l=Math.sin(2*Math.PI/s),u=0;u<i;u+=s)for(var d=c,p=l,f=0;f<o;f++){var g=n[u+f],m=r[u+f],h=n[u+f+o],b=r[u+f+o],v=d*h-p*b;b=d*b+p*h,h=v,n[u+f]=g+h,r[u+f]=m+b,n[u+f+o]=g-h,r[u+f+o]=m-b,f!==s&&(v=c*d-l*p,p=c*p+l*d,d=v)}},p.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},p.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},p.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},p.prototype.convert13b=function(e,t,n,i){for(var a=0,o=0;o<t;o++)a+=0|e[o],n[2*o]=8191&a,a>>>=13,n[2*o+1]=8191&a,a>>>=13;for(o=2*t;o<i;++o)n[o]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},p.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),a=this.stub(r),o=new Array(r),s=new Array(r),c=new Array(r),l=new Array(r),u=new Array(r),d=new Array(r),p=n.words;p.length=r,this.convert13b(e.words,e.length,o,r),this.convert13b(t.words,t.length,l,r),this.transform(o,a,s,c,r,i),this.transform(l,a,u,d,r,i);for(var f=0;f<r;f++){var g=s[f]*u[f]-c[f]*d[f];c[f]=s[f]*d[f]+c[f]*u[f],s[f]=g}return this.conjugate(s,c,r),this.transform(s,c,p,a,r,i),this.conjugate(p,a,r),this.normalize13b(p,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),d(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,n=0;n<this.length;n++){var i=(0|this.words[n])*e,a=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=a>>>26,this.words[n]=67108863&a}return 0!==t&&(this.words[n]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=c(e);if(0===t.length)return new a(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var i=n.sqr();r<t.length;r++,i=i.sqr())0!==t[r]&&(n=n.mul(i));return n},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,a=67108863>>>26-n<<26-n;if(0!==n){var o=0;for(t=0;t<this.length;t++){var s=this.words[t]&a,c=(0|this.words[t])-s<<n;this.words[t]=c|o,o=s>>>26-n}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,n){r("number"==typeof e&&e>=0);var i;i=t?(t-t%26)/26:0;var a=e%26,o=Math.min((e-a)/26,this.length),s=67108863^67108863>>>a<<a,c=n;if(i-=o,i=Math.max(0,i),c){for(var l=0;l<o;l++)c.words[l]=this.words[l];c.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var u=0;for(l=this.length-1;l>=0&&(0!==u||l>=i);l--){var d=0|this.words[l];this.words[l]=u<<26-a|d>>>a,u=d&s}return c&&0!==u&&(c.words[c.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;return!(this.length<=n||!(this.words[n]&i))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,n){var i,a=e.length+n;this._expand(a);var o,s=0;for(i=0;i<e.length;i++){o=(0|this.words[i+n])+s;var c=(0|e.words[i])*t;o-=67108863&c,s=(o>>26)-(c/67108864|0),this.words[i+n]=67108863&o}for(;i<this.length-n;i++)o=(0|this.words[i+n])+s,s=o>>26,this.words[i+n]=67108863&o;if(0===s)return this.strip();for(r(-1===s),s=0,i=0;i<this.length;i++)o=-(0|this.words[i])+s,s=o>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var n=this.length-e.length,r=this.clone(),i=e,o=0|i.words[i.length-1];0!=(n=26-this._countBits(o))&&(i=i.ushln(n),r.iushln(n),o=0|i.words[i.length-1]);var s,c=r.length-i.length;if("mod"!==t){s=new a(null),s.length=c+1,s.words=new Array(s.length);for(var l=0;l<s.length;l++)s.words[l]=0}var u=r.clone()._ishlnsubmul(i,1,c);0===u.negative&&(r=u,s&&(s.words[c]=1));for(var d=c-1;d>=0;d--){var p=67108864*(0|r.words[i.length+d])+(0|r.words[i.length+d-1]);for(p=Math.min(p/o|0,67108863),r._ishlnsubmul(i,p,d);0!==r.negative;)p--,r.negative=0,r._ishlnsubmul(i,1,d),r.isZero()||(r.negative^=1);s&&(s.words[d]=p)}return s&&s.strip(),r.strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:s||null,mod:r}},a.prototype.divmod=function(e,t,n){if(r(!e.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var i,o,s;return 0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(i=s.div.neg()),"div"!==t&&(o=s.mod.neg(),n&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(i=s.div.neg()),{div:i,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(o=s.mod.neg(),n&&0!==o.negative&&o.isub(e)),{div:s.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t)},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),a=n.cmp(r);return a<0||1===i&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,n=0,i=this.length-1;i>=0;i--)n=(t*n+(0|this.words[i]))%e;return n},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,n=this.length-1;n>=0;n--){var i=(0|this.words[n])+67108864*t;this.words[n]=i/e|0,t=i%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new a(1),o=new a(0),s=new a(0),c=new a(1),l=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++l;for(var u=n.clone(),d=t.clone();!t.isZero();){for(var p=0,f=1;0==(t.words[0]&f)&&p<26;++p,f<<=1);if(p>0)for(t.iushrn(p);p-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(u),o.isub(d)),i.iushrn(1),o.iushrn(1);for(var g=0,m=1;0==(n.words[0]&m)&&g<26;++g,m<<=1);if(g>0)for(n.iushrn(g);g-- >0;)(s.isOdd()||c.isOdd())&&(s.iadd(u),c.isub(d)),s.iushrn(1),c.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(s),o.isub(c)):(n.isub(t),s.isub(i),c.isub(o))}return{a:s,b:c,gcd:n.iushln(l)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new a(1),o=new a(0),s=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,l=1;0==(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)i.isOdd()&&i.iadd(s),i.iushrn(1);for(var u=0,d=1;0==(n.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(n.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(s),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(o)):(n.isub(t),o.isub(i))}var p;return p=0===t.cmpn(1)?i:o,p.cmpn(0)<0&&p.iadd(e),p},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var a=t;t=n,n=a}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var a=i,o=n;0!==a&&o<this.length;o++){var s=0|this.words[o];s+=a,a=s>>>26,s&=67108863,this.words[o]=s}return 0!==a&&(this.words[o]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t=e<0;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;this.strip();var n;if(this.length>1)n=1;else{t&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];n=i===e?0:i<e?-1:1}return 0!==this.negative?0|-n:n},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new v(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},f.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),n=this.imulK(n),n=n.iadd(this.tmp),t=n.bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):n.strip(),n},f.prototype.split=function(e,t){e.iushrn(this.n,0,t)},f.prototype.imulK=function(e){return e.imul(this.k)},i(g,f),g.prototype.split=function(e,t){for(var n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var i=e.words[9];for(t.words[t.length++]=4194303&i,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|i>>>22,i=a}i>>>=22,e.words[r-10]=i,0===i&&e.length>10?e.length-=10:e.length-=9},g.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(m,f),i(h,f),i(b,f),b.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new g;else if("p224"===e)t=new m;else if("p192"===e)t=new h;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new b}return w[e]=t,t},v.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},v.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},v.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},v.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},v.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},v.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},v.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},v.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},v.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},v.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},v.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},v.prototype.isqr=function(e){return this.imul(e,e.clone())},v.prototype.sqr=function(e){return this.mul(e,e)},v.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var n=this.m.add(new a(1)).iushrn(2);return this.pow(e,n)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);r(!i.isZero());var s=new a(1).toRed(this),c=s.redNeg(),l=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new a(2*u*u).toRed(this);0!==this.pow(u,l).cmp(c);)u.redIAdd(c);for(var d=this.pow(u,i),p=this.pow(e,i.addn(1).iushrn(1)),f=this.pow(e,i),g=o;0!==f.cmp(s);){for(var m=f,h=0;0!==m.cmp(s);h++)m=m.redSqr();r(h<g);var b=this.pow(d,new a(1).iushln(g-h-1));p=p.redMul(b),d=b.redSqr(),f=f.redMul(d),g=h}return p},v.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},v.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new a(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var i=n[0],o=0,s=0,c=t.bitLength()%26;for(0===c&&(c=26),r=t.length-1;r>=0;r--){for(var l=t.words[r],u=c-1;u>=0;u--){var d=l>>u&1;i!==n[0]&&(i=this.sqr(i)),0!==d||0!==o?(o<<=1,o|=d,(4==++s||0===r&&0===u)&&(i=this.mul(i,n[o]),s=0,o=0)):s=0}c=26}return i},v.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},v.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new E(e)},i(E,v),E.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},E.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},E.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),a=i;return i.cmp(this.m)>=0?a=i.isub(this.m):i.cmpn(0)<0&&(a=i.iadd(this.m)),a._forceRed(this)},E.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},E.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===e||e,this)}).call(t,n(190)(e))},function(e,t,n){var r=n(32);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(17);!function(e){e.ACTIVE="Active",e.CANCELLED="Cancelled",e.CANCELLING="Cancelling",e.COMPLETE="Complete",e.COMPLETING="Completing",e.FAILED="Failed",e.FAILING="Failing",e.NEW="New",e.PAUSED="Paused",e.PAUSING="Pausing",e.PREPARING="Preparing",e.READY="Ready",e.SUSPENDED="Suspended"}(r=t.JobStatus||(t.JobStatus={})),t.JOB_STATUSES=[r.ACTIVE,r.CANCELLED,r.CANCELLING,r.COMPLETE,r.COMPLETING,r.FAILED,r.FAILING,r.NEW,r.PAUSED,r.PAUSING,r.PREPARING,r.READY,r.SUSPENDED];var a=function(){function e(){}return e}();t.JobReport=a,function(e){e.Bucket="Bucket",e.Key="Key",e.VersionId="VersionId",e.Ignore="Ignore"}(t.JobManifestField||(t.JobManifestField={})),function(e){e.S3BatchOperations_CSV_20180820="S3BatchOperations_CSV_20180820",e.S3InventoryReport_CSV_20161130="S3InventoryReport_CSV_20161130"}(t.JobManifestFormat||(t.JobManifestFormat={})),function(e){e.Report_CSV_20180820="Report_CSV_20180820"}(t.JobReportFormat||(t.JobReportFormat={})),function(e){e.FAILED_TASKS_ONLY="FailedTasksOnly",e.ALL_TASKS="AllTasks"}(t.JobReportScope||(t.JobReportScope={})),function(e){e.COPY="COPY",e.REPLACE="REPLACE"}(t.S3MetadataDirective||(t.S3MetadataDirective={})),function(e){e.COPY="COPY",e.REPLACE="REPLACE"}(t.S3TaggingDirective||(t.S3TaggingDirective={})),function(e){e.STANDARD="STANDARD",e.STANDARD_IA="STANDARD_IA",e.ONEZONE_IA="ONEZONE_IA",e.INTELLIGENT_TIERING="INTELLIGENT_TIERING",e.GLACIER="GLACIER",e.DEEP_ARCHIVE="DEEP_ARCHIVE",e.RRS="RRS"}(t.S3StorageClass||(t.S3StorageClass={})),function(e){e.None="None",e.Tail="Tail"}(t.LambdaLogType||(t.LambdaLogType={}));var o=function(){function e(){}return e}();t.S3Tag=o;var s=function(){function e(){}return e}();t.S3ObjectMetadata=s,t.metadataKeyMap={CacheControl:"Cache-Control",ContentDisposition:"Content-Disposition",ContentEncoding:"Content-Encoding",ContentLanguage:"Content-Language",ContentType:"Content-Type",HttpExpiresDate:"Expires",UserMetadata:i.S3Constants.USER_DEFINED_METADATA_PREFIX},t.REMOVE_DIRECTIVE="REMOVE",function(e){e.AES256="AES256",e.KMS="KMS"}(t.S3EncryptionAlgorithm||(t.S3EncryptionAlgorithm={})),function(e){e.BULK="BULK",e.STANDARD="STANDARD"}(t.S3RestoreJobTier||(t.S3RestoreJobTier={})),function(e){e.create="create",e.clone="clone",e.edit_priority="edit_priority",e.confirm_and_run="confirm_and_run",e.cancel_job="cancel_job"}(t.JobConsoleAction||(t.JobConsoleAction={})),function(e){e.EXISTING_ROLE="EXISTING_ROLE"}(t.JobIamRole||(t.JobIamRole={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.S3Constants={OPT_IN_REGION_LIST:["ap-east-1"],API_MAX_ITEMS:{LAMBDA_LIST_FUNCTIONS:1e4,IAM_LIST_ROLES:1e3,IAM_LIST_ROLES_RECURSIVE_LIMIT:3,IAM_ATTACHED_POLICIES:10,IAM_ATTACHED_POLICIES_VERSIONS:5},CLOG_PAGE_ID:"s3v2",CLOG_OBJECTS_PAGE_ID:"s3v2-objects",CLOG_OBJECTS_DETAILS_PAGE_ID:"s3v2-objectdetails",DELIMITER:"/",PATH_SEGMENTS:{HOME:"home",BUCKETS:"buckets",BUCKET_NAME:"bucketName",KEY_PREFIX:"prefix",OBJECT_DETAILS:"object",SETTINGS:"settings",JOBS:"jobs",JOB_CREATE:"create",JOB_ID:"jobId",JOB_CONFIRM_AND_RUN:"confirm-and-run",JOB_CANCEL:"cancel",JOB_CLONE:"clone",JOB_EDIT_PRIORITY:"edit-priority",FEATURE_SPOTLIGHT:"spotlight"},SHOW_DELETED_PARAM:"showdeleted",SHOW_VERSION_PARAM:"showversions",PREFIX_SEARCH_PARAM:"prefixSearch",CURRENT_MARKER:"currentmarker",CURRENT_VERSIONS_KEY_MARKER:"currentversionkeymarker",CURRENT_VERSIONS_ID_MARKER:"currentversionidmarker",VERSION_ID_PARAM:"versionId",JOB_MANIFEST_PARAM:"manifest",SOURCE_PAGE_PARAM:"sourcePage",ACTION_SUCCESS_PARAM:"success",JOB_ID_PARAM:"jobId",XSRF_TOKEN_COOKIE:"XSRF-TOKEN",UPLOAD:{TIMEOUT_MSECS:36e5,PART_SIZE_IN_BYTES:8589934.592,MAX_OBJECT_SIZE:85899345920,MAX_NUMBER_OF_PARTS:1e4,MIN_NUMBER_OF_PARTS:1,MAX_NUMBER_CONCURRENT_UPLOADS:5,ZERO_BYTE_MD5:"d41d8cd98f00b204e9800998ecf8427e",ZERO_BYTE_MD5_BASE64:"1B2M2Y8AsgTpgAmY7PhCfg==",CUSTOM_ARN:"CUSTOM_ARN",USER_ERROR_MESSAGES:["Access Denied","Forbidden","Bad Request","Your proposed upload is smaller than the minimum allowed size","OptionsRequestDenied","OptionsResponseMissingHeaders"]},OBJECT_SSE:{AES256:"AES256",SSEC:"SSEC",CUSTOM_ARN:"CUSTOM_ARN",KMS_ENCRYPTION:"aws:kms",NONE:"NONE",KMS:{ALIAS:":alias/",KEY:":key/"}},INITIATE_RESTORE:{BULK_RETRIEVAL:"Bulk",STANDARD_RETRIEVAL:"Standard",EXPEDITED_RETRIEVAL:"Expedited",EXPEDITED_RETRIEVAL_COST:{"us-east-1":100,"us-east-2":100,"us-west-1":110,"us-west-2":100,"ca-central-1":110,"eu-west-1":100,"eu-west-2":105,"eu-west-3":105,"eu-central-1":120,"eu-north-1":100,"ap-northeast-1":110,"ap-northeast-2":110,"ap-northeast-3":110,"ap-south-1":120,"ap-east-1":120,"ap-southeast-1":120,"ap-southeast-2":120,"cn-north-1":110,"cn-northwest-1":110,"us-gov-west-1":130,"us-gov-east-1":130,"us-iso-east-1":150,"us-isob-east-1":150}},MULTIPART_COPY:{PART_SIZE:16777216},HTTP_STATUS_CODES:{UNKNOWN_ERROR:-1,OK:200,PERMANENT_REDIRECT:301,BAD_REQUEST:400,ACCESS_DENIED:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,SERVER_ERROR_THRESHOLD:500,CLIENT_ERROR_THRESHOLD:300},POSSIBLE_NETWORK_ERROR:"POSSIBLE_NETWORK_ERROR",NETWORK_STATUS:"NETWORK_STATUS",BATCH_OPS_MAX_KEYS_PER_OP:20,DATE_FORMAT:"MMM d, y h:mm:ss a 'GMT'Z",LIST_OBJECTS_MAX_KEYS_PER_LISTING:300,LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:1e3,FAC:{ISIDORE:"s3-sc-isidore",GLACIER:"s3-sc-glacier",ONEZONE_IA:"s3-zia",ACCELERATE:"s3-x-acceleration",ACCESS:"s3-access",CRR:"s3-crr",CRR_V2:"s3-crr-v2",CRR_KMS:"s3-crr-kms",CRR_KMS_TEMPLATE_V3:"s3-crr-kms-template-v3",CRR_SLICE:"s3-crr-slice",CRR_CHINA_REGION_CUSTOM_TEXT:"s3-crr-cn-custom-text",OBJECT_TAGGING:"s3-ot",OBJECT_RETENTION:"s3-sharpie",CRR_WITH_OBJECT_LOCK:"s3-sharpie-v2",TAG_QUERY:"s3-tq",QUICKSIGHT:"s3-qs",NEW_MULTIPART_COPY:"s3-new-multipart-copy",ANALYTICS:"s3-an",INVENTORY:"s3-oi",DEFAULT_ENCRYPTION:"s3-default-encryption",KMS:"s3-kms",METRICS:"s3-me",NO_ENC:"s3-no-enc",BUCKET_ALWAYS_ENCRYPT:"s3-region-level-enc",S3_RRS:"s3-rrs",QUICKSIGHT_LINK:"aws-quicksight",VERSIONED_VIEW:"s3-versioned-view",PROD_STACK:"s3-prod-stack",S3_SELECT:"s3-select",S3_SELECT_METRICS:"s3-select-metrics",RESTORE_SPEED_PROMOTION:"s3-gl-rsp",PUBLIC_ACCESS_BLOCK:"s3-ld",GLACIER_RESTORE_EVENTS:"s3-gl-rest-event",BATCH_OPERATIONS:"s3-batch-ops",BATCH_OPERATIONS_GA:"s3-batch-ops-ga",BATCH_OPERATIONS_INVENTORY:"s3-batch-ops-inv",INVENTORY_PARQUET:"s3-oi-pq",FEATURE_SPOTLIGHT:"s3-spotlight",DEEP_ARCHIVE:"s3-deep-archive",ONE_TIME_INVENTORY:"s3-one-time-inventory",BATCH_OPERATIONS_LAMBDA:"s3-batch-ops-lambda",OPT_IN_REGIONS:"s3-opt-in-regions",BULK_ANALYZE_ACCESS:"s3-bulk-analyze-access"},OPERATION:{NAME:"opName",ID:"opId",STEP:"opStep",INITIAL_BUCKET:"initialBucket",INITIAL_PATH:"initialPath",BUCKET_REGION:"bucketRegion",TIMESTAMP:"timestamp",CURRENT_BUCKET:"currentBucket",CURRENT_PATH:"currentPath",CWS_OP_ID:"cwsOpId",ERROR_STATUS:"errorStatus",THRESHOLD_PERCENTAGE:10},OPERATION_MANAGER_LOGGING:{STARTED:"S3ConsoleOperationStarted",ADDED:"S3ConsoleOperationsAdded",ENQUEUED:"S3ConsoleOperationsEnqueued",DEQUEUED:"S3ConsoleOperationsDequeued",CANCELED:"S3ConsoleOperationCanceled",COMPLETED:"S3ConsoleOperationCompleted"},OPERATION_PER_KEY_STATUS:{DONE:"SUCCESS",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"},S3_REQUEST_HEADERS:{X_AMZ_S3_CONSOLE_REQUEST_ID:"x-amz-s3-console-request-id",X_AMZ_S3_CONSOLE_OP_ID:"x-amz-s3-console-op-id",X_AMZ_S3_CONSOLE_OP_NAME:"x-amz-s3-console-op-name",XSRF_TOKEN:"X-XSRF-TOKEN"},S3_RESPONSE_HEADERS:{X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_BUCKET_REGION:"x-amz-bucket-region"},OPERATION_STATE:{ACTIVE:"active",WAITING:"waiting",CANCEL:"cancel",ERROR:"error",COMPLETED:"completed"},OPERATION_NAME:{ADD_OBJECT_TAG:"Add object tags",COPY:"Copy",CUT:"Cut",PASTE:"Paste",GET_INFO:"GetInfo",MAKE_PUBLIC:"Make public",DELETE_OBJECTS:"Delete objects",RESTORE_OBJECTS:"Restore objects",EDIT_PERMISSIONS:"Edit permissions",CHANGE_STORAGE_CLASS:"Change storage class",CHANGE_SSE:"Change SSE",UPLOAD:"Upload",LAMB:"LAMB",RENAME:"Rename",GET_OBJECT_DETAILS:"GetObjectDetails",LOAD_BUCKETS:"LoadBuckets",LIST_DELETED_OBJECTS:"ListDeletedObjects",LIST_VERSIONS:"ListVersions",SWITCH_VERSION:"SwitchVersion",EMPTY_BUCKET:"Empty bucket",DELETE_BUCKET:"Delete bucket",CHANGE_METADATA:"Change metadata",SELECT_WITHIN_OBJECT:"SelectWithinObject",GET_OBJECT_TAGGING:"GetObjectTagging",PUT_OBJECT_TAGGING:"PutObjectTagging",INITIATE_RESTORE:"Initiate restore",GET_METADATA:"Get object metadata",GET_OBJECT_METADATA:"getObjectMetadataProxy",METRICS_GET_CONFIG:"GetMetricsConfig",METRICS_PUT_CONFIG:"PutMetricsConfig",METRICS_DELETE_CONFIG:"DeleteMetricsConfig",ANALYTICS_GET_CONFIG:"GetAnalyticsConfig",ANALYTICS_PUT_CONFIG:"PutAnalyticsConfig",ANALYTICS_DELETE_CONFIG:"DeleteAnalyticsConfig",ANALYTICS_GET_DATA:"GetAnalyticsData",ANALYTICS_GET_STATUS:"GetAnalyticsStatus",INVENTORY_GET_STATUS:"GetInventoryStatus",IS_INVENTORY_ENABLED:"isInventoryEnabled",IS_ANALYTICS_ENABLED:"isAnalyticsEnabled",IS_LIFECYCLE_ENABLED:"isLifecycleEnabled",IS_METRICS_ENABLED:"isMetricsEnabled",GET_BUCKET_POLICY:"GetBucketPolicy",PUT_BUCKET_POLICY:"PutBucketPolicy",OPEN:"Open",GET_KMS_DEFAULT_ENCRYPTION:"GetKMSKeysForDefaultEncryption",GET_DEFAULT_ENCRYPTION:"GetDefaultEncryption",PUT_DEFAULT_ENCRYPTION:"PutDefaultEncryption",DELETE_DEFAULT_ENCRYPTION:"DeleteDefaultEncryption",ANALYZE_ACCESS:"AnalyzeBucketAccess",VALIDATE_BUCKET_DELETION:"ValidateBucketDeletion",GET_ACCOUNT_PUBLIC_ACCESS:"GetAccountPublicAccess",PUT_ACCOUNT_PUBLIC_ACCESS:"PutAccountPublicAccess",GET_BUCKET_PUBLIC_ACCESS:"GetBucketPublicAccess",PUT_BUCKET_PUBLIC_ACCESS:"PutBucketPublicAccess",PUT_BUCKET_PUBLIC_ACCESS_BATCH:"PutBucketPublicAccessBatch",COPY_OBJECT_PATH:"CopyObjectPath"},METRIC_NAME:{LIFECYCLE_RULE_MISMATCH:"LifecycleRuleMismatch",LIFECYCLE_DELETE_MISMATCH:"LifecycleDeleteMismatch"},CWS_OPERATION_NAME:{ADD_OBJECT_TAG:"AddObjectVersionsTags",CHANGE_METADATA:"ChangeMetadata",SELECT_WITHIN_OBJECT:"SelectWithinObject",CHANGE_SSE:"ChangeSSE",CHANGE_STORAGE_CLASS:"ChangeStorageClass",COMPLETE_MULTIPART_COPY:"CompleteMultipartCopy",COPY:"CopyObject",GENERATE_COUNT:"Count",GENERATE_VERSIONS_COUNT:"VersionsCount",GENERATE_PRESIGNED_URL:"GeneratePresignedUrl",GET_METADATA:"GetObjectMetadata",INITIATE_RESTORE:"RestoreObjectVersions",MAKE_PUBLIC:"MakePublicVersions",MULTIPART_COPY:"MultipartCopy",ANALYZE_ACCESS:"AnalyzeAccess",ANALYZE_PUBLIC_ACCESS:"AnalyzePublicAccess",VALIDATE_BUCKET_DELETION:"ValidateBucketDeletion",GET_ACCOUNT_PUBLIC_ACCESS:"GetAccountPublicAccess",PUT_ACCOUNT_PUBLIC_ACCESS:"PutAccountPublicAccess",GET_BUCKET_PUBLIC_ACCESS:"GetBucketPublicAccess",PUT_BUCKET_PUBLIC_ACCESS:"PutBucketPublicAccess",LIST_ACCOUNT_REGION_STATES:"ListAccountRegionStates"},OPERATION_PROGRESS_UPDATE_TYPE:{SINGLE_PART_RESULTS:"SinglePart",MULTIPART_COPY_RESULT:"MultipartCopy",MULTIPART_COPY_COMPLETE:"MultipartCopyComplete",MULTIPART_COPY_ALL_COMPLETE:"MultipartCopyAllComplete",MULTIPART_COPY_ERROR:"MultipartCopyError"},PROGRESS_BAR:{USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR:"S3ConsoleUserConfirmCancelProgressBar",USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL:"S3ConsoleUserConfirmCancelDetailModal"},CACHE:{SIZE:{BUCKET_LOCATION:1e3,BUCKET_PROPERTIES:11,LAMB:1,LIST_OBJECTS:50,ACCESS:1e3}},DIRECTORY_CONTENT_TYPE:"application/x-directory",HEADERS:{CACHE_CONTROL:"Cache-Control",CONTENT_DISPOSITION:"Content-Disposition",CONTENT_ENCODING:"Content-Encoding",CONTENT_LENGTH:"Content-Length",CONTENT_MD5:"Content-MD5",CONTENT_TYPE:"Content-Type",CONTENT_TYPE_JSON:"application/x-amz-json-1.1",EXPECT:"Expect",EXPIRES:"Expires",X_AMZ_MFA:"x-amz-mfa",X_AMZ_STORAGE_CLASS:"x-amz-storage-class",X_AMZ_SERVER_SIDE_ENCRYPTION:"x-amz-server-side-encryption",X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID:"x-amz-server-side-encryption-aws-kms-key-id",X_AMZ_GRANT_READ:"x-amz-grant-read",X_AMZ_RESTORE:"x-amz-restore",X_AMZ_RESTORE_TIER:"x-amz-restore-tier",X_AMZ_RESTORE_EXPIRY_DAYS:"x-amz-restore-expiry-days",X_AMZ_RESTORE_REQUEST_DATE:"x-amz-restore-request-date",X_AMZ_GRANT_READ_ACP:"x-amz-grant-read-acp",X_AMZ_GRANT_WRITE:"x-amz-grant-write",X_AMZ_GRANT_WRITE_ACP:"x-amz-grant-write-acp",X_AMZ_WEBSITE_REDIRECT_LOCATION:"x-amz-website​-redirect-location",X_AMZ_REPLICATION_STATUS:"x-amz-replication-status",X_AMZ_BYPASS_GOV_RETENTION:"x-amz-bypass-governance-retention",OPERATION:"X-Amazon-S3Console-Operation",X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_DATE:"X-Amz-Date",X_AMZ_EXPIRATION:"x-amz-expiration",X_AMZ_TAGGING:"x-amz-tagging",X_AMZ_TAGGING_COUNT:"x-amz-tagging-count",X_AMZ_ACL:"x-amz-acl",X_AMZ_ACL_PRIVATE:"private"},STORAGE_CLASSES:{DEFAULT:"default",GLACIER:"GLACIER",Glacier:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY","Reduced redundancy":"REDUCED_REDUNDANCY",STANDARD:"STANDARD",Standard:"STANDARD",STANDARD_INFREQUENT_ACCESS:"STANDARD_IA","Standard - IA":"STANDARD_IA","Standard-IA":"STANDARD_IA",ONEZONE_IA:"ONEZONE_IA","ONEZONE - IA":"ONEZONE_IA","One Zone-IA":"ONEZONE_IA",INTELLIGENT_TIERING:"INTELLIGENT_TIERING","Intelligent-Tiering":"INTELLIGENT_TIERING",DEEP_ARCHIVE:"DEEP_ARCHIVE"},BYTES:{UNITS:["unit.B","unit.KB","unit.MB","unit.GB","unit.TB","unit.PB","unit.EB"],BASE:1024},LOGGING:{S3_REQUEST_PREFIX:"s3Req",S3_RESPONSE_PREFIX:"s3Res",CWS_REQUEST_PREFIX:"cwsReq",CWS_RESPONSE_PREFIX:"cwsRes",FAC_MISMATCH_PREFIX:"facErr"},ACL_PERMISSIONS:{READ:"READ",WRITE:"WRITE",READ_ACP:"READ_ACP",WRITE_ACP:"WRITE_ACP",FULL_CONTROL:"FULL_CONTROL"},VERSIONS:{LIST_VERSIONS_COMPLETED:"ListVersionsCompleted"},GRANTEE_GROUP:{OWNER:"owner",SYSTEM:"system",ACCOUNTS:"accounts",GROUP:"group"},PUBLIC_PERMISSIONS_LIST:["AuthenticatedUsers","AllUsers"],SYSTEM_PERMISSIONS_LIST:["LogDelivery"],LOG_DELIVERY_VALUE:"LogDelivery",BUCKET_PERMISSIONS:{PUT_BUCKET_PERMISSIONS_REQUEST:"put-bucket-permissions-request",GET_BUCKET_OWNER:"get-bucket-owner",CREATE_BUCKET_PERMISSIONS:"CreateBucketPermissions",INITIALIZE_ACLS:{publicPermissions:[{detail:{text:"Any AWS user",value:"AuthenticatedUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},permissions:{READ:!1,READ_ACP:!1,WRITE:!1,WRITE_ACP:!1}},{detail:{text:"Everyone",value:"AllUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},permissions:{READ:!1,READ_ACP:!1,WRITE:!1,WRITE_ACP:!1}}],userPermissions:[{permissions:{READ:!0,READ_ACP:!0,WRITE:!0,WRITE_ACP:!0},revokeAll:!1}],awsAccountPermissions:[],systemPermissions:[{detail:{text:"LogDelivery",value:"LogDelivery",Type:"Group",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"},permissions:{READ:!1,READ_ACP:!1,WRITE:!1,WRITE_ACP:!1}}]},SAMPLE_CORS_POLICY:"\x3c!-- Sample policy --\x3e\n<CORSConfiguration>\n\t<CORSRule>\n\t\t<AllowedOrigin>*</AllowedOrigin>\n\t\t<AllowedMethod>GET</AllowedMethod>\n\t\t<MaxAgeSeconds>3000</MaxAgeSeconds>\n\t\t<AllowedHeader>Authorization</AllowedHeader>\n\t</CORSRule>\n</CORSConfiguration>",POLICY_GEN:{PUBLIC:"https://awspolicygen.s3.amazonaws.com/policygen.html",CN:"https://awspolicygen.s3.cn-north-1.amazonaws.com.cn/policygen.html",GOV:"https://awspolicygen.s3-fips-us-gov-west-1.amazonaws.com/policygen.html",ISO:"https://awspolicygen.s3.us-iso-east-1.c2s.ic.gov/policygen.html","ISO-B":"https://awspolicygen.s3.us-isob-east-1.sc2s.sgov.gov/policygen.html"},PUBLIC_ACCESS_BLOCK_DEFAULTS:{blockPublicAcls:!0,ignorePublicAcls:!0,blockPublicPolicy:!0,restrictPublicBuckets:!0}},BUCKET_PROPERTIES:{WEBSITE:{USE_BUCKET:"useBucket",PROPERTY_NAME:"website",INDEX_FILE:"index.html",CREATE_BUCKET_CARD:"create-bucket-website-card",REDIRECT_REQUEST:"redirectRequest",CONFIGURE_BUCKET_WEBSITE:"configureBucketWebsite",REDIRECT_BUCKET_WEBSITE_REQUESTS:"redirectBucketWebsiteRequests",NO_WEBSITE_CONFIGURATION_MESSAGE:"The specified bucket does not have a website configuration",DISABLE:"disable",REGION_TO_WEBSITE_ENDPOINT_MAP:{"us-east-1":"s3-website-us-east-1.amazonaws.com","us-west-2":"s3-website-us-west-2.amazonaws.com","us-west-1":"s3-website-us-west-1.amazonaws.com","eu-west-1":"s3-website-eu-west-1.amazonaws.com","eu-west-2":"s3-website.eu-west-2.amazonaws.com","eu-north-1":"s3-website.eu-north-1.amazonaws.com","eu-west-3":"s3-website.eu-west-3.amazonaws.com",EU:"s3-website-eu-west-1.amazonaws.com","ap-southeast-1":"s3-website-ap-southeast-1.amazonaws.com","ap-northeast-1":"s3-website-ap-northeast-1.amazonaws.com","ap-southeast-2":"s3-website-ap-southeast-2.amazonaws.com","sa-east-1":"s3-website-sa-east-1.amazonaws.com","eu-central-1":"s3-website.eu-central-1.amazonaws.com","ap-northeast-2":"s3-website.ap-northeast-2.amazonaws.com","ap-northeast-3":"s3-website.ap-northeast-3.amazonaws.com","ap-east-1":"s3-website.ap-east-1.amazonaws.com","ap-south-1":"s3-website.ap-south-1.amazonaws.com","us-east-2":"s3-website.us-east-2.amazonaws.com","ca-central-1":"s3-website.ca-central-1.amazonaws.com","us-gov-west-1":"s3-website-us-gov-west-1.amazonaws.com","us-gov-east-1":"s3-website-us-gov-east-1.amazonaws.com","us-iso-east-1":"s3-website.us-iso-east-1.c2s.ic.gov","us-isob-east-1":"s3-website.us-isob-east-1.sc2s.sgov.gov","cn-north-1":"s3-website.cn-north-1.amazonaws.com.cn","cn-northwest-1":"s3-website.cn-northwest-1.amazonaws.com.cn"}},TAGGING:{PROPERTY_NAME:"tagging",CREATE_BUCKET_CARD:"create-bucket-tagging-card",PUT_BUCKET_TAGGING:"putBucketTagging",TAG_SET_NOT_EXIST_MESSAGE:"The TagSet does not exist"},OBJECT_LOGGING:{READ_ONLY:"ReadOnly",WRITE_ONLY:"WriteOnly",ALL:"All"},PUT_BUCKET_ACL:"putBucketACL",GET_BUCKET_ACL:"getBucketACL",LOGGING:{ENABLE_BUCKET_LOGGING:"enableBucketLogging",CREATE_BUCKET_CARD:"create-bucket-logging-card",ENABLE:"enable"},OBJECT_RETENTION:{ENABLED:"Enabled",DISABLED:"Disabled",MODE:{NONE:"NONE",GOVERNANCE:"GOVERNANCE",COMPLIANCE:"COMPLIANCE"},LEGAL_HOLD:{ON:"ON",OFF:"OFF"},ERROR_CODE:{ACCESS_DENIED:"ACCESS_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR"}},DEFAULT_ENCRYPTION:{NONE:"None",AES256:"AES-256",AWSKMS:"AWS-KMS",API_PARAMS:{NONE:"NONE",AES256:"AES256",AWSKMS:"aws:kms"},CUSTOM_ARN:"CUSTOM_ARN",DEFAULT_ENCRYPTION_CARD:"create-bucket-default-encryption-card",NOT_FOUND_ERROR:"The server side encryption configuration was not found"},VERSIONING:{ENABLE_BUCKET_VERSIONING:"enableBucketVersioning",CREATE_BUCKET_CARD:"create-bucket-versioning-card",ENABLED:"Enabled",SUSPENDED:"Suspended",ENABLE:"enable"},REPLICATION:{CREATE_BUCKET_CARD:"create-bucket-replication-card",PUT_REPLICATION:"putBucketReplication",DISABLED:"Disabled",ENABLED:"Enabled"},EVENTS:{PUT_NOTIFICATION:"putBucketNotification",CREATE_BUCKET_CARD:"create-bucket-events-card"},EVENT_SELECTORS:{CREATE_BUCKET_CARD:"create-event-selectors-card"},REPORTS:{},ENABLE:"enable",DISABLE:"disable",GROUP_GANTEE_TYPE:"Group",LOG_DELIVERY_GROUP:"http://acs.amazonaws.com/groups/s3/LogDelivery"},BULK_OPERATION_KEYS_PER_REQUEST:{S3_API:1e3,CWS_API:20},BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE:100,BUCKET_EVENTS:{PUT:"s3:ObjectCreated:Put",POST:"s3:ObjectCreated:Post",COPY:"s3:ObjectCreated:Copy",COMPLETE_MULTIPART_UPLOAD:"s3:ObjectCreated:CompleteMultipartUpload",DELETE:"s3:ObjectRemoved:Delete",DELETE_MARKER_CREATED:"s3:ObjectRemoved:DeleteMarkerCreated",RRS_OBJECT_LOST:"s3:ReducedRedundancyLostObject",CREATE_OBJECT_ALL:"s3:ObjectCreated:*",DELETE_OBJECT_ALL:"s3:ObjectRemoved:*",RESTORE_STARTED:"s3:ObjectRestore:Post",RESTORE_COMPLETED:"s3:ObjectRestore:Completed"},EVENTS:{PREFIX:"Prefix",SUFFIX:"Suffix",SNS:"SNS",SQS:"SQS",LAMBDA:"Lambda",CUSTOM:"custom",CLOUDCONFIG:"CloudFunctionConfiguration",QUEUECONFIG:"QueueConfiguration",TOPICCONFIG:"TopicConfiguration",TOPIC:"Topic",QUEUE:"Queue",CLOUDFN:"CloudFunction",CUSTOM_PLACEHOLDER:{LAMBDA:"us-east-1:123456789:function:my_function_name",SNS:"us-east-1:123456789012:my_topic",SQS:"us-east-1:123456789012:my_queue"}},REPLICATION:{ENABLED:"Enabled",DISABLED:"Disabled",CONFIGNOTFOUND:"The replication configuration was not found",NEWROLE:"newrole",ERROR_CODE:{ENTITY_EXIST:"EntityAlreadyExists",ACCESS_DENIED:"AccessDenied",LIMIT_EXCEED:"LimitExceeded"}},TAGGING:{ERROR_CODES:{NO_SUCH_TAG_SET:"NoSuchTagSet"},MAX_ALLOWED_TAGS:10},USER_DEFINED_METADATA:["Cache-Control","Content-Disposition","Content-Encoding","Content-Language","Content-Type","Expires","x-amz-website-redirect-location"],CONTENT_TYPE_VAL_FROM_EXT:{mp3:"audio/mp3",wav:"audio/wav",aac:"audio/aac",png:"image/png",jpeg:"image/jpeg",jpg:"image/jpeg",gif:"image/gif",bmp:"image/bmp",tiff:"image/tiff",svg:"image/svg+xml",txt:"text/plain",rtf:"text/rtf",css:"text/css",html:"text/html",csv:"text/csv",doc:"application/msword",zip:"application/zip",json:"application/json",js:"application/javascript",pdf:"application/pdf",gz:"application/x-gzip",gzip:"application/x-gzip",z:"application/x-compressed","7z":"application/x-7z-compressed",apk:"application/vnd.android.package-archive",azw:"application/vnd.amazon.ebook",dmg:"application/x-apple-diskimage",mpkg:"application/vnd.apple.installer+xml",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",m3u8:"application/x-mpegURL",flv:"video/x-flv",mp4:"video/mp4",mpeg:"video/mpeg",ts:"video/MP2T","3gp":"video/3gpp",mov:"video/quicktime",avi:"video/x-msvideo",wmv:"video/x-ms-wmv"},CONTENT_TYPE_VALUES:[{text:"binary/octet-stream"},{text:"image/png"},{text:"image/jpeg"},{text:"image/gif"},{text:"image/bmp"},{text:"image/tiff"},{text:"image/svg+xml"},{text:"text/plain"},{text:"text/rtf"},{text:"application/msword"},{text:"application/zip"},{text:"audio/mpeg"},{text:"application/pdf"},{text:"application/x-gzip"},{text:"application/x-compressed"},{text:"application/zip"},{text:"application/vnd.android.package-archive"}],CONTENT_DISPOSITION:[{text:"attachment"}],USER_DEFINED_METADATA_PREFIX:"x-amz-meta-",FILE_EXTENSIONS_ICON_MAP:{default:"file-o","7z":"file-archive-o",dmg:"file-archive-o",gz:"file-archive-o",iso:"file-archive-o",jar:"file-archive-o",rar:"file-archive-o",tar:"file-archive-o",tgz:"file-archive-o",war:"file-archive-o",z:"file-archive-o",zip:"file-archive-o",mp3:"file-audio-o",bin:"file-code-o",c:"file-code-o","c++":"file-code-o",css:"file-code-o",html:"file-code-o",java:"file-code-o",js:"file-code-o",py:"file-code-o",sh:"file-code-o",xml:"file-code-o",xl:"file-excel-o",xlsx:"file-excel-o",xlsm:"file-excel-o",gif:"file-image-o",jpeg:"file-image-o",jpg:"file-image-o",png:"file-image-o",pdf:"file-pdf-o",ppt:"file-powerpoint-o",rt:"file-text-o",rtf:"file-text-o",rtx:"file-text-o",text:"file-text-o",txt:"file-text-o",avi:"file-video-o",flv:"file-video-o",m4v:"file-video-o",mov:"file-video-o",movie:"file-video-o",mp4:"file-video-o",qt:"file-video-o",wmv:"file-video-o",doc:"file-word-o",docm:"file-word-o",docx:"file-word-o",word:"file-word-o",trash:"trash-o"},LIFECYCLE:{NAME:"lifecycle",ENABLED:"Enabled",DISABLED:"Disabled",SIA:"SIA",INTELLIGENT_TIERING:"INTELLIGENT_TIERING",ONEZONEIA:"ONEZONEIA",GLACIER:"Glacier",DEEP_ARCHIVE:"DEEP_ARCHIVE",EXPIRE:"Expire",AMU:"AMU",PREFIX_PROPERTY:"Prefix",PERMANENTLY_DELETE:"PermanentlyDelete",LIST_VIEW:{STANDARD_IA:"Standard-IA","Intelligent-Tiering":"Intelligent-Tiering",ONEZONE_IA:"One Zone-IA",GLACIER:"Glacier",DEEP_ARCHIVE:"DEEP_ARCHIVE",PREFIX:"prefix : ",WHOLE:"Whole bucket",PermanentlyDelete:"Permanently Delete"},REVIEW_SECTION_TRANSITIONS:{SIA:"Standard-IA",Glacier:"Glacier",DEEP_ARCHIVE:"Glacier Deep Archive",ONEZONEIA:"One Zone-IA",INTELLIGENT_TIERING:"Intelligent-Tiering",Expire:"Expire",PermanentlyDelete:"Permanently delete"},MAX_DAYS_ALLOWED:2147483647,EXPONENTIAL:"e",EXPIRATION:"Expiration",NON_CURRENT_VERSION_EXPIRATION:"NoncurrentVersionExpiration",NON_CURRENT_DAYS:"NoncurrentDays",DAYS:"Days",STORAGE_CLASS:"StorageClass",TRUE:"true",FALSE:"false",WHOLE_BUCKET:"whole",PREFIX:"prefix",TOTAL_OPTIONS:5,RULE_ACTIONS_MAP:{DEEP_ARCHIVE:"DEEP_ARCHIVE",INTELLIGENT_TIERING:"INTELLIGENT_TIERING",STANDARD_IA:"SIA",ONEZONE_IA:"ONEZONEIA",GLACIER:"Glacier",Expiration:"Expire",NoncurrentVersionExpiration:"PermanentlyDelete"},KEY:"Key",VALUE:"Value",TAGSET:"Tags",NONCURRENT_RULE_OPTIONS_MAP:{SIA:0,INTELLIGENT_TIERING:1,ONEZONEIA:2,Glacier:3,DEEP_ARCHIVE:4,PermanentlyDelete:5},CURRENT_RULE_OPTIONS_MAP:{SIA:0,INTELLIGENT_TIERING:1,ONEZONEIA:2,Glacier:3,DEEP_ARCHIVE:4,Expire:5},TAGS:"Tags",KEY_STRING:"Key",VALUE_STRING:"Value",BUCKET_LIFECYCLE:"BucketLifecycle",GET_BUCKET_LIFECYCLE:"getBucketLifecycle",PUT_BUCKET_LIFECYCLE:"putBucketLifecycle",ENABLED_LIFECYCLE_RULE_ACTIONS:"enabledLifecycleRuleActions",CREATE_BUCKET_LIFECYCLE:"createLifecycleRule",EDIT_BUCKET_LIFECYCLE:"editLifecycleRule",CURRENT:"current",NONCURRENT:"noncurrent",AMU_DEFAULT_DAYS:"7",GLACIER_OUT_TRANSITION_MIN_DAYS:90,INTELLIGENT_TIERING_OUT_TRANSITION_MIN_DAYS:30,LIFECYCLE_RULE_ACTION_MIN_DAYS:{INTELLIGENT_TIERING:0,SIA:30,ONEZONEIA:30,Glacier:0,Expire:1,PermanentlyDelete:1,AMU:1,Delete:1,DEEP_ARCHIVE:1},RECOMMENDED_DAYS:{INTELLIGENT_TIERING:"0",SIA:"30",ONEZONEIA:"30",GLACIER:"1",DEEP_ARCHIVE:"1",EXPIRATION:"365"},RULE_ACTION_ERRORS:{SIA:0,INTELLIGENT_TIERING:1,ONEZONEIA:2,GLACIER:3,DEEP_ARCHIVE:4,EXPIRE:5,PERMANENTLY_DELETE:99,DELETE_RULE_ACTION:99,GLACIER_GREATER_THAN_SIA:"GlacierGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_SIA:"DeleteGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_GLACIER:"DeleteGreaterThanGlacier"},LIFECYCLE_DOES_NOT_EXIST_MESSAGE:"The lifecycle configuration does not exist",CONFIRMATION_MODAL:{ENABLE_POLICY:"enablePolicy",DISABLE_POLICY:"disablePolicy",DELETE_POLICY:"deletePolicy"},LIST_VIEW_MAX_LENGTH:25,ENABLE_LIFECYCLE_POLICY:"enableLifecyclePolicy",DISABLE_LIFECYCLE_POLICY:"disableLifecyclePolicy",DELETE_LIFECYCLE_POLICY:"deleteLifecyclePolicy"},PUBLIC_ACCESS_BLOCK:{MODE:{ACCOUNT:"account",BUCKET:"bucket",SELECTED:"selected"},ACCESS_TYPE:{ALL:"all",UNKNOWN:"unknown",PUBLIC:"public"},ACCESS_TYPES:["public","objects_may_be_public","authorized_users","not_public"]},KEY_CODES:{BACKSPACE:8,DOWN:40,ENTER:13,ESC:27,UP:38},ENTITY_MAX_LENGTH:{ROLE:64,POLICY:128,PATH:512,TAG_KEY:128,TAG_VALUE:256},REQUEST_METRICS:{SERVER_AVAILABILITY_SUFFIX:"-SerAvail",CLIENT_AVAILABILITY_SUFFIX:"-CliAvail",STATUS_CODE_INFIX:"-Code-",LATENCY_SUFFIX:"-latency",SESSION_TIMEOUT_SUFFIX:"-stimeout",S3_STATUS_PREFIX:"S3-Status-",CLIENT_DROP_METRIC:"S3-Client-5xx",SLOWDOWN_METRIC:"S3-Client-Slowdown",CLIENT_DROP_DEBUG_METRIC:"S3-Client-5xx-Debug"},PROXY_API_NAMES:{KMS:{LIST_KEYS:"KMS-ListKeys",PUT_POLICY:"KMS-PutPolicy",GET_POLICY:"KMS-GetPolicy"},SNS:{LIST_TOPICS:"SNS-ListTopics"},SQS:{LIST_QUEUES:"SQS-ListQueues"},LAMBDA:{LIST_FUNCTIONS:"LAMBDA-listFunctions"},IAM:{LIST_ROLES:"IAM-ListRoles",LIST_ATTACHED_ROLE_POLICIES:"IAM-ListAttachedRolePolicies",GET_POLICY_VERSIONS:"IAM-GetPolicyVersion",LIST_POLICY_VERSIONS:"IAM-ListPolicyVersions"},S3:{LAMB:"S3-LAMB",HEAD_BUCKET:"S3-HeadBucket",PUT_OBJECT:"S3-PutObject",HEAD_OBJECT:"S3-HeadObject",GET_BUCKET_LOCATION:"S3-GetBucketLocation",CREATE_BUCKET:"S3-CreateBucket",LIST_OBJECT:"S3-ListObject",LIST_VERSION:"S3-ListVersion",GET_OBJECT_TAG:"S3-GetObjectTag",PUT_OBJECT_TAG:"S3-PutObjectTag",GET_OBJECT_ACL:"S3-GetObjectAcl",PUT_OBJECT_ACL:"S3-PutObjectAcl",INITIAL_MULTIPART_UPLOAD:"S3-InitialMPUpload",COMPLETE_MULTIPART_UPLOAD:"S3-CompleteMPUpload",GET_OBJECT_METADATA:"S3-GetObjectMD",GET_PROPERTY_PREFIX:"S3-Get",PUT_PROPERTY_PREFIX:"S3-Put",DELETE_PROPERTY_PREFIX:"S3-Delete",DELETE:"S3-Delete",GET_OBJECT:"S3-GetObject",TAG_QUERY:"S3-TagQuery",LIST_BUCKET_ISIDORE_CONFIGURATION:"S3-ListBucketIsidoreConfiguration",GET_BUCKET_RETENTION_CONFIG:"Retention-GetBucketConfig",PUT_BUCKET_RETENTION_CONFIG:"Retention-PutBucketConfig",GET_OBJECT_RETENTION_CONFIG:"Retention-GetObjectConfig",PUT_OBJECT_RETENTION_CONFIG:"Retention-PutObjectConfig",GET_OBJECT_LEGAL_HOLD:"Retention-GetLegalHold",PUT_OBJECT_LEGAL_HOLD:"Retention-PutLegalHold"},GLACIER:{LIST_PROVISIONED_CAPACITY:"GLACIER-ListCapacity",PURCHASE_PROVISIONED_CAPACTIY:"GLACIER-PurchaseCapacity"},CLOUDTRAIL:{DESCRIBE_TRAILS:"CLOUDTRAIL-DescribeTrails",GET_EVENT_SELECTORS:"CLOUDTRAIL-GetEventSelectors",PUT_EVENT_SELECTORS:"CLOUDTRAIL-PutEventSelectors"}},S3_DEFAULT_ENDPOINT:"s3.amazonaws.com",S3_ENDPOINTS:{"us-east-1":"s3.amazonaws.com","us-west-2":"s3-us-west-2.amazonaws.com","us-west-1":"s3-us-west-1.amazonaws.com","eu-west-1":"s3-eu-west-1.amazonaws.com","eu-west-2":"s3.eu-west-2.amazonaws.com","eu-west-3":"s3.eu-west-3.amazonaws.com","eu-north-1":"s3.eu-north-1.amazonaws.com","ap-southeast-1":"s3-ap-southeast-1.amazonaws.com","ap-northeast-1":"s3-ap-northeast-1.amazonaws.com","ap-southeast-2":"s3-ap-southeast-2.amazonaws.com","sa-east-1":"s3-sa-east-1.amazonaws.com","eu-central-1":"s3.eu-central-1.amazonaws.com","ap-northeast-2":"s3.ap-northeast-2.amazonaws.com","ap-northeast-3":"s3.ap-northeast-3.amazonaws.com","ap-east-1":"s3.ap-east-1.amazonaws.com","ap-south-1":"s3.ap-south-1.amazonaws.com","us-east-2":"s3.us-east-2.amazonaws.com","ca-central-1":"s3.ca-central-1.amazonaws.com","cn-north-1":"s3.cn-north-1.amazonaws.com.cn","cn-northwest-1":"s3.cn-northwest-1.amazonaws.com.cn","us-gov-west-1":"s3-us-gov-west-1.amazonaws.com","us-gov-east-1":"s3-us-gov-east-1.amazonaws.com","us-iso-east-1":"s3.us-iso-east-1.c2s.ic.gov","us-isob-east-1":"s3.us-isob-east-1.sc2s.sgov.gov"},SESSION_TIMEOUT_MESSAGE:"Please (re)authenticate or return to https://console.aws.amazon.com",METRICS:{RANGE:{H1:"H1",H3:"H3",H12:"H12",H24:"H24",D3:"D3",W1:"W1",W2:"W2"},TYPE:{STORAGE:"storage",REQUESTS:"requests",DATA:"data"},UNIT:{COUNT:"Count",BYTES:"Bytes",MILLIS:"Milliseconds"},COLOR:{MAIN_AREA:"#1f77b4",OVERHEAD_AREA:"#ff7f0e"}},MANAGEMENT:{VIEWS:{LIFECYCLE:0,REPLICATION:1,ANALYTICS:2,CLOUDWATCH:3,INVENTORY:4},ACTION:{APPLYING_CONFIG:"applyingConfig",SAVING_FILTER:"savingFilter",CONFIG_LOADING:"configLoading",DELETE_FILTER:"deleteFilter",DATA_LOADING:"dataLoading"},FILTER_NAME_REGEX:/^[a-zA-Z0-9\-_.]+$/,POLICY:{SPACING:4,ID:"S3-Console-Auto-Gen-Policy",ACTION:["s3:PutObject","s3:*"],SID:"S3PolicyStmt-DO-NOT-MODIFY",SERVICE_KEY:"Service",SERVICE_VAL:"s3.amazonaws.com",SOURCE_ARN:"aws:SourceArn",ACCOUNT_KEY:"aws:SourceAccount",X_AMZ_ACL_KEY:"s3:x-amz-acl",X_AMZ_ACL_VAL:"bucket-owner-full-control",STATUS:{FAILED:0,CREATED:1,MODIFIED:2,FOUND:3,WARN:4,DENY:5},ALLOW:"Allow",DENY:"Deny"},INVENTORY:{ENABLED:"Enabled",DISABLED:"Disabled"}},ENTRY_STATE:{CREATE:0,ADDED:1,SAVED:2,REMOVE:3,UPDATE:4},STATUS_CODE_MAP:{403:"Access Denied",404:"Data not found",500:"Internal Error"},ACCELERATE:{COMPARISON_ENDPOINT:"http://s3-accelerate-speedtest.s3-accelerate.amazonaws.com/en/accelerate-speed-comparsion.html?",ENDPOINT:{PUBLIC:".s3-accelerate.amazonaws.com"}},ANALYTICS:{STORAGE_CLASS:{STANDARD:"STANDARD",STANDARD_IA:"STANDARD-IA",GLACIER:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY",ONEZONE_IA:"ONEZONE-IA",INTELLIGENT_TIERING:"INTELLIGENT_TIERING",DEEP_ARCHIVE:"DEEP_ARCHIVE"},ERROR:{USER_INFO_MISSING:"USER_INFO_MISSING",DATA_FILE_NOT_FOUND:"DATA_FILE_NOT_FOUND"},TAB_VIEW:"Tab",DETAILS:"Details",CREATE_BUCKET_MODAL:"CreateBucketModal",UPLOAD_OBJECTS_MODAL:"UploadObjectsModal",LIFECYCLE_RULES_MODAL:"LifecycleRulesModal",LATEST_VERSION:"LatestVersion",DOWNLOAD_AS:"DownloadAs",ADD_GRANTEE:"AddGrantee",SAVE_LOGGING:"SaveLogging",CANCEL_LOGGING:"CancelLogging",SAVE_WEBSITE:"SaveWebsite",CANCEL_WEBSITE:"CancelWebsite",SAVE_REPLICATION:"SaveReplication",CANCEL_REPLICATION:"CancelReplication",SAVE_EVENTS:"SaveEvents",CANCEL_EVENTS:"CancelEvents",SAVE_VERSIONING:"SaveVersioning",CANCEL_VERSIONING:"CancelVersioning",CONFIRMATION_MODAL:"ConfirmationModal",CARD_OPEN:"CardOpen",SAVE_TAGGING:"SaveTagging",CANCEL_TAGGING:"CancelTagging",SAVE_BUCKET_OBJECT_RETENTION:"SaveBucketRetention",CANCEL_BUCKET_OBJECT_RETENTION:"CancelBucketRetention",SAVE_OBJECT_METADATA:"SaveObjectMetadata",CANCEL_OBJECT_METADATA:"CancelObjectMetadata",SAVE_OBJECT_TAGS:"SaveObjectTags",CANCEL_OBJECT_TAGS:"CancelObjectTags",SAVE_OBJECT_SSE:"SaveObjectSSE",CANCEL_OBJECT_SSE:"CancelObjectSSE",SAVE_OBJECT_STORAGE_CLASS:"SaveObjectStorageClass",CANCEL_OBJECT_STORAGE_CLASS:"CancelObjectStorageClass",SAVE_REQUESTER_PAYS:"SaveRequesterPays",CANCEL_REQUESTER_PAYS:"CancelRequesterPays",SAVE_EVENT_SELECTORS:"SaveEventSelectors",CANCEL_EVENT_SELECTORS:"CancelEventSelectors",CREATE_BUCKET_S3:"CreateBucketS3",START_CREATE_BUCKET:"Start_CreateBucket",NAME_REGION_CREATE_BUCKET:"NameRegion_CreateBucket",SET_PROP_CREATE_BUCKET:"SetProp_CreateBucket",SET_PERM_CREATE_BUCKET:"SetPerm_CreateBucket",REVIEW_CREATE_BUCKET:"Review_CreateBucket",END_CREATE_BUCKET:"End_CreateBucket",SUCCESS_CREATE_BUCKET:"Success_CreateBucket",UPLOAD_FILE_S3:"UploadFileS3",START_UPLOAD_FILE:"Start_UploadFileS3",SELECT_UPLOAD_FILE:"Select_UploadFileS3",SET_PERMISSIONS_UPLOAD_FILE:"SetPerm_UploadFileS3",SET_PROPERTIES_UPLOAD_FILE:"SetProp_UploadFileS3",REVIEW_UPLOAD_FILE:"Review_UploadFileS3",END_UPLOAD_FILE:"End_UploadFileS3",LIFECYCLE_S3:"LifeCycleS3",START_LIFECYCLE:"Start_LifeCycleS3",NAME_SCOPE_LIFECYCLE:"NameScope_LifeCycleS3",TRANSITION_LIFECYCLE:"Transition_LifeCycleS3",EXPIRATIONS_LIFECYCLE:"Expirations_LifeCycleS3",REVIEW_LIFECYCLE:"Review_LifeCycleS3",END_LIFECYCLE:"End_LifeCycleS3",CANCEL_ACCELERATE:"CancelAccelerate",GET_BUCKET_ACCELERATE:"GetBucketAccelerate",PUT_BUCKET_ACCELERATE:"PutBucketAccelerate",SAVE_ACCELERATE:"SaveAccelerate",MANAGEMENT:{ADD_CONFIG:"AddConfig",SAVE_CONFIG:"SaveConfig",DELETE_CONFIG:"DeleteConfig",EDIT_CONFIG:"EditConfig",EDIT_ACTIONS_DROPDOWN:"EditActionsDropdown",SEARCH_CONFIG:"SearchConfig",CANCEL_CONFIG:"CancelAddConfig",ANALYTICS:{CONTEXT:"StorageClassAnalysis",QUICKSIGHT_LINK:"QuicksightDeepLink",CHANGE_STORAGE_CLASS:"ChangeStorageClass"},METRICS:{CONTEXT:"StorageCloudwatchMetrics",CLOUDWATCH_LINK:"CloudwatchDeepLink",REFRESH:"RefreshMetrics",PERIOD:{W2:"MetricsPeriod2Weeks",W1:"MetricsPeriod1Week",H24:"MetricsPeriod1Day",H12:"MetricsPeriodHalfDay",H3:"MetricsPeriod3Hours",H1:"MetricsPeriod1Hour"},TYPE:{storage:"StorageMetrics",requests:"RequestsMetrics",data:"DataTransferMetrics"}},INVENTORY:{CONTEXT:"ObjectInventoryContext"}},SPOTLIGHT:{ID:"Spotlight",NEW:"NewUser",VIEW:"ViewPage",ENTER:"EnterPage",EXIT:"ExitPage"},LOGGED_LINK_CLICK:"Link"},INVENTORY:{GET_STATUS_ERROR:"STATUS_FILE_NOT_FOUND"},AWS_SERVICE_LINKS:{CLOUDTRAIL:"cloudtrail"},PRICING_LINKS:{CLOUDTRAIL:"cloudtrail/pricing",CLOUDWATCH:"cloudwatch/pricing",S3:"s3/pricing"},CUSTOMER_SUPPORT:"contact-us",LEARN_MORE_LINKS:{ACCELERATE:"console/s3/transfer-acceleration",AES256_ENCRYPTION:"console/s3/using-sse-encryption-s3-managed",OBJECT_RETENTION:"console/s3/object-lock",ENCRYPTION:"console/s3/usingencryption",DEFAULT_ENCRYPTION:"console/s3/bucket-encryption",INVENTORY_OUTPUT_FORMAT:"console/s3/inventory",INVENTORY_ENCRYPTION:"console/s3/inventory-kms-key-policy",EVENTS:"console/s3/event-notifications",DELETE_BUCKET:"console/s3/delete-bucket",LAMB:{MAIN:"documentation/s3/",ACCESS:"console/s3/acl-overview-permissions"},LOGGING:"console/s3/server-access-logging",CLOUDTRAIL:"awscloudtrail/latest/userguide/logging-management-and-data-events-with-cloudtrail.html?icmpid=docs_cloudtrail_console#logging-data-events",CLOUDTRAIL_NEW_LINK:"AmazonS3/latest/dev/cloudtrail-logging.html",CLOUDWATCH:"AmazonS3/latest/dev/cloudwatch-monitoring.html",METADATA:"console/s3/using-metadata",OBJECT_TAGGING:"console/s3/object-tagging",PERMISSIONS:{POLICY:"console/s3/using-iam-policies",CORS:"console/s3/enablecors"},PUBLIC_ACCESS_BLOCK:"console/s3/publicaccess",CRR_KMS:"console/s3/crr-kms-key-policy",CRR_IAM_ROLE_SETUP:"AmazonS3/latest/dev/crr-how-setup.html",REPLICATION:"console/s3/replication",STORAGE_CLASS:"console/s3/storageclasses",LIFECYCLE_OVERLAPPING_RULE:"AmazonS3/latest/dev/lifecycle-configuration-examples.html#lifecycle-config-conceptual-ex5",LIFECYCLE_TRANSITIONS:"AmazonS3/latest/dev/lifecycle-transition-general-considerations.html",TAGGING:"console/s3/cost-allocation-tagging",VERSIONING:"console/s3/enable-bucket-versioning",REQUESTER_PAYS:"console/s3/requesterpaysbucket",WEBSITE:{configure:"console/s3/configurebucketforwebsite",redirect:"console/s3/website-redirect",hosting:"console/s3/hostingstaticwebsite"},bucket:["console/s3/usingbucket","console/s3/upload-object","console/s3/accesscontrol"],object:["console/s3/upload-object","console/s3/object-properties","console/s3/accesscontrol"],lifecycle:["console/s3/lifecyclerules","console/s3/lifecycle-transitions","console/s3/lifecycle-expire"],"storage-management":{"analytics-storage-class":"console/s3/analytics-storage-class","configure-metrics-filter":"console/s3/cloudwatch-request-metrics-filter","configure-inventory":"console/s3/configure-inventory",quicksight:"https://quicksight.aws"},replication:["console/s3/replication"],STORAGE_CLASS_INTRO:"AmazonS3/latest/dev/storage-class-intro.html",UPLOAD_OBJECTS:"AmazonS3/latest/dev/UploadingObjects.html"},SUCCESS_MESSAGE_TIMEOUT:5e3,TARGET_MEDIATOR:{SUPPORTED_LANGUAGES:["en","jp","cn","fr","de","it","pt","ko","tw","es"],LANGUAGE_MAP:{en:"en",en_us:"en",ja:"jp",ja_jp:"jp",zh:"cn",zh_cn:"cn",fr:"fr",fr_fr:"fr",de:"de",it:"it",es:"es",pt:"pt",pt_br:"pt",ko:"ko",tw:"tw",zh_tw:"tw"}},FALLBACK_REGION_LIST:{PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","eu-north-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ap-northeast-3","ca-central-1","sa-east-1","ap-east-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1","us-gov-east-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]},REGION_DOMAIN:{ISOB:"ISOB","ISO-B":"ISO-B"},DEFAULT_REGION:{PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1","ISO-B":"us-isob-east-1"},ARN_SERVICE:{KMS:"kms:",IAM:"iam::",LAMBDA:"lambda:",S3:"s3:::",SNS:"sns:",SQS:"sqs:"},AWS_SERVICE:{KMS:"KMS",S3:"S3",LAMBDA:"LAMBDA",IAM:"IAM",SQS:"SQS",SNS:"SNS"},BUCKET_PERMISSION_TYPE:{PUBLIC_ACCESS:"public-access",ACL:"acl",CORS:"cors",POLICY:"policy"},CARD_SUMMARY_INIT:{isActive:!1,isMultiValue:!1,isLoading:!1,activeSummary:{text:"",value:""},inactiveSummary:{text:""}},YOUTUBE_VIDEO_LINK:"https://youtu.be/U7e97oK_Elg?list=PLhr1KZpdzukeIOiqk59BgvpmHXOfPon92",CONTEXT_MENU:{OBJECT:{METRIC_NAME:"ObjectContextMenu",Y_OFFSET:125}},OBJECT_VERSION_OPERATION:{SHOW_VERSIONS:"ShowObjectVersions",HIDE_VERSIONS:"HideObjectVersions"},PROPERTIES_TITLE_OPNAME_MAPPING:{StorageClass:"Change storage class",Encryption:"Change SSE",Metadata:"Change metadata",Tags:"Add object tags",Retention:"Object retention"},LBR_ENDPOINTS:{PUBLIC:"s3.console.aws.amazon.com"},S3_SHARED_DATA:{DATA:"data",STATUS:"status",FAILED:"FAILED",SUCCESS:"SUCCESS",OBJECT_TEMPLATE:"<account-id>/<bucket-name>/<config-id>/data.csv",STATUS_TEMPLATE:"<account-id>/<bucket-name>/<config-id>/status.csv",ANALYTICS_BUCKET_TEMPLATE:"s3-analytics-export-shared-<region>-prod",INVENTORY_BUCKET_TEMPLATE:"s3-inventory-reporter-shared-<region>-prod"},TABS:{OBJECT:{OBJECTS:0,PROPERTIES:1,PERMISSIONS:2,MANAGEMENT:3},OBJECT_DETAILS:{OVERVIEW:0,PROPERTIES:1,PERMISSIONS:2},OBJECT_LIST:{OVERVIEW:"overview",PROPERTIES:"properties",PERMISSIONS:"permissions",SELECT:"select"}},MODAL_TYPE:{CREATE_BUCKET:"createbucket",UPLOAD:"upload"},FALLBACK_REGION_LIST_FOR_LAMB_AND_HEADBUCKET:{PUBLIC:["us-east-1","eu-west-1","ap-northeast-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1","us-gov-east-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]},IAM_ENDPOINT_MAPPING:{PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1"},PERFORMANCE_TRACKING:{BOOTSTRAP_FINISHED:"BootstrapFinished",CUSTOMER_READY:"CustomerReady",LOG_ENTRY_PREFIX:"perf",CUSTOMER_READY_PREFIX:"CR-"},MAX_RETRIES:{OPERATION_REQUEST_FAILURE:2,OPERATION_SERVER_FAILURE:3},RETRY_WAIT_TIME:500,BUCKET_PUBLIC_ACCESS_BLOCK:{ACCESS_TYPE_ALL:"all",ACCESS_TYPE_UNKNOWN:"unknown",ACCESS_TYPE_PUBLIC:"public",ACCESS_TYPES:["public","objects_may_be_public","authorized_users","not_public"]},SPOTLIGHT_STORAGE_KEY:"amz.s3.console.spotlight",REGION_STATES:{DISABLED:"DISABLED"}},r.module("s3").constant("S3Constants",t.S3Constants)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r=t;r.version=n(616).version,r.utils=n(617),r.rand=n(212),r.hmacDRBG=n(618),r.curve=n(98),r.curves=n(628),r.ec=n(630),r.eddsa=n(633)},function(e,t,n){var r=n(12),i=n(42);e.exports=n(11)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(5),i=n(20),a=n(23),o=n(43)("src"),s=Function.toString,c=(""+s).split("toString");n(30).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var l="function"==typeof n;l&&(a(n,"name")||i(n,"name",t)),e[t]!==n&&(l&&(a(n,o)||i(n,o,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||s.call(this)})},function(e,t,n){var r=n(1),i=n(7),a=n(32),o=/"/g,s=function(e,t,n,r){var i=String(a(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(o,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(69),i=n(32);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(70),i=n(42),a=n(24),o=n(31),s=n(23),c=n(155),l=Object.getOwnPropertyDescriptor;t.f=n(11)?l:function(e,t){if(e=a(e),t=o(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(23),i=n(15),a=n(103)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var r=n(18);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){"use strict";var r=n(7);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(8);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(1),i=n(30),a=n(7);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},function(e,t,n){var r=n(27),i=n(69),a=n(15),o=n(13),s=n(120);e.exports=function(e,t){var n=1==e,c=2==e,l=3==e,u=4==e,d=6==e,p=5==e||d,f=t||s;return function(t,s,g){for(var m,h,b=a(t),v=i(b),E=r(s,g,3),S=o(v.length),y=0,A=n?f(t,S):c?f(t,0):void 0;S>y;y++)if((p||y in v)&&(m=v[y],h=E(m,y,b),e))if(n)A[y]=h;else if(h)switch(e){case 3:return!0;case 5:return m;case 6:return y;case 2:A.push(m)}else if(u)return!1;return d?-1:l||u?u:A}}},,function(e,t,n){"use strict";if(n(11)){var r=n(40),i=n(5),a=n(7),o=n(1),s=n(89),c=n(126),l=n(27),u=n(49),d=n(42),p=n(20),f=n(51),g=n(33),m=n(13),h=n(181),b=n(45),v=n(31),E=n(23),S=n(71),y=n(8),A=n(15),C=n(117),_=n(46),w=n(26),T=n(47).f,R=n(119),O=n(43),k=n(10),I=n(35),P=n(79),N=n(86),M=n(122),L=n(58),x=n(83),D=n(48),j=n(121),B=n(171),F=n(12),U=n(25),K=F.f,V=U.f,G=i.RangeError,Y=i.TypeError,W=i.Uint8Array,z=Array.prototype,$=c.ArrayBuffer,H=c.DataView,q=I(0),J=I(2),X=I(3),Z=I(4),Q=I(5),ee=I(6),te=P(!0),ne=P(!1),re=M.values,ie=M.keys,ae=M.entries,oe=z.lastIndexOf,se=z.reduce,ce=z.reduceRight,le=z.join,ue=z.sort,de=z.slice,pe=z.toString,fe=z.toLocaleString,ge=k("iterator"),me=k("toStringTag"),he=O("typed_constructor"),be=O("def_constructor"),ve=s.CONSTR,Ee=s.TYPED,Se=s.VIEW,ye=I(1,function(e,t){return Te(N(e,e[be]),t)}),Ae=a(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Ce=!!W&&!!W.prototype.set&&a(function(){new W(1).set({})}),_e=function(e,t){var n=g(e);if(n<0||n%t)throw G("Wrong offset!");return n},we=function(e){if(y(e)&&Ee in e)return e;throw Y(e+" is not a typed array!")},Te=function(e,t){if(!(y(e)&&he in e))throw Y("It is not a typed array constructor!");return new e(t)},Re=function(e,t){return Oe(N(e,e[be]),t)},Oe=function(e,t){for(var n=0,r=t.length,i=Te(e,r);r>n;)i[n]=t[n++];return i},ke=function(e,t,n){K(e,t,{get:function(){return this._d[n]}})},Ie=function(e){var t,n,r,i,a,o,s=A(e),c=arguments.length,u=c>1?arguments[1]:void 0,d=void 0!==u,p=R(s);if(void 0!=p&&!C(p)){for(o=p.call(s),r=[],t=0;!(a=o.next()).done;t++)r.push(a.value);s=r}for(d&&c>2&&(u=l(u,arguments[2],2)),t=0,n=m(s.length),i=Te(this,n);n>t;t++)i[t]=d?u(s[t],t):s[t];return i},Pe=function(){for(var e=0,t=arguments.length,n=Te(this,t);t>e;)n[e]=arguments[e++];return n},Ne=!!W&&a(function(){fe.call(new W(1))}),Me=function(){return fe.apply(Ne?de.call(we(this)):we(this),arguments)},Le={copyWithin:function(e,t){return B.call(we(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return Z(we(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return j.apply(we(this),arguments)},filter:function(e){return Re(this,J(we(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Q(we(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(we(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){q(we(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(we(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(we(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(we(this),arguments)},lastIndexOf:function(e){return oe.apply(we(this),arguments)},map:function(e){return ye(we(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(we(this),arguments)},reduceRight:function(e){return ce.apply(we(this),arguments)},reverse:function(){for(var e,t=this,n=we(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return X(we(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(we(this),e)},subarray:function(e,t){var n=we(this),r=n.length,i=b(e,r);return new(N(n,n[be]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,m((void 0===t?r:b(t,r))-i))}},xe=function(e,t){return Re(this,de.call(we(this),e,t))},De=function(e){we(this);var t=_e(arguments[1],1),n=this.length,r=A(e),i=m(r.length),a=0;if(i+t>n)throw G("Wrong length!");for(;a<i;)this[t+a]=r[a++]},je={entries:function(){return ae.call(we(this))},keys:function(){return ie.call(we(this))},values:function(){return re.call(we(this))}},Be=function(e,t){return y(e)&&e[Ee]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Fe=function(e,t){return Be(e,t=v(t,!0))?d(2,e[t]):V(e,t)},Ue=function(e,t,n){return!(Be(e,t=v(t,!0))&&y(n)&&E(n,"value"))||E(n,"get")||E(n,"set")||n.configurable||E(n,"writable")&&!n.writable||E(n,"enumerable")&&!n.enumerable?K(e,t,n):(e[t]=n.value,e)};ve||(U.f=Fe,F.f=Ue),o(o.S+o.F*!ve,"Object",{getOwnPropertyDescriptor:Fe,defineProperty:Ue}),a(function(){pe.call({})})&&(pe=fe=function(){return le.call(this)});var Ke=f({},Le);f(Ke,je),p(Ke,ge,je.values),f(Ke,{slice:xe,set:De,constructor:function(){},toString:pe,toLocaleString:Me}),ke(Ke,"buffer","b"),ke(Ke,"byteOffset","o"),ke(Ke,"byteLength","l"),ke(Ke,"length","e"),K(Ke,me,{get:function(){return this[Ee]}}),e.exports=function(e,t,n,c){c=!!c;var l=e+(c?"Clamped":"")+"Array",d="get"+e,f="set"+e,g=i[l],b=g||{},v=g&&w(g),E=!g||!s.ABV,A={},C=g&&g.prototype,R=function(e,n){var r=e._d;return r.v[d](n*t+r.o,Ae)},O=function(e,n,r){var i=e._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[f](n*t+i.o,r,Ae)},k=function(e,t){K(e,t,{get:function(){return R(this,t)},set:function(e){return O(this,t,e)},enumerable:!0})};E?(g=n(function(e,n,r,i){u(e,g,l,"_d");var a,o,s,c,d=0,f=0;if(y(n)){if(!(n instanceof $||"ArrayBuffer"==(c=S(n))||"SharedArrayBuffer"==c))return Ee in n?Oe(g,n):Ie.call(g,n);a=n,f=_e(r,t);var b=n.byteLength;if(void 0===i){if(b%t)throw G("Wrong length!");if((o=b-f)<0)throw G("Wrong length!")}else if((o=m(i)*t)+f>b)throw G("Wrong length!");s=o/t}else s=h(n),o=s*t,a=new $(o);for(p(e,"_d",{b:a,o:f,l:o,e:s,v:new H(a)});d<s;)k(e,d++)}),C=g.prototype=_(Ke),p(C,"constructor",g)):a(function(){g(1)})&&a(function(){new g(-1)})&&x(function(e){new g,new g(null),new g(1.5),new g(e)},!0)||(g=n(function(e,n,r,i){u(e,g,l);var a;return y(n)?n instanceof $||"ArrayBuffer"==(a=S(n))||"SharedArrayBuffer"==a?void 0!==i?new b(n,_e(r,t),i):void 0!==r?new b(n,_e(r,t)):new b(n):Ee in n?Oe(g,n):Ie.call(g,n):new b(h(n))}),q(v!==Function.prototype?T(b).concat(T(v)):T(b),function(e){e in g||p(g,e,b[e])}),g.prototype=C,r||(C.constructor=g));var I=C[ge],P=!!I&&("values"==I.name||void 0==I.name),N=je.values;p(g,he,!0),p(C,Ee,l),p(C,Se,!0),p(C,be,g),(c?new g(1)[me]==l:me in C)||K(C,me,{get:function(){return l}}),A[l]=g,o(o.G+o.W+o.F*(g!=b),A),o(o.S,l,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*a(function(){b.of.call(g,1)}),l,{from:Ie,of:Pe}),"BYTES_PER_ELEMENT"in C||p(C,"BYTES_PER_ELEMENT",t),o(o.P,l,Le),D(l),o(o.P+o.F*Ce,l,{set:De}),o(o.P+o.F*!P,l,je),r||C.toString==pe||(C.toString=pe),o(o.P+o.F*a(function(){new g(1).slice()}),l,{slice:xe}),o(o.P+o.F*(a(function(){return[1,2].toLocaleString()!=new g([1,2]).toLocaleString()})||!a(function(){C.toLocaleString.call([1,2])})),l,{toLocaleString:Me}),L[l]=P?I:N,r||P||p(C,ge,N)}}else e.exports=function(){}},function(e,t,n){var r=n(176),i=n(1),a=n(78)("metadata"),o=a.store||(a.store=new(n(179))),s=function(e,t,n){var i=o.get(e);if(!i){if(!n)return;o.set(e,i=new r)}var a=i.get(t);if(!a){if(!n)return;i.set(t,a=new r)}return a},c=function(e,t,n){var r=s(t,n,!1);return void 0!==r&&r.has(e)},l=function(e,t,n){var r=s(t,n,!1);return void 0===r?void 0:r.get(e)},u=function(e,t,n,r){s(n,r,!0).set(e,t)},d=function(e,t){var n=s(e,t,!1),r=[];return n&&n.forEach(function(e,t){r.push(t)}),r},p=function(e){return void 0===e||"symbol"==typeof e?e:String(e)},f=function(e){i(i.S,"Reflect",e)};e.exports={store:o,map:s,has:c,get:l,set:u,keys:d,key:p,exp:f}},function(e,t,n){var r=n(43)("meta"),i=n(8),a=n(23),o=n(12).f,s=0,c=Object.isExtensible||function(){return!0},l=!n(7)(function(){return c(Object.preventExtensions({}))}),u=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},d=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[r].i},p=function(e,t){if(!a(e,r)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[r].w},f=function(e){return l&&g.NEED&&c(e)&&!a(e,r)&&u(e),e},g=e.exports={KEY:r,NEED:!1,fastKey:d,getWeak:p,onFreeze:f}},function(e,t){e.exports=!1},function(e,t,n){var r=n(10)("unscopables"),i=Array.prototype;void 0==i[r]&&n(20)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(157),i=n(104);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(33),i=Math.max,a=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(4),i=n(158),a=n(104),o=n(103)("IE_PROTO"),s=function(){},c=function(){var e,t=n(101)("iframe"),r=a.length;for(t.style.display="none",n(105).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[a[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(157),i=n(104).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(5),i=n(12),a=n(11),o=n(10)("species");e.exports=function(e){var t=r[e];a&&t&&!t[o]&&i.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(27),i=n(169),a=n(117),o=n(4),s=n(13),c=n(119),l={},u={},t=e.exports=function(e,t,n,d,p){var f,g,m,h,b=p?function(){return e}:c(e),v=r(n,d,t?2:1),E=0;if("function"!=typeof b)throw TypeError(e+" is not iterable!");if(a(b)){for(f=s(e.length);f>E;E++)if((h=t?v(o(g=e[E])[0],g[1]):v(e[E]))===l||h===u)return h}else for(m=b.call(e);!(g=m.next()).done;)if((h=i(m,v,g.value,t))===l||h===u)return h};t.BREAK=l,t.RETURN=u},function(e,t,n){var r=n(21);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);l.call(this,e),u.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){this.allowHalfOpen||this._writableState.ended||s(a,this)}function a(e){e.end()}var o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=r;var s=n(138),c=n(73);c.inherits=n(65);var l=n(197),u=n(140);c.inherits(r,l);for(var d=o(u.prototype),p=0;p<d.length;p++){var f=d[p];r.prototype[f]||(r.prototype[f]=u.prototype[f])}},function(e,t,n){var r=t;r.utils=n(619),r.common=n(620),r.sha=n(621),r.ripemd=n(622),r.hmac=n(623),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},function(e,t,n){"use strict";function r(e){return b(g(e))}function i(e){var t=e.PercentageComplete;return(t?100===t?"100":t.toFixed(2):"0")+"%"}function a(e){return v(m(e),g(e))}function o(e){return v(h(e),g(e))}function s(e){var t=g(e);return t&&e.ProgressSummary?e.PercentageComplete=((e.ProgressSummary.NumberOfTasksSucceeded||0)+(e.ProgressSummary.NumberOfTasksFailed||0))/t*100:e.PercentageComplete=0,c(e),e}function c(e){var t,n,r=e.Operation;E.isString(r)?(t=r,n={}):E.isObject(r)&&(t=Object.keys(r).find(function(e){return r[e]}),n=r[t]);var i=A.jobOperationTypeClassMapping[t];i&&(e.Operation=new i,E.assign(e.Operation,n))}function l(e,t){var n=d(e);return n?u(t)+"/"+n:void 0}function u(e){return e?"/"+S.S3Constants.PATH_SEGMENTS.JOBS+"/"+e:void 0}function d(e){switch(e){case y.JobConsoleAction.confirm_and_run:return S.S3Constants.PATH_SEGMENTS.JOB_CONFIRM_AND_RUN;case y.JobConsoleAction.cancel_job:return S.S3Constants.PATH_SEGMENTS.JOB_CANCEL;case y.JobConsoleAction.clone:return S.S3Constants.PATH_SEGMENTS.JOB_CLONE;case y.JobConsoleAction.edit_priority:return S.S3Constants.PATH_SEGMENTS.JOB_EDIT_PRIORITY;default:return}}function p(e,t){return!(!t||e===y.JobConsoleAction.create||e!==y.JobConsoleAction.clone&&(e===y.JobConsoleAction.confirm_and_run?t.Status!==y.JobStatus.SUSPENDED:f(t)))}function f(e){return[y.JobStatus.CANCELLED,y.JobStatus.COMPLETE,y.JobStatus.FAILED].indexOf(e.Status)>-1}function g(e){return e.ProgressSummary&&e.ProgressSummary.TotalNumberOfTasks||0}function m(e){return e.ProgressSummary?e.ProgressSummary.NumberOfTasksFailed:0}function h(e){return e.ProgressSummary?e.ProgressSummary.NumberOfTasksSucceeded:0}function b(e){return e?e.toLocaleString?e.toLocaleString():e.toString():"0"}function v(e,t){var n="0";if(e&&t){var r=e/t*100;n=r>0&&r<1?"< 1":""+Math.round(r)}return b(e)+" ("+n+"%)"}Object.defineProperty(t,"__esModule",{value:!0});var E=n(2),S=n(17),y=n(16),A=n(147);t.jobHelpers={getFormattedTotalObjects:r,getCompletePercent:i,getFailureData:a,getSucceededData:o,processJob:s,getJobConsoleActionPath:l,getJobPath:u,isJobConsoleActionEnabled:p}},function(e,t,n){"use strict";function r(e,t,n){return n?e.instant(t+"."+n.toLowerCase()):""}function i(e,t,n){return void 0===n&&(n=!1),'<a class="awsui-hover-child-icons external-link" href="'+t+'" target="_blank">\n        <span>'+e+"</span>&nbsp;"+(n?"":'<span class="awsui-icon awsui-icon-link external-link"></span>')+"\n    </a>"}function a(e){return e?0===e.length?m.REMOVE_DIRECTIVE:m.S3TaggingDirective.REPLACE:m.S3TaggingDirective.COPY}function o(e,t){return e!==m.S3TaggingDirective.REPLACE||t?e:m.REMOVE_DIRECTIVE}function s(e){return{headers:["objectproperties.tags.key","objectproperties.tags.value"],rows:e.map(function(e){return[e.Key,e.Value]})}}function c(e,t){var n=[];return Object.keys(e).forEach(function(i){if("UserMetadata"===i)Object.keys(e[i]).forEach(function(t){n.push({Key:""+f.S3Constants.USER_DEFINED_METADATA_PREFIX+t,Value:e[i][t]})});else{var a=m.metadataKeyMap[i],o=a?r(t,"objectdetail.metadata",a):i;n.push({Key:o,Value:e[i].toString()})}}),n}function l(e,t){return{headers:["objectproperties.tags.key","objectproperties.tags.value"],rows:c(e,t).map(function(e){return[e.Key,e.Value]})}}function u(e,t){return{headers:["job_management.properties.operation_acl_table.grantee","job_management.properties.operation_acl_table.object","job_management.properties.operation_acl_table.object_acl"],rows:g.aclHelpers.processGrants(e).map(function(e){return d(e,t)})}}function d(e,t){var n=[],i=[];e.Permissions.READ&&n.push("read"),e.Permissions.READ_ACP&&i.push("read"),e.Permissions.WRITE_ACP&&i.push("write");var a=function(e){return e.map(function(e){return r(t,"job_management.properties.operation_acl_table",e)}).join(", ")};return[g.aclHelpers.getGranteeName(e.Grantee,t),a(n),a(i)]}function p(e){return{Grantee:{Identifier:e,TypeIdentifier:g.S3GranteeTypeIdentifier.CANONICAL},Permission:g.S3Permission.FULL_CONTROL}}Object.defineProperty(t,"__esModule",{value:!0});var f=n(17),g=n(223),m=n(16);t.jobPropertyHelpers={getAclTable:u,createOwnerGrant:p,getTranslatedValue:r,getExternalLink:i,getTagsTable:s,getMetadataTable:l,getTaggingDirective:a,processDirective:o}},function(e,t,n){var r=n(12).f,i=n(23),a=n(10)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(1),i=n(32),a=n(7),o=n(107),s="["+o+"]",c="​",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(e,t,n){var i={},s=a(function(){return!!o[e]()||c[e]()!=c}),l=i[e]=s?t(p):o[e];n&&(i[n]=l),r(r.P+r.F*s,"String",i)},p=d.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},function(e,t){e.exports={}},function(e,t,n){var r=n(8);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},,function(e,t,n){"use strict";(function(t){function r(e){l.call(this,"digest"),this._hash=e,this.buffers=[]}function i(e){l.call(this,"digest"),this._hash=e}var a=n(9),o=n(194),s=n(583),c=n(584),l=n(63);a(r,l),r.prototype._update=function(e){this.buffers.push(e)},r.prototype._final=function(){var e=t.concat(this.buffers),n=this._hash(e);return this.buffers=null,n},a(i,l),i.prototype._update=function(e){this._hash.update(e)},i.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return e=e.toLowerCase(),"md5"===e?new r(o):"rmd160"===e||"ripemd160"===e?new r(s):new i(c(e))}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function n(e,n){this._block=new t(e),this._finalSize=n,this._blockSize=e,this._len=0,this._s=0}n.prototype.update=function(e,n){"string"==typeof e&&(n=n||"utf8",e=new t(e,n));for(var r=this._len+=e.length,i=this._s||0,a=0,o=this._block;i<r;){for(var s=Math.min(e.length,a+this._blockSize-i%this._blockSize),c=s-a,l=0;l<c;l++)o[i%this._blockSize+l]=e[l+a];i+=c,a+=c,i%this._blockSize==0&&this._update(o)}return this._s=i,this},n.prototype.digest=function(e){var t=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4);var n=this._update(this._block)||this._hash();return e?n.toString(e):n},n.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=n}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._decoder=null,this._encoding=null}var i=n(64).Transform,a=n(9),o=n(141).StringDecoder;e.exports=r,a(r,i),r.prototype.update=function(e,n,r){"string"==typeof e&&(e=new t(e,n));var i=this._update(e);return this.hashMode?this:(r&&(i=this._toString(i,r)),i)},r.prototype.setAutoPadding=function(){},r.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},r.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},r.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},r.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{n(r)}},r.prototype._flush=function(e){var t;try{this.push(this._final())}catch(e){t=e}finally{e(t)}},r.prototype._finalOrDigest=function(e){var n=this._final()||new t("");return e&&(n=this._toString(n,e,!0)),n},r.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r}}).call(t,n(3).Buffer)},function(e,t,n){function r(){i.call(this)}e.exports=r;var i=n(93).EventEmitter;n(65)(r,i),r.Readable=n(589),r.Writable=n(595),r.Duplex=n(596),r.Transform=n(597),r.PassThrough=n(598),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&l.pause&&l.pause()}function r(){l.readable&&l.resume&&l.resume()}function a(){u||(u=!0,e.end())}function o(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){l.removeListener("data",n),e.removeListener("drain",r),l.removeListener("end",a),l.removeListener("close",o),l.removeListener("error",s),e.removeListener("error",s),l.removeListener("end",c),l.removeListener("close",c),e.removeListener("close",c)}var l=this;l.on("data",n),e.on("drain",r),e._isStdio||t&&!1===t.end||(l.on("end",a),l.on("close",o));var u=!1;return l.on("error",s),e.on("error",s),l.on("end",c),l.on("close",c),e.on("close",c),e.emit("pipe",l),e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r=t;r.bignum=n(14),r.define=n(637).define,r.base=n(76),r.constants=n(215),r.decoders=n(643),r.encoders=n(645)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(){function e(){this.type=void 0,this.defaultName="",this.iamRoleTemplate="",this.internalProperties=["internalProperties","type","defaultName","iamRoleTemplate"]}return e.prototype.toPlainObject=function(){var e,t=this,n={};return Object.getOwnPropertyNames(this).filter(function(e){return!r.isFunction(t[e])&&!r.includes(t.internalProperties,e)}).forEach(function(e){n[e]=t[e]}),e={},e[this.type]=n,e},e.prototype.initializeDefaults=function(e){},e.prototype.getProperties=function(e){return[]},e}();t.JobOperation=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,a=n(221),o=n(222),s=n(224),c=n(225),l=n(226);!function(e){e.S3PutObjectCopy="S3PutObjectCopy",e.LambdaInvoke="LambdaInvoke",e.S3PutObjectTagging="S3PutObjectTagging",e.S3PutObjectAcl="S3PutObjectAcl",e.S3InitiateRestoreObject="S3InitiateRestoreObject"}(i=t.JobOperationType||(t.JobOperationType={})),t.jobOperationTypeClassMapping=(r={},r[i.S3PutObjectCopy]=o.S3CopyObjectOperation,r[i.LambdaInvoke]=a.LambdaInvokeOperation,r[i.S3PutObjectTagging]=l.S3SetObjectTaggingOperation,r[i.S3PutObjectAcl]=c.S3SetObjectAclOperation,r[i.S3InitiateRestoreObject]=s.S3InitiateRestoreObjectOperation,r)},function(e,t,n){var r=n(28);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(28),i=n(10)("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),i))?n:a?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";(function(t,n,r){function i(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function a(e,i){if(e>65536)throw new Error("requested too many random bytes");var a=new t.Uint8Array(e);e>0&&o.getRandomValues(a);var s=new n(a.buffer);return"function"==typeof i?r.nextTick(function(){i(null,s)}):s}var o=t.crypto||t.msCrypto;o&&o.getRandomValues?e.exports=a:e.exports=i}).call(t,n(36),n(3).Buffer,n(60))},function(e,t,n){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===h(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function a(e){return null==e}function o(e){return"number"==typeof e}function s(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function l(e){return void 0===e}function u(e){return"[object RegExp]"===h(e)}function d(e){return"object"==typeof e&&null!==e}function p(e){return"[object Date]"===h(e)}function f(e){return"[object Error]"===h(e)||e instanceof Error}function g(e){return"function"==typeof e}function m(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function h(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=a,t.isNumber=o,t.isString=s,t.isSymbol=c,t.isUndefined=l,t.isRegExp=u,t.isObject=d,t.isDate=p,t.isError=f,t.isFunction=g,t.isPrimitive=m,t.isBuffer=e.isBuffer}).call(t,n(3).Buffer)},function(e,t,n){(function(t){e.exports=function(e,n){for(var r=Math.min(e.length,n.length),i=new t(r),a=0;a<r;++a)i[a]=e[a]^n[a];return i}}).call(t,n(3).Buffer)},function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=n,n.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},function(e,t,n){var r=t;r.Reporter=n(640).Reporter,r.DecoderBuffer=n(214).DecoderBuffer,r.EncoderBuffer=n(214).EncoderBuffer,r.Node=n(641)},function(e,t,n){"use strict";function r(e,t,n){return a(i(e,t),n)}function i(e,n){if(!l.includes(d,e))return o();var r=n&&n.errorCode;return l.includes(t.ACCESS_DENIED_CODES,r)?s(e):c(e)}function a(e,t){return{header:t.instant(e.header),content:t.instant(e.content)}}function o(){return{header:"error.internal_error",content:"utilities.unknown.error"}}function s(e){var t=["list","detail"];return{header:l.includes(t,e)?"job_management.errors.permissions.title."+e:"error.insufficient_permissions",content:"job_management.errors.permissions.content."+e}}function c(e){return{header:"error.internal_error",content:"job_management.errors.internal."+e}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),u=n(16),d=Object.keys(u.JobConsoleAction).concat(["list","detail"]);!function(e){e.list="list",e.detail="detail",e.unknown="unknown"}(t.JobConsoleErrorAction||(t.JobConsoleErrorAction={})),t.ACCESS_DENIED_CODES=["403 Forbidden","AccessDenied"],t.jobErrorAlert={get:r}},function(e,t,n){var r=n(30),i=n(5),a=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(40)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(24),i=n(13),a=n(45);e.exports=function(e){return function(t,n,o){var s,c=r(t),l=i(c.length),u=a(o,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(28);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(8),i=n(28),a=n(10)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(10)("iterator"),i=!1;try{var a=[7][r]();a.return=function(){i=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:n=!0}},a[r]=function(){return o},e(a)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(4);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(20),i=n(21),a=n(7),o=n(32),s=n(10);e.exports=function(e,t,n){var c=s(e),l=n(o,c,""[e]),u=l[0],d=l[1];a(function(){var t={};return t[c]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,u),r(RegExp.prototype,c,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){var r=n(4),i=n(18),a=n(10)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[a])?t:i(n)}},function(e,t,n){var r=n(5),i=r.navigator;e.exports=i&&i.userAgent||""},function(e,t,n){"use strict";var r=n(5),i=n(1),a=n(21),o=n(51),s=n(39),c=n(50),l=n(49),u=n(8),d=n(7),p=n(83),f=n(56),g=n(108);e.exports=function(e,t,n,m,h,b){var v=r[e],E=v,S=h?"set":"add",y=E&&E.prototype,A={},C=function(e){var t=y[e];a(y,e,"delete"==e?function(e){return!(b&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return b&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof E&&(b||y.forEach&&!d(function(){(new E).entries().next()}))){var _=new E,w=_[S](b?{}:-0,1)!=_,T=d(function(){_.has(1)}),R=p(function(e){new E(e)}),O=!b&&d(function(){for(var e=new E,t=5;t--;)e[S](t,t);return!e.has(-0)});R||(E=t(function(t,n){l(t,E,e);var r=g(new v,t,E);return void 0!=n&&c(n,h,r[S],r),r}),E.prototype=y,y.constructor=E),(T||O)&&(C("delete"),C("has"),h&&C("get")),(O||w)&&C(S),b&&y.clear&&delete y.clear}else E=m.getConstructor(t,e,h,S),o(E.prototype,n),s.NEED=!0;return f(E,e),A[e]=E,i(i.G+i.W+i.F*(E!=v),A),b||m.setStrong(E,e,h),E}},function(e,t,n){for(var r,i=n(5),a=n(20),o=n(43),s=o("typed_array"),c=o("view"),l=!(!i.ArrayBuffer||!i.DataView),u=l,d=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(r=i[p[d++]])?(a(r.prototype,s,!0),a(r.prototype,c,!0)):u=!1;e.exports={ABV:l,CONSTR:u,TYPED:s,VIEW:c}},function(e,t,n){"use strict";e.exports=n(40)||!n(7)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n(5)[e]})},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(1),i=n(18),a=n(27),o=n(50);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,s,c=arguments[1];return i(this),t=void 0!==c,t&&i(c),void 0==e?new this:(n=[],t?(r=0,s=a(c,arguments[2],2),o(e,!1,function(e){n.push(s(e,r++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(a(n))for(s=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,c=0;c<i;c++)l[c].apply(this,s);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(function(t){function r(e,n,r,a){t.isBuffer(e)||(e=new t(e,"binary")),n&&!t.isBuffer(n)&&(n=new t(n,"binary")),r/=8,a=a||0;for(var o,s,c=0,l=0,u=new t(r),d=new t(a),p=0,f=[];;){if(p++>0&&f.push(o),f.push(e),n&&f.push(n),o=i(t.concat(f)),f=[],s=0,r>0)for(;0!==r&&s!==o.length;)u[c++]=o[s],r--,s++;if(a>0&&s!==o.length)for(;0!==a&&s!==o.length;)d[l++]=o[s],a--,s++;if(0===r&&0===a)break}for(s=0;s<o.length;s++)o[s]=0;return{key:u,iv:d}}var i=n(194);e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function n(e){var t;return e>s||e<0?(t=Math.abs(e)%s,e<0?s-t:t):e}function r(e){for(;0<e.length;e++)e[0]=0;return!1}function i(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function a(e){for(var t=e.length/4,n=new Array(t),r=-1;++r<t;)n[r]=e.readUInt32BE(4*r);return n}function o(e){this._key=a(e),this._doReset()}var s=Math.pow(2,32);i.prototype.init=function(){var e,t,n,r,i,a,o,s,c,l;for(e=function(){var e,n;for(n=[],t=e=0;e<256;t=++e)t<128?n.push(t<<1):n.push(t<<1^283);return n}(),i=0,c=0,t=l=0;l<256;t=++l)n=c^c<<1^c<<2^c<<3^c<<4,n=n>>>8^255&n^99,this.SBOX[i]=n,this.INV_SBOX[n]=i,a=e[i],o=e[a],s=e[o],r=257*e[n]^16843008*n,this.SUB_MIX[0][i]=r<<24|r>>>8,this.SUB_MIX[1][i]=r<<16|r>>>16,this.SUB_MIX[2][i]=r<<8|r>>>24,this.SUB_MIX[3][i]=r,r=16843009*s^65537*o^257*a^16843008*i,this.INV_SUB_MIX[0][n]=r<<24|r>>>8,this.INV_SUB_MIX[1][n]=r<<16|r>>>16,this.INV_SUB_MIX[2][n]=r<<8|r>>>24,this.INV_SUB_MIX[3][n]=r,0===i?i=c=1:(i=a^e[e[e[s^a]]],c^=e[e[c]]);return!0};var c=new i;o.blockSize=16,o.prototype.blockSize=o.blockSize,o.keySize=32,o.prototype.keySize=o.keySize,o.prototype._doReset=function(){var e,t,n,r,i,a;for(n=this._key,t=n.length,this._nRounds=t+6,i=4*(this._nRounds+1),this._keySchedule=[],r=0;r<i;r++)this._keySchedule[r]=r<t?n[r]:(a=this._keySchedule[r-1],r%t==0?(a=a<<8|a>>>24,a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a],a^=c.RCON[r/t|0]<<24):t>6&&r%t==4&&(a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a]),this._keySchedule[r-t]^a);for(this._invKeySchedule=[],e=0;e<i;e++)r=i-e,a=this._keySchedule[r-(e%4?0:4)],this._invKeySchedule[e]=e<4||r<=4?a:c.INV_SUB_MIX[0][c.SBOX[a>>>24]]^c.INV_SUB_MIX[1][c.SBOX[a>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[a>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&a]];return!0},o.prototype.encryptBlock=function(t){t=a(new e(t));var n=this._doCryptBlock(t,this._keySchedule,c.SUB_MIX,c.SBOX),r=new e(16);return r.writeUInt32BE(n[0],0),r.writeUInt32BE(n[1],4),r.writeUInt32BE(n[2],8),r.writeUInt32BE(n[3],12),r},o.prototype.decryptBlock=function(t){t=a(new e(t));var n=[t[3],t[1]];t[1]=n[0],t[3]=n[1];var r=this._doCryptBlock(t,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX),i=new e(16);return i.writeUInt32BE(r[0],0),i.writeUInt32BE(r[3],4),i.writeUInt32BE(r[2],8),i.writeUInt32BE(r[1],12),i},o.prototype.scrub=function(){r(this._keySchedule),r(this._invKeySchedule),r(this._key)},o.prototype._doCryptBlock=function(e,t,r,i){var a,o,s,c,l,u,d,p,f;o=e[0]^t[0],s=e[1]^t[1],c=e[2]^t[2],l=e[3]^t[3],a=4;for(var g=1;g<this._nRounds;g++)u=r[0][o>>>24]^r[1][s>>>16&255]^r[2][c>>>8&255]^r[3][255&l]^t[a++],d=r[0][s>>>24]^r[1][c>>>16&255]^r[2][l>>>8&255]^r[3][255&o]^t[a++],p=r[0][c>>>24]^r[1][l>>>16&255]^r[2][o>>>8&255]^r[3][255&s]^t[a++],f=r[0][l>>>24]^r[1][o>>>16&255]^r[2][s>>>8&255]^r[3][255&c]^t[a++],o=u,s=d,c=p,l=f;return u=(i[o>>>24]<<24|i[s>>>16&255]<<16|i[c>>>8&255]<<8|i[255&l])^t[a++],d=(i[s>>>24]<<24|i[c>>>16&255]<<16|i[l>>>8&255]<<8|i[255&o])^t[a++],p=(i[c>>>24]<<24|i[l>>>16&255]<<16|i[o>>>8&255]<<8|i[255&s])^t[a++],f=(i[l>>>24]<<24|i[o>>>16&255]<<16|i[s>>>8&255]<<8|i[255&c])^t[a++],[n(u),n(d),n(p),n(f)]},t.AES=o}).call(t,n(3).Buffer)},function(e,t){t["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},t["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},t["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},t["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},t["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},t["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},t.aes128=t["aes-128-cbc"],t.aes192=t["aes-192-cbc"],t.aes256=t["aes-256-cbc"],t["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},t["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},t["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},t["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},t["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},t["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},t["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},t["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},t["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},t["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},t["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},t["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},t["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},t["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},t["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},t["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},t["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},t["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},function(e,t,n){(function(e){function r(e){for(var t,n=e.length;n--;){if(255!==(t=e.readUInt8(n))){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}function i(e){var t=e._cipher.encryptBlock(e._prev);return r(e._prev),t}var a=n(74);t.encrypt=function(t,n){for(;t._cache.length<n.length;)t._cache=e.concat([t._cache,i(t)]);var r=t._cache.slice(0,n.length);return t._cache=t._cache.slice(n.length),a(n,r)}}).call(t,n(3).Buffer)},function(e,t,n){"use strict";var r=t;r.base=n(624),r.short=n(625),r.mont=n(626),r.edwards=n(627)},function(e,t,n){(function(t){function r(e){var n;"object"!=typeof e||t.isBuffer(e)||(n=e.passphrase,e=e.key),"string"==typeof e&&(e=new t(e));var r,o,c=s(e,n),l=c.tag,u=c.data;switch(l){case"PUBLIC KEY":switch(o=a.PublicKey.decode(u,"der"),r=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPublicKey.decode(o.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return o.subjectPrivateKey=o.subjectPublicKey,{type:"ec",data:o};case"1.2.840.10040.4.1":return o.algorithm.params.pub_key=a.DSAparam.decode(o.subjectPublicKey.data,"der"),{type:"dsa",data:o.algorithm.params};default:throw new Error("unknown key id "+r)}throw new Error("unknown key type "+l);case"ENCRYPTED PRIVATE KEY":u=a.EncryptedPrivateKey.decode(u,"der"),u=i(u,n);case"PRIVATE KEY":switch(o=a.PrivateKey.decode(u,"der"),r=o.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPrivateKey.decode(o.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:o.algorithm.curve,privateKey:a.ECPrivateKey.decode(o.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return o.algorithm.params.priv_key=a.DSAparam.decode(o.subjectPrivateKey,"der"),{type:"dsa",params:o.algorithm.params};default:throw new Error("unknown key id "+r)}throw new Error("unknown key type "+l);case"RSA PUBLIC KEY":return a.RSAPublicKey.decode(u,"der");case"RSA PRIVATE KEY":return a.RSAPrivateKey.decode(u,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:a.DSAPrivateKey.decode(u,"der")};case"EC PRIVATE KEY":return u=a.ECPrivateKey.decode(u,"der"),{curve:u.parameters.value,privateKey:u.privateKey};default:throw new Error("unknown key type "+l)}}function i(e,n){var r=e.algorithm.decrypt.kde.kdeparams.salt,i=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),a=o[e.algorithm.decrypt.cipher.algo.join(".")],s=e.algorithm.decrypt.cipher.iv,u=e.subjectPrivateKey,d=parseInt(a.split("-")[1],10)/8,p=l.pbkdf2Sync(n,r,i,d),f=c.createDecipheriv(a,p,s),g=[];return g.push(f.update(u)),g.push(f.final()),t.concat(g)}var a=n(636),o=n(647),s=n(648),c=n(144),l=n(201);e.exports=r,r.signature=a.signature}).call(t,n(3).Buffer)},,function(e,t,n){var r=n(8),i=n(5).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var r=n(5),i=n(30),a=n(40),o=n(156),s=n(12).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var r=n(78)("keys"),i=n(43);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(5).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(8),i=n(4),a=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(27)(Function.call,n(25).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(8),i=n(106).set;e.exports=function(e,t,n){var a,o=t.constructor;return o!==n&&"function"==typeof o&&(a=o.prototype)!==n.prototype&&r(a)&&i&&i(e,a),e}},function(e,t,n){"use strict";var r=n(33),i=n(32);e.exports=function(e){var t=String(i(this)),n="",a=r(e);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(33),i=n(32);e.exports=function(e){return function(t,n){var a,o,s=String(i(t)),c=r(n),l=s.length;return c<0||c>=l?e?"":void 0:(a=s.charCodeAt(c),a<55296||a>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):a:e?s.slice(c,c+2):o-56320+(a-55296<<10)+65536)}}},function(e,t,n){"use strict";var r=n(40),i=n(1),a=n(21),o=n(20),s=n(58),c=n(114),l=n(56),u=n(26),d=n(10)("iterator"),p=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,g,m,h,b){c(n,t,g);var v,E,S,y=function(e){if(!p&&e in w)return w[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},A=t+" Iterator",C="values"==m,_=!1,w=e.prototype,T=w[d]||w["@@iterator"]||m&&w[m],R=T||y(m),O=m?C?y("entries"):R:void 0,k="Array"==t?w.entries||T:T;if(k&&(S=u(k.call(new e)))!==Object.prototype&&S.next&&(l(S,A,!0),r||"function"==typeof S[d]||o(S,d,f)),C&&T&&"values"!==T.name&&(_=!0,R=function(){return T.call(this)}),r&&!b||!p&&!_&&w[d]||o(w,d,R),s[t]=R,s[A]=f,m)if(v={values:C?R:y("values"),keys:h?R:y("keys"),entries:O},b)for(E in v)E in w||a(w,E,v[E]);else i(i.P+i.F*(p||_),t,v);return v}},function(e,t,n){"use strict";var r=n(46),i=n(42),a=n(56),o={};n(20)(o,n(10)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(82),i=n(32);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(10)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(58),i=n(10)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[i]===e)}},function(e,t,n){"use strict";var r=n(12),i=n(42);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(71),i=n(10)("iterator"),a=n(58);e.exports=n(30).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||a[r(e)]}},function(e,t,n){var r=n(332);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(15),i=n(45),a=n(13);e.exports=function(e){for(var t=r(this),n=a(t.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,l=void 0===c?n:i(c,n);l>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(41),i=n(172),a=n(58),o=n(24);e.exports=n(113)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r,i,a,o=n(27),s=n(162),c=n(105),l=n(101),u=n(5),d=u.process,p=u.setImmediate,f=u.clearImmediate,g=u.MessageChannel,m=u.Dispatch,h=0,b={},v=function(){var e=+this;if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}},E=function(e){v.call(e.data)};p&&f||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return b[++h]=function(){s("function"==typeof e?e:Function(e),t)},r(h),h},f=function(e){delete b[e]},"process"==n(28)(d)?r=function(e){d.nextTick(o(v,e,1))}:m&&m.now?r=function(e){m.now(o(v,e,1))}:g?(i=new g,a=i.port2,i.port1.onmessage=E,r=o(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",E,!1)):r="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:p,clear:f}},function(e,t,n){var r=n(5),i=n(123).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,c="process"==n(28)(o);e.exports=function(){var e,t,n,l=function(){var r,i;for(c&&(r=o.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){o.nextTick(l)};else if(!a||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(l)}}else n=function(){i.call(r,l)};else{var d=!0,p=document.createTextNode("");new a(l).observe(p,{characterData:!0}),n=function(){p.data=d=!d}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=i(t),this.reject=i(n)}var i=n(18);e.exports.f=function(e){return new r(e)}},function(e,t,n){"use strict";function r(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,c=(1<<s)-1,l=c>>1,u=23===t?B(2,-24)-B(2,-77):0,d=0,p=e<0||0===e&&1/e<0?1:0;for(e=j(e),e!=e||e===x?(i=e!=e?1:0,r=c):(r=F(U(e)/K),e*(a=B(2,-r))<1&&(r--,a*=2),e+=r+l>=1?u/a:u*B(2,1-l),e*a>=2&&(r++,a/=2),r+l>=c?(i=0,r=c):r+l>=1?(i=(e*a-1)*B(2,t),r+=l):(i=e*B(2,l-1)*B(2,t),r=0));t>=8;o[d++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[d++]=255&r,r/=256,s-=8);return o[--d]|=128*p,o}function i(e,t,n){var r,i=8*n-t-1,a=(1<<i)-1,o=a>>1,s=i-7,c=n-1,l=e[c--],u=127&l;for(l>>=7;s>0;u=256*u+e[c],c--,s-=8);for(r=u&(1<<-s)-1,u>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===u)u=1-o;else{if(u===a)return r?NaN:l?-x:x;r+=B(2,t),u-=o}return(l?-1:1)*r*B(2,u-t)}function a(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function o(e){return[255&e]}function s(e){return[255&e,e>>8&255]}function c(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function l(e){return r(e,52,8)}function u(e){return r(e,23,4)}function d(e,t,n){T(e[k],t,{get:function(){return this[n]}})}function p(e,t,n,r){var i=+n,a=_(i);if(a+t>e[G])throw L(I);var o=e[V]._b,s=a+e[Y],c=o.slice(s,s+t);return r?c:c.reverse()}function f(e,t,n,r,i,a){var o=+n,s=_(o);if(s+t>e[G])throw L(I);for(var c=e[V]._b,l=s+e[Y],u=r(+i),d=0;d<t;d++)c[l+d]=u[a?d:t-d-1]}var g=n(5),m=n(11),h=n(40),b=n(89),v=n(20),E=n(51),S=n(7),y=n(49),A=n(33),C=n(13),_=n(181),w=n(47).f,T=n(12).f,R=n(121),O=n(56),k="prototype",I="Wrong index!",P=g.ArrayBuffer,N=g.DataView,M=g.Math,L=g.RangeError,x=g.Infinity,D=P,j=M.abs,B=M.pow,F=M.floor,U=M.log,K=M.LN2,V=m?"_b":"buffer",G=m?"_l":"byteLength",Y=m?"_o":"byteOffset";if(b.ABV){if(!S(function(){P(1)})||!S(function(){new P(-1)})||S(function(){return new P,new P(1.5),new P(NaN),"ArrayBuffer"!=P.name})){P=function(e){return y(this,P),new D(_(e))};for(var W,z=P[k]=D[k],$=w(D),H=0;$.length>H;)(W=$[H++])in P||v(P,W,D[W]);h||(z.constructor=P)}var q=new N(new P(2)),J=N[k].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||E(N[k],{setInt8:function(e,t){J.call(this,e,t<<24>>24)},setUint8:function(e,t){J.call(this,e,t<<24>>24)}},!0)}else P=function(e){y(this,P,"ArrayBuffer");var t=_(e);this._b=R.call(new Array(t),0),this[G]=t},N=function(e,t,n){y(this,N,"DataView"),y(e,P,"DataView");var r=e[G],i=A(t);if(i<0||i>r)throw L("Wrong offset!");if(n=void 0===n?r-i:C(n),i+n>r)throw L("Wrong length!");this[V]=e,this[Y]=i,this[G]=n},m&&(d(P,"byteLength","_l"),d(N,"buffer","_b"),d(N,"byteLength","_l"),d(N,"byteOffset","_o")),E(N[k],{getInt8:function(e){return p(this,1,e)[0]<<24>>24},getUint8:function(e){return p(this,1,e)[0]},getInt16:function(e){var t=p(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=p(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return a(p(this,4,e,arguments[1]))},getUint32:function(e){return a(p(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return i(p(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return i(p(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){f(this,1,e,o,t)},setUint8:function(e,t){f(this,1,e,o,t)},setInt16:function(e,t){f(this,2,e,s,t,arguments[2])},setUint16:function(e,t){f(this,2,e,s,t,arguments[2])},setInt32:function(e,t){f(this,4,e,c,t,arguments[2])},setUint32:function(e,t){f(this,4,e,c,t,arguments[2])},setFloat32:function(e,t){f(this,4,e,u,t,arguments[2])},setFloat64:function(e,t){f(this,8,e,l,t,arguments[2])}});O(P,"ArrayBuffer"),O(N,"DataView"),v(N[k],b.VIEW,!0),t.ArrayBuffer=P,t.DataView=N},,,,,,,,,,,,function(e,t,n){"use strict";(function(t){function n(e){for(var n=new Array(arguments.length-1),r=0;r<n.length;)n[r++]=arguments[r];t.nextTick(function(){e.apply(null,n)})}!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=n:e.exports=t.nextTick}).call(t,n(60))},function(e,t,n){"use strict";(function(e){var r=n(3),i=r.Buffer,a=r.SlowBuffer,o=r.kMaxLength||2147483647;t.alloc=function(e,t,n){if("function"==typeof i.alloc)return i.alloc(e,t,n);if("number"==typeof n)throw new TypeError("encoding must not be number");if("number"!=typeof e)throw new TypeError("size must be a number");if(e>o)throw new RangeError("size is too large");var r=n,a=t;void 0===a&&(r=void 0,a=0);var s=new i(e);if("string"==typeof a)for(var c=new i(a,r),l=c.length,u=-1;++u<e;)s[u]=c[u%l];else s.fill(a);return s},t.allocUnsafe=function(e){if("function"==typeof i.allocUnsafe)return i.allocUnsafe(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>o)throw new RangeError("size is too large");return new i(e)},t.from=function(t,n,r){if("function"==typeof i.from&&(!e.Uint8Array||Uint8Array.from!==i.from))return i.from(t,n,r);if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("string"==typeof t)return new i(t,n);if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var a=n;if(1===arguments.length)return new i(t);void 0===a&&(a=0);var o=r;if(void 0===o&&(o=t.byteLength-a),a>=t.byteLength)throw new RangeError("'offset' is out of bounds");if(o>t.byteLength-a)throw new RangeError("'length' is out of bounds");return new i(t.slice(a,a+o))}if(i.isBuffer(t)){var s=new i(t.length);return t.copy(s,0,0,t.length),s}if(t){if(Array.isArray(t)||"undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return new i(t);if("Buffer"===t.type&&Array.isArray(t.data))return new i(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},t.allocUnsafeSlow=function(e){if("function"==typeof i.allocUnsafeSlow)return i.allocUnsafeSlow(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(e>=o)throw new RangeError("size is too large");return new a(e)}}).call(t,n(36))},function(e,t,n){"use strict";(function(t,r){function i(){}function a(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function o(e,t){P=P||n(52),e=e||{},this.objectMode=!!e.objectMode,t instanceof P&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){m(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new C(this)}function s(e){if(P=P||n(52),!(this instanceof s||this instanceof P))return new s(e);this._writableState=new o(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),R.call(this)}function c(e,t){var n=new Error("write after end");e.emit("error",n),_(t,n)}function l(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):k.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),_(r,a),i=!1),i}function u(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=I.from(t,n)),t}function d(e,t,n,r,i){n=u(t,n,r),k.isBuffer(n)&&(r="buffer");var o=t.objectMode?1:n.length;t.length+=o;var s=t.length<t.highWaterMark;if(s||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest=new a(n,r,i),c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else p(e,t,!1,o,n,r,i);return s}function p(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function f(e,t,n,r,i){--t.pendingcb,n?_(i,r):i(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function m(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(g(n),t)f(e,n,r,t,i);else{var a=E(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||v(e,n),r?w(h,e,n,a,i):h(e,n,a,i)}}function h(e,t,n,r){n||b(e,t),t.pendingcb--,r(),y(e,t)}function b(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function v(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var o=0;n;)i[o]=n,n=n.next,o+=1;p(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new C(t)}else{for(;n;){var s=n.chunk,c=n.encoding,l=n.callback;if(p(e,t,!1,t.objectMode?1:s.length,s,c,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function y(e,t){var n=E(t);return n&&(0===t.pendingcb?(S(e,t),t.finished=!0,e.emit("finish")):S(e,t)),n}function A(e,t,n){t.ending=!0,y(e,t),n&&(t.finished?_(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function C(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}e.exports=s;var _=n(138),w=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:_;s.WritableState=o;var T=n(73);T.inherits=n(65);var R,O={deprecate:n(594)};!function(){try{R=n(64)}catch(e){}finally{R||(R=n(93).EventEmitter)}}();var k=n(3).Buffer,I=n(139);T.inherits(s,R);var P;o.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(o.prototype,"buffer",{get:O.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var P;s.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},s.prototype.write=function(e,t,n){var r=this._writableState,a=!1;return"function"==typeof t&&(n=t,t=null),k.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=i),r.ended?c(this,n):l(this,r,e,n)&&(r.pendingcb++,a=d(this,r,e,t,n)),a},s.prototype.cork=function(){this._writableState.corked++},s.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||v(this,e))},s.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},s.prototype._write=function(e,t,n){n(new Error("not implemented"))},s.prototype._writev=null,s.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||A(this,r,n)}}).call(t,n(60),n(198).setImmediate)},function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function a(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function o(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var s=n(3).Buffer,c=s.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},l=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=a;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=o;break;default:return void(this.write=i)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),e.copy(this.charBuffer,0,0,a),t.substring(0,i)}return t},l.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},l.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);s.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){o(t,e)}):o(t)})}function o(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}e.exports=a;var s=n(52),c=n(73);c.inherits=n(65),c.inherits(a,s),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("Not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,n){"use strict";(function(t){function r(e,n){o.call(this),e=e.toLowerCase(),"string"==typeof n&&(n=new t(n));var r="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=n,n.length>r?n=i(e).update(n).digest():n.length<r&&(n=t.concat([n,s],r));for(var a=this._ipad=new t(r),c=this._opad=new t(r),l=0;l<r;l++)a[l]=54^n[l],c[l]=92^n[l];this._hash=i(e).update(a)}var i=n(61),a=n(9),o=n(64).Transform,s=new t(128);s.fill(0),a(r,o),r.prototype.update=function(e,t){return this._hash.update(e,t),this},r.prototype._transform=function(e,t,n){this._hash.update(e),n()},r.prototype._flush=function(e){this.push(this.digest()),e()},r.prototype.digest=function(e){var t=this._hash.digest();return i(this._alg).update(this._opad).update(t).digest(e)},e.exports=function(e,t){return new r(e,t)}}).call(t,n(3).Buffer)},function(e,t,n){function r(){return Object.keys(o)}var i=n(600);t.createCipher=t.Cipher=i.createCipher,t.createCipheriv=t.Cipheriv=i.createCipheriv;var a=n(602);t.createDecipher=t.Decipher=a.createDecipher,t.createDecipheriv=t.Decipheriv=a.createDecipheriv;var o=n(96);t.listCiphers=t.getCiphers=r},function(e,t,n){"use strict";t.utils=n(604),t.Cipher=n(605),t.DES=n(606),t.CBC=n(607),t.EDE=n(608)},function(e,t,n){(function(t){function r(e){var t=a(e);return{blinder:t.toRed(o.mont(e.modulus)).redPow(new o(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}function i(e,n){var i=r(n),a=n.modulus.byteLength(),s=(o.mont(n.modulus),new o(e).mul(i.blinder).umod(n.modulus)),c=s.toRed(o.mont(n.prime1)),l=s.toRed(o.mont(n.prime2)),u=n.coefficient,d=n.prime1,p=n.prime2,f=c.redPow(n.exponent1),g=l.redPow(n.exponent2);f=f.fromRed(),g=g.fromRed();var m=f.isub(g).imul(u).umod(d);return m.imul(p),g.iadd(m),new t(g.imul(i.unblinder).umod(n.modulus).toArray(!1,a))}function a(e){for(var t=e.modulus.byteLength(),n=new o(s(t));n.cmp(e.modulus)>=0||!n.umod(e.prime1)||!n.umod(e.prime2);)n=new o(s(t));return n}var o=n(14),s=n(72);e.exports=i,i.getr=a}).call(t,n(3).Buffer)},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(67)),r(n(68)),r(n(221)),r(n(222)),r(n(224)),r(n(225)),r(n(226))},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(77),a=n(54),o=n(17),s=n(228),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isWorking=!1,t}return r(t,e),t.prototype.cancel=function(){this.loadSourcePage()},t.prototype.performAction=function(){var e=this;this.isWorking=!0,this.actionError=null,this.actionApiCall().then(function(){e.setSuccessParams(),e.loadSourcePage()}).catch(function(t){e.actionError=i.jobErrorAlert.get(e.actionType,t,e.$translate)}).finally(function(){e.isWorking=!1})},t.prototype.afterLoadJob=function(e){this.isValidJob(e)||this.loadJobDetailPage()},t.prototype.actionApiCall=function(){throw new Error("performAction not implemented")},t.prototype.isValidJob=function(e){return a.jobHelpers.isJobConsoleActionEnabled(this.actionType,e)},t.prototype.setSuccessParams=function(){this.$location.search(o.S3Constants.JOB_ID_PARAM,this.jobId),this.$location.search(o.S3Constants.ACTION_SUCCESS_PARAM,this.actionType)},t.prototype.loadSourcePage=function(){var e=this.getSourcePagePath();this.$location.search(o.S3Constants.SOURCE_PAGE_PARAM,null),this.$location.path(e)},t.prototype.loadJobDetailPage=function(){this.$location.path(a.jobHelpers.getJobPath(this.jobId))},t.prototype.getSourcePagePath=function(){switch(this.$location.search()[o.S3Constants.SOURCE_PAGE_PARAM]){case"detail":return a.jobHelpers.getJobPath(this.jobId);default:return"/"+o.S3Constants.PATH_SEGMENTS.JOBS}},t}(s.JobDetailBaseController);t.JobActionController=c},,,,,,,function(e,t,n){e.exports=!n(11)&&!n(7)(function(){return 7!=Object.defineProperty(n(101)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){t.f=n(10)},function(e,t,n){var r=n(23),i=n(24),a=n(79)(!1),o=n(103)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~a(l,n)||l.push(n));return l}},function(e,t,n){var r=n(12),i=n(4),a=n(44);e.exports=n(11)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,c=0;s>c;)r.f(e,n=o[c++],t[n]);return e}},function(e,t,n){var r=n(24),i=n(47).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?s(e):i(r(e))}},function(e,t,n){"use strict";var r=n(44),i=n(80),a=n(70),o=n(15),s=n(69),c=Object.assign;e.exports=!c||n(7)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=r})?function(e,t){for(var n=o(e),c=arguments.length,l=1,u=i.f,d=a.f;c>l;)for(var p,f=s(arguments[l++]),g=u?r(f).concat(u(f)):r(f),m=g.length,h=0;m>h;)d.call(f,p=g[h++])&&(n[p]=f[p]);return n}:c},function(e,t,n){"use strict";var r=n(18),i=n(8),a=n(162),o=[].slice,s={},c=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?c(t,r.length,r):a(t,r,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(5).parseInt,i=n(57).trim,a=n(107),o=/^[-+]?0[xX]/;e.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(o.test(n)?16:10))}:r},function(e,t,n){var r=n(5).parseFloat,i=n(57).trim;e.exports=1/r(n(107)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(28);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(8),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var r=n(110),i=Math.pow,a=i(2,-52),o=i(2,-23),s=i(2,127)*(2-o),c=i(2,-126),l=function(e){return e+1/a-1/a};e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),u=r(e);return i<c?u*l(i/c/o)*c*o:(t=(1+o/a)*i,n=t-(t-i),n>s||n!=n?u*(1/0):u*n)}},function(e,t,n){var r=n(4);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,n){var r=n(18),i=n(15),a=n(69),o=n(13);e.exports=function(e,t,n,s,c){r(t);var l=i(e),u=a(l),d=o(l.length),p=c?d-1:0,f=c?-1:1;if(n<2)for(;;){if(p in u){s=u[p],p+=f;break}if(p+=f,c?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;c?p>=0:d>p;p+=f)p in u&&(s=t(s,u[p],p,l));return s}},function(e,t,n){"use strict";var r=n(15),i=n(45),a=n(13);e.exports=[].copyWithin||function(e,t){var n=r(this),o=a(n.length),s=i(e,o),c=i(t,o),l=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===l?o:i(l,o))-c,o-s),d=1;for(c<s&&s<c+u&&(d=-1,c+=u-1,s+=u-1);u-- >0;)c in n?n[s]=n[c]:delete n[s],s+=d,c+=d;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(11)&&"g"!=/./g.flags&&n(12).f(RegExp.prototype,"flags",{configurable:!0,get:n(84)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(4),i=n(8),a=n(125);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(177),i=n(59);e.exports=n(88)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(12).f,i=n(46),a=n(51),o=n(27),s=n(49),c=n(50),l=n(113),u=n(172),d=n(48),p=n(11),f=n(39).fastKey,g=n(59),m=p?"_s":"size",h=function(e,t){var n,r=f(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var u=e(function(e,r){s(e,u,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=r&&c(r,n,e[l],e)});return a(u.prototype,{clear:function(){for(var e=g(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=g(this,t),r=h(n,e);if(r){var i=r.n,a=r.p;delete n._i[r.i],r.r=!0,a&&(a.n=i),i&&(i.p=a),n._f==r&&(n._f=i),n._l==r&&(n._l=a),n[m]--}return!!r},forEach:function(e){g(this,t);for(var n,r=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!h(g(this,t),e)}}),p&&r(u.prototype,"size",{get:function(){return g(this,t)[m]}}),u},def:function(e,t,n){var r,i,a=h(e,t);return a?a.v=n:(e._l=a={i:i=f(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[m]++,"F"!==i&&(e._i[i]=a)),e},getEntry:h,setStrong:function(e,t,n){l(e,t,function(e,n){this._t=g(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var r=n(177),i=n(59);e.exports=n(88)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(35)(0),a=n(21),o=n(39),s=n(160),c=n(180),l=n(8),u=n(7),d=n(59),p=o.getWeak,f=Object.isExtensible,g=c.ufstore,m={},h=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(e){if(l(e)){var t=p(e);return!0===t?g(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(d(this,"WeakMap"),e,t)}},v=e.exports=n(88)("WeakMap",h,b,c,!0,!0);u(function(){return 7!=(new v).set((Object.freeze||Object)(m),7).get(m)})&&(r=c.getConstructor(h,"WeakMap"),s(r.prototype,b),o.NEED=!0,i(["delete","has","get","set"],function(e){var t=v.prototype,n=t[e];a(t,e,function(t,i){if(l(t)&&!f(t)){this._f||(this._f=new r);var a=this._f[e](t,i);return"set"==e?this:a}return n.call(this,t,i)})}))},function(e,t,n){"use strict";var r=n(51),i=n(39).getWeak,a=n(4),o=n(8),s=n(49),c=n(50),l=n(35),u=n(23),d=n(59),p=l(5),f=l(6),g=0,m=function(e){return e._l||(e._l=new h)},h=function(){this.a=[]},b=function(e,t){return p(e.a,function(e){return e[0]===t})};h.prototype={get:function(e){var t=b(this,e);if(t)return t[1]},has:function(e){return!!b(this,e)},set:function(e,t){var n=b(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,a){var l=e(function(e,r){s(e,l,t,"_i"),e._t=t,e._i=g++,e._l=void 0,void 0!=r&&c(r,n,e[a],e)});return r(l.prototype,{delete:function(e){if(!o(e))return!1;var n=i(e);return!0===n?m(d(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!o(e))return!1;var n=i(e);return!0===n?m(d(this,t)).has(e):n&&u(n,this._i)}}),l},def:function(e,t,n){var r=i(a(t),!0);return!0===r?m(e).set(t,n):r[e._i]=n,e},ufstore:m}},function(e,t,n){var r=n(33),i=n(13);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(47),i=n(80),a=n(4),o=n(5).Reflect;e.exports=o&&o.ownKeys||function(e){var t=r.f(a(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";function r(e,t,n,l,u,d,p,f){for(var g,m,h=u,b=0,v=!!p&&s(p,f,3);b<l;){if(b in n){if(g=v?v(n[b],b,t):n[b],m=!1,a(g)&&(m=g[c],m=void 0!==m?!!m:i(g)),m&&d>0)h=r(e,t,g,o(g.length),h,d-1)-1;else{if(h>=9007199254740991)throw TypeError();e[h]=g}h++}b++}return h}var i=n(81),a=n(8),o=n(13),s=n(27),c=n(10)("isConcatSpreadable");e.exports=r},function(e,t,n){var r=n(13),i=n(109),a=n(32);e.exports=function(e,t,n,o){var s=String(a(e)),c=s.length,l=void 0===n?" ":String(n),u=r(t);if(u<=c||""==l)return s;var d=u-c,p=i.call(l,Math.ceil(d/l.length));return p.length>d&&(p=p.slice(0,d)),o?p+s:s+p}},function(e,t,n){var r=n(44),i=n(24),a=n(70).f;e.exports=function(e){return function(t){for(var n,o=i(t),s=r(o),c=s.length,l=0,u=[];c>l;)a.call(o,n=s[l++])&&u.push(e?[n,o[n]]:o[n]);return u}}},function(e,t,n){var r=n(71),i=n(187);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){var r=n(50);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t){e.exports=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}},,,,,function(e,t,n){"use strict";t.randomBytes=t.rng=t.pseudoRandomBytes=t.prng=n(72),t.createHash=t.Hash=n(61),t.createHmac=t.Hmac=n(143);var r=n(200),i=Object.keys(r),a=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i);t.getHashes=function(){return a};var o=n(201);t.pbkdf2=o.pbkdf2,t.pbkdf2Sync=o.pbkdf2Sync;var s=n(599);t.Cipher=s.Cipher,t.createCipher=s.createCipher,t.Cipheriv=s.Cipheriv,t.createCipheriv=s.createCipheriv,t.Decipher=s.Decipher,t.createDecipher=s.createDecipher,t.Decipheriv=s.Decipheriv,t.createDecipheriv=s.createDecipheriv,t.getCiphers=s.getCiphers,t.listCiphers=s.listCiphers;var c=n(610);t.DiffieHellmanGroup=c.DiffieHellmanGroup,t.createDiffieHellmanGroup=c.createDiffieHellmanGroup,t.getDiffieHellman=c.getDiffieHellman,t.createDiffieHellman=c.createDiffieHellman,t.DiffieHellman=c.DiffieHellman;var l=n(614);t.createSign=l.createSign,t.Sign=l.Sign,t.createVerify=l.createVerify,t.Verify=l.Verify,t.createECDH=n(650);var u=n(651);t.publicEncrypt=u.publicEncrypt,t.privateEncrypt=u.privateEncrypt,t.publicDecrypt=u.publicDecrypt,t.privateDecrypt=u.privateDecrypt,t.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},t.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,i=-1732584194,u=271733878,d=0;d<e.length;d+=16){var p=n,f=r,g=i,m=u;n=a(n,r,i,u,e[d+0],7,-680876936),u=a(u,n,r,i,e[d+1],12,-389564586),i=a(i,u,n,r,e[d+2],17,606105819),r=a(r,i,u,n,e[d+3],22,-1044525330),n=a(n,r,i,u,e[d+4],7,-176418897),u=a(u,n,r,i,e[d+5],12,1200080426),i=a(i,u,n,r,e[d+6],17,-1473231341),r=a(r,i,u,n,e[d+7],22,-45705983),n=a(n,r,i,u,e[d+8],7,1770035416),u=a(u,n,r,i,e[d+9],12,-1958414417),i=a(i,u,n,r,e[d+10],17,-42063),r=a(r,i,u,n,e[d+11],22,-1990404162),n=a(n,r,i,u,e[d+12],7,1804603682),u=a(u,n,r,i,e[d+13],12,-40341101),i=a(i,u,n,r,e[d+14],17,-1502002290),r=a(r,i,u,n,e[d+15],22,1236535329),n=o(n,r,i,u,e[d+1],5,-165796510),u=o(u,n,r,i,e[d+6],9,-1069501632),i=o(i,u,n,r,e[d+11],14,643717713),r=o(r,i,u,n,e[d+0],20,-373897302),n=o(n,r,i,u,e[d+5],5,-701558691),u=o(u,n,r,i,e[d+10],9,38016083),i=o(i,u,n,r,e[d+15],14,-660478335),r=o(r,i,u,n,e[d+4],20,-405537848),n=o(n,r,i,u,e[d+9],5,568446438),u=o(u,n,r,i,e[d+14],9,-1019803690),i=o(i,u,n,r,e[d+3],14,-187363961),r=o(r,i,u,n,e[d+8],20,1163531501),n=o(n,r,i,u,e[d+13],5,-1444681467),u=o(u,n,r,i,e[d+2],9,-51403784),i=o(i,u,n,r,e[d+7],14,1735328473),r=o(r,i,u,n,e[d+12],20,-1926607734),n=s(n,r,i,u,e[d+5],4,-378558),u=s(u,n,r,i,e[d+8],11,-2022574463),i=s(i,u,n,r,e[d+11],16,1839030562),r=s(r,i,u,n,e[d+14],23,-35309556),n=s(n,r,i,u,e[d+1],4,-1530992060),u=s(u,n,r,i,e[d+4],11,1272893353),i=s(i,u,n,r,e[d+7],16,-155497632),r=s(r,i,u,n,e[d+10],23,-1094730640),n=s(n,r,i,u,e[d+13],4,681279174),u=s(u,n,r,i,e[d+0],11,-358537222),i=s(i,u,n,r,e[d+3],16,-722521979),r=s(r,i,u,n,e[d+6],23,76029189),n=s(n,r,i,u,e[d+9],4,-640364487),u=s(u,n,r,i,e[d+12],11,-421815835),i=s(i,u,n,r,e[d+15],16,530742520),r=s(r,i,u,n,e[d+2],23,-995338651),n=c(n,r,i,u,e[d+0],6,-198630844),u=c(u,n,r,i,e[d+7],10,1126891415),i=c(i,u,n,r,e[d+14],15,-1416354905),r=c(r,i,u,n,e[d+5],21,-57434055),n=c(n,r,i,u,e[d+12],6,1700485571),u=c(u,n,r,i,e[d+3],10,-1894986606),i=c(i,u,n,r,e[d+10],15,-1051523),r=c(r,i,u,n,e[d+1],21,-2054922799),n=c(n,r,i,u,e[d+8],6,1873313359),u=c(u,n,r,i,e[d+15],10,-30611744),i=c(i,u,n,r,e[d+6],15,-1560198380),r=c(r,i,u,n,e[d+13],21,1309151649),n=c(n,r,i,u,e[d+4],6,-145523070),u=c(u,n,r,i,e[d+11],10,-1120210379),i=c(i,u,n,r,e[d+2],15,718787259),r=c(r,i,u,n,e[d+9],21,-343485551),n=l(n,p),r=l(r,f),i=l(i,g),u=l(u,m)}return Array(n,r,i,u)}function i(e,t,n,r,i,a){return l(u(l(l(t,e),l(r,a)),i),n)}function a(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)}function o(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)}function s(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)}function c(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)}function l(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function u(e,t){return e<<t|e>>>32-t}var d=n(582);e.exports=function(e){return d.hash(e,r,16)}},function(e,t,n){(function(t){function r(){this.init(),this._w=f,d.call(this,64,56)}function i(e,t,n){return n^e&(t^n)}function a(e,t,n){return e&t|n&(e|t)}function o(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function s(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function c(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function l(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}var u=n(9),d=n(62),p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=new Array(64);u(r,d),r.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,u=0|this._c,d=0|this._d,f=0|this._e,g=0|this._f,m=0|this._g,h=0|this._h,b=0;b<16;++b)t[b]=e.readInt32BE(4*b);for(;b<64;++b)t[b]=l(t[b-2])+t[b-7]+c(t[b-15])+t[b-16]|0;for(var v=0;v<64;++v){var E=h+s(f)+i(f,g,m)+p[v]+t[v]|0,S=o(n)+a(n,r,u)|0;h=m,m=g,g=f,f=d+E|0,d=u,u=r,r=n,n=E+S|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=u+this._c|0,this._d=d+this._d|0,this._e=f+this._e|0,this._f=g+this._f|0,this._g=m+this._g|0,this._h=h+this._h|0},r.prototype._hash=function(){var e=new t(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(){this.init(),this._w=h,g.call(this,128,112)}function i(e,t,n){return n^e&(t^n)}function a(e,t,n){return e&t|n&(e|t)}function o(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function s(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function c(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function l(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function u(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function d(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function p(e,t){return e>>>0<t>>>0?1:0}var f=n(9),g=n(62),m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],h=new Array(160);f(r,g),r.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,f=0|this._ch,g=0|this._dh,h=0|this._eh,b=0|this._fh,v=0|this._gh,E=0|this._hh,S=0|this._al,y=0|this._bl,A=0|this._cl,C=0|this._dl,_=0|this._el,w=0|this._fl,T=0|this._gl,R=0|this._hl,O=0;O<32;O+=2)t[O]=e.readInt32BE(4*O),t[O+1]=e.readInt32BE(4*O+4);for(;O<160;O+=2){var k=t[O-30],I=t[O-30+1],P=c(k,I),N=l(I,k);k=t[O-4],I=t[O-4+1];var M=u(k,I),L=d(I,k),x=t[O-14],D=t[O-14+1],j=t[O-32],B=t[O-32+1],F=N+D|0,U=P+x+p(F,N)|0;F=F+L|0,U=U+M+p(F,L)|0,F=F+B|0,U=U+j+p(F,B)|0,t[O]=U,t[O+1]=F}for(var K=0;K<160;K+=2){U=t[K],F=t[K+1];var V=a(n,r,f),G=a(S,y,A),Y=o(n,S),W=o(S,n),z=s(h,_),$=s(_,h),H=m[K],q=m[K+1],J=i(h,b,v),X=i(_,w,T),Z=R+$|0,Q=E+z+p(Z,R)|0;Z=Z+X|0,Q=Q+J+p(Z,X)|0,Z=Z+q|0,Q=Q+H+p(Z,q)|0,Z=Z+F|0,Q=Q+U+p(Z,F)|0;var ee=W+G|0,te=Y+V+p(ee,W)|0;E=v,R=T,v=b,T=w,b=h,w=_,_=C+Z|0,h=g+Q+p(_,C)|0,g=f,C=A,f=r,A=y,r=n,y=S,S=Z+ee|0,n=Q+te+p(S,Z)|0}this._al=this._al+S|0,this._bl=this._bl+y|0,this._cl=this._cl+A|0,this._dl=this._dl+C|0,this._el=this._el+_|0,this._fl=this._fl+w|0,this._gl=this._gl+T|0,this._hl=this._hl+R|0,this._ah=this._ah+n+p(this._al,S)|0,this._bh=this._bh+r+p(this._bl,y)|0,this._ch=this._ch+f+p(this._cl,A)|0,this._dh=this._dh+g+p(this._dl,C)|0,this._eh=this._eh+h+p(this._el,_)|0,this._fh=this._fh+b+p(this._fl,w)|0,this._gh=this._gh+v+p(this._gl,T)|0,this._hh=this._hh+E+p(this._hl,R)|0},r.prototype._hash=function(){function e(e,t,r){n.writeInt32BE(e,r),n.writeInt32BE(t,r+4)}var n=new t(64);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),n},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){"use strict";(function(t){function r(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?I(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function i(e,t){U=U||n(52),e=e||{},this.objectMode=!!e.objectMode,t instanceof U&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new F,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(B||(B=n(141).StringDecoder),this.decoder=new B(e.encoding),this.encoding=e.encoding)}function a(e){if(U=U||n(52),!(this instanceof a))return new a(e);this._readableState=new i(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),P.call(this)}function o(e,t,n,r,i){var a=u(t,n);if(a)e.emit("error",a);else if(null===n)t.reading=!1,d(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var o=new Error("stream.push() after EOF");e.emit("error",o)}else if(t.endEmitted&&i){var c=new Error("stream.unshift() after end event");e.emit("error",c)}else{var l;!t.decoder||i||r||(n=t.decoder.write(n),l=!t.objectMode&&0===n.length),i||(t.reading=!1),l||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&p(e))),g(e,t)}else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function c(e){return e>=K?e=K:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function l(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=c(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function u(e,t){var n=null;return M.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function d(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,p(e)}}function p(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(j("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?k(f,e):f(e))}function f(e){j("emit readable"),e.emit("readable"),S(e)}function g(e,t){t.readingMore||(t.readingMore=!0,k(m,e,t))}function m(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(j("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function h(e){return function(){var t=e._readableState;j("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&N(e,"data")&&(t.flowing=!0,S(e))}}function b(e){j("readable nexttick read 0"),e.read(0)}function v(e,t){t.resumeScheduled||(t.resumeScheduled=!0,k(E,e,t))}function E(e,t){t.reading||(j("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),S(e),t.flowing&&!t.reading&&e.read(0)}function S(e){var t=e._readableState;for(j("flow",t.flowing);t.flowing&&null!==e.read(););}function y(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=A(e,t.buffer,t.decoder),n}function A(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?C(e,t):_(e,t),r}function C(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0==(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}function _(e,t){var n=L.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0==(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}function w(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,k(T,t,e))}function T(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function O(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=a;var k=n(138),I=n(590);a.ReadableState=i;var P,N=(n(93).EventEmitter,function(e,t){return e.listeners(t).length});!function(){try{P=n(64)}catch(e){}finally{P||(P=n(93).EventEmitter)}}();var M=n(3).Buffer,L=n(139),x=n(73);x.inherits=n(65);var D=n(591),j=void 0;j=D&&D.debuglog?D.debuglog("stream"):function(){};var B,F=n(592);x.inherits(a,P);var U,U;a.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=L.from(e,t),t=""),o(this,n,e,t,!1)},a.prototype.unshift=function(e){return o(this,this._readableState,e,"",!0)},a.prototype.isPaused=function(){return!1===this._readableState.flowing},a.prototype.setEncoding=function(e){return B||(B=n(141).StringDecoder),this._readableState.decoder=new B(e),this._readableState.encoding=e,this};var K=8388608;a.prototype.read=function(e){j("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return j("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?w(this):p(this),null;if(0===(e=l(e,t))&&t.ended)return 0===t.length&&w(this),null;var r=t.needReadable;j("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,j("length less than watermark",r)),t.ended||t.reading?(r=!1,j("reading or ended",r)):r&&(j("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=l(n,t)));var i;return i=e>0?y(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&w(this)),null!==i&&this.emit("data",i),i},a.prototype._read=function(e){this.emit("error",new Error("not implemented"))},a.prototype.pipe=function(e,n){function i(e){j("onunpipe"),e===p&&o()}function a(){j("onend"),e.end()}function o(){j("cleanup"),e.removeListener("close",l),e.removeListener("finish",u),e.removeListener("drain",b),e.removeListener("error",c),e.removeListener("unpipe",i),p.removeListener("end",a),p.removeListener("end",o),p.removeListener("data",s),v=!0,!f.awaitDrain||e._writableState&&!e._writableState.needDrain||b()}function s(t){j("ondata"),E=!1,!1!==e.write(t)||E||((1===f.pipesCount&&f.pipes===e||f.pipesCount>1&&-1!==O(f.pipes,e))&&!v&&(j("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++,E=!0),p.pause())}function c(t){j("onerror",t),d(),e.removeListener("error",c),0===N(e,"error")&&e.emit("error",t)}function l(){e.removeListener("finish",u),d()}function u(){j("onfinish"),e.removeListener("close",l),d()}function d(){j("unpipe"),p.unpipe(e)}var p=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,j("pipe count=%d opts=%j",f.pipesCount,n);var g=(!n||!1!==n.end)&&e!==t.stdout&&e!==t.stderr,m=g?a:o;f.endEmitted?k(m):p.once("end",m),e.on("unpipe",i);var b=h(p);e.on("drain",b);var v=!1,E=!1;return p.on("data",s),r(e,"error",c),e.once("close",l),e.once("finish",u),e.emit("pipe",p),f.flowing||(j("pipe resume"),p.resume()),e},a.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var a=O(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},a.prototype.on=function(e,t){var n=P.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&p(this):k(b,this))}return n},a.prototype.addListener=a.prototype.on,a.prototype.resume=function(){var e=this._readableState;return e.flowing||(j("resume"),e.flowing=!0,v(this,e)),this},a.prototype.pause=function(){return j("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this},a.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(j("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){j("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)&&(r.push(i)||(n=!0,e.pause()))});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return R(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){j("wrapped _read",t),n&&(n=!1,e.resume())},r},a._fromList=y}).call(t,n(60))},,function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}e.exports=r;var i=n(142),a=n(73);a.inherits=n(65),a.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){"use strict";(function(e){t["RSA-SHA224"]=t.sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:new e("302d300d06096086480165030402040500041c","hex")},t["RSA-SHA256"]=t.sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:new e("3031300d060960864801650304020105000420","hex")},t["RSA-SHA384"]=t.sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:new e("3041300d060960864801650304020205000430","hex")},t["RSA-SHA512"]=t.sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:new e("3051300d060960864801650304020305000440","hex")},t["RSA-SHA1"]={sign:"rsa",hash:"sha1",id:new e("3021300906052b0e03021a05000414","hex")},t["ecdsa-with-SHA1"]={sign:"ecdsa",hash:"sha1",id:new e("","hex")},t.DSA=t["DSA-SHA1"]=t["DSA-SHA"]={sign:"dsa",hash:"sha1",id:new e("","hex")},t["DSA-SHA224"]=t["DSA-WITH-SHA224"]={sign:"dsa",hash:"sha224",id:new e("","hex")},t["DSA-SHA256"]=t["DSA-WITH-SHA256"]={sign:"dsa",hash:"sha256",id:new e("","hex")},t["DSA-SHA384"]=t["DSA-WITH-SHA384"]={sign:"dsa",hash:"sha384",id:new e("","hex")},t["DSA-SHA512"]=t["DSA-WITH-SHA512"]={sign:"dsa",hash:"sha512",id:new e("","hex")},t["DSA-RIPEMD160"]={sign:"dsa",hash:"rmd160",id:new e("","hex")},t["RSA-RIPEMD160"]=t.ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:new e("3021300906052b2403020105000414","hex")},t["RSA-MD5"]=t.md5WithRSAEncryption={sign:"rsa",hash:"md5",id:new e("3020300c06082a864886f70d020505000410","hex")}}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function r(e,t,n,r,a,o){if("function"==typeof a&&(o=a,a=void 0),"function"!=typeof o)throw new Error("No callback provided to pbkdf2");var s=i(e,t,n,r,a);setTimeout(function(){o(void 0,s)})}function i(t,n,r,i,s){if("number"!=typeof r)throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if("number"!=typeof i)throw new TypeError("Key length not a number");if(i<0||i>o)throw new TypeError("Bad key length");s=s||"sha1",e.isBuffer(t)||(t=new e(t,"binary")),e.isBuffer(n)||(n=new e(n,"binary"));var c,l=1,u=new e(i),d=new e(n.length+4);n.copy(d,0,0,n.length);for(var p,f,g=1;g<=l;g++){d.writeUInt32BE(g,n.length);var m=a(s,t).update(d).digest();c||(c=m.length,f=new e(c),l=Math.ceil(i/c),p=i-(l-1)*c),m.copy(f,0,0,c);for(var h=1;h<r;h++){m=a(s,t).update(m).digest();for(var b=0;b<c;b++)f[b]^=m[b]}var v=(g-1)*c,E=g===l?p:c;f.copy(u,v,0,E)}return u}var a=n(143),o=Math.pow(2,30)-1;t.pbkdf2=r,t.pbkdf2Sync=i}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e,n,o,s){if(!(this instanceof r))return new r(e,n,o);a.call(this),this._cipher=new i.AES(n),this._prev=new t(o.length),this._cache=new t(""),this._secCache=new t(""),this._decrypt=s,o.copy(this._prev),this._mode=e}var i=n(95),a=n(63);n(9)(r,a),e.exports=r,r.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},r.prototype._final=function(){this._cipher.scrub()}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e,n,i,s){if(!(this instanceof r))return new r(e,n,i);o.call(this),this._finID=t.concat([i,new t([0,0,0,1])]),i=t.concat([i,new t([0,0,0,2])]),this._cipher=new a.AES(n),this._prev=new t(i.length),this._cache=new t(""),this._secCache=new t(""),this._decrypt=s,this._alen=0,this._len=0,i.copy(this._prev),this._mode=e;var l=new t(4);l.fill(0),this._ghash=new c(this._cipher.encryptBlock(l)),this._authTag=null,this._called=!1}function i(e,t){var n=0;e.length!==t.length&&n++;for(var r=Math.min(e.length,t.length),i=-1;++i<r;)n+=e[i]^t[i];return n}var a=n(95),o=n(63),s=n(9),c=n(601),l=n(74);s(r,o),e.exports=r,r.prototype._update=function(e){if(!this._called&&this._alen){var n=16-this._alen%16;n<16&&(n=new t(n),n.fill(0),this._ghash.update(n))}this._called=!0;var r=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(r),this._len+=e.length,r},r.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=l(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(i(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=e;this._cipher.scrub()},r.prototype.getAuthTag=function(){if(!this._decrypt&&t.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},r.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},r.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length}}).call(t,n(3).Buffer)},function(e,t){t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},function(e,t,n){var r=n(74);t.encrypt=function(e,t){var n=r(t,e._prev);return e._prev=e._cipher.encryptBlock(n),e._prev},t.decrypt=function(e,t){var n=e._prev;e._prev=t;var i=e._cipher.decryptBlock(t);return r(i,n)}},function(e,t,n){(function(e){function r(t,n,r){var a=n.length,o=i(n,t._cache);return t._cache=t._cache.slice(a),t._prev=e.concat([t._prev,r?n:o]),o}var i=n(74);t.encrypt=function(t,n,i){for(var a,o=new e("");n.length;){if(0===t._cache.length&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=new e("")),!(t._cache.length<=n.length)){o=e.concat([o,r(t,n,i)]);break}a=t._cache.length,o=e.concat([o,r(t,n.slice(0,a),i)]),n=n.slice(a)}return o}}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function n(t,n,r){var i=t._cipher.encryptBlock(t._prev),a=i[0]^n;return t._prev=e.concat([t._prev.slice(1),new e([r?n:a])]),a}t.encrypt=function(t,r,i){for(var a=r.length,o=new e(a),s=-1;++s<a;)o[s]=n(t,r[s],i);return o}}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function n(e,t,n){for(var i,a,o,s=-1,c=0;++s<8;)i=e._cipher.encryptBlock(e._prev),a=t&1<<7-s?128:0,o=i[0]^a,c+=(128&o)>>s%8,e._prev=r(e._prev,n?a:o);return c}function r(t,n){var r=t.length,i=-1,a=new e(t.length);for(t=e.concat([t,new e([n])]);++i<r;)a[i]=t[i]<<1|t[i+1]>>7;return a}t.encrypt=function(t,r,i){for(var a=r.length,o=new e(a),s=-1;++s<a;)o[s]=n(t,r[s],i);return o}}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function r(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}var i=n(74);t.encrypt=function(t,n){for(;t._cache.length<n.length;)t._cache=e.concat([t._cache,r(t)]);var a=t._cache.slice(0,n.length);return t._cache=t._cache.slice(n.length),i(n,a)}}).call(t,n(3).Buffer)},function(e,t,n){function r(){if(null!==E)return E;var e=[];e[0]=2;for(var t=1,n=3;n<1048576;n+=2){for(var r=Math.ceil(Math.sqrt(n)),i=0;i<t&&e[i]<=r&&n%e[i]!=0;i++);t!==i&&e[i]<=r||(e[t++]=n)}return E=e,e}function i(e){for(var t=r(),n=0;n<t.length;n++)if(0===e.modn(t[n]))return 0===e.cmpn(t[n]);return!0}function a(e){var t=c.mont(e);return 0===f.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function o(e,t){if(e<16)return new c(2===t||5===t?[140,123]:[140,39]);t=new c(t);for(var n,r;;){for(n=new c(s(Math.ceil(e/8)));n.bitLength()>e;)n.ishrn(1);if(n.isEven()&&n.iadd(p),n.testn(1)||n.iadd(f),t.cmp(f)){if(!t.cmp(g))for(;n.mod(m).cmp(h);)n.iadd(v)}else for(;n.mod(l).cmp(b);)n.iadd(v);if(r=n.shrn(1),i(r)&&i(n)&&a(r)&&a(n)&&d.test(r)&&d.test(n))return n}}var s=n(72);e.exports=o,o.simpleSieve=i,o.fermatTest=a;var c=n(14),l=new c(24),u=n(211),d=new u,p=new c(1),f=new c(2),g=new c(5),m=(new c(16),new c(8),new c(10)),h=new c(3),b=(new c(7),new c(11)),v=new c(4),E=(new c(12),null)},function(e,t,n){function r(e){this.rand=e||new a.Rand}var i=n(14),a=n(212);e.exports=r,r.create=function(e){return new r(e)},r.prototype._rand=function(e){var t=e.bitLength(),n=this.rand.generate(Math.ceil(t/8));n[0]|=3;var r=7&t;return 0!==r&&(n[n.length-1]>>=7-r),new i(n)},r.prototype.test=function(e,t,n){var r=e.bitLength(),a=i.mont(e),o=new i(1).toRed(a);t||(t=Math.max(1,r/48|0));for(var s=e.subn(1),c=s.subn(1),l=0;!s.testn(l);l++);for(var u=e.shrn(l),d=s.toRed(a);t>0;t--){var p=this._rand(c);n&&n(p);var f=p.toRed(a).redPow(u);if(0!==f.cmp(o)&&0!==f.cmp(d)){for(var g=1;g<l;g++){if(f=f.redSqr(),0===f.cmp(o))return!1;if(0===f.cmp(d))break}if(g===l)return!1}}return!0},r.prototype.getDivisor=function(e,t){var n=e.bitLength(),r=i.mont(e),a=new i(1).toRed(r);t||(t=Math.max(1,n/48|0));for(var o=e.subn(1),s=o.subn(1),c=0;!o.testn(c);c++);for(var l=e.shrn(c),u=o.toRed(r);t>0;t--){var d=this._rand(s),p=e.gcd(d);if(0!==p.cmpn(1))return p;var f=d.toRed(r).redPow(l);if(0!==f.cmp(a)&&0!==f.cmp(u)){for(var g=1;g<c;g++){if(f=f.redSqr(),0===f.cmp(a))return f.fromRed().subn(1).gcd(e);if(0===f.cmp(u))break}if(g===c)return f=f.redSqr(),f.fromRed().subn(1).gcd(e)}}return!1}},function(e,t,n){function r(e){this.rand=e}var i;if(e.exports=function(e){return i||(i=new r(null)),i.generate(e)},e.exports.Rand=r,r.prototype.generate=function(e){return this._rand(e)},"object"==typeof window)window.crypto&&window.crypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}:window.msCrypto&&window.msCrypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return window.msCrypto.getRandomValues(t),t}:r.prototype._rand=function(){throw new Error("Not implemented yet")};else try{var a=n(193);r.prototype._rand=function(e){return a.randomBytes(e)}}catch(e){r.prototype._rand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t}}},function(e,t,n){"use strict";t["1.3.132.0.10"]="secp256k1",t["1.3.132.0.33"]="p224",t["1.2.840.10045.3.1.1"]="p192",t["1.2.840.10045.3.1.7"]="p256",t["1.3.132.0.34"]="p384",t["1.3.132.0.35"]="p521"},function(e,t,n){function r(e,t){if(o.call(this,t),!s.isBuffer(e))return void this.error("Input not Buffer");this.base=e,this.offset=0,this.length=e.length}function i(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof i||(e=new i(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=s.byteLength(e);else{if(!s.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}var a=n(9),o=n(76).Reporter,s=n(3).Buffer;a(r,o),t.DecoderBuffer=r,r.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},r.prototype.restore=function(e){var t=new r(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,o.prototype.restore.call(this,e.reporter),t},r.prototype.isEmpty=function(){return this.offset===this.length},r.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},r.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var n=new r(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n},r.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.EncoderBuffer=i,i.prototype.join=function(e,t){return e||(e=new s(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(n){n.join(e,t),t+=n.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):s.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)}},function(e,t,n){var r=t;r._reverse=function(e){var t={};return Object.keys(e).forEach(function(n){(0|n)==n&&(n|=0);var r=e[n];t[r]=n}),t},r.der=n(642)},function(e,t,n){function r(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new i,this.tree._init(e.body)}function i(e){l.Node.call(this,"der",e)}function a(e,t){var n=e.readUInt8(t);if(e.isError(n))return n;var r=d.tagClass[n>>6],i=0==(32&n);if(31==(31&n)){var a=n;for(n=0;128==(128&a);){if(a=e.readUInt8(t),e.isError(a))return a;n<<=7,n|=127&a}}else n&=31;return{cls:r,primitive:i,tag:n,tagStr:d.tag[n]}}function o(e,t,n){var r=e.readUInt8(n);if(e.isError(r))return r;if(!t&&128===r)return null;if(0==(128&r))return r;var i=127&r;if(i>=4)return e.error("length octect is too long");r=0;for(var a=0;a<i;a++){r<<=8;var o=e.readUInt8(n);if(e.isError(o))return o;r|=o}return r}var s=n(9),c=n(66),l=c.base,u=c.bignum,d=c.constants.der;e.exports=r,r.prototype.decode=function(e,t){return e instanceof l.DecoderBuffer||(e=new l.DecoderBuffer(e,t)),this.tree._decode(e,t)},s(i,l.Node),i.prototype._peekTag=function(e,t,n){if(e.isEmpty())return!1;var r=e.save(),i=a(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(r),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||n)},i.prototype._decodeTag=function(e,t,n){var r=a(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;var i=o(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!n&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(r.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');var s=e.save(),c=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(c)?c:(i=e.offset-s.offset,e.restore(s),e.skip(i,'Failed to match body of: "'+t+'"'))},i.prototype._skipUntilEnd=function(e,t){for(;;){var n=a(e,t);if(e.isError(n))return n;var r=o(e,n.primitive,t);if(e.isError(r))return r;var i;if(i=n.primitive||null!==r?e.skip(r):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===n.tagStr)break}},i.prototype._decodeList=function(e,t,n){for(var r=[];!e.isEmpty();){var i=this._peekTag(e,"end");if(e.isError(i))return i;var a=n.decode(e,"der");if(e.isError(a)&&i)break;r.push(a)}return r},i.prototype._decodeStr=function(e,t){if("bitstr"===t){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}if("bmpstr"===t){var r=e.raw();if(r.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var i="",a=0;a<r.length/2;a++)i+=String.fromCharCode(r.readUInt16BE(2*a));return i}if("numstr"===t){var o=e.raw().toString("ascii");return this._isNumstr(o)?o:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("printstr"===t){var s=e.raw().toString("ascii");return this._isPrintstr(s)?s:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},i.prototype._decodeObjid=function(e,t,n){for(var r,i=[],a=0;!e.isEmpty();){var o=e.readUInt8();a<<=7,a|=127&o,0==(128&o)&&(i.push(a),a=0)}128&o&&i.push(a);var s=i[0]/40|0,c=i[0]%40;if(r=n?i:[s,c].concat(i.slice(1)),t){var l=t[r.join(" ")];void 0===l&&(l=t[r.join(".")]),void 0!==l&&(r=l)}return r},i.prototype._decodeTime=function(e,t){var n=e.raw().toString();if("gentime"===t)var r=0|n.slice(0,4),i=0|n.slice(4,6),a=0|n.slice(6,8),o=0|n.slice(8,10),s=0|n.slice(10,12),c=0|n.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");var r=0|n.slice(0,2),i=0|n.slice(2,4),a=0|n.slice(4,6),o=0|n.slice(6,8),s=0|n.slice(8,10),c=0|n.slice(10,12);r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,a,o,s,c,0)},i.prototype._decodeNull=function(e){return null},i.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},i.prototype._decodeInt=function(e,t){var n=e.raw(),r=new u(n);return t&&(r=t[r.toString(10)]||r),r},i.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},function(e,t,n){function r(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new i,this.tree._init(e.body)}function i(e){u.Node.call(this,"der",e)}function a(e){return e<10?"0"+e:e}function o(e,t,n,r){var i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),d.tagByName.hasOwnProperty(e))i=d.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return r.error("Unknown tag: "+e);i=e}return i>=31?r.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=d.tagClassByName[n||"universal"]<<6)}var s=n(9),c=n(3).Buffer,l=n(66),u=l.base,d=(l.bignum,l.constants.der);e.exports=r,r.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},s(i,u.Node),i.prototype._encodeComposite=function(e,t,n,r){var i=o(e,t,n,this.reporter);if(r.length<128){var a=new c(2);return a[0]=i,a[1]=r.length,this._createEncoderBuffer([a,r])}for(var s=1,l=r.length;l>=256;l>>=8)s++;var a=new c(2+s);a[0]=i,a[1]=128|s;for(var l=1+s,u=r.length;u>0;l--,u>>=8)a[l]=255&u;return this._createEncoderBuffer([a,r])},i.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var n=new c(2*e.length),r=0;r<e.length;r++)n.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(n)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},i.prototype._encodeObjid=function(e,t,n){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var r=0;r<e.length;r++)e[r]|=0}else if(Array.isArray(e)){e=e.slice();for(var r=0;r<e.length;r++)e[r]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}for(var i=0,r=0;r<e.length;r++){var a=e[r];for(i++;a>=128;a>>=7)i++}for(var o=new c(i),s=o.length-1,r=e.length-1;r>=0;r--){var a=e[r];for(o[s--]=127&a;(a>>=7)>0;)o[s--]=128|127&a}return this._createEncoderBuffer(o)},i.prototype._encodeTime=function(e,t){var n,r=new Date(e);return"gentime"===t?n=[a(r.getFullYear()),a(r.getUTCMonth()+1),a(r.getUTCDate()),a(r.getUTCHours()),a(r.getUTCMinutes()),a(r.getUTCSeconds()),"Z"].join(""):"utctime"===t?n=[a(r.getFullYear()%100),a(r.getUTCMonth()+1),a(r.getUTCDate()),a(r.getUTCHours()),a(r.getUTCMinutes()),a(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(n,"octstr")},i.prototype._encodeNull=function(){return this._createEncoderBuffer("")},i.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!c.isBuffer(e)){var n=e.toArray();!e.sign&&128&n[0]&&n.unshift(0),e=new c(n)}if(c.isBuffer(e)){var r=e.length;0===e.length&&r++;var i=new c(r);return e.copy(i),0===e.length&&(i[0]=0),this._createEncoderBuffer(i)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var r=1,a=e;a>=256;a>>=8)r++;for(var i=new Array(r),a=i.length-1;a>=0;a--)i[a]=255&e,e>>=8;return 128&i[0]&&i.unshift(0),this._createEncoderBuffer(new c(i))},i.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},i.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},i.prototype._skipDefault=function(e,t,n){var r,i=this._baseState;if(null===i.default)return!1;var a=e.join();if(void 0===i.defaultBuffer&&(i.defaultBuffer=this._encodeValue(i.default,t,n).join()),a.length!==i.defaultBuffer.length)return!1;for(r=0;r<a.length;r++)if(a[r]!==i.defaultBuffer[r])return!1;return!0}},function(e,t,n){(function(t){function r(e){var n=new t(4);return n.writeUInt32BE(e,0),n}var i=n(61);e.exports=function(e,n){for(var a,o=new t(""),s=0;o.length<n;)a=r(s++),o=t.concat([o,i("sha1").update(e).update(a).digest()]);return o.slice(0,n)}}).call(t,n(3).Buffer)},function(e,t){e.exports=function(e,t){for(var n=e.length,r=-1;++r<n;)e[r]^=t[r];return e}},function(e,t,n){(function(t){function r(e,n){return new t(e.toRed(i.mont(n.modulus)).redPow(new i(n.publicExponent)).fromRed().toArray())}var i=n(14);e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(67),a=n(68),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.JobOperationType.LambdaInvoke,t.defaultName="Lambda",t.iamRoleTemplate={Version:"2012-10-17",Statement:[{Effect:"Allow",Action:["lambda:InvokeFunction"],Resource:"{{LambdaFunctionARN}}"},{Effect:"Allow",Action:["s3:GetObject","s3:GetObjectVersion","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ManifestBucket}}"]},{Effect:"Allow",Action:["s3:PutObject","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ReportBucket}}/*"]}]},t}return r(t,e),t.prototype.getProperties=function(e){return[{title:"job_management.properties.operation_lambda_function",value:this.FunctionArn||"-"}]},t}(i.JobOperation);t.LambdaInvokeOperation=o},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(16),o=n(67),s=n(68),c=n(55),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.JobOperationType.S3PutObjectCopy,t.defaultName="Copy",t.iamRoleTemplate={Version:"2012-10-17",Statement:[{Action:["s3:PutObject","s3:PutObjectAcl","s3:PutObjectTagging"],Effect:"Allow",Resource:"{{S3ResourceARN}}{{DestinationBucket}}/*"},{Action:["s3:GetObject","s3:GetObjectAcl","s3:GetObjectTagging"],Effect:"Allow",Resource:"{{S3ResourceARN}}{{SourceBucket}}/*"},{Effect:"Allow",Action:["s3:GetObject","s3:GetObjectVersion","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ManifestBucket}}"]},{Effect:"Allow",Action:["s3:PutObject","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ReportBucket}}/*"]}]},t.internalProperties=t.internalProperties.concat(["TaggingDirective"]),t}return r(t,e),t.prototype.initializeDefaults=function(e){this.StorageClass=a.S3StorageClass.STANDARD,this.TaggingDirective=a.S3TaggingDirective.COPY,this.NewObjectTagging=[],this.MetadataDirective=a.S3MetadataDirective.COPY,this.NewObjectMetadata={},this.AccessControlGrants=[c.jobPropertyHelpers.createOwnerGrant(e)]},t.prototype.getProperties=function(e){var t,n=this;switch(i.get(this,"NewObjectMetadata.Ssealgorithm")){case a.S3EncryptionAlgorithm.AES256:t=e.instant("sse_editor.option.aes256");break;case a.S3EncryptionAlgorithm.KMS:t=e.instant("sse_editor.option.awskms")+" - "+this.SSEAwsKmsKeyId;break;default:t=e.instant("sse_editor.option.none")}var r=[{title:"job_management.properties.copy_destination",value:this.TargetResource?c.jobPropertyHelpers.getExternalLink(this.TargetResource,this.TargetResource.replace("s3://","/s3/buckets/"),!0):"-"},{title:"job_management.properties.operation_storage_class",value:c.jobPropertyHelpers.getTranslatedValue(e,"storageclass",this.StorageClass)||"-"},{title:"job_management.properties.operation_encryption",value:t}];this.AccessControlGrants&&r.push({title:"job_management.properties.operation_acl",table:c.jobPropertyHelpers.getAclTable(this.AccessControlGrants,e)});var o=c.jobPropertyHelpers.getTaggingDirective(this.NewObjectTagging);r.push({title:"job_management.properties.operation_tags",value:c.jobPropertyHelpers.getTranslatedValue(e,"job_management.tags_directive",o)}),o===a.S3TaggingDirective.REPLACE&&r.push({title:"job_management.properties.operation_tags_full",table:c.jobPropertyHelpers.getTagsTable(this.NewObjectTagging)});var s={};if(this.NewObjectMetadata&&(Object.keys(this.NewObjectMetadata).forEach(function(e){var t=n.NewObjectMetadata[e];"UserMetadata"===e&&t?s[e]=t:t&&(s[e]=t.toString())}),delete s.Ssealgorithm),this.MetadataDirective){var l=c.jobPropertyHelpers.processDirective(this.MetadataDirective,!i.isEmpty(s));r.push({title:"job_management.properties.operation_metadata",value:c.jobPropertyHelpers.getTranslatedValue(e,"job_management.metadata_directive",l)}),l===a.S3MetadataDirective.REPLACE&&r.push({title:"job_management.properties.operation_metadata_full",table:c.jobPropertyHelpers.getMetadataTable(s,e)})}return r},t}(o.JobOperation);t.S3CopyObjectOperation=l},function(e,t,n){"use strict";function r(e){var n=t.aclHelpers.grantsToMap(e);return c.values(n)}function i(e,t,n,r){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1),{READ:e,READ_ACP:t,WRITE:n,WRITE_ACP:r}}function a(e,t){return void 0===t&&(t={}),e.forEach(function(e){var n=e.Grantee.Identifier;t[n]||(t[n]={Grantee:e.Grantee,Permissions:i()}),e.Permission===s.FULL_CONTROL?t[n].Permissions=i(!0,!0,!0,!0):t[n].Permissions[e.Permission]=!0}),t}function o(e,n){if(e.TypeIdentifier===l.GROUP){var r=e.Identifier.split("/").pop(),i=t.predefinedGranteeGroups[r];return i?n.instant(i.translationId):r}return e.Identifier}Object.defineProperty(t,"__esModule",{value:!0});var s,c=n(2);!function(e){e.FULL_CONTROL="FULL_CONTROL",e.READ="READ",e.WRITE="WRITE",e.READ_ACP="READ_ACP",e.WRITE_ACP="WRITE_ACP"}(s=t.S3Permission||(t.S3Permission={}));var l;!function(e){e.CANONICAL="id",e.EMAIL_ADDRESS="emailAddress",e.GROUP="uri"}(l=t.S3GranteeTypeIdentifier||(t.S3GranteeTypeIdentifier={}));var u=function(){function e(){}return e}();t.S3AccessControlPolicy=u,function(e){e.PRIVATE="private",e.PUBLIC_READ="public-read",e.PUBLIC_READ_WRITE="public-read-write",e.AWS_EXEC_READ="aws-exec-read",e.AUTHENTICATED_READ="authenticated-read",e.BUCKET_OWNER_READ="bucket-owner-read",e.BUCKET_OWNER_FULL_CONTROL="bucket-owner-full-control"}(t.S3CannedAccessControlList||(t.S3CannedAccessControlList={}));var d=function(){function e(){}return e}();t.S3ObjectOwner=d;var p=function(){function e(){}return e}();t.S3AccessControlList=p;var f=function(){function e(){}return e}();t.S3Grant=f;var g=function(){function e(){}return e}();t.S3Grantee=g,t.predefinedGranteeGroups={AllUsers:{id:"AllUsers",translationId:"permissions.acl.everyone_full",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},AuthenticatedUsers:{id:"AuthenticatedUsers",translationId:"permissions.acl.any",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},LogDelivery:{id:"LogDelivery",translationId:"permissions.acl.log",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"}},t.aclHelpers={getGranteeName:o,grantsToMap:a,getPermissionSet:i,processGrants:r}},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=n(67),o=n(68),s=n(55),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=o.JobOperationType.S3InitiateRestoreObject,t.defaultName="Glacier-restore",t.iamRoleTemplate={Version:"2012-10-17",Statement:[{Effect:"Allow",Action:["s3:RestoreObject"],Resource:"{{S3ResourceARN}}{{TargetResource}}/*"},{Effect:"Allow",Action:["s3:GetObject","s3:GetObjectVersion","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ManifestBucket}}"]},{Effect:"Allow",Action:["s3:PutObject","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ReportBucket}}/*"]}]},t}return r(t,e),t.prototype.initializeDefaults=function(){this.GlacierJobTier=i.S3RestoreJobTier.BULK},t.prototype.getProperties=function(e){return[{title:"job_management.properties.operation_glacier_restore_num_days",value:this.ExpirationInDays?this.ExpirationInDays+" "+s.jobPropertyHelpers.getTranslatedValue(e,"job_management.create.operation","glacier_restore_days"):"-"},{title:"job_management.properties.operation_glacier_restore_speed",value:s.jobPropertyHelpers.getTranslatedValue(e,"job_management.restore_tier",this.GlacierJobTier)||"-"}]},t}(a.JobOperation);t.S3InitiateRestoreObjectOperation=c},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(67),o=n(68),s=n(55),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=o.JobOperationType.S3PutObjectAcl,t.defaultName="Set-ACL",t.iamRoleTemplate={Version:"2012-10-17",Statement:[{Effect:"Allow",Action:["s3:PutObjectAcl","s3:PutObjectVersionAcl"],Resource:"{{S3ResourceARN}}{{TargetResource}}/*"},{Effect:"Allow",Action:["s3:GetObject","s3:GetObjectVersion","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ManifestBucket}}"]},{Effect:"Allow",Action:["s3:PutObject","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ReportBucket}}/*"]}]},t}return r(t,e),t.prototype.initializeDefaults=function(e){this.AccessControlPolicy={AccessControlList:{Owner:{ID:e},Grants:[s.jobPropertyHelpers.createOwnerGrant(e)]}}},t.prototype.getProperties=function(e){return this.AccessControlPolicy&&this.AccessControlPolicy.AccessControlList?[{title:"job_management.properties.operation_acl_object_owner",value:i.get(this.AccessControlPolicy.AccessControlList,"Owner.ID")||"-"},{title:"job_management.properties.operation_acl",table:s.jobPropertyHelpers.getAclTable(this.AccessControlPolicy.AccessControlList.Grants,e)}]:[]},t}(a.JobOperation);t.S3SetObjectAclOperation=c},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(67),a=n(68),o=n(55),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=a.JobOperationType.S3PutObjectTagging,t.defaultName="Set-Tags",t.iamRoleTemplate={Version:"2012-10-17",Statement:[{Effect:"Allow",Action:["s3:PutObjectTagging","s3:PutObjectVersionTagging"],Resource:"{{S3ResourceARN}}{{TargetResource}}/*"},{Effect:"Allow",Action:["s3:GetObject","s3:GetObjectVersion","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ManifestBucket}}"]},{Effect:"Allow",Action:["s3:PutObject","s3:GetBucketLocation"],Resource:["{{S3ResourceARN}}{{ReportBucket}}/*"]}]},t}return r(t,e),t.prototype.initializeDefaults=function(){this.TagSet=[]},t.prototype.getProperties=function(e){return this.TagSet&&this.TagSet.length>0?[{title:"job_management.properties.operation_tags",table:o.jobPropertyHelpers.getTagsTable(this.TagSet)}]:[]},t}(i.JobOperation);t.S3SetObjectTaggingOperation=s},function(e,t,n){"use strict";function r(e,t,n,r){void 0===n&&(n=!1);var l=e.search(),d=l[u.S3Constants.ACTION_SUCCESS_PARAM],p=l[u.S3Constants.JOB_ID_PARAM];if(i(e),p&&a(d)){var f={header:o(d,p,t),content:s(d,p,t)};return n&&(f.content=((f.content||"")+" "+c(p,r,t)).trim()),f}}function i(e){e.search(u.S3Constants.ACTION_SUCCESS_PARAM,null),e.search(u.S3Constants.JOB_ID_PARAM,null)}function a(e){var t=Object.keys(p.JobConsoleAction).filter(function(e){return e!==p.JobConsoleAction.clone});return l.includes(t,e)}function o(e,t,n){var r="job_management.success_notification."+e;return n.instant(r,{jobId:t})}function s(e,t,n){if(e===p.JobConsoleAction.create){var r="job_management.success_notification.content."+e;return n.instant(r,{jobId:t})}}function c(e,t,n){return'<a href="/s3'+d.jobHelpers.getJobPath(e)+"?region="+t+'">'+n.instant("job_management.view_job_details")+"</a>"}Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),u=n(17),d=n(54),p=n(16);t.jobSuccessAlert={get:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77),i=n(54),a=n(17),o=function(){function e(e,t,n,r,i,o,s,c,l){this.$routeParams=e,this.Region=t,this.jobsApiService=n,this.jobPropertiesService=r,this.$translate=i,this.$location=o,this.UtilService=s,this.jobDocLinksService=c,this.PerformanceUtilsService=l,this.jobId=e[a.S3Constants.PATH_SEGMENTS.JOB_ID],this.currentRegion=t.getCurrentRegion(),this.initialize()}return e.prototype.$onInit=function(){},e.prototype.loadJob=function(){var e=this;this.isLoading=!0,this.clearData(),this.jobsApiService.describeJob(this.currentRegion,this.jobId).then(function(t){e.job=t.Job,i.jobHelpers.processJob(e.job),e.loadPropertiesDefinition(),e.afterLoadJob(e.job)}).catch(function(t){e.error=r.jobErrorAlert.get(r.JobConsoleErrorAction.detail,t,e.$translate)}).finally(function(){e.setCustomerReady(),e.isLoading=!1})},e.prototype.setCustomerReady=function(){},e.prototype.clearData=function(){this.error=null,this.job=null},e.prototype.afterLoadJob=function(e){},e.prototype.initialize=function(){this.loadJob()},e.prototype.loadPropertiesDefinition=function(){this.propertiesDefinition=this.jobPropertiesService.getJobDetails(this.job,this.currentRegion)},e.$inject=["$routeParams","Region","JobsApiService","JobPropertiesService","$translate","$location","UtilService","JobDocLinksService","PerformanceUtilsService"],e}();t.JobDetailBaseController=o},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(2),o=n(77),s=n(16),c=n(147),l=n(55),u=n(17);t.CUSTOM_ROLE_ARN="CUSTOM_ROLE_ARN";var d,p={Version:"2012-10-17",Statement:[{Effect:"Allow",Principal:{Service:"batchoperations.s3.amazonaws.com"},Action:"sts:AssumeRole"}]};!function(e){e.IAM_POLICY="iam",e.TRUST_POLICY="trust"}(d||(d={}));var f=function(){function e(e,t,n,r,c,l,f,g,m,h,b,v,E,S,y,A,C,_,w){var T=this;this.$filter=e,this.$routeParams=t,this.Region=n,this.$location=r,this.APIProxyService=c,this.LambdaService=l,this.ConsoleOperation=f,this.$translate=g,this.IAMService=m,this.UtilService=h,this.FAC=b,this.SCLogService=v,this.BucketPropertiesService=E,this.jobsApiService=S,this.jobPropertiesService=y,this.UUIDService=A,this.jobDocLinksService=C,this.RegionStatesService=_,this.PerformanceUtilsService=w,this.reviewRegionAndManifestProperties=[],this.reviewOperationProperties=[],this.reviewOptionsProperties=[],this.showCopyDestinationBucketBrowser=!1,this.showManifestBucketBrowser=!1,this.showReportBucketBrowser=!1,this.isCreateBucketModalOpen={flag:!1},this.iamPolicyModal={flag:!1},this.selectedManifestFormat=s.JobManifestFormat.S3InventoryReport_CSV_20161130,this.versionIDinManifest=!1,this.regions=[],this.aclList=[],this.tags=[],this.metadata=[],this.currentStepIndex=0,this.manifestPath="",this.inputWithSpecialchar=!0,this.versioningEnabled=!0,this.reportScope=s.JobReportScope.ALL_TASKS,this.iamRoleList=[],this.jobMgmtTitle="job_management.create.title",this.createBtnTitle="job_management.actions.create",this.actionName=s.JobConsoleAction.create,this.disableRegionSelector=!1,this.MANIFEST_STEP="MANIFEST",this.ACTION_STEP="ACTION",this.OPTIONS_STEP="OPTIONS",this.REVIEW_STEP="REVIEW",this.s3PathPattern=/^s3:\/\/.+/,this.s3BucketPattern=/^s3:\/\/[^\/]+$/,this.s3InventoryReportPattern=/^s3:\/\/.+\.(json|JSON)$/,this.numberPattern=/^[0-9]+$/,this.glacierDaysPattern=/^[1-9][0-9]*$/,this.arnPattern=/^arn:.+/,this.validationStrings={},this.docLinks=this.jobDocLinksService.links,this.glacierPricingLink=this.UtilService.getPricingUrl("glacier"),this.metadataDirective=s.S3MetadataDirective.COPY,this.selectedTab=d.IAM_POLICY,this.onSelectManifest=function(e){T.manifestVersionId=void 0,T.manifestETag=void 0,T.etagPermissionsError=!1,T.manifestPathValidationMessage=null,T.manifestPath="s3://"+e.Bucket+"/"+e.Key,e.VersionID&&(T.manifestVersionId=e.VersionID),e.ETag&&(T.manifestETag=e.ETag)},this.onSelectReport=function(e){var t="s3://";if(e.Bucket&&(t+=e.Bucket,e.Key)){var n=e.Key;n=n.replace(/\/$/,""),t+="/"+n}T.jobReportDestination=t,T.updatePolicyTemplate()},this.onSelectPutCopyDest=function(e){var t="s3://";e.Bucket&&(t+=e.Bucket,e.Key&&(t+="/"+e.Key)),T.operation.TargetResource=t,T.checkTargetBucket()},this.onSelectStorageClass=function(e){T.operation.StorageClass=e},this.loadBuckets=function(){if(!T.isCreateBucketModalOpen.flag){var e=new T.ConsoleOperation("CreateBucket","populateBucketSelectorDropdown");T.APIProxyService.listAllMyBuckets(e).then(function(t){var n=t.response;T.SCLogService.log("listBucketsComplete",1,e),T.bucketList=n.ListAllMyBucketsResult.Buckets.Bucket,T.bucketList.forEach(function(e){T.BucketPropertiesService.getBucketLocation(e.Name).then(function(t){T.Region.regionMapping.forEach(function(n){n.value===t&&(e.Location=n.text,e.Region=n.value)})})}),T.numRegions=a.without(a.uniq(a.map(T.bucketList,"Location")),void 0).length})}},this.createBucketCallBack=function(e){var t=T.getSelectedStep().value;e="s3://"+e,t===T.ACTION_STEP?T.operation.TargetResource=e:t===T.OPTIONS_STEP&&(T.jobReportDestination=e,T.updatePolicyTemplate()),T.isCreateBucketModalOpen.flag=!1},this.initializeData(),this.initializeValidationStrings(),this.regions=[],this.currentRegion=this.Region.getCurrentRegion();var R=u.S3Constants.FAC.BATCH_OPERATIONS,O=_.getDisabledRegions(),k=[];h.getFACRegions(n.regionMapping,k,R),k.forEach(function(e){var t=i.copy(e);T.regions.push(t),O.then(function(e){a.indexOf(e,t.value)>-1&&(t.disabled=!0,t.text+=" - "+g.instant("disabled.region"))})});var I=!1;this.regions.forEach(function(e){T.currentRegion&&T.currentRegion===e.value&&(I=!0)}),this.regionFilters=this.regions,this.currentRegion&&I||this.changeRegion(this.regions[0].value),this.policyTabs=[{label:this.$translate.instant("job_management.create.options.permissions_view_policy_template_modal_header"),id:d.IAM_POLICY},{label:this.$translate.instant("job_management.create.options.permissions_view_trust_policy_modal_header"),id:d.TRUST_POLICY}],this.listRolesPromise=this.listRoles();var P=new this.ConsoleOperation("CreateJobGetAccountOwner");this.APIProxyService.getBucketOwner(P).then(function(e){T.accountOwnerId=e.ID}).catch(function(){T.error=o.jobErrorAlert.get(o.JobConsoleErrorAction.unknown,null,T.$translate)}),this.checkForManifestParam(),this.afterInitialize(),this.trustPolicy=JSON.stringify(p,null,4)}return e.prototype.changeRegion=function(e){this.$location.search("region",e),this.currentRegion=e},e.prototype.getManifestInputs=function(){return this.manifestSelector},e.prototype.getSteps=function(){return this.steps},e.prototype.getSelectedStep=function(){return this.steps[this.currentStepIndex]},e.prototype.$onInit=function(){this.manifestSelector=[]},e.prototype.scrollToTop=function(){i.element(".sidebar-nav-main-content").scrollTop(0)},e.prototype.next=function(){this.currentStepIndex++,1===this.currentStepIndex?this.operationType===c.JobOperationType.S3PutObjectCopy&&this.checkTargetBucket():2===this.currentStepIndex?this.updatePolicyTemplate():3===this.currentStepIndex&&this.prepareReviewPanel(),this.scrollToTop()},e.prototype.previous=function(){this.currentStepIndex--,this.scrollToTop()},e.prototype.cancel=function(){this.$location.path("/"+u.S3Constants.PATH_SEGMENTS.JOBS)},e.prototype.browseManifest=function(){this.showManifestBucketBrowser=!0},e.prototype.browseReport=function(){this.showReportBucketBrowser=!0},e.prototype.browsePutCopyDestination=function(){this.showCopyDestinationBucketBrowser=!0},e.prototype.listRoles=function(){var e=this,t=new this.ConsoleOperation("listRoles");return this.isLoadingRoles=!0,this.selectedIAMRole=null,this.APIProxyService.makeProxyRequest(this.IAMService.listRoles,{region:this.UtilService.getDefaultRegion(),params:{MaxItems:u.S3Constants.API_MAX_ITEMS.IAM_LIST_ROLES}},u.S3Constants.PROXY_API_NAMES.IAM.LIST_ROLES,t).then(function(n){var r=n.response.ListRolesResponse.ListRolesResult.Roles;return e.SCLogService.log("CJ_ListRoles",1,t),r.forEach(function(t){e.iamRoleList.push({text:t.RoleName,value:t.Arn})}),e.iamRoleList}).catch(function(t){e.listRolesError=e.UtilService.handleErrors(t)}).finally(function(){e.isLoadingRoles=!1})},e.prototype.getObjectPathLink=function(e){return e?e.replace("s3://","/s3/object/")+"?region="+this.currentRegion:null},e.prototype.getPrefixPathLink=function(e){return e?e.replace("s3://","/s3/buckets/"):null},e.prototype.getRoleLink=function(){var e=this.UtilService.getIamRoleNameFromArn(this.selectedIAMRole);return this.UtilService.getIamRoleLink(e)},e.prototype.validatePathCharacters=function(e){return/^[\w\.\-\/:]*$/.test(e)},e.prototype.showValidation=function(e){if(e)return e.$invalid&&e.$touched},e.prototype.showPathValidation=function(e){if(this.showValidation(e))return this.validationStrings.invalidPath},e.prototype.showBucketPathValidation=function(e){if(this.showValidation(e))return this.validationStrings.invalidBucketPath},e.prototype.manifestPathValidation=function(){if(this.showValidation(this.form.manifestPath))return this.isManifestInventoryReport()?this.validationStrings.invalidInventoryReportPath:this.validationStrings.invalidPath},e.prototype.checkTargetBucket=function(){var e=this;this.resetTargetBucketValidation();var t=this.parseS3Path(this.operation.TargetResource);if(this.targetResourceBucket=t.bucket,this.targetResourceBucket){var n=new this.ConsoleOperation("createJobCheckBucket"),r={};this.APIProxyService.getBucketLocation(n,this.targetResourceBucket,r).then(function(){r.region!==e.currentRegion?e.targetBucketValidationMessage="bucket.invalid_region_validation":e.isVersioningEnabled()}).catch(function(t){404===t.status&&(e.targetBucketValidationMessage="bucket.not_found")})}},e.prototype.getVersioningHeader=function(){var e=this.parseS3Path(this.operation.TargetResource),t=e.bucket;return this.$translate.instant("job_management.create.operation.versioning_warning_title",{bucketName:t})},e.prototype.isVersioningEnabled=function(){var e=this,t=this.parseS3Path(this.operation.TargetResource),n=t.bucket;n&&this.BucketPropertiesService.getBucketVersioning(n,new this.ConsoleOperation("GetBucketVersioning")).then(function(t){e.versioningEnabled=!1,"Enabled"===t&&(e.versioningEnabled=!0)}).catch(function(t){e.versioningEnabled=!1})},e.prototype.enableVersioning=function(){var e=this,t=new this.ConsoleOperation("enableBucketVersioning"),n=this.parseS3Path(this.operation.TargetResource),r=n.bucket;this.BucketPropertiesService.enableBucketVersioning(r,t).then(function(){e.versioningEnabled=!0,e.SCLogService.log("CJ_enableBucketVersioning",1,t)}).catch(function(n){e.SCLogService.log("CJ_enableBucketVersioning",0,t)})},e.prototype.getManifestPlaceHolderPath=function(){return"s3://path/to/manifest."+(this.isCSVManifest()?"csv":"json")},e.prototype.showCreateBucketModal=function(){this.loadBuckets(),this.disableRegionSelector=this.ACTION_STEP===this.getSelectedStep().value,this.isCreateBucketModalOpen.flag=!0},e.prototype.isNextDisabled=function(){if(0===this.currentStepIndex&&!this.manifestETag)return!0;if(1===this.currentStepIndex&&this.operationType===c.JobOperationType.S3PutObjectCopy){if(this.targetBucketValidationMessage)return!0;if(!this.versioningEnabled&&!this.versioningAcknowledgement)return!0;var e=u.S3Constants.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION;if(this.selectedEncryption&&this.selectedEncryption.encryption===e.AWSKMS&&(!this.selectedEncryption.kmsId||this.selectedEncryption.kmsId.value===e.CUSTOM_ARN&&!this.selectedEncryption.customKMSARN))return!0}return!1},e.prototype.changeOperationType=function(){this.operation&&this.operation.type===this.operationType||(this.operation=new c.jobOperationTypeClassMapping[this.operationType],this.operation.initializeDefaults(this.accountOwnerId),this.jobDescription===this.lastAutomaticDescription&&(this.jobDescription=this.UtilService.formatDate(new Date,"y-MM-dd")+" "+this.operation.defaultName,this.lastAutomaticDescription=this.jobDescription),this.resetTargetBucketValidation())},e.prototype.isOperationSelected=function(){return!!this.operationType},e.prototype.getVersionIDsInManifestSelected=function(){return this.versionIDinManifest?this.$translate.instant("bucketproperty.yes"):this.$translate.instant("bucketproperty.no")},e.prototype.prepareReviewPanel=function(){this.reviewRegionAndManifestProperties=[{properties:this.jobPropertiesService.getRegionProperties(this.currentRegion).concat(this.jobPropertiesService.getManifestProperties(this.manifestPath,this.manifestVersionId,this.manifestETag,this.selectedManifestFormat,this.versionIDinManifest))}],this.prepareCopyOperation(),this.reviewOperationProperties=[{properties:this.jobPropertiesService.getOperationProperties(this.getOperation())}],this.iamRoleArn=null,this.selectedIAMRoleAction===s.JobIamRole.EXISTING_ROLE?this.iamRoleArn=this.selectedIAMRole:this.selectedIAMRoleAction===t.CUSTOM_ROLE_ARN&&(this.iamRoleArn=this.customIAMRoleArn),this.reviewOptionsProperties=[{properties:this.jobPropertiesService.getAdditionalOptionsProperties(this.jobDescription,this.jobPriority,this.generateCompletionReport,this.reportScope,this.jobReportDestination,this.iamRoleArn)}]},e.prototype.getCurrentRegionName=function(){var e=this;return this.regionFilters.find(function(t){return t.value===e.currentRegion}).text},e.prototype.getTargetRegionName=function(e){return this.regionFilters.find(function(t){return t.value===e}).text},e.prototype.getManifestFields=function(){var e=[];return s.JobManifestFormat.S3BatchOperations_CSV_20180820===this.selectedManifestFormat&&(e.push(s.JobManifestField.Bucket),e.push(s.JobManifestField.Key),this.versionIDinManifest&&e.push(s.JobManifestField.VersionId)),e},e.prototype.getReportConfig=function(){var e={Enabled:!1},t=this.parseS3Path(this.jobReportDestination),n=t.bucket;return this.generateCompletionReport&&(e.Enabled=!0,e.Bucket=this.toARN(n),e.Format=s.JobReportFormat.Report_CSV_20180820,e.ReportScope=this.reportScope,e.Prefix=t.key),e},e.prototype.getManifestConfig=function(){var e=this.getManifestFields(),t={Spec:{Format:this.selectedManifestFormat},Location:{ObjectArn:this.manifestPath,ObjectVersionId:this.manifestVersionId,Etag:this.manifestETag}};return e.length>0&&(t.Spec.Fields=e),t},e.prototype.create=function(){this.isWorking=!0,this.actionError=null,this.prepareCopyOperation(),this.callCreateJob()},e.prototype.toARN=function(e){return this.UtilService.getBucketARN(e)},e.prototype.parseS3Path=function(e){var t,n,r=e?e.split("/"):[];return r[2]&&(t=r[2]),r.length>3&&(n=r.slice(3,r.length).join("/")),n||(n=void 0),{bucket:t,key:n}},e.prototype.processManifestETag=function(){var e=this,t=this.parseS3Path(this.manifestPath);this.etagPermissionsError=!1,this.manifestPathValidationMessage=null,this.manifestETag=null,t.bucket&&t.key&&(this.loadingEtag=!0,this.APIProxyService.headObject(new this.ConsoleOperation("headObject"),t.bucket,t.key).then(function(t){if(t&&t.headers&&t.headers("etag")){var n=t.headers("etag");n=n.replaceAll('"',""),e.manifestETag=n}}).catch(function(t){switch(t.status){case 403:e.etagPermissionsError=!0;break;case 404:e.manifestPathValidationMessage="job_management.create.manifest.path_not_found";break;default:e.manifestPathValidationMessage="utilities.unknown.error"}}).finally(function(){e.loadingEtag=!1}))},e.prototype.updatePolicyTemplate=function(){this.iamPolicyDocument=this.prepareIAMTemplate(JSON.stringify(this.operation.iamRoleTemplate,null,4))},e.prototype.copyPolicyToClipboard=function(e){this.UtilService.copyToClipboard(e)},e.prototype.isManifestInventoryReport=function(){return this.selectedManifestFormat===s.JobManifestFormat.S3InventoryReport_CSV_20161130},e.prototype.afterInitialize=function(){this.PerformanceUtilsService.customerReady("BOPs-Create")},e.prototype.resetTargetBucketValidation=function(){this.targetBucketValidationMessage=null,this.versioningEnabled=!0,this.versioningAcknowledgement=!1},e.prototype.isCSVManifest=function(){return this.selectedManifestFormat===s.JobManifestFormat.S3BatchOperations_CSV_20180820},e.prototype.getOperation=function(){return this.operation},e.prototype.initializeValidationStrings=function(){this.validationStrings.invalidPath=this.$translate.instant("job_management.invalid_path"),this.validationStrings.invalidBucketPath=this.$translate.instant("job_management.invalid_bucket_path"),this.validationStrings.invalidInventoryReportPath=this.$translate.instant("job_management.invalid_path_manifest_json")},e.prototype.getOptionList=function(e,t){var n=this;return e.map(function(e){return{name:l.jobPropertyHelpers.getTranslatedValue(n.$translate,"job_management."+t,e),value:e}})},e.prototype.enumToArray=function(e){return Object.keys(e).map(function(t){return e[t]})},e.prototype.initializeData=function(){var e=this;this.steps=this.getOptionList([this.MANIFEST_STEP,this.ACTION_STEP,this.OPTIONS_STEP,this.REVIEW_STEP],"create.step"),this.manifestSelector=this.getOptionList([s.JobManifestFormat.S3InventoryReport_CSV_20161130,s.JobManifestFormat.S3BatchOperations_CSV_20180820],"manifest_format"),this.availableJobs=this.getOptionList(this.enumToArray(c.JobOperationType),"operation").map(function(t){return t.value===c.JobOperationType.LambdaInvoke&&(t.tooltip="job_management.create.operation.lambda_tooltip",t.disabled=!e.FAC.isFeatureEnabled(u.S3Constants.FAC.BATCH_OPERATIONS_LAMBDA)),t}),this.putCopyTagActions=this.getOptionList([s.S3TaggingDirective.COPY,s.S3TaggingDirective.REPLACE,s.REMOVE_DIRECTIVE],"tags_directive"),this.putCopyMetadataActions=this.getOptionList([s.S3MetadataDirective.COPY,s.S3MetadataDirective.REPLACE,s.REMOVE_DIRECTIVE],"metadata_directive"),this.jobReportScope=this.getOptionList(this.enumToArray(s.JobReportScope),"report_scope"),this.jobPermissions=this.getOptionList(Object.keys(s.JobIamRole).concat([t.CUSTOM_ROLE_ARN]),"iam_role"),this.retrievalSpeedList=this.FAC.isFeatureEnabled(u.S3Constants.FAC.DEEP_ARCHIVE)?this.getRetrievalList("restore_tier"):this.getRetrievalList("glacier_tier"),this.selectedIAMRoleAction=s.JobIamRole.EXISTING_ROLE,this.jobPriority=10,this.generateCompletionReport=!0},e.prototype.getRetrievalList=function(e){var t=this;return this.getOptionList(this.enumToArray(s.S3RestoreJobTier),e).map(function(n){return r({},n,{desc:l.jobPropertyHelpers.getTranslatedValue(t.$translate,"job_management."+e+"_desc",n.value)})})},e.prototype.prepareCopyOperation=function(){if(this.operation.type===c.JobOperationType.S3PutObjectCopy){var e=this.operation;if(e.TaggingDirective===s.S3TaggingDirective.COPY?e.NewObjectTagging=null:e.TaggingDirective===s.REMOVE_DIRECTIVE&&(e.NewObjectTagging=[]),e.MetadataDirective=this.metadataDirective,e.MetadataDirective===s.S3MetadataDirective.COPY&&(e.NewObjectMetadata={}),e.MetadataDirective===s.REMOVE_DIRECTIVE&&(e.NewObjectMetadata={},e.MetadataDirective=s.S3MetadataDirective.REPLACE),e.NewObjectMetadata&&delete e.NewObjectMetadata.Ssealgorithm,e.SSEAwsKmsKeyId&&delete e.SSEAwsKmsKeyId,!this.selectedEncryption)return;var t=u.S3Constants.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION;this.selectedEncryption.encryption===t.AES256?e.NewObjectMetadata.Ssealgorithm=s.S3EncryptionAlgorithm.AES256:this.selectedEncryption.encryption===t.AWSKMS&&(e.NewObjectMetadata.Ssealgorithm=s.S3EncryptionAlgorithm.KMS,this.selectedEncryption.kmsId&&(e.SSEAwsKmsKeyId=this.selectedEncryption.kmsId.value===t.CUSTOM_ARN?this.selectedEncryption.customKMSARN:this.selectedEncryption.kmsId.value))}},e.prototype.callCreateJob=function(){var e=this;this.jobsApiService.createJob(this.currentRegion,this.jobDescription,this.operation,this.getReportConfig(),this.UUIDService.generateUUID(),this.getManifestConfig(),this.jobPriority,this.iamRoleArn).then(function(t){e.$location.search(u.S3Constants.ACTION_SUCCESS_PARAM,s.JobConsoleAction.create),e.$location.search(u.S3Constants.JOB_ID_PARAM,t.JobId),e.$location.path("/"+u.S3Constants.PATH_SEGMENTS.JOBS)}).catch(function(t){e.actionError=o.jobErrorAlert.get(e.actionName,t,e.$translate)}).finally(function(){e.isWorking=!1})},e.prototype.removeS3Prefix=function(e){var t=e;return t&&t.startsWith("s3://")&&(t=t.replace("s3://","")),t},e.prototype.checkForManifestParam=function(){this.$routeParams.manifest&&(this.manifestPath=this.$routeParams.manifest,this.manifestFromInventory=!0,this.$location.search(u.S3Constants.JOB_MANIFEST_PARAM,null).replace(),this.processManifestETag())},e.prototype.prepareIAMTemplate=function(e){var t=this.manifestPath,n=this.jobReportDestination;if(t){if(t=this.removeS3Prefix(t),this.isManifestInventoryReport()){var r=t.split("/");r.length>0&&(r.pop(),r.push("*")),t=r.join("/")}e=e.replace(/{{ManifestBucket}}/g,t)}if(n&&(e=e.replace(/{{ReportBucket}}/g,this.removeS3Prefix(n))),this.operation.TargetResource){var i=this.parseS3Path(this.operation.TargetResource);e=e.replace(/{{DestinationBucket}}/g,i.bucket)}if(this.operation.FunctionArn){var a=this.operation.FunctionArn;e=e.replace(/{{LambdaFunctionARN}}/g,a)}return e=e.replace(/{{S3ResourceARN}}/g,this.UtilService.getARNPrefix("S3"))},e.$inject=["$filter","$routeParams","Region","$location","APIProxyService","LambdaService","ConsoleOperation","$translate","IAMService","UtilService","FAC","SCLogService","BucketPropertiesService","JobsApiService","JobPropertiesService","UUIDService","JobDocLinksService","RegionStatesService","PerformanceUtilsService"],e}();t.CreateJobController=f,i.module("s3").controller("CreateJobController",f)},function(e,t,n){"use strict";(function(e){e.module("s3").directive("propertiesDisplay",function(){return{restrict:"E",scope:{definition:"<"},template:n(859)}})}).call(t,n(0))},,function(e,t,n){"use strict";n(233),n(234)},function(e,t){},function(e,t,n){"use strict";n(0),n(149),n(150),n(151),n(152),n(153),n(154),n(240),window.d3=n(439),n(189),n(440),n(441),n(442),n(443),n(444),n(191),n(192),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(17),n(496),n(497),n(498),n(499),n(501),n(503),n(505),n(507),n(508),n(510),n(512),n(514),n(516),n(518),n(520),n(522),n(524),n(526),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(534),n(535),n(537),n(538),n(539),n(540),n(541),n(542),n(543),n(544),n(545),n(546),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(555),n(556),n(557),n(559),n(561),n(563),n(565),n(567),n(569),n(571),n(573),n(575),n(577),n(578),n(654),n(656),n(658),n(660),n(662),n(663),n(664),n(665),n(666),n(667),n(668),n(669),n(670),n(671),n(673),n(674),n(675),n(676),n(677),n(679),n(681),n(682),n(683),n(684),n(685),n(686),n(687),n(689),n(690),n(692),n(694),n(696),n(698),n(699),n(701),n(703),n(705),n(707),n(709),n(711),n(713),n(715),n(717),n(719),n(721),n(723),n(724),n(726),n(728),n(730),n(732),n(734),n(735),n(737),n(740),n(742),n(744),n(746),n(748),n(750),n(752),n(753),n(755),n(756),n(757),n(758),n(760),n(762),n(764),n(765),n(766),n(768),n(770),n(772),n(774),n(776),n(778),n(779),n(781),n(782),n(783),n(785),n(787),n(789),n(790),n(792),n(794),n(796),n(798),n(800),n(801),n(802),n(803),n(804),n(805),n(807),n(808),n(809),n(811),n(812),n(814),n(816),n(818),n(820),n(822),n(823),n(825),n(826),n(827),n(829);n(830),n(831),n(832),n(833),n(834),n(836),n(838),n(839),n(840),n(841),n(229),n(842),n(843),n(845),n(847),n(848),n(850),n(852),n(854),n(856),n(857),n(230),n(230),n(860),n(861),n(862)},,,,,,function(e,t,n){"use strict";(function(e){n(241),n(438),e._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),e._babelPolyfill=!0}).call(t,n(36))},function(e,t,n){n(242),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(322),n(323),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(122),n(346),n(347),n(173),n(348),n(349),n(350),n(351),n(352),n(176),n(178),n(179),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),e.exports=n(30)},function(e,t,n){"use strict";var r=n(5),i=n(23),a=n(11),o=n(1),s=n(21),c=n(39).KEY,l=n(7),u=n(78),d=n(56),p=n(43),f=n(10),g=n(156),m=n(102),h=n(243),b=n(81),v=n(4),E=n(8),S=n(24),y=n(31),A=n(42),C=n(46),_=n(159),w=n(25),T=n(12),R=n(44),O=w.f,k=T.f,I=_.f,P=r.Symbol,N=r.JSON,M=N&&N.stringify,L=f("_hidden"),x=f("toPrimitive"),D={}.propertyIsEnumerable,j=u("symbol-registry"),B=u("symbols"),F=u("op-symbols"),U=Object.prototype,K="function"==typeof P,V=r.QObject,G=!V||!V.prototype||!V.prototype.findChild,Y=a&&l(function(){return 7!=C(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=O(U,t);r&&delete U[t],k(e,t,n),r&&e!==U&&k(U,t,r)}:k,W=function(e){var t=B[e]=C(P.prototype);return t._k=e,t},z=K&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},$=function(e,t,n){return e===U&&$(F,t,n),v(e),t=y(t,!0),v(n),i(B,t)?(n.enumerable?(i(e,L)&&e[L][t]&&(e[L][t]=!1),n=C(n,{enumerable:A(0,!1)})):(i(e,L)||k(e,L,A(1,{})),e[L][t]=!0),Y(e,t,n)):k(e,t,n)},H=function(e,t){v(e);for(var n,r=h(t=S(t)),i=0,a=r.length;a>i;)$(e,n=r[i++],t[n]);return e},q=function(e,t){return void 0===t?C(e):H(C(e),t)},J=function(e){var t=D.call(this,e=y(e,!0));return!(this===U&&i(B,e)&&!i(F,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,L)&&this[L][e])||t)},X=function(e,t){if(e=S(e),t=y(t,!0),e!==U||!i(B,t)||i(F,t)){var n=O(e,t);return!n||!i(B,t)||i(e,L)&&e[L][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=I(S(e)),r=[],a=0;n.length>a;)i(B,t=n[a++])||t==L||t==c||r.push(t);return r},Q=function(e){for(var t,n=e===U,r=I(n?F:S(e)),a=[],o=0;r.length>o;)!i(B,t=r[o++])||n&&!i(U,t)||a.push(B[t]);return a};K||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(F,n),i(this,L)&&i(this[L],e)&&(this[L][e]=!1),Y(this,e,A(1,n))};return a&&G&&Y(U,e,{configurable:!0,set:t}),W(e)},s(P.prototype,"toString",function(){return this._k}),w.f=X,T.f=$,n(47).f=_.f=Z,n(70).f=J,n(80).f=Q,a&&!n(40)&&s(U,"propertyIsEnumerable",J,!0),g.f=function(e){return W(f(e))}),o(o.G+o.W+o.F*!K,{Symbol:P});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)f(ee[te++]);for(var ne=R(f.store),re=0;ne.length>re;)m(ne[re++]);o(o.S+o.F*!K,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=P(e)},keyFor:function(e){if(!z(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!K,"Object",{create:q,defineProperty:$,defineProperties:H,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),N&&o(o.S+o.F*(!K||l(function(){var e=P();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(E(t)||void 0!==e)&&!z(e))return b(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!z(t))return t}),r[1]=t,M.apply(N,r)}}),P.prototype[x]||n(20)(P.prototype,x,P.prototype.valueOf),d(P,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(e,t,n){var r=n(44),i=n(80),a=n(70);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var o,s=n(e),c=a.f,l=0;s.length>l;)c.call(e,o=s[l++])&&t.push(o);return t}},function(e,t,n){var r=n(1);r(r.S,"Object",{create:n(46)})},function(e,t,n){var r=n(1);r(r.S+r.F*!n(11),"Object",{defineProperty:n(12).f})},function(e,t,n){var r=n(1);r(r.S+r.F*!n(11),"Object",{defineProperties:n(158)})},function(e,t,n){var r=n(24),i=n(25).f;n(34)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},function(e,t,n){var r=n(15),i=n(26);n(34)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(15),i=n(44);n(34)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){n(34)("getOwnPropertyNames",function(){return n(159).f})},function(e,t,n){var r=n(8),i=n(39).onFreeze;n(34)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(8),i=n(39).onFreeze;n(34)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(8),i=n(39).onFreeze;n(34)("preventExtensions",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(8);n(34)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(8);n(34)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(8);n(34)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){var r=n(1);r(r.S+r.F,"Object",{assign:n(160)})},function(e,t,n){var r=n(1);r(r.S,"Object",{is:n(259)})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(1);r(r.S,"Object",{setPrototypeOf:n(106).set})},function(e,t,n){"use strict";var r=n(71),i={};i[n(10)("toStringTag")]="z",i+""!="[object z]"&&n(21)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){var r=n(1);r(r.P,"Function",{bind:n(161)})},function(e,t,n){var r=n(12).f,i=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in i||n(11)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(8),i=n(26),a=n(10)("hasInstance"),o=Function.prototype;a in o||n(12).f(o,a,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(1),i=n(163);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(1),i=n(164);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(5),i=n(23),a=n(28),o=n(108),s=n(31),c=n(7),l=n(47).f,u=n(25).f,d=n(12).f,p=n(57).trim,f=r.Number,g=f,m=f.prototype,h="Number"==a(n(46)(m)),b="trim"in String.prototype,v=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=b?t.trim():p(t,3);var n,r,i,a=t.charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,c=t.slice(2),l=0,u=c.length;l<u;l++)if((o=c.charCodeAt(l))<48||o>i)return NaN;return parseInt(c,r)}}return+t};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof f&&(h?c(function(){m.valueOf.call(n)}):"Number"!=a(n))?o(new g(v(t)),n,f):v(t)};for(var E,S=n(11)?l(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0;S.length>y;y++)i(g,E=S[y])&&!i(f,E)&&d(f,E,u(g,E));f.prototype=m,m.constructor=f,n(21)(r,"Number",f)}},function(e,t,n){"use strict";var r=n(1),i=n(33),a=n(165),o=n(109),s=1..toFixed,c=Math.floor,l=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",d=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*l[n],l[n]=r%1e7,r=c(r/1e7)},p=function(e){for(var t=6,n=0;--t>=0;)n+=l[t],l[t]=c(n/e),n=n%e*1e7},f=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==l[e]){var n=String(l[e]);t=""===t?n:t+o.call("0",7-n.length)+n}return t},g=function(e,t,n){return 0===t?n:t%2==1?g(e,t-1,n*e):g(e*e,t/2,n)},m=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(7)(function(){s.call({})})),"Number",{toFixed:function(e){var t,n,r,s,c=a(this,u),l=i(e),h="",b="0";if(l<0||l>20)throw RangeError(u);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(h="-",c=-c),c>1e-21)if(t=m(c*g(2,69,1))-69,n=t<0?c*g(2,-t,1):c/g(2,t,1),n*=4503599627370496,(t=52-t)>0){for(d(0,n),r=l;r>=7;)d(1e7,0),r-=7;for(d(g(10,r,1),0),r=t-1;r>=23;)p(1<<23),r-=23;p(1<<r),d(1,1),p(2),b=f()}else d(0,n),d(1<<-t,0),b=f()+o.call("0",l);return l>0?(s=b.length,b=h+(s<=l?"0."+o.call("0",l-s)+b:b.slice(0,s-l)+"."+b.slice(s-l))):b=h+b,b}})},function(e,t,n){"use strict";var r=n(1),i=n(7),a=n(165),o=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==o.call(1,void 0)})||!i(function(){o.call({})})),"Number",{toPrecision:function(e){var t=a(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},function(e,t,n){var r=n(1);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(1),i=n(5).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(1);r(r.S,"Number",{isInteger:n(166)})},function(e,t,n){var r=n(1);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(1),i=n(166),a=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&a(e)<=9007199254740991}})},function(e,t,n){var r=n(1);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(1);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(1),i=n(164);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(1),i=n(163);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(1),i=n(167),a=Math.sqrt,o=Math.acosh;r(r.S+r.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+a(e-1)*a(e+1))}})},function(e,t,n){function r(e){return isFinite(e=+e)&&0!=e?e<0?-r(-e):Math.log(e+Math.sqrt(e*e+1)):e}var i=n(1),a=Math.asinh;i(i.S+i.F*!(a&&1/a(0)>0),"Math",{asinh:r})},function(e,t,n){var r=n(1),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(1),i=n(110);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(1),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(1),i=n(111);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(1);r(r.S,"Math",{fround:n(168)})},function(e,t,n){var r=n(1),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,a=0,o=0,s=arguments.length,c=0;o<s;)n=i(arguments[o++]),c<n?(r=c/n,a=a*r*r+1,c=n):n>0?(r=n/c,a+=r*r):a+=n;return c===1/0?1/0:c*Math.sqrt(a)}})},function(e,t,n){var r=n(1),i=Math.imul;r(r.S+r.F*n(7)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,a=65535&r;return 0|i*a+((65535&n>>>16)*a+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(1);r(r.S,"Math",{log1p:n(167)})},function(e,t,n){var r=n(1);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(1);r(r.S,"Math",{sign:n(110)})},function(e,t,n){var r=n(1),i=n(111),a=Math.exp;r(r.S+r.F*n(7)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(a(e-1)-a(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(1),i=n(111),a=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(a(e)+a(-e))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(1),i=n(45),a=String.fromCharCode,o=String.fromCodePoint;r(r.S+r.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(1),i=n(24),a=n(13);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=a(t.length),r=arguments.length,o=[],s=0;n>s;)o.push(String(t[s++])),s<r&&o.push(String(arguments[s]));return o.join("")}})},function(e,t,n){"use strict";n(57)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var r=n(112)(!0);n(113)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(1),i=n(112)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(1),i=n(13),a=n(115),o="".endsWith;r(r.P+r.F*n(116)("endsWith"),"String",{endsWith:function(e){var t=a(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),c=String(e);return o?o.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,n){"use strict";var r=n(1),i=n(115);r(r.P+r.F*n(116)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(1);r(r.P,"String",{repeat:n(109)})},function(e,t,n){"use strict";var r=n(1),i=n(13),a=n(115),o="".startsWith;r(r.P+r.F*n(116)("startsWith"),"String",{startsWith:function(e){var t=a(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return o?o.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(22)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(22)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(22)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(22)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";n(22)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(22)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(22)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";n(22)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";n(22)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";n(22)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";n(22)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(22)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(22)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(1),i=n(15),a=n(31);r(r.P+r.F*n(7)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),n=a(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(1),i=n(321);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(7),i=Date.prototype.getTime,a=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-5e13-1))})||!r(function(){a.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:a},function(e,t,n){var r=Date.prototype,i=r.toString,a=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(21)(r,"toString",function(){var e=a.call(this);return e===e?i.call(this):"Invalid Date"})},function(e,t,n){var r=n(10)("toPrimitive"),i=Date.prototype;r in i||n(20)(i,r,n(324))},function(e,t,n){"use strict";var r=n(4),i=n(31);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){var r=n(1);r(r.S,"Array",{isArray:n(81)})},function(e,t,n){"use strict";var r=n(27),i=n(1),a=n(15),o=n(169),s=n(117),c=n(13),l=n(118),u=n(119);i(i.S+i.F*!n(83)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,d,p=a(e),f="function"==typeof this?this:Array,g=arguments.length,m=g>1?arguments[1]:void 0,h=void 0!==m,b=0,v=u(p);if(h&&(m=r(m,g>2?arguments[2]:void 0,2)),void 0==v||f==Array&&s(v))for(t=c(p.length),n=new f(t);t>b;b++)l(n,b,h?m(p[b],b):p[b]);else for(d=v.call(p),n=new f;!(i=d.next()).done;b++)l(n,b,h?o(d,m,[i.value,b],!0):i.value);return n.length=b,n}})},function(e,t,n){"use strict";var r=n(1),i=n(118);r(r.S+r.F*n(7)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(1),i=n(24),a=[].join;r(r.P+r.F*(n(69)!=Object||!n(29)(a)),"Array",{join:function(e){return a.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(1),i=n(105),a=n(28),o=n(45),s=n(13),c=[].slice;r(r.P+r.F*n(7)(function(){i&&c.call(i)}),"Array",{slice:function(e,t){var n=s(this.length),r=a(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=o(e,n),l=o(t,n),u=s(l-i),d=new Array(u),p=0;p<u;p++)d[p]="String"==r?this.charAt(i+p):this[i+p];return d}})},function(e,t,n){"use strict";var r=n(1),i=n(18),a=n(15),o=n(7),s=[].sort,c=[1,2,3];r(r.P+r.F*(o(function(){c.sort(void 0)})||!o(function(){c.sort(null)})||!n(29)(s)),"Array",{sort:function(e){return void 0===e?s.call(a(this)):s.call(a(this),i(e))}})},function(e,t,n){"use strict";var r=n(1),i=n(35)(0),a=n(29)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(8),i=n(81),a=n(10)("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(1),i=n(35)(1);r(r.P+r.F*!n(29)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),i=n(35)(2);r(r.P+r.F*!n(29)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),i=n(35)(3);r(r.P+r.F*!n(29)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),i=n(35)(4);r(r.P+r.F*!n(29)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),i=n(170);r(r.P+r.F*!n(29)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(1),i=n(170);r(r.P+r.F*!n(29)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(1),i=n(79)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(o||!n(29)(a)),"Array",{indexOf:function(e){return o?a.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),i=n(24),a=n(33),o=n(13),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(29)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=o(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,a(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(1);r(r.P,"Array",{copyWithin:n(171)}),n(41)("copyWithin")},function(e,t,n){var r=n(1);r(r.P,"Array",{fill:n(121)}),n(41)("fill")},function(e,t,n){"use strict";var r=n(1),i=n(35)(5),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(41)("find")},function(e,t,n){"use strict";var r=n(1),i=n(35)(6),a="findIndex",o=!0;a in[]&&Array(1)[a](function(){o=!1}),r(r.P+r.F*o,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(41)(a)},function(e,t,n){n(48)("Array")},function(e,t,n){var r=n(5),i=n(108),a=n(12).f,o=n(47).f,s=n(82),c=n(84),l=r.RegExp,u=l,d=l.prototype,p=/a/g,f=/a/g,g=new l(p)!==p;if(n(11)&&(!g||n(7)(function(){return f[n(10)("match")]=!1,l(p)!=p||l(f)==f||"/a/i"!=l(p,"i")}))){l=function(e,t){var n=this instanceof l,r=s(e),a=void 0===t;return!n&&r&&e.constructor===l&&a?e:i(g?new u(r&&!a?e.source:e,t):u((r=e instanceof l)?e.source:e,r&&a?c.call(e):t),n?this:d,l)};for(var m=o(u),h=0;m.length>h;)!function(e){e in l||a(l,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})}(m[h++]);d.constructor=l,l.prototype=d,n(21)(r,"RegExp",l)}n(48)("RegExp")},function(e,t,n){"use strict";n(173);var r=n(4),i=n(84),a=n(11),o=/./.toString,s=function(e){n(21)(RegExp.prototype,"toString",e,!0)};n(7)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?s(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=o.name&&s(function(){return o.call(this)})},function(e,t,n){n(85)("match",1,function(e,t,n){return[function(n){"use strict";var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(85)("replace",2,function(e,t,n){return[function(r,i){"use strict";var a=e(this),o=void 0==r?void 0:r[t];return void 0!==o?o.call(r,a,i):n.call(String(a),r,i)},n]})},function(e,t,n){n(85)("search",1,function(e,t,n){return[function(n){"use strict";var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(85)("split",2,function(e,t,r){"use strict";var i=n(82),a=r,o=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var c=void 0===/()??/.exec("")[1];r=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return a.call(n,e,t);var r,l,u,d,p,f=[],g=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,h=void 0===t?4294967295:t>>>0,b=new RegExp(e.source,g+"g");for(c||(r=new RegExp("^"+b.source+"$(?!\\s)",g));(l=b.exec(n))&&!((u=l.index+l[0][s])>m&&(f.push(n.slice(m,l.index)),!c&&l[s]>1&&l[0].replace(r,function(){for(p=1;p<arguments[s]-2;p++)void 0===arguments[p]&&(l[p]=void 0)}),l[s]>1&&l.index<n[s]&&o.apply(f,l.slice(1)),d=l[0][s],m=u,f[s]>=h));)b.lastIndex===l.index&&b.lastIndex++;return m===n[s]?!d&&b.test("")||f.push(""):f.push(n.slice(m)),f[s]>h?f.slice(0,h):f}}else"0".split(void 0,0)[s]&&(r=function(e,t){return void 0===e&&0===t?[]:a.call(this,e,t)});return[function(n,i){var a=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,a,i):r.call(String(a),n,i)},r]})},function(e,t,n){"use strict";var r,i,a,o,s=n(40),c=n(5),l=n(27),u=n(71),d=n(1),p=n(8),f=n(18),g=n(49),m=n(50),h=n(86),b=n(123).set,v=n(124)(),E=n(125),S=n(174),y=n(87),A=n(175),C=c.TypeError,_=c.process,w=_&&_.versions,T=w&&w.v8||"",R=c.Promise,O="process"==u(_),k=function(){},I=i=E.f,P=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(10)("species")]=function(e){e(k,k)};return(O||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==T.indexOf("6.6")&&-1===y.indexOf("Chrome/66")}catch(e){}}(),N=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,i=1==e._s,a=0;n.length>a;)!function(t){var n,a,o,s=i?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{s?(i||(2==e._h&&D(e),e._h=1),!0===s?n=r:(u&&u.enter(),n=s(r),u&&(u.exit(),o=!0)),n===t.promise?l(C("Promise-chain cycle")):(a=N(n))?a.call(n,c,l):c(n)):l(r)}catch(e){u&&!o&&u.exit(),l(e)}}(n[a++]);e._c=[],e._n=!1,t&&!e._h&&L(e)})}},L=function(e){b.call(c,function(){var t,n,r,i=e._v,a=x(e);if(a&&(t=S(function(){O?_.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=O||x(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},x=function(e){return 1!==e._h&&0===(e._a||e._c).length},D=function(e){b.call(c,function(){var t;O?_.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},j=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},B=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw C("Promise can't be resolved itself");(t=N(e))?v(function(){var r={_w:n,_d:!1};try{t.call(e,l(B,r,1),l(j,r,1))}catch(e){j.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){j.call({_w:n,_d:!1},e)}}};P||(R=function(e){g(this,R,"Promise","_h"),f(e),r.call(this);try{e(l(B,this,1),l(j,this,1))}catch(e){j.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(51)(R.prototype,{then:function(e,t){var n=I(h(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=O?_.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new r;this.promise=e,this.resolve=l(B,e,1),this.reject=l(j,e,1)},E.f=I=function(e){return e===R||e===o?new a(e):i(e)}),d(d.G+d.W+d.F*!P,{Promise:R}),n(56)(R,"Promise"),n(48)("Promise"),o=n(30).Promise,d(d.S+d.F*!P,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!P),"Promise",{resolve:function(e){return A(s&&this===o?R:this,e)}}),d(d.S+d.F*!(P&&n(83)(function(e){R.all(e).catch(k)})),"Promise",{all:function(e){var t=this,n=I(t),r=n.resolve,i=n.reject,a=S(function(){var n=[],a=0,o=1;m(e,!1,function(e){var s=a++,c=!1;n.push(void 0),o++,t.resolve(e).then(function(e){c||(c=!0,n[s]=e,--o||r(n))},i)}),--o||r(n)});return a.e&&i(a.v),n.promise},race:function(e){var t=this,n=I(t),r=n.reject,i=S(function(){m(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(180),i=n(59);n(88)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(1),i=n(89),a=n(126),o=n(4),s=n(45),c=n(13),l=n(8),u=n(5).ArrayBuffer,d=n(86),p=a.ArrayBuffer,f=a.DataView,g=i.ABV&&u.isView,m=p.prototype.slice,h=i.VIEW;r(r.G+r.W+r.F*(u!==p),{ArrayBuffer:p}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return g&&g(e)||l(e)&&h in e}}),r(r.P+r.U+r.F*n(7)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(o(this),e);for(var n=o(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),a=new(d(this,p))(c(i-r)),l=new f(this),u=new f(a),g=0;r<i;)u.setUint8(g++,l.getUint8(r++));return a}}),n(48)("ArrayBuffer")},function(e,t,n){var r=n(1);r(r.G+r.W+r.F*!n(89).ABV,{DataView:n(126).DataView})},function(e,t,n){n(37)("Int8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}},!0)},function(e,t,n){n(37)("Int16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Uint16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Int32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Uint32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Float32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(37)("Float64",8,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){var r=n(1),i=n(18),a=n(4),o=(n(5).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(7)(function(){o(function(){})}),"Reflect",{apply:function(e,t,n){var r=i(e),c=a(n);return o?o(r,t,c):s.call(r,t,c)}})},function(e,t,n){var r=n(1),i=n(46),a=n(18),o=n(4),s=n(8),c=n(7),l=n(161),u=(n(5).Reflect||{}).construct,d=c(function(){function e(){}return!(u(function(){},[],e)instanceof e)}),p=!c(function(){u(function(){})});r(r.S+r.F*(d||p),"Reflect",{construct:function(e,t){a(e),o(t);var n=arguments.length<3?e:a(arguments[2]);if(p&&!d)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}var c=n.prototype,f=i(s(c)?c:Object.prototype),g=Function.apply.call(e,f,t);return s(g)?g:f}})},function(e,t,n){var r=n(12),i=n(1),a=n(4),o=n(31);i(i.S+i.F*n(7)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){a(e),t=o(t,!0),a(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(1),i=n(25).f,a=n(4);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(a(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(1),i=n(4),a=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(114)(a,"Object",function(){var e,t=this,n=t._k;do{if(t._i>=n.length)return{value:void 0,done:!0}}while(!((e=n[t._i++])in t._t));return{value:e,done:!1}}),r(r.S,"Reflect",{enumerate:function(e){return new a(e)}})},function(e,t,n){function r(e,t){var n,s,u=arguments.length<3?e:arguments[2];return l(e)===u?e[t]:(n=i.f(e,t))?o(n,"value")?n.value:void 0!==n.get?n.get.call(u):void 0:c(s=a(e))?r(s,t,u):void 0}var i=n(25),a=n(26),o=n(23),s=n(1),c=n(8),l=n(4);s(s.S,"Reflect",{get:r})},function(e,t,n){var r=n(25),i=n(1),a=n(4);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(a(e),t)}})},function(e,t,n){var r=n(1),i=n(26),a=n(4);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(a(e))}})},function(e,t,n){var r=n(1);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(1),i=n(4),a=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!a||a(e)}})},function(e,t,n){var r=n(1);r(r.S,"Reflect",{ownKeys:n(182)})},function(e,t,n){var r=n(1),i=n(4),a=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return a&&a(e),!0}catch(e){return!1}}})},function(e,t,n){function r(e,t,n){var c,p,f=arguments.length<4?e:arguments[3],g=a.f(u(e),t);if(!g){if(d(p=o(e)))return r(p,t,n,f);g=l(0)}if(s(g,"value")){if(!1===g.writable||!d(f))return!1;if(c=a.f(f,t)){if(c.get||c.set||!1===c.writable)return!1;c.value=n,i.f(f,t,c)}else i.f(f,t,l(0,n));return!0}return void 0!==g.set&&(g.set.call(f,n),!0)}var i=n(12),a=n(25),o=n(26),s=n(23),c=n(1),l=n(42),u=n(4),d=n(8);c(c.S,"Reflect",{set:r})},function(e,t,n){var r=n(1),i=n(106);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(1),i=n(79)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(41)("includes")},function(e,t,n){"use strict";var r=n(1),i=n(183),a=n(15),o=n(13),s=n(18),c=n(120);r(r.P,"Array",{flatMap:function(e){var t,n,r=a(this);return s(e),t=o(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(41)("flatMap")},function(e,t,n){"use strict";var r=n(1),i=n(183),a=n(15),o=n(13),s=n(33),c=n(120);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=a(this),n=o(t.length),r=c(t,0);return i(r,t,t,n,0,void 0===e?1:s(e)),r}}),n(41)("flatten")},function(e,t,n){"use strict";var r=n(1),i=n(112)(!0);r(r.P,"String",{at:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(1),i=n(184),a=n(87);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var r=n(1),i=n(184),a=n(87);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(a),"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(57)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,n){"use strict";n(57)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,n){"use strict";var r=n(1),i=n(32),a=n(13),o=n(82),s=n(84),c=RegExp.prototype,l=function(e,t){this._r=e,this._s=t};n(114)(l,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),r(r.P,"String",{matchAll:function(e){if(i(this),!o(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in c?String(e.flags):s.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=a(e.lastIndex),new l(r,t)}})},function(e,t,n){n(102)("asyncIterator")},function(e,t,n){n(102)("observable")},function(e,t,n){var r=n(1),i=n(182),a=n(24),o=n(25),s=n(118);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),c=o.f,l=i(r),u={},d=0;l.length>d;)void 0!==(n=c(r,t=l[d++]))&&s(u,t,n);return u}})},function(e,t,n){var r=n(1),i=n(185)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){var r=n(1),i=n(185)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(1),i=n(15),a=n(18),o=n(12);n(11)&&r(r.P+n(90),"Object",{__defineGetter__:function(e,t){o.f(i(this),e,{get:a(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(1),i=n(15),a=n(18),o=n(12);n(11)&&r(r.P+n(90),"Object",{__defineSetter__:function(e,t){o.f(i(this),e,{set:a(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(1),i=n(15),a=n(31),o=n(26),s=n(25).f;n(11)&&r(r.P+n(90),"Object",{__lookupGetter__:function(e){var t,n=i(this),r=a(e,!0);do{if(t=s(n,r))return t.get}while(n=o(n))}})},function(e,t,n){"use strict";var r=n(1),i=n(15),a=n(31),o=n(26),s=n(25).f;n(11)&&r(r.P+n(90),"Object",{__lookupSetter__:function(e){var t,n=i(this),r=a(e,!0);do{if(t=s(n,r))return t.set}while(n=o(n))}})},function(e,t,n){var r=n(1);r(r.P+r.R,"Map",{toJSON:n(186)("Map")})},function(e,t,n){var r=n(1);r(r.P+r.R,"Set",{toJSON:n(186)("Set")})},function(e,t,n){n(91)("Map")},function(e,t,n){n(91)("Set")},function(e,t,n){n(91)("WeakMap")},function(e,t,n){n(91)("WeakSet")},function(e,t,n){n(92)("Map")},function(e,t,n){n(92)("Set")},function(e,t,n){n(92)("WeakMap")},function(e,t,n){n(92)("WeakSet")},function(e,t,n){var r=n(1);r(r.G,{global:n(5)})},function(e,t,n){var r=n(1);r(r.S,"System",{global:n(5)})},function(e,t,n){var r=n(1),i=n(28);r(r.S,"Error",{isError:function(e){return"Error"===i(e)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){var r=n(1),i=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*i}})},function(e,t,n){var r=n(1),i=n(188),a=n(168);r(r.S,"Math",{fscale:function(e,t,n,r,o){return a(i(e,t,n,r,o))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{iaddh:function(e,t,n,r){var i=e>>>0,a=t>>>0,o=n>>>0;return a+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(e,t,n){var r=n(1);r(r.S,"Math",{isubh:function(e,t,n,r){var i=e>>>0,a=t>>>0,o=n>>>0;return a-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(e,t,n){var r=n(1);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,i=65535&n,a=65535&r,o=n>>16,s=r>>16,c=(o*a>>>0)+(i*a>>>16);return o*s+(c>>16)+((i*s>>>0)+(65535&c)>>16)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){var r=n(1),i=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*i}})},function(e,t,n){var r=n(1);r(r.S,"Math",{scale:n(188)})},function(e,t,n){var r=n(1);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,i=65535&n,a=65535&r,o=n>>>16,s=r>>>16,c=(o*a>>>0)+(i*a>>>16);return o*s+(c>>>16)+((i*s>>>0)+(65535&c)>>>16)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var r=n(1),i=n(30),a=n(5),o=n(86),s=n(175);r(r.P+r.R,"Promise",{finally:function(e){var t=o(this,i.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(1),i=n(125),a=n(174);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=a(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var r=n(38),i=n(4),a=r.key,o=r.set;r.exp({defineMetadata:function(e,t,n,r){o(e,t,i(n),a(r))}})},function(e,t,n){var r=n(38),i=n(4),a=r.key,o=r.map,s=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:a(arguments[2]),r=o(i(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var c=s.get(t);return c.delete(n),!!c.size||s.delete(t)}})},function(e,t,n){var r=n(38),i=n(4),a=n(26),o=r.has,s=r.get,c=r.key,l=function(e,t,n){if(o(e,t,n))return s(e,t,n);var r=a(t);return null!==r?l(e,r,n):void 0};r.exp({getMetadata:function(e,t){return l(e,i(t),arguments.length<3?void 0:c(arguments[2]))}})},function(e,t,n){var r=n(178),i=n(187),a=n(38),o=n(4),s=n(26),c=a.keys,l=a.key,u=function(e,t){var n=c(e,t),a=s(e);if(null===a)return n;var o=u(a,t);return o.length?n.length?i(new r(n.concat(o))):o:n};a.exp({getMetadataKeys:function(e){return u(o(e),arguments.length<2?void 0:l(arguments[1]))}})},function(e,t,n){var r=n(38),i=n(4),a=r.get,o=r.key;r.exp({getOwnMetadata:function(e,t){return a(e,i(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var r=n(38),i=n(4),a=r.keys,o=r.key;r.exp({getOwnMetadataKeys:function(e){return a(i(e),arguments.length<2?void 0:o(arguments[1]))}})},function(e,t,n){var r=n(38),i=n(4),a=n(26),o=r.has,s=r.key,c=function(e,t,n){if(o(e,t,n))return!0;var r=a(t);return null!==r&&c(e,r,n)};r.exp({hasMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var r=n(38),i=n(4),a=r.has,o=r.key;r.exp({hasOwnMetadata:function(e,t){return a(e,i(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var r=n(38),i=n(4),a=n(18),o=r.key,s=r.set;r.exp({metadata:function(e,t){return function(n,r){s(e,t,(void 0!==r?i:a)(n),o(r))}}})},function(e,t,n){var r=n(1),i=n(124)(),a=n(5).process,o="process"==n(28)(a);r(r.G,{asap:function(e){var t=o&&a.domain;i(t?t.bind(e):e)}})},function(e,t,n){"use strict";var r=n(1),i=n(5),a=n(30),o=n(124)(),s=n(10)("observable"),c=n(18),l=n(4),u=n(49),d=n(51),p=n(20),f=n(50),g=f.RETURN,m=function(e){return null==e?void 0:c(e)},h=function(e){var t=e._c;t&&(e._c=void 0,t())},b=function(e){return void 0===e._o},v=function(e){b(e)||(e._o=void 0,h(e))},E=function(e,t){l(e),this._c=void 0,this._o=e,e=new S(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:c(n),this._c=n)}catch(t){return void e.error(t)}b(this)&&h(this)};E.prototype=d({},{unsubscribe:function(){v(this)}});var S=function(e){this._s=e};S.prototype=d({},{next:function(e){var t=this._s;if(!b(t)){var n=t._o;try{var r=m(n.next);if(r)return r.call(n,e)}catch(e){try{v(t)}finally{throw e}}}},error:function(e){var t=this._s;if(b(t))throw e;var n=t._o;t._o=void 0;try{var r=m(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{h(t)}finally{throw e}}return h(t),e},complete:function(e){var t=this._s;if(!b(t)){var n=t._o;t._o=void 0;try{var r=m(n.complete);e=r?r.call(n,e):void 0}catch(e){try{h(t)}finally{throw e}}return h(t),e}}});var y=function(e){u(this,y,"Observable","_f")._f=c(e)};d(y.prototype,{subscribe:function(e){return new E(e,this._f)},forEach:function(e){var t=this;return new(a.Promise||i.Promise)(function(n,r){c(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:n})})}}),d(y,{from:function(e){var t="function"==typeof this?this:y,n=m(l(e)[s]);if(n){var r=l(n.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var n=!1;return o(function(){if(!n){try{if(f(e,!1,function(e){if(t.next(e),n)return g})===g)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:y)(function(e){var t=!1;return o(function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}}),function(){t=!0}})}}),p(y.prototype,s,function(){return this}),r(r.G,{Observable:y}),n(48)("Observable")},function(e,t,n){var r=n(5),i=n(1),a=n(87),o=[].slice,s=/MSIE .\./.test(a),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&o.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(1),i=n(123);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(122),i=n(44),a=n(21),o=n(5),s=n(20),c=n(58),l=n(10),u=l("iterator"),d=l("toStringTag"),p=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=i(f),m=0;m<g.length;m++){var h,b=g[m],v=f[b],E=o[b],S=E&&E.prototype;if(S&&(S[u]||s(S,u,p),S[d]||s(S,d,b),c[b]=p,v))for(h in r)S[h]||a(S,h,r[h],!0)}},function(e,t){!function(t){"use strict";function n(e,t,n,r){var a=t&&t.prototype instanceof i?t:i,o=Object.create(a.prototype),s=new f(r||[]);return o._invoke=l(e,n,s),o}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function i(){}function a(){}function o(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(e){function t(n,i,a,o){var s=r(e[n],e,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&v.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},o)}o(s.arg)}function n(e,n){function r(){return new Promise(function(r,i){t(e,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function l(e,t,n){var i=w;return function(a,o){if(i===R)throw new Error("Generator is already running");if(i===O){if("throw"===a)throw o;return m()}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var c=u(s,n);if(c){if(c===k)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===w)throw i=O,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=R;var l=r(e,t,n);if("normal"===l.type){if(i=n.done?O:T,l.arg===k)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=O,n.method="throw",n.arg=l.arg)}}}function u(e,t){var n=e.iterator[t.method];if(n===h){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=h,u(e,t),"throw"===t.method))return k;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,k;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=h),t.delegate=null,k):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,k)}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function g(e){if(e){var t=e[S];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(v.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=h,t.done=!0,t};return r.next=r}}return{next:m}}function m(){return{value:h,done:!0}}var h,b=Object.prototype,v=b.hasOwnProperty,E="function"==typeof Symbol?Symbol:{},S=E.iterator||"@@iterator",y=E.asyncIterator||"@@asyncIterator",A=E.toStringTag||"@@toStringTag",C="object"==typeof e,_=t.regeneratorRuntime;if(_)return void(C&&(e.exports=_));_=t.regeneratorRuntime=C?e.exports:{},_.wrap=n;var w="suspendedStart",T="suspendedYield",R="executing",O="completed",k={},I={};I[S]=function(){return this};var P=Object.getPrototypeOf,N=P&&P(P(g([])));N&&N!==b&&v.call(N,S)&&(I=N);var M=o.prototype=i.prototype=Object.create(I);a.prototype=M.constructor=o,o.constructor=a,o[A]=a.displayName="GeneratorFunction",_.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},_.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,A in e||(e[A]="GeneratorFunction")),e.prototype=Object.create(M),e},_.awrap=function(e){return{__await:e}},s(c.prototype),c.prototype[y]=function(){return this},_.AsyncIterator=c,_.async=function(e,t,r,i){var a=new c(n(e,t,r,i));return _.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},s(M),M[A]="Generator",M[S]=function(){return this},M.toString=function(){return"[object Generator]"},_.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},_.values=g,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=h)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,n.next=t,r&&(n.method="next",n.arg=h),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var o=v.call(i,"catchLoc"),s=v.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&v.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,k):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),k},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),k}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;p(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:g(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=h),k}}}(function(){return this}()||Function("return this")())},function(e,t,n){var r,i;!function(){function a(e){return e&&(e.ownerDocument||e.document||e).documentElement}function o(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function s(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function c(e){return null===e?NaN:+e}function l(e){return!isNaN(e)}function u(e){return{left:function(t,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function(t,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}}function d(e){return e.length}function p(e){for(var t=1;e*t%1;)t*=10;return t}function f(e,t){for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}function g(){this._=Object.create(null)}function m(e){return(e+="")===_o||e[0]===wo?wo+e:e}function h(e){return(e+="")[0]===wo?e.slice(1):e}function b(e){return m(e)in this._}function v(e){return(e=m(e))in this._&&delete this._[e]}function E(){var e=[];for(var t in this._)e.push(h(t));return e}function S(){var e=0;for(var t in this._)++e;return e}function y(){for(var e in this._)return!1;return!0}function A(){this._=Object.create(null)}function C(e){return e}function _(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function w(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0,r=To.length;n<r;++n){var i=To[n]+t;if(i in e)return i}}function T(){}function R(){}function O(e){function t(){for(var t,r=n,i=-1,a=r.length;++i<a;)(t=r[i].on)&&t.apply(this,arguments);return e}var n=[],r=new g;return t.on=function(t,i){var a,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,a=n.indexOf(o)).concat(n.slice(a+1)),r.remove(t)),i&&n.push(r.set(t,{on:i})),e)},t}function k(){fo.event.preventDefault()}function I(){for(var e,t=fo.event;e=t.sourceEvent;)t=e;return t}function P(e){for(var t=new R,n=0,r=arguments.length;++n<r;)t[arguments[n]]=O(t);return t.of=function(n,r){return function(i){try{var a=i.sourceEvent=fo.event;i.target=e,fo.event=i,t[i.type].apply(n,r)}finally{fo.event=a}}},t}function N(e){return Oo(e,No),e}function M(e){return"function"==typeof e?e:function(){return ko(e,this)}}function L(e){return"function"==typeof e?e:function(){return Io(e,this)}}function x(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function a(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function s(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=fo.ns.qualify(e),null==t?e.local?r:n:"function"==typeof t?e.local?s:o:e.local?a:i}function D(e){return e.trim().replace(/\s+/g," ")}function j(e){return new RegExp("(?:^|\\s+)"+fo.requote(e)+"(?:\\s+|$)","g")}function B(e){return(e+"").trim().split(/^|\s+/)}function F(e,t){function n(){for(var n=-1;++n<i;)e[n](this,t)}function r(){for(var n=-1,r=t.apply(this,arguments);++n<i;)e[n](this,r)}e=B(e).map(U);var i=e.length;return"function"==typeof t?r:n}function U(e){var t=j(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||n.setAttribute("class",D(i+" "+e))):n.setAttribute("class",D(i.replace(t," ")))}}function K(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function a(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return null==t?r:"function"==typeof t?a:i}function V(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"==typeof t?i:r}function G(e){function t(){var t=this.ownerDocument,n=this.namespaceURI;return n===Mo&&t.documentElement.namespaceURI===Mo?t.createElement(e):t.createElementNS(n,e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=fo.ns.qualify(e)).local?n:t}function Y(){var e=this.parentNode;e&&e.removeChild(this)}function W(e){return{__data__:e}}function z(e){return function(){return Po(this,e)}}function $(e){return arguments.length||(e=s),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function H(e,t){for(var n=0,r=e.length;n<r;n++)for(var i,a=e[n],o=0,s=a.length;o<s;o++)(i=a[o])&&t(i,o,n);return e}function q(e){return Oo(e,xo),e}function J(e){var t,n;return function(r,i,a){var o,s=e[a].update,c=s.length;for(a!=n&&(n=a,t=0),i>=t&&(t=i+1);!(o=s[t])&&++t<c;);return o}}function X(e,t,n){function r(){var t=this[o];t&&(this.removeEventListener(e,t,t.$),delete this[o])}function i(){var i=c(t,mo(arguments));r.call(this),this.addEventListener(e,this[o]=i,i.$=n),i._=t}function a(){var t,n=new RegExp("^__on([^.]+)"+fo.requote(e)+"$");for(var r in this)if(t=r.match(n)){var i=this[r];this.removeEventListener(t[1],i,i.$),delete this[r]}}var o="__on"+e,s=e.indexOf("."),c=Z;s>0&&(e=e.slice(0,s));var l=Do.get(e);return l&&(e=l,c=Q),s?t?i:r:t?T:a}function Z(e,t){return function(n){var r=fo.event;fo.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{fo.event=r}}}function Q(e,t){var n=Z(e,t);return function(e){var t=this,r=e.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||n.call(t,e)}}function ee(e){var t=".dragsuppress-"+ ++Bo,n="click"+t,r=fo.select(o(e)).on("touchmove"+t,k).on("dragstart"+t,k).on("selectstart"+t,k);if(null==jo&&(jo=!("onselectstart"in e)&&w(e.style,"userSelect")),jo){var i=a(e).style,s=i[jo];i[jo]="none"}return function(e){if(r.on(t,null),jo&&(i[jo]=s),e){var a=function(){r.on(n,null)};r.on(n,function(){k(),a()},!0),setTimeout(a,0)}}}function te(e,t){t.changedTouches&&(t=t.changedTouches[0]);var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(Fo<0){var i=o(e);if(i.scrollX||i.scrollY){n=fo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=n[0][0].getScreenCTM();Fo=!(a.f||a.e),n.remove()}}return Fo?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function ne(){return fo.event.changedTouches[0].identifier}function re(e){return e>0?1:e<0?-1:0}function ie(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function ae(e){return e>1?0:e<-1?Vo:Math.acos(e)}function oe(e){return e>1?Wo:e<-1?-Wo:Math.asin(e)}function se(e){return((e=Math.exp(e))-1/e)/2}function ce(e){return((e=Math.exp(e))+1/e)/2}function le(e){return((e=Math.exp(2*e))-1)/(e+1)}function ue(e){return(e=Math.sin(e/2))*e}function de(){}function pe(e,t,n){return this instanceof pe?(this.h=+e,this.s=+t,void(this.l=+n)):arguments.length<2?e instanceof pe?new pe(e.h,e.s,e.l):Te(""+e,Re,pe):new pe(e,t,n)}function fe(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?a+(o-a)*e/60:e<180?o:e<240?a+(o-a)*(240-e)/60:a}function i(e){return Math.round(255*r(e))}var a,o;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,a=2*n-o,new Ae(i(e+120),i(e),i(e-120))}function ge(e,t,n){return this instanceof ge?(this.h=+e,this.c=+t,void(this.l=+n)):arguments.length<2?e instanceof ge?new ge(e.h,e.c,e.l):e instanceof he?ve(e.l,e.a,e.b):ve((e=Oe((e=fo.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new ge(e,t,n)}function me(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new he(n,Math.cos(e*=zo)*t,Math.sin(e)*t)}function he(e,t,n){return this instanceof he?(this.l=+e,this.a=+t,void(this.b=+n)):arguments.length<2?e instanceof he?new he(e.l,e.a,e.b):e instanceof ge?me(e.h,e.c,e.l):Oe((e=Ae(e)).r,e.g,e.b):new he(e,t,n)}function be(e,t,n){var r=(e+16)/116,i=r+t/500,a=r-n/200;return i=Ee(i)*ts,r=Ee(r)*ns,a=Ee(a)*rs,new Ae(ye(3.2404542*i-1.5371385*r-.4985314*a),ye(-.969266*i+1.8760108*r+.041556*a),ye(.0556434*i-.2040259*r+1.0572252*a))}function ve(e,t,n){return e>0?new ge(Math.atan2(n,t)*$o,Math.sqrt(t*t+n*n),e):new ge(NaN,NaN,e)}function Ee(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function Se(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function ye(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function Ae(e,t,n){return this instanceof Ae?(this.r=~~e,this.g=~~t,void(this.b=~~n)):arguments.length<2?e instanceof Ae?new Ae(e.r,e.g,e.b):Te(""+e,Ae,fe):new Ae(e,t,n)}function Ce(e){return new Ae(e>>16,e>>8&255,255&e)}function _e(e){return Ce(e)+""}function we(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function Te(e,t,n){var r,i,a,o=0,s=0,c=0;if(r=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return n(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(Ie(i[0]),Ie(i[1]),Ie(i[2]))}return(a=os.get(e))?t(a.r,a.g,a.b):(null==e||"#"!==e.charAt(0)||isNaN(a=parseInt(e.slice(1),16))||(4===e.length?(o=(3840&a)>>4,o|=o>>4,s=240&a,s|=s>>4,c=15&a,c|=c<<4):7===e.length&&(o=(16711680&a)>>16,s=(65280&a)>>8,c=255&a)),t(o,s,c))}function Re(e,t,n){var r,i,a=Math.min(e/=255,t/=255,n/=255),o=Math.max(e,t,n),s=o-a,c=(o+a)/2;return s?(i=c<.5?s/(o+a):s/(2-o-a),r=e==o?(t-n)/s+(t<n?6:0):t==o?(n-e)/s+2:(e-t)/s+4,r*=60):(r=NaN,i=c>0&&c<1?0:r),new pe(r,i,c)}function Oe(e,t,n){e=ke(e),t=ke(t),n=ke(n);var r=Se((.4124564*e+.3575761*t+.1804375*n)/ts),i=Se((.2126729*e+.7151522*t+.072175*n)/ns);return he(116*i-16,500*(r-i),200*(i-Se((.0193339*e+.119192*t+.9503041*n)/rs)))}function ke(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ie(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function Pe(e){return"function"==typeof e?e:function(){return e}}function Ne(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),Me(t,n,e,r)}}function Me(e,t,n,r){function i(){var e,t=c.status;if(!t&&xe(c)||t>=200&&t<300||304===t){try{e=n.call(a,c)}catch(e){return void o.error.call(a,e)}o.load.call(a,e)}else o.error.call(a,c)}var a={},o=fo.dispatch("beforesend","progress","load","error"),s={},c=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(e)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=i:c.onreadystatechange=function(){c.readyState>3&&i()},c.onprogress=function(e){var t=fo.event;fo.event=e;try{o.progress.call(a,c)}finally{fo.event=t}},a.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?s[e]:(null==t?delete s[e]:s[e]=t+"",a)},a.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",a):t},a.responseType=function(e){return arguments.length?(l=e,a):l},a.response=function(e){return n=e,a},["get","post"].forEach(function(e){a[e]=function(){return a.send.apply(a,[e].concat(mo(arguments)))}}),a.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),c.open(n,e,!0),null==t||"accept"in s||(s.accept=t+",*/*"),c.setRequestHeader)for(var u in s)c.setRequestHeader(u,s[u]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=l&&(c.responseType=l),null!=i&&a.on("error",i).on("load",function(e){i(null,e)}),o.beforesend.call(a,c),c.send(null==r?null:r),a},a.abort=function(){return c.abort(),a},fo.rebind(a,o,"on"),null==r?a:a.get(Le(r))}function Le(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function xe(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function De(e,t,n){var r=arguments.length;r<2&&(t=0),r<3&&(n=Date.now());var i=n+t,a={c:e,t:i,n:null};return cs?cs.n=a:ss=a,cs=a,ls||(us=clearTimeout(us),ls=1,ds(je)),a}function je(){var e=Be(),t=Fe()-e;t>24?(isFinite(t)&&(clearTimeout(us),us=setTimeout(je,t)),ls=0):(ls=1,ds(je))}function Be(){for(var e=Date.now(),t=ss;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function Fe(){for(var e,t=ss,n=1/0;t;)t.c?(t.t<n&&(n=t.t),t=(e=t).n):t=e?e.n=t.n:ss=t.n;return cs=e,n}function Ue(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function Ke(e,t){var n=Math.pow(10,3*Co(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function Ve(e){var t=e.decimal,n=e.thousands,r=e.grouping,i=e.currency,a=r&&n?function(e,t){for(var i=e.length,a=[],o=0,s=r[0],c=0;i>0&&s>0&&(c+s+1>t&&(s=Math.max(1,t-c)),a.push(e.substring(i-=s,i+s)),!((c+=s+1)>t));)s=r[o=(o+1)%r.length];return a.reverse().join(n)}:C;return function(e){var n=fs.exec(e),r=n[1]||" ",o=n[2]||">",s=n[3]||"-",c=n[4]||"",l=n[5],u=+n[6],d=n[7],p=n[8],f=n[9],g=1,m="",h="",b=!1,v=!0;switch(p&&(p=+p.substring(1)),(l||"0"===r&&"="===o)&&(l=r="0",o="="),f){case"n":d=!0,f="g";break;case"%":g=100,h="%",f="f";break;case"p":g=100,h="%",f="r";break;case"b":case"o":case"x":case"X":"#"===c&&(m="0"+f.toLowerCase());case"c":v=!1;case"d":b=!0,p=0;break;case"s":g=-1,f="r"}"$"===c&&(m=i[0],h=i[1]),"r"!=f||p||(f="g"),null!=p&&("g"==f?p=Math.max(1,Math.min(21,p)):"e"!=f&&"f"!=f||(p=Math.max(0,Math.min(20,p)))),f=gs.get(f)||Ge;var E=l&&d;return function(e){var n=h;if(b&&e%1)return"";var i=e<0||0===e&&1/e<0?(e=-e,"-"):"-"===s?"":s;if(g<0){var c=fo.formatPrefix(e,p);e=c.scale(e),n=c.symbol+h}else e*=g;e=f(e,p);var S,y,A=e.lastIndexOf(".");if(A<0){var C=v?e.lastIndexOf("e"):-1;C<0?(S=e,y=""):(S=e.substring(0,C),y=e.substring(C))}else S=e.substring(0,A),y=t+e.substring(A+1);!l&&d&&(S=a(S,1/0));var _=m.length+S.length+y.length+(E?0:i.length),w=_<u?new Array(_=u-_+1).join(r):"";return E&&(S=a(w+S,w.length?u-y.length:1/0)),i+=m,e=S+y,("<"===o?i+e+w:">"===o?w+i+e:"^"===o?w.substring(0,_>>=1)+i+e+w.substring(_):i+(E?e:w+e))+n}}}function Ge(e){return e+""}function Ye(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function We(e,t,n){function r(t){var n=e(t),r=a(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new hs(n-1)),1),n}function a(e,n){return t(e=new hs(+e),n),e}function o(e,r,a){var o=i(e),s=[];if(a>1)for(;o<r;)n(o)%a||s.push(new Date(+o)),t(o,1);else for(;o<r;)s.push(new Date(+o)),t(o,1);return s}function s(e,t,n){try{hs=Ye;var r=new Ye;return r._=e,o(r,t,n)}finally{hs=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=a,e.range=o;var c=e.utc=ze(e);return c.floor=c,c.round=ze(r),c.ceil=ze(i),c.offset=ze(a),c.range=s,e}function ze(e){return function(t,n){try{hs=Ye;var r=new Ye;return r._=t,e(r,n)._}finally{hs=Date}}}function $e(e){function t(e){function t(t){for(var n,i,a,o=[],s=-1,c=0;++s<r;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(i=vs[n=e.charAt(++s)])&&(n=e.charAt(++s)),(a=O[n])&&(n=a(t,null==i?"e"===n?" ":"0":i)),o.push(n),c=s+1);return o.push(e.slice(c,s)),o.join("")}var r=e.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(n(r,e,t,0)!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&hs!==Ye,a=new(i?Ye:hs);return"j"in r?a.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),a.setFullYear(r.y,0,1),a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(a.getDay()+5)%7:r.w+7*r.U-(a.getDay()+6)%7)):a.setFullYear(r.y,r.m,r.d),a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),i?a._:a},t.toString=function(){return e},t}function n(e,t,n,r){for(var i,a,o,s=0,c=t.length,l=n.length;s<c;){if(r>=l)return-1;if(37===(i=t.charCodeAt(s++))){if(o=t.charAt(s++),!(a=k[o in vs?t.charAt(s++):o])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function r(e,t,n){A.lastIndex=0;var r=A.exec(t.slice(n));return r?(e.w=C.get(r[0].toLowerCase()),n+r[0].length):-1}function i(e,t,n){S.lastIndex=0;var r=S.exec(t.slice(n));return r?(e.w=y.get(r[0].toLowerCase()),n+r[0].length):-1}function a(e,t,n){T.lastIndex=0;var r=T.exec(t.slice(n));return r?(e.m=R.get(r[0].toLowerCase()),n+r[0].length):-1}function o(e,t,n){_.lastIndex=0;var r=_.exec(t.slice(n));return r?(e.m=w.get(r[0].toLowerCase()),n+r[0].length):-1}function s(e,t,r){return n(e,O.c.toString(),t,r)}function c(e,t,r){return n(e,O.x.toString(),t,r)}function l(e,t,r){return n(e,O.X.toString(),t,r)}function u(e,t,n){var r=E.get(t.slice(n,n+=2).toLowerCase());return null==r?-1:(e.p=r,n)}var d=e.dateTime,p=e.date,f=e.time,g=e.periods,m=e.days,h=e.shortDays,b=e.months,v=e.shortMonths;t.utc=function(e){function n(e){try{hs=Ye;var t=new hs;return t._=e,r(t)}finally{hs=Date}}var r=t(e);return n.parse=function(e){try{hs=Ye;var t=r.parse(e);return t&&t._}finally{hs=Date}},n.toString=r.toString,n},t.multi=t.utc.multi=ft;var E=fo.map(),S=qe(m),y=Je(m),A=qe(h),C=Je(h),_=qe(b),w=Je(b),T=qe(v),R=Je(v);g.forEach(function(e,t){E.set(e.toLowerCase(),t)});var O={a:function(e){return h[e.getDay()]},A:function(e){return m[e.getDay()]},b:function(e){return v[e.getMonth()]},B:function(e){return b[e.getMonth()]},c:t(d),d:function(e,t){return He(e.getDate(),t,2)},e:function(e,t){return He(e.getDate(),t,2)},H:function(e,t){return He(e.getHours(),t,2)},I:function(e,t){return He(e.getHours()%12||12,t,2)},j:function(e,t){return He(1+ms.dayOfYear(e),t,3)},L:function(e,t){return He(e.getMilliseconds(),t,3)},m:function(e,t){return He(e.getMonth()+1,t,2)},M:function(e,t){return He(e.getMinutes(),t,2)},p:function(e){return g[+(e.getHours()>=12)]},S:function(e,t){return He(e.getSeconds(),t,2)},U:function(e,t){return He(ms.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return He(ms.mondayOfYear(e),t,2)},x:t(p),X:t(f),y:function(e,t){return He(e.getFullYear()%100,t,2)},Y:function(e,t){return He(e.getFullYear()%1e4,t,4)},Z:dt,"%":function(){return"%"}},k={a:r,A:i,b:a,B:o,c:s,d:at,e:at,H:st,I:st,j:ot,L:ut,m:it,M:ct,p:u,S:lt,U:Ze,w:Xe,W:Qe,x:c,X:l,y:tt,Y:et,Z:nt,"%":pt};return t}function He(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function qe(e){return new RegExp("^(?:"+e.map(fo.requote).join("|")+")","i")}function Je(e){for(var t=new g,n=-1,r=e.length;++n<r;)t.set(e[n].toLowerCase(),n);return t}function Xe(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ze(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n));return r?(e.U=+r[0],n+r[0].length):-1}function Qe(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n));return r?(e.W=+r[0],n+r[0].length):-1}function et(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function tt(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.y=rt(+r[0]),n+r[0].length):-1}function nt(e,t,n){return/^[+-]\d{4}$/.test(t=t.slice(n,n+5))?(e.Z=-t,n+5):-1}function rt(e){return e+(e>68?1900:2e3)}function it(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function at(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ot(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+3));return r?(e.j=+r[0],n+r[0].length):-1}function st(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ct(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function lt(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function ut(e,t,n){Es.lastIndex=0;var r=Es.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function dt(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=Co(t)/60|0,i=Co(t)%60;return n+He(r,"0",2)+He(i,"0",2)}function pt(e,t,n){Ss.lastIndex=0;var r=Ss.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function ft(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,r=e[n];!r[1](t);)r=e[++n];return r[0](t)}}function gt(){}function mt(e,t,n){var r=n.s=e+t,i=r-e,a=r-i;n.t=e-a+(t-i)}function ht(e,t){e&&_s.hasOwnProperty(e.type)&&_s[e.type](e,t)}function bt(e,t,n){var r,i=-1,a=e.length-n;for(t.lineStart();++i<a;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function vt(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)bt(e[n],t,1);t.polygonEnd()}function Et(){function e(e,t){e*=zo,t=t*zo/2+Vo/4;var n=e-r,o=n>=0?1:-1,s=o*n,c=Math.cos(t),l=Math.sin(t),u=a*l,d=i*c+u*Math.cos(s),p=u*o*Math.sin(s);Ts.add(Math.atan2(p,d)),r=e,i=c,a=l}var t,n,r,i,a;Rs.point=function(o,s){Rs.point=e,r=(t=o)*zo,i=Math.cos(s=(n=s)*zo/2+Vo/4),a=Math.sin(s)},Rs.lineEnd=function(){e(t,n)}}function St(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function yt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function At(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ct(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function _t(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function wt(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Tt(e){return[Math.atan2(e[1],e[0]),oe(e[2])]}function Rt(e,t){return Co(e[0]-t[0])<Uo&&Co(e[1]-t[1])<Uo}function Ot(e,t){e*=zo;var n=Math.cos(t*=zo);kt(n*Math.cos(e),n*Math.sin(e),Math.sin(t))}function kt(e,t,n){++Os,Is+=(e-Is)/Os,Ps+=(t-Ps)/Os,Ns+=(n-Ns)/Os}function It(){function e(e,i){e*=zo;var a=Math.cos(i*=zo),o=a*Math.cos(e),s=a*Math.sin(e),c=Math.sin(i),l=Math.atan2(Math.sqrt((l=n*c-r*s)*l+(l=r*o-t*c)*l+(l=t*s-n*o)*l),t*o+n*s+r*c);ks+=l,Ms+=l*(t+(t=o)),Ls+=l*(n+(n=s)),xs+=l*(r+(r=c)),kt(t,n,r)}var t,n,r;Fs.point=function(i,a){i*=zo;var o=Math.cos(a*=zo);t=o*Math.cos(i),n=o*Math.sin(i),r=Math.sin(a),Fs.point=e,kt(t,n,r)}}function Pt(){Fs.point=Ot}function Nt(){function e(e,t){e*=zo;var n=Math.cos(t*=zo),o=n*Math.cos(e),s=n*Math.sin(e),c=Math.sin(t),l=i*c-a*s,u=a*o-r*c,d=r*s-i*o,p=Math.sqrt(l*l+u*u+d*d),f=r*o+i*s+a*c,g=p&&-ae(f)/p,m=Math.atan2(p,f);Ds+=g*l,js+=g*u,Bs+=g*d,ks+=m,Ms+=m*(r+(r=o)),Ls+=m*(i+(i=s)),xs+=m*(a+(a=c)),kt(r,i,a)}var t,n,r,i,a;Fs.point=function(o,s){t=o,n=s,Fs.point=e,o*=zo;var c=Math.cos(s*=zo);r=c*Math.cos(o),i=c*Math.sin(o),a=Math.sin(s),kt(r,i,a)},Fs.lineEnd=function(){e(t,n),Fs.lineEnd=Pt,Fs.point=Ot}}function Mt(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function Lt(){return!0}function xt(e,t,n,r,i){var a=[],o=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n=e[0],r=e[t];if(Rt(n,r)){i.lineStart();for(var s=0;s<t;++s)i.point((n=e[s])[0],n[1]);return void i.lineEnd()}var c=new jt(n,e,null,!0),l=new jt(n,null,c,!1);c.o=l,a.push(c),o.push(l),c=new jt(r,e,null,!1),l=new jt(r,null,c,!0),c.o=l,a.push(c),o.push(l)}}),o.sort(t),Dt(a),Dt(o),a.length){for(var s=0,c=n,l=o.length;s<l;++s)o[s].e=c=!c;for(var u,d,p=a[0];;){for(var f=p,g=!0;f.v;)if((f=f.n)===p)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(g)for(var s=0,l=u.length;s<l;++s)i.point((d=u[s])[0],d[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(g){u=f.p.z;for(var s=u.length-1;s>=0;--s)i.point((d=u[s])[0],d[1])}else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,u=f.z,g=!g}while(!f.v);i.lineEnd()}}}function Dt(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function jt(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Bt(e,t,n,r){return function(i,a){function o(t,n){var r=i(t,n);e(t=r[0],n=r[1])&&a.point(t,n)}function s(e,t){var n=i(e,t);h.point(n[0],n[1])}function c(){v.point=s,h.lineStart()}function l(){v.point=o,h.lineEnd()}function u(e,t){m.push([e,t]);var n=i(e,t);S.point(n[0],n[1])}function d(){S.lineStart(),m=[]}function p(){u(m[0][0],m[0][1]),S.lineEnd();var e,t=S.clean(),n=E.buffer(),r=n.length;if(m.pop(),g.push(m),m=null,r)if(1&t){e=n[0];var i,r=e.length-1,o=-1;if(r>0){for(y||(a.polygonStart(),y=!0),a.lineStart();++o<r;)a.point((i=e[o])[0],i[1]);a.lineEnd()}}else r>1&&2&t&&n.push(n.pop().concat(n.shift())),f.push(n.filter(Ft))}var f,g,m,h=t(a),b=i.invert(r[0],r[1]),v={point:o,lineStart:c,lineEnd:l,polygonStart:function(){v.point=u,v.lineStart=d,v.lineEnd=p,f=[],g=[]},polygonEnd:function(){v.point=o,v.lineStart=c,v.lineEnd=l,f=fo.merge(f);var e=Wt(b,g);f.length?(y||(a.polygonStart(),y=!0),xt(f,Kt,e,n,a)):e&&(y||(a.polygonStart(),y=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),y&&(a.polygonEnd(),y=!1),f=g=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}},E=Ut(),S=t(E),y=!1;return v}}function Ft(e){return e.length>1}function Ut(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:T,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Kt(e,t){return((e=e.x)[0]<0?e[1]-Wo-Uo:Wo-e[1])-((t=t.x)[0]<0?t[1]-Wo-Uo:Wo-t[1])}function Vt(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?Vo:-Vo,c=Co(a-n);Co(c-Vo)<Uo?(e.point(n,r=(r+o)/2>0?Wo:-Wo),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(a,r),t=0):i!==s&&c>=Vo&&(Co(n-i)<Uo&&(n-=i*Uo),Co(a-s)<Uo&&(a-=s*Uo),r=Gt(n,r,a,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=a,r=o),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}function Gt(e,t,n,r){var i,a,o=Math.sin(e-n);return Co(o)>Uo?Math.atan((Math.sin(t)*(a=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(t))*Math.sin(e))/(i*a*o)):(t+r)/2}function Yt(e,t,n,r){var i;if(null==e)i=n*Wo,r.point(-Vo,i),r.point(0,i),r.point(Vo,i),r.point(Vo,0),r.point(Vo,-i),r.point(0,-i),r.point(-Vo,-i),r.point(-Vo,0),r.point(-Vo,i);else if(Co(e[0]-t[0])>Uo){var a=e[0]<t[0]?Vo:-Vo;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function Wt(e,t){var n=e[0],r=e[1],i=[Math.sin(n),-Math.cos(n),0],a=0,o=0;Ts.reset();for(var s=0,c=t.length;s<c;++s){var l=t[s],u=l.length;if(u)for(var d=l[0],p=d[0],f=d[1]/2+Vo/4,g=Math.sin(f),m=Math.cos(f),h=1;;){h===u&&(h=0),e=l[h];var b=e[0],v=e[1]/2+Vo/4,E=Math.sin(v),S=Math.cos(v),y=b-p,A=y>=0?1:-1,C=A*y,_=C>Vo,w=g*E;if(Ts.add(Math.atan2(w*A*Math.sin(C),m*S+w*Math.cos(C))),a+=_?y+A*Go:y,_^p>=n^b>=n){var T=At(St(d),St(e));wt(T);var R=At(i,T);wt(R);var O=(_^y>=0?-1:1)*oe(R[2]);(r>O||r===O&&(T[0]||T[1]))&&(o+=_^y>=0?1:-1)}if(!h++)break;p=b,g=E,m=S,d=e}}return(a<-Uo||a<Uo&&Ts<-Uo)^1&o}function zt(e){function t(e,t){return Math.cos(e)*Math.cos(t)>a}function n(e){var n,a,c,l,u;return{lineStart:function(){l=c=!1,u=1},point:function(d,p){var f,g=[d,p],m=t(d,p),h=o?m?0:i(d,p):m?i(d+(d<0?Vo:-Vo),p):0;if(!n&&(l=c=m)&&e.lineStart(),m!==c&&(f=r(n,g),(Rt(n,f)||Rt(g,f))&&(g[0]+=Uo,g[1]+=Uo,m=t(g[0],g[1]))),m!==c)u=0,m?(e.lineStart(),f=r(g,n),e.point(f[0],f[1])):(f=r(n,g),e.point(f[0],f[1]),e.lineEnd()),n=f;else if(s&&n&&o^m){var b;h&a||!(b=r(g,n,!0))||(u=0,o?(e.lineStart(),e.point(b[0][0],b[0][1]),e.point(b[1][0],b[1][1]),e.lineEnd()):(e.point(b[1][0],b[1][1]),e.lineEnd(),e.lineStart(),e.point(b[0][0],b[0][1])))}!m||n&&Rt(n,g)||e.point(g[0],g[1]),n=g,c=m,a=h},lineEnd:function(){c&&e.lineEnd(),n=null},clean:function(){return u|(l&&c)<<1}}}function r(e,t,n){var r=St(e),i=St(t),o=[1,0,0],s=At(r,i),c=yt(s,s),l=s[0],u=c-l*l;if(!u)return!n&&e;var d=a*c/u,p=-a*l/u,f=At(o,s),g=_t(o,d);Ct(g,_t(s,p));var m=f,h=yt(g,m),b=yt(m,m),v=h*h-b*(yt(g,g)-1);if(!(v<0)){var E=Math.sqrt(v),S=_t(m,(-h-E)/b);if(Ct(S,g),S=Tt(S),!n)return S;var y,A=e[0],C=t[0],_=e[1],w=t[1];C<A&&(y=A,A=C,C=y);var T=C-A,R=Co(T-Vo)<Uo,O=R||T<Uo;if(!R&&w<_&&(y=_,_=w,w=y),O?R?_+w>0^S[1]<(Co(S[0]-A)<Uo?_:w):_<=S[1]&&S[1]<=w:T>Vo^(A<=S[0]&&S[0]<=C)){var k=_t(m,(-h+E)/b);return Ct(k,g),[S,Tt(k)]}}}function i(t,n){var r=o?e:Vo-e,i=0;return t<-r?i|=1:t>r&&(i|=2),n<-r?i|=4:n>r&&(i|=8),i}var a=Math.cos(e),o=a>0,s=Co(a)>Uo;return Bt(t,n,Sn(e,6*zo),o?[0,-e]:[-Vo,e-Vo])}function $t(e,t,n,r){return function(i){var a,o=i.a,s=i.b,c=o.x,l=o.y,u=s.x,d=s.y,p=0,f=1,g=u-c,m=d-l;if(a=e-c,g||!(a>0)){if(a/=g,g<0){if(a<p)return;a<f&&(f=a)}else if(g>0){if(a>f)return;a>p&&(p=a)}if(a=n-c,g||!(a<0)){if(a/=g,g<0){if(a>f)return;a>p&&(p=a)}else if(g>0){if(a<p)return;a<f&&(f=a)}if(a=t-l,m||!(a>0)){if(a/=m,m<0){if(a<p)return;a<f&&(f=a)}else if(m>0){if(a>f)return;a>p&&(p=a)}if(a=r-l,m||!(a<0)){if(a/=m,m<0){if(a>f)return;a>p&&(p=a)}else if(m>0){if(a<p)return;a<f&&(f=a)}return p>0&&(i.a={x:c+p*g,y:l+p*m}),f<1&&(i.b={x:c+f*g,y:l+f*m}),i}}}}}}function Ht(e,t,n,r){function i(r,i){return Co(r[0]-e)<Uo?i>0?0:3:Co(r[0]-n)<Uo?i>0?2:1:Co(r[1]-t)<Uo?i>0?1:0:i>0?3:2}function a(e,t){return o(e.x,t.x)}function o(e,t){var n=i(e,1),r=i(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(s){function c(e){for(var t=0,n=h.length,r=e[1],i=0;i<n;++i)for(var a,o=1,s=h[i],c=s.length,l=s[0];o<c;++o)a=s[o],l[1]<=r?a[1]>r&&ie(l,a,e)>0&&++t:a[1]<=r&&ie(l,a,e)<0&&--t,l=a;return 0!==t}function l(a,s,c,l){var u=0,d=0;if(null==a||(u=i(a,c))!==(d=i(s,c))||o(a,s)<0^c>0)do{l.point(0===u||3===u?e:n,u>1?r:t)}while((u=(u+c+4)%4)!==d);else l.point(s[0],s[1])}function u(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function d(e,t){u(e,t)&&s.point(e,t)}function p(){k.point=g,h&&h.push(b=[]),_=!0,C=!1,y=A=NaN}function f(){m&&(g(v,E),S&&C&&R.rejoin(),m.push(R.buffer())),k.point=d,C&&s.lineEnd()}function g(e,t){e=Math.max(-Ks,Math.min(Ks,e)),t=Math.max(-Ks,Math.min(Ks,t));var n=u(e,t);if(h&&b.push([e,t]),_)v=e,E=t,S=n,_=!1,n&&(s.lineStart(),s.point(e,t));else if(n&&C)s.point(e,t);else{var r={a:{x:y,y:A},b:{x:e,y:t}};O(r)?(C||(s.lineStart(),s.point(r.a.x,r.a.y)),s.point(r.b.x,r.b.y),n||s.lineEnd(),w=!1):n&&(s.lineStart(),s.point(e,t),w=!1)}y=e,A=t,C=n}var m,h,b,v,E,S,y,A,C,_,w,T=s,R=Ut(),O=$t(e,t,n,r),k={point:d,lineStart:p,lineEnd:f,polygonStart:function(){s=R,m=[],h=[],w=!0},polygonEnd:function(){s=T,m=fo.merge(m);var t=c([e,r]),n=w&&t,i=m.length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),l(null,null,1,s),s.lineEnd()),i&&xt(m,a,t,l,s),s.polygonEnd()),m=h=b=null}};return k}}function qt(e){var t=0,n=Vo/3,r=pn(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*Vo/180,n=e[1]*Vo/180):[t/Vo*180,n/Vo*180]},i}function Jt(e,t){function n(e,t){var n=Math.sqrt(a-2*i*Math.sin(t))/i;return[n*Math.sin(e*=i),o-n*Math.cos(e)]}var r=Math.sin(e),i=(r+Math.sin(t))/2,a=1+r*(2*i-r),o=Math.sqrt(a)/i;return n.invert=function(e,t){var n=o-t;return[Math.atan2(e,n)/i,oe((a-(e*e+n*n)*i*i)/(2*i))]},n}function Xt(){function e(e,t){Gs+=i*e-r*t,r=e,i=t}var t,n,r,i;Hs.point=function(a,o){Hs.point=e,t=r=a,n=i=o},Hs.lineEnd=function(){e(t,n)}}function Zt(e,t){e<Ys&&(Ys=e),e>zs&&(zs=e),t<Ws&&(Ws=t),t>$s&&($s=t)}function Qt(){function e(e,t){o.push("M",e,",",t,a)}function t(e,t){o.push("M",e,",",t),s.point=n}function n(e,t){o.push("L",e,",",t)}function r(){s.point=e}function i(){o.push("Z")}var a=en(4.5),o=[],s={point:e,lineStart:function(){s.point=t},lineEnd:r,polygonStart:function(){s.lineEnd=i},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(e){return a=en(e),s},result:function(){if(o.length){var e=o.join("");return o=[],e}}};return s}function en(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function tn(e,t){Is+=e,Ps+=t,++Ns}function nn(){function e(e,r){var i=e-t,a=r-n,o=Math.sqrt(i*i+a*a);Ms+=o*(t+e)/2,Ls+=o*(n+r)/2,xs+=o,tn(t=e,n=r)}var t,n;Js.point=function(r,i){Js.point=e,tn(t=r,n=i)}}function rn(){Js.point=tn}function an(){function e(e,t){var n=e-r,a=t-i,o=Math.sqrt(n*n+a*a);Ms+=o*(r+e)/2,Ls+=o*(i+t)/2,xs+=o,o=i*e-r*t,Ds+=o*(r+e),js+=o*(i+t),Bs+=3*o,tn(r=e,i=t)}var t,n,r,i;Js.point=function(a,o){Js.point=e,tn(t=r=a,n=i=o)},Js.lineEnd=function(){e(t,n)}}function on(e){function t(t,n){e.moveTo(t+o,n),e.arc(t,n,o,0,Go)}function n(t,n){e.moveTo(t,n),s.point=r}function r(t,n){e.lineTo(t,n)}function i(){s.point=t}function a(){e.closePath()}var o=4.5,s={point:t,lineStart:function(){s.point=n},lineEnd:i,polygonStart:function(){s.lineEnd=a},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(e){return o=e,s},result:T};return s}function sn(e){function t(e){return(s?r:n)(e)}function n(t){return un(t,function(n,r){n=e(n,r),t.point(n[0],n[1])})}function r(t){function n(n,r){n=e(n,r),t.point(n[0],n[1])}function r(){E=NaN,_.point=a,t.lineStart()}function a(n,r){var a=St([n,r]),o=e(n,r);i(E,S,v,y,A,C,E=o[0],S=o[1],v=n,y=a[0],A=a[1],C=a[2],s,t),t.point(E,S)}function o(){_.point=n,t.lineEnd()}function c(){r(),_.point=l,_.lineEnd=u}function l(e,t){a(d=e,p=t),f=E,g=S,m=y,h=A,b=C,_.point=a}function u(){i(E,S,v,y,A,C,f,g,d,m,h,b,s,t),_.lineEnd=o,o()}var d,p,f,g,m,h,b,v,E,S,y,A,C,_={point:n,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),_.lineStart=c},polygonEnd:function(){t.polygonEnd(),_.lineStart=r}};return _}function i(t,n,r,s,c,l,u,d,p,f,g,m,h,b){var v=u-t,E=d-n,S=v*v+E*E;if(S>4*a&&h--){var y=s+f,A=c+g,C=l+m,_=Math.sqrt(y*y+A*A+C*C),w=Math.asin(C/=_),T=Co(Co(C)-1)<Uo||Co(r-p)<Uo?(r+p)/2:Math.atan2(A,y),R=e(T,w),O=R[0],k=R[1],I=O-t,P=k-n,N=E*I-v*P;(N*N/S>a||Co((v*I+E*P)/S-.5)>.3||s*f+c*g+l*m<o)&&(i(t,n,r,s,c,l,O,k,T,y/=_,A/=_,C,h,b),b.point(O,k),i(O,k,T,y,A,C,u,d,p,f,g,m,h,b))}}var a=.5,o=Math.cos(30*zo),s=16;return t.precision=function(e){return arguments.length?(s=(a=e*e)>0&&16,t):Math.sqrt(a)},t}function cn(e){var t=sn(function(t,n){return e([t*$o,n*$o])});return function(e){return fn(t(e))}}function ln(e){this.stream=e}function un(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function dn(e){return pn(function(){return e})()}function pn(e){function t(e){return e=s(e[0]*zo,e[1]*zo),[e[0]*p+c,l-e[1]*p]}function n(e){return(e=s.invert((e[0]-c)/p,(l-e[1])/p))&&[e[0]*$o,e[1]*$o]}function r(){s=Mt(o=hn(b,v,E),a);var e=a(m,h);return c=f-e[0]*p,l=g+e[1]*p,i()}function i(){return u&&(u.valid=!1,u=null),t}var a,o,s,c,l,u,d=sn(function(e,t){return e=a(e,t),[e[0]*p+c,l-e[1]*p]}),p=150,f=480,g=250,m=0,h=0,b=0,v=0,E=0,S=Us,y=C,A=null,_=null;return t.stream=function(e){return u&&(u.valid=!1),u=fn(S(o,d(y(e)))),u.valid=!0,u},t.clipAngle=function(e){return arguments.length?(S=null==e?(A=e,Us):zt((A=+e)*zo),i()):A},t.clipExtent=function(e){return arguments.length?(_=e,y=e?Ht(e[0][0],e[0][1],e[1][0],e[1][1]):C,i()):_},t.scale=function(e){return arguments.length?(p=+e,r()):p},t.translate=function(e){return arguments.length?(f=+e[0],g=+e[1],r()):[f,g]},t.center=function(e){return arguments.length?(m=e[0]%360*zo,h=e[1]%360*zo,r()):[m*$o,h*$o]},t.rotate=function(e){return arguments.length?(b=e[0]%360*zo,v=e[1]%360*zo,E=e.length>2?e[2]%360*zo:0,r()):[b*$o,v*$o,E*$o]},fo.rebind(t,d,"precision"),function(){return a=e.apply(this,arguments),t.invert=a.invert&&n,r()}}function fn(e){return un(e,function(t,n){e.point(t*zo,n*zo)})}function gn(e,t){return[e,t]}function mn(e,t){return[e>Vo?e-Go:e<-Vo?e+Go:e,t]}function hn(e,t,n){return e?t||n?Mt(vn(e),En(t,n)):vn(e):t||n?En(t,n):mn}function bn(e){return function(t,n){return t+=e,[t>Vo?t-Go:t<-Vo?t+Go:t,n]}}function vn(e){var t=bn(e);return t.invert=bn(-e),t}function En(e,t){function n(e,t){var n=Math.cos(t),s=Math.cos(e)*n,c=Math.sin(e)*n,l=Math.sin(t),u=l*r+s*i;return[Math.atan2(c*a-u*o,s*r-l*i),oe(u*a+c*o)]}var r=Math.cos(e),i=Math.sin(e),a=Math.cos(t),o=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),s=Math.cos(e)*n,c=Math.sin(e)*n,l=Math.sin(t),u=l*a-c*o;return[Math.atan2(c*a+l*o,s*r+u*i),oe(u*r-s*i)]},n}function Sn(e,t){var n=Math.cos(e),r=Math.sin(e);return function(i,a,o,s){var c=o*t;null!=i?(i=yn(n,i),a=yn(n,a),(o>0?i<a:i>a)&&(i+=o*Go)):(i=e+o*Go,a=e-.5*c);for(var l,u=i;o>0?u>a:u<a;u-=c)s.point((l=Tt([n,-r*Math.cos(u),-r*Math.sin(u)]))[0],l[1])}}function yn(e,t){var n=St(t);n[0]-=e,wt(n);var r=ae(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Uo)%(2*Math.PI)}function An(e,t,n){var r=fo.range(e,t-Uo,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function Cn(e,t,n){var r=fo.range(e,t-Uo,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function _n(e){return e.source}function wn(e){return e.target}function Tn(e,t,n,r){var i=Math.cos(t),a=Math.sin(t),o=Math.cos(r),s=Math.sin(r),c=i*Math.cos(e),l=i*Math.sin(e),u=o*Math.cos(n),d=o*Math.sin(n),p=2*Math.asin(Math.sqrt(ue(r-t)+i*o*ue(n-e))),f=1/Math.sin(p),g=p?function(e){var t=Math.sin(e*=p)*f,n=Math.sin(p-e)*f,r=n*c+t*u,i=n*l+t*d,o=n*a+t*s;return[Math.atan2(i,r)*$o,Math.atan2(o,Math.sqrt(r*r+i*i))*$o]}:function(){return[e*$o,t*$o]};return g.distance=p,g}function Rn(){function e(e,i){var a=Math.sin(i*=zo),o=Math.cos(i),s=Co((e*=zo)-t),c=Math.cos(s);Xs+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=r*a-n*o*c)*s),n*a+r*o*c),t=e,n=a,r=o}var t,n,r;Zs.point=function(i,a){t=i*zo,n=Math.sin(a*=zo),r=Math.cos(a),Zs.point=e},Zs.lineEnd=function(){Zs.point=Zs.lineEnd=T}}function On(e,t){function n(t,n){var r=Math.cos(t),i=Math.cos(n),a=e(r*i);return[a*i*Math.sin(t),a*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),i=t(r),a=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*a,r*o),Math.asin(r&&n*a/r)]},n}function kn(e,t){function n(e,t){o>0?t<-Wo+Uo&&(t=-Wo+Uo):t>Wo-Uo&&(t=Wo-Uo);var n=o/Math.pow(i(t),a);return[n*Math.sin(a*e),o-n*Math.cos(a*e)]}var r=Math.cos(e),i=function(e){return Math.tan(Vo/4+e/2)},a=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(i(t)/i(e)),o=r*Math.pow(i(e),a)/a;return a?(n.invert=function(e,t){var n=o-t,r=re(a)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/a,2*Math.atan(Math.pow(o/r,1/a))-Wo]},n):Pn}function In(e,t){function n(e,t){var n=a-t;return[n*Math.sin(i*e),a-n*Math.cos(i*e)]}var r=Math.cos(e),i=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),a=r/i+e;return Co(i)<Uo?gn:(n.invert=function(e,t){var n=a-t;return[Math.atan2(e,n)/i,a-re(i)*Math.sqrt(e*e+n*n)]},n)}function Pn(e,t){return[e,Math.log(Math.tan(Vo/4+t/2))]}function Nn(e){var t,n=dn(e),r=n.scale,i=n.translate,a=n.clipExtent;return n.scale=function(){var e=r.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.translate=function(){var e=i.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.clipExtent=function(e){var o=a.apply(n,arguments);if(o===n){if(t=null==e){var s=Vo*r(),c=i();a([[c[0]-s,c[1]-s],[c[0]+s,c[1]+s]])}}else t&&(o=null);return o},n.clipExtent(null)}function Mn(e,t){return[Math.log(Math.tan(Vo/4+t/2)),-e]}function Ln(e){return e[0]}function xn(e){return e[1]}function Dn(e){for(var t=e.length,n=[0,1],r=2,i=2;i<t;i++){for(;r>1&&ie(e[n[r-2]],e[n[r-1]],e[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function jn(e,t){return e[0]-t[0]||e[1]-t[1]}function Bn(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function Fn(e,t,n,r){var i=e[0],a=n[0],o=t[0]-i,s=r[0]-a,c=e[1],l=n[1],u=t[1]-c,d=r[1]-l,p=(s*(c-l)-d*(i-a))/(d*o-s*u);return[i+p*o,c+p*u]}function Un(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function Kn(){cr(this),this.edge=this.site=this.circle=null}function Vn(e){var t=uc.pop()||new Kn;return t.site=e,t}function Gn(e){Qn(e),sc.remove(e),uc.push(e),cr(e)}function Yn(e){var t=e.circle,n=t.x,r=t.cy,i={x:n,y:r},a=e.P,o=e.N,s=[e];Gn(e);for(var c=a;c.circle&&Co(n-c.circle.x)<Uo&&Co(r-c.circle.cy)<Uo;)a=c.P,s.unshift(c),Gn(c),c=a;s.unshift(c),Qn(c);for(var l=o;l.circle&&Co(n-l.circle.x)<Uo&&Co(r-l.circle.cy)<Uo;)o=l.N,s.push(l),Gn(l),l=o;s.push(l),Qn(l);var u,d=s.length;for(u=1;u<d;++u)l=s[u],c=s[u-1],ar(l.edge,c.site,l.site,i);c=s[0],l=s[d-1],l.edge=rr(c.site,l.site,null,i),Zn(c),Zn(l)}function Wn(e){for(var t,n,r,i,a=e.x,o=e.y,s=sc._;s;)if((r=zn(s,o)-a)>Uo)s=s.L;else{if(!((i=a-$n(s,o))>Uo)){r>-Uo?(t=s.P,n=s):i>-Uo?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}var c=Vn(e);if(sc.insert(t,c),t||n){if(t===n)return Qn(t),n=Vn(t.site),sc.insert(c,n),c.edge=n.edge=rr(t.site,c.site),Zn(t),void Zn(n);if(!n)return void(c.edge=rr(t.site,c.site));Qn(t),Qn(n);var l=t.site,u=l.x,d=l.y,p=e.x-u,f=e.y-d,g=n.site,m=g.x-u,h=g.y-d,b=2*(p*h-f*m),v=p*p+f*f,E=m*m+h*h,S={x:(h*v-f*E)/b+u,y:(p*E-m*v)/b+d};ar(n.edge,l,g,S),c.edge=rr(l,e,null,S),n.edge=rr(e,g,null,S),Zn(t),Zn(n)}}function zn(e,t){var n=e.site,r=n.x,i=n.y,a=i-t;if(!a)return r;var o=e.P;if(!o)return-1/0;n=o.site;var s=n.x,c=n.y,l=c-t;if(!l)return s;var u=s-r,d=1/a-1/l,p=u/l;return d?(-p+Math.sqrt(p*p-2*d*(u*u/(-2*l)-c+l/2+i-a/2)))/d+r:(r+s)/2}function $n(e,t){var n=e.N;if(n)return zn(n,t);var r=e.site;return r.y===t?r.x:1/0}function Hn(e){this.site=e,this.edges=[]}function qn(e){for(var t,n,r,i,a,o,s,c,l,u,d=e[0][0],p=e[1][0],f=e[0][1],g=e[1][1],m=oc,h=m.length;h--;)if((a=m[h])&&a.prepare())for(s=a.edges,c=s.length,o=0;o<c;)u=s[o].end(),r=u.x,i=u.y,l=s[++o%c].start(),t=l.x,n=l.y,(Co(r-t)>Uo||Co(i-n)>Uo)&&(s.splice(o,0,new or(ir(a.site,u,Co(r-d)<Uo&&g-i>Uo?{x:d,y:Co(t-d)<Uo?n:g}:Co(i-g)<Uo&&p-r>Uo?{x:Co(n-g)<Uo?t:p,y:g}:Co(r-p)<Uo&&i-f>Uo?{x:p,y:Co(t-p)<Uo?n:f}:Co(i-f)<Uo&&r-d>Uo?{x:Co(n-f)<Uo?t:d,y:f}:null),a.site,null)),++c)}function Jn(e,t){return t.angle-e.angle}function Xn(){cr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Zn(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,i=e.site,a=n.site;if(r!==a){var o=i.x,s=i.y,c=r.x-o,l=r.y-s,u=a.x-o,d=a.y-s,p=2*(c*d-l*u);if(!(p>=-Ko)){var f=c*c+l*l,g=u*u+d*d,m=(d*f-l*g)/p,h=(c*g-u*f)/p,d=h+s,b=dc.pop()||new Xn;b.arc=e,b.site=i,b.x=m+o,b.y=d+Math.sqrt(m*m+h*h),b.cy=d,e.circle=b;for(var v=null,E=lc._;E;)if(b.y<E.y||b.y===E.y&&b.x<=E.x){if(!E.L){v=E.P;break}E=E.L}else{if(!E.R){v=E;break}E=E.R}lc.insert(v,b),v||(cc=b)}}}}function Qn(e){var t=e.circle;t&&(t.P||(cc=t.N),lc.remove(t),dc.push(t),cr(t),e.circle=null)}function er(e){for(var t,n=ac,r=$t(e[0][0],e[0][1],e[1][0],e[1][1]),i=n.length;i--;)t=n[i],(!tr(t,e)||!r(t)||Co(t.a.x-t.b.x)<Uo&&Co(t.a.y-t.b.y)<Uo)&&(t.a=t.b=null,n.splice(i,1))}function tr(e,t){var n=e.b;if(n)return!0;var r,i,a=e.a,o=t[0][0],s=t[1][0],c=t[0][1],l=t[1][1],u=e.l,d=e.r,p=u.x,f=u.y,g=d.x,m=d.y,h=(p+g)/2,b=(f+m)/2;if(m===f){if(h<o||h>=s)return;if(p>g){if(a){if(a.y>=l)return}else a={x:h,y:c};n={x:h,y:l}}else{if(a){if(a.y<c)return}else a={x:h,y:l};n={x:h,y:c}}}else if(r=(p-g)/(m-f),i=b-r*h,r<-1||r>1)if(p>g){if(a){if(a.y>=l)return}else a={x:(c-i)/r,y:c};n={x:(l-i)/r,y:l}}else{if(a){if(a.y<c)return}else a={x:(l-i)/r,y:l};n={x:(c-i)/r,y:c}}else if(f<m){if(a){if(a.x>=s)return}else a={x:o,y:r*o+i};n={x:s,y:r*s+i}}else{if(a){if(a.x<o)return}else a={x:s,y:r*s+i};n={x:o,y:r*o+i}}return e.a=a,e.b=n,!0}function nr(e,t){this.l=e,this.r=t,this.a=this.b=null}function rr(e,t,n,r){var i=new nr(e,t);return ac.push(i),n&&ar(i,e,t,n),r&&ar(i,t,e,r),oc[e.i].edges.push(new or(i,e,t)),oc[t.i].edges.push(new or(i,t,e)),i}function ir(e,t,n){var r=new nr(e,null);return r.a=t,r.b=n,ac.push(r),r}function ar(e,t,n,r){e.a||e.b?e.l===n?e.b=r:e.a=r:(e.a=r,e.l=t,e.r=n)}function or(e,t,n){var r=e.a,i=e.b;this.edge=e,this.site=t,this.angle=n?Math.atan2(n.y-t.y,n.x-t.x):e.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function sr(){this._=null}function cr(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function lr(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function ur(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function dr(e){for(;e.L;)e=e.L;return e}function pr(e,t){var n,r,i,a=e.sort(fr).pop();for(ac=[],oc=new Array(e.length),sc=new sr,lc=new sr;;)if(i=cc,a&&(!i||a.y<i.y||a.y===i.y&&a.x<i.x))a.x===n&&a.y===r||(oc[a.i]=new Hn(a),Wn(a),n=a.x,r=a.y),a=e.pop();else{if(!i)break;Yn(i.arc)}t&&(er(t),qn(t));var o={cells:oc,edges:ac};return sc=lc=ac=oc=null,o}function fr(e,t){return t.y-e.y||t.x-e.x}function gr(e,t,n){return(e.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-e.y)}function mr(e){return e.x}function hr(e){return e.y}function br(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function vr(e,t,n,r,i,a){if(!e(t,n,r,i,a)){var o=.5*(n+i),s=.5*(r+a),c=t.nodes;c[0]&&vr(e,c[0],n,r,o,s),c[1]&&vr(e,c[1],o,r,i,s),c[2]&&vr(e,c[2],n,s,o,a),c[3]&&vr(e,c[3],o,s,i,a)}}function Er(e,t,n,r,i,a,o){var s,c=1/0;return function e(l,u,d,p,f){if(!(u>a||d>o||p<r||f<i)){if(g=l.point){var g,m=t-l.x,h=n-l.y,b=m*m+h*h;if(b<c){var v=Math.sqrt(c=b);r=t-v,i=n-v,a=t+v,o=n+v,s=g}}for(var E=l.nodes,S=.5*(u+p),y=.5*(d+f),A=t>=S,C=n>=y,_=C<<1|A,w=_+4;_<w;++_)if(l=E[3&_])switch(3&_){case 0:e(l,u,d,S,y);break;case 1:e(l,S,d,p,y);break;case 2:e(l,u,y,S,f);break;case 3:e(l,S,y,p,f)}}}(e,r,i,a,o),s}function Sr(e,t){e=fo.rgb(e),t=fo.rgb(t);var n=e.r,r=e.g,i=e.b,a=t.r-n,o=t.g-r,s=t.b-i;return function(e){return"#"+we(Math.round(n+a*e))+we(Math.round(r+o*e))+we(Math.round(i+s*e))}}function yr(e,t){var n,r={},i={};for(n in e)n in t?r[n]=_r(e[n],t[n]):i[n]=e[n];for(n in t)n in e||(i[n]=t[n]);return function(e){for(n in r)i[n]=r[n](e);return i}}function Ar(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Cr(e,t){var n,r,i,a=fc.lastIndex=gc.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=fc.exec(e))&&(r=gc.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Ar(n,r)})),a=gc.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?(t=c[0].x,function(e){return t(e)+""}):function(){return t}:(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})}function _r(e,t){for(var n,r=fo.interpolators.length;--r>=0&&!(n=fo.interpolators[r](e,t)););return n}function wr(e,t){var n,r=[],i=[],a=e.length,o=t.length,s=Math.min(e.length,t.length);for(n=0;n<s;++n)r.push(_r(e[n],t[n]));for(;n<a;++n)i[n]=e[n];for(;n<o;++n)i[n]=t[n];return function(e){for(n=0;n<s;++n)i[n]=r[n](e);return i}}function Tr(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function Rr(e){return function(t){return 1-e(1-t)}}function Or(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function kr(e){return e*e}function Ir(e){return e*e*e}function Pr(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function Nr(e){return function(t){return Math.pow(t,e)}}function Mr(e){return 1-Math.cos(e*Wo)}function Lr(e){return Math.pow(2,10*(e-1))}function xr(e){return 1-Math.sqrt(1-e*e)}function Dr(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/Go*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,-10*r)*Math.sin((r-n)*Go/t)}}function jr(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function Br(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Fr(e,t){e=fo.hcl(e),t=fo.hcl(t);var n=e.h,r=e.c,i=e.l,a=t.h-n,o=t.c-r,s=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(a)?(a=0,n=isNaN(n)?t.h:n):a>180?a-=360:a<-180&&(a+=360),function(e){return me(n+a*e,r+o*e,i+s*e)+""}}function Ur(e,t){e=fo.hsl(e),t=fo.hsl(t);var n=e.h,r=e.s,i=e.l,a=t.h-n,o=t.s-r,s=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(a)?(a=0,n=isNaN(n)?t.h:n):a>180?a-=360:a<-180&&(a+=360),function(e){return fe(n+a*e,r+o*e,i+s*e)+""}}function Kr(e,t){e=fo.lab(e),t=fo.lab(t);var n=e.l,r=e.a,i=e.b,a=t.l-n,o=t.a-r,s=t.b-i;return function(e){return be(n+a*e,r+o*e,i+s*e)+""}}function Vr(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function Gr(e){var t=[e.a,e.b],n=[e.c,e.d],r=Wr(t),i=Yr(t,n),a=Wr(zr(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*$o,this.translate=[e.e,e.f],this.scale=[r,a],this.skew=a?Math.atan2(i,a)*$o:0}function Yr(e,t){return e[0]*t[0]+e[1]*t[1]}function Wr(e){var t=Math.sqrt(Yr(e,e));return t&&(e[0]/=t,e[1]/=t),t}function zr(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function $r(e){return e.length?e.pop()+",":""}function Hr(e,t,n,r){if(e[0]!==t[0]||e[1]!==t[1]){var i=n.push("translate(",null,",",null,")");r.push({i:i-4,x:Ar(e[0],t[0])},{i:i-2,x:Ar(e[1],t[1])})}else(t[0]||t[1])&&n.push("translate("+t+")")}function qr(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push($r(n)+"rotate(",null,")")-2,x:Ar(e,t)})):t&&n.push($r(n)+"rotate("+t+")")}function Jr(e,t,n,r){e!==t?r.push({i:n.push($r(n)+"skewX(",null,")")-2,x:Ar(e,t)}):t&&n.push($r(n)+"skewX("+t+")")}function Xr(e,t,n,r){if(e[0]!==t[0]||e[1]!==t[1]){var i=n.push($r(n)+"scale(",null,",",null,")");r.push({i:i-4,x:Ar(e[0],t[0])},{i:i-2,x:Ar(e[1],t[1])})}else 1===t[0]&&1===t[1]||n.push($r(n)+"scale("+t+")")}function Zr(e,t){var n=[],r=[];return e=fo.transform(e),t=fo.transform(t),Hr(e.translate,t.translate,n,r),qr(e.rotate,t.rotate,n,r),Jr(e.skew,t.skew,n,r),Xr(e.scale,t.scale,n,r),e=t=null,function(e){for(var t,i=-1,a=r.length;++i<a;)n[(t=r[i]).i]=t.x(e);return n.join("")}}function Qr(e,t){return t=(t-=e=+e)||1/t,function(n){return(n-e)/t}}function ei(e,t){return t=(t-=e=+e)||1/t,function(n){return Math.max(0,Math.min(1,(n-e)/t))}}function ti(e){for(var t=e.source,n=e.target,r=ri(t,n),i=[t];t!==r;)t=t.parent,i.push(t);for(var a=i.length;n!==r;)i.splice(a,0,n),n=n.parent;return i}function ni(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function ri(e,t){if(e===t)return e;for(var n=ni(e),r=ni(t),i=n.pop(),a=r.pop(),o=null;i===a;)o=i,i=n.pop(),a=r.pop();return o}function ii(e){e.fixed|=2}function ai(e){e.fixed&=-7}function oi(e){e.fixed|=4,e.px=e.x,e.py=e.y}function si(e){e.fixed&=-5}function ci(e,t,n){var r=0,i=0;if(e.charge=0,!e.leaf)for(var a,o=e.nodes,s=o.length,c=-1;++c<s;)null!=(a=o[c])&&(ci(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var l=t*n[e.point.index];e.charge+=e.pointCharge=l,r+=l*e.point.x,i+=l*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function li(e,t){return fo.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=mi,e}function ui(e,t){for(var n=[e];null!=(e=n.pop());)if(t(e),(i=e.children)&&(r=i.length))for(var r,i;--r>=0;)n.push(i[r])}function di(e,t){for(var n=[e],r=[];null!=(e=n.pop());)if(r.push(e),(a=e.children)&&(i=a.length))for(var i,a,o=-1;++o<i;)n.push(a[o]);for(;null!=(e=r.pop());)t(e)}function pi(e){return e.children}function fi(e){return e.value}function gi(e,t){return t.value-e.value}function mi(e){return fo.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function hi(e){return e.x}function bi(e){return e.y}function vi(e,t,n){e.y0=t,e.y=n}function Ei(e){return fo.range(e.length)}function Si(e){for(var t=-1,n=e[0].length,r=[];++t<n;)r[t]=0;return r}function yi(e){for(var t,n=1,r=0,i=e[0][1],a=e.length;n<a;++n)(t=e[n][1])>i&&(r=n,i=t);return r}function Ai(e){return e.reduce(Ci,0)}function Ci(e,t){return e+t[1]}function _i(e,t){return wi(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function wi(e,t){for(var n=-1,r=+e[0],i=(e[1]-r)/t,a=[];++n<=t;)a[n]=i*n+r;return a}function Ti(e){return[fo.min(e),fo.max(e)]}function Ri(e,t){return e.value-t.value}function Oi(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function ki(e,t){e._pack_next=t,t._pack_prev=e}function Ii(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return.999*i*i>n*n+r*r}function Pi(e){function t(e){u=Math.min(e.x-e.r,u),d=Math.max(e.x+e.r,d),p=Math.min(e.y-e.r,p),f=Math.max(e.y+e.r,f)}if((n=e.children)&&(l=n.length)){var n,r,i,a,o,s,c,l,u=1/0,d=-1/0,p=1/0,f=-1/0;if(n.forEach(Ni),r=n[0],r.x=-r.r,r.y=0,t(r),l>1&&(i=n[1],i.x=i.r,i.y=0,t(i),l>2))for(a=n[2],xi(r,i,a),t(a),Oi(r,a),r._pack_prev=a,Oi(a,i),i=r._pack_next,o=3;o<l;o++){xi(r,i,a=n[o]);var g=0,m=1,h=1;for(s=i._pack_next;s!==i;s=s._pack_next,m++)if(Ii(s,a)){g=1;break}if(1==g)for(c=r._pack_prev;c!==s._pack_prev&&!Ii(c,a);c=c._pack_prev,h++);g?(m<h||m==h&&i.r<r.r?ki(r,i=s):ki(r=c,i),o--):(Oi(r,a),i=a,t(a))}var b=(u+d)/2,v=(p+f)/2,E=0;for(o=0;o<l;o++)a=n[o],a.x-=b,a.y-=v,E=Math.max(E,a.r+Math.sqrt(a.x*a.x+a.y*a.y));e.r=E,n.forEach(Mi)}}function Ni(e){e._pack_next=e._pack_prev=e}function Mi(e){delete e._pack_next,delete e._pack_prev}function Li(e,t,n,r){var i=e.children;if(e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r,i)for(var a=-1,o=i.length;++a<o;)Li(i[a],t,n,r)}function xi(e,t,n){var r=e.r+n.r,i=t.x-e.x,a=t.y-e.y;if(r&&(i||a)){var o=t.r+n.r,s=i*i+a*a;o*=o,r*=r;var c=.5+(r-o)/(2*s),l=Math.sqrt(Math.max(0,2*o*(r+s)-(r-=s)*r-o*o))/(2*s);n.x=e.x+c*i+l*a,n.y=e.y+c*a-l*i}else n.x=e.x+r,n.y=e.y}function Di(e,t){return e.parent==t.parent?1:2}function ji(e){var t=e.children;return t.length?t[0]:e.t}function Bi(e){var t,n=e.children;return(t=n.length)?n[t-1]:e.t}function Fi(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Ui(e){for(var t,n=0,r=0,i=e.children,a=i.length;--a>=0;)t=i[a],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}function Ki(e,t,n){return e.a.parent===t.parent?e.a:n}function Vi(e){return 1+fo.max(e,function(e){return e.y})}function Gi(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Yi(e){var t=e.children;return t&&t.length?Yi(t[0]):e}function Wi(e){var t,n=e.children;return n&&(t=n.length)?Wi(n[t-1]):e}function zi(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function $i(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],a=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),a<0&&(r+=a/2,a=0),{x:n,y:r,dx:i,dy:a}}function Hi(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function qi(e){return e.rangeExtent?e.rangeExtent():Hi(e.range())}function Ji(e,t,n,r){var i=n(e[0],e[1]),a=r(t[0],t[1]);return function(e){return a(i(e))}}function Xi(e,t){var n,r=0,i=e.length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}function Zi(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:wc}function Qi(e,t,n,r){var i=[],a=[],o=0,s=Math.min(e.length,t.length)-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<=s;)i.push(n(e[o-1],e[o])),a.push(r(t[o-1],t[o]));return function(t){var n=fo.bisect(e,t,1,s)-1;return a[n](i[n](t))}}function ea(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?Qi:Ji,c=r?ei:Qr;return o=i(e,t,c,n),s=i(t,e,c,_r),a}function a(e){return o(e)}var o,s;return a.invert=function(e){return s(e)},a.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},a.range=function(e){return arguments.length?(t=e,i()):t},a.rangeRound=function(e){return a.range(e).interpolate(Vr)},a.clamp=function(e){return arguments.length?(r=e,i()):r},a.interpolate=function(e){return arguments.length?(n=e,i()):n},a.ticks=function(t){return ia(e,t)},a.tickFormat=function(t,n){return aa(e,t,n)},a.nice=function(t){return na(e,t),i()},a.copy=function(){return ea(e,t,n,r)},i()}function ta(e,t){return fo.rebind(e,t,"range","rangeRound","interpolate","clamp")}function na(e,t){return Xi(e,Zi(ra(e,t)[2])),Xi(e,Zi(ra(e,t)[2])),e}function ra(e,t){null==t&&(t=10);var n=Hi(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),a=t/r*i;return a<=.15?i*=10:a<=.35?i*=5:a<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+.5*i,n[2]=i,n}function ia(e,t){return fo.range.apply(fo,ra(e,t))}function aa(e,t,n){var r=ra(e,t);if(n){var i=fs.exec(n);if(i.shift(),"s"===i[8]){var a=fo.formatPrefix(Math.max(Co(r[0]),Co(r[1])));return i[7]||(i[7]="."+oa(a.scale(r[2]))),i[8]="f",n=fo.format(i.join("")),function(e){return n(a.scale(e))+a.symbol}}i[7]||(i[7]="."+sa(i[8],r)),n=i.join("")}else n=",."+oa(r[2])+"f";return fo.format(n)}function oa(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function sa(e,t){var n=oa(t[2]);return e in Tc?Math.abs(n-oa(Math.max(Co(t[0]),Co(t[1]))))+ +("e"!==e):n-2*("%"===e)}function ca(e,t,n,r){function i(e){return(n?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function a(e){return n?Math.pow(t,e):-Math.pow(t,-e)}function o(t){return e(i(t))}return o.invert=function(t){return a(e.invert(t))},o.domain=function(t){return arguments.length?(n=t[0]>=0,e.domain((r=t.map(Number)).map(i)),o):r},o.base=function(n){return arguments.length?(t=+n,e.domain(r.map(i)),o):t},o.nice=function(){var t=Xi(r.map(i),n?Math:Oc);return e.domain(t),r=t.map(a),o},o.ticks=function(){var e=Hi(r),o=[],s=e[0],c=e[1],l=Math.floor(i(s)),u=Math.ceil(i(c)),d=t%1?2:t;if(isFinite(u-l)){if(n){for(;l<u;l++)for(var p=1;p<d;p++)o.push(a(l)*p);o.push(a(l))}else for(o.push(a(l));l++<u;)for(var p=d-1;p>0;p--)o.push(a(l)*p);for(l=0;o[l]<s;l++);for(u=o.length;o[u-1]>c;u--);o=o.slice(l,u)}return o},o.tickFormat=function(e,n){if(!arguments.length)return Rc;arguments.length<2?n=Rc:"function"!=typeof n&&(n=fo.format(n));var r=Math.max(1,t*e/o.ticks().length);return function(e){var o=e/a(Math.round(i(e)));return o*t<t-.5&&(o*=t),o<=r?n(e):""}},o.copy=function(){return ca(e.copy(),t,n,r)},ta(o,e)}function la(e,t,n){function r(t){return e(i(t))}var i=ua(t),a=ua(1/t);return r.invert=function(t){return a(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(i)),r):n},r.ticks=function(e){return ia(n,e)},r.tickFormat=function(e,t){return aa(n,e,t)},r.nice=function(e){return r.domain(na(n,e))},r.exponent=function(o){return arguments.length?(i=ua(t=o),a=ua(1/t),e.domain(n.map(i)),r):t},r.copy=function(){return la(e.copy(),t,n)},ta(r,e)}function ua(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function da(e,t){function n(n){return a[((i.get(n)||("range"===t.t?i.set(n,e.push(n)):NaN))-1)%a.length]}function r(t,n){return fo.range(e.length).map(function(e){return t+n*e})}var i,a,o;return n.domain=function(r){if(!arguments.length)return e;e=[],i=new g;for(var a,o=-1,s=r.length;++o<s;)i.has(a=r[o])||i.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(a=e,o=0,t={t:"range",a:arguments},n):a},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var c=i[0],l=i[1],u=e.length<2?(c=(c+l)/2,0):(l-c)/(e.length-1+s);return a=r(c+u*s/2,u),o=0,t={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(i,s){arguments.length<2&&(s=0);var c=i[0],l=i[1],u=e.length<2?(c=l=Math.round((c+l)/2),0):(l-c)/(e.length-1+s)|0;return a=r(c+Math.round(u*s/2+(l-c-(e.length-1+s)*u)/2),u),o=0,t={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(i,s,c){arguments.length<2&&(s=0),arguments.length<3&&(c=s);var l=i[1]<i[0],u=i[l-0],d=i[1-l],p=(d-u)/(e.length-s+2*c);return a=r(u+p*c,p),l&&a.reverse(),o=p*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,c){arguments.length<2&&(s=0),arguments.length<3&&(c=s);var l=i[1]<i[0],u=i[l-0],d=i[1-l],p=Math.floor((d-u)/(e.length-s+2*c));return a=r(u+Math.round((d-u-(e.length-s)*p)/2),p),l&&a.reverse(),o=Math.round(p*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return Hi(t.a[0])},n.copy=function(){return da(e,t)},n.domain(e)}function pa(e,t){function n(){var n=0,a=t.length;for(i=[];++n<a;)i[n-1]=fo.quantile(e,n/a);return r}function r(e){if(!isNaN(e=+e))return t[fo.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.map(c).filter(l).sort(s),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.invertExtent=function(n){return n=t.indexOf(n),n<0?[NaN,NaN]:[n>0?i[n-1]:e[0],n<i.length?i[n]:e[e.length-1]]},r.copy=function(){return pa(e,t)},n()}function fa(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(a*(t-e))))]}function i(){return a=n.length/(t-e),o=n.length-1,r}var a,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.invertExtent=function(t){return t=n.indexOf(t),t=t<0?NaN:t/a+e,[t,t+1/a]},r.copy=function(){return fa(e,t,n)},i()}function ga(e,t){function n(n){if(n<=n)return t[fo.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return ga(e,t)},n}function ma(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return ia(e,t)},t.tickFormat=function(t,n){return aa(e,t,n)},t.copy=function(){return ma(e)},t}function ha(){return 0}function ba(e){return e.innerRadius}function va(e){return e.outerRadius}function Ea(e){return e.startAngle}function Sa(e){return e.endAngle}function ya(e){return e&&e.padAngle}function Aa(e,t,n,r){return(e-n)*t-(t-r)*e>0?0:1}function Ca(e,t,n,r,i){var a=e[0]-t[0],o=e[1]-t[1],s=(i?r:-r)/Math.sqrt(a*a+o*o),c=s*o,l=-s*a,u=e[0]+c,d=e[1]+l,p=t[0]+c,f=t[1]+l,g=(u+p)/2,m=(d+f)/2,h=p-u,b=f-d,v=h*h+b*b,E=n-r,S=u*f-p*d,y=(b<0?-1:1)*Math.sqrt(Math.max(0,E*E*v-S*S)),A=(S*b-h*y)/v,C=(-S*h-b*y)/v,_=(S*b+h*y)/v,w=(-S*h+b*y)/v,T=A-g,R=C-m,O=_-g,k=w-m;return T*T+R*R>O*O+k*k&&(A=_,C=w),[[A-c,C-l],[A*n/E,C*n/E]]}function _a(e){function t(t){function o(){l.push("M",a(e(u),s))}for(var c,l=[],u=[],d=-1,p=t.length,f=Pe(n),g=Pe(r);++d<p;)i.call(this,c=t[d],d)?u.push([+f.call(this,c,d),+g.call(this,c,d)]):u.length&&(o(),u=[]);return u.length&&o(),l.length?l.join(""):null}var n=Ln,r=xn,i=Lt,a=wa,o=a.key,s=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(o="function"==typeof e?a=e:(a=Lc.get(e)||wa).key,t):o},t.tension=function(e){return arguments.length?(s=e,t):s},t}function wa(e){return e.length>1?e.join("L"):e+"Z"}function Ta(e){return e.join("L")+"Z"}function Ra(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("H",(r[0]+(r=e[t])[0])/2,"V",r[1]);return n>1&&i.push("H",r[0]),i.join("")}function Oa(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function ka(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function Ia(e,t){return e.length<4?wa(e):e[1]+Ma(e.slice(1,-1),La(e,t))}function Pa(e,t){return e.length<3?Ta(e):e[0]+Ma((e.push(e[0]),e),La([e[e.length-2]].concat(e,[e[1]]),t))}function Na(e,t){return e.length<3?wa(e):e[0]+Ma(e,La(e,t))}function Ma(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return wa(e);var n=e.length!=t.length,r="",i=e[0],a=e[1],o=t[0],s=o,c=1;if(n&&(r+="Q"+(a[0]-2*o[0]/3)+","+(a[1]-2*o[1]/3)+","+a[0]+","+a[1],i=e[1],c=2),t.length>1){s=t[1],a=e[c],c++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1];for(var l=2;l<t.length;l++,c++)a=e[c],s=t[l],r+="S"+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1]}if(n){var u=e[c];r+="Q"+(a[0]+2*s[0]/3)+","+(a[1]+2*s[1]/3)+","+u[0]+","+u[1]}return r}function La(e,t){for(var n,r=[],i=(1-t)/2,a=e[0],o=e[1],s=1,c=e.length;++s<c;)n=a,a=o,o=e[s],r.push([i*(o[0]-n[0]),i*(o[1]-n[1])]);return r}function xa(e){if(e.length<3)return wa(e);var t=1,n=e.length,r=e[0],i=r[0],a=r[1],o=[i,i,i,(r=e[1])[0]],s=[a,a,a,r[1]],c=[i,",",a,"L",Fa(jc,o),",",Fa(jc,s)];for(e.push(e[n-1]);++t<=n;)r=e[t],o.shift(),o.push(r[0]),s.shift(),s.push(r[1]),Ua(c,o,s);return e.pop(),c.push("L",r),c.join("")}function Da(e){if(e.length<4)return wa(e);for(var t,n=[],r=-1,i=e.length,a=[0],o=[0];++r<3;)t=e[r],a.push(t[0]),o.push(t[1]);for(n.push(Fa(jc,a)+","+Fa(jc,o)),--r;++r<i;)t=e[r],a.shift(),a.push(t[0]),o.shift(),o.push(t[1]),Ua(n,a,o);return n.join("")}function ja(e){for(var t,n,r=-1,i=e.length,a=i+4,o=[],s=[];++r<4;)n=e[r%i],o.push(n[0]),s.push(n[1]);for(t=[Fa(jc,o),",",Fa(jc,s)],--r;++r<a;)n=e[r%i],o.shift(),o.push(n[0]),s.shift(),s.push(n[1]),Ua(t,o,s);return t.join("")}function Ba(e,t){var n=e.length-1;if(n)for(var r,i,a=e[0][0],o=e[0][1],s=e[n][0]-a,c=e[n][1]-o,l=-1;++l<=n;)r=e[l],i=l/n,r[0]=t*r[0]+(1-t)*(a+i*s),r[1]=t*r[1]+(1-t)*(o+i*c);return xa(e)}function Fa(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ua(e,t,n){e.push("C",Fa(xc,t),",",Fa(xc,n),",",Fa(Dc,t),",",Fa(Dc,n),",",Fa(jc,t),",",Fa(jc,n))}function Ka(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Va(e){for(var t=0,n=e.length-1,r=[],i=e[0],a=e[1],o=r[0]=Ka(i,a);++t<n;)r[t]=(o+(o=Ka(i=a,a=e[t+1])))/2;return r[t]=o,r}function Ga(e){for(var t,n,r,i,a=[],o=Va(e),s=-1,c=e.length-1;++s<c;)t=Ka(e[s],e[s+1]),Co(t)<Uo?o[s]=o[s+1]=0:(n=o[s]/t,r=o[s+1]/t,(i=n*n+r*r)>9&&(i=3*t/Math.sqrt(i),o[s]=i*n,o[s+1]=i*r));for(s=-1;++s<=c;)i=(e[Math.min(c,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s])),a.push([i||0,o[s]*i||0]);return a}function Ya(e){return e.length<3?wa(e):e[0]+Ma(e,Ga(e))}function Wa(e){for(var t,n,r,i=-1,a=e.length;++i<a;)t=e[i],n=t[0],r=t[1]-Wo,t[0]=n*Math.cos(r),t[1]=n*Math.sin(r);return e}function za(e){function t(t){function c(){m.push("M",s(e(b),d),u,l(e(h.reverse()),d),"Z")}for(var p,f,g,m=[],h=[],b=[],v=-1,E=t.length,S=Pe(n),y=Pe(i),A=n===r?function(){return f}:Pe(r),C=i===a?function(){return g}:Pe(a);++v<E;)o.call(this,p=t[v],v)?(h.push([f=+S.call(this,p,v),g=+y.call(this,p,v)]),b.push([+A.call(this,p,v),+C.call(this,p,v)])):h.length&&(c(),h=[],b=[]);return h.length&&c(),m.length?m.join(""):null}var n=Ln,r=Ln,i=0,a=xn,o=Lt,s=wa,c=s.key,l=s,u="L",d=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=a=e,t):a},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(a=e,t):a},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(c="function"==typeof e?s=e:(s=Lc.get(e)||wa).key,l=s.reverse||s,u=s.closed?"M":"L",t):c},t.tension=function(e){return arguments.length?(d=e,t):d},t}function $a(e){return e.radius}function Ha(e){return[e.x,e.y]}function qa(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]-Wo;return[n*Math.cos(r),n*Math.sin(r)]}}function Ja(){return 64}function Xa(){return"circle"}function Za(e){var t=Math.sqrt(e/Vo);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Qa(e){return function(){var t,n,r;(t=this[e])&&(r=t[n=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[n]:delete this[e],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function eo(e,t,n){return Oo(e,Yc),e.namespace=t,e.id=n,e}function to(e,t,n,r){var i=e.id,a=e.namespace;return H(e,"function"==typeof n?function(e,o,s){e[a][i].tween.set(t,r(n.call(e,e.__data__,o,s)))}:(n=r(n),function(e){e[a][i].tween.set(t,n)}))}function no(e){return null==e&&(e=""),function(){this.textContent=e}}function ro(e){return null==e?"__transition__":"__transition_"+e+"__"}function io(e,t,n,r,i){function a(e){var t=m.delay;if(l.t=t+c,t<=e)return o(e-t);l.c=o}function o(n){var i=f.active,a=f[i];a&&(a.timer.c=null,a.timer.t=NaN,--f.count,delete f[i],a.event&&a.event.interrupt.call(e,e.__data__,a.index));for(var o in f)if(+o<r){var g=f[o];g.timer.c=null,g.timer.t=NaN,--f.count,delete f[o]}l.c=s,De(function(){return l.c&&s(n||1)&&(l.c=null,l.t=NaN),1},0,c),f.active=r,m.event&&m.event.start.call(e,e.__data__,t),p=[],m.tween.forEach(function(n,r){(r=r.call(e,e.__data__,t))&&p.push(r)}),d=m.ease,u=m.duration}function s(i){for(var a=i/u,o=d(a),s=p.length;s>0;)p[--s].call(e,o);if(a>=1)return m.event&&m.event.end.call(e,e.__data__,t),--f.count?delete f[r]:delete e[n],1}var c,l,u,d,p,f=e[n]||(e[n]={active:0,count:0}),m=f[r];m||(c=i.time,l=De(a,0,c),m=f[r]={tween:new g,time:c,timer:l,delay:i.delay,duration:i.duration,ease:i.ease,index:t},i=null,++f.count)}function ao(e,t,n){e.attr("transform",function(e){var r=t(e);return"translate("+(isFinite(r)?r:n(e))+",0)"})}function oo(e,t,n){e.attr("transform",function(e){var r=t(e);return"translate(0,"+(isFinite(r)?r:n(e))+")"})}function so(e){return e.toISOString()}function co(e,t,n){function r(t){return e(t)}function i(e,n){var r=e[1]-e[0],i=r/n,a=fo.bisect(Qc,i);return a==Qc.length?[t.year,ra(e.map(function(e){return e/31536e6}),n)[2]]:a?t[i/Qc[a-1]<Qc[a]/i?a-1:a]:[nl,ra(e,n)[2]]}return r.invert=function(t){return lo(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(lo)},r.nice=function(e,t){function n(n){return!isNaN(n)&&!e.range(n,lo(+n+1),t).length}var a=r.domain(),o=Hi(a),s=null==e?i(o,10):"number"==typeof e&&i(o,e);return s&&(e=s[0],t=s[1]),r.domain(Xi(a,t>1?{floor:function(t){for(;n(t=e.floor(t));)t=lo(t-1);return t},ceil:function(t){for(;n(t=e.ceil(t));)t=lo(+t+1);return t}}:e))},r.ticks=function(e,t){var n=Hi(r.domain()),a=null==e?i(n,10):"number"==typeof e?i(n,e):!e.range&&[{range:e},t];return a&&(e=a[0],t=a[1]),e.range(n[0],lo(+n[1]+1),t<1?1:t)},r.tickFormat=function(){return n},r.copy=function(){return co(e.copy(),t,n)},ta(r,e)}function lo(e){return new Date(e)}function uo(e){return JSON.parse(e.responseText)}function po(e){var t=ho.createRange();return t.selectNode(ho.body),t.createContextualFragment(e.responseText)}var fo={version:"3.5.17"},go=[].slice,mo=function(e){return go.call(e)},ho=this.document;if(ho)try{mo(ho.documentElement.childNodes)[0].nodeType}catch(e){mo=function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}}if(Date.now||(Date.now=function(){return+new Date}),ho)try{ho.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var bo=this.Element.prototype,vo=bo.setAttribute,Eo=bo.setAttributeNS,So=this.CSSStyleDeclaration.prototype,yo=So.setProperty;bo.setAttribute=function(e,t){vo.call(this,e,t+"")},bo.setAttributeNS=function(e,t,n){Eo.call(this,e,t,n+"")},So.setProperty=function(e,t,n){yo.call(this,e,t+"",n)}}fo.ascending=s,fo.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},fo.min=function(e,t){var n,r,i=-1,a=e.length;if(1===arguments.length){for(;++i<a;)if(null!=(r=e[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=e[i])&&n>r&&(n=r)}else{for(;++i<a;)if(null!=(r=t.call(e,e[i],i))&&r>=r){n=r;break}for(;++i<a;)null!=(r=t.call(e,e[i],i))&&n>r&&(n=r)}return n},fo.max=function(e,t){var n,r,i=-1,a=e.length;if(1===arguments.length){for(;++i<a;)if(null!=(r=e[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=e[i])&&r>n&&(n=r)}else{for(;++i<a;)if(null!=(r=t.call(e,e[i],i))&&r>=r){n=r;break}for(;++i<a;)null!=(r=t.call(e,e[i],i))&&r>n&&(n=r)}return n},fo.extent=function(e,t){var n,r,i,a=-1,o=e.length;if(1===arguments.length){for(;++a<o;)if(null!=(r=e[a])&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=e[a])&&(n>r&&(n=r),i<r&&(i=r))}else{for(;++a<o;)if(null!=(r=t.call(e,e[a],a))&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=t.call(e,e[a],a))&&(n>r&&(n=r),i<r&&(i=r))}return[n,i]},fo.sum=function(e,t){var n,r=0,i=e.length,a=-1;if(1===arguments.length)for(;++a<i;)l(n=+e[a])&&(r+=n);else for(;++a<i;)l(n=+t.call(e,e[a],a))&&(r+=n);return r},fo.mean=function(e,t){var n,r=0,i=e.length,a=-1,o=i;if(1===arguments.length)for(;++a<i;)l(n=c(e[a]))?r+=n:--o;else for(;++a<i;)l(n=c(t.call(e,e[a],a)))?r+=n:--o;if(o)return r/o},fo.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=+e[r-1],a=n-r;return a?i+a*(e[r]-i):i},fo.median=function(e,t){var n,r=[],i=e.length,a=-1;if(1===arguments.length)for(;++a<i;)l(n=c(e[a]))&&r.push(n);else for(;++a<i;)l(n=c(t.call(e,e[a],a)))&&r.push(n);if(r.length)return fo.quantile(r.sort(s),.5)},fo.variance=function(e,t){var n,r,i=e.length,a=0,o=0,s=-1,u=0;if(1===arguments.length)for(;++s<i;)l(n=c(e[s]))&&(r=n-a,a+=r/++u,o+=r*(n-a));else for(;++s<i;)l(n=c(t.call(e,e[s],s)))&&(r=n-a,a+=r/++u,o+=r*(n-a));if(u>1)return o/(u-1)},fo.deviation=function(){var e=fo.variance.apply(this,arguments);return e?Math.sqrt(e):e};var Ao=u(s);fo.bisectLeft=Ao.left,fo.bisect=fo.bisectRight=Ao.right,fo.bisector=function(e){return u(1===e.length?function(t,n){return s(e(t),n)}:e)},fo.shuffle=function(e,t,n){(a=arguments.length)<3&&(n=e.length,a<2&&(t=0));for(var r,i,a=n-t;a;)i=Math.random()*a--|0,r=e[a+t],e[a+t]=e[i+t],e[i+t]=r;return e},fo.permute=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},fo.pairs=function(e){for(var t=0,n=e.length-1,r=e[0],i=new Array(n<0?0:n);t<n;)i[t]=[r,r=e[++t]];return i},fo.transpose=function(e){if(!(i=e.length))return[];for(var t=-1,n=fo.min(e,d),r=new Array(n);++t<n;)for(var i,a=-1,o=r[t]=new Array(i);++a<i;)o[a]=e[a][t];return r},fo.zip=function(){return fo.transpose(arguments)},fo.keys=function(e){var t=[];for(var n in e)t.push(n);return t},fo.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},fo.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},fo.merge=function(e){for(var t,n,r,i=e.length,a=-1,o=0;++a<i;)o+=e[a].length;for(n=new Array(o);--i>=0;)for(r=e[i],t=r.length;--t>=0;)n[--o]=r[t];return n};var Co=Math.abs;fo.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n==1/0)throw new Error("infinite range");var r,i=[],a=p(Co(n)),o=-1;if(e*=a,t*=a,(n*=a)<0)for(;(r=e+n*++o)>t;)i.push(r/a);else for(;(r=e+n*++o)<t;)i.push(r/a);return i},fo.map=function(e,t){var n=new g;if(e instanceof g)e.forEach(function(e,t){n.set(e,t)});else if(Array.isArray(e)){var r,i=-1,a=e.length;if(1===arguments.length)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t.call(e,r=e[i],i),r)}else for(var o in e)n.set(o,e[o]);return n};var _o="__proto__",wo="\0";f(g,{has:b,get:function(e){return this._[m(e)]},set:function(e,t){return this._[m(e)]=t},remove:v,keys:E,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:h(t),value:this._[t]});return e},size:S,empty:y,forEach:function(e){for(var t in this._)e.call(this,h(t),this._[t])}}),fo.nest=function(){function e(t,o,s){if(s>=a.length)return r?r.call(i,o):n?o.sort(n):o;for(var c,l,u,d,p=-1,f=o.length,m=a[s++],h=new g;++p<f;)(d=h.get(c=m(l=o[p])))?d.push(l):h.set(c,[l]);return t?(l=t(),u=function(n,r){l.set(n,e(t,r,s))}):(l={},u=function(n,r){l[n]=e(t,r,s)}),h.forEach(u),l}function t(e,n){if(n>=a.length)return e;var r=[],i=o[n++];return e.forEach(function(e,i){r.push({key:e,values:t(i,n)})}),i?r.sort(function(e,t){return i(e.key,t.key)}):r}var n,r,i={},a=[],o=[];return i.map=function(t,n){return e(n,t,0)},i.entries=function(n){return t(e(fo.map,n,0),0)},i.key=function(e){return a.push(e),i},i.sortKeys=function(e){return o[a.length-1]=e,i},i.sortValues=function(e){return n=e,i},i.rollup=function(e){return r=e,i},i},fo.set=function(e){var t=new A;if(e)for(var n=0,r=e.length;n<r;++n)t.add(e[n]);return t},f(A,{has:b,add:function(e){return this._[m(e+="")]=!0,e},remove:v,values:E,size:S,empty:y,forEach:function(e){for(var t in this._)e.call(this,h(t))}}),fo.behavior={},fo.rebind=function(e,t){for(var n,r=1,i=arguments.length;++r<i;)e[n=arguments[r]]=_(e,t,t[n]);return e};var To=["webkit","ms","moz","Moz","o","O"];fo.dispatch=function(){for(var e=new R,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=O(e);return e},R.prototype.on=function(e,t){var n=e.indexOf("."),r="";if(n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},fo.event=null,fo.requote=function(e){return e.replace(Ro,"\\$&")};var Ro=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Oo={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},ko=function(e,t){return t.querySelector(e)},Io=function(e,t){return t.querySelectorAll(e)},Po=function(e,t){var n=e.matches||e[w(e,"matchesSelector")];return(Po=function(e,t){return n.call(e,t)})(e,t)};"function"==typeof Sizzle&&(ko=function(e,t){return Sizzle(e,t)[0]||null},Io=Sizzle,Po=Sizzle.matchesSelector),fo.selection=function(){return fo.select(ho.documentElement)};var No=fo.selection.prototype=[];No.select=function(e){var t,n,r,i,a=[];e=M(e);for(var o=-1,s=this.length;++o<s;){a.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,l=r.length;++c<l;)(i=r[c])?(t.push(n=e.call(i,i.__data__,c,o)),n&&"__data__"in i&&(n.__data__=i.__data__)):t.push(null)}return N(a)},No.selectAll=function(e){var t,n,r=[];e=L(e);for(var i=-1,a=this.length;++i<a;)for(var o=this[i],s=-1,c=o.length;++s<c;)(n=o[s])&&(r.push(t=mo(e.call(n,n.__data__,s,i))),t.parentNode=n);return N(r)};var Mo="http://www.w3.org/1999/xhtml",Lo={svg:"http://www.w3.org/2000/svg",xhtml:Mo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};fo.ns={prefix:Lo,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&"xmlns"!==(n=e.slice(0,t))&&(e=e.slice(t+1)),Lo.hasOwnProperty(n)?{space:Lo[n],local:e}:e}},No.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node();return e=fo.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(x(t,e[t]));return this}return this.each(x(e,t))},No.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),r=(e=B(e)).length,i=-1;if(t=n.classList){for(;++i<r;)if(!t.contains(e[i]))return!1}else for(t=n.getAttribute("class");++i<r;)if(!j(e[i]).test(t))return!1;return!0}for(t in e)this.each(F(t,e[t]));return this}return this.each(F(e,t))},No.style=function(e,t,n){var r=arguments.length;if(r<3){if("string"!=typeof e){r<2&&(t="");for(n in e)this.each(K(n,e[n],t));return this}if(r<2){var i=this.node();return o(i).getComputedStyle(i,null).getPropertyValue(e)}n=""}return this.each(K(e,t,n))},No.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(V(t,e[t]));return this}return this.each(V(e,t))},No.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},No.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},No.append=function(e){return e=G(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},No.insert=function(e,t){return e=G(e),t=M(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},No.remove=function(){return this.each(Y)},No.data=function(e,t){function n(e,n){var r,i,a,o=e.length,u=n.length,d=Math.min(o,u),p=new Array(u),f=new Array(u),m=new Array(o);if(t){var h,b=new g,v=new Array(o);for(r=-1;++r<o;)(i=e[r])&&(b.has(h=t.call(i,i.__data__,r))?m[r]=i:b.set(h,i),v[r]=h);for(r=-1;++r<u;)(i=b.get(h=t.call(n,a=n[r],r)))?!0!==i&&(p[r]=i,i.__data__=a):f[r]=W(a),b.set(h,!0);for(r=-1;++r<o;)r in v&&!0!==b.get(v[r])&&(m[r]=e[r])}else{for(r=-1;++r<d;)i=e[r],a=n[r],i?(i.__data__=a,p[r]=i):f[r]=W(a);for(;r<u;++r)f[r]=W(n[r]);for(;r<o;++r)m[r]=e[r]}f.update=p,f.parentNode=p.parentNode=m.parentNode=e.parentNode,s.push(f),c.push(p),l.push(m)}var r,i,a=-1,o=this.length;if(!arguments.length){for(e=new Array(o=(r=this[0]).length);++a<o;)(i=r[a])&&(e[a]=i.__data__);return e}var s=q([]),c=N([]),l=N([]);if("function"==typeof e)for(;++a<o;)n(r=this[a],e.call(r,r.parentNode.__data__,a));else for(;++a<o;)n(r=this[a],e);return c.enter=function(){return s},c.exit=function(){return l},c},No.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},No.filter=function(e){var t,n,r,i=[];"function"!=typeof e&&(e=z(e));for(var a=0,o=this.length;a<o;a++){i.push(t=[]),t.parentNode=(n=this[a]).parentNode;for(var s=0,c=n.length;s<c;s++)(r=n[s])&&e.call(r,r.__data__,s,a)&&t.push(r)}return N(i)},No.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,r=this[e],i=r.length-1,a=r[i];--i>=0;)(n=r[i])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},No.sort=function(e){e=$.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},No.each=function(e){return H(this,function(t,n,r){e.call(t,t.__data__,n,r)})},No.call=function(e){var t=mo(arguments);return e.apply(t[0]=this,t),this},No.empty=function(){return!this.node()},No.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,i=n.length;r<i;r++){var a=n[r];if(a)return a}return null},No.size=function(){var e=0;return H(this,function(){++e}),e};var xo=[];fo.selection.enter=q,fo.selection.enter.prototype=xo,xo.append=No.append,xo.empty=No.empty,xo.node=No.node,xo.call=No.call,xo.size=No.size,xo.select=function(e){for(var t,n,r,i,a,o=[],s=-1,c=this.length;++s<c;){r=(i=this[s]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var l=-1,u=i.length;++l<u;)(a=i[l])?(t.push(r[l]=n=e.call(i.parentNode,a.__data__,l,s)),n.__data__=a.__data__):t.push(null)}return N(o)},xo.insert=function(e,t){return arguments.length<2&&(t=J(this)),No.insert.call(this,e,t)},fo.select=function(e){var t;return"string"==typeof e?(t=[ko(e,ho)],t.parentNode=ho.documentElement):(t=[e],t.parentNode=a(e)),N([t])},fo.selectAll=function(e){var t;return"string"==typeof e?(t=mo(Io(e,ho)),t.parentNode=ho.documentElement):(t=mo(e),t.parentNode=null),N([t])},No.on=function(e,t,n){var r=arguments.length;if(r<3){if("string"!=typeof e){r<2&&(t=!1);for(n in e)this.each(X(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(X(e,t,n))};var Do=fo.map({mouseenter:"mouseover",mouseleave:"mouseout"});ho&&Do.forEach(function(e){"on"+e in ho&&Do.remove(e)});var jo,Bo=0;fo.mouse=function(e){return te(e,I())};var Fo=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;fo.touch=function(e,t,n){if(arguments.length<3&&(n=t,t=I().changedTouches),t)for(var r,i=0,a=t.length;i<a;++i)if((r=t[i]).identifier===n)return te(e,r)},fo.behavior.drag=function(){function e(){this.on("mousedown.drag",i).on("touchstart.drag",a)}function t(e,t,i,a,o){return function(){function s(){var e,n,r=t(p,m);r&&(e=r[0]-E[0],n=r[1]-E[1],g|=e|n,E=r,f({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:e,dy:n}))}function c(){t(p,m)&&(b.on(a+h,null).on(o+h,null),v(g),f({type:"dragend"}))}var l,u=this,d=fo.event.target.correspondingElement||fo.event.target,p=u.parentNode,f=n.of(u,arguments),g=0,m=e(),h=".drag"+(null==m?"":"-"+m),b=fo.select(i(d)).on(a+h,s).on(o+h,c),v=ee(d),E=t(p,m);r?(l=r.apply(u,arguments),l=[l.x-E[0],l.y-E[1]]):l=[0,0],f({type:"dragstart"})}}var n=P(e,"drag","dragstart","dragend"),r=null,i=t(T,fo.mouse,o,"mousemove","mouseup"),a=t(ne,fo.touch,C,"touchmove","touchend");return e.origin=function(t){return arguments.length?(r=t,e):r},fo.rebind(e,n,"on")},fo.touches=function(e,t){return arguments.length<2&&(t=I().touches),t?mo(t).map(function(t){var n=te(e,t);return n.identifier=t.identifier,n}):[]};var Uo=1e-6,Ko=Uo*Uo,Vo=Math.PI,Go=2*Vo,Yo=Go-Uo,Wo=Vo/2,zo=Vo/180,$o=180/Vo,Ho=Math.SQRT2;fo.interpolateZoom=function(e,t){var n,r,i=e[0],a=e[1],o=e[2],s=t[0],c=t[1],l=t[2],u=s-i,d=c-a,p=u*u+d*d;if(p<Ko)r=Math.log(l/o)/Ho,n=function(e){return[i+e*u,a+e*d,o*Math.exp(Ho*e*r)]};else{var f=Math.sqrt(p),g=(l*l-o*o+4*p)/(2*o*2*f),m=(l*l-o*o-4*p)/(2*l*2*f),h=Math.log(Math.sqrt(g*g+1)-g),b=Math.log(Math.sqrt(m*m+1)-m);r=(b-h)/Ho,n=function(e){var t=e*r,n=ce(h),s=o/(2*f)*(n*le(Ho*t+h)-se(h));return[i+s*u,a+s*d,o*n/ce(Ho*t+h)]}}return n.duration=1e3*r,n},fo.behavior.zoom=function(){function e(e){e.on(I,d).on(Jo+".zoom",f).on("dblclick.zoom",g).on(L,p)}function t(e){return[(e[0]-_.x)/_.k,(e[1]-_.y)/_.k]}function n(e){return[e[0]*_.k+_.x,e[1]*_.k+_.y]}function r(e){_.k=Math.max(T[0],Math.min(T[1],e))}function i(e,t){t=n(t),_.x+=e[0]-t[0],_.y+=e[1]-t[1]}function a(t,n,a,o){t.__chart__={x:_.x,y:_.y,k:_.k},r(Math.pow(2,o)),i(h=n,a),t=fo.select(t),R>0&&(t=t.transition().duration(R)),t.call(e.event)}function s(){y&&y.domain(S.range().map(function(e){return(e-_.x)/_.k}).map(S.invert)),C&&C.domain(A.range().map(function(e){return(e-_.y)/_.k}).map(A.invert))}function c(e){O++||e({type:"zoomstart"})}function l(e){s(),e({type:"zoom",scale:_.k,translate:[_.x,_.y]})}function u(e){--O||(e({type:"zoomend"}),h=null)}function d(){function e(){s=1,i(fo.mouse(r),p),l(a)}function n(){d.on(N,null).on(M,null),f(s),u(a)}var r=this,a=x.of(r,arguments),s=0,d=fo.select(o(r)).on(N,e).on(M,n),p=t(fo.mouse(r)),f=ee(r);Gc.call(r),c(a)}function p(){function e(){var e=fo.touches(g);return f=_.k,e.forEach(function(e){e.identifier in h&&(h[e.identifier]=t(e))}),e}function n(){var t=fo.event.target;fo.select(t).on(S,o).on(y,s),A.push(t);for(var n=fo.event.changedTouches,r=0,i=n.length;r<i;++r)h[n[r].identifier]=null;var c=e(),l=Date.now();if(1===c.length){if(l-E<500){var u=c[0];a(g,u,h[u.identifier],Math.floor(Math.log(_.k)/Math.LN2)+1),k()}E=l}else if(c.length>1){var u=c[0],d=c[1],p=u[0]-d[0],f=u[1]-d[1];b=p*p+f*f}}function o(){var e,t,n,a,o=fo.touches(g);Gc.call(g);for(var s=0,c=o.length;s<c;++s,a=null)if(n=o[s],a=h[n.identifier]){if(t)break;e=n,t=a}if(a){var u=(u=n[0]-e[0])*u+(u=n[1]-e[1])*u,d=b&&Math.sqrt(u/b);e=[(e[0]+n[0])/2,(e[1]+n[1])/2],t=[(t[0]+a[0])/2,(t[1]+a[1])/2],r(d*f)}E=null,i(e,t),l(m)}function s(){if(fo.event.touches.length){for(var t=fo.event.changedTouches,n=0,r=t.length;n<r;++n)delete h[t[n].identifier];for(var i in h)return void e()}fo.selectAll(A).on(v,null),C.on(I,d).on(L,p),w(),u(m)}var f,g=this,m=x.of(g,arguments),h={},b=0,v=".zoom-"+fo.event.changedTouches[0].identifier,S="touchmove"+v,y="touchend"+v,A=[],C=fo.select(g),w=ee(g);n(),c(m),C.on(I,null).on(L,n)}function f(){var e=x.of(this,arguments);v?clearTimeout(v):(Gc.call(this),m=t(h=b||fo.mouse(this)),c(e)),v=setTimeout(function(){v=null,u(e)},50),k(),r(Math.pow(2,.002*qo())*_.k),i(h,m),l(e)}function g(){var e=fo.mouse(this),n=Math.log(_.k)/Math.LN2;a(this,e,t(e),fo.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var m,h,b,v,E,S,y,A,C,_={x:0,y:0,k:1},w=[960,500],T=Xo,R=250,O=0,I="mousedown.zoom",N="mousemove.zoom",M="mouseup.zoom",L="touchstart.zoom",x=P(e,"zoomstart","zoom","zoomend");return Jo||(Jo="onwheel"in ho?(qo=function(){return-fo.event.deltaY*(fo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ho?(qo=function(){return fo.event.wheelDelta},"mousewheel"):(qo=function(){return-fo.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=x.of(this,arguments),t=_;Kc?fo.select(this).transition().each("start.zoom",function(){_=this.__chart__||{x:0,y:0,k:1},c(e)}).tween("zoom:zoom",function(){var n=w[0],r=w[1],i=h?h[0]:n/2,a=h?h[1]:r/2,o=fo.interpolateZoom([(i-_.x)/_.k,(a-_.y)/_.k,n/_.k],[(i-t.x)/t.k,(a-t.y)/t.k,n/t.k]);return function(t){var r=o(t),s=n/r[2];this.__chart__=_={x:i-r[0]*s,y:a-r[1]*s,k:s},l(e)}}).each("interrupt.zoom",function(){u(e)}).each("end.zoom",function(){u(e)}):(this.__chart__=_,c(e),l(e),u(e))})},e.translate=function(t){return arguments.length?(_={x:+t[0],y:+t[1],k:_.k},s(),e):[_.x,_.y]},e.scale=function(t){return arguments.length?(_={x:_.x,y:_.y,k:null},r(+t),s(),e):_.k},e.scaleExtent=function(t){return arguments.length?(T=null==t?Xo:[+t[0],+t[1]],e):T},e.center=function(t){return arguments.length?(b=t&&[+t[0],+t[1]],e):b},e.size=function(t){return arguments.length?(w=t&&[+t[0],+t[1]],e):w},e.duration=function(t){return arguments.length?(R=+t,e):R},e.x=function(t){return arguments.length?(y=t,S=t.copy(),_={x:0,y:0,k:1},e):y},e.y=function(t){return arguments.length?(C=t,A=t.copy(),_={x:0,y:0,k:1},e):C},fo.rebind(e,x,"on")};var qo,Jo,Xo=[0,1/0];fo.color=de,de.prototype.toString=function(){return this.rgb()+""},fo.hsl=pe;var Zo=pe.prototype=new de;Zo.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new pe(this.h,this.s,this.l/e)},Zo.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new pe(this.h,this.s,e*this.l)},Zo.rgb=function(){return fe(this.h,this.s,this.l)},fo.hcl=ge;var Qo=ge.prototype=new de;Qo.brighter=function(e){return new ge(this.h,this.c,Math.min(100,this.l+es*(arguments.length?e:1)))},Qo.darker=function(e){return new ge(this.h,this.c,Math.max(0,this.l-es*(arguments.length?e:1)))},Qo.rgb=function(){return me(this.h,this.c,this.l).rgb()},fo.lab=he;var es=18,ts=.95047,ns=1,rs=1.08883,is=he.prototype=new de;is.brighter=function(e){return new he(Math.min(100,this.l+es*(arguments.length?e:1)),this.a,this.b)},is.darker=function(e){return new he(Math.max(0,this.l-es*(arguments.length?e:1)),this.a,this.b)},is.rgb=function(){return be(this.l,this.a,this.b)},fo.rgb=Ae;var as=Ae.prototype=new de;as.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return t||n||r?(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),new Ae(Math.min(255,t/e),Math.min(255,n/e),Math.min(255,r/e))):new Ae(i,i,i)},as.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new Ae(e*this.r,e*this.g,e*this.b)},as.hsl=function(){return Re(this.r,this.g,this.b)},as.toString=function(){return"#"+we(this.r)+we(this.g)+we(this.b)};var os=fo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});os.forEach(function(e,t){os.set(e,Ce(t))}),fo.functor=Pe,fo.xhr=Ne(C),fo.dsv=function(e,t){function n(e,n,a){arguments.length<3&&(a=n,n=null);var o=Me(e,t,null==n?r:i(n),a);return o.row=function(e){return arguments.length?o.response(null==(n=e)?r:i(e)):n},o}function r(e){return n.parse(e.responseText)}function i(e){return function(t){return n.parse(t.responseText,e)}}function a(t){return t.map(o).join(e)}function o(e){return s.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp('["'+e+"\n]"),c=e.charCodeAt(0);return n.parse=function(e,t){var r;return n.parseRows(e,function(e,n){if(r)return r(e,n-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,n){return t(i(e),n)}:i})},n.parseRows=function(e,t){function n(){if(u>=l)return o;if(i)return i=!1,a;var t=u;if(34===e.charCodeAt(t)){for(var n=t;n++<l;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}u=n+2;var r=e.charCodeAt(n+1);return 13===r?(i=!0,10===e.charCodeAt(n+2)&&++u):10===r&&(i=!0),e.slice(t+1,n).replace(/""/g,'"')}for(;u<l;){var r=e.charCodeAt(u++),s=1;if(10===r)i=!0;else if(13===r)i=!0,10===e.charCodeAt(u)&&(++u,++s);else if(r!==c)continue;return e.slice(t,u-s)}return e.slice(t)}for(var r,i,a={},o={},s=[],l=e.length,u=0,d=0;(r=n())!==o;){for(var p=[];r!==a&&r!==o;)p.push(r),r=n();t&&null==(p=t(p,d++))||s.push(p)}return s},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var r=new A,i=[];return t.forEach(function(e){for(var t in e)r.has(t)||i.push(r.add(t))}),[i.map(o).join(e)].concat(t.map(function(t){return i.map(function(e){return o(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(a).join("\n")},n},fo.csv=fo.dsv(",","text/csv"),fo.tsv=fo.dsv("\t","text/tab-separated-values");var ss,cs,ls,us,ds=this[w(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};fo.timer=function(){De.apply(this,arguments)},fo.timer.flush=function(){Be(),Fe()},fo.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var ps=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Ke);fo.formatPrefix=function(e,t){var n=0;return(e=+e)&&(e<0&&(e*=-1),t&&(e=fo.round(e,Ue(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),ps[8+n/3]};var fs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,gs=fo.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=fo.round(e,Ue(e,t))).toFixed(Math.max(0,Math.min(20,Ue(e*(1+1e-15),t))))}}),ms=fo.time={},hs=Date;Ye.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){bs.setUTCDate.apply(this._,arguments)},setDay:function(){bs.setUTCDay.apply(this._,arguments)},setFullYear:function(){bs.setUTCFullYear.apply(this._,arguments)},setHours:function(){bs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){bs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){bs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){bs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){bs.setUTCSeconds.apply(this._,arguments)},setTime:function(){bs.setTime.apply(this._,arguments)}};var bs=Date.prototype;ms.year=We(function(e){return e=ms.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),ms.years=ms.year.range,ms.years.utc=ms.year.utc.range,ms.day=We(function(e){var t=new hs(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),ms.days=ms.day.range,ms.days.utc=ms.day.utc.range,ms.dayOfYear=function(e){var t=ms.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=ms[e]=We(function(e){return(e=ms.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=ms.year(e).getDay();return Math.floor((ms.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});ms[e+"s"]=n.range,ms[e+"s"].utc=n.utc.range,ms[e+"OfYear"]=function(e){var n=ms.year(e).getDay();return Math.floor((ms.dayOfYear(e)+(n+t)%7)/7)}}),ms.week=ms.sunday,ms.weeks=ms.sunday.range,ms.weeks.utc=ms.sunday.utc.range,ms.weekOfYear=ms.sundayOfYear;var vs={"-":"",_:" ",0:"0"},Es=/^\s*\d+/,Ss=/^%/;fo.locale=function(e){return{numberFormat:Ve(e),timeFormat:$e(e)}};var ys=fo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});fo.format=ys.numberFormat,fo.geo={},gt.prototype={s:0,t:0,add:function(e){mt(e,this.t,As),mt(As.s,this.s,this),this.s?this.t+=As.t:this.s=As.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var As=new gt;fo.geo.stream=function(e,t){e&&Cs.hasOwnProperty(e.type)?Cs[e.type](e,t):ht(e,t)};var Cs={Feature:function(e,t){ht(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)ht(n[r].geometry,t)}},_s={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){bt(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)bt(n[r],t,0)},Polygon:function(e,t){vt(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)vt(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)ht(n[r],t)}};fo.geo.area=function(e){return ws=0,fo.geo.stream(e,Rs),ws};var ws,Ts=new gt,Rs={sphere:function(){ws+=4*Vo},point:T,lineStart:T,lineEnd:T,polygonStart:function(){Ts.reset(),Rs.lineStart=Et},polygonEnd:function(){var e=2*Ts;ws+=e<0?4*Vo+e:e,Rs.lineStart=Rs.lineEnd=Rs.point=T}};fo.geo.bounds=function(){function e(e,t){E.push(S=[u=e,p=e]),t<d&&(d=t),t>f&&(f=t)}function t(t,n){var r=St([t*zo,n*zo]);if(b){var i=At(b,r),a=[i[1],-i[0],0],o=At(a,i);wt(o),o=Tt(o);var c=t-g,l=c>0?1:-1,m=o[0]*$o*l,h=Co(c)>180;if(h^(l*g<m&&m<l*t)){var v=o[1]*$o;v>f&&(f=v)}else if(m=(m+360)%360-180,h^(l*g<m&&m<l*t)){var v=-o[1]*$o;v<d&&(d=v)}else n<d&&(d=n),n>f&&(f=n);h?t<g?s(u,t)>s(u,p)&&(p=t):s(t,p)>s(u,p)&&(u=t):p>=u?(t<u&&(u=t),t>p&&(p=t)):t>g?s(u,t)>s(u,p)&&(p=t):s(t,p)>s(u,p)&&(u=t)}else e(t,n);b=r,g=t}function n(){y.point=t}function r(){S[0]=u,S[1]=p,y.point=e,b=null}function i(e,n){if(b){var r=e-g;v+=Co(r)>180?r+(r>0?360:-360):r}else m=e,h=n;Rs.point(e,n),t(e,n)}function a(){Rs.lineStart()}function o(){i(m,h),Rs.lineEnd(),Co(v)>Uo&&(u=-(p=180)),S[0]=u,S[1]=p,b=null}function s(e,t){return(t-=e)<0?t+360:t}function c(e,t){return e[0]-t[0]}function l(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var u,d,p,f,g,m,h,b,v,E,S,y={point:e,lineStart:n,lineEnd:r,polygonStart:function(){y.point=i,y.lineStart=a,y.lineEnd=o,v=0,Rs.polygonStart()},polygonEnd:function(){Rs.polygonEnd(),y.point=e,y.lineStart=n,y.lineEnd=r,Ts<0?(u=-(p=180),d=-(f=90)):v>Uo?f=90:v<-Uo&&(d=-90),S[0]=u,S[1]=p}};return function(e){f=p=-(u=d=1/0),E=[],fo.geo.stream(e,y);var t=E.length;if(t){E.sort(c);for(var n,r=1,i=E[0],a=[i];r<t;++r)n=E[r],l(n[0],i)||l(n[1],i)?(s(i[0],n[1])>s(i[0],i[1])&&(i[1]=n[1]),s(n[0],i[1])>s(i[0],i[1])&&(i[0]=n[0])):a.push(i=n);for(var o,n,g=-1/0,t=a.length-1,r=0,i=a[t];r<=t;i=n,++r)n=a[r],(o=s(i[1],n[0]))>g&&(g=o,u=n[0],p=i[1])}return E=S=null,u===1/0||d===1/0?[[NaN,NaN],[NaN,NaN]]:[[u,d],[p,f]]}}(),fo.geo.centroid=function(e){Os=ks=Is=Ps=Ns=Ms=Ls=xs=Ds=js=Bs=0,fo.geo.stream(e,Fs);var t=Ds,n=js,r=Bs,i=t*t+n*n+r*r;return i<Ko&&(t=Ms,n=Ls,r=xs,ks<Uo&&(t=Is,n=Ps,r=Ns),(i=t*t+n*n+r*r)<Ko)?[NaN,NaN]:[Math.atan2(n,t)*$o,oe(r/Math.sqrt(i))*$o]};var Os,ks,Is,Ps,Ns,Ms,Ls,xs,Ds,js,Bs,Fs={sphere:T,point:Ot,lineStart:It,lineEnd:Pt,polygonStart:function(){Fs.lineStart=Nt},polygonEnd:function(){Fs.lineStart=It}},Us=Bt(Lt,Vt,Yt,[-Vo,-Vo/2]),Ks=1e9;fo.geo.clipExtent=function(){var e,t,n,r,i,a,o={stream:function(e){return i&&(i.valid=!1),i=a(e),i.valid=!0,i},extent:function(s){return arguments.length?(a=Ht(e=+s[0][0],t=+s[0][1],n=+s[1][0],r=+s[1][1]),i&&(i.valid=!1,i=null),o):[[e,t],[n,r]]}};return o.extent([[0,0],[960,500]])},(fo.geo.conicEqualArea=function(){return qt(Jt)}).raw=Jt,fo.geo.albers=function(){return fo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},fo.geo.albersUsa=function(){function e(e){var a=e[0],o=e[1];return t=null,n(a,o),t||(r(a,o),t)||i(a,o),t}var t,n,r,i,a=fo.geo.albers(),o=fo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=fo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,n){t=[e,n]}};return e.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?o:i>=.166&&i<.234&&r>=-.214&&r<-.115?s:a).invert(e)},e.stream=function(e){var t=a.stream(e),n=o.stream(e),r=s.stream(e);return{point:function(e,i){t.point(e,i),n.point(e,i),r.point(e,i)},sphere:function(){t.sphere(),n.sphere(),r.sphere()},lineStart:function(){t.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},e.precision=function(t){return arguments.length?(a.precision(t),o.precision(t),s.precision(t),e):a.precision()},e.scale=function(t){return arguments.length?(a.scale(t),o.scale(.35*t),s.scale(t),e.translate(a.translate())):a.scale()},e.translate=function(t){if(!arguments.length)return a.translate();var l=a.scale(),u=+t[0],d=+t[1];return n=a.translate(t).clipExtent([[u-.455*l,d-.238*l],[u+.455*l,d+.238*l]]).stream(c).point,r=o.translate([u-.307*l,d+.201*l]).clipExtent([[u-.425*l+Uo,d+.12*l+Uo],[u-.214*l-Uo,d+.234*l-Uo]]).stream(c).point,i=s.translate([u-.205*l,d+.212*l]).clipExtent([[u-.214*l+Uo,d+.166*l+Uo],[u-.115*l-Uo,d+.234*l-Uo]]).stream(c).point,e},e.scale(1070)};var Vs,Gs,Ys,Ws,zs,$s,Hs={point:T,lineStart:T,lineEnd:T,polygonStart:function(){Gs=0,Hs.lineStart=Xt},polygonEnd:function(){Hs.lineStart=Hs.lineEnd=Hs.point=T,Vs+=Co(Gs/2)}},qs={point:Zt,lineStart:T,lineEnd:T,polygonStart:T,polygonEnd:T},Js={point:tn,lineStart:nn,lineEnd:rn,polygonStart:function(){Js.lineStart=an},polygonEnd:function(){Js.point=tn,Js.lineStart=nn,Js.lineEnd=rn}};fo.geo.path=function(){function e(e){return e&&("function"==typeof s&&a.pointRadius(+s.apply(this,arguments)),o&&o.valid||(o=i(a)),fo.geo.stream(e,o)),a.result()}function t(){return o=null,e}var n,r,i,a,o,s=4.5;return e.area=function(e){return Vs=0,fo.geo.stream(e,i(Hs)),Vs},e.centroid=function(e){return Is=Ps=Ns=Ms=Ls=xs=Ds=js=Bs=0,fo.geo.stream(e,i(Js)),Bs?[Ds/Bs,js/Bs]:xs?[Ms/xs,Ls/xs]:Ns?[Is/Ns,Ps/Ns]:[NaN,NaN]},e.bounds=function(e){return zs=$s=-(Ys=Ws=1/0),fo.geo.stream(e,i(qs)),[[Ys,Ws],[zs,$s]]},e.projection=function(e){return arguments.length?(i=(n=e)?e.stream||cn(e):C,t()):n},e.context=function(e){return arguments.length?(a=null==(r=e)?new Qt:new on(e),"function"!=typeof s&&a.pointRadius(s),t()):r},e.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(a.pointRadius(+t),+t),e):s},e.projection(fo.geo.albersUsa()).context(null)},fo.geo.transform=function(e){return{stream:function(t){var n=new ln(t);for(var r in e)n[r]=e[r];return n}}},ln.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},fo.geo.projection=dn,fo.geo.projectionMutator=pn,(fo.geo.equirectangular=function(){return dn(gn)}).raw=gn.invert=gn,fo.geo.rotation=function(e){function t(t){return t=e(t[0]*zo,t[1]*zo),t[0]*=$o,t[1]*=$o,t}return e=hn(e[0]%360*zo,e[1]*zo,e.length>2?e[2]*zo:0),t.invert=function(t){return t=e.invert(t[0]*zo,t[1]*zo),t[0]*=$o,t[1]*=$o,t},t},mn.invert=gn,fo.geo.circle=function(){function e(){var e="function"==typeof r?r.apply(this,arguments):r,t=hn(-e[0]*zo,-e[1]*zo,0).invert,i=[];return n(null,null,1,{point:function(e,n){i.push(e=t(e,n)),e[0]*=$o,e[1]*=$o}}),{type:"Polygon",coordinates:[i]}}var t,n,r=[0,0],i=6;return e.origin=function(t){return arguments.length?(r=t,e):r},e.angle=function(r){return arguments.length?(n=Sn((t=+r)*zo,i*zo),e):t},e.precision=function(r){return arguments.length?(n=Sn(t*zo,(i=+r)*zo),e):i},e.angle(90)},fo.geo.distance=function(e,t){var n,r=(t[0]-e[0])*zo,i=e[1]*zo,a=t[1]*zo,o=Math.sin(r),s=Math.cos(r),c=Math.sin(i),l=Math.cos(i),u=Math.sin(a),d=Math.cos(a);return Math.atan2(Math.sqrt((n=d*o)*n+(n=l*u-c*d*s)*n),c*u+l*d*s)},fo.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return fo.range(Math.ceil(a/h)*h,i,h).map(p).concat(fo.range(Math.ceil(l/b)*b,c,b).map(f)).concat(fo.range(Math.ceil(r/g)*g,n,g).filter(function(e){return Co(e%h)>Uo}).map(u)).concat(fo.range(Math.ceil(s/m)*m,o,m).filter(function(e){return Co(e%b)>Uo}).map(d))}var n,r,i,a,o,s,c,l,u,d,p,f,g=10,m=g,h=90,b=360,v=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[p(a).concat(f(c).slice(1),p(i).reverse().slice(1),f(l).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(a=+t[0][0],i=+t[1][0],l=+t[0][1],c=+t[1][1],a>i&&(t=a,a=i,i=t),l>c&&(t=l,l=c,c=t),e.precision(v)):[[a,l],[i,c]]},e.minorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),e.precision(v)):[[r,s],[n,o]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(h=+t[0],b=+t[1],e):[h,b]},e.minorStep=function(t){return arguments.length?(g=+t[0],m=+t[1],e):[g,m]},e.precision=function(t){return arguments.length?(v=+t,u=An(s,o,90),d=Cn(r,n,v),p=An(l,c,90),f=Cn(a,i,v),e):v},e.majorExtent([[-180,-90+Uo],[180,90-Uo]]).minorExtent([[-180,-80-Uo],[180,80+Uo]])},fo.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),n||i.apply(this,arguments)]}}var t,n,r=_n,i=wn;return e.distance=function(){return fo.geo.distance(t||r.apply(this,arguments),n||i.apply(this,arguments))},e.source=function(n){return arguments.length?(r=n,t="function"==typeof n?null:n,e):r},e.target=function(t){return arguments.length?(i=t,n="function"==typeof t?null:t,e):i},e.precision=function(){return arguments.length?e:0},e},fo.geo.interpolate=function(e,t){return Tn(e[0]*zo,e[1]*zo,t[0]*zo,t[1]*zo)},fo.geo.length=function(e){return Xs=0,fo.geo.stream(e,Zs),Xs};var Xs,Zs={sphere:T,point:T,lineStart:Rn,lineEnd:T,polygonStart:T,polygonEnd:T},Qs=On(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(fo.geo.azimuthalEqualArea=function(){return dn(Qs)}).raw=Qs;var ec=On(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},C);(fo.geo.azimuthalEquidistant=function(){return dn(ec)}).raw=ec,(fo.geo.conicConformal=function(){return qt(kn)}).raw=kn,(fo.geo.conicEquidistant=function(){return qt(In)}).raw=In;var tc=On(function(e){return 1/e},Math.atan);(fo.geo.gnomonic=function(){return dn(tc)}).raw=tc,Pn.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Wo]},(fo.geo.mercator=function(){return Nn(Pn)}).raw=Pn;var nc=On(function(){return 1},Math.asin);(fo.geo.orthographic=function(){return dn(nc)}).raw=nc;var rc=On(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(fo.geo.stereographic=function(){return dn(rc)}).raw=rc,Mn.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Wo]},(fo.geo.transverseMercator=function(){var e=Nn(Mn),t=e.center,n=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90])}).raw=Mn,fo.geom={},fo.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,i=Pe(n),a=Pe(r),o=e.length,s=[],c=[];for(t=0;t<o;t++)s.push([+i.call(this,e[t],t),+a.call(this,e[t],t),t]);for(s.sort(jn),t=0;t<o;t++)c.push([s[t][0],-s[t][1]]);var l=Dn(s),u=Dn(c),d=u[0]===l[0],p=u[u.length-1]===l[l.length-1],f=[];for(t=l.length-1;t>=0;--t)f.push(e[s[l[t]][2]]);for(t=+d;t<u.length-p;++t)f.push(e[s[u[t]][2]]);return f}var n=Ln,r=xn;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t)},fo.geom.polygon=function(e){return Oo(e,ic),e};var ic=fo.geom.polygon.prototype=[];ic.area=function(){for(var e,t=-1,n=this.length,r=this[n-1],i=0;++t<n;)e=r,r=this[t],i+=e[1]*r[0]-e[0]*r[1];return.5*i},ic.centroid=function(e){var t,n,r=-1,i=this.length,a=0,o=0,s=this[i-1];for(arguments.length||(e=-1/(6*this.area()));++r<i;)t=s,s=this[r],n=t[0]*s[1]-s[0]*t[1],a+=(t[0]+s[0])*n,o+=(t[1]+s[1])*n;return[a*e,o*e]},ic.clip=function(e){for(var t,n,r,i,a,o,s=Un(e),c=-1,l=this.length-Un(this),u=this[l-1];++c<l;){for(t=e.slice(),e.length=0,i=this[c],a=t[(r=t.length-s)-1],n=-1;++n<r;)o=t[n],Bn(o,u,i)?(Bn(a,u,i)||e.push(Fn(a,o,u,i)),e.push(o)):Bn(a,u,i)&&e.push(Fn(a,o,u,i)),a=o;s&&e.push(e[0]),u=i}return e};var ac,oc,sc,cc,lc,uc=[],dc=[];Hn.prototype.prepare=function(){for(var e,t=this.edges,n=t.length;n--;)e=t[n].edge,e.b&&e.a||t.splice(n,1);return t.sort(Jn),t.length},or.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},sr.prototype={insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=dr(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(lr(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ur(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(ur(this,n),e=n,n=e.U),n.C=!1,r.C=!0,lr(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,i=e.U,a=e.L,o=e.R;if(n=a?o?dr(o):a:o,i?i.L===e?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=e.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=e.U,e=n.R,i.L=e,n.R=o,o.U=n):(n.U=i,i=n,e=n.R)):(r=e.C,e=n),e&&(e.U=i),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===i.L){if(t=i.R,t.C&&(t.C=!1,i.C=!0,lr(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ur(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,lr(this,i),e=this._;break}}else if(t=i.L,t.C&&(t.C=!1,i.C=!0,ur(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,lr(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,ur(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}},fo.geom.voronoi=function(e){function t(e){var t=new Array(e.length),r=s[0][0],i=s[0][1],a=s[1][0],o=s[1][1];return pr(n(e),s).cells.forEach(function(n,s){var c=n.edges,l=n.site;(t[s]=c.length?c.map(function(e){var t=e.start();return[t.x,t.y]}):l.x>=r&&l.x<=a&&l.y>=i&&l.y<=o?[[r,o],[a,o],[a,i],[r,i]]:[]).point=e[s]}),t}function n(e){return e.map(function(e,t){return{x:Math.round(a(e,t)/Uo)*Uo,y:Math.round(o(e,t)/Uo)*Uo,i:t}})}var r=Ln,i=xn,a=r,o=i,s=pc;return e?t(e):(t.links=function(e){return pr(n(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return pr(n(e)).cells.forEach(function(n,r){for(var i,a=n.site,o=n.edges.sort(Jn),s=-1,c=o.length,l=o[c-1].edge,u=l.l===a?l.r:l.l;++s<c;)i=u,l=o[s].edge,u=l.l===a?l.r:l.l,r<i.i&&r<u.i&&gr(a,i,u)<0&&t.push([e[r],e[i.i],e[u.i]])}),t},t.x=function(e){return arguments.length?(a=Pe(r=e),t):r},t.y=function(e){return arguments.length?(o=Pe(i=e),t):i},t.clipExtent=function(e){return arguments.length?(s=null==e?pc:e,t):s===pc?null:s},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):s===pc?null:s&&s[1]},t)};var pc=[[-1e6,-1e6],[1e6,1e6]];fo.geom.delaunay=function(e){return fo.geom.voronoi().triangles(e)},fo.geom.quadtree=function(e,t,n,r,i){function a(e){function a(e,t,n,r,i,a,o,s){if(!isNaN(n)&&!isNaN(r))if(e.leaf){var c=e.x,u=e.y;if(null!=c)if(Co(c-n)+Co(u-r)<.01)l(e,t,n,r,i,a,o,s);else{var d=e.point;e.x=e.y=e.point=null,l(e,d,c,u,i,a,o,s),l(e,t,n,r,i,a,o,s)}else e.x=n,e.y=r,e.point=t}else l(e,t,n,r,i,a,o,s)}function l(e,t,n,r,i,o,s,c){var l=.5*(i+s),u=.5*(o+c),d=n>=l,p=r>=u,f=p<<1|d;e.leaf=!1,e=e.nodes[f]||(e.nodes[f]=br()),d?i=l:s=l,p?o=u:c=u,a(e,t,n,r,i,o,s,c)}var u,d,p,f,g,m,h,b,v,E=Pe(s),S=Pe(c);if(null!=t)m=t,h=n,b=r,v=i;else if(b=v=-(m=h=1/0),d=[],p=[],g=e.length,o)for(f=0;f<g;++f)u=e[f],u.x<m&&(m=u.x),u.y<h&&(h=u.y),u.x>b&&(b=u.x),u.y>v&&(v=u.y),d.push(u.x),p.push(u.y);else for(f=0;f<g;++f){var y=+E(u=e[f],f),A=+S(u,f);y<m&&(m=y),A<h&&(h=A),y>b&&(b=y),A>v&&(v=A),d.push(y),p.push(A)}var C=b-m,_=v-h;C>_?v=h+C:b=m+_;var w=br();if(w.add=function(e){a(w,e,+E(e,++f),+S(e,f),m,h,b,v)},w.visit=function(e){vr(e,w,m,h,b,v)},w.find=function(e){return Er(w,e[0],e[1],m,h,b,v)},f=-1,null==t){for(;++f<g;)a(w,e[f],d[f],p[f],m,h,b,v);--f}else e.forEach(w.add);return d=p=e=u=null,w}var o,s=Ln,c=xn;return(o=arguments.length)?(s=mr,c=hr,3===o&&(i=n,r=t,n=t=0),a(e)):(a.x=function(e){return arguments.length?(s=e,a):s},a.y=function(e){return arguments.length?(c=e,a):c},a.extent=function(e){return arguments.length?(null==e?t=n=r=i=null:(t=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),a):null==t?null:[[t,n],[r,i]]},a.size=function(e){return arguments.length?(null==e?t=n=r=i=null:(t=n=0,r=+e[0],i=+e[1]),a):null==t?null:[r-t,i-n]},a)},fo.interpolateRgb=Sr,fo.interpolateObject=yr,fo.interpolateNumber=Ar,fo.interpolateString=Cr;var fc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gc=new RegExp(fc.source,"g");fo.interpolate=_r,fo.interpolators=[function(e,t){var n=typeof t;return("string"===n?os.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?Sr:Cr:t instanceof de?Sr:Array.isArray(t)?wr:"object"===n&&isNaN(t)?yr:Ar)(e,t)}],fo.interpolateArray=wr;var mc=function(){return C},hc=fo.map({linear:mc,poly:Nr,quad:function(){return kr},cubic:function(){return Ir},sin:function(){return Mr},exp:function(){return Lr},circle:function(){return xr},elastic:Dr,back:jr,bounce:function(){return Br}}),bc=fo.map({in:C,out:Rr,"in-out":Or,"out-in":function(e){return Or(Rr(e))}});fo.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.slice(0,t):e,r=t>=0?e.slice(t+1):"in";return n=hc.get(n)||mc,r=bc.get(r)||C,Tr(r(n.apply(null,go.call(arguments,1))))},fo.interpolateHcl=Fr,fo.interpolateHsl=Ur,fo.interpolateLab=Kr,fo.interpolateRound=Vr,fo.transform=function(e){var t=ho.createElementNS(fo.ns.prefix.svg,"g");return(fo.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new Gr(n?n.matrix:vc)})(e)},Gr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var vc={a:1,b:0,c:0,d:1,e:0,f:0};fo.interpolateTransform=Zr,fo.layout={},fo.layout.bundle=function(){return function(e){for(var t=[],n=-1,r=e.length;++n<r;)t.push(ti(e[n]));return t}},fo.layout.chord=function(){function e(){var e,l,d,p,f,g={},m=[],h=fo.range(a),b=[];for(n=[],r=[],e=0,p=-1;++p<a;){for(l=0,f=-1;++f<a;)l+=i[p][f];m.push(l),b.push(fo.range(a)),e+=l}for(o&&h.sort(function(e,t){return o(m[e],m[t])}),s&&b.forEach(function(e,t){e.sort(function(e,n){return s(i[t][e],i[t][n])})}),e=(Go-u*a)/e,l=0,p=-1;++p<a;){for(d=l,f=-1;++f<a;){var v=h[p],E=b[v][f],S=i[v][E],y=l,A=l+=S*e;g[v+"-"+E]={index:v,subindex:E,startAngle:y,endAngle:A,value:S}}r[v]={index:v,startAngle:d,endAngle:l,value:m[v]},l+=u}for(p=-1;++p<a;)for(f=p-1;++f<a;){var C=g[p+"-"+f],_=g[f+"-"+p];(C.value||_.value)&&n.push(C.value<_.value?{source:_,target:C}:{source:C,target:_})}c&&t()}function t(){n.sort(function(e,t){return c((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n,r,i,a,o,s,c,l={},u=0;return l.matrix=function(e){return arguments.length?(a=(i=e)&&i.length,n=r=null,l):i},l.padding=function(e){return arguments.length?(u=e,n=r=null,l):u},l.sortGroups=function(e){return arguments.length?(o=e,n=r=null,l):o},l.sortSubgroups=function(e){return arguments.length?(s=e,n=null,l):s},l.sortChords=function(e){return arguments.length?(c=e,n&&t(),l):c},l.chords=function(){return n||e(),n},l.groups=function(){return r||e(),r},l},fo.layout.force=function(){function e(e){return function(t,n,r,i){if(t.point!==e){var a=t.cx-e.x,o=t.cy-e.y,s=i-n,c=a*a+o*o;if(s*s/b<c){if(c<m){var l=t.charge/c;e.px-=a*l,e.py-=o*l}return!0}if(t.point&&c&&c<m){var l=t.pointCharge/c;e.px-=a*l,e.py-=o*l}}return!t.charge}}function t(e){e.px=fo.event.x,e.py=fo.event.y,c.resume()}var n,r,i,a,o,s,c={},l=fo.dispatch("start","tick","end"),u=[1,1],d=.9,p=Ec,f=Sc,g=-30,m=yc,h=.1,b=.64,v=[],E=[];return c.tick=function(){if((i*=.99)<.005)return n=null,l.end({type:"end",alpha:i=0}),!0;var t,r,c,p,f,m,b,S,y,A=v.length,C=E.length;for(r=0;r<C;++r)c=E[r],p=c.source,f=c.target,S=f.x-p.x,y=f.y-p.y,(m=S*S+y*y)&&(m=i*o[r]*((m=Math.sqrt(m))-a[r])/m,S*=m,y*=m,f.x-=S*(b=p.weight+f.weight?p.weight/(p.weight+f.weight):.5),f.y-=y*b,p.x+=S*(b=1-b),p.y+=y*b);if((b=i*h)&&(S=u[0]/2,y=u[1]/2,r=-1,b))for(;++r<A;)c=v[r],c.x+=(S-c.x)*b,c.y+=(y-c.y)*b;if(g)for(ci(t=fo.geom.quadtree(v),i,s),r=-1;++r<A;)(c=v[r]).fixed||t.visit(e(c));for(r=-1;++r<A;)c=v[r],c.fixed?(c.x=c.px,c.y=c.py):(c.x-=(c.px-(c.px=c.x))*d,c.y-=(c.py-(c.py=c.y))*d);l.tick({type:"tick",alpha:i})},c.nodes=function(e){return arguments.length?(v=e,c):v},c.links=function(e){return arguments.length?(E=e,c):E},c.size=function(e){return arguments.length?(u=e,c):u},c.linkDistance=function(e){return arguments.length?(p="function"==typeof e?e:+e,c):p},c.distance=c.linkDistance,c.linkStrength=function(e){return arguments.length?(f="function"==typeof e?e:+e,c):f},c.friction=function(e){return arguments.length?(d=+e,c):d},c.charge=function(e){return arguments.length?(g="function"==typeof e?e:+e,c):g},c.chargeDistance=function(e){return arguments.length?(m=e*e,c):Math.sqrt(m)},c.gravity=function(e){return arguments.length?(h=+e,c):h},c.theta=function(e){return arguments.length?(b=e*e,c):Math.sqrt(b)},c.alpha=function(e){return arguments.length?(e=+e,i?e>0?i=e:(n.c=null,n.t=NaN,n=null,l.end({type:"end",alpha:i=0})):e>0&&(l.start({type:"start",alpha:i=e}),n=De(c.tick)),c):i},c.start=function(){function e(e,r){if(!n){for(n=new Array(i),c=0;c<i;++c)n[c]=[];for(c=0;c<l;++c){var a=E[c];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var o,s=n[t],c=-1,u=s.length;++c<u;)if(!isNaN(o=s[c][e]))return o;return Math.random()*r}var t,n,r,i=v.length,l=E.length,d=u[0],m=u[1];for(t=0;t<i;++t)(r=v[t]).index=t,r.weight=0;for(t=0;t<l;++t)r=E[t],"number"==typeof r.source&&(r.source=v[r.source]),"number"==typeof r.target&&(r.target=v[r.target]),++r.source.weight,++r.target.weight;for(t=0;t<i;++t)r=v[t],isNaN(r.x)&&(r.x=e("x",d)),isNaN(r.y)&&(r.y=e("y",m)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof p)for(t=0;t<l;++t)a[t]=+p.call(this,E[t],t);else for(t=0;t<l;++t)a[t]=p;if(o=[],"function"==typeof f)for(t=0;t<l;++t)o[t]=+f.call(this,E[t],t);else for(t=0;t<l;++t)o[t]=f;if(s=[],"function"==typeof g)for(t=0;t<i;++t)s[t]=+g.call(this,v[t],t);else for(t=0;t<i;++t)s[t]=g;return c.resume()},c.resume=function(){return c.alpha(.1)},c.stop=function(){return c.alpha(0)},c.drag=function(){if(r||(r=fo.behavior.drag().origin(C).on("dragstart.force",ii).on("drag.force",t).on("dragend.force",ai)),!arguments.length)return r;this.on("mouseover.force",oi).on("mouseout.force",si).call(r)},fo.rebind(c,l,"on")};var Ec=20,Sc=1,yc=1/0;fo.layout.hierarchy=function(){function e(i){var a,o=[i],s=[];for(i.depth=0;null!=(a=o.pop());)if(s.push(a),(l=n.call(e,a,a.depth))&&(c=l.length)){for(var c,l,u;--c>=0;)o.push(u=l[c]),u.parent=a,u.depth=a.depth+1;r&&(a.value=0),a.children=l}else r&&(a.value=+r.call(e,a,a.depth)||0),delete a.children;return di(i,function(e){var n,i;t&&(n=e.children)&&n.sort(t),r&&(i=e.parent)&&(i.value+=e.value)}),s}var t=gi,n=pi,r=fi;return e.sort=function(n){return arguments.length?(t=n,e):t},e.children=function(t){return arguments.length?(n=t,e):n},e.value=function(t){return arguments.length?(r=t,e):r},e.revalue=function(t){return r&&(ui(t,function(e){e.children&&(e.value=0)}),di(t,function(t){var n;t.children||(t.value=+r.call(e,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},e},fo.layout.partition=function(){function e(t,n,r,i){var a=t.children;if(t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i,a&&(o=a.length)){var o,s,c,l=-1;for(r=t.value?r/t.value:0;++l<o;)e(s=a[l],n,c=s.value*r,i),n+=c}}function t(e){var n=e.children,r=0;if(n&&(i=n.length))for(var i,a=-1;++a<i;)r=Math.max(r,t(n[a]));return 1+r}function n(n,a){var o=r.call(this,n,a);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=fo.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},li(n,r)},fo.layout.pie=function(){function e(o){var s,c=o.length,l=o.map(function(n,r){return+t.call(e,n,r)}),u=+("function"==typeof r?r.apply(this,arguments):r),d=("function"==typeof i?i.apply(this,arguments):i)-u,p=Math.min(Math.abs(d)/c,+("function"==typeof a?a.apply(this,arguments):a)),f=p*(d<0?-1:1),g=fo.sum(l),m=g?(d-c*f)/g:0,h=fo.range(c),b=[];return null!=n&&h.sort(n===Ac?function(e,t){return l[t]-l[e]}:function(e,t){return n(o[e],o[t])}),h.forEach(function(e){b[e]={data:o[e],value:s=l[e],startAngle:u,endAngle:u+=s*m+f,padAngle:p}}),b}var t=Number,n=Ac,r=0,i=Go,a=0;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e.padAngle=function(t){return arguments.length?(a=t,e):a},e};var Ac={};fo.layout.stack=function(){function e(s,c){if(!(p=s.length))return s;var l=s.map(function(n,r){return t.call(e,n,r)}),u=l.map(function(t){return t.map(function(t,n){return[a.call(e,t,n),o.call(e,t,n)]})}),d=n.call(e,u,c);l=fo.permute(l,d),u=fo.permute(u,d);var p,f,g,m,h=r.call(e,u,c),b=l[0].length;for(g=0;g<b;++g)for(i.call(e,l[0][g],m=h[g],u[0][g][1]),f=1;f<p;++f)i.call(e,l[f][g],m+=u[f-1][g][1],u[f][g][1]);return s}var t=C,n=Ei,r=Si,i=vi,a=hi,o=bi;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"==typeof t?t:Cc.get(t)||Ei,e):n},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:_c.get(t)||Si,e):r},e.x=function(t){return arguments.length?(a=t,e):a},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(i=t,e):i},e};var Cc=fo.map({"inside-out":function(e){var t,n,r=e.length,i=e.map(yi),a=e.map(Ai),o=fo.range(r).sort(function(e,t){return i[e]-i[t]}),s=0,c=0,l=[],u=[];for(t=0;t<r;++t)n=o[t],s<c?(s+=a[n],l.push(n)):(c+=a[n],u.push(n));return u.reverse().concat(l)},reverse:function(e){return fo.range(e.length).reverse()},default:Ei}),_c=fo.map({silhouette:function(e){var t,n,r,i=e.length,a=e[0].length,o=[],s=0,c=[];for(n=0;n<a;++n){for(t=0,r=0;t<i;t++)r+=e[t][n][1];r>s&&(s=r),o.push(r)}for(n=0;n<a;++n)c[n]=(s-o[n])/2;return c},wiggle:function(e){var t,n,r,i,a,o,s,c,l,u=e.length,d=e[0],p=d.length,f=[];for(f[0]=c=l=0,n=1;n<p;++n){for(t=0,i=0;t<u;++t)i+=e[t][n][1];for(t=0,a=0,s=d[n][0]-d[n-1][0];t<u;++t){for(r=0,o=(e[t][n][1]-e[t][n-1][1])/(2*s);r<t;++r)o+=(e[r][n][1]-e[r][n-1][1])/s;a+=o*e[t][n][1]}f[n]=c-=i?a/i*s:0,c<l&&(l=c)}for(n=0;n<p;++n)f[n]-=l;return f},expand:function(e){var t,n,r,i=e.length,a=e[0].length,o=1/i,s=[];for(n=0;n<a;++n){for(t=0,r=0;t<i;t++)r+=e[t][n][1];if(r)for(t=0;t<i;t++)e[t][n][1]/=r;else for(t=0;t<i;t++)e[t][n][1]=o}for(n=0;n<a;++n)s[n]=0;return s},zero:Si});fo.layout.histogram=function(){function e(e,a){for(var o,s,c=[],l=e.map(n,this),u=r.call(this,l,a),d=i.call(this,u,l,a),a=-1,p=l.length,f=d.length-1,g=t?1:1/p;++a<f;)o=c[a]=[],o.dx=d[a+1]-(o.x=d[a]),o.y=0;if(f>0)for(a=-1;++a<p;)(s=l[a])>=u[0]&&s<=u[1]&&(o=c[fo.bisect(d,s,1,f)-1],o.y+=g,o.push(e[a]));return c}var t=!0,n=Number,r=Ti,i=_i;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=Pe(t),e):r},e.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return wi(e,t)}:Pe(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},fo.layout.pack=function(){function e(e,a){var o=n.call(this,e,a),s=o[0],c=i[0],l=i[1],u=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,di(s,function(e){e.r=+u(e.value)}),di(s,Pi),r){var d=r*(t?1:Math.max(2*s.r/c,2*s.r/l))/2;di(s,function(e){e.r+=d}),di(s,Pi),di(s,function(e){e.r-=d})}return Li(s,c/2,l/2,t?1:1/Math.max(2*s.r/c,2*s.r/l)),o}var t,n=fo.layout.hierarchy().sort(Ri),r=0,i=[1,1];return e.size=function(t){return arguments.length?(i=t,e):i},e.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,e):t},e.padding=function(t){return arguments.length?(r=+t,e):r},li(e,n)},fo.layout.tree=function(){function e(e,i){var u=o.call(this,e,i),d=u[0],p=t(d);if(di(p,n),p.parent.m=-p.z,ui(p,r),l)ui(d,a);else{var f=d,g=d,m=d;ui(d,function(e){e.x<f.x&&(f=e),e.x>g.x&&(g=e),e.depth>m.depth&&(m=e)});var h=s(f,g)/2-f.x,b=c[0]/(g.x+s(g,f)/2+h),v=c[1]/(m.depth||1);ui(d,function(e){e.x=(e.x+h)*b,e.y=e.depth*v})}return u}function t(e){for(var t,n={A:null,children:[e]},r=[n];null!=(t=r.pop());)for(var i,a=t.children,o=0,s=a.length;o<s;++o)r.push((a[o]=i={_:a[o],parent:t,children:(i=a[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return n.children[0]}function n(e){var t=e.children,n=e.parent.children,r=e.i?n[e.i-1]:null;if(t.length){Ui(e);var a=(t[0].z+t[t.length-1].z)/2;r?(e.z=r.z+s(e._,r._),e.m=e.z-a):e.z=a}else r&&(e.z=r.z+s(e._,r._));e.parent.A=i(e,r,e.parent.A||n[0])}function r(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function i(e,t,n){if(t){for(var r,i=e,a=e,o=t,c=i.parent.children[0],l=i.m,u=a.m,d=o.m,p=c.m;o=Bi(o),i=ji(i),o&&i;)c=ji(c),a=Bi(a),a.a=e,r=o.z+d-i.z-l+s(o._,i._),r>0&&(Fi(Ki(o,e,n),e,r),l+=r,u+=r),d+=o.m,l+=i.m,p+=c.m,u+=a.m;o&&!Bi(a)&&(a.t=o,a.m+=d-u),i&&!ji(c)&&(c.t=i,c.m+=l-p,n=e)}return n}function a(e){e.x*=c[0],e.y=e.depth*c[1]}var o=fo.layout.hierarchy().sort(null).value(null),s=Di,c=[1,1],l=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(l=null==(c=t)?a:null,e):l?null:c},e.nodeSize=function(t){return arguments.length?(l=null==(c=t)?null:a,e):l?c:null},li(e,o)},fo.layout.cluster=function(){function e(e,a){var o,s=t.call(this,e,a),c=s[0],l=0;di(c,function(e){var t=e.children;t&&t.length?(e.x=Gi(t),e.y=Vi(t)):(e.x=o?l+=n(e,o):0,e.y=0,o=e)});var u=Yi(c),d=Wi(c),p=u.x-n(u,d)/2,f=d.x+n(d,u)/2;return di(c,i?function(e){e.x=(e.x-c.x)*r[0],e.y=(c.y-e.y)*r[1]}:function(e){e.x=(e.x-p)/(f-p)*r[0],e.y=(1-(c.y?e.y/c.y:1))*r[1]}),s}var t=fo.layout.hierarchy().sort(null).value(null),n=Di,r=[1,1],i=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(i=null==(r=t),e):i?null:r},e.nodeSize=function(t){return arguments.length?(i=null!=(r=t),e):i?r:null},li(e,t)},fo.layout.treemap=function(){function e(e,t){for(var n,r,i=-1,a=e.length;++i<a;)r=(n=e[i]).value*(t<0?0:t),n.area=isNaN(r)||r<=0?0:r}function t(n){var a=n.children;if(a&&a.length){var o,s,c,l=d(n),u=[],p=a.slice(),g=1/0,m="slice"===f?l.dx:"dice"===f?l.dy:"slice-dice"===f?1&n.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(e(p,l.dx*l.dy/n.value),u.area=0;(c=p.length)>0;)u.push(o=p[c-1]),u.area+=o.area,"squarify"!==f||(s=r(u,m))<=g?(p.pop(),g=s):(u.area-=u.pop().area,i(u,m,l,!1),m=Math.min(l.dx,l.dy),u.length=u.area=0,g=1/0);u.length&&(i(u,m,l,!0),u.length=u.area=0),a.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var a,o=d(t),s=r.slice(),c=[];for(e(s,o.dx*o.dy/t.value),c.area=0;a=s.pop();)c.push(a),c.area+=a.area,null!=a.z&&(i(c,a.z?o.dx:o.dy,o,!s.length),c.length=c.area=0);r.forEach(n)}}function r(e,t){for(var n,r=e.area,i=0,a=1/0,o=-1,s=e.length;++o<s;)(n=e[o].area)&&(n<a&&(a=n),n>i&&(i=n));return r*=r,t*=t,r?Math.max(t*i*g/r,r/(t*a*g)):1/0}function i(e,t,n,r){var i,a=-1,o=e.length,s=n.x,l=n.y,u=t?c(e.area/t):0;if(t==n.dx){for((r||u>n.dy)&&(u=n.dy);++a<o;)i=e[a],i.x=s,i.y=l,i.dy=u,s+=i.dx=Math.min(n.x+n.dx-s,u?c(i.area/u):0);i.z=!0,i.dx+=n.x+n.dx-s,n.y+=u,n.dy-=u}else{for((r||u>n.dx)&&(u=n.dx);++a<o;)i=e[a],i.x=s,i.y=l,i.dx=u,l+=i.dy=Math.min(n.y+n.dy-l,u?c(i.area/u):0);i.z=!1,i.dy+=n.y+n.dy-l,n.x+=u,n.dx-=u}}function a(r){var i=o||s(r),a=i[0];return a.x=a.y=0,a.value?(a.dx=l[0],a.dy=l[1]):a.dx=a.dy=0,o&&s.revalue(a),e([a],a.dx*a.dy/a.value),(o?n:t)(a),p&&(o=i),i}var o,s=fo.layout.hierarchy(),c=Math.round,l=[1,1],u=null,d=zi,p=!1,f="squarify",g=.5*(1+Math.sqrt(5));return a.size=function(e){return arguments.length?(l=e,a):l},a.padding=function(e){function t(t){var n=e.call(a,t,t.depth);return null==n?zi(t):$i(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return $i(t,e)}if(!arguments.length)return u;var r;return d=null==(u=e)?zi:"function"==(r=typeof e)?t:"number"===r?(e=[e,e,e,e],n):n,a},a.round=function(e){return arguments.length?(c=e?Math.round:Number,a):c!=Number},a.sticky=function(e){return arguments.length?(p=e,o=null,a):p},a.ratio=function(e){return arguments.length?(g=e,a):g},a.mode=function(e){return arguments.length?(f=e+"",a):f},li(a,s)},fo.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do{n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r}while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=fo.random.normal.apply(fo,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=fo.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t}}},fo.scale={};var wc={floor:C,ceil:C};fo.scale.linear=function(){return ea([0,1],[0,1],_r,!1)};var Tc={s:1,g:1,p:1,r:1,e:1};fo.scale.log=function(){return ca(fo.scale.linear().domain([0,1]),10,!0,[1,10])};var Rc=fo.format(".0e"),Oc={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};fo.scale.pow=function(){return la(fo.scale.linear(),1,[0,1])},fo.scale.sqrt=function(){return fo.scale.pow().exponent(.5)},fo.scale.ordinal=function(){return da([],{t:"range",a:[[]]})},fo.scale.category10=function(){return fo.scale.ordinal().range(kc)},fo.scale.category20=function(){return fo.scale.ordinal().range(Ic)},fo.scale.category20b=function(){return fo.scale.ordinal().range(Pc)},fo.scale.category20c=function(){return fo.scale.ordinal().range(Nc)};var kc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(_e),Ic=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(_e),Pc=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(_e),Nc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(_e);fo.scale.quantile=function(){return pa([],[])},fo.scale.quantize=function(){return fa(0,1,[0,1])},fo.scale.threshold=function(){return ga([.5],[0,1])},fo.scale.identity=function(){return ma([0,1])},fo.svg={},fo.svg.arc=function(){function e(){var e=Math.max(0,+n.apply(this,arguments)),l=Math.max(0,+r.apply(this,arguments)),u=o.apply(this,arguments)-Wo,d=s.apply(this,arguments)-Wo,p=Math.abs(d-u),f=u>d?0:1;if(l<e&&(g=l,l=e,e=g),p>=Yo)return t(l,f)+(e?t(e,1-f):"")+"Z";var g,m,h,b,v,E,S,y,A,C,_,w,T=0,R=0,O=[];if((b=(+c.apply(this,arguments)||0)/2)&&(h=a===Mc?Math.sqrt(e*e+l*l):+a.apply(this,arguments),f||(R*=-1),l&&(R=oe(h/l*Math.sin(b))),e&&(T=oe(h/e*Math.sin(b)))),l){v=l*Math.cos(u+R),E=l*Math.sin(u+R),S=l*Math.cos(d-R),y=l*Math.sin(d-R);var k=Math.abs(d-u-2*R)<=Vo?0:1;if(R&&Aa(v,E,S,y)===f^k){var I=(u+d)/2;v=l*Math.cos(I),E=l*Math.sin(I),S=y=null}}else v=E=0;if(e){A=e*Math.cos(d-T),C=e*Math.sin(d-T),_=e*Math.cos(u+T),w=e*Math.sin(u+T);var P=Math.abs(u-d+2*T)<=Vo?0:1;if(T&&Aa(A,C,_,w)===1-f^P){var N=(u+d)/2;A=e*Math.cos(N),C=e*Math.sin(N),_=w=null}}else A=C=0;if(p>Uo&&(g=Math.min(Math.abs(l-e)/2,+i.apply(this,arguments)))>.001){m=e<l^f?0:1;var M=g,L=g;if(p<Vo){var x=null==_?[A,C]:null==S?[v,E]:Fn([v,E],[_,w],[S,y],[A,C]),D=v-x[0],j=E-x[1],B=S-x[0],F=y-x[1],U=1/Math.sin(Math.acos((D*B+j*F)/(Math.sqrt(D*D+j*j)*Math.sqrt(B*B+F*F)))/2),K=Math.sqrt(x[0]*x[0]+x[1]*x[1]);L=Math.min(g,(e-K)/(U-1)),M=Math.min(g,(l-K)/(U+1))}if(null!=S){var V=Ca(null==_?[A,C]:[_,w],[v,E],l,M,f),G=Ca([S,y],[A,C],l,M,f);g===M?O.push("M",V[0],"A",M,",",M," 0 0,",m," ",V[1],"A",l,",",l," 0 ",1-f^Aa(V[1][0],V[1][1],G[1][0],G[1][1]),",",f," ",G[1],"A",M,",",M," 0 0,",m," ",G[0]):O.push("M",V[0],"A",M,",",M," 0 1,",m," ",G[0])}else O.push("M",v,",",E);if(null!=_){var Y=Ca([v,E],[_,w],e,-L,f),W=Ca([A,C],null==S?[v,E]:[S,y],e,-L,f);g===L?O.push("L",W[0],"A",L,",",L," 0 0,",m," ",W[1],"A",e,",",e," 0 ",f^Aa(W[1][0],W[1][1],Y[1][0],Y[1][1]),",",1-f," ",Y[1],"A",L,",",L," 0 0,",m," ",Y[0]):O.push("L",W[0],"A",L,",",L," 0 0,",m," ",Y[0])}else O.push("L",A,",",C)}else O.push("M",v,",",E),null!=S&&O.push("A",l,",",l," 0 ",k,",",f," ",S,",",y),O.push("L",A,",",C),null!=_&&O.push("A",e,",",e," 0 ",P,",",1-f," ",_,",",w);return O.push("Z"),O.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var n=ba,r=va,i=ha,a=Mc,o=Ea,s=Sa,c=ya;return e.innerRadius=function(t){return arguments.length?(n=Pe(t),e):n},e.outerRadius=function(t){return arguments.length?(r=Pe(t),e):r},e.cornerRadius=function(t){return arguments.length?(i=Pe(t),e):i},e.padRadius=function(t){return arguments.length?(a=t==Mc?Mc:Pe(t),e):a},e.startAngle=function(t){return arguments.length?(o=Pe(t),e):o},e.endAngle=function(t){return arguments.length?(s=Pe(t),e):s},e.padAngle=function(t){return arguments.length?(c=Pe(t),e):c},e.centroid=function(){var e=(+n.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +s.apply(this,arguments))/2-Wo;return[Math.cos(t)*e,Math.sin(t)*e]},e};var Mc="auto";fo.svg.line=function(){return _a(C)};var Lc=fo.map({linear:wa,"linear-closed":Ta,step:Ra,"step-before":Oa,"step-after":ka,basis:xa,"basis-open":Da,"basis-closed":ja,bundle:Ba,cardinal:Na,"cardinal-open":Ia,"cardinal-closed":Pa,monotone:Ya});Lc.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var xc=[0,2/3,1/3,0],Dc=[0,1/3,2/3,0],jc=[0,1/6,2/3,1/6];fo.svg.line.radial=function(){var e=_a(Wa);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Oa.reverse=ka,ka.reverse=Oa,fo.svg.area=function(){return za(C)},fo.svg.area.radial=function(){var e=za(Wa);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},fo.svg.chord=function(){function e(e,s){var c=t(this,a,e,s),l=t(this,o,e,s);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(n(c,l)?i(c.r,c.p1,c.r,c.p0):i(c.r,c.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+i(l.r,l.p1,c.r,c.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),a=s.call(e,i,r),o=c.call(e,i,r)-Wo,u=l.call(e,i,r)-Wo;return{r:a,a0:o,a1:u,p0:[a*Math.cos(o),a*Math.sin(o)],p1:[a*Math.cos(u),a*Math.sin(u)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Vo)+",1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var a=_n,o=wn,s=$a,c=Ea,l=Sa;return e.radius=function(t){return arguments.length?(s=Pe(t),e):s},e.source=function(t){return arguments.length?(a=Pe(t),e):a},e.target=function(t){return arguments.length?(o=Pe(t),e):o},e.startAngle=function(t){return arguments.length?(c=Pe(t),e):c},e.endAngle=function(t){return arguments.length?(l=Pe(t),e):l},e},fo.svg.diagonal=function(){function e(e,i){var a=t.call(this,e,i),o=n.call(this,e,i),s=(a.y+o.y)/2,c=[a,{x:a.x,y:s},{x:o.x,y:s},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=_n,n=wn,r=Ha;return e.source=function(n){return arguments.length?(t=Pe(n),e):t},e.target=function(t){return arguments.length?(n=Pe(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},fo.svg.diagonal.radial=function(){var e=fo.svg.diagonal(),t=Ha,n=e.projection;return e.projection=function(e){return arguments.length?n(qa(t=e)):t},e},fo.svg.symbol=function(){function e(e,r){return(Bc.get(t.call(this,e,r))||Za)(n.call(this,e,r))}var t=Xa,n=Ja;return e.type=function(n){return arguments.length?(t=Pe(n),e):t},e.size=function(t){return arguments.length?(n=Pe(t),e):n},e};var Bc=fo.map({circle:Za,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Uc)),n=t*Uc;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Fc),n=t*Fc/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Fc),n=t*Fc/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});fo.svg.symbolTypes=Bc.keys();var Fc=Math.sqrt(3),Uc=Math.tan(30*zo);No.transition=function(e){for(var t,n,r=Kc||++Wc,i=ro(e),a=[],o=Vc||{time:Date.now(),ease:Pr,delay:0,duration:250},s=-1,c=this.length;++s<c;){a.push(t=[]);for(var l=this[s],u=-1,d=l.length;++u<d;)(n=l[u])&&io(n,u,i,r,o),t.push(n)}return eo(a,i,r)},No.interrupt=function(e){return this.each(null==e?Gc:Qa(ro(e)))};var Kc,Vc,Gc=Qa(ro()),Yc=[],Wc=0;Yc.call=No.call,Yc.empty=No.empty,Yc.node=No.node,Yc.size=No.size,fo.transition=function(e,t){return e&&e.transition?Kc?e.transition(t):e:fo.selection().transition(e)},fo.transition.prototype=Yc,Yc.select=function(e){var t,n,r,i=this.id,a=this.namespace,o=[];e=M(e);for(var s=-1,c=this.length;++s<c;){o.push(t=[]);for(var l=this[s],u=-1,d=l.length;++u<d;)(r=l[u])&&(n=e.call(r,r.__data__,u,s))?("__data__"in r&&(n.__data__=r.__data__),io(n,u,a,i,r[a][i]),t.push(n)):t.push(null)}return eo(o,a,i)},Yc.selectAll=function(e){var t,n,r,i,a,o=this.id,s=this.namespace,c=[];e=L(e);for(var l=-1,u=this.length;++l<u;)for(var d=this[l],p=-1,f=d.length;++p<f;)if(r=d[p]){a=r[s][o],n=e.call(r,r.__data__,p,l),c.push(t=[]);for(var g=-1,m=n.length;++g<m;)(i=n[g])&&io(i,g,s,o,a),t.push(i)}return eo(c,s,o)},Yc.filter=function(e){var t,n,r,i=[];"function"!=typeof e&&(e=z(e));for(var a=0,o=this.length;a<o;a++){i.push(t=[]);for(var n=this[a],s=0,c=n.length;s<c;s++)(r=n[s])&&e.call(r,r.__data__,s,a)&&t.push(r)}return eo(i,this.namespace,this.id)},Yc.tween=function(e,t){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(e):H(this,null==t?function(t){t[r][n].tween.remove(e)}:function(i){i[r][n].tween.set(e,t)})},Yc.attr=function(e,t){function n(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}function i(e){return null==e?n:(e+="",function(){var t,n=this.getAttribute(s);return n!==e&&(t=o(n,e),function(e){this.setAttribute(s,t(e))})})}function a(e){return null==e?r:(e+="",function(){var t,n=this.getAttributeNS(s.space,s.local);return n!==e&&(t=o(n,e),function(e){this.setAttributeNS(s.space,s.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var o="transform"==e?Zr:_r,s=fo.ns.qualify(e);return to(this,"attr."+e,t,s.local?a:i)},Yc.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=fo.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Yc.style=function(e,t,n){function r(){this.style.removeProperty(e)}function i(t){return null==t?r:(t+="",function(){var r,i=o(this).getComputedStyle(this,null).getPropertyValue(e);return i!==t&&(r=_r(i,t),function(t){this.style.setProperty(e,r(t),n)})})}var a=arguments.length;if(a<3){if("string"!=typeof e){a<2&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}return to(this,"style."+e,t,i)},Yc.styleTween=function(e,t,n){function r(r,i){var a=t.call(this,r,i,o(this).getComputedStyle(this,null).getPropertyValue(e));return a&&function(t){this.style.setProperty(e,a(t),n)}}return arguments.length<3&&(n=""),this.tween("style."+e,r)},Yc.text=function(e){return to(this,"text",e,no)},Yc.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Yc.ease=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].ease:("function"!=typeof e&&(e=fo.ease.apply(fo,arguments)),H(this,function(r){r[n][t].ease=e}))},Yc.delay=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].delay:H(this,"function"==typeof e?function(r,i,a){r[n][t].delay=+e.call(r,r.__data__,i,a)}:(e=+e,function(r){r[n][t].delay=e}))},Yc.duration=function(e){var t=this.id,n=this.namespace;return arguments.length<1?this.node()[n][t].duration:H(this,"function"==typeof e?function(r,i,a){r[n][t].duration=Math.max(1,e.call(r,r.__data__,i,a))}:(e=Math.max(1,e),function(r){r[n][t].duration=e}))},Yc.each=function(e,t){var n=this.id,r=this.namespace;if(arguments.length<2){var i=Vc,a=Kc;try{Kc=n,H(this,function(t,i,a){Vc=t[r][n],e.call(t,t.__data__,i,a)})}finally{Vc=i,Kc=a}}else H(this,function(i){var a=i[r][n];(a.event||(a.event=fo.dispatch("start","end","interrupt"))).on(e,t)});return this},Yc.transition=function(){for(var e,t,n,r,i=this.id,a=++Wc,o=this.namespace,s=[],c=0,l=this.length;c<l;c++){s.push(e=[]);for(var t=this[c],u=0,d=t.length;u<d;u++)(n=t[u])&&(r=n[o][i],io(n,u,o,a,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),e.push(n)}return eo(s,o,a)},fo.svg.axis=function(){function e(e){e.each(function(){var e,l=fo.select(this),u=this.__chart__||n,d=this.__chart__=n.copy(),p=null==c?d.ticks?d.ticks.apply(d,s):d.domain():c,f=null==t?d.tickFormat?d.tickFormat.apply(d,s):C:t,g=l.selectAll(".tick").data(p,d),m=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Uo),h=fo.transition(g.exit()).style("opacity",Uo).remove(),b=fo.transition(g.order()).style("opacity",1),v=Math.max(i,0)+o,E=qi(d),S=l.selectAll(".domain").data([0]),y=(S.enter().append("path").attr("class","domain"),fo.transition(S));m.append("line"),m.append("text");var A,_,w,T,R=m.select("line"),O=b.select("line"),k=g.select("text").text(f),I=m.select("text"),P=b.select("text"),N="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(e=ao,A="x",w="y",_="x2",T="y2",k.attr("dy",N<0?"0em":".71em").style("text-anchor","middle"),y.attr("d","M"+E[0]+","+N*a+"V0H"+E[1]+"V"+N*a)):(e=oo,A="y",w="x",_="y2",T="x2",k.attr("dy",".32em").style("text-anchor",N<0?"end":"start"),y.attr("d","M"+N*a+","+E[0]+"H0V"+E[1]+"H"+N*a)),R.attr(T,N*i),I.attr(w,N*v),O.attr(_,0).attr(T,N*i),P.attr(A,0).attr(w,N*v),d.rangeBand){var M=d,L=M.rangeBand()/2;u=d=function(e){return M(e)+L}}else u.rangeBand?u=d:h.call(e,d,u);m.call(e,u,d),b.call(e,d,d)})}var t,n=fo.scale.linear(),r=zc,i=6,a=6,o=3,s=[10],c=null;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(r=t in $c?t+"":zc,e):r},e.ticks=function(){return arguments.length?(s=mo(arguments),e):s},e.tickValues=function(t){return arguments.length?(c=t,e):c},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t){var n=arguments.length;return n?(i=+t,a=+arguments[n-1],e):i},e.innerTickSize=function(t){return arguments.length?(i=+t,e):i},e.outerTickSize=function(t){return arguments.length?(a=+t,e):a},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(){return arguments.length&&e},e};var zc="bottom",$c={top:1,right:1,bottom:1,left:1};fo.svg.brush=function(){function e(a){a.each(function(){var a=fo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),o=a.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),a.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=a.selectAll(".resize").data(m,C);s.exit().remove(),s.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Hc[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",e.empty()?"none":null);var c,d=fo.transition(a),p=fo.transition(o);l&&(c=qi(l),p.attr("x",c[0]).attr("width",c[1]-c[0]),n(d)),u&&(c=qi(u),p.attr("y",c[0]).attr("height",c[1]-c[0]),r(d)),t(d)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+d[+/e$/.test(e)]+","+p[+/^s/.test(e)]+")"})}function n(e){e.select(".extent").attr("x",d[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",d[1]-d[0])}function r(e){e.select(".extent").attr("y",p[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function i(){function i(){32==fo.event.keyCode&&(O||(E=null,P[0]-=d[1],P[1]-=p[1],O=2),k())}function m(){32==fo.event.keyCode&&2==O&&(P[0]+=d[1],P[1]+=p[1],O=0,k())}function h(){var e=fo.mouse(y),i=!1;S&&(e[0]+=S[0],e[1]+=S[1]),O||(fo.event.altKey?(E||(E=[(d[0]+d[1])/2,(p[0]+p[1])/2]),P[0]=d[+(e[0]<E[0])],P[1]=p[+(e[1]<E[1])]):E=null),T&&b(e,l,0)&&(n(_),i=!0),R&&b(e,u,1)&&(r(_),i=!0),i&&(t(_),C({type:"brush",mode:O?"move":"resize"}))}function b(e,t,n){var r,i,o=qi(t),c=o[0],l=o[1],u=P[n],m=n?p:d,h=m[1]-m[0];if(O&&(c-=u,l-=h+u),r=(n?g:f)?Math.max(c,Math.min(l,e[n])):e[n],O?i=(r+=u)+h:(E&&(u=Math.max(c,Math.min(l,2*E[n]-r))),u<r?(i=r,r=u):i=u),m[0]!=r||m[1]!=i)return n?s=null:a=null,m[0]=r,m[1]=i,!0}function v(){h(),_.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),fo.select("body").style("cursor",null),N.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),I(),C({type:"brushend"})}var E,S,y=this,A=fo.select(fo.event.target),C=c.of(y,arguments),_=fo.select(y),w=A.datum(),T=!/^(n|s)$/.test(w)&&l,R=!/^(e|w)$/.test(w)&&u,O=A.classed("extent"),I=ee(y),P=fo.mouse(y),N=fo.select(o(y)).on("keydown.brush",i).on("keyup.brush",m);if(fo.event.changedTouches?N.on("touchmove.brush",h).on("touchend.brush",v):N.on("mousemove.brush",h).on("mouseup.brush",v),_.interrupt().selectAll("*").interrupt(),O)P[0]=d[0]-P[0],P[1]=p[0]-P[1];else if(w){var M=+/w$/.test(w),L=+/^n/.test(w);S=[d[1-M]-P[0],p[1-L]-P[1]],P[0]=d[M],P[1]=p[L]}else fo.event.altKey&&(E=P.slice());_.style("pointer-events","none").selectAll(".resize").style("display",null),fo.select("body").style("cursor",A.style("cursor")),C({type:"brushstart"}),h()}var a,s,c=P(e,"brushstart","brush","brushend"),l=null,u=null,d=[0,0],p=[0,0],f=!0,g=!0,m=qc[0];return e.event=function(e){e.each(function(){var e=c.of(this,arguments),t={x:d,y:p,i:a,j:s},n=this.__chart__||t;this.__chart__=t,Kc?fo.select(this).transition().each("start.brush",function(){a=n.i,s=n.j,d=n.x,p=n.y,e({type:"brushstart"})}).tween("brush:brush",function(){var n=wr(d,t.x),r=wr(p,t.y);return a=s=null,function(i){d=t.x=n(i),p=t.y=r(i),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=t.i,s=t.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(l=t,m=qc[!l<<1|!u],e):l},e.y=function(t){return arguments.length?(u=t,m=qc[!l<<1|!u],e):u},e.clamp=function(t){return arguments.length?(l&&u?(f=!!t[0],g=!!t[1]):l?f=!!t:u&&(g=!!t),e):l&&u?[f,g]:l?f:u?g:null},e.extent=function(t){var n,r,i,o,c;return arguments.length?(l&&(n=t[0],r=t[1],u&&(n=n[0],r=r[0]),a=[n,r],l.invert&&(n=l(n),r=l(r)),r<n&&(c=n,n=r,r=c),n==d[0]&&r==d[1]||(d=[n,r])),u&&(i=t[0],o=t[1],l&&(i=i[1],o=o[1]),s=[i,o],u.invert&&(i=u(i),o=u(o)),o<i&&(c=i,i=o,o=c),i==p[0]&&o==p[1]||(p=[i,o])),e):(l&&(a?(n=a[0],r=a[1]):(n=d[0],r=d[1],l.invert&&(n=l.invert(n),r=l.invert(r)),r<n&&(c=n,n=r,r=c))),u&&(s?(i=s[0],o=s[1]):(i=p[0],o=p[1],u.invert&&(i=u.invert(i),o=u.invert(o)),o<i&&(c=i,i=o,o=c))),l&&u?[[n,i],[r,o]]:l?[n,r]:u&&[i,o])},e.clear=function(){return e.empty()||(d=[0,0],p=[0,0],a=s=null),e},e.empty=function(){return!!l&&d[0]==d[1]||!!u&&p[0]==p[1]},fo.rebind(e,c,"on")};var Hc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Jc=ms.format=ys.timeFormat,Xc=Jc.utc,Zc=Xc("%Y-%m-%dT%H:%M:%S.%LZ");Jc.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?so:Zc,so.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},so.toString=Zc.toString,ms.second=We(function(e){return new hs(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),ms.seconds=ms.second.range,ms.seconds.utc=ms.second.utc.range,ms.minute=We(function(e){return new hs(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),ms.minutes=ms.minute.range,ms.minutes.utc=ms.minute.utc.range,ms.hour=We(function(e){var t=e.getTimezoneOffset()/60;return new hs(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),ms.hours=ms.hour.range,ms.hours.utc=ms.hour.utc.range,ms.month=We(function(e){return e=ms.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),ms.months=ms.month.range,ms.months.utc=ms.month.utc.range;var Qc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],el=[[ms.second,1],[ms.second,5],[ms.second,15],[ms.second,30],[ms.minute,1],[ms.minute,5],[ms.minute,15],[ms.minute,30],[ms.hour,1],[ms.hour,3],[ms.hour,6],[ms.hour,12],[ms.day,1],[ms.day,2],[ms.week,1],[ms.month,1],[ms.month,3],[ms.year,1]],tl=Jc.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Lt]]),nl={range:function(e,t,n){return fo.range(Math.ceil(e/n)*n,+t,n).map(lo)},floor:C,ceil:C};el.year=ms.year,ms.scale=function(){return co(fo.scale.linear(),el,tl)};var rl=el.map(function(e){return[e[0].utc,e[1]]}),il=Xc.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Lt]]);rl.year=ms.year.utc,ms.scale.utc=function(){return co(fo.scale.linear(),rl,il)},fo.text=Ne(function(e){return e.responseText}),fo.json=function(e,t){return Me(e,"application/json",uo,t)},fo.html=function(e,t){return Me(e,"text/html",po,t)},fo.xml=Ne(function(e){return e.responseXML}),this.d3=fo,r=fo,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}()},function(e,t,n){(function(e,t,n,r){function i(t,n,r){return function(i,a){return document.createElement("div"),i.append("<div ng-transclude></div>"),"function"==typeof t&&t(i,a),{pre:function(e,t,r,i,a){"function"==typeof n&&n(e,t,r,i,a)},post:function(t,n,i,a,o){e.forEach(n.find("[ng-transclude]").children("[transclude-name]"),function(r){r=e.element(r),n.find("[transclude="+r.attr("transclude-name")+"]").append(r),n.find("[transclude="+r.attr("transclude-name")+"]").attr("transclude",t.$id+r.attr("transclude-name"))}),"function"==typeof r&&r(t,n,i,a,o)}}}}function a(t,n,r){if(e.isDefined(t))if(0<=n.indexOf(".")){n=n.split(".");var i=n.shift();n=n.join("."),e.isDefined(t[i])||(t[i]={}),a(t[i],n,r)}else e.isDefined(t[n])||(t[n]=r)}function o(t,n){return e.isDefined(t)?t:n}function s(e,t){arguments[4](e.$parent,function(e){t.find(".transclude-element").append(e)})}e.module("awsCommonComponents.awsBarGroup",[]).directive("awsBarGroup",[function(){return{restrict:"AE",transclude:!0,template:'<div class="awsBarGroup gray-background" ng-transclude></div>'}}]);var c=e.module("awsCommonComponents.awsRoleSelector",[]);if(window.oneClickResponseFunctions={},0<=window.location.search.indexOf("response=")){var l=function(e){return JSON.parse(decodeURIComponent(e.replace(/^\?/,"").split("&").filter(function(e){return 0===e.indexOf("response=")})[0]).replace(/^response=/,""))}(window.location.search);e.isDefined(l)&&(e.forEach(l,function(e,t){window.opener&&window.opener.oneClickResponseFunctions&&window.opener.oneClickResponseFunctions[t]&&window.opener.oneClickResponseFunctions[t](e)}),window.close())}iam_console_prelogin_success=function(){window.ANALYTICS_GLOBAL_VARS.IAM_CONSOLE_PRELOGIN_SUCCESS=!0},iam_console_prelogin_failure=function(){window.ANALYTICS_GLOBAL_VARS.IAM_CONSOLE_PRELOGIN_SUCCESS||(window.ANALYTICS_GLOBAL_VARS.IAM_CONSOLE_PRELOGIN_SUCCESS=!1)},c.controller("awsRoleSelectorCtrl",["$scope","$timeout","$window","$log",function(t,n,r,i){t.iam_console_working=!0,i=document.createElement("script"),i.type="text/javascript",i.src=ANALYTICS_GLOBAL_VARS.ONE_CLICK_BASE_URI.replace("iam/home","iam/iam_console_prelogin?&state=hashArgs%23"),n(iam_console_prelogin_failure,1e4),document.body.appendChild(i),t.ANALYTICS_GLOBAL_VARS=ANALYTICS_GLOBAL_VARS,t.$watch("ANALYTICS_GLOBAL_VARS.IAM_CONSOLE_PRELOGIN_SUCCESS",function(e){n(function(){t.iam_console_working=e},0)}),a(t,"isDisabled",function(){return!1}),a(t,"latestRoleResponses",{}),a(t,"ownedRoleNames",[]),e.forEach(t.roleRequests,function(e,n){t.ownedRoleNames.push(n)}),i=1<Object.keys(t.roleRequests).length?"Select/Create Roles":"Select/Create Role",t.roleButtonText=t.buttonText||i,t.callOneClickRole=function(){var i={context:t.context,returnURI:"https://"+r.location.host+t.returnPath,requests:{}};t.errorMessages=[],e.forEach(t.roleRequests,function(e,t){i.requests[t]=e.role}),e.forEach(Object.keys(i.requests),function(e){r.oneClickResponseFunctions[e]=function(r){n(function(){2===r.split("/").length?(t.$emit("iamRoleArnSelected",r),t.latestRoleResponses[e+"Arn"]=r):t.errorMessages="decline"===r&&0==t.errorMessages.length?["You must select or create a role to continue."]:["There was an error that occurred during the role creation. Role Name: "+e+", Error Code: "+r]},0)}}),r.open(ANALYTICS_GLOBAL_VARS.ONE_CLICK_BASE_URI+"#one_click_role?request="+encodeURIComponent(JSON.stringify(i)))},t.$on(t.validationBroadcastKey,function(){t.validate()||t.$emit(t.validationBroadcastKey+"InvalidField",!1)}),t.validate=function(){return t.errorMessages=[],e.forEach(t.ownedRoleNames,function(n){(e.isUndefined(t.latestRoleResponses[n+"Arn"])||0==t.latestRoleResponses[n+"Arn"].length)&&t.errorMessages.push(t.roleRequests[n].title+" has not been Created or Selected")}),0==t.errorMessages.length},t.$watch("latestRoleResponses",function(n){t.roleDisplayResponses={},e.forEach(t.ownedRoleNames,function(n){var r=t.latestRoleResponses[n+"Arn"];e.isString(r)&&0<r.length?(t.roleDisplayResponses[n]={role:r.split("/")[1],title:t.roleRequests[n].title+"*"},e.isDefined(t.roleRequests[n].description)&&(t.roleDisplayResponses[n].description=t.roleRequests[n].description)):t.roleDisplayResponses[n]={role:"<role not created or selected>",title:t.roleRequests[n].title+"*"}})},!0),t.$on("$destroy",function(){e.forEach(t.ownedRoleNames,function(e){delete r.oneClickResponseFunctions[e]})})}]),c.directive("awsRoleSelector",[function(){return{restrict:"AE",template:'<aws-inline-validation\n        show-error="errorMessages.length > 0">\n    <div class="aws-role-selector">\n        <div>\n            <div class="inline">\n                <div class="role-table"\n                     ng-repeat="roleDisplay in roleDisplayResponses">\n                    <div class="title-div role-field">{{roleDisplay.title}}</div>\n                    <div class="content-div role-field">{{roleDisplay.role}}\n                        <i class="icon-info-sign"\n                           ng-if="roleDisplay.description"\n                           data-popover=""\n                           data-placement="right"\n                           data-content="{{roleDisplay.description}}"\n                           data-html="true"></i>\n                    </div>\n                </div>\n            </div>\n            <div ng-disabled="isDisabled"\n                 ng-click="isDisabled || callOneClickRole()"\n                 class="{{buttonClass || \'btn role-button\'}}"\n                 ng-bind="roleButtonText">\n            </div>\n        </div>\n        <div ng-if="errorMessage"\n             class="content-error-div validation-error-message"\n             ng-repeat="errorMessage in errorMessages">\n            <i class="icon-warning-sign validation-icon"></i>\n            {{errorMessage}}\n        </div>\n    </div>\n</aws-inline-validation>',controller:"awsRoleSelectorCtrl",scope:{buttonClass:"@",buttonText:"@",roleRequests:"=?",context:"=",isDisabled:"=?",latestRoleResponses:"=?",returnPath:"=",validationBroadcastKey:"=?"}}}]);var u=e.module("awsCommonComponents.awsButton",[]);u.controller("awsButtonCtrl",["$scope",function(e){a(e,"disabled",!1),a(e,"loading",!1),a(e,"primaryButton",!1),a(e,"textButton",!1),a(e,"refreshButton",!1),a(e,"deleteButton",!1)}]),u.directive("awsButton",[function(){return{restrict:"AE",template:'<div class="aws-button btn-wrapper"\n     ng-click="clicked()">\n    <div class="btn"\n            ng-class="{\'btn-primary\': primaryButton, \'btn-text\': textButton, \'btn-refresh\': refreshButton, \'btn-delete\': deleteButton, \'disabled\': disabled}">\n        <span class="btn-loading" ng-if="loading || refreshButton">\n            <i class="fa fa-refresh"\n               ng-class="{\'fa-spin\': loading}"></i>\n        </span>\n        <span ng-if="!refreshButton" ng-bind-html="buttonText"></span>\n    </div>\n</div>',require:"?ngClick",scope:{disabled:"=?",loading:"=?",buttonText:"=",primaryButton:"=?",textButton:"=?",refreshButton:"=?",deleteButton:"=?"},controller:"awsButtonCtrl",link:function(e,n,r){t._data(n[0]).events&&(r=t._data(n[0]).events.click,r.reverse(),n.on("click",function(t){(e.disabled||e.loading)&&t.stopImmediatePropagation()}),r.reverse())}}}]);var d=e.module("awsCommonComponents.awsMultiSelect",[]);d.controller("awsMultiSelectCtrl",["$scope","$timeout","$element",function(r,i,o){a(r,"selectedItems",[]),a(r,"items",[]),a(r,"actionItems",[]),a(r,"allowDynamic",!1),a(r,"focused",!1),a(r,"placeholder",""),a(r,"inputText",""),a(r,"delimiters",[",",";","\r","\t","     "]),e.forEach(r.selectedItems,function(e){r.items.splice(r.items.indexOf(e,1))}),r.unSelectItem=function(e){r.selectedItems.splice(r.selectedItems.indexOf(e),1),r.items.push(e)},r.clearSelected=function(){r.items=n.unique(r.items.concat(r.selectedItems)),r.selectedItems=[]},r.addItem=function(e){return void 0!==e&&!r.itemInItems(e,r.selectedItems)&&r.itemInItems(e,r.items)&&(r.selectedItems.push(e),r.items.splice(r.items.indexOf(e),1),r.inputText="",r.activeItemId=void 0),!1},r.createDynamicItem=function(e){if(e=e.trim(),r.allowDynamic&&0<e.length)return e={name:e,id:e},r.itemInItems(e,r.items)||r.itemInItems(e,r.selectedItems)||r.items.push(e),e},r.itemInItems=function(t,n){return 0<n.filter(function(n){return e.isDefined(t.id)&&e.isDefined(n.id)?n.id===t.id:n.name===t.name}).length},o.find("[contenteditable]").keypress(function(e){if(13===e.which)return r.addItem(r.createDynamicItem(r.inputText)),!1}),o.find("[contenteditable]").focusout(function(){return r.addItem(r.createDynamicItem(r.inputText)),!1}),window.addPasteListener(o.find("[contenteditable]"),function(t){return console.log("Pasted Data: "+t),t=t.replace(/\n/g,"\r"),e.forEach(r.delimiters.map(function(e){return{delimiter:e,count:t.split(e).length,list:t.split(e).filter(function(e){return 0!==e.length})}}).sort(function(e,t){return t.count-e.count})[0].list,function(e){r.addItem(r.createDynamicItem(e))}),!1}),r.setFocused=function(e){i.cancel(r.closePromise),e?r.focused=e:r.closePromise=i(function(){r.focused=!1},100)},r.focusTextBox=function(){o.find(".aws-multi-select-input").focus()},r.$evalAsync(function(){t(o).find(".awsDropdown, .dropdown-menu").css("width","100%")})}]),d.directive("awsMultiSelect",[function(){return{restrict:"AE",template:'<div class="aws-multi-select">\n    <div class="aws-multi-select-label">{{label}}</div>\n    <div class="aws-multi-select-clear badge badge-important ng-hide" ng-click="clearSelected()" ng-show="selectedItems.length > 0">Clear All</div>\n    <div class="aws-multi-select-input-wrapper"\n         onclick="$(this).find(\'[contenteditable]\').focus()">\n        <div class="btn aws-multi-select-button no-text-select"\n             ng-repeat="item in selectedItems">\n            <div class="aws-multi-select-input" ng-bind="item.name"></div>\n             <i  class="fa fa-times-circle aws-multi-select-button-x"\n                 ng-click="unSelectItem(item);"></i>\n        </div>\n        <div class="aws-multi-select-input aws-multi-select-button"\n             contenteditable="true"\n             ng-model="inputText"\n             ng-blur="setFocused(false);"\n             ng-focus="setFocused(true);">\n        </div>\n        <div class="aws-multi-select-placeholder ng-hide"\n             ng-show="inputText ==\'\' && !focused">\n            {{placeholder}}\n        </div>\n    </div>\n    \n         \n         \n         \n         \n         \n         \n         \n         \n         \n         \n</div>',controller:"awsMultiSelectCtrl",scope:{items:"=",selectedItems:"=?",focused:"=?",allowDynamic:"=?",label:"=?"}}}]),d.directive("contenteditable",["$sce",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,r,i){i&&(i.$render=function(){n.html(e.getTrustedHtml(i.$viewValue||""))},n.on("blur keyup change",function(){t.$apply(function(){i.$setViewValue(n.text())})}))}}}]);var p=e.module("awsCommonComponents.awsTextInput",["ngSanitize"]);p.controller("awsTextInputCtrl",["$scope",function(t){function n(){return t.inputValidation.rules.filter(function(e){return!e.valid})}function r(e){t.validation.errorMessages=e.map(function(e){return e.message})}t.textInputStyle={},a(t,"validation",{errorMessages:[]}),t.validationErrorMessages=[],e.isDefined(t.rightIcon)&&(t.textInputStyle["border-top-right-radius"]=0,t.textInputStyle["border-bottom-right-radius"]=0),e.isDefined(t.leftIcon)&&(t.textInputStyle["border-top-left-radius"]=0,t.textInputStyle["border-bottom-left-radius"]=0),a(t,"inputValue",""),a(t.inputConfig,"maxLength",255),a(t.inputConfig,"disabled",!1),a(t,"inputValidation.valid",!0),a(t,"inputValidation.rules",[]),a(t,"inputType","text"),a(t,"inputValidation.errorMessages",[]),a(t,"disableBlur",!1),t.activeType=t.inputType,"password"===t.inputType&&(t.inputConfig.tooltip="Show/Hide Password"),!0===t.inputConfig.required&&0===t.inputValidation.rules.filter(function(e){return JSON.stringify(e.expression)===JSON.stringify(/\S+/)}).length&&t.inputValidation.rules.push({expression:/\S+/,message:"This field is required"}),0===t.inputValidation.rules.filter(function(e){return JSON.stringify(e.expression)===JSON.stringify(new RegExp("^.{0,"+t.inputConfig.maxLength+"}$"))}).length&&t.inputValidation.rules.push({expression:new RegExp("^.{0,"+t.inputConfig.maxLength+"}$"),message:"Value must be less than "+t.inputConfig.maxLength+" characters"}),t.formatInputLabel=function(){return!0===t.inputConfig.required?t.inputConfig.label+"*":t.inputConfig.label},t.hasLabel=function(){return e.isDefined(t.inputConfig.label)},t.showTooltip=function(){return e.isDefined(t.inputConfig.tooltip)},t.clickTooltip=function(){"password"===t.inputType&&"password"===t.activeType?(t.activeType="text",t.inputConfig.tooltip="Hide Password"):"password"===t.inputType&&"text"===t.activeType&&(t.activeType="password",t.inputConfig.tooltip="Show Password")},t.inputValidation.validate=function(i,a){return t.validation.errorMessages=[],e.isDefined(i)?e.isDefined(i)?t.inputValue=i:a&&(t.inputValue=i):i=t.inputValue,"string"!=typeof i&&(i=""+i),t.inputValidation.valid=!0,e.forEach(t.inputValidation.rules,function(e){e.valid=!0,"string"==typeof e.expression&&(e.expression=new RegExp(e.expression)),i.match(e.expression)||(t.inputValidation.valid=!1,e.valid=!1)}),r(n()),t.inputValidation.valid},e.forEach(t.inputValidation.rules,function(e){e.valid=!0})}]),p.directive("awsTextInput",[function(){return{restrict:"AE",template:'\n<aws-inline-validation\n        label="formatInputLabel()"\n        required="required"\n        validation="validation">\n    <div class="aws-text-input {{inputValidation.state}}">\n        <label>\n            <div ng-form name="form" class="aws-text-input-wrapper">\n                <div class="btn left-decoration"\n                     ng-if="leftIcon"\n                     ng-class="{disabled: leftIconCallback == null}"\n                     ng-click="leftIconCallback()"><i ng-class="leftIcon"></i></div>\n                <input type="text"\n                       name="textInput"\n                       class="aws-text-input"\n                       placeholder="{{inputConfig.placeholder}}"\n                       ng-show="activeType === \'text\'"\n                       ng-blur="!disableBlur && inputValidation.validate(inputValue)"\n                       ng-disabled="inputConfig.disabled"\n                       ng-style="textInputStyle"\n                       ng-model="inputValue"/>\n                <input type="password"\n                       name="passwordInput"\n                       class="aws-text-input ng-hide"\n                       placeholder="{{inputConfig.placeholder}}"\n                       ng-show="activeType === \'password\'"\n                       ng-blur="!disableBlur && inputValidation.validate(inputValue)"\n                       ng-disabled="inputConfig.disabled"\n                       ng-model="inputValue"/>\n                <div class="btn right-decoration"\n                     ng-if="rightIcon"\n                     ng-class="{disabled: rightIconCallback == null}"\n                     ng-click="rightIconCallback()"><i ng-class="rightIcon"></i></div>\n                <aws-tooltip\n                     ng-if="showTooltip()"\n                     ng-click="clickTooltip()"\n                     text="inputConfig.tooltip"\n                     placement="\'right\'">\n                        <i class="fa" ng-class="{\'fa-info-circle\': inputType === \'text\', \'fa-eye\': inputType === \'password\'}"></i>\n                </aws-tooltip>\n            </div>\n        </label>\n    </div>\n</aws-inline-validation>',scope:{inputValue:"=",inputConfig:"=",inputValidation:"=?",inputType:"=?",leftIcon:"=?",leftIconCallback:"=?",rightIcon:"=?",rightIconCallback:"=?",validation:"=?",disableBlur:"=?"},controller:"awsTextInputCtrl"}}]);var f=e.module("awsCommonComponents.awsDateCalendarPicker",[]);f.controller("awsDateCalendarPickerCtrl",["$scope","$element","$timeout",function(e,n,r){a(e,"datePickerId","dateRangePicker"+Math.floor(1e3*Math.random())),a(e,"dateFormat","YYYY/MM/DD"),a(e,"dateValue",moment.utc().format(e.dateFormat)),e.datePickerOptions={singleDatePicker:!0,openOnClick:!1,opens:"left",format:e.dateFormat,startDate:e.dateValue,minDate:"2014/01/01"},e.updateDatePicker=function(t,n,r){t._isValid||(t=moment.utc()),e.dateValue=t.format(e.dateFormat),e.inputValidation.validate(e.dateValue,!0),e.$apply()},e.openCalendar=function(){e.dateRangePicker.show()},e.$watch("dateValue",function(t,n){"Invalid date"===t&&("Invalid date"===n?moment.utc().format(e.dateFormat):e.dateValue=n)}),e.inputValidation={rules:[{expression:/^((?:19|20)\d\d)[\/](0[1-9]|1[012])[\/](0[1-9]|[12][0-9]|3[01])$/,message:"Must be date in format YYYY/MM/DD"}]},r(function(){e.dateRangePicker=t(n.find("input")[0]).daterangepicker(e.datePickerOptions,e.updateDatePicker).data("daterangepicker")},0),e.$on("$destroy",function(){e.dateRangePickerElement.data().daterangepicker.container.remove()})}]),f.directive("awsDateCalendarPicker",[function(){return{restrict:"AE",template:'<div class="awsDateRangePicker"\n     id="{{datePickerId}}">\n    <aws-text-input\n        input-config="inputConfig"\n        input-value="dateValue"\n        input-validation="inputValidation"\n        right-icon="\'icon-calendar\'"\n        right-icon-callback="openCalendar"></aws-text-input>\n</div>',scope:{dateValue:"=",inputConfig:"=",inputValidation:"=?"},controller:"awsDateCalendarPickerCtrl"}}]);var g=e.module("awsCommonComponents.awsDateRangePicker",[]);g.controller("awsDateRangePickerCtrl",["$scope","$element","$filter",function(t,n,r){e.isDefined(t.defaultDateRange)||(t.defaultDateRange=29),e.isDefined(t.endDate)||(t.endDate=moment.utc()),e.isDefined(t.startDate)||(t.startDate=moment(t.endDate).subtract("days",t.defaultDateRange)),e.isDefined(t.minDate)||(t.minDate=moment("12/01/2012","MM/DD/YYYY")),e.isDefined(t.maxDate)||(t.maxDate=moment.utc().endOf("day")),e.isDefined(t.uiDateFormat)||(t.uiDateFormat="MM/DD/YY"),e.isDefined(t.onChange)||(t.onChange=function(e,t){}),r={dateLimit:{days:364},showDropdowns:!1,showWeekNumbers:!1,timePicker:!1,timePickerIncrement:1,timePicker12Hour:!0,ranges:{"Last 7 Days":[moment.utc().subtract("days",6).startOf("day"),moment.utc().startOf("day")],"Last 30 Days":[moment.utc().subtract("days",29).startOf("day"),moment.utc().startOf("day")],"Last Week":[moment.utc().subtract("week",1).startOf("week"),moment.utc().subtract("weeks",1).endOf("week")],"Last Month":[moment.utc().subtract("month",1).startOf("month"),moment.utc().subtract("month",1).endOf("month")]},opens:"right",buttonClasses:["btn btn-mini"],applyClass:"apply-btn",cancelClass:"clear-btn",format:"MM/DD/YY",separator:" to ",locale:{applyLabel:r("i18n")("_datepicker_apply_"),cancelLabel:r("i18n")("_datepicker_cancel_"),fromLabel:r("i18n")("_datepicker_from_"),toLabel:r("i18n")("_datepicker_to_"),customRangeLabel:r("i18n")("_datepicker_custom_"),daysOfWeek:[r("i18n")("_sunday_abbrev_"),r("i18n")("_monday_abbrev_"),r("i18n")("_tuesday_abbrev_"),r("i18n")("_wednesday_abbrev_"),r("i18n")("_thursday_abbrev_"),r("i18n")("_friday_abbrev_"),r("i18n")("_saturday_abbrev_")],monthNames:[r("i18n")("_january_"),r("i18n")("_february_"),r("i18n")("_march_"),r("i18n")("_april_"),r("i18n")("_may_"),r("i18n")("_june_"),r("i18n")("_july_"),r("i18n")("_august_"),r("i18n")("_september_"),r("i18n")("_october_"),r("i18n")("_november_"),r("i18n")("_december_")],firstDay:0}},moment.utc().startOf("month").format("MM/DD/YYYY")!==moment.utc().startOf("day").format("MM/DD/YYYY")&&(r.ranges["Month-to-date"]=[moment.utc().startOf("month"),moment.utc().startOf("day")]),r.startDate=t.startDate,r.endDate=t.endDate,r.minDate=t.minDate,r.maxDate=t.maxDate,t.updateDateRangePicker=function(e,n){t.startDate=e,t.endDate=n,t.onChange({startDate:e,endDate:n}),t.$apply()},t.dateRangePickerElement=n.daterangepicker(r,t.updateDateRangePicker),t.$on("$destroy",function(){t.dateRangePickerElement.data().daterangepicker.container.remove()})}]),g.filter("uiDateFilter",[function(){return function(e,t){return e.format(t.uiDateFormat)}}]),g.directive("awsDateRangePicker",[function(){return{restrict:"AE",template:'<div class="awsDateRangePicker">\n    <div id="daterangepicker" class="btn dropdown-toggle dropdown-btn">\n        <span>{{startDate | uiDateFilter:this}} - {{endDate | uiDateFilter:this}}</span> <div class="dropdown-btn-caret"></div>\n    </div>\n</div>',scope:{defaultDateRange:"=?",startDate:"=?",endDate:"=?",minDate:"=?",maxDate:"=?",uiDateFormat:"=?",onChange:"&"},controller:"awsDateRangePickerCtrl"}}]);var m=e.module("awsCommonComponents.awsTooltip",[]);m.controller("awsTooltipCtrl",["$scope","$element",function(e,t){a(e,"width",250),a(e,"text",""),a(e,"enabledFunction",function(){return 0<e.text.length}),a(e,"enabled",0<e.text.length),a(e,"placement","right")}]),m.directive("awsTooltip",[function(){return{restrict:"AE",template:'<div class="aws-tooltip" ng-if="enabled">\n    <div fix-transclude></div>\n    <div class="aws-tooltip-container {{placement}}">\n        <div class="aws-tooltip-arrow"></div>\n        <div class="aws-tooltip-text" ng-bind-html="text"></div>\n    </div> \n</div>\n<div class="aws-tooltip" ng-if="!enabled" fix-transclude></div>',scope:{text:"=",enabled:"=?",placement:"=?"},controller:"awsTooltipCtrl",transclude:!0,link:function(e,n){t(n).hover(function(){var r=t(n).find(".aws-tooltip-container");if(r.show(),230>e.width){t(n).find(".aws-tooltip-container").width(e.width+20);var i=t(n).find(".aws-tooltip-container.top");i&&t(i).css("margin-left",-1*(r.width()/2+4)),(i=t(n).find(".aws-tooltip-container.bottom"))&&t(i).css("margin-left",-1*(r.width()/2+4))}"right"!==e.placement&&"left"!==e.placement||r.css("top",r.height()/2*-1)},function(){t(n).find(".aws-tooltip-container").hide()}),e.$watch("text",function(){var r=t(n).find(".aws-tooltip-container"),i=t("<div class='aws-inline-block aws-not-visible'></div>").html(e.text);r.append(i),e.width=t(n).find(".aws-not-visible").width(),t(i).remove()})}}}]),m.directive("fixTransclude",[function(){return{compile:function(e,t,n){return function(e,t,r){n(e.$parent.$parent,function(e){t.append(e)})}}}}]);var h=e.module("awsCommonComponents.awsInlineValidation",[]);h.controller("awsInlineValidationCtrl",["$scope",function(e){e.clearValidation=function(){e.validation.errorMessages=[],e.showError=!1}}]),h.directive("awsInlineValidation",[function(){return{restrict:"AE",template:'<div class="aws-inline-validation"\n     ng-class="{\'warning\': validation.errorMessages.length > 0 || showError, \'normal\': validation.errorMessages == 0 || !showError}">\n    <div ng-if="label"\n         class="inline aws-inline-validation-label">\n        {{label}}\n    </div>\n    <div class="inline">\n        <div class="transclude-element" ng-class="{\'inline-validation-content-block\': validation.errorMessages.length > 0}"></div>\n        <div ng-if="validation.errorMessages"\n             class="validation-error-message"\n             ng-repeat="validationErrorMessage in validation.errorMessages">\n            <i class="fa fa-exclamation-triangle validation-icon"></i>\n            <span ng-bind-html="validationErrorMessage"></span>\n        </div>\n    </div>\n</div>',scope:{label:"=?",showError:"=?",validation:"="},controller:"awsInlineValidationCtrl",transclude:!0,link:s}}]);var b=e.module("awsCommonComponents.awsRadioButtonInput",[]);b.controller("awsRadioButtonInputCtrl",["$scope",function(t){t.showTooltip=function(){return e.isDefined(t.inputConfig.tooltip)}}]),b.directive("awsRadioButtonInput",[function(){return{restrict:"AE",template:'<div class="aws-radiobutton">\n    <span class="field-name">{{inputConfig.fieldName}}</span><i ng-if="showTooltip()" class="icon-info-sign aws-text-input-tooltip" data-popover="" data-placement="right" data-content={{inputConfig.tooltip}} data-html="true"></i>\n    <aws-radio-button ng-repeat="item in inputValues"></aws-radio-button>\n</div>',scope:{inputValues:"=",activeValue:"=",inputConfig:"="},controller:"awsRadioButtonInputCtrl"}}]);var v=e.module("awsCommonComponents.awsSingleSelect",[]);v.controller("awsSingleSelectCtrl",["$scope",function(t){function n(n){var r=!1;e.forEach(t.items,function(i){e.isArray(i.id)?e.forEach(i.id,function(e){e.id===n&&(t.activeName=e.name,t.activeItemId=e.id,r=!0)}):i.id===n&&(t.activeName=i.name,t.activeItemId=i.id,r=!0)}),r||(0<t.items.length?(t.activeName=t.items[0].name,t.activeItemId=t.items[0].id):t.activeName=t.emptyText)}e.isDefined(t.scrollLimit)||(t.scrollLimit=10),e.isDefined(t.emptyText)||(t.emptyText="None Available"),t.searchString="",t.focusInput=!1,t.singleSelectOpened=function(){t.focusInput=!0,t.searchString=""},t.subMenuOpened=function(){t.focusInput=!0},t.$watch("activeItem",function(){n(t.activeItemId)}),t.itemClick=function(e){t.itemIsNestedMenu(e)||(t.activeItemId=e)},t.itemIsNestedMenu=function(t){return e.isArray(t)},t.itemHasSubItems=function(t){return e.isArray(t)&&0<t.length}}]),v.directive("awsSingleSelect",[function(){return{restrict:"AE",template:'<div class="dropdown inline-block aws-single-select">\n    <input class="dropdown-toggle" data-toggle="dropdown" ng-click="singleSelectOpened()" value="{{activeName}}" type="text" readonly/><i data-toggle="dropdown" ng-click="singleSelectOpened()" class="icon-single-select-caret"></i>\n    <ul class="dropdown-menu" ng-class="{scrolling: items.length > scrollLimit}">\n        <div class="aws-single-select-search-box-body ng-hide" ng-show="items.length > scrollLimit">\n            <input type="text" class="aws-single-select-search-box-text" focus-me="focusInput" ng-model="searchString" />\n        </div>\n\n        <li ng-repeat="item in items | searchSingleSelect:searchString" ng-click="itemClick(item.id)" ng-class="{\'dropdown-submenu\': itemIsNestedMenu(item.id)}">\n            <a ng-if="!itemIsNestedMenu(item.id)" tabindex="-1">{{item.name}}</a>\n\n            <a ng-if="itemIsNestedMenu(item.id) && itemHasSubItems(item.id)" ng-mouseenter="subMenuOpened()" tabindex="0">{{item.name}}</a>\n            <ul ng-if="itemIsNestedMenu(item.id) && itemHasSubItems(item.id)" class="dropdown-menu" ng-class="{scrolling: items.length > scrollLimit}">\n                <div class="aws-single-select-search-box-body" >\n                    <input type="text" class="aws-single-select-search-box-text" focus-me="focusInput" ng-model="searchString" />\n                </div>\n                <li ng-repeat="subItem in item.id | searchSingleSelect:searchString" ng-click="itemClick(subItem.id)">\n                    <a tabindex="-1">{{subItem.name}}</a>\n                </li>\n            </ul>\n        </li>\n    </ul>\n</div>',controller:"awsSingleSelectCtrl",scope:{items:"=",activeItemId:"=",scrollLimit:"=?",emptyText:"=?"}}}]),v.filter("searchSingleSelect",[function(){return function(t,n){if(!n)return t;var r=[];return void 0!==n&&(n=n.toLowerCase(),e.forEach(t,function(t){(-1!==t.name.toLowerCase().indexOf(n)||e.isArray(t.id)&&0<t.id.length)&&r.push(t)})),r}}]);var E=e.module("awsCommonComponents.awsRadioButton",[]);E.controller("awsRadioButtonCtrl",["$scope",function(t){e.isDefined(t.name)||(t.name=Math.random()),a(t,"enabled",!0),e.isDefined(t.callback)&&"function"==typeof t.callback&&t.$watch("model.value",function(){e.isDefined(t.callback)&&"function"==typeof t.callback&&t.callback(t.value)})}]),E.directive("awsRadioButton",[function(){return{restrict:"AE",template:'<div class="aws-radio-button">\n    <label ng-click="model = value">\n        <input type="radio"\n               class="aws-radio-button-input"\n               ng-name="name"\n               ng-model="model"\n               ng-value="value"\n               ng-disabled="!enabled">\n        <div class="button-wrapper"><div class="button-inner">&nbsp;</div></div>\n        <div class="item-label" ng-transclude></div>\n    </label>\n</div>',scope:{value:"=?",model:"=",name:"=?",tooltip:"=?",callback:"=?",enabled:"=?"},transclude:!0,controller:"awsRadioButtonCtrl"}}]);var S=e.module("awsCommonComponents.awsSection",["ngSanitize"]);S.controller("awsSectionCtrl",["$scope","$element","$attrs",function(t,n,r){e.isDefined(t.isOpen)||(t.isOpen=e.isDefined(r.$attr.isopen)),e.isDefined(t.isDisabled)||(t.isDisabled=e.isDefined(r.$attr.isdisabled)),e.isDefined(t.iconOpenClass)||(t.iconOpenClass="icon-caret-right"),e.isDefined(t.iconCloseClass)||(t.iconCloseClass="icon-caret-down"),t.iconClass=t.isOpen?t.iconCloseClass:t.iconOpenClass,t.section=n.find("section")[0],t.toggleOpen=function(e){t.isDisabled&&!e||(t.isOpen=!t.isOpen,t.iconClass=t.isOpen?t.iconCloseClass:t.iconOpenClass)},t.isOpen||(t.isOpen=!0,t.$evalAsync(t.toggleOpen,!0))}]),S.directive("awsSection",[function(){return{restrict:"AE",template:'<div class="aws-section">\n    <header ng-click="toggleOpen();"\n            ng-class="isDisabled ? \'header\' : \'header pointer\'">\n        <h3 class="section-header-item {{iconClass}} expander-button"></h3>\n        <h3 transclude="header" class="section-header-item"></h3>\n    </header>\n    <div>\n        <section transclude="content" class="slider section-content" ng-class="{\'closed\': !isOpen}"></section>\n    </div>\n</div>',scope:{header:"=",iconOpenClass:"=?",iconCloseClass:"=?",isOpen:"=?",isDisabled:"=?"},controller:"awsSectionCtrl",transclude:!0,compile:i()}}]);var y=e.module("awsCommonComponents.awsCountdownTimer",[]);y.controller("awsCountdownTimerCtrl",["$scope","$interval","$rootScope",function(t,n,r){e.isDefined(t.refreshRates)||(t.refreshRates=[{displayName:"No Refresh",value:0},{displayName:"5 Minutes",value:3e5},{displayName:"10 Minutes",value:6e5},{displayName:"15 Minutes",value:9e5},{displayName:"30 Minutes",value:18e5}]),e.isDefined(t.elapsedTime)||(t.activeRefreshRate=0),e.isDefined(t.refreshEventName)||(t.refreshEventName="awsCountdownTimerRefresh"),e.isDefined(t.singleClick)||(t.singleClick=!1),e.isDefined(t.timerFinished)||(t.timerFinished=function(){}),t.elapsedTime=0;var i;t.itemClick=function(e){t.activeRefreshRate=e,t.restartRefresh()},t.startRefresh=function(){e.isDefined(i)||0===t.activeRefreshRate||(i=n(function(){t.elapsedTime>t.activeRefreshRate?(t.broadcastRefresh(),t.restartRefresh(),t.timerFinished()):t.elapsedTime+=1e3},1e3))},t.stopRefresh=function(){n.cancel(i),i=void 0,t.elapsedTime=0},t.restartRefresh=function(){t.stopRefresh(),t.startRefresh()},t.broadcastRefresh=function(){r.$broadcast(t.refreshEventName)},t.$on("$destroy",function(){t.stopRefresh()}),!0!==t.singleClick&&t.restartRefresh()}]),y.directive("awsCountdownTimer",[function(){return{restrict:"AE",template:'<div ng-if="singleClick">\n    <a ng-click="broadcastRefresh()"><i class="icon-refresh icon-2x"></i></a>\n</div>\n<div ng-if="!singleClick" class="dropdown inline-block aws-console-dropdown">\n    <div class="btn dropdown-toggle dropdown-btn" data-toggle="dropdown" ng-click="dropdownOpened()">{{refreshRates | displayNameForRefresh:activeRefreshRate}} <div class="dropdown-btn-caret"></div></div>\n    <ul class="dropdown-menu">\n        <li ng-repeat="refreshRate in refreshRates" ng-click="itemClick(refreshRate.value)">\n            <a tabindex="-1">{{refreshRate.displayName}}</a>\n        </li>\n    </ul>\n</div>\n<div ng-if="!singleClick" class="aws-countdown-timer-progress progress small">\n    <div class="bar" style="width: {{elapsedTime | progressPercent:activeRefreshRate}}%;"></div>\n</div>',scope:{refreshRates:"=?",activeRefreshRate:"=?",refreshEventName:"=?",singleClick:"=?",timerFinished:"&?"},controller:"awsCountdownTimerCtrl"}}]),y.filter("displayNameForRefresh",[function(){return function(t,n){var r="NoRefresh";return n?(e.forEach(t,function(e){e.value===n&&(r=e.displayName)}),r):r}}]),y.filter("progressPercent",[function(){return function(e,t){return e>t?100:0===t?0:e/t*100}}]);var A=e.module("awsCommonComponents.awsAlert",[]);A.controller("awsAlertCtrl",["$scope",function(e){a(e,"type","success"),a(e,"showIcon",!1),a(e,"closable",!0),a(e,"dismissed",!1),e.close=function(){e.dismissed=!0}}]),A.directive("awsAlert",[function(){return{restrict:"AE",template:'<div class="aws-alert" ng-class="type" ng-hide="dismissed">\n    <i class="close fa fa-times" ng-show="closable" class="ng-hide" ng-click="close()"></i>\n    <table>\n        <tr>\n            <td>\n                <i ng-show="showIcon" class="icon fa" ng-class="{\'fa-check-circle\' : type === \'success\', \'fa-exclamation-triangle\' : type === \'warning\', \'fa-exclamation-circle\' : type === \'error\', \'fa-info-circle\' : type === \'notice\'}"></i>\n            </td>\n            <td>\n                <div transclude="header" class="header"></div>\n                <div transclude="content" class="content"></div>\n            </td>\n        </tr>\n    </table>\n</div>',scope:{type:"=",showIcon:"=?",closable:"=?",dismissed:"=?"},controller:"awsAlertCtrl",transclude:!0,compile:i()}}]),e.module("awsCommonComponents","awsCommonComponents.awsAlert awsCommonComponents.awsBarGroup awsCommonComponents.awsTabBar awsCommonComponents.awsDropdown awsCommonComponents.awsSingleSelect awsCommonComponents.awsDateRangePicker awsCommonComponents.awsCountdownTimer awsCommonComponents.awsWizard awsCommonComponents.awsTextInput awsCommonComponents.awsCheckboxInput awsCommonComponents.awsRadioButtonInput awsCommonComponents.awsSection awsCommonComponents.awsMultiSelect awsCommonComponents.awsSideBar awsCommonComponents.awsCheckbox awsCommonComponents.awsRadioButton awsCommonComponents.awsDateCalendarPicker awsCommonComponents.awsTable awsCommonComponents.awsModal awsCommonComponents.awsPrivateBeta awsCommonComponents.awsTooltip awsCommonComponents.awsCard awsCommonComponents.awsCodeBlock awsCommonComponents.awsProgressBar awsCommonComponents.awsRoleSelector awsCommonComponents.awsButton awsCommonComponents.awsInlineValidation".split(" ")),RegExp.prototype.toJSON=function(){return this.toString().substr(1,this.toString().length-2)},String.prototype.replaceAll=function(e,t,n){return this.replace(new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),n?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},e.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(t){return{compile:function(n,r){e.isFunction(r)&&(r={post:r});var i,a=n.contents().remove();return{pre:r&&r.pre?r.pre:null,post:function(e,n){i||(i=t(a)),i(e,function(e){n.append(e)}),r&&r.post&&r.post.apply(null,arguments)}}}}}]);var C=e.module("awsCommonComponents.awsProgressBar",[]);C.controller("awsProgressBarCtrl",["$scope",function(t){a(t,"progress",0),a(t,"displayFormat",1),a(t,"stepDescription","Steps Completed"),e.isDefined(t.totalSteps)&&t.$watch("currentStep",function(e){t.progress=e/t.totalSteps})}]),C.directive("awsProgressBar",[function(){return{restrict:"AE",template:'<div ng-switch="displayFormat" class="aws-progress-bar">\n    <div class="format-container" ng-switch-when="1">\n        <div class="empty-bar">\n            <span class="progress-bar" ng-style="{\'width\': (100 * progress) + \'%\'}"></span>\n        </div>\n        <div class="text-area" ng-if="timeLeft || lastAction || currentStep">\n            <div ng-if="timeLeft" class="est-time">Est. time remaining <span ng-bind="timeLeft"></span></div>\n            <div ng-if="currentStep && totalSteps" class="step-progress">\n                <span ng-bind="currentStep"></span> of <span ng-bind="totalSteps"></span> <span ng-bind="stepDescription"></span>\n            </div>\n            <div ng-if="lastAction" class="current-action"><span ng-bind="lastAction"></span>...</div>\n        </div>\n    </div>\n    <div class="format-container" ng-switch-when="2">\n        <div class="empty-bar">\n            <span class="progress-bar" ng-style="{\'width\': (100 * progress) + \'%\'}"></span>\n        </div>\n        <div class="text-area">\n            <div ng-if="filesTransferred" class="est-time">Total files transferred <span ng-bind="filesTransferred"></span></div>\n            <div class="step-progress">\n                <span>{{100 * progress | number}}</span><span ng-bind="stepDescription"> % complete</span>\n            </div>\n            <div ng-if="lastAction" class="current-action"><span ng-bind="lastAction"></span>...</div>\n        </div>\n    </div>\n</div>',scope:{progress:"=?",timeLeft:"=?",currentStep:"=?",totalSteps:"=?",lastAction:"=?",stepDescription:"=?",filesTransferred:"=?",displayFormat:"=?"},controller:"awsProgressBarCtrl",transclude:!0}}]);var _=e.module("awsCommonComponents.awsPrivateBeta",[]);_.controller("awsPrivateBetaCtrl",["$element","$rootScope",function(t,n){e.isDefined(n.inPrivateBeta)&&n.inPrivateBeta||t[0].parentElement.removeChild(t[0])}]),_.directive("awsPrivateBeta",[function(){return{restrict:"A",controller:"awsPrivateBetaCtrl"}}]);var w=e.module("awsCommonComponents.awsCodeBlock",[]);r&&r.highlightBlock&&(r.oldGet=r.getLanguage,r.highlightBlock(document.createElement("a"))),w.controller("awsCodeBlockCtrl",["$scope","$transclude","$compile","$element","$timeout",function(t,n,i,a,o){t.customTitles=["RegionEndpoint","IAmazonMobileAnalyticsClientContextConfig","Amazon","MobileAnalyticsManager","CognitoAWSCredentials"],t.customKeywords=["USEast1"],r.getLanguage=function(n){var i=r.oldGet(n);return e.isArray(t.customTitles)&&e.forEach(t.customTitles,function(e){i.k[e]=["title",1]}),e.isArray(t.customKeywords)&&e.forEach(t.customKeywords,function(e){i.k[e]=["keyword",1]}),i},r.getLanguage("cs"),r.highlightBlock(n()[0]),o(function(){i(a.find("pre")[0])(t.$parent)},0)}]),w.directive("awsCodeBlock",[function(){return{restrict:"AE",transclude:!0,link:s,template:'<pre class="transclude-element"></pre>',controller:"awsCodeBlockCtrl",scope:{customTitles:"=?",customKeywords:"=?"}}}]);var T=e.module("awsCommonComponents.awsTabBar",[]);T.controller("awsTabBarCtrl",["$scope",function(e){a(e,"icons",[]),a(e,"iconClass",""),a(e,"iconCallback",function(){}),a(e,"horizontal",!1),e.tabClick=function(t){if("function"==typeof e.callback){var n=e.callback(e.tabs.filter(function(e){return e.id===t})[0]);if("string"==typeof n)return void(e.activeTab=n)}e.activeTab=t}}]),T.directive("awsTabBar",[function(){return{restrict:"AE",template:'<ul class="nav nav-tabs aws-tab-bar"\n    ng-class="{\'nav-stacked\': horizontal, \'horizontal-tabs\': horizontal}"\n    data-tabset="true">\n    <li ng-repeat="tab in tabs"\n        ng-class="{active: activeTab === tab.id}"\n        ng-click="tabClick(tab.id);">\n        <a ng-bind-html="tab.name"></a>\n    </li>\n    <li class="help-icon">\n        <div>\n            <div class="top-right-content" transclude="top-right-content"></div>\n            <a ng-repeat="icon in icons" ng-click="iconCallback(icon)">\n                <i class="{{icon}} {{iconClass}}" ></i>\n            </a>\n        </div>\n    </li>\n</ul>\n<div class="aws-tab-bar-content panel panel-default panel-body"\n     ng-class="{\'horizontal-content\': horizontal}"\n     transclude="content">\n</div>',scope:{tabs:"=",callback:"=?",activeTab:"=",icons:"=?",iconCallback:"=?",iconClass:"=?",horizontal:"@?"},controller:"awsTabBarCtrl",transclude:!0,compile:i()}}]),e.module("awsCommonComponents.awsCard",[]).directive("awsCard",[function(){return{restrict:"AE",template:'<div transclude="header" class="aws-card-header gray-background"></div>\n<div transclude="content" class="aws-card-body"></div>',transclude:!0,compile:i()}}]);var R=e.module("awsCommonComponents.awsSideBar",[]);R.controller("awsSideBarCtrl",["$scope","$element",function(t,n){e.isDefined(t.isDisabled)||(t.isDisabled=!1),e.isDefined(t.isOpen)||(t.isOpen=!0),e.isDefined(t.iconCloseClass)||(t.iconCloseClass="icon-caret-left type-size-big aws-side-bar-arrow aws-side-bar-arrow-close"),e.isDefined(t.iconOpenClass)||(t.iconOpenClass="icon-caret-right type-size-big aws-side-bar-arrow aws-side-bar-arrow-open"),t.sidebar=n.find(".aws-side-bar-wrapper")[0],t.content=n.find(".content")[0],t.toggleOpen=function(r){t.isDisabled&&!r||(t.isOpen=!t.isOpen,e.isDefined(t.sidebarWidth)||0===parseInt(window.getComputedStyle(t.sidebar).width)||(t.sidebarWidth=window.getComputedStyle(t.sidebar).width),t.maxWidth=n.parent().css("width"),t.content.style.width=parseInt(t.maxWidth)-(t.isOpen?parseInt(t.sidebarWidth):0)-36+"px",t.sidebar.style.left=t.isOpen?0:"-"+t.sidebarWidth)},t.isOpen=!t.isOpen,t.$evalAsync(t.toggleOpen,!0)}]),R.directive("awsSideBar",[function(){return{restrict:"AE",template:'<div class="aws-side-bar">\n    <i ng-class="isOpen ? iconCloseClass : iconOpenClass" ng-click="toggleOpen();"></i>\n    <div transclude="sidebar" class="aws-side-bar-wrapper"></div>\n    <div transclude="content" class="content"></div>\n</div>',scope:{isOpen:"=?",isDisabled:"=?",iconOpenClass:"=?",iconCloseClass:"=?"},controller:"awsSideBarCtrl",transclude:!0,compile:i()}}]);var O=e.module("awsCommonComponents.awsTable",[]);O.controller("awsTableCtrl",["$scope","$sce",function(t,n){a(t,"isLoading",!1),t.headIsChecked=!1,t.toggleSortOrder=function(e){t.config.head[e].sortable&&(e!==t.config.sortIndex?(t.config.sortAsc=!0,t.config.sortIndex=e):t.config.sortAsc=!t.config.sortAsc)},t.orderIndex=function(e){return e.cells[t.config.sortIndex].value},t.cellClick=function(e,n){t.onCellClick({row:e,col:n})},t.buildCell=function(t,r){return e.isDefined(t.wrapper)?t.wrapper.replace("$1",n.trustAsHtml(t.value)):t.value},t.clickCheckbox=function(){t.config.singleSelect&&e.forEach(t.config.body,function(e){e.isChecked=!1})},t.clickAllCheckboxes=function(){t.config.singleSelect||e.forEach(t.config.body,function(e){e.isChecked=t.config.headIsChecked})}}]),O.directive("awsTable",[function(){return{restrict:"AE",template:'<div class="aws-table">\n    <table class="table table-bordered">\n        <thead class="navbar">\n            <tr class="navbar-inner">\n                <td ng-if="config.hasCheckboxColumn" class="checkbox-column ">\n                    <label class="aws-checkbox-input-wrapper ng-hide" ng-show="!$scope.config.singleSelect">\n                        <input type="checkbox" class="aws-checkbox-input-element" id="select-all-chk" ng-model="config.headIsChecked" ng-click="clickAllCheckboxes()">\n                        <span class="aws-checkbox-indicator"></span>\n                    </label>\n                </td>\n                <th ng-repeat="cell in config.head" ng-click="toggleSortOrder($index)" class="headerSortUp">\n                    <div ng-class="{sortable: cell.sortable}">\n                        <span ng-bind-html="cell.title"></span>\n                        <i ng-if="cell.sortable && $index === config.sortIndex" class="fa" ng-class="{\'fa-sort-asc\': config.sortAsc, \'fa-sort-desc\': !config.sortAsc}"></i>\n                        <i ng-if="cell.sortable && $index !== config.sortIndex" class="fa fa-sort-desc disabled"></i>\n                    </div>\n                </th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-if="isLoading"><td style="text-align: center" colspan="{{config.head.length + (config.hasCheckboxColumn ? 1 : 0)}}">\n                <i class="icon-spinner icon-spin icon-jumbotron"></i>\n            </td></tr>\n            <tr ng-if="!isLoading" ng-repeat="row in config.body | orderBy:orderIndex:config.sortAsc">\n                <td ng-if="config.hasCheckboxColumn" class="checkbox-column">\n                    <label class="aws-checkbox-input-wrapper">\n                        <input type="checkbox" class="aws-checkbox-input-element" ng-model="row.isChecked" ng-click="clickCheckbox()">\n                        <span class="aws-checkbox-indicator"></span>\n                    </label>\n                </td>\n                <td ng-repeat="cell in row.cells track by $index">\n                    <aws-tooltip text="cell.tooltip" placement="$index === row.cells.length - 1 ? \'left\' : \'right\'" class="cell-tooltip">\n                        <div class="cell-content" ng-bind-html="buildCell(cell)" ng-click="cellClick(row ,$index)"></div>\n                    </aws-tooltip>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>',scope:{config:"=",onCellClick:"&?",isLoading:"=?"},controller:"awsTableCtrl"}}]),O.filter("checkedItems",[function(){return function(t){if(!e.isArray(t))return t;var n=[];return e.forEach(t,function(e){e.isChecked&&n.push(e)}),n}}]);var k=e.module("awsCommonComponents.awsCheckboxInput",[]);k.controller("awsCheckboxInputCtrl",["$scope",function(t){t.showTooltip=function(){return e.isDefined(t.inputConfig.tooltip)}}]),k.directive("awsCheckboxInput",[function(){return{restrict:"AE",template:'<div class="aws-checkbox-input">\n    <span class="aws-checkbox-input-field-name">{{inputConfig.fieldName}}</span><i ng-if="showTooltip()" class="icon-info-sign aws-text-input-tooltip" data-popover="" data-placement="right" data-content={{inputConfig.tooltip}} data-html="true"></i>\n    <aws-checkbox\n        ng-repeat="item in inputValues"\n        value="item.value"\n        label="item.label"></aws-checkbox>\n</div>',scope:{inputValues:"=",inputConfig:"="},controller:"awsCheckboxInputCtrl"}}]);var I=e.module("awsCommonComponents.awsModal",[]);I.controller("awsModalCtrl",["$scope",function(e){a(e,"closeCallback",function(){}),e.closeModal=function(){e.isOpen=!1,e.closeCallback()}}]),I.directive("awsModal",[function(){return{restrict:"AE",template:'<div class="aws-modal">\n    <div ng-show="isOpen" class="modal-frame fade in ng-hide">\n        <div class="modal-header">\n            <div class="modal-title" transclude="header"></div>\n            <i class="fa fa-close modal-close" ng-click="closeModal()"></i>\n        </div>\n        <div class="modal-body" transclude="content"></div>\n        <div class="modal-footer" transclude="footer"></div>\n    </div>\n    <div ng-show="isOpen" class="modal-background ng-hide"></div>\n</div>',scope:{isOpen:"=",closeCallback:"=?"},transclude:!0,compile:i(),controller:"awsModalCtrl"}}]);var P=e.module("awsCommonComponents.awsDropdown.awsDropdownMenu",["RecursionHelper"]);P.controller("awsDropdownMenuCtrl",["$scope","$timeout",function(t,n){function r(){t.showDivider=e.isArray(t.actionItems)&&0<t.actionItems.length&&0<t.items.length}a(t,"childOpen",!1),t.showDivider=!1,t.$watch("items",r),t.$watch("actionItems",r),t.itemClicked=function(e){t.itemIsNestedMenu(e)||(t.onClickItemCallback(e),t.isOpen=!1)},t.itemHovered=function(e){t.itemIsNestedMenu(e)||t.onHoverItemCallback(e)},t.actionItemClicked=function(e){e.onClick(e),t.isOpen=!1},e.forEach(t.actionItems,function(e){a(e,"enabled",function(){return!0})}),t.subMenuClosed=function(e){t.tryCloseSubMenuTimeout=n(function(){e.isOpen=!1},t.autoCloseDelay)},t.subMenuOpened=function(r){n.cancel(t.tryCloseSubMenuTimeout),e.forEach(t.items,function(e){e.isOpen=!1}),r.isOpen=!0},t.$watch("isOpen",function(){t.resetSearchString&&(t.searchString="")}),t.subMenuClickedContainer=function(e){e.stopPropagation()},t.itemIsNestedMenu=function(t){return e.isArray(t.items)},t.itemHasNestedItems=function(e){return t.itemIsNestedMenu(e)&&0<e.items.length}}]),P.directive("awsDropdownMenu",["RecursionHelper",function(e){return{restrict:"AE",template:'<ul class="aws-dropdown-menu dropdown-menu dropdown-list"\n    display="block"\n    ng-class="{open: isOpen, scrolling: ((items| searchDropdown:searchString).length) + actionItems.length > scrollLimit}">\n    <li ng-repeat="actionItem in actionItems">\n        <a ng-if="actionItem.enabled()" ng-click="actionItemClicked(actionItem)" title="{{actionItem.title}}">{{actionItem.name}}</a>\n        <a ng-if="!actionItem.enabled()" class="disabled" title="{{actionItem.title}}">{{actionItem.name}}</a>\n    </li>\n    <li ng-if="showDivider" class="divider"></li>\n    <div class="aws-dropdown-search-box-body ng-hide"\n         ng-show="items.length > searchBarThreshold"\n         ng-class="{\'no-action-items\': !actionItems}">\n        <i class="fa fa-filter"></i>\n        <input type="text"\n               class="aws-dropdown-search-box-text"\n               ng-model="searchString"\n               placeholder="{{searchPlaceholderString}}"/>\n    </div>\n    <li ng-repeat="item in items | orderBy:orderItemFunction | searchDropdown:searchString"\n        ng-click="itemClicked(item)"\n        ng-class="{\'dropdown-submenu\': itemIsNestedMenu(item), \'filter-off\': items.length <= searchBarThreshold }"></a>\n        <a ng-if="!itemIsNestedMenu(item)"\n           tabindex="-1"\n           ng-mouseenter="itemHovered(item)"\n           ng-mouseleave="itemHovered({})"\n           title="{{item.title}}">\n           {{item.name}}</a>\n        <a ng-if="itemIsNestedMenu(item)"\n           ng-mouseenter="subMenuOpened(item)"\n           ng-mouseleave="subMenuClosed(item)"\n           ng-class="{disabled: !itemHasNestedItems(item)}"\n           tabindex="0"\n           title="{{item.title}}">{{item.name}}\n            <div class="dropdown-container submenu"\n                 ng-if="itemHasNestedItems(item)"\n                 ng-click="subMenuClickedContainer($event);">\n                <aws-dropdown-menu\n                        items="item.items"\n                        action-items={}\n                        is-open="item.isOpen"\n                        on_click_item_callback="itemClicked"\n                        on-hover-item-callback="itemHovered"\n                        scroll-limit="scrollLimit"\n                        search-bar-threshold="searchBarThreshold"\n                        reset-search-string="resetSearchString"\n                        active-item={}\n                        order-action-function="orderActionFunction"\n                        order-item-function="orderItemFunction"\n                        empty-text="emptyText"\n                        ng-if="itemIsNestedMenu(item)"></aws-dropdown-menu>\n            </div>\n        </a>\n    </li>\n</ul>',controller:"awsDropdownMenuCtrl",scope:{actionItems:"=",orderActionFunction:"=",searchString:"=?",searchPlaceholderString:"=?",resetSearchString:"=",searchBarThreshold:"=",items:"=",activeItem:"=",orderItemFunction:"=",onClickItemCallback:"=",onHoverItemCallback:"=",scrollLimit:"=",isOpen:"=",autoCloseDelay:"="},compile:function(t){return e.compile(t)}}}]),P.filter("searchDropdown",[function(){return function(t,n){if(!n)return t;var r=[];return n=n.toLowerCase(),e.forEach(t,function(t){(-1!==t.name.toLowerCase().indexOf(n)||e.isArray(t.id)&&0<t.id.length)&&r.push(t)}),r}}]);var N=e.module("awsCommonComponents.awsDropdown",["awsCommonComponents.awsDropdown.awsDropdownMenu"]);N.controller("awsDropdownCtrl",["$scope","$timeout",function(t,n){function r(n){function r(t,n){e.forEach(n,function(n){if(e.isArray(n.items))return r(t,n.items);a||e.isArray(n.items)||(a=n),e.isDefined(n.id)&&n.id===t&&!e.isArray(n.items)&&(i=n)})}var i,a;r(n,t.items),i?(t.activeItemId!==i.id&&(t.activeItemId=i.id),t.activeItem=i,t.displayText=t.activeItem.name):t.autoSelectFirstItem&&e.isDefined(a)&&a!==t.activeItemId?(t.activeItemId=a.id,t.activeItem=a,t.displayText=t.activeItem.name):t.emptyText!==t.activeItemId&&(t.activeItemId=void 0,t.activeItem=void 0,t.displayText=t.emptyText)}a(t,"scrollLimit",15),a(t,"searchBarThreshold",10),a(t,"allowSearchBar",!0),a(t,"resetSearchString",!0),a(t,"searchString",""),a(t,"searchPlaceholderString","Filter"),a(t,"isOpen",!1),a(t,"isButton",!1),a(t,"emptyText","None Available"),a(t,"orderItemFunction",function(e){return o(e.orderBy,e.name)}),a(t,"orderActionFunction",t.orderFunction),a(t,"subMenuOpened",!1),a(t,"enabled",!0),a(t,"autoCloseDelay",200),a(t,"autoSelectFirstItem",!0),t.itemSelected=function(e){t.activeItemId=e.id},t.itemHovered=function(e){t.hoverItem=e},t.buttonClicked=function(){t.isOpen=!t.isOpen,t.buttonClickedCallback&&t.buttonClickedCallback()},t.tryCloseMenu=function(){!1===t.subMenuOpened&&(t.tryCloseMenuTimeout=n(function(){t.isOpen=!1},t.autoCloseDelay))},t.subMenuEntered=function(){n.cancel(t.tryCloseMenuTimeout),t.subMenuOpened=!0},t.subMenuExited=function(){t.tryCloseMenuTimeout=n(function(){t.isOpen=!1,t.subMenuOpened=!1},t.autoCloseDelay)},t.$watchCollection("items",function(){r(t.activeItemId)}),t.$watch("activeItemId",r),t.$watch("emptyText",function(e,n){t.displayText===n&&(t.displayText=e)})}]),N.directive("awsDropdown",[function(){return{restrict:"AE",template:'<div class="dropdown aws-dropdown" ng-class="{\'aws-button\' : isButton}">\n    <div class="btn dropdown-label"\n         ng-class="{\'open\': isOpen, \'disabled\': !enabled || items.length + actionItems.length === 0 }"\n         ng-click="buttonClicked()"\n         ng-mouseleave="tryCloseMenu()"\n         ng-bind="displayText">\n    </div>\n    <div class="dropdown-container">\n        <aws-dropdown-menu\n                ng-mouseenter="subMenuEntered()"\n                ng-mouseleave="subMenuExited()"\n                items="items"\n                action-items="actionItems"\n                is-open="isOpen"\n                on-click-item-callback="itemSelected"\n                on-hover-item-callback="itemHovered"\n                scroll-limit="scrollLimit"\n                search-placeholder-string="searchPlaceholderString"\n                search-bar-threshold="searchBarThreshold"\n                reset-search-string="resetSearchString"\n                active-item="activeItem"\n                order-action-function="orderActionFunction"\n                order-item-function="orderItemFunction"\n                auto-close-delay="autoCloseDelay"></aws-dropdown-menu>\n    </div>\n</div>',controller:"awsDropdownCtrl",scope:{actionItems:"=?",orderActionFunction:"=?",searchString:"=?",searchPlaceholderString:"=?",resetSearchString:"=?",searchBarThreshold:"=?",items:"=",activeItemId:"=?",activeItem:"=?",hoverItem:"=?",orderItemFunction:"=?",enabled:"=?",scrollLimit:"=?",emptyText:"=?",isOpen:"=?",isButton:"=?",autoCloseDelay:"=?",buttonClickedCallback:"=?",autoSelectFirstItem:"=?"}}}]);var M=e.module("awsCommonComponents.awsCheckbox",[]);M.controller("awsCheckboxCtrl",["$scope",function(t){a(t,"value",!1),a(t,"labelPosition","right"),t.clickMe=function(){t.value=!t.value},e.isDefined(t.callback)&&typeof("function"===t.callback)&&t.$watch("value",function(){e.isDefined(t.callback)&&typeof("function"===t.callback)&&t.callback(t.value)})}]),M.directive("awsCheckbox",[function(){return{restrict:"AE",template:'<div class="aws-checkbox" ng-click="clickMe()">\n    <table>\n        <tr>\n            <td ng-if="labelPosition === \'left\'">\n                <label for="{{label.replace(\' \', \'\')}}" class="aws-checkbox-label">{{label}}</label>\n            </td>\n            <td class="aws-checkbox-wrapper-outer">\n                <div class="aws-checkbox-wrapper">\n                    <input id="{{label.replace(\' \', \'\')}}" type="checkbox" class="aws-checkbox-element" ng-model="value">\n                    <span class="aws-checkbox-indicator">\n                        <i class="fa fa-check"></i>\n                    </span>\n                </div>\n            </td>\n            <td ng-if="labelPosition === \'right\'">\n                <label for="{{label.replace(\' \', \'\')}}" class="aws-checkbox-label">{{label}}</label>\n            </td>\n        </tr>\n    </table>\n</div>',scope:{label:"=",value:"=?",callback:"=?",labelPosition:"=?"},controller:"awsCheckboxCtrl"}}]);var L=e.module("awsCommonComponents.awsWizard",[]);L.controller("awsWizardCtrl",["$scope","$interpolate",function(t,n){function r(n){e.isDefined(n)&&(t.wizardSteps=n,t.wizard.steps=n,e.forEach(t.wizardSteps,function(e){a(e,"navigation",{}),a(e,"navigation.message","* Required"),a(e,"navigation.displayingMessage",e.navigation.message),a(e,"navigation.nextButton.onClick",function(){return!0}),a(e,"navigation.nextButton.disabled",!1),a(e.navigation.backButton,"onClick",function(){return!0}),a(e.navigation.backButton,"disabled",!1),e.wizard=t.wizard}))}function i(e,n){var r=t.wizardSteps[t.wizardActiveStep].navigation[n];!0===e?t.defaultButtonActions[n]():"number"==typeof e?t.wizardActiveStep+=e:"string"==typeof e?t.wizard.setStepMessage(e):"object"==typeof e&&(r.disabled=!0,r.loading=!0,e.then(function(e){i(e,n),r.disabled=!1,r.loading=!1},function(e){i(e,n),r.disabled=!1,r.loading=!1}))}a(t,"wizard",{}),a(t,"wizardStepPattern","Step {{$index+1}}: {{step.name}}"),a(t,"wizardStepsOpen",!0),a(t,"wizardAllowForwardOnly",!1),r(),t.$watch("wizardSteps",r),t.$watch("wizard.steps",r),t.completedSteps=-1,t.defaultButtonActions={nextButton:function(){t.completedSteps<t.wizardActiveStep&&(t.completedSteps=t.wizardActiveStep),t.wizardActiveStep+=1},backButton:function(){--t.wizardActiveStep},cancelButton:{}},t.$watch("wizardActiveStep",function(){t.wizard.setStepMessage(t.wizardSteps[t.wizardActiveStep].navigation.message)}),t.wizard.setStepMessage=function(e,n){t.wizardSteps[o(n,t.wizardActiveStep)].navigation.displayingMessage=e},t.buttonPress=function(e){t.wizard.setStepMessage(t.wizardSteps[t.wizardActiveStep].navigation.message);var n=t.wizardSteps[t.wizardActiveStep].navigation[e];n.disabled||i(n.onClick(),e)},t.itemClick=function(n){if(t.wizardActiveStep>n){if(e.isDefined(t.wizardNoReturnRanges))for(var r=0;r<t.wizardNoReturnRanges.length;r++){var i=t.wizardNoReturnRanges[r][0],a=t.wizardNoReturnRanges[r][1];if(t.completedSteps>=a&&n>=i&&n<=a)return t.wizardActiveStep}return t.wizardAllowForwardOnly&&t.wizardActiveStep>=n?t.wizardActiveStep:t.wizardActiveStep=n}},t.buttonShow=function(n){return!isNaN(t.wizardActiveStep)&&e.isDefined(t.wizardSteps)&&e.isDefined(t.wizardSteps[t.wizardActiveStep])&&e.isDefined(t.wizardSteps[t.wizardActiveStep].navigation[n])&&""!==t.wizardSteps[t.wizardActiveStep].navigation[n].label},t.wizardStepLabel=function(e,r){return n(t.wizardStepPattern)({$index:e,step:r})}}]),L.directive("awsWizard",[function(){return{restrict:"AE",template:'<div class="aws-wizard">\n    <div class="aws-wizard-title">{{wizardTitle}}</div>\n    <div class="aws-wizard-content">\n        <div class="aws-wizard-navigation aws-wizard-side-width" ng-class="{\'closed-sidebar\': !wizardStepsOpen}">\n            <div class="aws-wizard-nav-body">\n                <div ng-repeat="step in wizardSteps"\n                     ng-class="{\n                        past: $index < wizardActiveStep,\n                        active: $index == wizardActiveStep,\n                        future: $index > wizardActiveStep || wizardAllowForwardOnly\n                     }"\n                     ng-click="itemClick($index)">{{wizardStepLabel($index, step)}}\n                </div>\n            </div>\n        </div>\n        <div class="aws-wizard-body">\n            <div class="aws-wizard-content-title">{{wizardSteps[wizardActiveStep].name}}</div>\n            <div class="aws-wizard-content-description" ng-if="wizardSteps[wizardActiveStep].description" ng-bind-html="wizardSteps[wizardActiveStep].description"></div>\n            <div ng-transclude=""></div>\n            <div class="aws-wizard-footer">\n                <div class="aws-wizard-footer-message">\n                    <span>{{wizardSteps[wizardActiveStep].navigation.displayingMessage}}</span>\n                </div>\n                <div class="aws-wizard-footer-buttons">\n                    <aws-button class="btn-cancel"\n                                ng-if="buttonShow(\'cancelButton\')"\n                                text-button="true"\n                                disabled="wizardSteps[wizardActiveStep].navigation.cancelButton.disabled"\n                                loading="wizardSteps[wizardActiveStep].navigation.cancelButton.loading"\n                                button-text="wizardSteps[wizardActiveStep].navigation.cancelButton.label"\n                                ng-click="buttonPress(\'cancelButton\')">\n                    </aws-button>\n                    <aws-button class="btn-back"\n                                ng-if="buttonShow(\'backButton\')"\n                                disabled="wizardSteps[wizardActiveStep].navigation.backButton.disabled"\n                                loading="wizardSteps[wizardActiveStep].navigation.backButton.loading"\n                                button-text="wizardSteps[wizardActiveStep].navigation.backButton.label"\n                                ng-click="buttonPress(\'backButton\')">\n                    </aws-button>\n                    <aws-button class="btn-show"\n                                ng-if="buttonShow(\'nextButton\')"\n                                primary-button="true"\n                                class="primary"\n                                disabled="wizardSteps[wizardActiveStep].navigation.nextButton.disabled"\n                                loading="wizardSteps[wizardActiveStep].navigation.nextButton.loading"\n                                button-text="wizardSteps[wizardActiveStep].navigation.nextButton.label"\n                                ng-click="buttonPress(\'nextButton\')">\n                    </aws-button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div style="clear: both;"></div>\n</div>',scope:{wizardTitle:"=",wizardSteps:"=?",wizardActiveStep:"=",wizardStepPattern:"=?",wizardNavStepClick:"&?",wizard:"=?",wizardStepsOpen:"=?",wizardNoReturnRanges:"=",wizardAllowForwardOnly:"=?"},transclude:!0,controller:"awsWizardCtrl"}}]);var x=e.module("aws.deleteConfirmationModal",["awsCommonComponents.awsModal"]);x.controller("awsDeleteConfirmationModalCtl",["$scope",function(t){function n(){return t.deleteResourceValidation.message="",t.deleteResourceValidation.state="",""===t.deleteInput.value.trim()?(t.deleteResourceValidation.message="This field is required. Please enter the name of the "+t.resourceType+" to be deleted.",t.deleteResourceValidation.state="error",!1):t.resourceName===t.deleteInput.value||(t.deleteResourceValidation.message="'"+t.deleteInput.value+"' does not match the name of the "+t.resourceType+" to be deleted.",t.deleteResourceValidation.state="error",!1)}t.deleteInput={value:e.isDefined(t.deleteInput)?t.deleteInput:""},t.deleteResourceInputLabel=e.isDefined(t.deleteResourceInputLabel)?t.deleteResourceInputLabel:"",t.deleteResourceValidation={state:"",message:""},t.deleteResourceInputConfig={required:!0,placeholder:t.resourceType+" name",label:t.deleteResourceInputLabel},t.closeModal=function(){t.isOpen=!1,t.deleteInput.value=""},e.isDefined(t.cancelCallback)||(t.cancelCallback=t.closeModal),t.validateDelete=function(){t.resourceName&&!n()||(t.deleteCallback(t.deleteInput.value),t.closeModal())}}]),x.directive("awsDeleteConfirmationModal",[function(){return{restrict:"AE",template:'<aws-modal is-open="isOpen">\n    <div transclude-name="header">Delete {{resourceType}}</div>\n    <div transclude-name="content">\n        <p>Deleting this {{resourceType}} cannot be undone. Are you sure you want to delete\n            <strong ng-if="resourceName">{{resourceName}}</strong>\n            <span ng-if="!resourceName">this {{resourceType}}</span>\n            permanently?</p>\n        <p ng-if="resourceName">Type in the name of the {{resourceType}} to confirm deletion:</p>\n        <div aws-text-input\n             ng-if="resourceName"\n             input-value="deleteInput.value"\n             input-config="deleteResourceInputConfig"\n             input-validation="deleteResourceValidation"></div>\n    </div>\n    <div transclude-name="footer">\n        <div class="btn-wrapper" ng-click="closeModal()"><a class="btn btn-link">Cancel</a></div>\n        <div class="btn-wrapper" ng-click="validateDelete()"><a class="btn btn-danger">Delete {{resourceType}}</a></div>\n    </div>\n</aws-modal>',scope:{isOpen:"=?",resourceType:"=",resourceName:"=?",deleteResourceValue:"=?",deleteResourceInputLabel:"=?",deleteCallback:"=",cancelCallback:"=?"},controller:"awsDeleteConfirmationModalCtl"}}])}).call(t,n(0),n(6),n(6),n(127))},function(e,t,n){(function(e,t){!function(){"use strict";e.module("awsconsole.common",["ngCookies","pascalprecht.translate"])}(),function(){"use strict";e.module("awsconsole.common").factory("AWSC",["$window",function(t){function n(t){var n=a(t,"key",d),r=a(t,"pageId",g);e.isString(n)&&s(n)&&(l(n,r),o(t,"key",d,c(n)))}function r(t){var n=a(t,"detail",f);e.isObject(n)&&o(t,"detail",f,e.toJson(n))}function i(t,n){var r=u-n,i=a(t,"id");e.isString(i)&&s(i,r)&&(l(i),o(t,"id",null,c(i,r)))}function a(t,n,r){if(t&&t.length>0){if(e.isObject(t[p]))return t[p][n];if(e.isNumber(r))return t[r]}}function o(t,n,r,i){t&&t.length>0&&(e.isObject(t[p])?t[p][n]=i:e.isNumber(r)&&(t[r]=i))}function s(e,t){var n=t||u;return e.length>n}function c(e,t){var n=t||u;return e.substring(0,n)}function l(e,n){var r={key:m,value:1,detail:e};n&&(r.pageId=n),t.AWSC.Clog.log(r)}var u=32,d=0,p=0,f=2,g=3,m="metricNameTruncated";return{Analytics:{trackClick:function(){t.AWSC&&t.AWSC.Analytics&&t.AWSC.Analytics.trackClick&&(i(arguments,"click_".length),t.AWSC.Analytics.trackClick.apply(t.AWSC.Analytics,arguments))},trackView:function(){t.AWSC&&t.AWSC.Analytics&&t.AWSC.Analytics.trackView&&(i(arguments,"view_".length),t.AWSC.Analytics.trackView.apply(t.AWSC.Analytics,arguments))},setDebugForAnalytics:function(){t.AWSC&&t.AWSC.Analytics&&t.AWSC.Analytics.setDebugForAnalytics&&t.AWSC.Analytics.setDebugForAnalytics.apply(t.AWSC.Analytics,arguments)}},Clog:{log:function(){t.AWSC&&t.AWSC.Clog&&t.AWSC.Clog.log&&(r(arguments),n(arguments),t.AWSC.Clog.log.apply(t.AWSC.Clog,arguments))},setPageId:function(){t.AWSC&&t.AWSC.Clog&&t.AWSC.Clog.setPageId&&(n(arguments),t.AWSC.Clog.setPageId.apply(t.AWSC.Clog,arguments))},setEndpointOverride:function(){t.AWSC&&t.AWSC.Clog&&t.AWSC.Clog.setEndpointOverride&&t.AWSC.Clog.setEndpointOverride.apply(t.AWSC.Clog.setEndpointOverride,arguments)}},Timer:{customerReady:function(){t.AWSC&&t.AWSC.Timer&&t.AWSC.Timer.customerReady&&t.AWSC.Timer.customerReady.apply(t.AWSC.Timer,arguments)},start:function(){t.AWSC&&t.AWSC.Timer&&t.AWSC.Timer.start&&(n(arguments),t.AWSC.Timer.start.apply(t.AWSC.Timer,arguments))},stop:function(){t.AWSC&&t.AWSC.Timer&&t.AWSC.Timer.stop&&(n(arguments),t.AWSC.Timer.stop.apply(t.AWSC.Timer,arguments))},submitCustomTimer:function(){t.AWSC&&t.AWSC.Timer&&t.AWSC.Timer.submitCustomTimer&&(n(arguments),t.AWSC.Timer.submitCustomTimer.apply(t.AWSC.Timer,arguments))}}}}])}(),function(){"use strict";var t=e.module("awsconsole.common");t.config(["$provide",function(e){e.decorator("$q",["$delegate",function(e){var t=e.defer;return e.defer=function(){var e=t();return e.promise.success=function(t){return e.promise.then(function(e){t(e)}),e.promise},e.promise.error=function(t){return e.promise.then(null,function(e){t(e)}),e.promise},e},e}])}]),t.service("AWSConsoleProxyService",["$http","$q","AWSC","lodashCustom","Region","XMLParser",function(t,n,r,i,a,o){var s="x-amzn-RequestId";return function(c){function l(t){function n(e,t){return i.get(e,t,"")}if(t.proxyConfig.exceptionPaths){var r=i.get(t,"proxyConfig.exceptionMessageSizeLimit",100);return{serviceTarget:i.get(t,"proxyConfig.serviceTarget",""),operation:e.isString(t.operation)?t.operation:t.operation.name,type:n(t.data,i.get(t,"proxyConfig.exceptionPaths.type")),message:n(t.data,i.get(t,"proxyConfig.exceptionPaths.message")).substring(0,r),status:t.status,url:i.get(t,"config.url",""),requestId:t.headers(s)}}}function u(e,t){if(c.serviceTarget){var n=c.serviceTargetMetricName?c.serviceTargetMetricName:c.serviceTarget,r=d(e);return n+"_"+r.charAt(0).toUpperCase()+r.slice(1)}return t}function d(e){return e instanceof Object?e.name:e}function p(e){return i.get(e,"options.pagination.shouldContinuePagination")&&i.get(e,"options.pagination.metricNames.success")&&i.get(e,"options.pagination.metricNames.timing")&&i.get(e,"options.pagination.metricNames.count")&&i.get(e,"options.pagination.reduceResponses")&&(i.get(e,"options.pagination.buildPaginationContent")||i.get(e,"options.pagination.buildPaginationParams"))}function f(t,n,r){var i=n[t];return i||(i=r[t]),r[t]instanceof Object&&n[t]instanceof Object&&(i=e.extend({},n[t],r[t])),i}var g={};return c.operations.forEach(function(t){if(t instanceof Object){var i=t.name.charAt(0).toLowerCase()+t.name.slice(1);g[i]=function(e){e||(e={});var n=f("params",t,e),r=f("config",t,e);return g.call(t,e.content,e.method||t.method,e.path||t.path,n,e.headers||t.headers,t.metricName,e.region||t.region,r,e.details||t.details)},p(t)&&(g[i+"WithPagination"]=function(i){var a=Date.now();i||(i={});var o=f("params",t,i),c=f("config",t,i),l=i.content,u=[],d=[],p=t.options.pagination.metricNames.success,m=function(){return g.call(t,l,i.method||t.method,i.path||t.path,o,i.headers||t.headers,t.metricName,i.region||t.region,c,i.details||t.details).then(function(r){return d.push(r.headers(s)),u.push(r),!0===t.options.pagination.shouldContinuePagination(r)?(t.options.pagination.buildPaginationParams&&(o=e.extend({},o,t.options.pagination.buildPaginationParams(r))),t.options.pagination.buildPaginationContent&&(l=e.extend({},l,t.options.pagination.buildPaginationContent(r))),m()):(r.paginatedResponses=u,r.reducedResponse=t.options.pagination.reduceResponses(u),n.when(r))}).catch(function(e){return e.paginatedResponses=u,e.reducedResponse=t.options.pagination.reduceResponses(u),n.reject(e)})};return m().then(function(e){return r.Clog.log(p,1,{requestIds:{failure:void 0,success:d}}),r.Clog.log(t.options.pagination.metricNames.count,d.length),n.when(e)}).catch(function(e){return r.Clog.log(p,0,{requestIds:{failure:e.headers(s),success:d}}),r.Clog.log(t.options.pagination.metricNames.count,d.length+1),n.reject(e)}).finally(function(){var e=Date.now();r.Timer.submitCustomTimer(t.options.pagination.metricNames.timing,e-a)})})}else g[t.charAt(0).toLowerCase()+t.slice(1)]=function(e){return g.call(t,e)}}),g.call=function(i,s,p,f,g,m,h,b,v,E){"POST"===p&&void 0===s&&(s={});var S,y=n.defer(),A={region:b||s&&s.region||a.getCurrentRegion()};if(m)A.headers=m;else if(A.headers={"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString()},c.serviceTarget){var C=d(i);A.headers["X-Amz-Target"]=c.serviceTarget+"."+C}S=u(i,h),p&&(A.method=p),f&&(A.path=f),g&&(A.params=g),s&&("object"==typeof s?A.content=s:"string"==typeof s&&(A.contentString=s)),v||(v={}),A.operation=i instanceof Object?i.name:i;var _=function(e){var t=e("Server")&&"AmazonEC2"===e("Server"),n=e("Content-Type")&&e("Content-Type").match("/xml");return o&&(t||n)},w={request:A},T="object"==typeof c.ajaxEndpoint?c.ajaxEndpoint[A.region]:c.ajaxEndpoint;return t.post(T,A,v).success(function(t,n,i,a){w.response=t,w.headers=i,w.status=n,w.config=a;var s=!1;e.isString(t)&&t.length>0&&i&&(_(i)?(w.response=o.convertXmlStringToJson(t),E&&E.shouldLogResponseData&&(r.Clog.log(S,1,t),s=!0)):i("Content-Type")&&(i("Content-Type").match("text")?y.resolve(w):(w.response={message:"Unexpected error",error:"Unable to parse response as JSON, XML or Text",data:t},r.Clog.log(S,0),s=!0,y.reject(w)))),s||r.Clog.log(S,1),y.resolve(w)}).error(function(t,n,a,s){w.headers=a,w.status=n,w.config=s,e.isString(t)&&t.length>0&&a&&_(a)?w.response=o.convertXmlStringToJson(t):w.response=t,r.Clog.log(S,0,l({operation:i,proxyConfig:c,data:t,status:n,headers:a,config:s})),y.reject(w)}),y.promise},g}}])}(),function(){"use strict";e.module("awsconsole.common").factory("lodashCustom",function(){function e(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function n(e,t){return null==e?Y:e[t]}function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function i(){this.__data__=_e?_e(null):{},this.size=0}function a(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function o(e){var t=this.__data__;if(_e){var n=t[e];return n===z?Y:n}return he.call(t,e)?t[e]:Y}function s(e){var t=this.__data__;return _e?t[e]!==Y:he.call(t,e)}function c(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_e&&t===Y?z:t,this}function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function u(){this.__data__=[],this.size=0}function d(e){var t=this.__data__,n=y(t,e);return!(n<0||(n==t.length-1?t.pop():ye.call(t,n,1),--this.size,0))}function p(e){var t=this.__data__,n=y(t,e);return n<0?Y:t[n][1]}function f(e){return y(this.__data__,e)>-1}function g(e,t){var n=this.__data__,r=y(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function m(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function h(){this.size=0,this.__data__={hash:new r,map:new(Ce||l),string:new r}}function b(e){var t=R(this,e).delete(e);return this.size-=t?1:0,t}function v(e){return R(this,e).get(e)}function E(e){return R(this,e).has(e)}function S(e,t){var n=R(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function y(e,t){for(var n=e.length;n--;)if(j(e[n][0],t))return n;return-1}function A(e,t){t=T(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[L(t[n++])];return n&&n==r?e:Y}function C(e){return null==e?e===Y?ee:X:Ae&&Ae in Object(e)?k(e):M(e)}function _(e){return!(!F(e)||N(e))&&(B(e)?Ee:se).test(x(e))}function w(t){if("string"==typeof t)return t;if(ke(t))return e(t,w)+"";if(K(t))return Te?Te.call(t):"";var n=t+"";return"0"==n&&1/t==-$?"-0":n}function T(e,t){return ke(e)?e:I(e,t)?[e]:Oe(V(e))}function R(e,t){var n=e.__data__;return P(t)?n["string"==typeof t?"string":"hash"]:n.map}function O(e,t){var r=n(e,t);return _(r)?r:Y}function k(e){var t=he.call(e,Ae),n=e[Ae];try{e[Ae]=Y;var r=!0}catch(e){}var i=ve.call(e);return r&&(t?e[Ae]=n:delete e[Ae]),i}function I(e,t){if(ke(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!K(e))||ne.test(e)||!te.test(e)||null!=t&&e in Object(t)}function P(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function N(e){return!!be&&be in e}function M(e){return ve.call(e)}function L(e){if("string"==typeof e||K(e))return e;var t=e+"";return"0"==t&&1/e==-$?"-0":t}function x(e){if(null!=e){try{return me.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function D(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(W);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(D.Cache||m),n}function j(e,t){return e===t||e!==e&&t!==t}function B(e){if(!F(e))return!1;var t=C(e);return t==q||t==J||t==H||t==Z}function F(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function U(e){return null!=e&&"object"==typeof e}function K(e){return"symbol"==typeof e||U(e)&&C(e)==Q}function V(e){return null==e?"":w(e)}function G(e,t,n){var r=null==e?Y:A(e,t);return r===Y?n:r}/**
         * @license
         * Lodash (Custom Build) <https://lodash.com/>
         * Build: `lodash include="get" exports="none"`
         * Copyright JS Foundation and other contributors <https://js.foundation/>
         * Released under MIT license <https://lodash.com/license>
         * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
         * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
         */
var Y,W="Expected a function",z="__lodash_hash_undefined__",$=1/0,H="[object AsyncFunction]",q="[object Function]",J="[object GeneratorFunction]",X="[object Null]",Z="[object Proxy]",Q="[object Symbol]",ee="[object Undefined]",te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/^\./,ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ae=/[\\^$.*+?()[\]{}|]/g,oe=/\\(\\)?/g,se=/^\[object .+?Constructor\]$/,ce="object"==typeof t&&t&&t.Object===Object&&t,le="object"==typeof self&&self&&self.Object===Object&&self,ue=ce||le||Function("return this")(),de=Array.prototype,pe=Function.prototype,fe=Object.prototype,ge=ue["__core-js_shared__"],me=pe.toString,he=fe.hasOwnProperty,be=function(){var e=/[^.]+$/.exec(ge&&ge.keys&&ge.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ve=fe.toString,Ee=RegExp("^"+me.call(he).replace(ae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=ue.Symbol,ye=de.splice,Ae=Se?Se.toStringTag:Y,Ce=O(ue,"Map"),_e=O(Object,"create"),we=Se?Se.prototype:Y,Te=we?we.toString:Y,Re={};r.prototype.clear=i,r.prototype.delete=a,r.prototype.get=o,r.prototype.has=s,r.prototype.set=c,l.prototype.clear=u,l.prototype.delete=d,l.prototype.get=p,l.prototype.has=f,l.prototype.set=g,m.prototype.clear=h,m.prototype.delete=b,m.prototype.get=v,m.prototype.has=E,m.prototype.set=S;var Oe=function(e){var t=D(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return re.test(e)&&t.push(""),e.replace(ie,function(e,n,r,i){t.push(r?i.replace(oe,"$1"):n||e)}),t});D.Cache=m;var ke=Array.isArray;return Re.memoize=D,Re.eq=j,Re.get=G,Re.isArray=ke,Re.isFunction=B,Re.isObject=F,Re.isObjectLike=U,Re.isSymbol=K,Re.toString=V,Re.VERSION="4.17.4",Re})}(),function(){"use strict";var t=e.module("awsconsole.common");t.config(["$translateProvider",function(e){var t={"region.iad":"US East (N. Virginia)","region.cmh":"US East (Ohio)","region.pdx":"US West (Oregon)","region.sfo":"US West (N. California)","region.yul":"Canada (Central)","region.dub":"EU (Ireland)","region.fra":"EU (Frankfurt)","region.bom":"Asia Pacific (Mumbai)","region.sin":"Asia Pacific (Singapore)","region.nrt":"Asia Pacific (Tokyo)","region.syd":"Asia Pacific (Sydney)","region.icn":"Asia Pacific (Seoul)","region.kix":"Asia Pacific (Osaka-Local)","region.gru":"South America (São Paulo)","region.lhr":"EU (London)","region.bjs":"China (Beijing)","region.pdt":"AWS GovCloud (US-West)","region.dca":"C2S US East 1","region.lck":"US ISOB East (Ohio)","region.zhy":"China (Ningxia)","region.cdg":"EU (Paris)","region.osu":"AWS GovCloud (US-East)","region.arn":"EU (Stockholm)","region.hkg":"Asia Pacific (Hong Kong)"},n={"region.iad":"米国東部（バージニア北部）","region.cmh":"米国東部 (オハイオ)","region.pdx":"米国西部 (オレゴン)","region.sfo":"米国西部 (北カリフォルニア)","region.yul":"カナダ（センター）","region.dub":"EU (アイルランド)","region.fra":"EU (フランクフルト)","region.bom":"アジアパシフィック (ムンバイ)","region.sin":"アジアパシフィック (シンガポール)","region.nrt":"アジアパシフィック (東京)","region.syd":"アジアパシフィック (シドニー)","region.icn":"アジアパシフィック (ソウル)","region.kix":"アジアパシフィック (大阪:ローカル)","region.gru":"南米 (サンパウロ)","region.lhr":"EU (ロンドン)","region.bjs":"中国（北京）","region.pdt":"AWS GovCloud (米国西部)","region.dca":"C2S US East 1","region.lck":"US ISOB East (Ohio)","region.zhy":"中国 (寧夏)","region.cdg":"EU (パリ)","region.osu":"AWS GovCloud (米国東部)","region.arn":"EU (ストックホルム)","region.hkg":"アジアパシフィック (香港)"},r={"region.iad":"USA Est (Virginie du Nord)","region.cmh":"USA Est (Ohio)","region.pdx":"USA Ouest (Oregon)","region.sfo":"USA Ouest (Californie du Nord)","region.yul":"Canada (Centre)","region.dub":"UE (Irlande)","region.fra":"UE (Francfort)","region.bom":"Asie-Pacifique (Mumbai)","region.sin":"Asie-Pacifique (Singapour)","region.nrt":"Asie-Pacifique (Tokyo)","region.syd":"Asie-Pacifique (Sydney)","region.icn":"Asie-Pacifique (Séoul)","region.kix":"Asie-Pacifique (Osaka-Local)","region.gru":"Amérique du Sud (São Paulo)","region.lhr":"UE (Londres)","region.bjs":"Chine (Pékin)","region.pdt":"AWS GovCloud (USA Ouest)","region.dca":"C2S US East 1","region.lck":"US ISOB East (Ohio)","region.zhy":"Chine (Ningxia)","region.cdg":"UE (Paris)","region.osu":"AWS GovCloud (USA Est)","region.arn":"UE (Stockholm)","region.hkg":"Asie-Pacifique (Hong Kong)"},i={"region.iad":"美国东部(弗吉尼亚北部）","region.cmh":"美国东部(俄亥俄州）","region.pdx":"美国西部(俄勒冈）","region.sfo":"美国西部(加利福尼亚北部）","region.yul":"加拿大(中）","region.dub":"欧洲(爱尔兰）","region.fra":"欧洲(法兰克福）","region.bom":"亚太地区(孟买）","region.sin":"亚太区域(新加坡）","region.nrt":"亚太区域(东京）","region.syd":"亚太区域(悉尼）","region.icn":"亚太区域(首尔）","region.kix":"亚太区域(大阪本地)","region.gru":"南美洲(圣保罗）","region.lhr":"欧洲(伦敦)","region.bjs":"中国(北京）","region.pdt":"AWS GovCloud（美国西部）","region.dca":"C2S US East 1","region.lck":"US ISOB East (Ohio)","region.zhy":"中国(宁夏)","region.cdg":"欧洲(巴黎)","region.osu":"AWS GovCloud（美国东部）","region.arn":"欧盟(斯德哥尔摩)","region.hkg":"亚太区域 (香港)"},a={"region.iad":"美國東部(維吉尼亞北部)","region.cmh":"美國東部(俄亥俄)","region.pdx":"美國西部(奧瑞岡)","region.sfo":"美國西部(加州北部)","region.yul":"加拿大(中部)","region.dub":"歐洲(愛爾蘭)","region.fra":"歐洲(法蘭克福)","region.bom":"亞太區域(孟買)","region.sin":"亞太區域(新加坡)","region.nrt":"亞太區域(東京)","region.syd":"亞太區域(雪梨)","region.icn":"亞太區域(首爾)","region.kix":"亞太區域(大阪當地)","region.gru":"南美洲(聖保羅)","region.lhr":"歐洲(倫敦)","region.bjs":"中國(北京)","region.pdt":"AWS GovCloud (美國西部)","region.dca":"C2S 美國東部 1","region.lck":"美國 ISOB 東部(俄亥俄)","region.zhy":"中國(寧夏)","region.cdg":"歐洲(巴黎)","region.osu":"AWS GovCloud (美國東部)","region.arn":"歐盟(斯德哥爾摩)","region.hkg":"亞太區域 (香港)"},o={"region.iad":"USA Ost (Nord-Virginia)","region.cmh":"USA Ost (Ohio)","region.pdx":"USA West (Oregon)","region.sfo":"USA West (Nordkalifornien)","region.yul":"Kanada (Zentral)","region.dub":"EU (Irland)","region.fra":"EU (Frankfurt)","region.bom":"Asien-Pazifik (Mumbai)","region.sin":"Asien-Pazifik (Singapur)","region.nrt":"Asien-Pazifik (Tokio)","region.syd":"Asien-Pazifik (Sydney)","region.icn":"Asien-Pazifik (Seoul)","region.kix":"Asien-Pazifik (Osaka-Lokal)","region.gru":"Südamerika (São Paulo)","region.lhr":"EU (London)","region.bjs":"China (Peking)","region.pdt":"AWS GovCloud (USA West)","region.dca":"C2S USA Ost 1","region.lck":"USA ISOB Ost (Ohio)","region.zhy":"China (Ningxia)","region.cdg":"EU (Paris)","region.osu":"AWS GovCloud (USA Ost)","region.arn":"EU (Stockholm)","region.hkg":"Asien-Pazifik (Hongkong)"},s={"region.iad":"Leste dos EUA (Norte da Virgínia)","region.cmh":"Leste dos EUA (Ohio)","region.pdx":"Oeste dos EUA (Oregon)","region.sfo":"Oeste dos EUA (Norte da Califórnia)","region.yul":"Canadá (Central)","region.dub":"UE (Irlanda)","region.fra":"UE (Frankfurt)","region.bom":"Ásia Pacífico (Mumbai)","region.sin":"Ásia-Pacífico (Cingapura)","region.nrt":"Ásia-Pacífico (Tóquio)","region.syd":"Ásia-Pacífico (Sydney)","region.icn":"Ásia-Pacífico (Seul)","region.kix":"Ásia-Pacífico (Osaka – Local)","region.gru":"América do Sul (São Paulo)","region.lhr":"UE (Londres)","region.bjs":"China (Pequim)","region.pdt":"AWS GovCloud (Oeste dos EUA)","region.dca":"Leste dos EUA C2S 1","region.lck":"US ISOB East (Ohio)","region.zhy":"China (Ningxia)","region.cdg":"UE (Paris)","region.osu":"AWS GovCloud (Leste dos EUA)","region.arn":"UE (Estocolmo)","region.hkg":"Ásia-Pacífico (Hong Kong)"},c={"region.iad":"Stati Uniti orientali (Virginia settentrionale)","region.cmh":"Stati Uniti orientali (Ohio)","region.pdx":"Stati Uniti occidentali (Oregon)","region.sfo":"Stati Uniti occidentali (California settentrionale)","region.yul":"Canada (Centrale)","region.dub":"UE (Irlanda)","region.fra":"UE (Francoforte)","region.bom":"Asia Pacifico (Mumbai)","region.sin":"Asia Pacifico (Singapore)","region.nrt":"Asia Pacifico (Tokyo)","region.syd":"Asia Pacifico (Sydney)","region.icn":"Asia Pacifico (Seoul)","region.kix":"Asia Pacifico (Osaka – Locale)","region.gru":"Sud America (San Paolo)","region.lhr":"UE (Londra)","region.bjs":"Cina (Pechino)","region.pdt":"AWS GovCloud (Stati Uniti occidentali)","region.dca":"Stati Uniti orientali C2S 1","region.lck":"Stati Uniti orientali ISOB (Ohio)","region.zhy":"Cina (Ningxia)","region.cdg":"UE (Parigi)","region.osu":"AWS GovCloud (Stati Uniti orientali)","region.arn":"UE (Stoccolma)","region.hkg":"Asia Pacifico (Hong Kong)"},l={"region.iad":"EE.UU. Este (Norte de Virginia)","region.cmh":"EE.UU. Este (Ohio)","region.pdx":"EE.UU. Oeste (Oregón)","region.sfo":"EE.UU. Oeste (Norte de California)","region.yul":"Canadá (Central)","region.dub":"UE (Irlanda)","region.fra":"UE (Fráncfort)","region.bom":"Asia Pacífico (Mumbai)","region.sin":"Asia Pacífico (Singapur)","region.nrt":"Asia Pacífico (Tokio)","region.syd":"Asia Pacífico (Sídney)","region.icn":"Asia Pacífico (Seúl)","region.kix":"Asia Pacífico (Osaka-local)","region.gru":"América del Sur (São Paulo)","region.lhr":"UE (Londres)","region.bjs":"China (Pekín)","region.pdt":"AWS GovCloud (EE.UU. Oeste)","region.dca":"C2S EE.UU. Este 1","region.lck":"US ISOB Este (Ohio)","region.zhy":"China (Ningxia)","region.cdg":"UE (París)","region.osu":"AWS GovCloud (EE.UU. Este)","region.arn":"UE (Estocolmo)","region.hkg":"Asia Pacífico (Hong Kong)"},u={"region.iad":"미국 동부(버지니아 북부)","region.cmh":"미국 동부(오하이오)","region.pdx":"미국 서부(오레곤)\t","region.sfo":"미국 서부(캘리포니아 북부 지역)","region.yul":"캐나다(중부)","region.dub":"EU(아일랜드)","region.fra":"EU(프랑크푸르트)","region.bom":"아시아 태평양(뭄바이)","region.sin":"아시아 태평양(싱가포르)","region.nrt":"아시아 태평양(도쿄)","region.syd":"아시아 태평양(시드니)","region.icn":"아시아 태평양(서울)","region.kix":"아시아 태평양 (오사카-로컬)","region.gru":"남아메리카(상파울루)","region.lhr":"EU(런던)","region.bjs":"중국 (베이징)","region.pdt":"AWS GovCloud(US-West)","region.dca":"C2S US East 1","region.lck":"US ISOB East (Ohio)","region.zhy":"중국(닝샤)","region.cdg":"EU(파리)","region.osu":"AWS GovCloud(US-East)","region.arn":"EU(스톡홀름)","region.hkg":"아시아 태평양(홍콩)"};e.translations("en",t),e.translations("en_US",t),e.translations("zh",i),e.translations("zh_CN",i),e.translations("zh_TW",a),e.translations("de",o),e.translations("it",c),e.translations("pt_BR",s),e.translations("es",l),e.translations("fr",r),e.translations("ja",n),e.translations("ko",u)}]),t.factory("Region",["$location","$translate",function(t,n){var r={NAME:"ISO-B",SUFFIX:"sc2shome.sgov.gov",PROD:"console.sc2shome.sgov.gov",GAMMA:"awsc-integ.sc2shome.sgov.gov",ARN:"arn:aws-iso-b:"},i={DOMAINS:{PUBLIC:{NAME:"PUBLIC",SUFFIX:"aws.amazon.com",PROD:"console.aws.amazon.com",GAMMA:"awsc-integ.aws.amazon.com",ARN:"arn:aws:"},CN:{NAME:"CN",SUFFIX:"amazonaws.cn",PROD:"console.amazonaws.cn",GAMMA:"aws-console-platform-proxy-integ-bjs.integ.amazonaws.cn",ARN:"arn:aws-cn:"},GOV:{NAME:"GOV",SUFFIX:"amazonaws-us-gov.com",PROD:"console.amazonaws-us-gov.com",GAMMA:"aws-console-proxy-staging.integ.amazonaws-us-gov.com",ARN:"arn:aws-us-gov:"},ISO:{NAME:"ISO",SUFFIX:"c2shome.ic.gov",PROD:"console.c2shome.ic.gov",GAMMA:"awsc-integ.dca.amazon.com",ARN:"arn:aws-iso:"},ISOB:r,"ISO-B":r}};return"function"==typeof t.host().indexOf&&(-1!==t.host().indexOf(i.DOMAINS.CN.SUFFIX)?i.regionMapping=[{label:n.instant("region.bjs"),id:"cn-north-1"},{label:n.instant("region.zhy"),id:"cn-northwest-1"}]:-1!==t.host().indexOf(i.DOMAINS.GOV.SUFFIX)?i.regionMapping=[{label:n.instant("region.pdt"),id:"us-gov-west-1"},{label:n.instant("region.osu"),id:"us-gov-east-1"}]:-1!==t.host().indexOf(i.DOMAINS.ISO.SUFFIX)||-1!==t.host().indexOf(i.DOMAINS.ISO.GAMMA)?i.regionMapping=[{label:n.instant("region.dca"),id:"us-iso-east-1"}]:-1!==t.host().indexOf(i.DOMAINS.ISOB.SUFFIX)||-1!==t.host().indexOf(i.DOMAINS.ISOB.GAMMA)?i.regionMapping=[{label:n.instant("region.lck"),id:"us-isob-east-1"}]:i.regionMapping=[{label:n.instant("region.iad"),id:"us-east-1"},{label:n.instant("region.cmh"),id:"us-east-2"},{label:n.instant("region.pdx"),id:"us-west-2"},{label:n.instant("region.sfo"),id:"us-west-1"},{label:n.instant("region.yul"),id:"ca-central-1"},{label:n.instant("region.dub"),id:"eu-west-1"},{label:n.instant("region.fra"),id:"eu-central-1"},{label:n.instant("region.lhr"),id:"eu-west-2"},{label:n.instant("region.cdg"),id:"eu-west-3"},{label:n.instant("region.arn"),id:"eu-north-1"},{label:n.instant("region.hkg"),id:"ap-east-1"},{label:n.instant("region.sin"),id:"ap-southeast-1"},{label:n.instant("region.syd"),id:"ap-southeast-2"},{label:n.instant("region.icn"),id:"ap-northeast-2"},{label:n.instant("region.kix"),id:"ap-northeast-3"},{label:n.instant("region.nrt"),id:"ap-northeast-1"},{label:n.instant("region.bom"),id:"ap-south-1"},{label:n.instant("region.gru"),id:"sa-east-1"}]),i.regionMapping&&(i.regionMapping=i.regionMapping.map(function(t){var n=e.copy(t);return n.text=t.label,n.value=t.id,n})),i.twoWayMapping={},i.regionMapping&&i.regionMapping.forEach(function(e){i.twoWayMapping[e.label]=e.id,i.twoWayMapping[e.id]=e.label}),i.getCurrentRegion=function(){var e=/region=([a-zA-Z0-9\-]+)/.exec(t.absUrl());if(e)return this.currentRegion=e[1],this.currentRegion;throw"No region found"},i.onRegionChangeRedirectTo=function(e){this.currentRegion!==i.getCurrentRegion()&&t.path(e)},i.getCloudSystem=function(){var e=i.DOMAINS.PUBLIC.NAME,n=t.host();return Object.keys(i.DOMAINS).forEach(function(t){var r=i.DOMAINS[t];-1===n.indexOf(r.SUFFIX)&&-1===n.indexOf(r.GAMMA)||(e=r.NAME)}),e},i}])}(),function(){"use strict";e.module("awsconsole.common").factory("XMLParser",[function(){var e=function(e){if(!Array.isArray(e)){var t=e;e=[],e.push(t)}return e},t=function(e,t,n){return e.substr(0,n)+t+e.substr(n+1)},n={};return n.convertXmlToJson=function(t){var n={};if(t.hasChildNodes()){var r,i,a;for(r=0;r<t.childNodes.length;r+=1)i=t.childNodes.item(r),a=i.nodeName,3!==i.nodeType&&(1===i.nodeType&&1===i.childNodes.length&&3===i.childNodes.item(0).nodeType?void 0!==n[a]?(n[a]=e(n[a]),n[a].push(i.childNodes.item(0).nodeValue)):n[a]=i.childNodes.item(0).nodeValue:void 0===n[a]?n[a]=this.convertXmlToJson(i):(n[a]=e(n[a]),n[a].push(this.convertXmlToJson(i))))}return n},n.convertXmlStringToJson=function(e){var n=new DOMParser,r=e.indexOf("&#");if(r>-1)for(;-1!==r;)e=t(e,"&amp;",r),r=e.indexOf("&#",r+1);var i=n.parseFromString(e,"text/xml");return this.convertXmlToJson(i)},n.jsonToXml=function(e){var t="";if("object"!=typeof e)return t;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(Array.isArray(i))i.forEach(function(e){"string"==typeof e?(t+="<"+r+">",t+=e,t+="</"+r+">"):"object"==typeof i&&null!==i&&(t+="<"+r+">",t+=n.jsonToXml(e),t+="</"+r+">")});else if("string"==typeof i||"number"==typeof i||"boolean"==typeof i)t+="<"+r+">",t+=i.toString(),t+="</"+r+">";else{if("object"!=typeof i||null===i)continue;t+="<"+r+">",t+=n.jsonToXml(i),t+="</"+r+">"}}return t},n}])}()}).call(t,n(0),n(36))},function(e,t,n){"use strict";(function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("storageconsole.common",["pascalprecht.translate","awsconsole.common","ngSanitize","storageconsole.common.filters","storageconsole.common.services","storageconsole.common.constants","storageconsole.common.components","storageconsole.common.translations"]).service("defaultValue",function(){function t(n,r,i){if(e.isDefined(n))if(r.indexOf(".")>=0){var a=r.split("."),o=a.shift();r=a.join("."),e.isDefined(n[o])||(n[o]={}),t(n[o],r,i)}else e.isDefined(n[r])||(n[r]=i)}return t}).config(["$translateProvider","SCAC_TRANSLATIONS_EN","SCAC_TRANSLATIONS_FR","SCAC_TRANSLATIONS_ZH_CN","SCAC_TRANSLATIONS_JA","SCAC_TRANSLATIONS_KO",function(e,t,n,r,i,a){e.translations("en",t),e.translations("zh",r),e.translations("zh_CN",r),e.translations("fr",n),e.translations("ja",i),e.translations("ko",a)}]),e.module("storageconsole.common.filters",["pascalprecht.translate","storageconsole.common.constants"]),e.module("storageconsole.common.services",["awsconsole.common","storageconsole.common.constants"]),e.module("storageconsole.common.components",["storageconsole.common.components.lambdafunctionselector","storageconsole.common.components.kinesisdatastreamselector","storageconsole.common.components.firehosedeliverystreamselector","storageconsole.common.components.resourceSelector","storageconsole.common.components.s3BucketArnSelector","storageconsole.common.components.s3ObjectPathInput"]),e.module("storageconsole.common.components.lambdafunctionselector",["pascalprecht.translate","awsconsole.common","storageconsole.common.services","storageconsole.common.constants"]),e.module("storageconsole.common.components.kinesisdatastreamselector",["pascalprecht.translate","awsconsole.common","storageconsole.common.services","storageconsole.common.constants"]),e.module("storageconsole.common.components.firehosedeliverystreamselector",["pascalprecht.translate","awsconsole.common","storageconsole.common.services","storageconsole.common.constants"]),e.module("storageconsole.common.components.s3BucketArnSelector",["pascalprecht.translate","awsconsole.common","storageconsole.common.constants","storageconsole.common.services","storageconsole.common.components.resourceSelector"]),e.module("storageconsole.common.components.s3ObjectPathInput",["pascalprecht.translate","storageconsole.common.services"]),e.module("storageconsole.common.components.resourceSelector",["pascalprecht.translate","awsconsole.common","storageconsole.common.services","storageconsole.common"]),e.module("storageconsole.common.components.awsRegionSelector",["awsconsole.common"]),e.module("storageconsole.common.translations",[])}(),function(){e.module("storageconsole.common.translations").constant("SCAC_TRANSLATIONS_EN",{scac:{kmsKeyDisplay:{label:{account:"Account",aliasArn:"Alias ARN",description:"Description",keyArn:"Key ARN",keyId:"Key ID",kmsMasterKey:"KMS master key"}},kmsKeySelector:{label:"KMS master key*",defaultKeyPrefix:"(Default) ",enterKeyText:"Enter a key ARN or ID",dropDownPlaceHolder:"Select a key",arnIdLabel:"ARN / ID",description:"Description",account:"Account",keyArn:"Key ARN",copy:"Copy",listKeysErrorHeader:"The KMS key list is unavailable"},datastreamSelector:{stream:{label:"Kinesis stream*",create:"Create new",placeholder:"Choose Kinesis stream",viewStream:"View <b>{{name}}</b> in Kinesis Streams",noStreamsMessage:"You do not have any Kinesis streams in this region.",describingStream:"Retrieving details"},error:{permissions:{header:"Insufficient permissions"},default:{loadingDetailsHeader:"Unable to retrieve Kinesis stream details",listStreamsHeader:"Unable to list Kinesis streams"},internal:{loadingDetailsMessage:"An internal error prevented fetching stream details. If the problem persists, contact AWS Support.",listStreamsMessage:'An internal error prevented listing Kinesis streams. Wait a few minutes and choose the <span class="awsui-icon refresh"></span> below. If the problem persists, contact AWS Support.'}}},lambdaBlueprintTable:{filterPlaceholder:"Filter Lambda blueprints",name:{label:"Lambda blueprint"},description:{label:"Description"}},lambdaFunction:{label:"Lambda function*",deeplink:"View <b>{{functionName}}</b> in Lambda",version:{desc:"Description",runtime:"Runtime",timeout:"Timeout"},error:{header:"Invalid Lambda function"},listFunctions:{error:{message:"There was an issue listing the Lambda functions. Wait a few minutes and choose the refresh icon. If the problem persists, contact AWS Support.",header:"Unable to list Lambda functions"}},listVersions:{error:{header:"Unable to list Lambda function versions",message:"There was an issue listing the versions for the selected Lambda function. Wait a few minutes and choose the refresh icon. If the problem persists, contact AWS Support."}},increaseTimeout:{header:"Increase Lambda function timeout",deeplink:"Go to Lambda configuration"}},createLambdaFunction:{button:"Create new"},lambdaFunctionVersion:{label:"Lambda function version*"},blueprintModal:{header:"Choose Lambda blueprint",description:"Choose the blueprint you want to use to configure your function in Lambda. Then return here, close this dialog box, and choose the newly created Lambda function."},selectLambdaFunction:{placeholder:"Choose Lambda function"},selectLambdaFunctionVersion:{placeholder:"Choose Lambda function version"},close:{button:"Close"},loading:{placeholder:"Loading"},time:{second:{string:"{{value}} second"},seconds:{string:"{{value}} seconds",minutes:{string:"{{minutesString}} {{secondsString}}"}},minute:{string:"{{value}} minute"},minutes:{string:"{{value}} minutes"}}}})}(),function(){e.module("storageconsole.common.translations").constant("SCAC_TRANSLATIONS_FR",{scac:{kmsKeyDisplay:{label:{account:"Compte",aliasArn:"ARN d'alias",description:"Description",keyArn:"ARN de la clé",keyId:"ID de la clé",kmsMasterKey:"Clé principale KMS"}},kmsKeySelector:{label:"Clé principale KMS*",defaultKeyPrefix:"(Par défaut) ",enterKeyText:"Entrez un ARN ou un ID de clé",dropDownPlaceHolder:"Sélectionner une clé",arnIdLabel:"ARN / ID",description:"Description",account:"Compte",keyArn:"ARN de la clé",copy:"Copier",listKeysErrorHeader:"La liste des clés KMS est indisponible"},datastreamSelector:{stream:{label:"Flux Kinesis*",create:"Créer",placeholder:"Choisir un flux Kinesis",viewStream:"Afficher <b>{{name}}</b> dans Kinesis Streams",noStreamsMessage:"Vous n'avez aucun flux Kinesis dans cette région.",describingStream:"Récupération des détails"},error:{permissions:{header:"Autorisations insuffisantes"},default:{loadingDetailsHeader:"Impossible de récupérer les détails de flux Kinesis",listStreamsHeader:"Impossible de répertorier les flux Kinesis"},internal:{loadingDetailsMessage:"Une erreur interne a empêché l'extraction des détails de flux. Si le problème persiste, contactez AWS Support.",listStreamsMessage:"Une erreur interne a empêché l'affichage de la liste des flux Kinesis. Patientez quelques minutes et choisissez l'icône <span class=\"awsui-icon refresh\"></span> ci-dessous. Si le problème persiste, contactez AWS Support."}}},lambdaBlueprintTable:{filterPlaceholder:"Filtrer les plans Lambda",name:{label:"Plan Lambda"},description:{label:"Description"}},lambdaFunction:{label:"Fonction Lambda*",deeplink:"Afficher <b>{{functionName}}</b> dans Lambda",version:{desc:"Description",runtime:"Exécution",timeout:"Délai"},error:{header:"Fonction Lambda non valide"},listFunctions:{error:{message:"Une erreur s'est produite lors de l'affichage de la liste des fonctions Lambda. Patientez quelques minutes, puis choisissez l'icône d'actualisation. Si le problème persiste, contactez AWS Support.",header:"Impossible de répertorier les fonctions Lambda"}},listVersions:{error:{header:"Impossible de répertorier les versions de fonction Lambda",message:"Une erreur s'est produite lors de l'affichage de la liste des versions de la fonction Lambda sélectionnée. Patientez quelques minutes, puis choisissez l'icône d'actualisation. Si le problème persiste, contactez AWS Support."}},increaseTimeout:{header:"Augmenter le délai de la fonction Lambda",deeplink:"Accéder à la configuration Lambda"}},createLambdaFunction:{button:"Créer"},lambdaFunctionVersion:{label:"Version de fonction Lambda*"},blueprintModal:{header:"Choisir un plan Lambda",description:"Choisissez le plan à utiliser pour configurer votre fonction dans Lambda. Revenez ensuite ici, fermez cette boîte de dialogue et choisissez la fonction Lambda nouvellement créée."},selectLambdaFunction:{placeholder:"Choisir une fonction Lambda"},selectLambdaFunctionVersion:{placeholder:"Choisir une version de fonction Lambda"},close:{button:"Fermer"},loading:{placeholder:"Chargement en cours"},time:{second:{string:"{{value}} seconde"},seconds:{string:"{{value}} secondes",minutes:{string:"{{minutesString}} {{secondsString}}"}},minute:{string:"{{value}} minute"},minutes:{string:"{{value}} minutes"}}}})}(),function(){e.module("storageconsole.common.translations").constant("SCAC_TRANSLATIONS_JA",{scac:{kmsKeyDisplay:{label:{account:"アカウント",aliasArn:"エイリアス ARN",description:"説明",keyArn:"キー ARN",keyId:"キー ID",kmsMasterKey:"KMS マスターキー"}},kmsKeySelector:{label:"KMS マスターキー*",defaultKeyPrefix:"(デフォルト) ",enterKeyText:"キーの ARN または ID を入力",dropDownPlaceHolder:"キーの選択",arnIdLabel:"ARN/ID",description:"説明",account:"アカウント",keyArn:"キー ARN",copy:"コピー",listKeysErrorHeader:"KMS キーのリストは利用できません。"}}})}(),function(){e.module("storageconsole.common.translations").constant("SCAC_TRANSLATIONS_KO",{scac:{kmsKeyDisplay:{label:{account:"계정",aliasArn:"별칭 ARN",description:"설명",keyArn:"키 ARN",keyId:"키 ID",kmsMasterKey:"KMS 마스터 키"}},kmsKeySelector:{label:"KMS 마스터 키*",defaultKeyPrefix:"(기본값) ",enterKeyText:"키 ARN 혹은 ID 입력",dropDownPlaceHolder:"키 선택",arnIdLabel:"ARN/ID",description:"설명",account:"계정",keyArn:"키 ARN",copy:"복사",listKeysErrorHeader:"KMS 키 목록을 사용할 수 없습니다."}}})}(),function(){e.module("storageconsole.common.translations").constant("SCAC_TRANSLATIONS_ZH_CN",{scac:{kmsKeyDisplay:{label:{account:"账户",aliasArn:"别名 ARN",description:"描述",keyArn:"密钥 ARN",keyId:"密钥 ID",kmsMasterKey:"KMS 主密钥"}},kmsKeySelector:{label:"KMS 主密钥*",defaultKeyPrefix:"(默认值) ",enterKeyText:"输入一个密钥 ARN 或 ID",dropDownPlaceHolder:"选择密钥",arnIdLabel:"ARN/ID",description:"描述",account:"账户",keyArn:"密钥 ARN",copy:"复制",listKeysErrorHeader:"KMS 密钥列表不可用"},datastreamSelector:{stream:{label:"Kinesis 流*",create:"新建",placeholder:"选择 Kinesis 流",viewStream:"在 Kinesis Streams 中查看 <b>{{name}}</b>",noStreamsMessage:"您在此区域中没有任何 Kinesis 流。",describingStream:"正在检索详细信息"},error:{permissions:{header:"权限不足"},default:{loadingDetailsHeader:"无法检索 Kinesis 流详细信息",listStreamsHeader:"无法列出 Kinesis 流"},internal:{loadingDetailsMessage:"出现内部错误，无法提取流详细信息。如果问题仍存在，请联系 AWS Support。",listStreamsMessage:'出现内部错误，无法列出 Kinesis 流。请稍候几分钟，然后选择下面的 <span class="awsui-icon refresh"></span>。如果问题仍存在，请联系 AWS Support。'}}},lambdaBlueprintTable:{filterPlaceholder:"筛选 Lambda 蓝图",name:{label:"Lambda 蓝图"},description:{label:"描述"}},lambdaFunction:{label:"Lambda 函数*",deeplink:"在 Lambda 中查看 <b>{{functionName}}</b>",version:{desc:"描述",runtime:"运行语言",timeout:"超时"},error:{header:"无效的 Lambda 函数"},listFunctions:{error:{message:"列出 Lambda 函数时出现问题。请等待几分钟，然后选择刷新图标。如果问题仍存在，请联系 AWS Support。",header:"无法列出 Lambda 函数"}},listVersions:{error:{header:"无法列出 Lambda 函数版本",message:"列出选定 Lambda 函数的版本时出现问题。请等待几分钟，然后选择刷新图标。如果问题仍存在，请联系 AWS Support。"}},increaseTimeout:{header:"增加 Lambda 函数超时时间",deeplink:"转到 Lambda 配置"}},createLambdaFunction:{button:"新建"},lambdaFunctionVersion:{label:"Lambda 函数版本*"},blueprintModal:{header:"选择 Lambda 蓝图",description:"选择您要用于在 Lambda 中配置您的函数的蓝图。然后返回到此处，关闭此对话框，并选择新创建的 Lambda 函数。"},selectLambdaFunction:{placeholder:"选择 Lambda 函数"},selectLambdaFunctionVersion:{placeholder:"选择 Lambda 函数版本"},close:{button:"关闭"},loading:{placeholder:"正在加载"},time:{second:{string:"{{value}} 秒"},seconds:{string:"{{value}} 秒",minutes:{string:"{{minutesString}} {{secondsString}}"}},minute:{string:"{{value}} 分钟"},minutes:{string:"{{value}} 分钟"}}}})}(),function(){e.module("storageconsole.common.constants",[]).constant("CLOUD_SYSTEMS",{BJS:"BJS",DCA:"DCA",LCK:"LCK",PDT:"PDT",PUBLIC:"PUBLIC",CN:"CN",GOV:"GOV"}).constant("DEMO_DATA_SAMPLE_LOWERCASE",'{"ticker_symbol":"QXZ", "sector":"HEALTHCARE", "change":-0.05, "price":84.51}').constant("DEMO_DATA_STOCK_PROPERTIES",{TICKER_SYMBOL:"TICKER_SYMBOL",SECTOR:"SECTOR",CHANGE:"CHANGE",PRICE:"PRICE"}).constant("STAGES",{GAMMA:"GAMMA",PROD:"PROD"}).constant("TIME_SPENT_ON_VIEW_IN_MILLISECONDS","TimeSpentOn_").constant("UNKNOWN_PAGE_ID","Unknown").constant("LOCALE",e.element(document.querySelector("meta[property='requestLocale']")).attr("content"))}();var r;!function(e){!function(e){var t=function(){function e(){}return e}();t.AVAILABLE_REGIONS=["ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-west-1","eu-west-2","eu-west-3","us-east-1","us-east-2","us-west-1","us-west-2"],e.GLUE_SERVICE=t;var n=function(){function e(){}return e}();n.GLUE="glue",e.AWS_SERVICES=n;var r=function(){function e(){}return e}();r.ERROR="error",r.INFO="info",r.SUCCESS="success",r.WARNING="warning",e.ERROR_ALERT_TYPES=r;var i=function(){function e(){}return e}();i.$LATEST="$LATEST",e.LAMBDA_FUNCTION_VERSION=i;var a=function(){function e(){}return e}();a.INTEGER=new RegExp(/^\d*$/),a.REDSHIFT_PASSWORD=new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/),a.REDSHIFT_DATABASE=new RegExp("^[a-zA-Z0-9_$]+$"),a.SPLUNK_HEC_TOKEN=new RegExp("[\\da-zA-Z]{8}-[\\da-zA-Z]{4}-[\\da-zA-Z]{4}-[\\da-zA-Z]{4}-[\\da-zA-Z]{12}"),e.REGEX=a;var o=function(){function e(){}return e}();o.INTERNAL_SERVER_ERROR=500,o.FORBIDDEN=403,o.BAD_REQUEST=400,e.STATUS_CODES=o;var s=function(){function e(){}return e}();s.MAX_LIST_PER_CALL=1e4,s.MAX_DESCRIBE_PER_SECOND=5,e.FIREHOSE_LIMITS=s;var c=function(){function e(){}return e}();c.TOP="top",c.RIGHT="right",c.BOTTOM="bottom",c.LEFT="left",e.TOOLTIP_POSITIONS=c;var l=function(){function e(){}return e}();l.AUTO="auto",l.SMALL="small",l.MEDIUM="medium",l.LARGE="large",e.TOOLTIP_SIZE=l;var u=function(){function e(){}return e}();u.TEXT="text",u.PASSWORD="password",u.SEARCH="search",e.TEXT_FIELD_TYPE=u;var d=function(){function e(){}return e}();d.REFRESH_KINESIS_STREAMS_CLICK="refreshStreams",d.SELECTED_KINESIS_STREAM="selectStream",d.REFRESH_DELIVERY_STREAMS_CLICK="refreshDeliveryStreams",d.SELECTED_DELIVERY_STREAM="selectDeliveryStream",e.METRICS=d}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){!function(e){var t=function(){function e(){}return e}();t.MIN_LEN=1,e.LAMBDA_FUNCTION_ARN_RESTRICTIONS=t;var n=function(){function e(){}return e}();n.DEFAULT="lambdaFunction.error.message",e.LAMBDA_FUNCTION_ARN_ERROR_I18N_KEYS=n}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){!function(t){!function(t){var n=e.core.ERROR_ALERT_TYPES,r=function(){function e(e,t,r,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===r&&(r=!1),void 0===i&&(i=n.ERROR),this.header=e,this.message=t,this.dismissible=r,this.alertType=i}return e}();t.NileAwsUIAlert=r}(t.nileAwsuiAlert||(t.nileAwsuiAlert={}))}(e.components||(e.components={}))}(r||(r={}));var r;!function(e){!function(t){!function(t){var n=e.core.TOOLTIP_SIZE,r=e.core.TOOLTIP_POSITIONS,i=function(){function e(e,t,i,a,o,s){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),void 0===a&&(a=n.SMALL),void 0===o&&(o=r.RIGHT),void 0===s&&(s=!1),this.buttonValue=e,this.buttonLabel=t,this.tooltipText=i,this.tooltipSize=a,this.tooltipPosition=o,this.isDisabled=s}return e}();t.RadioButtonWithTooltip=i}(t.radioButtonWithTooltip||(t.radioButtonWithTooltip={}))}(e.components||(e.components={}))}(r||(r={}));var r;!function(e){!function(e){!function(n){var r=function(){function e(e,t,n){this.value=e,this.errorKey=t,this.errorMessageTranslationValues=n}return e}();n.LengthValidationParams=r;var i=function(){function e(e,t,n){var r=this;this.minLength=e,this.errorKey=t,this.errorMessageTranslationValues=n,this.validate=function(e){return!!e&&e.length>=r.minLength}}return e}();n.MinLengthValidator=i;var a=function(){function e(e,t,n){var r=this;this.maxLength=e,this.errorKey=t,this.errorMessageTranslationValues=n,this.validate=function(e){return!e||e.length<=r.maxLength}}return e}();n.MaxLengthValidator=a;var o=function(){function e(e,t){this.value=e,this.errorKey=t}return e}();n.PatternValidationParams=o;var s=function(){function e(e,t,n){var r=this;this.regEx=e,this.errorKey=t,this.errorMessageTranslationValues=n,this.validate=function(e){return r.regEx.test(e)}}return e}();n.PatternValidator=s;var c=function(){function e(e,t,n,r){this.min=e,this.max=t,this.errorKey=n,this.errorMessageTranslationValues=r}return e}();n.RangeValidationParams=c;var l=function(){function n(n,r,i,a){var o=this;this.min=n,this.max=r,this.errorKey=i,this.errorMessageTranslationValues=a,this.intRegEx=e.REGEX.INTEGER,this.validate=function(e){return o.intRegEx.test(e)&&t.inRange(parseInt(e,10),o.min,o.max+1)}}return n}();n.RangeValidator=l}(e.model||(e.model={}))}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){!function(t){!function(t){var n=e.components.nileAwsuiAlert.NileAwsUIAlert,r=function(){function e(e,t,r,i,a){void 0===e&&(e=[]),void 0===t&&(t=""),void 0===r&&(r=!1),void 0===i&&(i=new n),void 0===a&&(a=""),this.list=e,this.selectedItem=t,this.updatingList=r,this.errorAlert=i,this.inlineErrorMessage=a}return e}();t.InputSelector=r}(t.model||(t.model={}))}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){!function(e){!function(e){var t=function(){function e(e,t,n,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=!1),void 0===r&&(r=!1),this.value=e,this.text=t,this.disabled=n,this.separator=r}return e}();e.NileAwsUISelectItem=t}(e.model||(e.model={}))}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){!function(t){!function(t){var n=e.core.LAMBDA_FUNCTION_ARN_RESTRICTIONS,r=e.core.LAMBDA_FUNCTION_ARN_ERROR_I18N_KEYS,i=e.core.model.MinLengthValidator,a=function(){function e(e,t,a,o,s,c){void 0===e&&(e=""),void 0===t&&(t=""),void 0===a&&(a=""),void 0===o&&(o=""),void 0===s&&(s=""),void 0===c&&(c=0);var l=this;this.name=e,this.version=t,this.arn=a,this.description=o,this.runtime=s,this.timeOutInSeconds=c,this.validationMessageKey="",this.lambdaFunctionValidation=new i(n.MIN_LEN,r.DEFAULT),this.validate=function(){return l.lambdaFunctionValidation.validate(l.arn)?(l.validationMessageKey="",!0):(l.validationMessageKey=l.lambdaFunctionValidation.errorKey,!1)}}return e.CLONE=function(t){return new e(t.name,t.version,t.arn,t.description,t.runtime,t.timeOutInSeconds)},e}();t.LambdaFunction=a;var o=function(){function e(){}return e}();o.checkIfLambdaFunctionsAreEqual=function(e,t){expect(e.name).toBe(t.name),expect(e.version).toBe(t.version),expect(e.arn).toBe(t.arn),expect(e.description).toBe(t.description),expect(e.runtime).toBe(t.runtime),expect(e.timeOutInSeconds).toBe(t.timeOutInSeconds)},t.LAMBDA_FUNCTION_SPEC_HELPER=o}(t.lambda||(t.lambda={}))}(e.core||(e.core={}))}(r||(r={}));var r;!function(e){e.core||(e.core={})}(r||(r={})),function(){e.module("storageconsole.common").factory("EvalUtil",function(){function e(e,n){try{var r=n.$eval(e);if(!t.isNil(r))return r}catch(e){}return e}return{tryEvalAttr:e}})}();var r;!function(e){!function(e){!function(e){var t=function(){function e(e,t){this.name=e,this.description=t}return e}();e.LambdaBlueprintTableRow=t}(e.lambdaBlueprintTable||(e.lambdaBlueprintTable={}))}(e.components||(e.components={}))}(r||(r={})),function(){e.module("storageconsole.common.kinesisnavbar",["AWS-DBUX-FAC","awsconsole.common","pascalprecht.translate","storageconsole.common.services"])}.call(void 0);var r;!function(e){!function(e){!function(e){e.RESOURCE_SELECTOR_DIRECTIVE_SCOPE_BASE={selectedResource:"=",disabled:"<",onChange:"&?",validationMessageKeys:"<"},e.AWS_RESOURCE_SELECTOR_DIRECTIVE_SCOPE_BASE=t.assign({},e.RESOURCE_SELECTOR_DIRECTIVE_SCOPE_BASE,{region:"<",triggerLoad:"=?",delayLoad:"<?"});var n=function(){function e(e){void 0===e&&(e=""),this.noResourceSelectedMessageKey=e}return e}();e.ResourceValidationMessageKeys=n}(e.resourceSelector||(e.resourceSelector={}))}(e.components||(e.components={}))}(r||(r={})),function(){function t(e){var t={"scac.alertWithApiResponse.apiResponse":"API response"},n={},r={},i={},a={};e.translations("en",t),e.translations("fr",n),e.translations("ja",r),e.translations("ko",i),e.translations("zh",a),e.translations("zh_CN",a)}function n(){return{bindToController:!0,controller:r,controllerAs:"vm",restrict:"E",scope:{type:"@",dismissible:"@",header:"@",content:"@",apiResponseText:"@"},templateUrl:"storageConsoleCommon/components/alert-with-api-response/alert-with-api-response.html"}}function r(){var e=this;e.showApiResponse=!1,e.toggleShowApiResponse=function(){return e.showApiResponse=!e.showApiResponse}}t.$inject=["$translateProvider"],e.module("storageconsole.common").config(t).controller("alertWithApiResponseController",r).directive("alertWithApiResponse",n)}.call(void 0);var r;!function(n){!function(r){!function(r){var i=n.components.nileAwsuiAlert.NileAwsUIAlert,a=function(){function e(e,t,n,r,i,a){this.regionsAvailable=e,this.labelKey=t,this.placeholderKey=n,this.disabled=r,this.selectMetricName=i,this.pageContext=a}return e}();r.AwsRegionSelectorConfig=a;var o=function(){function n(n,r){var a=this;this.$q=n,this.Region=r;var o=this;this.model={loadResources:function(){return a.$q.when(e.copy(a.Region.regionMapping))},onLoadSuccess:function(e){return{resourceItems:t.map(t.intersectionWith(e,a.regionsAvailable,function(e,t){return e.value===t}),function(e){return{value:e.value,text:e.text,disabled:!1,separator:!1}})}},onLoadFailure:function(e){return{awsUiAlert:new i}},text:{controlGroup:{label:this.labelKey},select:{placeholder:this.placeholderKey},validationMessageKeys:{getNoResourceSelectedMessageKey:function(){return o.validationMessageKeys.noResourceSelectedMessageKey}}},disabled:function(){return o.disabled||!1},delayLoad:function(){return!1},onChange:function(){return o.onChange()},metricNames:{select:this.selectMetricName,context:o.pageContext},disableRefresh:!0}}return n.$inject=["$q","Region"],n}();r.AwsRegionSelectorController=o,e.module("storageconsole.common.components.awsRegionSelector").controller("awsRegionSelectorController",o)}(r.awsRegionResourceSelector||(r.awsRegionResourceSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(n){!function(r){!function(r){function i(){return{bindToController:!0,controller:"awsRegionSelectorController",controllerAs:"vm",restrict:"E",scope:t.assign({},a,{regionsAvailable:"<",labelKey:"<",placeholderKey:"<",selectMetricName:"<",pageContext:"<"}),templateUrl:"storageConsoleCommon/components/aws-region-selector/aws-region-selector.html"}}var a=n.components.resourceSelector.RESOURCE_SELECTOR_DIRECTIVE_SCOPE_BASE;e.module("storageconsole.common.components.awsRegionSelector").directive("awsRegionSelector",i)}(r.awsRegionResourceSelector||(r.awsRegionResourceSelector={}))}(n.components||(n.components={}))}(r||(r={})),function(){e.module("storageconsole.common").directive("bindCompiledHtml",["$compile","EvalUtil",function(e,t){return{restrict:"A",link:function(n,r,i){n.$watch(function(){return t.tryEvalAttr(i.bindCompiledHtml,n)},function(t){r.html(t),e(r.contents())(n)})}}}])}(),function(){function t(){return{bindToController:!0,controller:n,controllerAs:"vm",restrict:"E",scope:{text:"=",color:"=",iconClass:"="},templateUrl:"storageConsoleCommon/components/displayStatusLabel/displayStatusLabel.tpl.html"}}function n(){}e.module("storageconsole.common").directive("displayStatusLabel",t)}.call(void 0);var r;!function(n){!function(r){!function(r){function i(e){var t={"scac.deliveryStream.label":"Kinesis Firehose delivery stream*","scac.createDeliveryStream":"Create new","scac.firehoseDeliveryStreamSelector.placeholder":"Choose delivery stream","scac.firehoseDeliveryStreamSelector.deeplink":"View <b>{{name}}</b> in Kinesis Firehose","scac.firehoseDeliveryStreamSelector.noDeliveryStreamsMessage":"You do not have any Kinesis Firehose delivery streams in this region.","scac.firehoseDeliveryStreamSelector.error.loadingDetailsHeader":"Unable to retrieve details for this delivery stream","scac.firehoseDeliveryStreamSelector.error.streamAsASource":"Delivery stream <b>{{deliveryStreamName}}</b> is connected to Kinesis stream <b>{{dataStreamName}}</b>. Delivery streams that receive records from a Kinesis stream cannot connect to an Analytics application. Instead chose the connected Kinesis stream","scac.firehoseDeliveryStreamSelector.describingDeliveryStream":"Retrieving details","scac.firehoseDeliveryStreamSelector.permissionsError.header":"Insufficient permissions","scac.datastreamSelector.error.default.loadingDetailsHeader":"Unable to retrieve Kinesis Firehose delivery stream details","scac.firehoseDeliveryStreamSelector.internalError.loadingDetailsMessage":"An internal error prevented fetching delivery stream details. If the problem persists, contact AWS Support.","scac.firehoseDeliveryStreamSelector.error.listDeliveryStreamsHeader":"Unable to list Kinesis Firehose delivery streams","scac.firehoseDeliveryStreamSelector.internalError.listDeliveryStreamsMessage":'An internal error prevented listing Kinesis Firehose delivery streams. Wait a few minutes and choose the <span class="awsui-icon refresh"></span> below. If the problem persists, contact AWS Support.',"scac.firehoseDeliveryStreamSelector.permissionsError.listDeliveryStreamsMessage":'Before you can select a Firehose delivery stream, you or your AWS administrator must update your IAM permissions to allow the firehose:ListDeliveryStreams action. Choose the <span class="awsui-icon refresh"></span> below to refresh the list of Kinesis Firehose delivery streams once you have been granted permissions.',"scac.firehoseDeliveryStreamSelector.permissionsError.loadDeliveryStreamsMessage":'Before you can select a Firehose delivery stream, you or your AWS administrator must update your IAM permissions to allow the firehose:DescribeDeliveryStream action. Choose the <span class="awsui-icon refresh"></span> below to refresh the list of Kinesis Firehose delivery streams once you have been granted permissions.'},n={},r={"scac.deliveryStream.label":"Flux de transmission Kinesis Firehose*","scac.createDeliveryStream":"Créer","scac.firehoseDeliveryStreamSelector.placeholder":"Choisir le flux de transmission","scac.firehoseDeliveryStreamSelector.deeplink":"Afficher <b>{{name}}</b> dans Kinesis Firehose","scac.firehoseDeliveryStreamSelector.noDeliveryStreamsMessage":"Vous n'avez aucun flux de transmission Kinesis Firehose dans cette région.","scac.firehoseDeliveryStreamSelector.error.loadingDetailsHeader":"Impossible de récupérer les détails de ce flux de transmission","scac.firehoseDeliveryStreamSelector.error.streamAsASource":"Le flux de transmission <b>{{deliveryStreamName}}</b> est connecté au flux Kinesis <b>{{dataStreamName}}</b>. Les flux de transmission qui reçoivent des enregistrements d'un flux Kinesis ne peuvent pas se connecter à une application Analytics. Choisissez plutôt le flux Kinesis connecté","scac.firehoseDeliveryStreamSelector.describingDeliveryStream":"Récupération des détails","scac.firehoseDeliveryStreamSelector.permissionsError.header":"Autorisations insuffisantes","scac.datastreamSelector.error.default.loadingDetailsHeader":"Impossible de récupérer les détails de flux de transmission flux Kinesis Firehose","scac.firehoseDeliveryStreamSelector.internalError.loadingDetailsMessage":"Une erreur interne a empêché l'extraction des détails de flux de transmission. Si le problème persiste, contactez AWS Support.","scac.firehoseDeliveryStreamSelector.error.listDeliveryStreamsHeader":"Impossible de répertorier les flux de transmission Kinesis Firehose","scac.firehoseDeliveryStreamSelector.internalError.listDeliveryStreamsMessage":"Une erreur interne a empêché l'affichage de la liste des flux de transmission Kinesis Firehose. Patientez quelques minutes et choisissez l'icône <span class=\"awsui-icon refresh\"></span> ci-dessous. Si le problème persiste, contactez AWS Support.","scac.firehoseDeliveryStreamSelector.permissionsError.listDeliveryStreamsMessage":"Avant que vous puissiez sélectionner un flux de transmission Firehose, vous ou votre administrateur AWS devez mettre à jour vos autorisations IAM afin d'autoriser l'action firehose:ListDeliveryStreams. Choisissez l'cône <span class=\"awsui-icon refresh\"></span> ci-dessous pour actualiser la liste des flux de transmission Kinesis Firehose une fois que vous avez reçu les autorisations.","scac.firehoseDeliveryStreamSelector.permissionsError.loadDeliveryStreamsMessage":"Avant que vous puissiez sélectionner un flux de transmission Firehose, vous ou votre administrateur AWS devez mettre à jour vos autorisations IAM afin d'autoriser l'action firehose:DescribeDeliveryStream. Choisissez l'cône <span class=\"awsui-icon refresh\"></span> ci-dessous pour actualiser la liste des flux de transmission Kinesis Firehose une fois que vous avez reçu les autorisations."},i={},a={};e.translations("en",t),e.translations("zh",n),e.translations("zh_CN",n),e.translations("fr",r),e.translations("ja",i),e.translations("ko",a)}i.$inject=["$translateProvider"];var a=n.core.METRICS,o=n.core.model.NileAwsUISelectItem,s=n.core.model.InputSelector,c=n.components.nileAwsuiAlert.NileAwsUIAlert,l=n.core.STATUS_CODES,u=function(){function e(n,r,i,u,d,p,f,g,m){var h=this;this.$q=n,this.$translate=r,this.AwsArn=i,this.AwsUrlsService=u,this.AwsResource=d,this.FirehoseService=p,this.ProxyErrorAdapter=f,this.Region=g,this.SCACMetricsService=m,this.firehoseDeliveryStreamSelector=new s,this.errorAlert=new c,this.loadingDeliveryStreamDetails=!1,this.showNoDeliveryStreamsMessage=!1,this.refreshDeliveryStreams=function(){h.SCACMetricsService.trackClick(a.REFRESH_DELIVERY_STREAMS_CLICK,h.pageContext),h.listDeliveryStreams()},this.selectDeliveryStream=function(){h.SCACMetricsService.trackClick(a.SELECTED_DELIVERY_STREAM,h.pageContext),h.selectedDeliveryStreamName=h.firehoseDeliveryStreamSelector.selectedItem,h.loadDeliveryStreamDetailsAndExecuteCallbacks()},this.disableFirehoseDeliveryStreamSelector=function(){return h.firehoseDeliveryStreamSelector.updatingList||t.isEmpty(h.firehoseDeliveryStreamSelector.list)},this.getDeliveryStreamDeeplink=function(){return h.selectedDeliveryStreamResource.deepLink},this.listDeliveryStreams=function(){return h.firehoseDeliveryStreamSelector=new s([],"",!0),h.errorAlert=new c,h.showNoDeliveryStreamsMessage=!1,h.selectedDeliveryStreamResource=void 0,h.FirehoseService.listDeliveryStreamsWithPagination().then(function(n){h.firehoseDeliveryStreamSelector.list=t.map(n.reducedResponse,function(e){return new o(e,e)}),0===h.firehoseDeliveryStreamSelector.list.length&&(h.showNoDeliveryStreamsMessage=!0,h.firehoseDeliveryStreamSelector.inlineErrorMessage=h.translate(e.TRANSLATION_KEYS.NO_DELIVERY_STREAMS_MESSAGE)),h.handleAlreadySelectedDeliveryStream()}).catch(function(t){h.surfaceError(t,h.errorAlert,e.TRANSLATION_KEYS.LIST_DELIVERY_STREAMS_ERROR_HEADER,e.TRANSLATION_KEYS.LIST_DELIVERY_STREAMS_INTERNAL_ERROR,e.TRANSLATION_KEYS.LIST_DELIVERY_STREAM_DETAILS_PERMISSIONS_ERROR)}).finally(function(){h.firehoseDeliveryStreamSelector.updatingList=!1})},this.loadDeliveryStreamDetailsAndExecuteCallbacks=function(){return h.describeAndCacheDeliveryStream().then(function(){h.surfaceInlineErrorIfUsingStreamAsASource(),h.onDescribeDeliveryStreamSuccess&&h.onDescribeDeliveryStreamSuccess({deliveryStreamDescription:h.deliveryStreamDescription})}).catch(function(e){h.onDescribeDeliveryStreamFailure&&h.onDescribeDeliveryStreamFailure({error:e})})},this.isDeliveryStreamUsingStreamAsASource=function(){return"KinesisStreamAsSource"===h.deliveryStreamDescription.DeliveryStreamType},this.describeAndCacheDeliveryStream=function(){return h.errorAlert=new c,h.firehoseDeliveryStreamSelector.inlineErrorMessage="",h.selectedDeliveryStreamResource=void 0,h.deliveryStreamDescription=void 0,h.loadingDeliveryStreamDetails=!0,h.FirehoseService.describeDeliveryStream({DeliveryStreamName:h.selectedDeliveryStreamName}).then(function(e){h.deliveryStreamDescription=e.response.DeliveryStreamDescription,h.selectedDeliveryStreamResource=new h.AwsResource(e.response.DeliveryStreamDescription.DeliveryStreamARN)}).catch(function(t){return h.surfaceError(t,h.errorAlert,e.TRANSLATION_KEYS.LOAD_DELIVERY_STREAM_DETAILS_ERROR_HEADER,e.TRANSLATION_KEYS.LOAD_DELIVERY_STREAM_DETAILS_INTERNAL_ERROR,e.TRANSLATION_KEYS.LOAD_DELIVERY_STREAM_DETAILS_PERMISSIONS_ERROR),h.$q.reject(t)}).finally(function(){h.loadingDeliveryStreamDetails=!1})},this.surfaceError=function(t,n,r,i,a){var o=h.ProxyErrorAdapter.proxyErrorHandler(t);n.header=h.translate(r),o.status>=l.INTERNAL_SERVER_ERROR?n.message=h.translate(i):"AccessDeniedException"===o.errorType?(n.header=h.translate(e.TRANSLATION_KEYS.PERMISSIONS_ERROR_HEADER),n.message=h.translate(a)):n.message=o.errorMessage||h.translate(i)},this.surfaceInlineErrorIfUsingStreamAsASource=function(){if(h.isDeliveryStreamUsingStreamAsASource()){var t=new h.AwsArn(h.deliveryStreamDescription.Source.KinesisStreamSourceDescription.KinesisStreamARN).resourceName;h.firehoseDeliveryStreamSelector.inlineErrorMessage=h.translate(e.TRANSLATION_KEYS.STREAMS_AS_A_SOURCE_ERROR_MESSAGE,{deliveryStreamName:h.selectedDeliveryStreamName,dataStreamName:t})}},this.translate=r.instant,this._createDeliveryStreamDeepLink=this.AwsUrlsService.getConsoleServiceUrl(e.FIREHOSE_SERVICE_NAME,this.Region.getCurrentRegion(),e.CREATE_DELIVERY_STREAM_PATH),this.listDeliveryStreams()}return e.$inject=["$q","$translate","AwsArn","AwsUrlsService","AwsResource","FirehoseService","ProxyErrorAdapter","Region","SCACMetricsService"],Object.defineProperty(e.prototype,"createDeliveryStreamDeepLink",{get:function(){return this._createDeliveryStreamDeepLink},enumerable:!0,configurable:!0}),e.prototype.handleAlreadySelectedDeliveryStream=function(){var e=this;t.find(this.firehoseDeliveryStreamSelector.list,function(t){return t.value===e.selectedDeliveryStreamName})?(this.firehoseDeliveryStreamSelector.selectedItem=this.selectedDeliveryStreamName,this.loadDeliveryStreamDetailsAndExecuteCallbacks()):this.selectedDeliveryStreamName&&(this.selectedDeliveryStreamName="",this.onDeliveryStreamNotFound&&this.onDeliveryStreamNotFound())},e}();u.CREATE_DELIVERY_STREAM_PATH="#/wizard/nameAndSource",u.FIREHOSE_SERVICE_NAME="firehose",u.TRANSLATION_KEYS={LOAD_DELIVERY_STREAM_DETAILS_ERROR_HEADER:"scac.firehoseDeliveryStreamSelector.error.loadingDetailsHeader",LOAD_DELIVERY_STREAM_DETAILS_INTERNAL_ERROR:"scac.firehoseDeliveryStreamSelector.internalError.loadingDetailsMessage",LOAD_DELIVERY_STREAM_DETAILS_PERMISSIONS_ERROR:"scac.firehoseDeliveryStreamSelector.permissionsError.loadDeliveryStreamsMessage",LIST_DELIVERY_STREAMS_ERROR_HEADER:"scac.firehoseDeliveryStreamSelector.error.listDeliveryStreamsHeader",LIST_DELIVERY_STREAMS_INTERNAL_ERROR:"scac.firehoseDeliveryStreamSelector.internalError.listDeliveryStreamsMessage",NO_DELIVERY_STREAMS_MESSAGE:"scac.firehoseDeliveryStreamSelector.noDeliveryStreamsMessage",PERMISSIONS_ERROR_HEADER:"scac.firehoseDeliveryStreamSelector.permissionsError.header",LIST_DELIVERY_STREAM_DETAILS_PERMISSIONS_ERROR:"scac.firehoseDeliveryStreamSelector.permissionsError.listDeliveryStreamsMessage",STREAMS_AS_A_SOURCE_ERROR_MESSAGE:"scac.firehoseDeliveryStreamSelector.error.streamAsASource"},r.FirehoseDeliveryStreamSelectorController=u,e.module("storageconsole.common.components.firehosedeliverystreamselector").config(i).controller("FirehoseDeliveryStreamSelectorController",u)}(r.firehoseDeliveryStreamSelector||(r.firehoseDeliveryStreamSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"FirehoseDeliveryStreamSelectorController",controllerAs:"vm",restrict:"E",scope:{selectedDeliveryStreamName:"=",deliveryStreamNamesToFilter:"=?",onDescribeDeliveryStreamSuccess:"&?",onDescribeDeliveryStreamFailure:"&?",onDeliveryStreamNotFound:"&?",pageContext:"@"},templateUrl:"storageConsoleCommon/components/firehose-delivery-stream-selector/firehose-delivery-stream-selector.html"}}e.module("storageconsole.common.components.firehosedeliverystreamselector").directive("firehoseDeliveryStreamSelector",n)}(t.firehoseDeliveryStreamSelector||(t.firehoseDeliveryStreamSelector={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(e){!function(e){e.firehoseDeliveryStreamSelector||(e.firehoseDeliveryStreamSelector={})}(e.components||(e.components={}))}(r||(r={}));var r;!function(n){!function(r){!function(r){var i=n.components.nileAwsuiAlert.NileAwsUIAlert,a=n.core.model.NileAwsUISelectItem,o=n.core.STATUS_CODES,s=n.core.METRICS,c=function(){function e(n,r,c,l,u,d,p,f,g){var m=this;this.$q=n,this.$translate=r,this.AwsResource=c,this.AwsUrlsService=l,this.KinesisService=u,this.KmsKeyService=d,this.SCACMetricsService=p,this.ProxyErrorAdapter=f,this.Region=g,this.createStreamDeepLink="",this.loadingListStreams=!1,this.loadingStreamDetails=!1,this.showNoStreamsMessage=!1,this.refreshStreams=function(){return m.SCACMetricsService.trackClick(s.REFRESH_KINESIS_STREAMS_CLICK,m.pageContext),m.listStreams()},this.selectStream=function(){m.SCACMetricsService.trackClick(s.SELECTED_KINESIS_STREAM,m.pageContext),m.loadStreamDetailsAndExecuteCallbacks()},this.listStreams=function(){return m.errorAlert=new i,m.awsUiStreams=[],m.showNoStreamsMessage=!1,m.loadingListStreams=!0,m.invalidSelectionErrorKey=void 0,m.selectedStreamResource=void 0,m.KinesisService.listStreamsWithPagination().then(function(e){return m.awsUiStreams=t.map(e.reducedResponse,function(e){return new a(e,e)}),m.showNoStreamsMessage=0===m.awsUiStreams.length,t.find(m.awsUiStreams,function(e){return e.value===m.selectedStreamName})?m.loadStreamDetailsAndExecuteCallbacks():m.onStreamNotFound&&m.onStreamNotFound(),m.$q.when()}).catch(function(t){return m.surfaceErrorAndReject(t,m.errorAlert,e.TRANSLATION_KEYS.LIST_STREAMS_ERROR_HEADER,e.TRANSLATION_KEYS.LIST_STREAMS_INTERNAL_ERROR)}).finally(function(){m.loadingListStreams=!1})},this.loadStreamDetailsAndExecuteCallbacks=function(){m.invalidSelectionErrorKey=void 0,m.loadStreamDetails().then(function(){m.onStreamDescribeSuccess&&m.onStreamDescribeSuccess({streamDescription:m.streamDescription})}).catch(function(e){m.onStreamDescribeFailure&&m.onStreamDescribeFailure({error:e})})},this.loadStreamDetails=function(){return m.loadingStreamDetails=!0,m.streamDescription=void 0,m.describeStream().then(function(e){return m.getArnFromKmsKeyIdIfExists(e.KeyId).then(function(t){return e.KeyId=t,m.streamDescription=e,m.selectedStreamResource=new m.AwsResource(m.streamDescription.StreamARN),m.$q.when()})}).finally(function(){m.loadingStreamDetails=!1})},this.describeStream=function(){return m.errorAlert=new i,m.selectedStreamResource=void 0,m.KinesisService.describeStream({StreamName:m.selectedStreamName}).then(function(e){return e.response.StreamDescription}).catch(function(t){return m.surfaceErrorAndReject(t,m.errorAlert,e.TRANSLATION_KEYS.LOAD_STREAM_DETAILS_ERROR_HEADER,e.TRANSLATION_KEYS.LOAD_STREAM_DETAILS_INTERNAL_ERROR)})},this.getArnFromKmsKeyIdIfExists=function(t){return t?m.KmsKeyService.getKeyOrAliasArn(t).catch(function(t){return m.surfaceErrorAndReject(t,m.errorAlert,e.TRANSLATION_KEYS.LOAD_STREAM_DETAILS_ERROR_HEADER,e.TRANSLATION_KEYS.LOAD_STREAM_DETAILS_INTERNAL_ERROR)}):m.$q.when(t)},this.surfaceErrorAndReject=function(t,n,r,i){var a=m.ProxyErrorAdapter.proxyErrorHandler(t);return n.header=m.translate(r),a.status>=o.INTERNAL_SERVER_ERROR?n.message=m.translate(i):(a.errorType===e.ACCESS_DENIED_ERROR_TYPE&&(n.header=m.translate(e.TRANSLATION_KEYS.PERMISSIONS_ERROR_HEADER)),n.message=a.errorMessage||m.translate(i)),m.$q.reject(t)},this.getCreateStreamDeeplink=function(){return m.AwsUrlsService.getConsoleServiceUrl(e.KINESIS_SERVICE_NAME,m.Region.getCurrentRegion(),e.CREATE_STREAM_PATH)},this.translate=r.instant,this.createStreamDeepLink=this.getCreateStreamDeeplink(),this.listStreams()}return e.$inject=["$q","$translate","AwsResource","AwsUrlsService","KinesisService","KmsKeyService","SCACMetricsService","ProxyErrorAdapter","Region"],e.prototype.getStreamsDropdownInlineError=function(){return this.showNoStreamsMessage?this.translate(e.TRANSLATION_KEYS.NO_STREAMS_MESSAGE):this.errorAlert.message?"":this.translate(this.invalidSelectionErrorKey)},e}();c.ACCESS_DENIED_ERROR_TYPE="AccessDeniedException",c.CREATE_STREAM_PATH="#/streams/create",c.KINESIS_SERVICE_NAME="kinesis",c.TRANSLATION_KEYS={LOAD_STREAM_DETAILS_ERROR_HEADER:"scac.datastreamSelector.error.default.loadingDetailsHeader",LOAD_STREAM_DETAILS_INTERNAL_ERROR:"scac.datastreamSelector.error.internal.loadingDetailsMessage",LIST_STREAMS_ERROR_HEADER:"scac.datastreamSelector.error.default.listStreamsHeader",LIST_STREAMS_INTERNAL_ERROR:"scac.datastreamSelector.error.internal.listStreamsMessage",NO_STREAMS_MESSAGE:"scac.datastreamSelector.stream.noStreamsMessage",PERMISSIONS_ERROR_HEADER:"scac.datastreamSelector.error.permissions.header"},r.KinesisStreamSelectorController=c,e.module("storageconsole.common.components.kinesisdatastreamselector").controller("KinesisDataStreamSelectorController",c)}(r.kinesisDataStreamSelector||(r.kinesisDataStreamSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"KinesisDataStreamSelectorController",controllerAs:"vm",restrict:"E",scope:{selectedStreamName:"=",invalidSelectionErrorKey:"=?",streamNamesToFilter:"=?",onStreamDescribeSuccess:"&?",onStreamDescribeFailure:"&?",onStreamNotFound:"&?",pageContext:"@"},templateUrl:"storageConsoleCommon/components/kinesis-data-stream-selector/kinesis-data-stream-selector.html"}}e.module("storageconsole.common.components.kinesisdatastreamselector").directive("kinesisDataStreamSelector",n)}(t.kinesisDataStreamSelector||(t.kinesisDataStreamSelector={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(e){!function(e){e.kinesisDataStreamSelector||(e.kinesisDataStreamSelector={})}(e.components||(e.components={}))}(r||(r={})),function(){function r(e,r,i,a,o,s){function c(){return t.map(o,function(e){return{service:e,label:e,url:d(e),isCurrentConsoleName:f(e)&&!m(),released:g(e),unreleasedToolTip:p(e)}})}function l(){var e=s.getCurrentRegion(),t=S[o.STREAMS];return{url:i.getConsoleServiceUrl(t.path,e,A),isCurrent:m()}}function u(){return{url:i.getLocalizedMarketingUrl("kinesis/whats-new"),isEnabled:a.isWhatsNewEnabled()}}function d(e){var t=s.getCurrentRegion(),n=S[e];return i.getConsoleServiceUrl(n.path,t,n.hash)}function p(e){var t=y[e];if(t)return E("scac.kinesisnavbar."+t+"NotSupported")}function f(e){var t=r.location.pathname;return S[e].path===t.split("/")[1]}function g(e){return e===o.STREAMS||a.isKinesisServiceEnabled(e)}function m(){return f(o.STREAMS)&&r.location.hash===A}var h,b,v={buildNavEntries:c,buildDashboardEntry:l,buildWhatsNew:u,isShown:!0},E=e.instant,S=(h={},n(h,o.STREAMS,{path:"kinesis",hash:"#/streams/list"}),n(h,o.FIREHOSE,{path:"firehose",hash:""}),n(h,o.ANALYTICS,{path:"kinesisanalytics",hash:""}),n(h,o.VIDEO_STREAMS,{path:"kinesisvideo",hash:""}),h),y=(b={},n(b,o.FIREHOSE,"firehose"),n(b,o.ANALYTICS,"analytics"),n(b,o.VIDEO_STREAMS,"kvs"),b),A="#/dashboard";return v}r.$inject=["$translate","$window","AwsUrlsService","KinesisNavBarFeatureService","KINESIS_NAV_SERVICES","Region"],e.module("storageconsole.common.kinesisnavbar").service("KinesisNavBarData",r)}.call(void 0),function(){function t(){return{bindToController:!0,controller:"KinesisNavBarController",controllerAs:"vm",restrict:"E",scope:{isShown:"=?",pageContext:"@?"},templateUrl:"storageConsoleCommon/components/kinesis-nav-bar/kinesis-nav-bar.html"}}function n(e,t,n,r){function i(){s.isShown=!s.isShown,n.isShown=s.isShown}function a(){try{return t.get("RouteProviderUtilities").getPageContextOfCurrentRoute()}catch(e){return s.pageContext}}function o(){s.dashboard=n.buildDashboardEntry(),s.entries=n.buildNavEntries(),s.whatsNew=n.buildWhatsNew()}var s=this;o(),e.$on("$locationChangeSuccess",o),s.heading="Amazon Kinesis",s.isShown=n.isShown,s.METRICS=r,s.toggleShowKinesisNavigation=i,s.getPageContext=a}function r(e){var t={"scac.kinesisnavbar.firehoseNotSupported":"Firehose is not supported in this region","scac.kinesisnavbar.analyticsNotSupported":"Analytics is not supported in this region","scac.kinesisnavbar.kvsNotSupported":"Video Streams is not supported in this region","scac.kinesisnavbar.dashboardText":"Dashboard","scac.kinesisnavbar.whatsNewText":"What's new","scac.kinesisnavbar.externalResources":"External resources"},n={"scac.kinesisnavbar.firehoseNotSupported":"Firehose n'est pas pris en charge dans cette région","scac.kinesisnavbar.analyticsNotSupported":"Analytics n'est pas pris en charge dans cette région","scac.kinesisnavbar.kvsNotSupported":"Video Streams n'est pas pris en charge dans cette région","scac.kinesisnavbar.dashboardText":"Tableau de bord","scac.kinesisnavbar.whatsNewText":"Nouveautés","scac.kinesisnavbar.externalResources":"Ressources externes"},r={"scac.kinesisnavbar.firehoseNotSupported":"Firehose はこのリージョンではサポートされていません","scac.kinesisnavbar.analyticsNotSupported":"Analytics はこのリージョンではサポートされていません","scac.kinesisnavbar.kvsNotSupported":"Video Streams はこのリージョンではサポートされていません","scac.kinesisnavbar.dashboardText":"ダッシュボード","scac.kinesisnavbar.whatsNewText":"最新情報","scac.kinesisnavbar.externalResources":"外部リソース"},i={"scac.kinesisnavbar.firehoseNotSupported":"Firehose는 이 지역에서 지원되지 않습니다.","scac.kinesisnavbar.analyticsNotSupported":"Analytics는 이 지역에서 지원되지 않습니다.","scac.kinesisnavbar.kvsNotSupported":"Video Streams는 이 지역에서 지원되지 않습니다.","scac.kinesisnavbar.dashboardText":"대시보드","scac.kinesisnavbar.whatsNewText":"새로운 소식","scac.kinesisnavbar.externalResources":"외부 리소스"},a={"scac.kinesisnavbar.firehoseNotSupported":"本区域不支持 Firehose","scac.kinesisnavbar.analyticsNotSupported":"本区域不支持 Analytics","scac.kinesisnavbar.kvsNotSupported":"本区域不支持 Video Streams","scac.kinesisnavbar.dashboardText":"控制面板","scac.kinesisnavbar.whatsNewText":"最新内容","scac.kinesisnavbar.externalResources":"外部资源"};e.translations("en",t),e.translations("fr",n),e.translations("ja",r),e.translations("ko",i),e.translations("zh",a),e.translations("zh_CN",a)}n.$inject=["$rootScope","$injector","KinesisNavBarData","METRICS"],r.$inject=["$translateProvider"],e.module("storageconsole.common.kinesisnavbar").constant("KINESIS_NAV_SERVICES",{STREAMS:"Data Streams",FIREHOSE:"Data Firehose",ANALYTICS:"Data Analytics",VIDEO_STREAMS:"Video Streams"}).constant("METRICS",{WHATS_NEW:"NavBarWhatsNew"}).controller("KinesisNavBarController",n).directive("kinesisNavigationBar",t).config(r)}.call(void 0),function(){function r(e,r,i,a){function o(t){var n=u[t];return e.isFeatureEnabled(n+"incloud")}function s(){var e=[i.PUBLIC,i.GOV];return t.includes(e,a.getCloudSystem())}var c,l={isKinesisServiceEnabled:o,isWhatsNewEnabled:s},u=(c={},n(c,r.FIREHOSE,"kfc"),n(c,r.ANALYTICS,"kac"),n(c,r.VIDEO_STREAMS,"kvc"),c);return l}r.$inject=["FAC","KINESIS_NAV_SERVICES","CLOUD_SYSTEMS","Region"],e.module("storageconsole.common.kinesisnavbar").service("KinesisNavBarFeatureService",r)}.call(void 0),function(){function t(e,t){function n(){r.showKmsKeySection=!1,t.bestEffortDescribeKeyAndGetAlias(r.kmsKey,r.serviceName).then(function(e){r.kmsKeyObj=e,r.showKmsKeySection=!0})}var r=this;r.showKmsKeySection=!1,e.$watch(function(){return r.kmsKey},function(e,t){e&&n()})}t.$inject=["$scope","KmsKeyService"],e.module("storageconsole.common").controller("KMSKeyDisplayController",t)}.call(void 0),function(){function t(){return{bindToController:!0,controller:"KMSKeyDisplayController",controllerAs:"vm",restrict:"E",scope:{serviceName:"=",kmsKey:"="},templateUrl:"storageConsoleCommon/components/kmsKeyDisplay/kmsKeyDisplay.tpl.html"}}e.module("storageconsole.common").directive("kmsKeyDisplay",t)}.call(void 0),function(){function n(e,n,r,i,a,o,s,c){function l(){return v.isLoadingKeys=!0,v.listKeysError="",v.keyList=[],o.listKeysForService({Service:v.serviceName,region:v.region}).catch(function(n){i.Clog.log(a.LIST_KEYS_FOR_SERVICE_FAILURE,1,n);var r=s.proxyErrorHandler(n);return r.errorType===E?(i.Clog.log(a.LIST_KEYS_FOR_SERVICE_FAILURE_ACCESS_DENIED,1,n),v.listKeysError=t.get(v.errorMessages,"permissionsError")||r.errorMessage):v.listKeysError=t.get(v.errorMessages,"genericError")||r.errorMessage,e.reject(n)}).then(function(e){i.Clog.log(a.LIST_KEYS_FOR_SERVICE_FAILURE,0);var n=t.get(e,"response.Keys");return v.keyList=h(n),d()}).then(function(n){var r;return v.listKeysError||v.selectedKeyArn||(r=u(),v.selectedKeyArn=t.get(r,"value")),v.keyList=t.sortBy(v.keyList,["text"]),g(),e.when()}).finally(function(){v.isLoadingKeys=!1})}function u(){return t.find(v.keyList,["text",C])}function d(){return u()?e.when():o.describeKey({KeyId:A,region:v.region}).then(function(n){i.Clog.log(a.DESCRIBE_DEFAULT_KEY_FAILURE,0);var r=t.get(n,"response.KeyMetadata"),o={text:C,value:r.Arn};return p(o,r),v.keyList.push(o),e.when()}).catch(function(t){return i.Clog.log(a.DESCRIBE_DEFAULT_KEY_FAILURE,1,t),s.proxyErrorHandler(t).errorType===E&&i.Clog.log(a.DESCRIBE_DEFAULT_KEY_FAILURE_ACCESS_DENIED,1,t),e.when()})}function p(e,n){t.merge(e,n),e.containsDetails=!0}function f(){g(),v.keyChange&&v.keyChange()}function g(){v.showKeyDetails=!1,v.selectedKeyArn&&(b()||(v.selectedKeyObj=t.find(v.keyList,["value",v.selectedKeyArn]),v.showKeyDetails=!0,v.selectedKeyObj?v.selectedKeyObj.containsDetails||m(v.selectedKeyObj):m({value:v.selectedKeyArn}).then(function(e){v.selectedKeyArn=e.Arn,v.selectedKeyObj=e})))}function m(n){return v.isDescribingKey=!0,o.describeKey({KeyId:n.value,region:v.region}).then(function(r){i.Clog.log(a.DESCRIBE_KEY_FAILURE,0);var o=t.get(r,"response.KeyMetadata");return p(n,o),e.when(n)}).catch(function(t){return i.Clog.log(a.DESCRIBE_KEY_FAILURE,1,t),s.proxyErrorHandler(t).errorType===E&&i.Clog.log(a.DESCRIBE_KEY_FAILURE_ACCESS_DENIED,1,t),e.reject()}).finally(function(){v.isDescribingKey=!1})}function h(e){return t.map(e,function(e){if(e.AliasList.length>0){var t=e.AliasList[0].Alias.split(":alias/"),n=t[t.length-1];return n===y&&(n=S+n),{text:n,value:e.KeyArn}}return{text:e.KeyId,value:e.KeyArn}})}function b(){var e=u();return e&&e.value===v.selectedKeyArn}var v=this,E="AccessDeniedException",S=n.instant("scac.kmsKeySelector.defaultKeyPrefix"),y="aws/"+v.serviceName,A="alias/"+y,C=""+S+y;v.LIST_KEYS_FAILURE_ALERT_TYPE=v.displayListKeyError?"error":"warning",v.isDescribingKey=!1,v.isLoadingKeys=!1,v.showKeyDetails=!1,v.listKeysError="",v.keyList=[],v.region=v.region||c.getCurrentRegion(),v.checkAndGetDetailsForSelectedKeyIfRequired=g,v.listKeys=l,v.onKeyChange=f,r.$watch("vm.region",function(e,t){e!==t&&l()}),function(){l()}()}n.$inject=["$q","$translate","$scope","AWSC","KMS_KEY_SELECTOR_METRICS","KMSService","ProxyErrorAdapter","Region"],e.module("storageconsole.common").controller("KMSKeySelectorController",n).constant("KMS_KEY_SELECTOR_METRICS",{LIST_KEYS_FOR_SERVICE_FAILURE:"listKeysForService_Failure",LIST_KEYS_FOR_SERVICE_FAILURE_ACCESS_DENIED:"listKeysForService_Failure_ADE",DESCRIBE_KEY_FAILURE:"describeKey_Failure",DESCRIBE_KEY_FAILURE_ACCESS_DENIED:"describeKey_Failure_ADE",DESCRIBE_DEFAULT_KEY_FAILURE:"describeDefaultKey_Failure",DESCRIBE_DEFAULT_KEY_FAILURE_ACCESS_DENIED:"describeDefaultKey_Failure_ADE"})}.call(void 0),function(){function t(){return{bindToController:!0,controller:"KMSKeySelectorController",controllerAs:"vm",restrict:"E",scope:{serviceName:"=",selectedKeyArn:"=",region:"=?",displayListKeyError:"=?",errorMessages:"=?",customText:"=?",keyChange:"&?"},templateUrl:"storageConsoleCommon/components/kmsKeySelector/kmsKeySelector.tpl.html"}}e.module("storageconsole.common").directive("kmsKeySelector",t)}.call(void 0);var r;!function(n){!function(r){!function(r){var i=n.components.lambdaBlueprintTable.LambdaBlueprintTableRow,a=function(){function e(e,n){var r=this;this.$translate=e,this.AwsUrlsService=n,this.translate=e.instant,this.filterPlaceholder=this.translate("scac.lambdaBlueprintTable.filterPlaceholder"),this.columns=[{name:this.translate("scac.lambdaBlueprintTable.name.label"),id:"name"},{name:this.translate("scac.lambdaBlueprintTable.description.label"),id:"description"}],this.blueprintRows=t.map(this.lambdaBlueprintsData,function(e){return new i(r.createBlueprintNameHtml(e.name,e.queryParam),e.description)})}return e.$inject=["$translate","AwsUrlsService"],e.prototype.createBlueprintNameHtml=function(e,t){return'<awsui-button class="external-button-link" data-disabled="false" loading="false" href="'+this.AwsUrlsService.getLambdaBlueprintUrl(t)+'" target="_blank"\n          icon="external-link" icon-align="right" variant="link">'+e+"</awsui-button>"},e}();r.LambdaBlueprintTableController=a,e.module("storageconsole.common").controller("LambdaBlueprintTableController",a)}(r.lambdaBlueprintTable||(r.lambdaBlueprintTable={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"LambdaBlueprintTableController",controllerAs:"vm",restrict:"E",scope:{lambdaBlueprintsData:"="},templateUrl:"storageConsoleCommon/components/lambda-blueprint-table/lambda-blueprint-table.html"}}e.module("storageconsole.common").directive("lambdaBlueprintTable",n)}(t.lambdaBlueprintTable||(t.lambdaBlueprintTable={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(e){!function(e){e.lambdaBlueprintTable||(e.lambdaBlueprintTable={})}(e.components||(e.components={}))}(r||(r={}));var r;!function(e){!function(e){!function(e){var t=function(){function e(e,t){this.latestVersionTimeoutWarningMessage=e,this.specificVersionTimeoutWarningMessage=t}return e}();e.LambdaFunctionSelectorTranslationKeys=t}(e.lambdaFunctionSelector||(e.lambdaFunctionSelector={}))}(e.components||(e.components={}))}(r||(r={}));var r;!function(n){!function(r){!function(r){var i=n.core.lambda.LambdaFunction,a=n.core.LAMBDA_FUNCTION_VERSION,o=n.core.STATUS_CODES,s=n.core.model.InputSelector,c=n.core.ERROR_ALERT_TYPES,l=n.components.nileAwsuiAlert.NileAwsUIAlert;r.LAMBDA_BLUEPRINT_MODAL_OPEN_METRIC="LambdaBlueprintModal_Open",r.LAMBDA_BLUEPRINT_MODAL_CLOSE_METRIC="LambdaBlueprintModal_Close";var u=function(){function e(e,n,i,o,c){var l=this;this.$translate=e,this.AwsResource=n,this.AWSC=i,this.LambdaServiceWrapper=o,this.SCACMetricsService=c,this.showModal="false",this.lambdaFunctionNamesSelector=new s,this.lambdaFunctionVersionsSelector=new s,this.lambdaFunctionDeeplink="",this.SUGGESTED_TIMEOUT_IN_MINUTES=1,this.lambdaFunctions=[],this.lambdaFunctionVersions=[],this.lambdaFunctionSelectionChanged=function(){l.selectLambdaFunctionWithLatestVersionIfRequired(l.lambdaFunctionNamesSelector.selectedItem),l.onLambdaFunctionChange&&l.onLambdaFunctionChange({lambdaFunction:l.lambdaFunction})},this.lambdaFunctionVersionSelectionChanged=function(){l.selectLambdaFunctionWithGivenVersionIfRequired(l.lambdaFunctionNamesSelector.selectedItem,l.lambdaFunctionVersionsSelector.selectedItem),l.onLambdaFunctionChange&&l.onLambdaFunctionChange({lambdaFunction:l.lambdaFunction})},this.isTimeoutInsufficient=function(){return l.lambdaFunction.timeOutInSeconds<60},this.isSelectedLambdaFunctionVersionLatest=function(){return l.isGivenLambdaFunctionVersionLatest(l.lambdaFunctionVersionsSelector.selectedItem)},this.openModal=function(){l.showModal="true",l.trackClick(r.LAMBDA_BLUEPRINT_MODAL_OPEN_METRIC),l.oldLengthOfLambdaFunctions=l.lambdaFunctionNamesSelector.list.length},this.closeModalAndRefreshLambdaFunctions=function(){l.showModal="false",l.trackClick(r.LAMBDA_BLUEPRINT_MODAL_CLOSE_METRIC),l.listLambdaFunctions().then(function(){l.AWSC.Clog.log("FunctionsCreatedInModal",l.lambdaFunctionNamesSelector.list.length-l.oldLengthOfLambdaFunctions)})},this.trackClick=function(e){l.SCACMetricsService.trackClick(e,l.pageContext)},this.isGivenLambdaFunctionVersionLatest=function(e){return e===a.$LATEST},this.orderLambdaFunctionVersions=function(){var e=t.remove(l.lambdaFunctionVersionsSelector.list,function(e){return e.text===a.$LATEST});l.lambdaFunctionVersionsSelector.list=t.concat(e,t.orderBy(l.lambdaFunctionVersionsSelector.list,["text"],["desc"]))},this.updateLambdaFunctionDeepLink=function(){if(l.lambdaFunction.arn){var e=new l.AwsResource(l.lambdaFunction.arn);l.lambdaFunctionDeeplink=e.deepLink}else l.lambdaFunctionDeeplink=""},this.translate=e.instant,this.lambdaFunctionNamesSelectorPlaceholder=this.translate("scac.selectLambdaFunction.placeholder"),this.lambdaFunctionVersionsSelectorPlaceholder=this.translate("scac.selectLambdaFunctionVersion.placeholder"),this.listLambdaFunctions().then(function(){l.lambdaFunction.name&&l.lambdaFunction.version&&!l.isGivenLambdaFunctionVersionLatest(l.lambdaFunction.version)?l.listAndOrderLambdaFunctionVersions().then(function(){l.selectLambdaFunctionWithGivenVersionIfRequired(l.lambdaFunction.name,l.lambdaFunction.version)}):l.selectLambdaFunctionWithLatestVersionIfRequired(l.lambdaFunction.name)})}return e.$inject=["$translate","AwsResource","AWSC","LambdaServiceWrapper","SCACMetricsService"],e.prototype.listLambdaFunctions=function(){var e=this;return this.lambdaFunctionNamesSelector.updatingList=!0,this.lambdaFunctionNamesSelectorPlaceholder=this.translate("scac.loading.placeholder"),this.lambdaFunctionNamesSelector.list=[],this.lambdaFunctionNamesSelector.errorAlert=new l,this.lambdaFunctions=[],this.LambdaServiceWrapper.listLambdaFunctions().then(function(n){e.lambdaFunctions=n,e.lambdaFunctionNamesSelector.list=t.map(n,function(e){return{value:e.name,text:e.name,disabled:!1,separator:!1}})}).catch(function(t){t.status>=o.INTERNAL_SERVER_ERROR?e.lambdaFunctionNamesSelector.errorAlert=new l(e.translate("scac.lambdaFunction.listFunctions.error.header"),e.translate("scac.lambdaFunction.listFunctions.error.message"),!0,c.ERROR):e.lambdaFunctionNamesSelector.errorAlert=new l(e.translate("scac.lambdaFunction.listFunctions.error.header"),t.errorMessage,!0,c.ERROR)}).finally(function(){e.lambdaFunctionNamesSelector.updatingList=!1,e.lambdaFunctionNamesSelectorPlaceholder=e.translate("scac.selectLambdaFunction.placeholder")})},e.prototype.listAndOrderLambdaFunctionVersions=function(){var e=this;return this.lambdaFunctionVersionsSelector.updatingList=!0,this.lambdaFunctionVersionsSelectorPlaceholder=this.translate("scac.loading.placeholder"),this.lambdaFunctionVersionsSelector.list=[],this.lambdaFunctionVersionsSelector.errorAlert=new l,this.lambdaFunctionVersions=[],this.LambdaServiceWrapper.listLambdaFunctionVersions(this.lambdaFunction.name).then(function(n){e.lambdaFunctionVersions=n,e.lambdaFunctionVersionsSelector.list=t.map(n,function(e){return{value:e.version,text:e.version,disabled:!1,separator:!1}}),e.orderLambdaFunctionVersions()}).catch(function(t){t.status>=o.INTERNAL_SERVER_ERROR?e.lambdaFunctionVersionsSelector.errorAlert=new l(e.translate("scac.lambdaFunction.listVersions.error.header"),e.translate("scac.lambdaFunction.listVersions.error.message"),!0,c.WARNING):e.lambdaFunctionVersionsSelector.errorAlert=new l(e.translate("scac.lambdaFunction.listVersions.error.header"),t.errorMessage,!0,c.WARNING),e.lambdaFunctionVersionsSelector.list=[{value:e.lambdaFunction.version,text:e.lambdaFunction.version,disabled:!1,separator:!1}]}).finally(function(){e.lambdaFunctionVersionsSelector.updatingList=!1,e.lambdaFunctionVersionsSelectorPlaceholder=e.translate("scac.selectLambdaFunctionVersion.placeholder")})},e.prototype.selectLambdaFunctionWithLatestVersionIfRequired=function(e){if(e){var t=this.findSelectedLambdaFunction(e);t?(this.lambdaFunctionNamesSelector.selectedItem=t.name,this.lambdaFunctionVersionsSelector.selectedItem=t.version,this.lambdaFunction=t,this.listAndOrderLambdaFunctionVersions()):(this.lambdaFunctionNamesSelector.selectedItem="",this.lambdaFunctionVersionsSelector.selectedItem="",this.lambdaFunction=new i),this.updateLambdaFunctionDeepLink()}},e.prototype.selectLambdaFunctionWithGivenVersionIfRequired=function(e,t){if(t){var n=this.findSelectedLambdaFunctionWithVersion(t);n?(this.lambdaFunctionNamesSelector.selectedItem=n.name,this.lambdaFunctionVersionsSelector.selectedItem=n.version,this.lambdaFunction=n,this.updateLambdaFunctionDeepLink()):this.selectLambdaFunctionWithLatestVersionIfRequired(e)}},e.prototype.findSelectedLambdaFunction=function(e){return t.find(this.lambdaFunctions,function(t){return t.name===e})},e.prototype.findSelectedLambdaFunctionWithVersion=function(e){return t.find(this.lambdaFunctionVersions,function(t){return t.version===e})},e}();r.LambdaFunctionSelectorController=u,e.module("storageconsole.common.components.lambdafunctionselector").controller("LambdaFunctionSelectorController",u)}(r.lambdaFunctionSelector||(r.lambdaFunctionSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"LambdaFunctionSelectorController",controllerAs:"vm",restrict:"E",scope:{lambdaFunction:"=",lambdaFunctionErrorMessage:"=",lambdaBlueprintsData:"=",pageContext:"@",translationKeys:"=",lambdaFunctionsToFilter:"=?",onLambdaFunctionChange:"&?"},templateUrl:"storageConsoleCommon/components/lambda-function-selector/lambda-function-selector.html"}}e.module("storageconsole.common.components.lambdafunctionselector").directive("lambdaFunctionSelector",n)}(t.lambdaFunctionSelector||(t.lambdaFunctionSelector={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{restrict:"E",scope:{alertModel:"="},templateUrl:"storageConsoleCommon/components/nile-awsui-alert/nile-awsui-alert.html"}}e.module("storageconsole.common").directive("nileAwsuiAlert",n)}(t.nileAwsuiAlert||(t.nileAwsuiAlert={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{restrict:"E",scope:{model:"="},templateUrl:"storageConsoleCommon/components/radio-button-with-tooltip/radio-button-with-tooltip.html"}}e.module("storageconsole.common").directive("radioButtonWithTooltip",n)}(t.radioButtonWithTooltip||(t.radioButtonWithTooltip={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(n){!function(r){!function(r){var i=n.components.nileAwsuiAlert.NileAwsUIAlert,a=function(){function e(e,n,r,a,o,s,c,l){var u=this;this.AWSC=e,this.AwsResource=n,this.AwsArnBuilder=r,this.AwsCookiesService=a,this.SCACMetricsService=o,this.ProxyErrorAdapter=s,this.$translate=c,this.$q=l,this.awsUiAlert=new i,this.loadingResources=!1,this.isLoadResourcesReturnedEmpty=!1,this.resourceItems=[],this.refreshResources=function(){return u.trackClick(u.model.metricNames.refresh),u.loadResourcesWrapper()},this.buildResourceDeepLink=function(){if(u.model.buildResourceDeepLink&&u.selectedResource)return u.model.buildResourceDeepLink(u.selectedResource)},this.buildCreateResourceDeepLink=function(){if(u.model.buildCreateResourceDeepLink)return u.model.buildCreateResourceDeepLink(u.selectedResource)},this.triggerLoad=function(){return u.loadResourcesWrapper()},this.loadResourcesWrapper=function(){return u.loadingResources=!0,u.resourceItems=[],u.awsUiAlert=new i,u.model.loadResources().then(u.updateResourceItems,u.surfaceCustomerError).finally(function(){u.loadingResources=!1})},this.updateResourceItems=function(e){var n=u.model.onLoadSuccess(e);return u.resourceItems=n.resourceItems,u.isLoadResourcesReturnedEmpty=t.isEmpty(u.resourceItems),u.checkSelectedItemAndEmitResourceNotFoundMetric(),u.$q.when(e)},this.surfaceCustomerError=function(e){var t=u.model.onLoadFailure(e);return u.awsUiAlert=t.awsUiAlert,u.$q.reject(e)},this.trackClick=function(e){u.SCACMetricsService.trackClick(e,u.model.metricNames.context)},!0===this.model.delayLoad()||this.loadResourcesWrapper()}return e.$inject=["AWSC","AwsResource","AwsArnBuilder","AwsCookiesService","SCACMetricsService","ProxyErrorAdapter","$translate","$q"],e.prototype.selectResource=function(){this.trackClick(this.model.metricNames.select),this.model.onChange&&this.model.onChange()},e.prototype.getSelectedResourceText=function(){var e=this.getSelectedItem();return t.get(e,"text")},e.prototype.getSelectedItem=function(){var e=this;return t.find(this.resourceItems,function(t){return t.value===e.selectedResource})},e.prototype.getInlineErrorMessageKey=function(){return this.isLoadResourcesReturnedEmpty&&t.get(this.model.text,"select.noResourcesExistMessage")?t.get(this.model.text,"select.noResourcesExistMessage"):this.model.text.validationMessageKeys.getNoResourceSelectedMessageKey()},e.prototype.checkSelectedItemAndEmitResourceNotFoundMetric=function(){this.selectedResource&&this.model.metricNames.resourceNotFound&&(this.getSelectedItem()?this.AWSC.Clog.log(this.model.metricNames.resourceNotFound,0):this.AWSC.Clog.log(this.model.metricNames.resourceNotFound,1))},e}();r.ResourceSelectorController=a,e.module("storageconsole.common.components.resourceSelector").controller("resourceSelectorController",a)}(r.resourceSelector||(r.resourceSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"resourceSelectorController",controllerAs:"vm",restrict:"E",scope:{model:"<",triggerLoad:"=",selectedResource:"="},templateUrl:"storageConsoleCommon/components/resource-selector/resource-selector.html"}}e.module("storageconsole.common.components.resourceSelector").directive("resourceSelector",n)}(t.resourceSelector||(t.resourceSelector={}))}(t.components||(t.components={}))}(r||(r={})),function(){function t(e){return{restrict:"A",link:function(t,n,r){var i=e(r.rightClick);n.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),i(t,{$event:e})})})}}}t.$inject=["$parse"],e.module("storageconsole.common").directive("rightClick",t)}();var r;!function(n){!function(r){!function(r){function i(e){var t={"scac.s3BucketArnSelector.label":"Amazon S3 bucket*","scac.s3BucketArnSelector.placeholder":"Choose S3 bucket","scac.s3BucketArnSelector.viewResource":"View <b>{{resourceName}}</b> in Amazon S3","scac.s3BucketArnSelector.noResourcesMessage":"You do not have any S3 buckets. Choose <b>Create new</b> to create a S3 bucket.","scac.s3BucketArnSelector.createNew":"Create new","scac.s3BucketArnSelector.error.default.header":"Unable to list buckets","scac.s3BucketArnSelector.error.internal.message":"An internal error prevented listing buckets. Wait a few minutes and choose the refresh icon. If the problem persists, contact AWS Support.","scac.s3BucketArnSelector.error.permissions.message":'Before you can select a bucket, you or your AWS administrator must update your IAM permissions to allow the s3:ListAllMyBuckets action. Choose the <span class="awsui-icon refresh"></span> below to refresh the list of S3 buckets once you have been granted permissions.'},n={},r={},i={},a={};e.translations("en",t),e.translations("zh",n),e.translations("zh_CN",n),e.translations("fr",r),e.translations("ja",i),e.translations("ko",a)}i.$inject=["$translateProvider"];var a=n.components.nileAwsuiAlert.NileAwsUIAlert,o=n.core.model.NileAwsUISelectItem,s=n.core.STATUS_CODES,c=function(){function e(n,r,i,c,l){var u=this;this.AwsArnBuilder=n,this.AwsResource=r,this.ProxyErrorAdapter=i,this.$translate=c,this.S3WrapperService=l,this.showCreateBucketModal=!1,this.selectCreatedBucketAndTriggerListS3BucketsLoad=function(e){u.selectedResource=new u.AwsResource(e).resourceName,u.triggerListS3BucketsLoad()};var d=this,p={controlGroup:{label:e.COMPONENT_KEY_PREFIX+"label"},select:{placeholder:e.COMPONENT_KEY_PREFIX+"placeholder",createNewResource:e.COMPONENT_KEY_PREFIX+"createNew",viewResource:e.COMPONENT_KEY_PREFIX+"viewResource",noResourcesExistMessage:e.COMPONENT_KEY_PREFIX+"noResourcesMessage"},validationMessageKeys:{getNoResourceSelectedMessageKey:function(){return t.get(d.validationMessageKeys,"noResourceSelectedMessageKey")}}};this.model={loadResources:function(){return u.S3WrapperService.getBucketsArrayFromLamb()},onLoadSuccess:function(e){return{resourceItems:t.map(e,function(e){var t=new o;return t.text=e.Name,t.value=u.AwsArnBuilder.build("s3","bucket",e.Name),t})}},onLoadFailure:function(t){var n=new a,r=u.ProxyErrorAdapter.proxyErrorHandler(t);return n.header=u.$translate.instant(e.ERROR_KEY_PREFIX+"default.header"),r.status>=s.INTERNAL_SERVER_ERROR?n.message=u.$translate.instant(e.ERROR_KEY_PREFIX+"internal.message"):r.status===s.FORBIDDEN&&r.errorType===e.ACCESS_DENIED_ERROR_TYPE?n.message=u.$translate.instant(e.ERROR_KEY_PREFIX+"permissions.message"):n.message=r.errorMessage||u.$translate.instant(e.ERROR_KEY_PREFIX+"internal.message"),{awsUiAlert:n}},text:t.merge({},p,this.labelKeyOverrides),disabled:function(){return d.disabled||!1},buildResourceDeepLink:function(e){return new u.AwsResource(u.selectedResource).deepLink},onCreateResourceClick:function(){u.showCreateBucketModal=!0},delayLoad:function(){return d.delayLoad||!1},onChange:d.onChange,metricNames:{select:"sS3BucketArn",refresh:"rS3BucketArn",context:d.pageContext,resourceNotFound:"bucketDoesNotExist"}}}return e.$inject=["AwsArnBuilder","AwsResource","ProxyErrorAdapter","$translate","S3WrapperService"],e}();c.ACCESS_DENIED_ERROR_TYPE="AccessDenied",c.COMPONENT_KEY_PREFIX="scac.s3BucketArnSelector.",c.ERROR_KEY_PREFIX=c.COMPONENT_KEY_PREFIX+"error.",r.S3BucketArnSelectorController=c,e.module("storageconsole.common.components.s3BucketArnSelector").config(i).controller("S3BucketArnSelectorController",c)}(r.s3BucketArnSelector||(r.s3BucketArnSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(n){!function(r){!function(r){function i(){return{bindToController:!0,controller:"S3BucketArnSelectorController",controllerAs:"vm",restrict:"E",scope:t.assign({},a,{pageContext:"<",labelKeyOverrides:"<?"}),templateUrl:"storageConsoleCommon/components/s3-bucket-arn-selector/s3-bucket-arn-selector.html"}}var a=n.components.resourceSelector.AWS_RESOURCE_SELECTOR_DIRECTIVE_SCOPE_BASE;e.module("storageconsole.common.components.s3BucketArnSelector").directive("s3BucketArnSelector",i)}(r.s3BucketArnSelector||(r.s3BucketArnSelector={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(e){!function(e){e.s3BucketArnSelector||(e.s3BucketArnSelector={})}(e.components||(e.components={}))}(r||(r={}));var r;!function(n){!function(n){!function(n){function r(e){var t={"scac.s3ObjectPathInput.label":"Path to Amazon S3 object*","scac.s3ObjectPathInput.placeholder":"path/to/object-name","scac.s3ObjectPathInput.viewObject":"View specified object in Amazon S3"},n={},r={},i={},a={};e.translations("en",t),e.translations("zh",n),e.translations("zh_CN",n),e.translations("fr",r),e.translations("ja",i),e.translations("ko",a)}r.$inject=["$translateProvider"];var i=function(){function e(n,r,i){var a=this;this.$translate=n,this.AwsResource=r,this.ResourceDeeplinkService=i,this.getS3ObjectArn=function(){return a.s3BucketArn&&a.s3ObjectPath&&!a.invalidObjectPathMessage?a.s3BucketArn+"/"+a.s3ObjectPath:""};var o={controlGroup:{label:this.$translate.instant(e.COMPONENT_KEY_PREFIX+"label"),viewResource:this.$translate.instant(e.COMPONENT_KEY_PREFIX+"viewObject")},input:{placeholder:this.$translate.instant(e.COMPONENT_KEY_PREFIX+"placeholder")}};this.text=t.merge({},o,this.overrideText)}return e.$inject=["$translate","AwsResource","ResourceDeeplinkService"],e.prototype.getObjectDeeplink=function(){if(this.s3BucketArn&&this.s3ObjectPath&&!this.invalidObjectPathMessage){var e=new this.AwsResource(this.s3BucketArn).resourceName;return this.ResourceDeeplinkService.getS3ObjectUrl(e,this.s3ObjectPath)}},e.prototype.onInputBlur=function(){this.validate&&(this.invalidObjectPathMessage=this.validate())},e.prototype.onInput=function(){this.validate&&this.invalidObjectPathMessage&&(this.invalidObjectPathMessage=this.validate())},e.prototype.onValueChange=function(){this.onChange&&this.onChange()},e}();i.COMPONENT_KEY_PREFIX="scac.s3ObjectPathInput.",n.S3ObjectPathInputController=i,e.module("storageconsole.common.components.s3ObjectPathInput").config(r).controller("S3ObjectPathInputController",i)}(n.s3ObjectPathInput||(n.s3ObjectPathInput={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"S3ObjectPathInputController",controllerAs:"vm",scope:{s3BucketArn:"<",s3ObjectPath:"=",getS3ObjectArn:"=?",validate:"&?",onChange:"&?",invalidObjectPathMessage:"=?",overrideText:"<?"},templateUrl:"storageConsoleCommon/components/s3-object-path-input/s3-object-path-input.html"}}e.module("storageconsole.common.components.s3ObjectPathInput").directive("s3ObjectPathInput",n)}(t.s3ObjectPathInput||(t.s3ObjectPathInput={}))}(t.components||(t.components={}))}(r||(r={})),function(){function n(e,n,r,i,a,o,s,c,l){function u(){return!!t.isString(b.bucketName)&&/^[a-z0-9-.]{3,63}$/.test(b.bucketName)}function d(){b.validationErrorMessage&&p()}function p(){m();var e=u();return e||(b.validationErrorMessage=v),e}function f(){b.visible=!1,g(),m()}function g(){b.bucketName=""}function m(){b.validationErrorMessage="",b.serverSideErrorMessage=""}function h(){if(p())return b.isCreatingBucket=!0,m(),o.createBucket(b.bucketName,b.selectedRegion).then(function(){if(r.Clog.log(s.S3_BUCKET_CREATION_MODAL_SUCCESS,1),t.isFunction(b.onSuccess)){var e=i.build("s3","bucket",b.bucketName);b.onSuccess({arn:e})}b.closeS3BucketCreationModal()}).catch(function(e){r.Clog.log(s.S3_BUCKET_CREATION_MODAL_SUCCESS,0,e),b.serverSideErrorMessage=c.proxyErrorHandler(e).errorMessage,t.isFunction(b.onFailure)&&b.onFailure({err:e})}).finally(function(){b.isCreatingBucket=!1})}var b=this,v=n.instant("scac.s3BucketCreationModal.errorMessage");b.selectedRegion=l.getCurrentRegion(),b.regions=l.regionMapping,b.displayCurrentRegionName=l.twoWayMapping[b.selectedRegion],b.learnMoreLink=a.getDocUrl("console/s3/usings3bucket"),b.checkIfS3BuckerNamingValidOnInputChange=d,b.checkIfS3BucketNamingValidOnBlur=p,b.createBucket=h,b.closeS3BucketCreationModal=f,b.isCreatingBucket=!1}n.$inject=["$q","$translate","AWSC","AwsArnBuilder","AwsUrlsService","S3WrapperService","S3_BUCKET_CREATION_MODAL_METRIC_CONSTANTS","ProxyErrorAdapter","Region"],e.module("storageconsole.common").controller("s3BucketCreationModalController",n).constant("S3_BUCKET_CREATION_MODAL_METRIC_CONSTANTS",{S3_BUCKET_CREATION_MODAL_SUCCESS:"s3CreateBucket_Success"})}.call(void 0),function(){function t(){return{bindToController:!0,controller:"s3BucketCreationModalController",controllerAs:"vm",restrict:"E",scope:{visible:"=",isRegionReadOnly:"=?",onSuccess:"&?",onFailure:"&?"},templateUrl:"storageConsoleCommon/components/s3BucketCreationModal/s3BucketCreationModal.tpl.html"}}e.module("storageconsole.common").directive("s3BucketCreationModal",t),e.module("storageconsole.common").config(["$translateProvider",function(e){var t={"scac.s3BucketCreationModal.titleAndCreateButton":"Create S3 bucket","scac.s3BucketCreationModal.description":'A bucket is a container for objects stored in Amazon S3. <a href="{{ learnMoreLink }}" target="_blank">Learn more</a>',"scac.s3BucketCreationModal.label":"S3 bucket name","scac.s3BucketCreationModal.region":"Region","scac.s3BucketCreationModal.button.cancel":"Cancel","scac.s3BucketCreationModal.errorMessage":"The bucket name must be between 3–63 characters, and can contain only the following: alphanumeric characters (0-9a-z), period (.), and hyphen (-)."},n={"scac.s3BucketCreationModal.titleAndCreateButton":"Créer un compartiment S3","scac.s3BucketCreationModal.description":'Un compartiment est un conteneur d\'objets stockés dans Amazon S3. <a href="{{ learnMoreLink }}" target="_blank">En savoir plus</a>',"scac.s3BucketCreationModal.label":"Nom du compartiment S3","scac.s3BucketCreationModal.region":"Région","scac.s3BucketCreationModal.button.cancel":"Annuler","scac.s3BucketCreationModal.errorMessage":"Le nom du compartiment peut compter entre 3 et 63 caractères et contenir uniquement les éléments suivants : des caractères alphanumériques (0-9, a-z), des points (.) et des tirets (-)."},r={"scac.s3BucketCreationModal.titleAndCreateButton":"S3 バケットの作成","scac.s3BucketCreationModal.description":'バケットとは、Amazon S3 に格納されるオブジェクトのコンテナです。<a href="{{ learnMoreLink }}" target="_blank">詳細はこちら</a>',"scac.s3BucketCreationModal.label":"S3 バケット名","scac.s3BucketCreationModal.region":"リージョン","scac.s3BucketCreationModal.button.cancel":"キャンセル","scac.s3BucketCreationModal.errorMessage":"バケット名は、長さが 3～63 文字で、英数字 (0～9、a～z)、ピリオド (.)、およびハイフン (-) のみを使用できます。"},i={"scac.s3BucketCreationModal.titleAndCreateButton":"S3 버킷 생성","scac.s3BucketCreationModal.description":'버킷은 Amazon S3에 저장된 객체에 대한 컨테이너입니다. <a href="{{ learnMoreLink }}" target="_blank">자세히 알아보기</a>',"scac.s3BucketCreationModal.label":"S3 버킷 이름","scac.s3BucketCreationModal.region":"리전","scac.s3BucketCreationModal.button.cancel":"취소","scac.s3BucketCreationModal.errorMessage":"버킷 이름은 3~63자로 이루어져야 하며, 다음 문자만 포함할 수 있습니다: 영숫자(0-9a-z), 마침표(.), 및 하이픈(-)"},a={"scac.s3BucketCreationModal.titleAndCreateButton":"创建 S3 存储桶","scac.s3BucketCreationModal.description":'存储桶是 Amazon S3 中用于存储数据元的容器。<a href="{{ learnMoreLink }}" target="_blank">了解更多</a>',"scac.s3BucketCreationModal.label":"S3 存储桶名称","scac.s3BucketCreationModal.region":"区域","scac.s3BucketCreationModal.button.cancel":"取消","scac.s3BucketCreationModal.errorMessage":"存储桶名称必须在 3 到 63 个字符之间，并且只能包含以下字符: 字母数字字符 (0-9 a-z)、句点 (.) 和连字符 (-)。"};e.translations("en",t),e.translations("fr",n),e.translations("ja",r),e.translations("ko",i),e.translations("zh",a),e.translations("zh_CN",a)}])}.call(void 0),function(){function t(e,t){e.emitMetric=function(){if(e.metricName){var n={id:e.metricName};e.metricContext&&(n.context=e.metricContext),t.Analytics.trackClick(n)}}}t.$inject=["$scope","AWSC"],e.module("storageconsole.common").controller("storageConsoleAnchorController",t)}.call(void 0),function(){function t(e){return{restrict:"E",templateUrl:"storageConsoleCommon/components/storageConsoleAnchor/storageConsoleAnchor.html",scope:!0,controller:"storageConsoleAnchorController",link:function(t,n,r){["target","href","text","metricName","metricContext","showExternalLinkIcon"].forEach(function(n){t.$watch(function(){return r[n]},function(){t[n]=e.tryEvalAttr(r[n],t)})})}}}t.$inject=["EvalUtil"],e.module("storageconsole.common").directive("scA",t)}.call(void 0);var r;!function(n){!function(n){!function(n){var r=function(){function e(e,n){var r=this;this.$scope=e,this.$filter=n,this.NUMBER_OF_RESOURCES_TO_SHOW=5,this.showAlert=function(){return!!r.storageConsoleCardModel.alertModel&&!!r.storageConsoleCardModel.alertModel.header&&!!r.storageConsoleCardModel.alertModel.message},this.showNoResourcesSection=function(){return!r.showAlert()&&!r.hasTableRows()},this.showTable=function(){return!r.showAlert()&&r.hasTableRows()},this.createHeaderTextWithItemCount=function(){return r.hasTableRows()&&r.storageConsoleCardModel.hasMoreResources?r.storageConsoleCardModel.headerText+" ("+r.storageConsoleCardModel.tableRows.length+"+)":r.hasTableRows()?r.storageConsoleCardModel.headerText+" ("+r.storageConsoleCardModel.tableRows.length+")":r.storageConsoleCardModel.headerText},this.hasTableRows=function(){return!!r.storageConsoleCardModel.tableRows&&r.storageConsoleCardModel.tableRows.length>0},this.headerTextWithItemCount=this.createHeaderTextWithItemCount(),this.tableRowsToDisplay=this.$filter("limitTo")(this.storageConsoleCardModel.tableRows,this.NUMBER_OF_RESOURCES_TO_SHOW),this.$scope.$watch(function(){return r.storageConsoleCardModel.tableRows},function(e,n){t.isEqual(e,n)||(r.headerTextWithItemCount=r.createHeaderTextWithItemCount(),r.tableRowsToDisplay=r.$filter("limitTo")(r.storageConsoleCardModel.tableRows,r.NUMBER_OF_RESOURCES_TO_SHOW))},!0)}return e.$inject=["$scope","$filter"],e}();n.StorageConsoleCardController=r,e.module("storageconsole.common").controller("StorageConsoleCardController",r)}(n.storageConsoleCard||(n.storageConsoleCard={}))}(n.components||(n.components={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function n(){return{bindToController:!0,controller:"StorageConsoleCardController",controllerAs:"vm",restrict:"E",transclude:{footer:"footer"},scope:{storageConsoleCardModel:"="},templateUrl:"storageConsoleCommon/components/storageConsoleCard/storageConsoleCard.html"}}e.module("storageconsole.common").directive("storageConsoleCard",n)}(t.storageConsoleCard||(t.storageConsoleCard={}))}(t.components||(t.components={}))}(r||(r={}));var r;!function(e){!function(e){!function(e){var t=function(){function e(e,t,n,r,i,a,o,s,c){void 0===e&&(e=!1),void 0===t&&(t=""),void 0===n&&(n=""),void 0===o&&(o=""),void 0===s&&(s=""),void 0===c&&(c=!1),this.loading=e,this.headerText=t,this.headerTooltipText=n,this.tableColumns=r,this.tableRows=i,this.alertModel=a,this.placeholderDescriptionText=o,this.placeholderImageId=s,this.hasMoreResources=c}return e}();e.StorageConsoleCardModel=t}(e.storageConsoleCard||(e.storageConsoleCard={}))}(e.components||(e.components={}))}(r||(r={})),function(){var t=e.module("storageconsole.common");t.controller("StorageConsoleConfigPanelController",["$scope","defaultValue",function(t,n){n(t,"onPanelClose",e.noop),t.hidePanel=function(){t.panelOpen=!1,t.onPanelClose()},document.onkeydown=function(e){e&&27==e.keyCode&&t.$apply(function(){t.hidePanel()})}}]),t.directive("storageConsoleConfigPanel",[function(){return{scope:{header:"=",panelOpen:"=",onPanelClose:"=?"},transclude:{header:"?header",content:"content",footer:"?footer"},templateUrl:"storageConsoleCommon/components/storageConsoleConfigPanel/storageConsoleConfigPanel.tpl.html",controller:"StorageConsoleConfigPanelController"}}]),t.config(["$translateProvider",function(e){var t={"configpanel.button.close":"Done"},n={"configpanel.button.close":"Effectué"},r={"configpanel.button.close":"完成"},i={"configpanel.button.close":"完了"},a={"configpanel.button.close":"완료"};e.translations("en",t),e.translations("en_US",t),e.translations("fr",n),e.translations("zh_CN",r),e.translations("zh",r),e.translations("ja",i),e.translations("ko",a)}])}(),function(){e.module("storageconsole.common").controller("StorageConsoleConfigPanelItemController",["$scope","defaultValue",function(e,t){t(e,"loading",!1)}]),e.module("storageconsole.common").directive("storageConsoleConfigPanelItem",[function(){return{scope:{header:"=",itemOpen:"=?",loading:"=?"},transclude:!0,templateUrl:"storageConsoleCommon/components/storageConsoleConfigPanel/storageConsoleConfigPanelItem.tpl.html",controller:"StorageConsoleConfigPanelItemController"}}])}(),function(){e.module("storageconsole.common").controller("StorageConsoleDisplayTableController",["$scope",function(e){var n=this;n.nameKeys=t.map(n.columnNames,"name"),n.idKeys=t.map(n.columnNames,"id"),n.columnStyles=t.map(n.columnNames,function(e){return{width:e.percentWidth?e.percentWidth+"%":null}}),n.toolTips=t.map(n.columnNames,"toolTip"),n.toolTipPositions=t.map(n.columnNames,function(e){return e.toolTipPosition?e.toolTipPosition:"right"}),n.currentFilter="",n.filterPlaceholder=n.filterPlaceholder||"Filter by name",n.wideText=n.wideText||!1,n.rowArrays=[],n.wideText&&(n.styles?n.styles+=" wide-text":n.styles="wide-text"),e.$watch(function(){return n.rows.length},function(){n.rowArrays=t.map(n.rows,function(e){return t.map(t.keys(e),function(t){return e[t]})})},!0)}]),e.module("storageconsole.common").filter("withKeyPartial",[function(){return function(e,t,n){if(void 0===n||!n.length)return e;var r=0,i={},a=new RegExp(n.toUpperCase());for(var o in e){var s=e instanceof Array?e[o].toUpperCase():o.toUpperCase(),c=t[r].toUpperCase();(s.match(a)||c.match(a))&&(i[o]=e[o]),r++}return i}}]),e.module("storageconsole.common").directive("storageConsoleDisplayTable",[function(){return{bindToController:!0,controller:"StorageConsoleDisplayTableController",controllerAs:"vm",restrict:"E",scope:{columnNames:"=",filterPlaceholder:"=?",rows:"=",secondaryHeaders:"=",filterByRow:"=?",showFilter:"=",wideText:"=?",styles:"=?"},templateUrl:"storageConsoleCommon/components/storageConsoleDisplayTable/storageConsoleDisplayTable.tpl.html"}}])}(),function(){e.module("storageconsole.common").controller("StorageConsoleLineChartController",["$scope","$window",function(e,t){function n(t){e.yaxisline&&e.yaxisline.Value&&(e.yaxisline.Value<t[0]&&(t[0]=e.yaxisline.Value),e.yaxisline.Value>t[1]&&(t[1]=e.yaxisline.Value))}function r(t){var n=e.xticks||4;if(!e.xticks&&e.xmin&&e.xmax&&e.isxdate){var r=e.xmax-e.xmin;t>o?r>=336*i?n=7:r>=168*i?n=7:r>=24*i?n=6:r>=12*i?n=8:r>=3*i?n=6:r>=i&&(n=6):r>=336*i&&(n=4)}return n}var i=36e5,a=t.d3,o=380,s=Math.floor(.7*o),c=e.ybase?e.ybase:1e3;e.draw=function(){var t=e.data,c=a.bisector(function(t){return t[e.xid]}).left,u=e.totalwidth||o,p=e.totalheight||s,f=e.marginleft||80,g=e.marginright||30,m=e.margintop||40,h=e.marginbottom||30,b=r(u),v=e.yticks||5,E=a.time.format("%m/%d %H:%M"),S=a.time.format("%m/%d"),y=l,A=y,C=e.xscaleby||1,_=e.yscaleby||1,w=e.sortx||!0,T=e.isxdate||!1;t||(AWSC.Clog.log("ChartDataPointsUndefined",0),t=[]),e.xmin&&e.xmax&&e.xmax-e.xmin<=12*i&&(S=a.time.format("%H:%M"));var R=t.length>0?t[0].Unit:null;"Count"===R&&(A=d);var O={top:m,right:g,bottom:h,left:f},k=u-O.left-O.right,I=p-O.top-O.bottom,P=a.time.scale().range([0,k]),N=a.scale.linear().range([I,0]);a.select("#"+e.chartid).selectAll("svg").remove();var M=a.select("#"+e.chartid).append("svg").attr("width",k+O.left+O.right).attr("height",I+O.top+O.bottom).append("g").attr("transform","translate("+O.left+","+O.top+")"),L=a.svg.axis().scale(P).orient("bottom").ticks(b);T&&L.tickFormat(S);var x=a.svg.axis().scale(N).orient("left").ticks(v).tickFormat(y),D=a.svg.line().x(function(t){return P(t[e.xid])}).y(function(t){return N(t[e.yid])});w&&t.sort(function(t,n){return a.ascending(t[e.xid],n[e.xid])}),t.forEach(function(t){t[e.xid]=t[e.xid]*C,T&&(t[e.xid]=new Date(t[e.xid])),t[e.yid]=+t[e.yid]*_});var j=void 0;if(j=e.xmin&&e.xmax?T?[new Date(e.xmin),new Date(e.xmax)]:[e.xmin,e.xmax]:a.extent(t,function(t){return t[e.xid]}),P.domain(j).nice(),t.length>0){var B=a.extent(t,function(t){return t[e.yid]});n(B);var F=B[0],U=B[1],K=.1*(U-F);0===K&&(0!==U?K=.1*U:(K=1,v=2,x.ticks(v))),"Count"===R&&(K=Math.ceil(K)),F=F-K>0?F-K:0,U+=K,N.domain([F,U]),N.nice([F,U])}else{var B=[0,5];n(B),N.domain(B),N.nice(B)}if(e.dotted?M.append("path").attr("class","line").style("stroke",e.color).style("stroke-width",e.dotted).style("stroke-dasharray",e.pattern).attr("d",D(t)):M.append("path").attr("class","line").attr("d",D(t)),e.yaxisline&&e.yaxisline.Value){var V=e.yaxisline.color?e.yaxisline.color:"red";M.append("line").attr("class","line").style("stroke",V).attr("x1",0).attr("y1",N(e.yaxisline.Value)).attr("x2",k).attr("y2",N(e.yaxisline.Value))}1===t.length&&M.selectAll("dot").data(t).enter().append("circle").attr("class","line").attr("r",4).attr("cx",function(t){return P(t[e.xid])}).attr("cy",function(t){return N(t[e.yid])});var G=M.append("g").attr("class","focus").style("display","none");G.append("circle").attr("r",4.5);var Y=M.append("line").attr("class","aim"),W=M.append("line").attr("class","aim"),z=M.append("rect").attr("style","cursor:crosshair"),$=M.append("g").style("opacity",0),H=M.append("g").style("opacity",0);$.append("rect").attr("class","chart-rect").attr("width","80px").attr("height","16px"),H.append("rect").attr("class","chart-rect").attr("width","16px").attr("height","80px");var q=$.append("text").attr("class","tooltip-text").attr("transform","translate(10, 12)"),J=M.append("g").style("opacity",0);J.append("rect").attr("class","chart-rect").attr("width","80px").attr("height","30px").attr("transform","translate(-40, -2.5)").style("opacity",1);var X=J.append("text").attr("class","tooltip-text").style("text-anchor","middle").attr("transform","translate(0, 10)"),Z=J.append("text").attr("class","tooltip-text").style("text-anchor","middle").attr("transform","translate(0, 23)"),Q=M.append("g");Q.append("text").attr("class","tooltip-text").style("text-anchor","middle").attr("transform","rotate(-90)"),z.attr("class","overlay").attr("width",k).attr("height",I).on("mouseover",function(){t.length>0&&G.style("display",null)}).on("mouseout",function(){G.style("display","none"),W.style("opacity",0),Y.style("opacity",0),$.style("opacity",0),H.style("opacity",0),J.style("opacity",0),Q.style("opacity",0)}).on("mousemove",function(){z.style("cursor","crosshair");var n=a.mouse(this),r=n[0],i=n[1];n[0]<44?r=44:n[0]>k-40&&(r=k-40),n[1]<40?i=40:n[1]>I-46&&(i=I-46),W.attr("x1",n[0]).attr("y1",0).attr("x2",n[0]).attr("y2",I),Y.attr("x1",0).attr("y1",n[1]).attr("x2",k).attr("y2",n[1]),W.style("opacity",.9),Y.style("opacity",.9);var o=P.invert(n[0]),s=N.invert(n[1]),l=c(t,o,1),u=t[l-1],d=t[l],p=u;if(d&&o-u[e.xid]>d[e.xid]-o&&(p=d),Q.select("text").text(y(s)),Q.attr("transform","translate(4,"+i+")"),q.text(E(o)),$.attr("transform","translate("+(r-40)+","+(I-13)+")"),H.attr("transform","translate(-8,"+(i-40)+")"),$.style("opacity",.9),H.style("opacity",.9),Q.style("opacity",.9),p){var f=P(p[e.xid]),g=N(p[e.yid]),m=0;f-40<0&&(m+=40),J.attr("transform","translate("+(f+m)+","+(g-35)+")"),X.text(E(p[e.xid])),Z.text(A(p[e.yid])),G.attr("transform","translate("+f+","+g+")"),J.style("opacity",.9)}}),M.append("g").attr("class","x axis").attr("transform","translate(0,"+(I+4)+")").call(L),M.append("g").attr("class","y axis").attr("transform","translate(-10,0)").call(x),e.metricStatisticsLoading=!1};var l=function(e){var t=a.format(".1f");return e<c?t(e):e<c*c?t(e/c)+"k":e<c*c*c?t(e/c/c)+"M":e<c*c*c*c?t(e/c/c/c)+"G":t(e/c/c/c/c)+"T"},u=function(e){return a.format(".1f")(e)},d=function(e){return Math.floor(u(e))}}]),e.module("storageconsole.common").directive("storageConsoleLineChart",[function(){return{scope:{chartid:"=",data:"=",heading:"=?",isxdate:"=?",marginbottom:"=?",marginleft:"=?",marginright:"=?",margintop:"=?",sortx:"=?",totalheight:"=?",totalwidth:"=?",xid:"=",xmin:"=?",xmax:"=?",xscaleby:"=?",xticks:"=?",yid:"=",yscaleby:"=?",yticks:"=?",loading:"=?",color:"=?",dotted:"=?",pattern:"=?",yaxisline:"=?",ybase:"<?"},transclude:!0,controller:"StorageConsoleLineChartController",link:function(e){e.$watch("data",function(t){t&&e.draw()})},templateUrl:function(e,t){return t.templateUrl||"storageConsoleCommon/components/storageConsoleLineChart/storageConsoleLineChart.tpl.html"}}}])}(),function(){function n(e){var t={"scac.listTable.paginationControls":"Viewing {{ paginationCurrentItemsMin }} - {{ paginationCurrentItemsMax }} of {{ paginationTotalItems }} {{ paginationResourceName }}","scac.listTable.paginationControls.defaultResourceName":"items"},n={"scac.listTable.paginationControls":"查看 {{ paginationCurrentItemsMin }} 到 {{ paginationCurrentItemsMax }}，共 {{ paginationTotalItems }} 个{{ paginationResourceName }}","scac.listTable.paginationControls.defaultResourceName":"项目"},r={"scac.listTable.paginationControls":"Affichage de {{ paginationCurrentItemsMin }} - {{ paginationCurrentItemsMax }} sur {{ paginationTotalItems }} {{ paginationResourceName }}","scac.listTable.paginationControls.defaultResourceName":"éléments"},i={"scac.listTable.paginationControls":"{{ paginationTotalItems }} 個の{{ paginationResourceName }}中 {{ paginationCurrentItemsMin }} ～ {{ paginationCurrentItemsMax }} を表示中","scac.listTable.paginationControls.defaultResourceName":"項目"},a={"scac.listTable.paginationControls":"{{ paginationCurrentItemsMin }} - {{ paginationCurrentItemsMax }}/{{ paginationTotalItems }} {{ paginationResourceName }} 보는 중","scac.listTable.paginationControls.defaultResourceName":"항목"};e.translations("en",t),e.translations("zh",n),e.translations("zh_CN",n),e.translations("fr",r),e.translations("ja",i),e.translations("ko",a)}function r(n,r,i,a,o){function s(e){i.openedInlineItem=e,t.isNil(e)||i.onInlineExpand(e)}function c(e){i.selectedItem=null,i.onItemDeselect(e),s(null)}function l(e){i.selectedItem=e,i.disableInlineContent||s(e),i.onItemSelect(e)}function u(){!function(){var e=p();i.enableMultiSelect?(t.isUndefined(t.find(i.openedInlineItem,e))&&s(null),i.selectedItems=t.filter(e,{isMultiSelected:!0})):t.isUndefined(t.find(e,i.selectedItem))&&c(i.selectedItem)}(),i.disablePagination||d()}function d(){var e=p();h.totalItems=e.length,h.totalPages=g(h.totalItems),h.currentPageIndex>=h.totalPages?i.goToFirstPage():f()}function p(){var e=r("filter")(i.items,i.tableFiltering.filter);return r("orderBy")(e,i.tableSorting.sortFunction,i.tableSorting.reverse[i.tableSorting.sortBy])}function f(){var e=o.instant,t=0===h.totalItems?0:h.currentPageIndex*m+1,n=Math.min(h.currentPageIndex*m+m,h.totalItems),r=i.resourceName||e("scac.listTable.paginationControls.defaultResourceName");i.paginationControlsText=e("scac.listTable.paginationControls",{paginationCurrentItemsMin:t,paginationCurrentItemsMax:n,paginationTotalItems:h.totalItems,paginationResourceName:r})}function g(e){var t=Math.ceil(e/m);return 0===h.totalItems&&(t=1),t}t.defaults(i,{items:[],emptyText:"",filterPlaceholderText:"",defaultFilterValue:"",selectedItems:[],onItemSelect:e.noop,onItemDeselect:e.noop,onInlineExpand:e.noop});var m=10,h={currentPageIndex:0};i.$watch(function(){return i.items},function(){t.isUndefined(i.items)||u()},!0),i.currentTableRange=function(){return i.disablePagination?{min:0,max:i.items.length}:{min:h.currentPageIndex*m,max:(h.currentPageIndex+1)*m}},i.disablePagination||(i.isFirstPage=function(){return 0===h.currentPageIndex},i.isLastPage=function(){return h.currentPageIndex===h.totalPages-1},i.nextPage=function(){i.isLastPage()||(h.currentPageIndex++,f())},i.previousPage=function(){i.isFirstPage()||(h.currentPageIndex--,f())},i.goToFirstPage=function(){h.currentPageIndex=0,f()},i.goToLastPage=function(){h.currentPageIndex=h.totalPages-1,f()}),i.tableFiltering={filter:{}},i.disableFilter||(i.tableFiltering.filter[i.filterColumn]=i.defaultFilterValue,i.clearFilter=function(){i.tableFiltering.filter[i.filterColumn]="",u()},i.showClearFilterButton=function(){var e=i.tableFiltering.filter[i.filterColumn];return t.isString(e)&&e.length>0},i.onFilterInputChange=u,i.filterKeyDown=function(e){e&&27===e.keyCode&&i.clearFilter()}),i.disableInlineContent||(i.toggleInlineExpansionAndSelectItemIfNeeded=function(e){function t(e){s(i.openedInlineItem===e?null:e)}i.enableMultiSelect?t(e):i.isItemSelected(e)?t(e):l(e)}),i.tableSorting={reverse:{},sortFunction:function(e){return e[i.tableSorting.sortBy]},sortBy:i.defaultSortColumn},i.tableSorting.sortBy&&i.defaultSortReversed&&(i.tableSorting.reverse[i.tableSorting.sortBy]=!0),i.enableMultiSelect?t.forEach(i.selectedItems,function(e){e.isMultiSelected=!0,i.onItemSelect(e)}):(i.singleSelection={selectedRadio:i.selectedItem},i.$watch("selectedItem",function(){i.singleSelection.selectedRadio=i.selectedItem,t.isNil(i.selectedItem)&&n.find('input[type="radio"]').prop("checked",!1)}),t.isNil(i.selectedItem)||(l(i.selectedItem),i.disablePagination||a(function(){!function(e){var n=p(),r=t.indexOf(n,e);-1===r?i.goToFirstPage():(h.currentPageIndex=t.floor(r/m),f())}(i.selectedItem)},100))),i.isItemSelected=function(e){return i.enableMultiSelect?!t.isUndefined(t.find(i.selectedItems,e)):i.selectedItem===e},i.selectOrDeselectItemForSingleSelect=function(e){i.isItemSelected(e)&&!i.disableDeselect?c(e):l(e)},i.isTableEmpty=function(){return 0===h.totalItems},i.tableColumns=i.displayColumns.map(function(e){function n(e){return t.isNil(e)?"":e}var r=e.disableSorting||t.isNil(e.id);return{key:e.id,header:n(e.name),getContent:function(e){return e.filter?function(t){return n(e.filter(t[e.id]))}:function(t){return n(t[e.id])}}(e),disableSorting:r,sort:function(){r||(i.tableSorting.sortBy!==e.id?i.tableSorting.sortBy=e.id:i.tableSorting.reverse[e.id]=!i.tableSorting.reverse[e.id])}}})}function i(){return{scope:{defaultSortColumn:"=?",defaultSortReversed:"=?",displayColumns:"=",filterColumn:"=?",filterPlaceholderText:"=?",filterEmptyText:"=?",defaultFilterValue:"=?",items:"=",selectedItem:"=?",selectedItems:"=?",resourceName:"=?",onItemSelect:"=?",onItemDeselect:"=?",onInlineExpand:"=?",emptyText:"=?",openedInlineItem:"=?",disableInlineContent:"=?",disablePagination:"=?",disableFilter:"=?",enableMultiSelect:"=?",disableDeselect:"<?"},transclude:!0,templateUrl:"storageConsoleCommon/components/storageConsoleListTable/storageConsoleListTable.tpl.html",controller:"StorageConsoleListTableController"}}n.$inject=["$translateProvider"],r.$inject=["$element","$filter","$scope","$timeout","$translate"],e.module("storageconsole.common").config(n).controller("StorageConsoleListTableController",r).directive("storageConsoleListTable",i).filter("range",function(){return t.slice})}(),function(){e.module("storageconsole.common").controller("StorageConsolePipelineController",["$scope","defaultValue",function(e,t){t(e,"currentStep",e.steps[0]),t(e,"highlightLastStep",!1),e.determineBelowText=function(e,t,n){if(e===t){if(n.currentText)return n.currentText;if(""===n.currentText)return n.currentText}else if(e<t){if(e===t-1&&n.belowOnePastText)return n.belowOnePastText;if(n.pastText)return n.pastText}return n.belowText?n.belowText:n.main},e.$watch("currentStep",function(){e.selectedIndex=e.steps.indexOf(e.currentStep)})}]),e.module("storageconsole.common").directive("storageConsolePipeline",[function(){return{scope:{steps:"=",currentStep:"=?",highlightLastStep:"=?"},templateUrl:"storageConsoleCommon/components/storageConsolePipeline/storageConsolePipeline.tpl.html",controller:"StorageConsolePipelineController"}}])}(),function(){function n(e,n,r){function i(i,a,o){function s(){var e={SVG:"svg",RECT:"rect",GROUP:"g",CLIP_PATH:"clipPath",LINE:"line",PATH:"path",XLINK:"a"},a=i.width?i.width:140,o=i.height?i.height:.3*a,s=a-10,l=o-10,u="clip-"+i.sparklineId,d=function(){var t=c.select("#"+i.sparklineId);return t.selectAll(e.SVG).remove(),t.append(e.SVG).attr("width",a).attr("height",o)}(),p=function(t){var s=function(t){return i.href?t.append(e.XLINK).attr("xlink:href",i.href).attr("target","_blank").on("click",function(){n.Clog.log({key:r.SPARKLINE_CLICKED,value:1,detail:{sparklineId:i.sparklineId,url:i.href}})}):t}(t).append(e.GROUP).attr("transform","translate(2, 2)");return s.append(e.RECT).attr("x",0).attr("y",0).attr("width",a-4).attr("height",o-4).attr("class","border outer").style("stroke-width",4),s}(d),f=function(t){var n=t.append(e.GROUP).attr("transform","translate(2.5, 2.5)");return n.append(e.RECT).attr("x",0).attr("y",0).attr("width",s+1).attr("height",l+1).attr("class","border inner").style("stroke-width",1),n}(p);!function(t){t.append(e.CLIP_PATH).attr("id",u).append(e.RECT).attr("x",0).attr("y",0).attr("width",s+1).attr("height",l+1).attr("class","clip")}(f);var g=function(e){return e.append("g").attr("transform","translate(0.5, 0.5)")}(f);!function(t){if(i.tickCountYAxis)for(var n=l/(i.tickCountYAxis+1),r=1;r<=i.tickCountYAxis;r++){var a=n*r;t.append(e.LINE).attr("class","grid y").attr("x1",0).attr("y1",a).attr("x2",s).attr("y2",a)}}(g),function(n,r){function a(e,n){return!t.isNil(e)&&n&&(e=new Date(1e3*e)),e}var o=!0===i.isXDate,d=function(e,t,n,r,i){var o=e.map(function(e){return{x:a(e[t],r),y:e[n]}});return!1!==i&&o.sort(function(e,t){return c.ascending(e.x,t.x)}),o}(i.data,i.keyXAxis,i.keyYAxis,o,i.sortByX),p=void 0;p=o?c.time.scale().range([0,s]):c.scale.linear().range([0,s]);var f=c.scale.linear().range([l,0]);p.domain(function(e,n,r){e||(e={});var i=e.min,o=e.max;return i=a(i,n),o=a(o,n),t.isNil(i)&&(i=c.min(r,function(e){return e.x})),t.isNil(o)&&(o=c.max(r,function(e){return e.x})),[i,o]}(i.domainX,o,d)),f.domain(function(e,n,r){e||(e={});var i=e.min,a=e.max;return t.isNil(i)&&(i=c.min(n,function(e){return e.y})),t.isNil(a)&&(a=c.max(n,function(e){return e.y})),r&&r.forEach(function(e){if(!e.isPercentage){var t=e.value;i=t<i?t:i,a=t>a?t:a}}),[i,a]}(i.domainY,d,i.dashedHorizontalLines));var g=c.svg.line().x(function(e){return p(e.x)}).y(function(e){return f(e.y)}).defined(function(e){return e&&!t.isNil(e.y)}),m=c.svg.area().x(function(e){return p(e.x)}).y0(l).y1(function(e){return f(e.y)}).defined(g.defined());n.append(e.PATH).datum(d).attr("class","area").attr("d",m).attr("clip-path","url(#"+u+")"),n.append(e.PATH).datum(d).attr("class","line").attr("d",g).attr("clip-path","url(#"+u+")"),i.dashedHorizontalLines&&i.dashedHorizontalLines.forEach(function(t){var r=void 0;r=t.isPercentage?l*(t.value/100):f(t.value);var i=n.append(e.LINE).attr("class","dashed").attr("x1",0).attr("y1",r).attr("x2",s).attr("y2",r);t.color&&i.style("stroke",t.color),t.pattern&&i.style("stroke-dasharray",t.pattern)}),0===d.length&&r.classed("disable",!0)}(g,d),function(e){e.on("mouseover",function(){e.classed("hover",!0)}).on("mouseout",function(){e.classed("hover",!1)})}(d)}var c=e.d3;i.$watch("data",function(e){e&&s()},!0),a.on("$destroy",function(){i.$destroy()})}return{restrict:"E",scope:{sparklineId:"=",data:"=",keyXAxis:"=",keyYAxis:"=",isXDate:"=?",sortByX:"=?",domainX:"=?",domainY:"=?",width:"=?",height:"=?",href:"=?",tickCountYAxis:"=?",dashedHorizontalLines:"=?"},link:i,template:'<div class="sc-sparkline" id="{{ sparklineId }}"</div>'}}n.$inject=["$window","AWSC","SPARKLINE_DIRECTIVE_METRICS"],e.module("storageconsole.common").constant("SPARKLINE_DIRECTIVE_METRICS",{SPARKLINE_CLICKED:"SparklineClicked"}).directive("storageConsoleSparkline",n)}(),function(){e.module("storageconsole.common").controller("StorageConsoleTagsController",["$scope","$translate",function(t,n){t.savedPairs=e.copy(t.tagPairs),t.dirtied=!1,t.displayErrors=!1,t.keyValueArray=[],t.isValidKey=function(e){var n=t.keyValueArray[e];return!t.validation.key||n.key.match(t.validation.key.regex)},t.isValidValue=function(e){var n=t.keyValueArray[e];return!t.validation.value||n.value.match(t.validation.value.regex)},t.showInvalidKeyError=function(){return t.validation.key&&t.keyValueArray.some(function(e,n){return!t.isValidKey(n)})},t.showInvalidValueError=function(){return t.validation.value&&t.keyValueArray.some(function(e,n){return!t.isValidValue(n)})},t.numSavedPairs=function(){return Object.keys(t.savedPairs).length},t.valueWithoutKey=function(){return t.keyValueArray&&t.keyValueArray.some(function(e){return""===e.key&&""!==e.value})},t.arrayToHash=function(e){var t={};return e.map(function(e){""!==e.key&&(t[e.key]=e.value)}),t},t.duplicateKeys=function(){for(var n=e.copy(t.keyValueArray).sort(function(e,t){return e.key>t.key?1:e.key<t.key?-1:0}),r=[],i=0;i<n.length-1;i++)""!==n[i+1].key&&n[i+1].key==n[i].key&&r.push(n[i+1]);return t.showDuplicateKeyError=r.length>0,r},t.pairInArray=function(e,t){if(e)for(var n=0;n<e.length;n++)if(t.key===e[n].key&&t.value===e[n].value)return!0;return!1},t.pairInHash=function(e,t){return e&&t&&e[t.key]===t.value},t.filteredKeys=function(){return t.tagPairs?Object.keys(t.tagPairs).filter(function(e){return""!==e}):[]},t.toggleEditing=function(e){var n=t.keyValueArray[e];n.editing=!n.editing,n.key=n.originalKey,n.value=n.originalValue},t.removeTag=function(n){var r=t.keyValueArray[n].originalKey;if(t.numSavedPairs()<=n&&t.pairInArray(t.duplicateKeys(),t.keyValueArray[n]))return t.keyValueArray.splice(n,1),t.duplicateKeys(),void t.addNewField();var i=function(){delete t.tagPairs[r],t.keyValueArray.splice(n,1),t.duplicateKeys(),t.addNewField()};if(t.pairInHash(t.savedPairs,t.keyValueArray[n])){var a=function(){if(t.saveOnDelete){var n=e.copy(t.savedPairs);delete n[r];var a=function(){i(),t.savedPairs=n,t.addNewField()};(!t.onSave||t.onSave(n,t.savedPairs,a))&&a()}else i()};(!t.onDelete||t.onDelete(r,t.tagPairs[r],a))&&a()}else i()},t.keyValueChanged=function(e){t.dirtied=!0,t.displayErrors=!1,t.cleanEmptyFields()},t.addNewField=function(){var e=t.keyValueArray.filter(function(e){return""===e.key&&""===e.value});(void 0===t.limit||t.keyValueArray.length<t.limit)&&0===e.length&&t.keyValueArray.push({originalKey:"",originalValue:"",key:"",value:""})},t.cleanEmptyFields=function(){if(t.keyValueArray.filter(function(e){return""===e.key&&""===e.value&&!e.editingKey&&!e.editingValue}).length>1){for(var e=t.keyValueArray.length-1;e>=0;e--)""===t.keyValueArray[e].key&&""===t.keyValueArray[e].value&&t.keyValueArray.splice(e,1);t.keyValueArray.push({originalKey:"",originalValue:"",key:"",value:"",unsaved:!0})}},t.cancel=function(){var e=function(){t.dirtied=!1,t.displayErrors=!1,t.refreshKeyValueArray()};(!t.onCancel||t.onCancel(e))&&e()},t.save=function(){if(t.duplicateKeys().length>0)return void(t.displayErrors=!0);var n=function(){t.dirtied=!1,t.displayErrors=!1,e.copy(t.arrayToHash(t.keyValueArray),t.tagPairs),t.savedPairs=e.copy(t.tagPairs)};(!t.onSave||t.onSave(t.arrayToHash(t.keyValueArray),t.savedPairs,n))&&n()},t.refreshKeyValueArray=function(){t.keyValueArray=[],t.filteredKeys().map(function(e){t.keyValueArray.push({originalKey:e,originalValue:t.tagPairs[e],key:e,value:t.tagPairs[e]})}),t.addNewField()},t.$watch("tagPairs",function(){t.refreshKeyValueArray()},!0)}]),e.module("storageconsole.common").directive("storageConsoleTags",[function(){return{scope:{tagPairs:"=",readOnlyPairs:"=?",onCancel:"=?",onSave:"=?",saveLoading:"=?",onDelete:"=?",saveOnDelete:"=?",limit:"=?",buttons:"=?",keysUnique:"=?",hideWarnings:"=?",editable:"=?",keyValueArray:"=?",validation:"=?",locale:"@?"},templateUrl:"storageConsoleCommon/components/storageConsoleTags/storageConsoleTags.tpl.html",controller:"StorageConsoleTagsController"}}]),e.module("storageconsole.common").config(["$translateProvider",function(e){var t={"tagging.header.key":"Key","tagging.header.value":"Value","tagging.placeholder.key":"Add a new key","tagging.placeholder.value":"Add a new value","tagging.button.save":"Save","tagging.button.cancel":"Cancel","tagging.errors.invalidKey.header":"Invalid key error","tagging.errors.invalidKey.unique":"Keys must be unique.","tagging.errors.invalidValue.header":"Invalid value error","tagging.errors.invalidValue.none":"Tags without keys will be ignored.","tagging.errors.max":"You cannot attach more than {{ limit }} tags to this resource.","tagging.key.noValue":"no value","label.important":"Important"},n={"tagging.header.key":"键","tagging.header.value":"值","tagging.placeholder.key":"添加新密钥","tagging.placeholder.value":"添加新值","tagging.button.save":"保存","tagging.button.cancel":"取消","tagging.errors.invalidKey.header":"无效键错误","tagging.errors.invalidKey.unique":"标签键必须是唯一的。","tagging.errors.invalidValue.header":"无效值错误","tagging.errors.invalidValue.none":"无键标签将被忽略。","tagging.errors.max":"此资源不能超过 {{ limit }} 个标签。","tagging.key.noValue":"无值","label.important":"重要提示"},r={"tagging.header.key":"Clé","tagging.header.value":"Valeur","tagging.placeholder.key":"Ajouter une nouvelle clé","tagging.placeholder.value":"Ajouter une nouvelle valeur","tagging.button.save":"Enregistrer","tagging.button.cancel":"Annuler","tagging.errors.invalidKey.header":"Erreur de clé non valide","tagging.errors.invalidKey.unique":"Les clés doivent être uniques.","tagging.errors.invalidValue.header":"Erreur de valeur non valide","tagging.errors.invalidValue.none":"Les balises sans clés seront ignorées.","tagging.errors.max":"Vous ne pouvez pas attacher plus de {{limit}} balises à cette ressource.","tagging.key.noValue":"Aucune valeur","label.important":"Important"},i={"tagging.header.key":"キー","tagging.header.value":"値","tagging.placeholder.key":"新しいキーを追加","tagging.placeholder.value":"新しい値を追加","tagging.button.save":"保存","tagging.button.cancel":"キャンセル","tagging.errors.invalidKey.header":"無効なキーのエラー","tagging.errors.invalidKey.unique":"タグキーは一意である必要があります。","tagging.errors.invalidValue.header":"無効な値のエラー","tagging.errors.invalidValue.none":"キーのないタグは無視されます。","tagging.errors.max":"このリソースには {{limit}} 個以上のタグをアタッチすることはできません。","tagging.key.noValue":"値なし","label.important":"重要"},a={"tagging.header.key":"키","tagging.header.value":"값","tagging.placeholder.key":"새 키 추가","tagging.placeholder.value":"새 값 추가","tagging.button.save":"저장","tagging.button.cancel":"취소","tagging.errors.invalidKey.header":"잘못된 키 오류","tagging.errors.invalidKey.unique":"키는 고유해야 합니다.","tagging.errors.invalidValue.header":"잘못된 값 오류","tagging.errors.invalidValue.none":"키가 없는 태그는 무시됩니다.","tagging.errors.max":"이 리소스에는 {{ limit }}개보다 많은 태그를 연결할 수 없습니다.","tagging.key.noValue":"값이 없음","label.important":"중요"};e.translations("en",t),e.translations("en_US",t),e.translations("zh",n),e.translations("zh_CN",n),e.translations("fr",r),e.translations("ja",i),e.translations("ko",a)}])}(),function(){function n(){return function(n){if(!e.isString(n)||0===n.length)throw new Error("ARN must be a non-empty string. Expected ARN structure: arn:<partition>:<vendor>:<region>:<namespace>:<relative-id>");var r=n.split(":");if(this.partition=r[1],this.vendor=r[2],this.region=r[3],this.namespace=r[4],r.length>6){var i=t.takeRight(r,r.length-5);this.relativeId=t.join(i,"/")}else this.relativeId=r[5];this.fullArn=n}}e.module("storageconsole.common.services").factory("Arn",n)}(),function(){function t(e,t){var n=function(e){t.call(this,e),this.serviceName=this.vendor,this.accountId=this.namespace,this.pathPrefix=function(e){var t=e.split("/");return t.shift(),t.pop(),t.join("/")}(this.relativeId),this.resourceName=function(e){var t=e.split("/");return t[t.length-1]}(this.relativeId),this.resourceType=function(e,t,n){var r=e.split("/")[0];return"s3"===t&&n===r?"bucket":r}(this.relativeId,this.serviceName,this.resourceName)};return n.prototype=e.Object.create(t.prototype),n.prototype.constructor=t,n}t.$inject=["$window","Arn"],e.module("storageconsole.common.services").factory("AwsArn",t)}(),function(){function n(e,n,r,i){function a(e){var n=e.serviceName,a=e.resourceType,o=e.resourceName,c=e.pathPrefix,l=e.region;l||(l=i.getCurrentRegion());var u="",d=void 0;if(d=c&&t.get(s,n+"."+a+".withPathPrefix")?t.get(s,n+"."+a+".withPathPrefix"):t.get(s,n+"."+a+".withoutPathPrefix"),d&&(d=d.replace("${pathPrefix}",c),u=d.replace("${resourceName}",o)),"s3"===n){var p=u;return r.getConsoleServiceUrl(n,l,"",p)}return r.getConsoleServiceUrl(n,l,u)}function o(e){return'<sc-a href="'+e.deepLink+'" text="\''+e.resourceName+'\'" show-external-link-icon="true" target="_blank"></sc-a>'}var s={iam:{role:{withoutPathPrefix:"#/roles/${resourceName}"}},s3:{bucket:{withoutPathPrefix:"buckets/${resourceName}"}},kinesis:{stream:{withoutPathPrefix:"#/streams/details?streamName=${resourceName}"}},firehose:{deliverystream:{withoutPathPrefix:"#/details/${resourceName}?edit=false"}},lambda:{function:{withoutPathPrefix:"#/functions/${resourceName}?tab=configuration",withPathPrefix:"#/functions/${pathPrefix}/${resourceName}?tab=configuration"}},es:{domain:{withoutPathPrefix:"#${resourceName}:dashboard"}}},c=function(e){n.call(this,e),this.deepLink=a(this),this.deepLinkHtml=o(this)};return c.prototype=e.Object.create(n.prototype),c.prototype.constructor=n,c}n.$inject=["$window","AwsArn","AwsUrlsService","Region"],e.module("storageconsole.common.services").factory("AwsResource",n)}(),function(){function t(t,n){return function(r){function i(e){return e.substring(a)}var a="alias/".length,o=/^alias\/.+/,s=/^[a-zA-Z0-9_-]+$/,c="The passed-in KMS key must be a non-empty string. Expected structure: <key-id>, alias/<alias-name>, arn:<partition>:kms:<region>:<account-id>:key/<key-id> or arn:<partition>:kms:<region>:<account-id>:alias/<alias-name>.";if(!e.isString(r)||0===r.length)throw new Error(c);try{this.inputKmsKey=r;var l=new t(r);if(this.keyAccountId=l.accountId,this.keyRegion=l.region,"key"===l.resourceType)this.keyType=n.KEY_ARN,this.keyArn=r,this.keyId=l.resourceName,this.keyArnObj=l;else{if("alias"!==l.resourceType)throw new Error(c);this.keyType=n.ALIAS_ARN,this.aliasArn=r,this.aliasNameWithPrefix=l.relativeId,this.aliasName=i(this.aliasNameWithPrefix),this.aliasArnObj=l}}catch(e){if(o.test(r))this.keyType=n.ALIAS_NAME,this.aliasNameWithPrefix=r,this.aliasName=i(this.aliasNameWithPrefix);else{if(!s.test(r))throw new Error(c);this.keyType=n.KEY_ID,this.keyId=r}}}}t.$inject=["AwsArn","KMS_KEY_TYPE"],e.module("storageconsole.common.services").constant("KMS_KEY_TYPE",{KEY_ARN:"KEY_ARN",ALIAS_ARN:"ALIAS_ARN",KEY_ID:"KEY_ID",ALIAS_NAME:"ALIAS_NAME"}).factory("KmsKey",t)}();var r;!function(t){!function(t){!function(t){function n(e){return function(){function t(t){this.getQualifierType=function(e){var t=new RegExp("(\\$LATEST|^[0-9]*$)"),n=new RegExp("(?!^[0-9]+$)(^[a-zA-Z0-9-_]*$)");if(t.test(e))return r.VERSION;if(n.test(e))return r.ALIAS;throw new Error("Invalid qualifier: "+e)};var n=new e(t);if(n.serviceName!==i)throw new Error(n.serviceName+" is not Lambda service");this.functionName=n.pathPrefix||n.resourceName,this.qualifier=n.pathPrefix?n.resourceName:"$LATEST",this.qualifierType=this.getQualifierType(this.qualifier),this.deepLink=n.deepLink}return t}()}n.$inject=["AwsResource"];var r=function(){function e(){}return e}();r.ALIAS="alias",r.VERSION="version",t.LAMBDA_QUALIFIER_TYPE=r;var i="lambda";e.module("storageconsole.common.services").factory("LambdaFunctionResource",n)}(t.services||(t.services={}))}(t.common||(t.common={}))}(r||(r={}));var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function n(n,r,a,o){return function(s,c){function l(e){return s.proxyService[s.methodName](s.requestParams).catch(function(t){var a=e.curRetryCount+1;if(!d(t,c,a))return n.reject(t);var o=function(){var t=u(c,a),n=r(function(){r.cancel(n)},t,1);return{v:n.then(function(){return e.curRetryCount++,l(e)})}}();return"object"===(void 0===o?"undefined":i(o))?o.v:void 0})}function u(e,t){return e.backOffStrategy?e.backOffStrategy(t):500}function d(e,t,n){return p(e,t)&&f(t,n)}function p(e,t){for(var n=o.proxyErrorHandler(e),r=t.errorsToRetryOn||[],i=0;i<r.length;i++){var a=r[i];if(a.errorType===n.errorType&&(!a.errorMessage||n.errorMessage.match(a.errorMessage)))return!0}return!1}function f(e,n){return n<=(t.get(e,"numberOfRetries")||3)}function g(t){return!e.isString(t)||0===t.length||t.length>32}!function(t,n){if(!e.isObject(t)||!e.isObject(n))throw new Error("Invalid ProxyCallConfig/ RetryConfig.");if(!e.isObject(t.proxyService))throw new Error("Invalid ProxyService. Make sure to specify valid proxy service in proxyCallConfig");if(!e.isString(t.methodName)||0===t.methodName.length)throw new Error("methodName must be a non-empty string.");if(g(n.retrySuccessMetricName)||g(n.retryCountMetricName))throw new Error("Invalid metric name. Metric name must be a string <= 32 characters length.");if(!e.isArray(n.errorsToRetryOn)||0===n.errorsToRetryOn.length)throw new Error("Invalid configuration for errors to retry on.")}(s,c),this.makeCall=function(){var e={curRetryCount:0},t=c.retrySuccessMetricName;return l(e).then(function(r){return a.Clog.log(t,1,{numRetries:e.curRetryCount}),n.when(r)}).catch(function(r){return a.Clog.log(t,0,{numRetries:e.curRetryCount}),n.reject(r)}).finally(function(){a.Clog.log(c.retryCountMetricName,e.curRetryCount)})}}}n.$inject=["$q","$interval","AWSC","ProxyErrorAdapter"],e.module("storageconsole.common.services").factory("ProxyRequestWithRetries",n)}(),function(){function n(n,r,i){function a(e,t,n,i){for(var a=r.defer(),s=arguments.length,c=Array(s>4?s-4:0),l=4;l<s;l++)c[l-4]=arguments[l];return o(a,Date.now(),0,e,t,n,i,c),a.promise}function o(r,a,s,c,g,m,h,b){function v(){if(e.isDefined(S)&&(i.cancel(S),S=void 0),!n.has(c))throw new Error("No service called "+c+" exists. Provide a valid service name.");n.get(c)[g](m).then(function(e){var n=e.response,i=t.reduce(h,function(e,t){return e[t]},n);if(t.includes(b,i))return r.resolve({response:n});var l=f[c];if(t.includes(l,i))return r.reject({response:{__type:p.unexpectedState,message:"The "+c+" "+g+" call returned a steady state "+i+", but it was not one of the desired states listed: '"+b+"' for request '"+m+"'."}});o(r,a,++s,c,g,m,h,b)}).catch(function(e){if(/ResourceNotFoundException/.test(e.response.__type))return t.includes(b,"DELETED")?r.resolve({response:{ResourceStatus:"DELETED"}}):r.reject({response:{__type:p.resourceNotFound,message:"The "+c+" "+g+" call returned a ResourceNotFoundException for request '"+m+"'."}});o(r,a,++s,c,g,m,h,b)})}if(Date.now()-a>d)return r.reject({response:{__type:p.timeout,message:"Timeout exceeded while waiting for "+c+" "+g+" to return expected state(s) "+b+" for request "+m}});var E=u*Math.pow(s,l),S=i(v,E,1)}function s(e){u=e}function c(e){d=e}var l=1.5,u=100,d=9e4,p={resourceNotFound:"resourceNotFound",timeout:"timeout",unexpectedState:"unexpectedState"},f={KinesisAnalyticsService:["READY","RUNNING"],KinesisService:["ACTIVE"]};return{setInitialDelayMillis:s,setmaxTimeoutMillis:c,waitForState:a}}n.$inject=["$injector","$q","$interval"],e.module("storageconsole.common").service("AsyncService",n)}.call(void 0);var r;!function(n){!function(n){!function(n){function r(e,n){function r(e,t,r,i,s){if(void 0===i&&(i=""),void 0===s&&(s=""),!o(e,t))throw new Error("Service and resource type not supported.");var c=n.getCloudSystem(),l=n.DOMAINS[c].ARN;return a(e,t)?""+l+e+":"+s+":"+i+":"+t+"/"+r:""+l+e+":"+s+":"+i+":"+r}function a(e,t){return"kinesis"===e&&"stream"===t||"iam"===e&&"role"===t||"iam"===e&&"policy"===t||"kms"===e&&"key"===t}function o(e,n){return-1!==t.findIndex(s,{service:e,resourceType:n})}var s=[new i("s3","bucket"),new i("es","domain"),new i("kinesis","stream"),new i("iam","policy"),new i("iam","role"),new i("kms","key")];return{build:r}}r.$inject=["$location","Region"];var i=function(){function e(e,t){this.service=e,this.resourceType=t}return e}();e.module("storageconsole.common").factory("AwsArnBuilder",r)}(n.awsArnBuilder||(n.awsArnBuilder={}))}(n.services||(n.services={}))}(r||(r={})),function(){function t(t,n,r,i){function a(){var a=void 0;try{a=new n(e.fromJson(function(){return t.get("aws-userInfo")}()).arn).accountId}catch(e){i.Clog.log(r.GET_USER_ACCOUNT_ID_FROM_COOKIE_PARSE_ERROR,1,{errorMessage:e})}return a||i.Clog.log(r.GET_USER_ACCOUNT_ID_FROM_COOKIE_FAILURE,1),a}return{bestEffortGetUserAccountId:a}}t.$inject=["$cookies","AwsArn","AWS_COOKIES_METRICS","AWSC"];var n=e.module("storageconsole.common.services");n.constant("AWS_COOKIES_METRICS",{GET_USER_ACCOUNT_ID_FROM_COOKIE_PARSE_ERROR:"getAwsIdFromCookie_ParseError",GET_USER_ACCOUNT_ID_FROM_COOKIE_FAILURE:"getAwsIdFromCookie_Failure"}),n.service("AwsCookiesService",t)}(),function(){function n(e,n,r,i,a){function o(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?"":arguments[3];return k(e)?s(e,t,n):"s3"===e?A()+"/"+e+"/"+r+"?region="+t+n:A()+"/"+e+"/home?region="+t+n}function s(t,n,r){var i="";return R()&&(i=":"+e.port()),e.protocol()+"://"+e.host()+i+"/"+t+"/home?region="+n+r}function c(e){return A()+"/support/home#/case/create?issueType=service-limit-increase&limitType=service-code-"+e}function l(e,t){return t&&t[I]?t[I]:y()+"/"+e}function u(e,t){return t&&t[I]?t[I]:C()+"/"+e}function d(e,t){return t&&t[I]?t[I]:_()+"/"+e}function p(){var e=S();return e?e.CLOUD_SYSTEM:n.PUBLIC}function f(){var e=S();return e?e.STAGE:i.PROD}function g(e,t){return t&&t[I]?t[I]:I==n.BJS?"https://forums.aws.csdn.net":"https://forums.aws.amazon.com/forum.jspa?forumID="+e}function m(e){var n=r.getCurrentRegion();return t.isString(e)?o("lambda",n,"#/create/new?bp="+e):o("lambda",n,"")}function h(e){var n=r.getCurrentRegion();return t.isString(e)?o("cloudformation",n,"#/stacks/new?templateURL="+e):o("cloudformation",n,"#/stacks/new")}function b(e,n){var r={de:"de",en:"en",es:"es",fr:"fr",ko:"ko",ja:"jp",pt_BR:"pt",zh:"cn",zh_CN:"cn"};return u(t.get(r,a,r.en)+"/"+e,n)}function v(e,n){return!!t.isArray(n)&&t.find(n,function(n){return t.includes(e,n)})}function E(){return[{PATTERNS:["integ-bjs.integ.amazonaws.cn","awsc-integ.amazonaws.cn"],CLOUD_SYSTEM:n.BJS,STAGE:i.GAMMA},{PATTERNS:["console.amazonaws.cn","preprod-bjs.integ.amazonaws.cn"],CLOUD_SYSTEM:n.BJS,STAGE:i.PROD},{PATTERNS:["integ.dca.amazon.com"],CLOUD_SYSTEM:n.DCA,STAGE:i.GAMMA},{PATTERNS:["console.c2shome.ic.gov"],CLOUD_SYSTEM:n.DCA,STAGE:i.PROD},{PATTERNS:["awsc-integ.sc2shome.sgov.gov"],CLOUD_SYSTEM:n.LCK,STAGE:i.GAMMA},{PATTERNS:["console.sc2shome.sgov.gov"],CLOUD_SYSTEM:n.LCK,STAGE:i.PROD},{PATTERNS:["desktop.amazon.com","aka.corp.amazon.com","aka.amazon.com"],CLOUD_SYSTEM:n.PUBLIC,STAGE:i.GAMMA},{PATTERNS:["l10n-testing"],CLOUD_SYSTEM:n.PUBLIC,STAGE:i.GAMMA},{PATTERNS:["staging.integ.amazonaws-us-gov.com"],CLOUD_SYSTEM:n.PDT,STAGE:i.GAMMA},{PATTERNS:["console.amazonaws-us-gov.com","preprod.integ.amazonaws-us-gov.com"],CLOUD_SYSTEM:n.PDT,STAGE:i.PROD},{PATTERNS:["integ.aws.amazon.com"],CLOUD_SYSTEM:n.PUBLIC,STAGE:i.GAMMA},{PATTERNS:["console.aws.amazon.com","preprod.aws.amazon.com"],CLOUD_SYSTEM:n.PUBLIC,STAGE:i.PROD}]}function S(){var n=e.host();return t.find(E(),function(e){return v(n,e.PATTERNS)})}function y(){return w(M)}function A(){return w(N)}function C(){return w(L)}function _(){return w(x)}function w(e){return e[I]?e[I][P]?e[I][P]:e[I][i.PROD]:e[n.PUBLIC][P]?e[n.PUBLIC][P]:e[n.PUBLIC][i.PROD]}function T(e){try{return e.split("/")[3].split("/home")[0]}catch(e){return""}}function R(){return e.port()&&0!==e.port().length}function O(e){return t.includes(e,"l10n-testing")}function k(t){try{return(R()||O(e.host()))&&T(e.absUrl())===t}catch(e){return!1}}var I="",P="",N=function(){var e={};return e[n.BJS]={},e[n.DCA]={},e[n.LCK]={},e[n.PDT]={},e[n.PUBLIC]={},e[n.BJS][i.GAMMA]="https://aws-console-platform-proxy-integ-bjs.integ.amazonaws.cn",e[n.BJS][i.PROD]="https://cn-north-1.console.amazonaws.cn",e[n.DCA][i.GAMMA]="https://awsc-integ.dca.amazon.com",e[n.DCA][i.PROD]="https://console.c2shome.ic.gov",e[n.LCK][i.GAMMA]="https://awsc-integ.sc2shome.sgov.gov",e[n.LCK][i.PROD]="https://console.sc2shome.sgov.gov",e[n.PDT][i.GAMMA]="https://aws-console-proxy-staging.integ.amazonaws-us-gov.com",e[n.PDT][i.PROD]="https://us-gov-west-1.console.amazonaws-us-gov.com",e[n.PUBLIC][i.GAMMA]="https://awsc-integ.aws.amazon.com",e[n.PUBLIC][i.PROD]="https://console.aws.amazon.com",e}(),M=function(){var e={};return e[n.BJS]={},e[n.DCA]={},e[n.LCK]={},e[n.PDT]={},e[n.PUBLIC]={},e[n.BJS][i.PROD]="https://docs.amazonaws.cn",e[n.DCA][i.PROD]="https://docs.c2shome.ic.gov",e[n.LCK][i.PROD]="https://docs.sc2shome.sgov.gov",e[n.PDT][i.PROD]="https://docs.aws.amazon.com",e[n.PUBLIC][i.PROD]="https://docs.aws.amazon.com",e}(),L=function(){var e={};return e[n.BJS]={},e[n.DCA]={},e[n.LCK]={},e[n.PDT]={},e[n.PUBLIC]={},e[n.BJS][i.PROD]="https://www.amazonaws.cn",e[n.DCA][i.PROD]="http://www.c2shome.ic.gov",e[n.LCK][i.PROD]="http://www.sc2shome.sgov.gov",e[n.PDT][i.PROD]="https://aws.amazon.com",e[n.PUBLIC][i.PROD]="https://aws.amazon.com",e}(),x=function(){var e={};return e[n.PUBLIC]={},e[n.PUBLIC][i.GAMMA]="https://spaceneedle-beta.amazon.com",e[n.PUBLIC][i.PROD]="https://quicksight.aws.amazon.com",e}(),D={getCloudFormationNewStackUrl:h,getCloudSystem:p,getConsoleServiceUrl:o,getDocUrl:l,getForumUrl:g,getLambdaBlueprintUrl:m,getMarketingUrl:u,getLocalizedMarketingUrl:b,getQuicksightUrl:d,getServiceLimitIncreaseUrl:c,getStage:f};return function(){I=p(),P=f()}(),D}n.$inject=["$location","CLOUD_SYSTEMS","Region","STAGES","LOCALE"],e.module("storageconsole.common.services").service("AwsUrlsService",n)}(),function(){function t(e){e.decorator("$exceptionHandler",n)}function n(e,t){return function(n,r){try{t.TraceKit.report(n)}catch(e){}e(n,r)}}function r(t){function n(){t.TraceKit.report.subscribe(function(n){t.AWSC&&t.AWSC.Clog&&t.AWSC.Clog.log&&t.AWSC.Clog.log({key:"clientSideError",value:1,logLevel:"WARN",metricType:"custom",detail:e.toJson({errorMessage:n.message,stackTrace:n.stack})})})}return{subscribeErrorReport:n}}function i(e){e.TraceKit.remoteFetching=!1}t.$inject=["$provide"],n.$inject=["$delegate","$window"],r.$inject=["$window"],i.$inject=["$window"];var a=e.module("storageconsole.exceptionHandler",[]);a.config(t),a.service("TraceKitService",r),a.run(i)}(),function(){function n(e){function n(){var n={},r=t.random(s.stockSectors.length-1),i=s.stockSectors[r],a=t.random(i.stocks.length-1),c=i.stocks[a];n[e.TICKER_SYMBOL]=c.ticker_symbol,n[e.SECTOR]=i.name;var l=t.random(-1,1,!0),u=l*i.volatilityPercentage*c.price/100,d=c.price+u;return d>o?(s.stockSectors[r].stocks[a].price=t.round(d,2),n[e.CHANGE]=t.round(u,2),n[e.PRICE]=t.round(d,2)):(n[e.CHANGE]=0,n[e.PRICE]=c.price),n}function r(){var e={},r=n();return t.keys(r).forEach(function(t){e[t.toLowerCase()]=r[t]}),e}function i(e){return t.isEmpty(t.xor(e,a))}var a=["TICKER_SYMBOL","SECTOR","CHANGE","PRICE"],o=1,s={getRandomizedDemoData:n,getRandomizedLowerCaseDemoData:r,schemaMatches:i,stockSectors:[{name:"RETAIL",volatilityPercentage:5,stocks:[{ticker_symbol:"ABC",price:24.78},{ticker_symbol:"BFH",price:17.05},{ticker_symbol:"WMT",price:70.51},{ticker_symbol:"PJN",price:32.8},{ticker_symbol:"WSB",price:8.74},{ticker_symbol:"QXZ",price:52.15},{ticker_symbol:"MJN",price:152.38},{ticker_symbol:"TGT",price:68.39},{ticker_symbol:"DFT",price:96.49},{ticker_symbol:"WAS",price:12.51}]},{name:"HEALTHCARE",volatilityPercentage:7,stocks:[{ticker_symbol:"VVY",price:34.85},{ticker_symbol:"SED",price:2.2},{ticker_symbol:"TBV",price:191},{ticker_symbol:"PPL",price:30.28},{ticker_symbol:"XTC",price:113.04},{ticker_symbol:"QXZ",price:86.74},{ticker_symbol:"NGC",price:5.09},{ticker_symbol:"AZL",price:17.67},{ticker_symbol:"JYB",price:45.22},{ticker_symbol:"CRM",price:29.62}]},{name:"ENERGY",volatilityPercentage:10,stocks:[{ticker_symbol:"NFS",price:100.95},{ticker_symbol:"ALY",price:89.1},{ticker_symbol:"KIN",price:5.05},{ticker_symbol:"KFU",price:41.97},{ticker_symbol:"SLW",price:75.8},{ticker_symbol:"DEG",price:5.81},{ticker_symbol:"MMB",price:21.35},{ticker_symbol:"HJV",price:205},{ticker_symbol:"VVS",price:15.27},{ticker_symbol:"SAC",price:55.57}]},{name:"FINANCIAL",volatilityPercentage:3,stocks:[{ticker_symbol:"WFC",price:46.79},{ticker_symbol:"BAC",price:14.85},{ticker_symbol:"ASD",price:65.8},{ticker_symbol:"RFV",price:50.85},{ticker_symbol:"WSB",price:110.53},{ticker_symbol:"QXZ",price:218.91},{ticker_symbol:"UHN",price:543.97},{ticker_symbol:"TGH",price:66.03},{ticker_symbol:"PLM",price:19.38},{ticker_symbol:"QAZ",price:195.03}]},{name:"TECHNOLOGY",volatilityPercentage:2,stocks:[{ticker_symbol:"HJK",price:4.78},{ticker_symbol:"NFLX",price:99},{ticker_symbol:"CVB",price:52.82},{ticker_symbol:"AMZN",price:735.51},{ticker_symbol:"BNM",price:176.16},{ticker_symbol:"AAPL",price:101.64},{ticker_symbol:"QWE",price:218.04},{ticker_symbol:"JKL",price:15.1},{ticker_symbol:"IOP",price:118.76},{ticker_symbol:"DFG",price:136.21}]}]};return s}n.$inject=["DEMO_DATA_STOCK_PROPERTIES"],e.module("storageconsole.common").service("DemoData",n)}.call(void 0),function(){function n(e){var t={"scac.KmsKeyService.defaultKeyPrefix":"(Default)"},n={"scac.KmsKeyService.defaultKeyPrefix":"(Par défaut)"},r={"scac.KmsKeyService.defaultKeyPrefix":"(デフォルト)"},i={"scac.KmsKeyService.defaultKeyPrefix":"(기본값)"},a={"scac.KmsKeyService.defaultKeyPrefix":"(默认)"};e.translations("en",t),e.translations("fr",n),e.translations("ja",r),e.translations("ko",i),e.translations("zh",a),e.translations("zh_CN",a)}function r(n,r,i,a,o,s,c,l,u,d,p){function f(e){var r=new c(e),i=r.keyArn,a=r.aliasArn;return i?n.when(i):a?n.when(a):S(e).then(function(e){return n.when(t.get(e,"response.KeyMetadata.Arn"))})}function g(e){var t=new c(e).keyArn;return t?n.when(t):A.bestEffortDescribeKey(e).then(function(e){return n.when(e.keyArn)})}function m(e){var r=new c(e);return S(r.inputKmsKey,r.keyRegion).then(function(e){var n=t.get(e,"response.KeyMetadata");r.keyAccountId=n.AWSAccountId,r.keyDescription=n.Description,r.keyArn=n.Arn,r.keyId=n.KeyId,r.keyArnObj=new i(n.Arn),r.keyRegion=r.keyArnObj.region}).catch(function(e){}).then(function(){return n.when(r)})}function h(e,t){return A.bestEffortDescribeKey(e).then(function(e){return b(e)}).then(function(e){var r=v(e,t);return r&&(e.aliasDisplayHtml=r),n.when(e)})}function b(r){function a(e){return u.listAliases({Marker:e,region:o.keyRegion}).then(function(e){var r=t.get(e,"response.Aliases"),i=t.find(r,function(e){return!!e.TargetKeyId&&o.keyId===new c(e.TargetKeyId).keyId});if(i)return n.when(i);var s=t.get(e,"response.NextMarker");return t.get(e,"response.Truncated")&&s?a(s):n.reject()})}var o=e.copy(r);return!o.aliasName&&o.keyId&&E(o)?a().then(function(e){var t="alias/".length;o.aliasArn=e.AliasArn,o.aliasNameWithPrefix=e.AliasName,o.aliasName=e.AliasName.substring(t),o.aliasArnObj=new i(e.AliasArn)}).catch(function(e){}).then(function(){return n.when(o)}):n.when(o)}function v(e,t){function n(){return t&&e.aliasName===a}if(E(e)&&e.aliasName){var i=r.instant("scac.KmsKeyService.defaultKeyPrefix"),a="aws/"+t,o=i+" "+a;if(!e.keyId||!e.keyRegion)return n()?o:e.aliasName;var c="#/encryptionKeys/"+e.keyRegion+"/"+e.keyId,l=p.getCurrentRegion(),u=s.getConsoleServiceUrl("iam",l,c),d="";return n()&&(d+=i+" "),d+='<awsui-button href="'+u+'" target="_blank" icon="external-link" icon-align="right" variant="link">'+e.aliasName+"</awsui-button>"}}function E(e){var t=o.bestEffortGetUserAccountId();return!(!t||!e.keyAccountId)&&e.keyAccountId===t}function S(e,t){return u.describeKey({KeyId:e,region:t}).then(function(e){return a.Clog.log(l.DESCRIBE_KEY_FAILURE,0),n.when(e)}).catch(function(e){var t=d.proxyErrorHandler(e);return a.Clog.log(l.DESCRIBE_KEY_FAILURE,1,t),t.errorType===y&&a.Clog.log(l.DESCRIBE_KEY_FAILURE_ACCESS_DENIED,1),n.reject(e)})}var y="AccessDeniedException",A={getKeyOrAliasArn:f,bestEffortGetKeyArn:g,bestEffortDescribeKey:m,bestEffortDescribeKeyAndGetAlias:h};return A}n.$inject=["$translateProvider"],r.$inject=["$q","$translate","AwsArn","AWSC","AwsCookiesService","AwsUrlsService","KmsKey","KMS_KEY_METRICS","KMSService","ProxyErrorAdapter","Region"],e.module("storageconsole.common.services").config(n).constant("KMS_KEY_METRICS",{DESCRIBE_KEY_FAILURE:"describeKey_Failure",DESCRIBE_KEY_FAILURE_ACCESS_DENIED:"describeKey_AccessDenied"}).service("KmsKeyService",r)}.call(void 0);var r;!function(n){!function(r){!function(r){var i=n.core.lambda.LambdaFunction,a=n.core.LAMBDA_FUNCTION_VERSION,o=function(){function e(e,n,r){var o=this;this.$q=e,this.LambdaService=n,this.ProxyErrorAdapter=r,this.listLambdaFunctions=function(){return o.LambdaService.listFunctionsWithPagination().then(function(e){return t.map(e.reducedResponse,function(e){var n=e.FunctionArn;return t.endsWith(n,a.$LATEST)||(n=n+":"+a.$LATEST),new i(e.FunctionName,e.Version,n,e.Description,e.Runtime,e.Timeout)})}).catch(o.errorCallback)},this.listLambdaFunctionVersions=function(e){var n="2015-03-31/functions/"+e+"/versions";return o.LambdaService.listVersionsByFunction({path:n}).then(function(e){return t.map(e.response.Versions,function(e){return new i(e.FunctionName,e.Version,e.FunctionArn,e.Description,e.Runtime,e.Timeout)})}).catch(o.errorCallback)},this.errorCallback=function(e){var t=o.ProxyErrorAdapter.proxyErrorHandler(e);return o.$q.reject(t)}}return e.$inject=["$q","LambdaService","ProxyErrorAdapter"],e}();r.LambdaServiceWrapper=o,e.module("storageconsole.common.services").service("LambdaServiceWrapper",o)}(r.lambda||(r.lambda={}))}(n.services||(n.services={}))}(r||(r={}));var r;!function(e){e.services||(e.services={})}(r||(r={}));var r;!function(t){!function(t){var n=function(){function e(e){var t=this;this.AWSC=e,this.trackClick=function(e,n){t.AWSC.Analytics.trackClick({id:e,context:n})}}return e.$inject=["AWSC"],e}();e.module("storageconsole.common.services").service("SCACMetricsService",n)}(t.services||(t.services={}))}(r||(r={})),function(){function n(e,t){return function(n){if(!n||!n.task)throw new Error(t);this.task=n.task,this.data=n.data,this.promise=e.defer()}}function r(e,n){var r=function(e){this.queue=[],this.maxLimit=e||1,this.outstandingPromises=0};return r.prototype.deQueue=function(){function n(e){a.promise.resolve(e)}function r(e){a.promise.reject(e)}function i(e){o.outstandingPromises--,o.deQueue()}var a=void 0,o=void 0;o=this,t.isEmpty(o.queue)||o.outstandingPromises>=o.maxLimit||(a=o.queue.shift())instanceof e&&(o.outstandingPromises++,a.task(a.data).then(n,r).finally(i))},r.prototype.add=function(t,r){if(!t)throw new Error(n);var i=new e({task:t,data:r});return this.queue.push(i),this.deQueue(),i.promise.promise},r.prototype.clearQueue=function(){this.queue=[]},r.prototype.isQueueEmpty=function(){return 0===this.queue.length},r}n.$inject=["$q","NO_TASK_ERROR"],r.$inject=["QueueItem","NO_TASK_ERROR"],e.module("storageconsole.common").constant("NO_TASK_ERROR","Task not provided").factory("QueueItem",n).factory("PromiseQueue",r)}(),function(){function n(){function e(e){var n={},r=["response.__type","response.Error.Code","response.code","response.ErrorResponse.Error.Code"],i=["response","response.Message","response.message","response.Error.Message","response.Error.message","response.ErrorResponse.Error.Message","Error.Message"];return n.status=t.get(e,"status"),t.some(r,function(r){return n.errorType=t.get(e,r),t.isString(n.errorType)}),t.isString(e)?n.errorMessage=e:t.some(i,function(r){return n.errorMessage=t.get(e,r),t.isString(n.errorMessage)}),n}return{proxyErrorHandler:e}}e.module("storageconsole.common.services").service("ProxyErrorAdapter",n)}.call(void 0),function(){function n(n,r,i){function a(e){function t(e){i.promise.resolve(e)}function n(e){i.promise.reject(e)}function r(){e.connectionsInFlight--}var i=void 0;if(e.isQueueEmpty())return void s(e);i=e.queue.shift(),e.connectionsInFlight++,i.task(i.data).then(t,n).finally(r)}function o(r){!e.isDefined(r.interval)&&r.requestRatePerSecond&&(r.interval=n(function(){r.connectionsInFlight<l&&a(r)},t.ceil(c/r.requestRatePerSecond)))}function s(t){e.isDefined(t.interval)&&(n.cancel(t.interval),t.interval=void 0)}var c=1e3,l=5,u=function(e){this.queue=[],this.requestRatePerSecond=e||1,this.interval=void 0,this.connectionsInFlight=0};return u.prototype.add=function(e,t){if(!e)throw new Error(i);var n=new r({task:e,data:t});return this.queue.push(n),o(this),n.promise.promise},u.prototype.clearQueue=function(){this.queue=[],s(this)},u.prototype.isQueueEmpty=function(){return t.isEmpty(this.queue)},u}n.$inject=["$interval","QueueItem","NO_TASK_ERROR"],e.module("storageconsole.common").factory("RequestRateControlPromiseQueue",n)}(),function(){function t(e,t,n){function r(e,r){var i=n.getCurrentRegion();return t.getConsoleServiceUrl(f,i,"","object/"+e+"/"+r)}function i(e){var r=n.getCurrentRegion();return t.getConsoleServiceUrl(p,r,"#Images:imageId="+e)}function a(e,r){return r=r||n.getCurrentRegion(),t.getConsoleServiceUrl(u,r,"#cluster-details:cluster="+e)}function o(e){var t=e.match(/((?!-)[A-Za-z0-9-]{1,63}())/gi);return{clusterName:t[2],region:t[4]}}function s(){return t.getConsoleServiceUrl(g,n.getCurrentRegion(),"#/case/create")}function c(r){var i=new e(r),a=i.resourceName,o=i.region||n.getCurrentRegion(),s=i.pathPrefix,c=s.substring(0,s.lastIndexOf("/")),l="#logEventViewer:group="+c+";stream="+a;return t.getConsoleServiceUrl(d,o,l)}function l(e,r){r=r||n.getCurrentRegion();var i="#metricsV2:namespace="+e;return t.getConsoleServiceUrl(d,r,i)}var u="redshift",d="cloudwatch",p="ec2",f="s3",g="support";return{getS3ObjectUrl:r,getCloudWatchLogsUrl:c,getCloudWatchMetricsUrlForNamespace:l,getCustomerCaseUrl:s,getEc2AmiUrl:i,getRedshiftClusterUrl:a,redshiftClusterNameExtractor:o}}t.$inject=["AwsArn","AwsUrlsService","Region"],e.module("storageconsole.common.services").service("ResourceDeeplinkService",t)}(),function(){function n(e,n,r,i){function a(){return t.get(e,"current.data.name",i)}function o(e){return t.get(e,"data.name",i)}function s(e,t){n.Analytics.trackView({id:e,context:t})}function c(e,t){s(o(e),o(t))}function l(e,t,n){c(t,n),u(t,n)}function u(e,t){d(o(e),o(t))}function d(e,t){p(e)&&n.Timer.start(r+e),p(t)&&n.Timer.stop(r+t)}function p(e){return e&&e!==i}return{getPageContextOfCurrentRoute:a,getPageContextFromRouteObject:o,recordView:c,recordViewWithPageIDAndContext:s,recordViewAndTimeSpentOnRouteChange:l,recordTimeSpentOnView:u,recordTimeSpentOnViewWithPageContexts:d}}n.$inject=["$route","AWSC","TIME_SPENT_ON_VIEW_IN_MILLISECONDS","UNKNOWN_PAGE_ID"],e.module("storageconsole.common").service("RouteProviderUtilities",n)}();var r;!function(n){!function(r){!function(r){var i=n.core.AWS_SERVICES,a=n.core.GLUE_SERVICE,o=function(){function e(){var e=this;this.getRegions=function(e){if(e===i.GLUE)return a.AVAILABLE_REGIONS;throw new Error("Service not supported.")},this.isServiceSupportedInRegion=function(n,r){return-1!==t.indexOf(e.getRegions(n),r)}}return e}();r.ServiceRegionAvailbility=o,e.module("storageconsole.common.services").service("ServiceRegionAvailbility",o)}(r.serviceRegionAvailbility||(r.serviceRegionAvailbility={}))}(n.services||(n.services={}))}(r||(r={}));var r;!function(n){!function(n){function r(){return function(e,n){return n&&t.forEach(n,function(n){t.remove(e,function(e){return e.value===n})}),e}}n.filterAwsUiSelectItems=r,e.module("storageconsole.common.filters").filter("filterAwsUiSelectItems",r)}(n.filters||(n.filters={}))}(r||(r={}));var r;!function(n){!function(n){function r(e){var n=e.instant;return function(e){var r=t.floor(e/60),i=e%60,a="",o="";switch(i){case 0:break;case 1:a=n("scac.time.second.string",{value:i});break;default:a=n("scac.time.seconds.string",{value:i})}switch(r){case 0:break;case 1:o=n("scac.time.minute.string",{value:r});break;default:o=n("scac.time.minutes.string",{value:r})}return o||a?o?a?n("scac.time.seconds.minutes.string",{secondsString:a,minutesString:o}):o:a:n("scac.time.seconds.string",{value:"0"})}}r.$inject=["$translate"],n.secondsToReadableTime=r,e.module("storageconsole.common.filters").filter("secondsToReadableTime",r)}(n.filters||(n.filters={}))}(r||(r={})),e.module("storageconsole.common").run(["$templateCache",function(e){e.put("storageConsoleCommon/components/alert-with-api-response/alert-with-api-response.html",'<div class="alert-with-api-response"><awsui-alert type="{{ vm.type }}" dismissible="{{ vm.dismissible }}"><div dom-region="header"><span ng-bind-html="vm.header"></span></div><div dom-region="content"><span ng-bind-html="vm.content"></span><div class="awsui-util-pt-s" ng-if="vm.apiResponseText"><div class="awsui-icon clickable-text" ng-class="vm.showApiResponse ? \'caret-down\':\'caret-right\'" ng-click="vm.toggleShowApiResponse()" translate="scac.alertWithApiResponse.apiResponse"></div><div class="awsui-util-pt-s code-font" ng-show="vm.showApiResponse">{{ vm.apiResponseText }}</div></div></div></awsui-alert></div>'),e.put("storageConsoleCommon/components/aws-region-selector/aws-region-selector.html",'<div class="aws-region-selector"><resource-selector model="vm.model" trigger-load="vm.triggerLoad" selected-resource="vm.selectedResource"></resource-selector></div>'),e.put("storageConsoleCommon/components/displayStatusLabel/displayStatusLabel.tpl.html",'<span ng-class="vm.iconClass"></span> <span ng-style="{ color: vm.color }"><span>{{ vm.text | translate }}</span></span>'),e.put("storageConsoleCommon/components/firehose-delivery-stream-selector/firehose-delivery-stream-selector.html",'<div class="firehose-delivery-stream-selector scac"><nile-awsui-alert alert-model="vm.errorAlert"></nile-awsui-alert><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ \'scac.deliveryStream.label\' | translate }}"><span ng-if="vm.firehoseDeliveryStreamSelector.inlineErrorMessage" dom-region="validationMessage" ng-bind-html="vm.firehoseDeliveryStreamSelector.inlineErrorMessage"></span><span dom-region="instructional"><div class="awsui-spinner awsui-spinner-small" ng-if="vm.loadingDeliveryStreamDetails" translate="scac.firehoseDeliveryStreamSelector.describingDeliveryStream"></div><awsui-button class="instructional-button-link" ng-if="vm.selectedDeliveryStreamResource" icon="external-link" icon-align="right" size="small" variant="link" href="{{ vm.getDeliveryStreamDeeplink() }}" target="_blank"><span translate="scac.firehoseDeliveryStreamSelector.deeplink" translate-values="{ name: vm.firehoseDeliveryStreamSelector.selectedItem }"></span></awsui-button></span><span dom-region="control"><div class="input-column"><awsui-select ng-model="vm.firehoseDeliveryStreamSelector.selectedItem" items="vm.firehoseDeliveryStreamSelector.list | filterAwsUiSelectItems: vm.deliveryStreamNamesToFilter" data-disabled="vm.disableFirehoseDeliveryStreamSelector()" placeholder="{{ \'scac.firehoseDeliveryStreamSelector.placeholder\' | translate }}" change="vm.selectDeliveryStream()"></awsui-select></div><div class="input-column-action related-buttons"><awsui-button loading="vm.firehoseDeliveryStreamSelector.updatingList" variant="normal" click="vm.refreshDeliveryStreams()" icon="refresh"></awsui-button><awsui-button icon="external-link" icon-align="right" href="{{ vm.createDeliveryStreamDeepLink }}" target="_blank" text="{{ \'scac.createDeliveryStream\' | translate }}"></awsui-button></div></span></awsui-control-group></div>'),e.put("storageConsoleCommon/components/kinesis-data-stream-selector/kinesis-data-stream-selector.html",'<div class="kinesis-data-stream-selector scac"><nile-awsui-alert alert-model="vm.errorAlert"></nile-awsui-alert><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ \'scac.datastreamSelector.stream.label\' | translate }}"><span ng-if="vm.getStreamsDropdownInlineError()" dom-region="validationMessage">{{ vm.getStreamsDropdownInlineError() }}</span><span dom-region="instructional"><div class="awsui-spinner awsui-spinner-small" ng-if="vm.loadingStreamDetails" translate="scac.datastreamSelector.stream.describingStream"></div><awsui-button class="instructional-button-link" ng-if="vm.selectedStreamResource" icon="external-link" icon-align="right" size="small" variant="link" href="{{ vm.selectedStreamResource.deepLink }}" target="_blank"><span translate="scac.datastreamSelector.stream.viewStream" translate-values="{ name: vm.selectedStreamResource.resourceName }"></span></awsui-button></span><span dom-region="control"><div class="input-column"><awsui-select ng-model="vm.selectedStreamName" items="vm.awsUiStreams | filterAwsUiSelectItems: vm.streamNamesToFilter" data-disabled="vm.loadingListStreams || vm.showNoStreamsMessage" placeholder="{{ \'scac.datastreamSelector.stream.placeholder\' | translate }}" change="vm.selectStream()"></awsui-select></div><div class="input-column-action related-buttons"><awsui-button loading="vm.loadingListStreams" variant="normal" click="vm.refreshStreams()" icon="refresh"></awsui-button><awsui-button icon="external-link" icon-align="right" href="{{ vm.createStreamDeepLink }}" target="_blank" text="{{ \'scac.datastreamSelector.stream.create\' | translate }}"></awsui-button></div></span></awsui-control-group></div>'),e.put("storageConsoleCommon/components/kinesis-nav-bar/kinesis-nav-bar.html",'<div class="kinesis-nav-bar" ng-class="{ \'nav-bar-hidden\': !vm.isShown }"><div class="awsui-util-pt-xl"></div><i class="toggle-icon awsui-icon" ng-class="{ true:\'caret-left\', false: \'caret-right\' }[vm.isShown]" ng-click="vm.toggleShowKinesisNavigation()"></i><div ng-show="vm.isShown"><div class="nav-bar-title">{{ vm.heading }}</div><div class="nav-bar-container"><div class="nav-bar-step-service"><div class="selected-service" ng-if="vm.dashboard.isCurrent">{{ \'scac.kinesisnavbar.dashboardText\' | translate }}</div><a ng-if="!vm.dashboard.isCurrent" href="{{ vm.dashboard.url }}">{{ \'scac.kinesisnavbar.dashboardText\' | translate }}</a></div><div class="nav-bar-step-divider"></div><div class="nav-bar-step-service" ng-repeat="entry in vm.entries"><div class="selected-service" ng-if="entry.isCurrentConsoleName">{{ entry.label }}</div><div class="service-not-released" ng-if="!entry.released"><awsui-tooltip text="{{ entry.unreleasedToolTip }}" position="right">{{ entry.label }}</awsui-tooltip></div><a ng-if="entry.released &amp;&amp; !entry.isCurrentConsoleName" href="{{ entry.url }}">{{ entry.label }}</a></div><div ng-show="vm.whatsNew.isEnabled"><div class="nav-bar-step-divider"></div><div class="nav-bar-step-service"><div class="section-title">{{ \'scac.kinesisnavbar.externalResources\' | translate }}</div></div><div class="nav-bar-step"><sc-a target="_blank" href="{{ vm.whatsNew.url }}" text="{{ \'scac.kinesisnavbar.whatsNewText\' | translate }}" metric-name="{{ vm.METRICS.WHATS_NEW }}" metric-context="{{ vm.getPageContext() }}"></sc-a></div></div></div></div></div>'),e.put("storageConsoleCommon/components/kmsKeyDisplay/kmsKeyDisplay.tpl.html",'<div class="scac"><awsui-control-group ng-if="!vm.showKmsKeySection"><span class="awsui-spinner awsui-spinner-bigger"></span></awsui-control-group><div ng-if="vm.showKmsKeySection" class="read-only-control-groups"><awsui-control-group ng-if="vm.kmsKeyObj.aliasDisplayHtml" label="{{ \'scac.kmsKeyDisplay.label.kmsMasterKey\' | translate }}"><span bind-compiled-html="vm.kmsKeyObj.aliasDisplayHtml"></span></awsui-control-group><awsui-control-group ng-if="vm.kmsKeyObj.keyArn" label="{{ \'scac.kmsKeyDisplay.label.keyArn\' | translate }}"><span>{{ vm.kmsKeyObj.keyArn }}</span></awsui-control-group><awsui-control-group ng-if="vm.kmsKeyObj.aliasArn" label="{{ \'scac.kmsKeyDisplay.label.aliasArn\' | translate }}"><span>{{ vm.kmsKeyObj.aliasArn }}</span></awsui-control-group><awsui-control-group ng-if="vm.kmsKeyObj.keyId" label="{{ \'scac.kmsKeyDisplay.label.keyId\' | translate }}"><span>{{ vm.kmsKeyObj.keyId }}</span></awsui-control-group><awsui-control-group ng-if="vm.kmsKeyObj.keyDescription" label="{{ \'scac.kmsKeyDisplay.label.description\' | translate }}"><span>{{ vm.kmsKeyObj.keyDescription }}</span></awsui-control-group><awsui-control-group ng-if="vm.kmsKeyObj.keyAccountId" label="{{ \'scac.kmsKeyDisplay.label.account\' | translate }}"><span>{{ vm.kmsKeyObj.keyAccountId }}</span></awsui-control-group></div></div>'),e.put("storageConsoleCommon/components/kmsKeySelector/kmsKeySelector.tpl.html",'<div class="kms-key-selector scac"><div ng-show="vm.listKeysError"><awsui-alert type="{{ vm.LIST_KEYS_FAILURE_ALERT_TYPE }}" header="{{ \'scac.kmsKeySelector.listKeysErrorHeader\' | translate }}">{{ vm.listKeysError }}</awsui-alert></div><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ \'scac.kmsKeySelector.label\' | translate }}"><div class="input-column"><awsui-select items="vm.keyList" ng-model="vm.selectedKeyArn" placeholder="{{ \'scac.kmsKeySelector.dropDownPlaceHolder\' | translate }}" data-disabled="vm.isLoadingKeys" change="vm.onKeyChange()"></awsui-select></div><div class="input-column-action"><awsui-button loading="vm.isLoadingKeys" icon="refresh" click="vm.listKeys()"></awsui-button></div></awsui-control-group><div ng-hide="vm.isLoadingKeys" class="control-group-full-width"><div ng-show="vm.showKeyDetails" class="related-content-sections"><div class="related-control-groups" ng-show="!vm.isDescribingKey"><div ng-show="vm.selectedKeyObj.containsDetails"><awsui-control-group ng-show="vm.selectedKeyObj.Description" label="{{ \'scac.kmsKeySelector.description\' | translate }}"><span>{{ vm.selectedKeyObj.Description }}</span></awsui-control-group><awsui-control-group label="{{ \'scac.kmsKeySelector.account\' | translate }}"><span>{{ vm.selectedKeyObj.AWSAccountId }}</span></awsui-control-group></div><awsui-control-group ng-show="vm.selectedKeyObj.value" label="{{ \'scac.kmsKeySelector.keyArn\' | translate }}"><span>{{ vm.selectedKeyObj.value }}</span></awsui-control-group></div><awsui-alert ng-if="vm.customText.customKeyWarningText" type="warning"><span ng-bind-html="vm.customText.customKeyWarningText"></span></awsui-alert></div></div></div>'),e.put("storageConsoleCommon/components/lambda-blueprint-table/lambda-blueprint-table.html",'<div class="lambda-blueprint-table"><storage-console-display-table show-filter="true" wide-text="true" column-names="vm.columns" rows="vm.blueprintRows" filter-by-row="true" filter-placeholder="vm.filterPlaceholder"></storage-console-display-table></div>'),e.put("storageConsoleCommon/components/lambda-function-selector/lambda-function-selector.html",'<div class="lambda-selector scac"><div class="lambda-function-name"><awsui-alert ng-if="!!vm.lambdaFunctionNamesSelector.errorAlert.message" dismissible="{{ vm.lambdaFunctionNamesSelector.errorAlert.dismissible }}" type="{{ vm.lambdaFunctionNamesSelector.errorAlert.alertType }}" header="{{ vm.lambdaFunctionNamesSelector.errorAlert.header }}">{{ vm.lambdaFunctionNamesSelector.errorAlert.message }}</awsui-alert><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ \'scac.lambdaFunction.label\' | translate }}"><span ng-if="vm.lambdaFunctionErrorMessage" dom-region="validationMessage" translate="{{ vm.lambdaFunctionErrorMessage }}"></span><span dom-region="instructional"><awsui-button class="instructional-button-link" ng-if="vm.lambdaFunctionNamesSelector.selectedItem" icon="external-link" icon-align="right" variant="link" size="small" href="{{ vm.lambdaFunctionDeeplink }}" target="_blank"><span translate="scac.lambdaFunction.deeplink" translate-values="{ functionName: vm.lambdaFunctionNamesSelector.selectedItem }"></span></awsui-button></span><span dom-region="control"><div class="input-column"><awsui-select items="vm.lambdaFunctionNamesSelector.list | filterAwsUiSelectItems: vm.lambdaFunctionsToFilter" placeholder="{{ vm.lambdaFunctionNamesSelectorPlaceholder }}" data-disabled="vm.lambdaFunctionNamesSelector.updatingList" ng-model="vm.lambdaFunctionNamesSelector.selectedItem" change="vm.lambdaFunctionSelectionChanged()"></awsui-select></div><div class="input-column-action related-buttons"><awsui-button icon="refresh" variant="normal" click="vm.listLambdaFunctions()" loading="vm.lambdaFunctionNamesSelector.updatingList"></awsui-button><awsui-button text="{{ \'scac.createLambdaFunction.button\' | translate }}" click="vm.openModal()"></awsui-button></div></span></awsui-control-group></div><div class="lambda-function-version related-control-groups" ng-if="!!vm.lambdaFunctionNamesSelector.selectedItem"><awsui-alert ng-if="!!vm.lambdaFunctionVersionsSelector.errorAlert.message" dismissible="{{ vm.lambdaFunctionVersionsSelector.errorAlert.dismissible }}" type="{{ vm.lambdaFunctionVersionsSelector.errorAlert.alertType }}" header="{{ vm.lambdaFunctionVersionsSelector.errorAlert.header }}">{{ vm.lambdaFunctionVersionsSelector.errorAlert.message }}</awsui-alert><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ \'scac.lambdaFunctionVersion.label\' | translate }}"><div class="awsui-util-pb-s"><div class="input-column"><awsui-select items="vm.lambdaFunctionVersionsSelector.list" placeholder="{{ vm.lambdaFunctionVersionsSelectorPlaceholder }}" data-disabled="vm.lambdaFunctionVersionsSelector.updatingList || !!vm.lambdaFunctionVersionsSelector.errorAlert.message" ng-model="vm.lambdaFunctionVersionsSelector.selectedItem" change="vm.lambdaFunctionVersionSelectionChanged()"></awsui-select></div><div class="input-column-action"><awsui-button icon="refresh" variant="normal" loading="vm.lambdaFunctionVersionsSelector.updatingList" click="vm.listAndOrderLambdaFunctionVersions()"></awsui-button></div></div><div class="clear-both-sides"></div></awsui-control-group><awsui-control-group class="control-group-with-actions text-control" ng-if="vm.lambdaFunction.description" label="{{ \'scac.lambdaFunction.version.desc\' | translate }}"><span>{{ vm.lambdaFunction.description }}</span></awsui-control-group><awsui-control-group class="text-control" label="{{ \'scac.lambdaFunction.version.runtime\' | translate }}"><span>{{ vm.lambdaFunction.runtime }}</span></awsui-control-group><div ng-if="vm.isTimeoutInsufficient()"><awsui-alert ng-if="vm.isSelectedLambdaFunctionVersionLatest()" dismissible="false" type="warning"><span dom-region="header" translate="scac.lambdaFunction.increaseTimeout.header"></span><span dom-region="content"><div translate="{{ vm.translationKeys.latestVersionTimeoutWarningMessage }}"></div><awsui-button class="instructional-button-link" icon="external-link" icon-align="right" variant="link" text="{{ \'scac.lambdaFunction.increaseTimeout.deeplink\' | translate }}" href="{{ vm.lambdaFunctionDeeplink }}" target="_blank"></awsui-button></span></awsui-alert><awsui-alert ng-if="!vm.isSelectedLambdaFunctionVersionLatest()" dismissible="false" type="warning"><span dom-region="header" translate="scac.lambdaFunction.increaseTimeout.header"></span><span dom-region="content"><div translate="{{ vm.translationKeys.specificVersionTimeoutWarningMessage }}"></div></span></awsui-alert></div><awsui-control-group class="text-control" label="{{ \'scac.lambdaFunction.version.timeout\' | translate }}"><span>{{ vm.lambdaFunction.timeOutInSeconds | secondsToReadableTime }}</span></awsui-control-group></div><awsui-modal header="{{ \'scac.blueprintModal.header\' | translate }}" size="large" visible="vm.showModal === \'true\'" dismiss="vm.closeModalAndRefreshLambdaFunctions()"><span dom-region="content"><p translate="scac.blueprintModal.description"></p><lambda-blueprint-table lambda-blueprints-data="vm.lambdaBlueprintsData"></lambda-blueprint-table></span><span dom-region="footer"><awsui-button class="awsui-util-f-r" text="{{ \'scac.close.button\' | translate }}" variant="link" click="vm.closeModalAndRefreshLambdaFunctions()"></awsui-button></span></awsui-modal></div>'),e.put("storageConsoleCommon/components/nile-awsui-alert/nile-awsui-alert.html",'<awsui-alert ng-show="alertModel.message" type="{{ alertModel.alertType }}" dismissible="{{ alertModel.dismissible }}"><span dom-region="header" ng-bind-html="alertModel.header" ng-if="alertModel.header"></span><span dom-region="content" ng-bind-html="alertModel.message"></span></awsui-alert>'),e.put("storageConsoleCommon/components/radio-button-with-tooltip/radio-button-with-tooltip.html",'<div class="inline-tooltip"><awsui-radio-button label="{{ model.buttonLabel }}" value="{{ model.buttonValue }}" data-disabled="{{ model.isDisabled }}"></awsui-radio-button><awsui-tooltip text="{{ model.tooltipText }}" size="{{ model.tooltipSize }}" position="{{ model.tooltipPosition }}"><i class="awsui-icon info-circle"></i></awsui-tooltip></div>'),e.put("storageConsoleCommon/components/resource-selector/resource-selector.html",'<div class="scac"><nile-awsui-alert alert-model="vm.awsUiAlert"></nile-awsui-alert><awsui-control-group class="control-group-with-actions control-group-with-select-and-inline-buttons" label="{{ vm.model.text.controlGroup.label | translate }}"><span dom-region="instructional"><awsui-button class="instructional-button-link" ng-if="!!vm.getSelectedResourceText() &amp;&amp; !!vm.buildResourceDeepLink()" icon="external-link" icon-align="right" size="small" variant="link" href="{{ vm.buildResourceDeepLink() }}" target="_blank"><span translate="{{ vm.model.text.select.viewResource }}" translate-values="{ resourceName: vm.getSelectedResourceText() }"></span></awsui-button></span><span dom-region="control"><div class="input-column"><awsui-select placeholder="{{ vm.model.text.select.placeholder | translate }}" data-disabled="vm.loadingResources || vm.model.disabled()" items="vm.resourceItems" ng-model="vm.selectedResource" change="vm.selectResource($event)"></awsui-select></div><div class="input-column-action related-buttons"><awsui-button ng-if="vm.model.disableRefresh !== true" loading="vm.loadingResources" variant="normal" click="vm.refreshResources()" icon="refresh" data-disabled="vm.model.disabled()"></awsui-button><awsui-button ng-if="!!vm.model.onCreateResourceClick" click="vm.model.onCreateResourceClick()">{{ vm.model.text.select.createNewResource | translate }}</awsui-button><awsui-button ng-if="!vm.model.onCreateResourceClick &amp;&amp; !!vm.buildCreateResourceDeepLink()" icon="external-link" icon-align="right" href="{{ vm.buildCreateResourceDeepLink() }}" target="_blank">{{ vm.model.text.select.createNewResource | translate }}</awsui-button></div></span><span ng-if="vm.getInlineErrorMessageKey()" dom-region="validationMessage"><span ng-bind-html="vm.getInlineErrorMessageKey() | translate"></span></span></awsui-control-group></div>'),e.put("storageConsoleCommon/components/s3-bucket-arn-selector/s3-bucket-arn-selector.html",'<div class="s3-bucket-selector"><resource-selector model="vm.model" trigger-load="vm.triggerListS3BucketsLoad" selected-resource="vm.selectedResource"></resource-selector><s3-bucket-creation-modal visible="vm.showCreateBucketModal" on-success="vm.selectCreatedBucketAndTriggerListS3BucketsLoad(arn)"></s3-bucket-creation-modal></div>'),e.put("storageConsoleCommon/components/s3-object-path-input/s3-object-path-input.html",'<div class="s3-object-path-input scac"><awsui-control-group class="control-group-full-width" label="{{ vm.text.controlGroup.label }}"><span dom-region="control"><awsui-textfield ng-model="vm.s3ObjectPath" placeholder="{{ vm.text.input.placeholder }}" blur="vm.onInputBlur()" input="vm.onInput()" change="vm.onValueChange()"></awsui-textfield></span><span dom-region="instructional"><div ng-if="vm.text.controlGroup.instructional" ng-bind-html="vm.text.controlGroup.instructional"></div><awsui-button class="instructional-button-link" ng-if="!!vm.getObjectDeeplink()" size="small" icon="external-link" icon-align="right" variant="link" href="{{ vm.getObjectDeeplink() }}" target="_blank">{{ vm.text.controlGroup.viewResource }}</awsui-button></span><span ng-if="vm.invalidObjectPathMessage" dom-region="validationMessage"><span ng-bind-html="vm.invalidObjectPathMessage"></span></span></awsui-control-group></div>'),e.put("storageConsoleCommon/components/s3BucketCreationModal/s3BucketCreationModal.tpl.html",'<awsui-modal class="s3-bucket-creation-modal" header="{{ \'scac.s3BucketCreationModal.titleAndCreateButton\' | translate }}" visible="vm.visible" dismiss="vm.closeS3BucketCreationModal()"><span dom-region="footer"><awsui-button text="{{ \'scac.s3BucketCreationModal.titleAndCreateButton\' | translate }}" data-disabled="vm.validationErrorMessage" loading="vm.isCreatingBucket" variant="primary" class="awsui-util-f-r" click="vm.createBucket()"></awsui-button><awsui-button text="{{ \'scac.s3BucketCreationModal.button.cancel\' | translate }}" variant="link" class="awsui-util-f-r" click="vm.closeS3BucketCreationModal()"></awsui-button></span> <span dom-region="content"><p translate="scac.s3BucketCreationModal.description" translate-values="{ learnMoreLink: vm.learnMoreLink }"></p><awsui-alert class="awsui-alert-margin-top" ng-if="vm.serverSideErrorMessage" type="error">{{ vm.serverSideErrorMessage }}</awsui-alert><awsui-control-group label="{{ \'scac.s3BucketCreationModal.label\' | translate }}" validation-message="{{ vm.validationErrorMessage }}"><awsui-textfield ng-model="vm.bucketName" blur="vm.checkIfS3BucketNamingValidOnBlur()" input="vm.checkIfS3BuckerNamingValidOnInputChange()"></awsui-textfield></awsui-control-group><awsui-control-group label="{{ \'scac.s3BucketCreationModal.region\' | translate }}"><awsui-select ng-if="!vm.isRegionReadOnly" ng-model="vm.selectedRegion" items="vm.regions"></awsui-select><span ng-if="vm.isRegionReadOnly">{{ vm.displayCurrentRegionName }}</span></awsui-control-group></span></awsui-modal>'),e.put("storageConsoleCommon/components/storageConsoleAnchor/storageConsoleAnchor.html",'<a ng-if="target" target="{{ target }}" ng-href="{{ href }}" ng-click="emitMetric()">{{ text }}<span class="awsui-util-pl-xs awsui-icon awsui-icon-link external-link" ng-if="showExternalLinkIcon"></span></a><a ng-if="!target" ng-href="{{ href }}" ng-click="emitMetric()">{{ text }}<span class="awsui-util-pl-xs awsui-icon awsui-icon-link external-link" ng-if="showExternalLinkIcon"></span></a>'),e.put("storageConsoleCommon/components/storageConsoleCard/storageConsoleCard.html",'<div class="storage-console-card"><div class="card-header"><span class="card-header-contents"><span class="awsui-text-big" ng-bind-html="vm.headerTextWithItemCount"></span><span ng-if="vm.storageConsoleCardModel.headerTooltipText &amp;&amp; vm.showTable()"><awsui-tooltip class="awsui-util-pl-s awsui-util-f-r" size="small" position="right" text="{{ vm.storageConsoleCardModel.headerTooltipText }}"><i class="awsui-icon info-circle"></i></awsui-tooltip></span></span></div><div class="card-body"><div class="awsui-spinner awsui-spinner-large" ng-if="vm.storageConsoleCardModel.loading"></div><div ng-if="!vm.storageConsoleCardModel.loading"><nile-awsui-alert class="unable-to-load-resources" ng-if="vm.showAlert()" alert-model="vm.storageConsoleCardModel.alertModel"></nile-awsui-alert><div class="no-resources" ng-if="vm.showNoResourcesSection()"><p class="resource-description-text" ng-bind-html="vm.storageConsoleCardModel.placeholderDescriptionText"></p><div class="awsui-util-ml-l" id="{{ vm.storageConsoleCardModel.placeholderImageId }}"></div></div><storage-console-display-table ng-if="vm.showTable()" filter-by-row="true" column-names="vm.storageConsoleCardModel.tableColumns" rows="vm.tableRowsToDisplay" show-filter="false" styles="\'wide-text no-side-borders\'"></storage-console-display-table></div></div><div class="card-footer" ng-transclude="footer"></div></div>'),e.put("storageConsoleCommon/components/storageConsoleConfigPanel/storageConsoleConfigPanel.tpl.html",'<div class="storage-console-config-panel" ng-if="panelOpen"><div class="config-panel-header" ng-transclude="header">{{header}}</div><div class="config-panel-content" ng-transclude="content"></div><div class="config-panel-footer" ng-transclude="footer"><awsui-button text="{{ \'configpanel.button.close\' | translate }}" variant="primary" click="hidePanel()"></awsui-button></div></div>'),e.put("storageConsoleCommon/components/storageConsoleConfigPanel/storageConsoleConfigPanelItem.tpl.html",'<div class="storage-console-config-panel-item"><div class="storage-console-config-panel-item-header" ng-click="itemOpen = !itemOpen"><span class="awsui-icon awsui-icon-bigger" ng-class="{ \'caret-right\': !itemOpen, \'caret-down\': itemOpen }"></span>{{header}}</div><div class="loading-spinner" ng-if="loading && itemOpen"><span class="awsui-icon awsui-spinner awsui-spinner-bigger"></span></div><div class="storage-console-config-panel-item-content" ng-if="!loading && itemOpen" ng-transclude=""></div></div>'),e.put("storageConsoleCommon/components/storageConsoleDisplayTable/storageConsoleDisplayTable.tpl.html",'<div class="storage-console-display-table"><div class="display-table-filter-bar"><table ng-show="vm.showFilter" class="table-content table-header"><thead><th><div class="input-field"><div class="awsui-icon filter awsui-icon-disabled"></div><awsui-textfield ng-model="vm.currentFilter" placeholder="{{ vm.filterPlaceholder }}"></awsui-textfield></div></th></thead></table></div><div ng-class="vm.styles"><table ng-if="vm.filterByRow" class="table-content"><thead><tr class="table-header"><th ng-repeat="key in vm.idKeys track by $index" ng-style="vm.columnStyles[$index]"><span ng-bind-html="vm.nameKeys[$index]"></span> <span ng-if="vm.toolTips[$index]"><awsui-tooltip size="small" position="{{ vm.toolTipPositions[$index] }}" text="{{ vm.toolTips[$index] }}"><i class="awsui-icon info-circle"></i></awsui-tooltip></span><div class="secondary-header" ng-if="vm.secondaryHeaders">{{ vm.secondaryHeaders[$index] }}</div></th></tr></thead><tbody><tr ng-repeat="row in vm.rows | filter: { name: vm.currentFilter }"><td ng-repeat="key in vm.idKeys" bind-compiled-html="row[key]"></td></tr></tbody></table><table ng-if="!vm.filterByRow" class="table-content"><thead><tr class="table-header"><th ng-repeat="(index, columnName) in vm.nameKeys | withKeyPartial:vm.secondaryHeaders:vm.currentFilter track by $index"><span ng-bind-html="columnName"></span> <span ng-if="vm.toolTips[index]"><awsui-tooltip size="small" position="{{ vm.toolTipPositions[$index] }}" text="{{ vm.toolTips[index] }}"><i class="awsui-icon info-circle"></i></awsui-tooltip></span><div ng-if="vm.secondaryHeaders" class="secondary-header">{{ vm.secondaryHeaders[index] }}</div></th></tr></thead><tbody><tr ng-repeat="row in vm.rowArrays track by $index"><td ng-repeat="(index, columnName) in vm.nameKeys | withKeyPartial:vm.secondaryHeaders:vm.currentFilter">{{ row[index] }}</td></tr></tbody></table></div></div>'),e.put("storageConsoleCommon/components/storageConsoleLineChart/storageConsoleLineChart.tpl.html",'<div class="line-chart-container"><div class="chart-heading" ng-bind-html="heading"></div><div id="{{ chartid }}" class="chartgraph"></div></div>'),e.put("storageConsoleCommon/components/storageConsoleListTable/storageConsoleListTable.tpl.html",'<div class="storage-console-list-table"><div class="header-bar" ng-if="!disableFilter || !disablePagination"><div class="filter-input-field" ng-if="!disableFilter"><div class="awsui-icon filter awsui-icon-disabled"></div><input type="text" placeholder="{{ filterPlaceholderText }}" ng-model="tableFiltering.filter[filterColumn]" ng-change="onFilterInputChange()" ng-keydown="filterKeyDown($event)"><div ng-if="showClearFilterButton()" class="awsui-icon times-circle" ng-click="clearFilter()"></div></div><div class="pagination-controls right" ng-if="!disablePagination"><span class="awsui-icon awsui-icon-big angle-double-left" ng-class="{ \'awsui-icon-disabled\': isFirstPage() }" ng-click="goToFirstPage()"></span> <span class="awsui-icon awsui-icon-big angle-left" ng-class="{ \'awsui-icon-disabled\': isFirstPage() }" ng-click="previousPage()"></span> <span class="text">{{ paginationControlsText }}</span> <span class="awsui-icon awsui-icon-big angle-right" ng-class="{ \'awsui-icon-disabled\': isLastPage() }" ng-click="nextPage()"></span> <span class="awsui-icon awsui-icon-big angle-double-right" ng-class="{ \'awsui-icon-disabled\': isLastPage() }" ng-click="goToLastPage()"></span></div></div><table class="item-list-table"><thead class="item-list-header" ng-class="{ \'top-border\': (disableFilter && disablePagination) }"><tr><th><span class="header-column"></span></th><th ng-if="!disableInlineContent"><span class="header-column"></span></th><th ng-repeat="column in tableColumns track by $index" ng-class="{ \'pointer-cursor\': !column.disableSorting }"><div ng-click="column.sort()"><span bind-compiled-html="column.header" class="header-column"></span> <span ng-if="!column.disableSorting" class="awsui-icon awsui-icon-has-hover" ng-class="{ \'caret-down\': tableSorting.reverse[column.key], \'caret-up\': !tableSorting.reverse[column.key], \'awsui-icon-link\': column.key === tableSorting.sortBy }"></span><div></div></div></th></tr></thead><tbody data-ng-repeat="item in items | filter:tableFiltering.filter | orderBy:tableSorting.sortFunction:tableSorting.reverse[tableSorting.sortBy] | range:currentTableRange().min:currentTableRange().max" class="item-list-body"><tr class="item-list-row" ng-click="!enableMultiSelect && selectOrDeselectItemForSingleSelect(item)" ng-class="{ \'selected\': isItemSelected(item), \'pointer-cursor\': !enableMultiSelect }"><td class="awsui-util-t-c multi-select-td" ng-if="enableMultiSelect"><awsui-checkbox ng-model="item.isMultiSelected" check="onItemSelect(item)"></awsui-checkbox></td><td class="awsui-util-t-c" ng-if="!enableMultiSelect"><div class="uxdg-radio-button-styling"></div><input type="radio" name="selectedRadio" ng-model="singleSelection.selectedRadio" ng-value="item"></td><td class="awsui-util-t-c" ng-if="!disableInlineContent" ng-click="$event.stopPropagation()"><span class="awsui-icon awsui-icon-bigger" ng-class="{ \'caret-down\': openedInlineItem === item, \'caret-right\': openedInlineItem !== item }" ng-click="toggleInlineExpansionAndSelectItemIfNeeded(item)"></span></td><td ng-repeat="column in tableColumns track by $index"><span bind-compiled-html="column.getContent(item)"></span></td></tr><tr ng-if="!disableInlineContent && openedInlineItem === item"><td class="inline-content" colspan="{{tableColumns.length + 2}}"><div ng-transclude=""></div></td></tr></tbody><tbody ng-show="isTableEmpty()"><tr><td class="centered awsui-util-p-m" colspan="{{tableColumns.length + 2}}"><div ng-if="items.length === 0" bind-compiled-html="{{ emptyText }}"></div><div ng-if="items.length !== 0" bind-compiled-html="{{ filterEmptyText }}"></div></td></tr></tbody></table><div class="pagination-controls" ng-if="!disablePagination"><div class="right"><span class="awsui-icon awsui-icon-big angle-double-left" ng-class="{ \'awsui-icon-disabled\': isFirstPage() }" ng-click="goToFirstPage()"></span> <span class="awsui-icon awsui-icon-big angle-left" ng-class="{ \'awsui-icon-disabled\': isFirstPage() }" ng-click="previousPage()"></span> <span class="text">{{ paginationControlsText }}</span> <span class="awsui-icon awsui-icon-big angle-right" ng-class="{ \'awsui-icon-disabled\': isLastPage() }" ng-click="nextPage()"></span> <span class="awsui-icon awsui-icon-big angle-double-right" ng-class="{ \'awsui-icon-disabled\': isLastPage() }" ng-click="goToLastPage()"></span></div><div class="clearfix"></div></div></div>'),e.put("storageConsoleCommon/components/storageConsolePipeline/storageConsolePipeline.tpl.html",'<div class="storage-console-pipeline"><table><tr class="storage-console-pipeline-steps"><td ng-repeat="step in steps track by $index" style="width: {{ ($index === 0 || $index === steps.length-1) ? 7 : 100/steps.length}}%" ng-class="{\'force-left\': $index === 0, \'force-right\': $index === steps.length-1}"><span ng-if="currentStep === step">{{ step.aboveText }}</span></td></tr><tr><td colspan="{{steps.length}}"><div class="storage-console-pipeline-content"><div class="storage-console-pipeline-container"><div ng-if="highlightLastStep" class="highlight-block"></div></div></div></td></tr><tr><td colspan="{{selectedIndex + 1}}" class="storage-console-completed-steps"><div class="storage-console-completed-steps-fill" style="width: auto" ng-if="selectedIndex === 0"><div class="current-step"></div></div><div class="storage-console-completed-steps-fill" style="width: 100%" ng-if="selectedIndex === steps.length-1"><div class="current-step"></div></div><div class="storage-console-completed-steps-fill" style="width: calc({{100-50/(selectedIndex+1)}}%" ng-if="selectedIndex !== 0 && (selectedIndex !== steps.length-1)"><div class="current-step with-small-caret"></div></div></td></tr><tr><td ng-repeat="step in steps track by $index" class="storage-console-pipeline-below-content" ng-class="{\'force-left\': $index === 0, \'force-right\': $index === steps.length-1}"><div ng-if="$index !== selectedIndex"><div class="small-caret" ng-if="$index !== 0 && $index < selectedIndex"></div><div class="big-caret" ng-if="$index !== (steps.length-1) && $index > selectedIndex"></div></div><span ng-class="{ current: ($index === selectedIndex) }" ng-bind-html="determineBelowText($index, selectedIndex, step)"></span></td></tr></table></div>'),e.put("storageConsoleCommon/components/storageConsoleTags/storageConsoleTags.tpl.html",'<div class="storage-console-tags"><table class="normal"><thead><tr><th><span translate="tagging.header.key"></span></th><th><span translate="tagging.header.value"></span></th><th><span></span></th></tr></thead><tbody><tr ng-repeat="pair in keyValueArray"><td><input ng-class="{ error: ((pair.value && !pair.key) || pairInArray(duplicateKeys(), pair) && displayErrors && !pair.originalKey) || !isValidKey($index) }" class="storage-common-tag-input" type="text" placeholder="{{ \'tagging.placeholder.key\' | translate }}" ng-model="pair.key" ng-change="keyValueChanged($index)" ng-hide="pairInHash(readOnlyPairs, pair) && pair.originalKey && !pair.editing" ng-trim="false"><span ng-if="pairInHash(readOnlyPairs, pair) && pair.originalKey && !pair.editing">{{ pair.key }}</span></td><td><input ng-hide="pairInHash(readOnlyPairs, pair) && !pair.editing && pair.originalKey" class="storage-common-tag-input" type="text" placeholder="{{ \'tagging.placeholder.value\' | translate}}" ng-model="pair.value" ng-disabled="((!pair.key || (pairInArray(duplicateKeys(), pair)) && displayErrors) && !pair.editing || showInvalidKeyError())" ng-change="keyValueChanged($index)" ng-focus="addNewField(); duplicateKeys()" ng-trim="false" ng-class="{ error: !isValidValue($index) }"><span ng-if="pairInHash(readOnlyPairs, pair) && pair.value && !pair.editing && pair.originalKey">{{ pair.value }}</span> <span class="no-value" ng-if="pairInHash(readOnlyPairs, pair) && !pair.value && !pair.editing && pair.originalKey" translate="tagging.key.noValue"></span></td><td><div class="edit-buttons centered" ng-if="(keyValueArray.length > 1) && (pair.key !== \'\' || pair.value !== \'\')"><span class="awsui-icon pencil awsui-icon-has-hover" ng-if="editable && !pair.editing && pair.originalKey" ng-click="toggleEditing($index)"></span> <span class="awsui-icon exclamation-circle awsui-icon-has-hover" ng-if="editable && pair.editing" ng-click="toggleEditing($index)"></span> <span class="awsui-icon times-circle awsui-icon-has-hover" ng-click="removeTag($index)"></span></div></td></tr></tbody></table><div class="tags-footer"><div class="tags-buttons" ng-if="buttons"><awsui-button variant="primary" text="{{ \'tagging.button.save\' | translate }}" click="save()" disabled loading="saveLoading"></awsui-button><awsui-button variant="normal" text="{{ \'tagging.button.cancel\' | translate }}" disabled click="cancel()"></awsui-button></div><div class="tags-alerts"><awsui-alert ng-if="showInvalidKeyError()" type="error" dismissible="false" header="{{ \'tagging.errors.invalidKey.header\'| translate }}">{{ validation.key.message }}</awsui-alert><awsui-alert ng-if="showInvalidValueError()" type="error" dismissible="false" header="{{ \'tagging.errors.invalidValue.header\'| translate }}">{{ validation.value.message }}</awsui-alert><div ng-hide="hideWarnings"><awsui-alert ng-if="showDuplicateKeyError && displayErrors" type="warning" dismissible="false" header="{{ \'label.important\'| translate }}"><span translate="tagging.errors.invalidKey.unique"></span></awsui-alert><awsui-alert ng-if="valueWithoutKey()" type="warning" dismissible="false" header="{{ \'label.important\'| translate }}"><span translate="tagging.errors.invalidValue.none"></span></awsui-alert><awsui-alert ng-if="limit == keyValueArray.length" type="warning" dismissible="false" header="{{ \'label.important\'| translate }}"><span translate="tagging.errors.max"></span></awsui-alert></div></div></div></div>')}]),window.storageConsoleCommon=r}).call(t,n(0),n(2))},function(e,t,n){(function(e,t){!function(){"use strict";e.module("AWS-DBUX-FAC",[]).service("FAC",function(){var n={},r=t("#meta-features-json");if(r&&r.attr("data-featuresjson")){var i=t("#meta-fac-stage"),a=i?i.attr("data-stage"):null,o=JSON.parse(r.attr("data-featuresjson"));e.isArray(o)&&o.forEach(function(e){n[e.externalId]=e.enabled}),this.isFeatureEnabled=function(e){return"disabled_visible"===a||"disabled"!==a&&!0===n[e]}}})}()}).call(t,n(0),n(6))},function(e,t,n){(function(e){!function(){"use strict";e.module("AWS-DBUX-FAC").directive("facId",[function(){return{restrict:"A",controller:["$element","$scope","FAC",function(e,t,n){n.isFeatureEnabled(e.attr("fac-id"))||e.hide()}]}}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";e.module("awsconsole.common").service("EZCRCService",["$q","AWSC","IAMAdminService","IAMService",function(t,n,r,i){function a(t,r,i,a,o,s,c){var l={params:{ServicePrincipalName:t,RoleName:r,PolicyName:i,TemplateName:a,TemplateVersion:o},region:c},u=Object.keys(s),d=1,f=1;return u.forEach(function(t){var r=s[t];e.isString(r)?(l.params["PermissionsPolicySingleValueReplacements.entry."+d+".key"]=t,l.params["PermissionsPolicySingleValueReplacements.entry."+d+".value"]=r,d++):e.isArray(r)?(l.params["PermissionsPolicyMultiValueReplacements.entry."+f+".key"]=t,r.forEach(function(e,t){var n=t+1;l.params["PermissionsPolicyMultiValueReplacements.entry."+f+".value.entry."+n]=e}),f++):n.Clog(p.INVALID_PLACEHOLDER_VALUE,{policyReplacementKey:t,policyReplacementValue:r})}),l}function o(e,i,a,o,s){return r.createServiceRole({params:{ServicePrincipalName:i,RoleName:e,TemplateName:a,TemplateVersion:o},region:s}).then(function(e){return n.Clog.log(p.CREATE_ROLE_ACTION,1),e}).catch(function(e){return u(e,"CreateRole"),"EntityAlreadyExists"===e.response.Error.Code?e:(n.Clog.log(p.CREATE_ROLE_ACTION,0),t.reject(e))})}function s(e,i,o,s,l,d,f,g){var m=a(o,e,i,s,l,f,g);return r.createPolicyForServiceRole(m).then(function(e){return n.Clog.log(p.CREATE_POLICY_ACTION,1),e}).catch(function(r){return u(r,"CreatePolicy"),"EntityAlreadyExists"===r.response.Error.Code?c(e,i,o,s,l,d,f,g):(n.Clog.log(p.CREATE_POLICY_ACTION,0),t.reject(r))})}function c(e,o,l,f,g,m,h,b){var v=a(l,e,o,f,g,h,b);return r.updateServiceRolePolicy(v).then(function(e){return n.Clog.log(p.UPDATE_POLICY_ACTION,1),e}).catch(function(r){if(u(r,"UpdatePolicy"),"AccessDenied"===r.response.Error.Code){var a=o+d.alternatePolicySuffix,v=m.replace("/"+o,"/"+a);return s(e,a,l,f,g,v,h,b)}return"LimitExceeded"===r.response.Error.Code?i.listPolicyVersions({params:{PolicyArn:m},region:b}).then(function(r){var a=r.response.ListPolicyVersionsResponse.ListPolicyVersionsResult.Versions;a.reverse();var s=a.find(function(e){return!e.IsDefaultVersion});return n.Clog.log(p.LIST_POLICY_VERSIONS_ACTION,1),i.deletePolicyVersion({params:{PolicyArn:m,VersionId:s.VersionId},region:b}).then(function(){return n.Clog.log(p.DELETE_POLICY_VERSION,1),c(e,o,l,f,g,m,h,b)}).catch(function(e){n.Clog.log(p.DELETE_POLICY_VERSION,0),t.reject(e)})}).catch(function(e){n.Clog.log(p.LIST_POLICY_VERSIONS_ACTION,0),t.reject(e)}):(n.Clog.log(p.UPDATE_POLICY_ACTION,0),t.reject(r))})}function l(e,r,i,a,c,l,u,d){return o(e,i,a,c,d).then(function(){return s(e,r,i,a,c,l,u,d).then(function(e){return n.Clog.log(p.CREATE_ROLE_AND_POLICY_ACTION,1),e}).catch(function(e){return n.Clog.log(p.CREATE_ROLE_AND_POLICY_ACTION,0),t.reject(e)})}).catch(function(e){return n.Clog.log("EZCRC",0),t.reject(e)})}function u(t,r){var i,a,o={UnrecognizedClientException:"UC",AccessDeniedException:"AD",InvalidInputException:"II",MalformedPolicyDocumentException:"MPD",LimitExceededException:"LE",NoSuchEntityException:"NSE",EntityAlreadyExistsException:"EAE",ValidationException:"VE",ThrottlingException:"TE"};t&&t.response&&t.response.Error&&e.isString(t.response.Error.Code)&&(a=o[t.response.Error.Code],a||(a=t.response.Error.Code),i="EZCRC_${action}_${errorCode}".replace("${action}",r).replace("${errorCode}",a),n.Clog.log(i,1))}var d=this,p={CREATE_ROLE_ACTION:"EZCRC_CreateRole",CREATE_POLICY_ACTION:"EZCRC_CreatePolicy",UPDATE_POLICY_ACTION:"EZCRC_UpdatePolicy",CREATE_ROLE_AND_POLICY_ACTION:"EZCRC_CreateRoleAndPolicy",LIST_POLICY_VERSIONS_ACTION:"EZCRC_ListPolicyVersions",DELETE_POLICY_VERSION:"EZCRC_DeletePolicyVersion",INVALID_PLACEHOLDER_VALUE:"EZCRC_Invalid_Value"};this.alternatePolicySuffix="-alt",this.createServiceRole=o,this.createPolicyForServiceRole=s,this.updatePolicyForServiceRole=c,this.zeroClickRoleCreation=l}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("IAMProxyConfig",{operations:[{name:"ListRoles",params:{Action:"ListRoles",ContentType:"JSON",Version:"2010-05-08"},headers:{},metricName:"IAMService_ListRoles"},{name:"DeletePolicyVersion",params:{Action:"DeletePolicyVersion",ContentType:"JSON",Version:"2010-05-08"},headers:{},metricName:"IAMService_DeletePolicyVersion"},{name:"ListPolicyVersions",params:{Action:"ListPolicyVersions",ContentType:"JSON",Version:"2010-05-08"},headers:{},metricName:"IAMService_ListPolicyVersions"},{name:"ListAttachedRolePolicies",params:{Action:"ListAttachedRolePolicies",ContentType:"JSON",Version:"2010-05-08"},headers:{},metricName:"IAMService_ListAttachedRolePolicies"},{name:"GetPolicyVersion",params:{Action:"GetPolicyVersion",ContentType:"JSON",Version:"2010-05-08"},headers:{},metricName:"IAMService_GetPolicyVersion"}]}),t.factory("IAMService",["IAMProxyConfig","AWSConsoleProxyService","$http","$q","Region","IAMEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("IAMAdminProxyConfig",{operations:[{name:"CreateServiceRole",params:{Action:"CreateServiceRole",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_CreateServiceRole"},{name:"CreatePolicyForServiceRole",params:{Action:"CreatePolicyForServiceRole",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_CreatePolicyForServiceRole"},{name:"UpdateServiceRolePolicy",params:{Action:"UpdateServiceRolePolicy",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_UpdateServiceRolePolicy"},{name:"CreatePolicyVersionForServiceRole",params:{Action:"CreatePolicyVersionForServiceRole",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_CreatePolicyVersionForServiceRole"},{name:"AttachServiceRolePolicy",params:{Action:"AttachServiceRolePolicy",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_AttachServiceRolePolicy"},{name:"ListRolesByPrincipal",params:{Action:"ListRolesByPrincipal",ContentType:"JSON"},headers:{},metricName:"IAMAdminService_ListRolesByPrincipal"}],exceptionPaths:{type:"Error.Code",message:"Error.Message"}}),t.factory("IAMAdminService",["IAMAdminProxyConfig","AWSConsoleProxyService","$http","$q","Region","IAMAdminEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}(),function(){"use strict";e.module("awsconsole.common").constant("IAM_ADMIN_WRAPPER_SERVICE_METRICS",{LIST_ROLES_BY_SPN_ACTION:"IAMAdminWrapper_ListRolesBySPN"}).factory("IAMAdminWrapperService",["$q","$window","AWSC","IAM_ADMIN_WRAPPER_SERVICE_METRICS","IAMAdminService",function(e,t,n,r,i){function a(a,o,s){function c(e){return i.listRolesByPrincipal({params:l(a,s,e),region:o}).then(function(e){var t=e.response.ListRolesByPrincipalResponse.ListRolesByPrincipalResult;return u=u.concat(t.Roles),t.IsTruncated?c(t.Marker):u})}function l(e,n,r){var i={};return n&&(i.PathPrefix=n),r&&(i.Marker=r),t.Object.keys(e).forEach(function(t){i["AuthorizedPrincipal."+t]=e[t]}),i}var u=[];return c().then(function(e){return n.Clog.log(r.LIST_ROLES_BY_SPN_ACTION,1),e}).catch(function(t){return n.Clog.log(r.LIST_ROLES_BY_SPN_ACTION,0),e.reject(t)})}return{listRolesByPrincipalAndPaginate:a}}])}.call(this)}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("KMSProxyConfig",{operations:["ListKeysForService","DescribeKey","ListAliases"],serviceTarget:"TrentService"}),t.factory("KMSService",["KMSProxyConfig","AWSConsoleProxyService","$http","$q","Region","KMSEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("LambdaProxyConfig",{operations:[{name:"ListFunctions",method:"GET",path:"2015-03-31/functions",metricName:"Lambda_ListFunctions",options:{pagination:{shouldContinuePagination:function(e){return e.response.NextMarker&&e.response.NextMarker.length>0},buildPaginationParams:function(e){return{Marker:e.response.NextMarker}},reduceResponses:function(e){var t=[];return e&&e.forEach(function(e){t=t.concat(e.response.Functions)}),t},metricNames:{success:"Lambda_ListFunctionsPSuccess",timing:"Lambda_ListFunctionsPTime",count:"Lambda_ListFunctionsPCount"}}}},{name:"AddPermission",method:"POST",metricName:"Lambda_AddPermission"},{name:"Invoke",method:"POST",metricName:"Lambda_Invoke"},{name:"ListVersionsByFunction",method:"GET",metricName:"Lambda_ListVersionsByFunction"},{name:"PublishVersion",method:"POST",metricName:"Lambda_PublishVersion"},{name:"GetFunctionConfiguration",method:"GET",metricName:"Lambda_GetFunctionConfiguration"}]}),t.factory("LambdaService",["LambdaProxyConfig","AWSConsoleProxyService","$http","$q","Region","LambdaEndpoint","$window","XMLParser",function(e,t,n,r,i,a,o,s){return e.ajaxEndpoint=a,t(e,n,r,i,s,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e,t){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("S3ProxyConfig",{operations:[{name:"ListAllMyBuckets",method:"GET",metricName:"S3_ListAllMyBuckets"},{name:"ListObjects",method:"GET",metricName:"S3_ListObjects"},{name:"GetObject",method:"GET",metricName:"S3_GetObject"},{name:"ListVersions",method:"GET",metricName:"S3_ListVersions",params:{versions:""}},{name:"GetObjectMetadata",method:"HEAD",metricName:"S3_GetObjectMetadata"},{name:"GetObjectAcl",method:"GET",metricName:"S3_GetObjectAcl",params:{acl:""}},{name:"PutObjectAcl",method:"PUT",metricName:"S3_PutObjectAcl",params:{acl:""}},{name:"GetObjectTag",method:"GET",metricName:"S3_GetObjectTag",params:{tagging:""}},{name:"PutObjectTag",method:"PUT",metricName:"S3_PutObjectTag",params:{tagging:""}},{name:"TagQuery",method:"POST",params:{"tag-query":""},metricName:"S3_TagQuery"},{name:"GetObjectInventory",method:"GET",metricName:"S3_GetObjectInventory",params:{inventory:""}},{name:"DeleteObjectInventoryConfig",method:"DELETE",metricName:"S3_DeleteObjectInventoryConfig",params:{inventory:""}},{name:"PutObjectInventoryConfig",method:"PUT",metricName:"S3_PutObjectInventoryConfig",params:{inventory:""}},{name:"GetBucketLocation",method:"GET",params:{location:""},metricName:"S3_GetBucketLocation"},{name:"AbortMultipartUpload",method:"DELETE",metricName:"S3Service.abortMultipartUpload"},{name:"InitiateMultipartUpload",method:"POST",metricName:"S3_InitiateMultipartUpload",params:{uploads:""}},{name:"CompleteMultipartUpload",method:"POST",metricName:"S3_CompleteMultipartUpload"},{name:"CreateBucket",method:"PUT",metricName:"S3_CreateBucket"},{name:"HeadBucket",method:"HEAD",metricName:"S3_HeadBucket"},{name:"GetBucketAcl",method:"GET",metricName:"S3_GetBucketAcl",params:{acl:""}},{name:"PutBucketAcl",method:"PUT",metricName:"S3_PutBucketAcl",params:{acl:""}},{name:"GetBucketCORS",method:"GET",metricName:"S3_GetBucketCORS",params:{cors:""}},{name:"PutBucketCORS",method:"PUT",metricName:"S3_PutBucketCORS",params:{cors:""}},{name:"DeleteBucketCORS",method:"DELETE",metricName:"S3_DeleteBucketCORS",params:{cors:""}},{name:"GetBucketPolicy",method:"GET",metricName:"S3_GetBucketPolicy",params:{policy:""}},{name:"PutBucketPolicy",method:"PUT",metricName:"S3_PutBucketPolicy",params:{policy:""}},{name:"DeleteBucketPolicy",method:"DELETE",metricName:"S3_DeleteBucketPolicy",params:{policy:""}},{name:"GetLifecycleConfiguration",method:"GET",metricName:"S3_GetLifecycleConfiguration",params:{lifecycle:""}},{name:"PutLifecycleConfiguration",method:"PUT",metricName:"S3_PutLifecycleConfiguration",params:{lifecycle:""}},{name:"DeleteLifecycleConfiguration",method:"DELETE",metricName:"S3_DeleteLifecycleConfiguration",params:{lifecycle:""}},{name:"GetBucketWebsite",method:"GET",metricName:"S3_GetBucketWebsite",params:{website:""}},{name:"GetBucketLogging",method:"GET",metricName:"S3_GetBucketLogging",params:{logging:""}},{name:"GetBucketVersioning",method:"GET",metricName:"S3_GetBucketVersioning",params:{versioning:""}},{name:"GetRequestPayment",method:"GET",metricName:"S3_GetRequestPayment",params:{requestPayment:""}},{name:"GetBucketNotification",method:"GET",metricName:"S3_GetBucketNotification",params:{notification:""}},{name:"PutBucketNotification",method:"PUT",metricName:"S3_PutBucketNotification",params:{notification:""}},{name:"GetBucketReplication",method:"GET",metricName:"S3_GetBucketReplication",params:{replication:""}},{name:"PutBucketReplication",method:"PUT",metricName:"S3_PutBucketReplication",params:{replication:""}},{name:"DeleteBucketReplication",method:"DELETE",metricName:"S3_DeleteBucketReplication",params:{replication:""}},{name:"GetBucketTagging",method:"GET",metricName:"S3_GetBucketTagging",params:{tagging:""}},{name:"PutBucketVersioning",method:"PUT",metricName:"S3_putBucketVersioning",params:{versioning:""}},{name:"PutBucketWebsite",method:"PUT",metricName:"S3_putBucketWebsite",params:{website:""}},{name:"DeleteBucketWebsite",method:"DELETE",metricName:"S3_deleteBucketWebsite",params:{website:""}},{name:"PutBucketLogging",method:"PUT",metricName:"S3_putBucketLogging",params:{logging:""}},{name:"PutBucketTagging",method:"PUT",metricName:"S3_putBucketTagging",params:{tagging:""}},{name:"DeleteBucketTagging",method:"DELETE",metricName:"S3_deleteBucketTagging",params:{tagging:""}},{name:"DeleteObjects",method:"POST",metricName:"S3_deleteObjects",params:{delete:""}},{name:"DeleteBucket",method:"DELETE",metricName:"S3_deleteBucket"},{name:"PutObject",method:"PUT",metricName:"S3_putObject"},{name:"HeadObject",method:"HEAD",metricName:"S3_headObject"},{name:"GetBucketMetrics",method:"GET",metricName:"S3_getBucketMetrics",params:{metrics:""}},{name:"PutBucketMetrics",method:"PUT",metricName:"S3_putBucketMetrics",params:{metrics:""}},{name:"DeleteBucketMetrics",method:"DELETE",metricName:"S3_deleteBucketMetrics",params:{metrics:""}},{name:"GetBucketAnalytics",method:"GET",metricName:"S3_getBucketAnalytics",params:{analytics:""}},{name:"PutBucketAnalytics",method:"PUT",metricName:"S3_putBucketAnalytics",params:{analytics:""}},{name:"DeleteBucketAnalytics",method:"DELETE",metricName:"S3_deleteBucketAnalytics",params:{analytics:""}},{name:"PutBucketAccelerate",method:"PUT",metricName:"S3_putBucketAccelerate",params:{accelerate:""}},{name:"GetBucketAccelerate",method:"GET",metricName:"S3_getBucketAccelerate",params:{accelerate:""}},{name:"PutRequestPayment",method:"PUT",metricName:"S3_PutRequestPayment",params:{requestPayment:""}},{name:"GetBucketIsidoreConfiguration",method:"GET",metricName:"S3_getBucketIsidoreConfiguration",params:{isidore:""}},{name:"PutBucketIsidoreConfiguration",method:"PUT",metricName:"S3_putBucketIsidoreConfiguration",params:{isidore:""}},{name:"DeleteBucketIsidoreConfiguration",method:"DELETE",metricName:"S3_deleteBucketIsidoreConfiguration",params:{isidore:""}},{name:"ListBucketIsidoreConfiguration",method:"GET",metricName:"S3_listBucketIsidoreConfiguration"},{name:"PutBucketDefaultEncryption",method:"PUT",metricName:"S3_putBucketDefaultEncryption",params:{encryption:""}},{name:"GetBucketDefaultEncryption",method:"GET",metricName:"S3_getBucketDefaultEncryption",params:{encryption:""}},{name:"DeleteBucketDefaultEncryption",method:"DELETE",metricName:"S3_deleteBucketDefaultEncryption",params:{encryption:""}},{name:"PutObjectLockConfiguration",method:"PUT",metricName:"S3_putObjectLockConfiguration",params:{"object-lock":""}},{name:"GetObjectLockConfiguration",method:"GET",metricName:"S3_getObjectLockConfiguration",params:{"object-lock":""}},{name:"PutObjectRetention",method:"PUT",metricName:"S3_putObjectRetention",params:{retention:""}},{name:"GetObjectRetention",method:"GET",metricName:"S3_getObjectRetention",params:{retention:""}},{name:"PutObjectLegalHold",method:"PUT",metricName:"S3_putObjectLegalHold",params:{"legal-hold":""}},{name:"GetObjectLegalHold",method:"GET",metricName:"S3_getObjectLegalHold",params:{"legal-hold":""}}]}),t.factory("S3Service",["S3ProxyConfig","AWSConsoleProxyService","$http","$q","Region","S3Endpoint","XMLParser","$window",function(e,t,n,r,i,a,o,s){return e.ajaxEndpoint=a,t(e,n,r,i,o,s)}])}(),function(){"use strict";e.module("awsconsole.common").constant("S3_WRAPPER_SERVICE_METRICS",{GET_BUCKET_LOCATION_BY_HEAD_BUCKET:"S3Wrapper_GetBucketLocationByHB",GET_BUCKET_LOCATION:"S3Wrapper_GetBucketLocation",FALLBACK_HEAD_BUCKET_RETRY:"FBKHeadBktRetry",FALLBACK_HEAD_BUCKET:"FBKHeadBkt",FALLBACK_HEAD_BUCKET_DONE:"FBKHeadBktDone",FALLBACK_HEAD_BUCKET_FAILED:"FBKHeadBktFailed",FALLBACK_GET_BUCKET_LOCATION:"FBKGetBucketLocation",FALLBACK_LAMB:"FBKLAMB",FALLBACK_LAMB_FAILED:"FBKLAMBFailed",FALLBACK_LAMB_DONE:"FBKLAMBDone",FALLBACK_LAMB_RETRY:"FBKLAMBRetry"}).constant("DEFAULT_RETRY_REGION",{PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1","ISO-B":"us-isob-east-1"}).factory("S3WrapperService",["$q","AWSC","DEFAULT_RETRY_REGION","Region","S3_WRAPPER_SERVICE_METRICS","S3Service",function(n,r,i,a,o,s){function c(e,t){t||(t=a.getCurrentRegion());var n=function(){var n={path:e};return"us-east-1"!==t&&(n.content='<CreateBucketConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><LocationConstraint>'+t+"</LocationConstraint></CreateBucketConfiguration>"),n}();return s.createBucket(n)}function l(e){function t(e){var t=e&&e.headers?e.headers()["x-amz-bucket-region"]:null;return t?(r.Clog.log(o.GET_BUCKET_LOCATION_BY_HEAD_BUCKET,1),n.when(t)):(r.Clog.log(o.GET_BUCKET_LOCATION_BY_HEAD_BUCKET,0),n.reject(e))}return s.headBucket({path:e}).then(t,t)}function u(t,n,r){return r||(r=w),n&&0!==n.length||(n=v()),d(t,e.copy(n),r)}function d(e,t,i){function a(a){var s=a&&a.headers?a.headers()["x-amz-bucket-region"]:null;return r.Clog.log(o.FALLBACK_HEAD_BUCKET+"_"+a.request.region.replace(/-/g,"_"),1),s?(r.Clog.log(o.FALLBACK_HEAD_BUCKET_DONE+"_"+a.request.region.replace(/-/g,"_"),1),n.when(s)):a.status&&a.status>=y&&a.status<S?(r.Clog.log(o.FALLBACK_HEAD_BUCKET_FAILED+"_"+a.request.region.replace(/-/g,"_"),0,{error:a}),n.reject(a)):(r.Clog.log(o.FALLBACK_HEAD_BUCKET_RETRY,1,{error:a,regionsToTry:t.slice(0)}),d(e,t,i))}return g(e,t,i,s.headBucket,a)}function p(t,n,r){return r||(r=w),n&&0!==n.length||(n=v()),f(t,e.copy(n),r)}function f(e,t,c){function l(s){if(s){if(s.status===C){var l=s.response.LocationConstraint,u=a.getCloudSystem();return"object"!=typeof l&&""!==l&&void 0!==l||(l=i[u]),"EU"===l&&(l="eu-west-1"),r.Clog.log(o.FALLBACK_GET_BUCKET_LOCATION+"_"+s.request.region.replace(/-/g,"_"),1),n.when(l)}return s.status>=y&&s.status<S?(r.Clog.log(o.FALLBACK_GET_BUCKET_LOCATION+"_"+s.request.region.replace(/-/g,"_"),0),n.reject(s)):(r.Clog.log(o.FALLBACK_GET_BUCKET_LOCATION+"_"+s.request.region.replace(/-/g,"_"),0),f(e,t,c))}return n.reject()}return g(e,t,c,s.getBucketLocation,l)}function g(e,t,r,i,a){return t&&0!==t.length?r(i,{path:e,region:t.shift()}).then(a,a):n.reject()}function m(t,n){return n||(n=w),h(e.copy(t),n)}function h(e,t){if(!e||0===e.length)return n.reject();var i=e.shift(),c=i.replace(/-/g,"_");return r.Clog.log(o.FALLBACK_LAMB+"_"+c,1),t(s.listAllMyBuckets,{region:i}).then(function(e){return r.Clog.log(o.FALLBACK_LAMB_DONE+"_"+c,1),e}).catch(function(s){var l=!1;if(s.status&&s.status==A){var u=a.getCurrentRegion();i!==u&&(l=!0,e=[u])}return!l&&s.status&&s.status>=y&&s.status<S?(r.Clog.log(o.FALLBACK_LAMB_FAILED+"_"+c,1,{error:s}),n.reject(s)):(r.Clog.log(o.FALLBACK_LAMB_RETRY,1,{error:s,regionsToTry:e}),m(e,t))})}function b(e){var r;return e&&(r={region:e}),s.listAllMyBuckets(r).then(function(e){var r=[].concat(t.get(e,["response","ListAllMyBucketsResult","Buckets","Bucket"],[]));return n.when(r)})}function v(){var e;try{e=a.getCurrentRegion()}catch(t){e=i.PUBLIC,r.Clog.log(_,1,t)}var n=e.substr(0,2),o=E(),s=[],c=a.getCloudSystem();return s.unshift(e),i[c]!==e&&s.unshift(i[c]),s=t.unionWith(s,o[n],t.isEqual),o=t.omit(o,n),t.forEach(o,function(e){s=t.unionWith(s,e)}),s}function E(){var e={};return t.forEach(a.regionMapping,function(t){var n=t.value,r=n.substr(0,2);e[r]?e[r].push(n):e[r]=[n]}),e}var S=500,y=400,A=403,C=200,_="GetCurrentRegionFail",w=function(e,t){return e(t)};return{createBucket:c,getBucketLocation:p,getBucketLocationByHeadBucket:l,getBucketLocationWithFallback:u,lambWithFallback:m,getBucketsArrayFromLamb:b,getRegionToTryOrder:v}}])}()}).call(t,n(0),n(2))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("SNSProxyConfig",{operations:[{name:"ListTopics",params:{Action:"ListTopics",ContentType:"JSON",Version:"2010-03-31"},headers:{},metricName:"SNS_ListTopics"},{name:"CreateTopic",params:{Action:"CreateTopic",ContentType:"JSON",Version:"2010-03-31"},headers:{},metricName:"SNS_CreateTopic"},{name:"SetTopicAttributes",params:{Action:"SetTopicAttributes",ContentType:"JSON",Version:"2010-03-31"},headers:{},metricName:"SNS_SetTopicAttributes"},{name:"Subscribe",params:{Action:"Subscribe",ContentType:"JSON",Version:"2010-03-31"},headers:{},metricName:"SNS_Subscribe"}]}),t.factory("SNSService",["SNSProxyConfig","AWSConsoleProxyService","$http","$q","Region","SNSEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("SQSProxyConfig",{operations:[{name:"AddPermission",params:{Action:"AddPermission",ContentType:"JSON",Version:"2012-11-05"},headers:{},metricName:"SQS_AddPermission"},{name:"CreateQueue",params:{Action:"CreateQueue",ContentType:"JSON",Version:"2012-11-05"},headers:{},metricName:"SQS_CreateQueue"},{name:"GetQueueUrl",params:{Action:"GetQueueUrl",ContentType:"JSON",Version:"2012-11-05"},headers:{},metricName:"SQS_GetQueueUrl"},{name:"ListQueues",params:{Action:"ListQueues",ContentType:"JSON",Version:"2012-11-05"},headers:{},metricName:"SQS_ListQueues"}]}),t.factory("SQSService",["SQSProxyConfig","AWSConsoleProxyService","$http","$q","Region","SQSEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("CloudWatchProxyConfig",{operations:[{name:"ListMetrics",params:{Action:"ListMetrics",ContentType:"JSON",Version:"2010-08-01"},headers:{},metricName:"CloudWatch_ListMetrics"},{name:"GetMetricStatistics",params:{Action:"GetMetricStatistics",ContentType:"JSON",Version:"2010-08-01"},headers:{},metricName:"CloudWatch_GetMetricStatistics"}]}),t.factory("CloudWatchService",["CloudWatchProxyConfig","AWSConsoleProxyService","$http","$q","Region","CloudWatchEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("GlacierProxyConfig",{operations:[{name:"CreateVault",method:"PUT",headers:{"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString(),"x-amz-glacier-version":"2012-06-01"},metricName:"Glacier_CreateVault"},{name:"ListVaults",method:"GET",path:"/-/vaults",headers:{"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString(),"x-amz-glacier-version":"2012-06-01"},metricName:"Glacier_ListVaults"},{name:"ListJobs",method:"GET",headers:{"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString(),"x-amz-glacier-version":"2012-06-01"},metricName:"Glacier_ListJobs"},{name:"ListProvisionedCapacity",method:"GET",path:"/-/provisioned-capacity",headers:{"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString(),"x-amz-glacier-version":"2012-06-01"},metricName:"Glacier_ListProvisionedCapacity"},{name:"PurchaseProvisionedCapacity",method:"POST",path:"/-/provisioned-capacity",headers:{"X-Amz-Date":(new Date).toUTCString(),"x-amz-glacier-version":"2012-06-01"},metricName:"Glacier_PurchaseCapacity"}]}),t.factory("GlacierService",["$http","$q","$window","AWSConsoleProxyService","GlacierEndpoint","GlacierProxyConfig","Region",function(e,t,n,r,i,a,o){return a.ajaxEndpoint=i,r(a,e,t,o,null,n)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(){"use strict";var t=e.module("awsconsole.common");t.constant("CloudTrailProxyConfig",{operations:["DescribeTrails","GetEventSelectors","PutEventSelectors"],serviceTarget:"CloudTrail_20131101",serviceTargetMetricName:"CloudTrail"}),t.factory("CloudTrailService",["CloudTrailProxyConfig","AWSConsoleProxyService","$http","$q","Region","CloudTrailEndpoint","$window",function(e,t,n,r,i,a,o){return e.ajaxEndpoint=a,t(e,n,r,i,null,o)}])}()}).call(t,n(0))},function(e,t,n){(function(e){!function(t){function n(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function r(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height}function i(e){var t=this;n(this),this.__resizeRAF__&&u(this.__resizeRAF__),this.__resizeRAF__=l(function(){r(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(n){n.call(t,e)}))})}function a(){if(!s){var e=(S||"")+".resize-triggers { "+(y||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n),s=!0}}var o=document.attachEvent,s=!1,c=t.fn.resize;if(t.fn.resize=function(t){return this.each(function(){this==window?c.call(e(this),t):addResizeListener(this,t)})},t.fn.removeResize=function(e){return this.each(function(){removeResizeListener(this,e)})},!o){var l=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),u=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}(),d=!1,p="",f="animationstart",g="Webkit Moz O ms".split(" "),m="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),h="",b=document.createElement("fakeelement");if(void 0!==b.style.animationName&&(d=!0),!1===d)for(var v=0;v<g.length;v++)if(void 0!==b.style[g[v]+"AnimationName"]){h=g[v],p="-"+h.toLowerCase()+"-",f=m[v],d=!0;break}var E="resizeanim",S="@"+p+"keyframes "+E+" { from { opacity: 0; } to { opacity: 0; } } ",y=p+"animation: 1ms "+E+"; "}window.addResizeListener=function(e,t){o?e.attachEvent("onresize",t):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),a(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),n(e),e.addEventListener("scroll",i,!0),f&&e.__resizeTriggers__.addEventListener(f,function(t){t.animationName==E&&n(e)})),e.__resizeListeners__.push(t))},window.removeResizeListener=function(e,t){o?e.detachEvent("onresize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",i),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}(e)}).call(t,n(6))},function(e,t,n){"use strict";(function(e,t,n){!function(){function r(e){var r={},i=n("#meta-features-json");if(!i||!i.attr("data-featuresjson"))return!1;var a=JSON.parse(i.attr("data-featuresjson"));return t.isArray(a)&&a.forEach(function(e){r[e.externalId]=e.enabled}),!0===r["s3-prod-stack-"+e]}var i={LOCAL:"LOCAL",PROD:"PROD",GAMMA:"GAMMA"},a={PUBLIC:{NAME:"PUBLIC",SUFFIX:"aws.amazon.com",PROD:"console.aws.amazon.com",GAMMA:"awsc-integ.aws.amazon.com"},CN:{NAME:"CN",SUFFIX:"amazonaws.cn",PROD:"console.amazonaws.cn",GAMMA:"awsc-integ.amazonaws.cn"},GOV:{NAME:"GOV",SUFFIX:"amazonaws-us-gov.com",PROD:"console.amazonaws-us-gov.com",GAMMA:"aws-console-proxy-staging.integ.amazonaws-us-gov.com"},ISO:{NAME:"ISO",SUFFIX:"c2shome.ic.gov",PROD:"console.c2shome.ic.gov",GAMMA:"awsc-integ.dca.amazon.com"},"ISO-B":{NAME:"ISO-B",SUFFIX:"sc2shome.sgov.gov",PROD:"console.sc2shome.sgov.gov",GAMMA:"awsc-integ.sc2shome.sgov.gov"}},o=["s3","command","batchOpsServlet","sns","sqs","lambda","kms","cloudwatch","glacier","cloudtrail"],s={PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1","ISO-B":"us-isob-east-1"},c=["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","eu-north-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ap-northeast-3","sa-east-1"],l={PUBLIC:{PROD:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","eu-north-1","ap-east-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ap-northeast-3","sa-east-1","ca-central-1"],GAMMA:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","eu-north-1","ap-east-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ap-northeast-3","sa-east-1","ca-central-1"]},CN:{PROD:["cn-north-1","cn-northwest-1"],GAMMA:["cn-north-1","cn-northwest-1"]},GOV:{PROD:["us-gov-west-1","us-gov-east-1"],GAMMA:["us-gov-west-1","us-gov-east-1"]},ISO:{PROD:["us-iso-east-1"],GAMMA:["us-iso-east-1"]},"ISO-B":{PROD:["us-isob-east-1"],GAMMA:["us-isob-east-1"]}},u=function(e){return"command"===e?e:"s3"===e?"proxy":e+"-proxy"};e.remove(l.PUBLIC.PROD,function(e){return e!==s.PUBLIC&&!r(e)}),1===l.PUBLIC.PROD.length&&(l.PUBLIC.PROD=c);var d={PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","eu-north-1","ap-east-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ap-northeast-3","ca-central-1","sa-east-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1","us-gov-east-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]},p=i.LOCAL,f=i.LOCAL;e.forEach(a,function(t){(e.contains(window.location.host,t.SUFFIX)||e.contains(window.location.host,t.GAMMA))&&(f=t.NAME,p=e.contains(window.location.host,"integ")?i.GAMMA:i.PROD)});var g={};f===a.PUBLIC.NAME?(o.forEach(function(t){g[t]={},d[f].forEach(function(n){var r=e.includes(l[f][p],n)?n:s[f],i=u(t);g[t][n]="https://"+r+"."+a[f][p]+"/s3/"+i})}),t.module("awsconsole.common").constant("S3Endpoint",g.s3),t.module("awsconsole.common").constant("S3CWSCommandEndpoint",g.command),t.module("awsconsole.common").constant("S3CWSEndpoint",g.batchOpsServlet),t.module("awsconsole.common").constant("SNSEndpoint",g.sns),t.module("awsconsole.common").constant("SQSEndpoint",g.sqs),t.module("awsconsole.common").constant("LambdaEndpoint",g.lambda),t.module("awsconsole.common").constant("KMSEndpoint",g.kms),t.module("awsconsole.common").constant("CloudWatchEndpoint",g.cloudwatch),t.module("awsconsole.common").constant("GlacierEndpoint",g.glacier),t.module("awsconsole.common").constant("CloudTrailEndpoint",g.cloudtrail)):f===a.CN.NAME?(o.forEach(function(t){g[t]={},d[f].forEach(function(n){var r=e.includes(l[f][p],n)?n:s[f],o=u(t);g[t][n]=r===s.CN?"https://"+a[f][p]+"/s3/"+o:p===i.GAMMA?"https://"+r+".awsc-integ.amazonaws.cn/s3/"+o:"https://"+r+"."+a[f][p]+"/s3/"+o})}),t.module("awsconsole.common").constant("S3Endpoint",g.s3),t.module("awsconsole.common").constant("S3CWSCommandEndpoint",g.command),t.module("awsconsole.common").constant("S3CWSEndpoint",g.batchOpsServlet),t.module("awsconsole.common").constant("SNSEndpoint",g.sns),t.module("awsconsole.common").constant("SQSEndpoint",g.sqs),t.module("awsconsole.common").constant("LambdaEndpoint",g.lambda),t.module("awsconsole.common").constant("KMSEndpoint",g.kms),t.module("awsconsole.common").constant("CloudWatchEndpoint",g.cloudwatch),t.module("awsconsole.common").constant("GlacierEndpoint",g.glacier),t.module("awsconsole.common").constant("CloudTrailEndpoint",g.cloudtrail)):(t.module("awsconsole.common").constant("S3Endpoint","/s3/proxy"),t.module("awsconsole.common").constant("S3CWSCommandEndpoint","/s3/command"),t.module("awsconsole.common").constant("S3CWSEndpoint","/s3/batchOpsServlet-proxy"),t.module("awsconsole.common").constant("SNSEndpoint","/s3/sns-proxy"),t.module("awsconsole.common").constant("KMSEndpoint","/s3/kms-proxy"),t.module("awsconsole.common").constant("LambdaEndpoint","/s3/lambda-proxy"),t.module("awsconsole.common").constant("SQSEndpoint","/s3/sqs-proxy"),t.module("awsconsole.common").constant("CloudWatchEndpoint","/s3/cloudwatch-proxy"),t.module("awsconsole.common").constant("GlacierEndpoint","/s3/glacier-proxy"),t.module("awsconsole.common").constant("CloudTrailEndpoint","/s3/cloudtrail-proxy")),t.module("awsconsole.common").constant("IAMEndpoint","/s3/iam-proxy"),t.module("awsconsole.common").constant("IAMAdminEndpoint","/s3/iamadmin-proxy"),t.module("awsconsole.common").constant("OptOutEndpoint","/s3/optOutServlet-proxy")}()}).call(t,n(2),n(0),n(6))},function(e,t,n){"use strict";(function(e,t){!function(){var r=n(0),i=n(459),a=n(460),o=n(461),s=n(462),c=n(463),l=n(464),u=n(465),d=n(466),p=n(467),f=n(468),g=n(469),m=r.module("s3",["AWS-DBUX-FAC","AWS-UI-Components","awsCommonComponents","awsconsole.common","ngCookies","ngRoute","ui.ace","pascalprecht.translate","storageconsole.common","angularResizable"]);m.run(["$templateCache",function(e){e.put("../partials/objects.html",n(470)),e.put("../partials/bucket-properties-tab.html",n(471)),e.put("../partials/storageConsoleLineChartS3.html",n(472)),e.put("../partials/storageConsoleLineChartAnalytics.html",n(473))}]),m.config(["$routeProvider","$locationProvider","S3Constants",function(e,t,n){t.html5Mode({enabled:!0});var r={translations:["$translate",function(e){return e.onReady()}]};e.when("/"+n.PATH_SEGMENTS.OBJECT_DETAILS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME+"/:"+n.PATH_SEGMENTS.KEY_PREFIX+"*",{template:i,controller:"ObjectDetailsController",reloadOnSearch:!1,resolve:r}),e.when("/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME+"/:"+n.PATH_SEGMENTS.KEY_PREFIX+"*",{template:a,controller:"ObjectController",resolve:r}),e.when("/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME+"/",{template:a,controller:"ObjectController",resolve:r}),e.when("/ot/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME+"/:"+n.PATH_SEGMENTS.KEY_PREFIX+"*/"+n.PATH_SEGMENTS.OBJECT_DETAILS,{template:i,controller:"ObjectDetailsController",resolve:r}),e.when("/lc/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME,{template:a,controller:"ObjectController",resolve:r}),e.when("/oi/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME,{template:a,controller:"ObjectController",resolve:r}),e.when("/si/"+n.PATH_SEGMENTS.BUCKETS+"/:"+n.PATH_SEGMENTS.BUCKET_NAME,{template:a,controller:"ObjectController",resolve:r}),e.when("/"+n.PATH_SEGMENTS.SETTINGS,{template:s,controller:"AccountSettingsController",resolve:r});var m=function(e){return{translations:r.translations,checkFAC:["FAC","$q","$location",function(t,n,r){return!!t.isFeatureEnabled(e)||(r.path("/"),n.defer().promise)}]}},h=m(n.FAC.BATCH_OPERATIONS);e.when("/"+n.PATH_SEGMENTS.JOBS,{template:c,controller:"JobListController",controllerAs:"vm",reloadOnSearch:!1,resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/"+n.PATH_SEGMENTS.JOB_CREATE,{template:f,controller:"CreateJobController",controllerAs:"cjc",reloadOnSearch:!1,resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/:"+n.PATH_SEGMENTS.JOB_ID,{template:l,controller:"JobDetailsController",controllerAs:"vm",reloadOnSearch:!1,resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/:"+n.PATH_SEGMENTS.JOB_ID+"/"+n.PATH_SEGMENTS.JOB_CONFIRM_AND_RUN,{template:u,controller:"JobConfirmAndRunController",controllerAs:"vm",resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/:"+n.PATH_SEGMENTS.JOB_ID+"/"+n.PATH_SEGMENTS.JOB_CANCEL,{template:d,controller:"JobCancelController",controllerAs:"vm",resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/:"+n.PATH_SEGMENTS.JOB_ID+"/"+n.PATH_SEGMENTS.JOB_EDIT_PRIORITY,{template:p,controller:"JobEditPriorityController",controllerAs:"vm",resolve:h}),e.when("/"+n.PATH_SEGMENTS.JOBS+"/:"+n.PATH_SEGMENTS.JOB_ID+"/"+n.PATH_SEGMENTS.JOB_CLONE,{template:f,controller:"CloneJobController",controllerAs:"cjc",reloadOnSearch:!1,resolve:h}),e.when("/"+n.PATH_SEGMENTS.FEATURE_SPOTLIGHT,{template:g,controller:"FeatureSpotlightController",resolve:m(n.FAC.FEATURE_SPOTLIGHT)}),e.otherwise({template:o,controller:"LambController",resolve:r})}]),m.config(["$httpProvider",function(e){e.defaults.useXDomain=!0,e.defaults.withCredentials=!0}]);var h=function(){var t=e("meta[property='requestLocale']").attr("content");return"zh"===t?"zh_CN":t};m.constant("CurrentLocale",h()),m.config(["$translateProvider",function(e){var r=window.AWSC,i=h();try{n(474);var a=n(495)("./"+i.toLowerCase()+".js");e.translations(i,a),e.preferredLanguage(i),e.useSanitizeValueStrategy("escapeParameters"),e.forceAsyncReload(!0),t.has(r,"Clog.log")&&r.Clog.log({key:"TranslationFileLoaded_"+i,value:1,pageId:"s3v2"})}catch(e){t.has(r,"Clog.log")&&r.Clog.log({key:"TranslationFileLoaded_"+i,value:0,pageId:"s3v2"})}}]),m.filter("humanReadableBytes",["$translate","S3Constants","$locale",function(e,t,n){var r=t.BYTES.UNITS.map(function(t){return e.instant(t)});return function(e,n){if(0===e||"0"===e)return e+" "+r[e];if(isNaN(e)||e<0)return"";void 0===n&&(n=1);var i=Math.floor(Math.log(e)/Math.log(t.BYTES.BASE));return(e/Math.pow(t.BYTES.BASE,Math.floor(i))).toFixed(n)+" "+r[i]}}])}()}).call(t,n(6),n(2))},function(e,t){e.exports='<sidebar-navigation open=false> <div class=object-details> <div class="watermark-wrapper header-section"> <div class="watermark watermark-file"></div> <breadcrumbs></breadcrumbs> <div class=file-name-container> <span class=file-name>{{obj.Key}}</span> <div class=version-label-container ng-click=listVersions($event)> <span ng-if=obj.versionLabel class=version-label>{{obj.versionLabel}}</span> <span ng-if=!obj.versionLabel class=version-label>{{obj.LastModified | date: dateFormat}}</span> <div class=versions-dropdown-caret></div> </div> <versions-dropdown ng-if=obj bucket=bucket error=error get-metadata="getMetadata(operation, versionId)" key=key obj=obj selected-tab=tabsInfo.selectedTab on-switch-version=onSwitchedObjectVersion(obj) show-versions-dropdown=showVersionsDropdown tabs=tabs versions-dropdown-selected-object=versionsDropdownSelectedObject.obj> </versions-dropdown> </div> </div> <awsui-tabs class=object-tabs tabs=tabs ng-model=tabsInfo.selectedTab ng-switch=tabsInfo.selectedTab ng-click=setTabParam(tabsInfo.selectedTab) ng-change=clearErrors()> <awsui-alert ng-if="tabsInfo.selectedTab === \'permissions\'" id=aclErrorAlert visible=errors.acl.message class="block permissions-error small-top-margin" type=error dismissible=false header="{{ errors.acl.header }}"> {{ errors.acl.message }} </awsui-alert> <div ng-switch-default class=overview> <awsui-alert type=success visible=showSuccessMessage>{{ successMessageString }}</awsui-alert> <awsui-button class=action-button-spacing id=open variant=normal text="{{ \'objectdetails.button.open\' | translate }}" click=openSelectedObject() data-disabled=actionButtonsDisabled()> </awsui-button> <awsui-button class=action-button-spacing id=download variant=normal text="{{ \'objectdetails.button.download\' | translate }}" click=downloadSelectedObject() data-disabled=actionButtonsDisabled()> </awsui-button> <awsui-button class=action-button-spacing id=downloadAs variant=normal text="{{ \'objectdetails.button.downloadAs\' | translate }}" click=openDownloadAsPanel() data-disabled=actionButtonsDisabled()> </awsui-button> <awsui-button class=action-button-spacing id=makepublic variant=normal text="{{ \'objectdetails.button.makepublic\' | translate }}" click=makePublic() loading=isMakingPublic data-disabled="actionButtonsDisabled() || makePublicButtonsDisabled()"> </awsui-button> <awsui-button class=action-button-spacing id=copypath variant=normal text="{{ \'objects.button.copypath\' | translate }}" click=copyPathToClipboard()> </awsui-button> <span class=copy-message ng-class="{ \'fade-in\' : copyFinished.flag, \'fade-out\' : !copyFinished.flag}" translate=copytoclipboard.path></span> <awsui-alert id=actionsErrorAlert visible=errors.actions class="block small-top-margin permissions-error" type=error dismissible=false header="{{ \'error.header\' | translate }}"> {{ errors.actions }} </awsui-alert> <div class=awsui-util-p-l></div> <div class=header translate=objectdetails.overview.owner></div> <div class=awsui-util-pb-m id=objectOwner>{{obj.Owner.DisplayName || obj.Owner.ID}}</div> <div class=header translate=last.modified></div> <div class=awsui-util-pb-m id=objectLastActivity>{{obj.LastModified | date: dateFormat}}</div> <div class=header translate=objectdetails.overview.etag></div> <div class=awsui-util-pb-m id=objectEtag>{{obj.ETag}}</div> <div class=header translate=objectdetails.overview.storageclass></div> <div class=awsui-util-pb-m id=objectStorageClass>{{ getStorageClassTranslation() }}</div> <div class=header translate=objectdetails.overview.sse></div> <div class=awsui-util-pb-m id=objectServerSideEncryption>{{ getEncryptionTranslation() }}</div> <div ng-if="obj.KmsID !== undefined" class=header translate=objectdetails.overview.kmsid></div> <div ng-if="obj.KmsID !== undefined" class=awsui-util-pb-m>{{obj.KmsID}}</div> <div ng-if=showReplication class=header translate=objectdetails.overview.replicationstatus></div> <div id=crr-objectdetail-status ng-if=showReplication class=awsui-util-pb-m>{{obj.ReplicationStatus}}</div> <div ng-if=showExpiry class=header translate=objectdetails.overview.expirydate></div> <div ng-if=showExpiry class=awsui-util-pb-m>{{obj.ExpirationDate}}</div> <div ng-if=showExpiry class=header translate=objectdetails.overview.expiryrule></div> <div ng-if=showExpiry class=awsui-util-pb-m>{{obj.ExpirationRule}}</div> <div ng-if=showRestoration class=header translate=objects.details.Restoration></div> <div ng-if=showRestoration class=awsui-util-pb-m translate=objectdetails.value.restoration></div> <div ng-if=restorationExpiry class=header translate=objects.details.RestorationExpiry></div> <div ng-if=restorationExpiry class=awsui-util-pb-m>{{restorationExpiry}}</div> <div class=header translate=objectdetails.overview.size></div> <div class=awsui-util-pb-m id=objectSize>{{ obj.Size | humanReadableBytes }}</div> <div ng-if=showVersionId class=header translate=objectdetails.overview.versionid></div> <div ng-if=showVersionId class=awsui-util-pb-m>{{obj.VersionId}}</div> <div class=header translate=objects.details.Key></div> <div class=awsui-util-pb-m>{{getFullKey(obj)}}</div> <div class=header translate=objectdetails.overview.link></div> <a class="link awsui-util-pb-m" id=object-link href={{obj.Link}}>{{obj.Link}}</a> <storage-console-config-panel class=download-side-panel ng-class="{\'side-config-panel objects-side-panel\': downloadAsPanel, \'hide-config-panel objects-side-panel\': !downloadAsPanel}" panel-open=downloadAsPanel> <header> <span class="side-panel-header download-as-panel-header" translate=object.download.destination></span> <span class=panel-close-icon ng-click=closeDownloadAsPanel()></span> </header> <content> <div class=download-as-directions> <div class=download-as-directions-text translate=object.download.directions></div> <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href={{downloadPanel.url}} id=downloadAsLink>{{ obj.Key }}</a> <div class=download-as-directions-text ng-show="!downloadAsPanelGenerating && downloadPanelError" translate=object.download.error></div> <span ng-show=downloadAsPanelGenerating class="awsui-spinner awsui-spinner-light"></span> </div> </content> </storage-console-config-panel> </div> <div ng-switch-when=properties> <object-properties obj=obj options=options bucket=bucket></object-properties> </div> <div ng-switch-when=permissions class=permissions-container> <acl ng-if=obj permission-obj=permissionObj put-acl=putAcl error=errors.acl.message is-bucket-permission=false bucket=bucket should-disable="obj && ((obj.StorageClass === \'GLACIER\' || obj.StorageClass === \'DEEP_ARCHIVE\') && !restorationExpiry)" block-public-access-settings=blockPublicAccessSettings> </acl> </div> <div fac-id=s3-select ng-switch-when=select> <s3-select ng-if=obj object=obj bucket=bucket /> </div> <awsui-alert visible="(!obj && objectDetailError) || (obj && objectDetailError && selectedTab === \'permissions\')" class="block small-top-margin permissions-error" type=error dismissible=false header="{{ \'error.header\' | translate }}"> {{ objectDetailError }} </awsui-alert> <awsui-alert visible=warning class="block small-top-margin permissions-error" type=warning dismissible=false header="{{ \'warning.header\' | translate }}"> {{ warning }} </awsui-alert> <awsui-alert visible="restoreWarning && selectedTab === \'properties\'" class="block small-top-margin permissions-error" type=warning dismissible=false header="{{ \'warning.header\' | translate }}"> {{ restoreWarning }} </awsui-alert> </awsui-tabs> </div> </sidebar-navigation> '},function(e,t){e.exports='<sidebar-navigation open=false> <div class="header-section watermark-wrapper" ng-class="{\'header-section-disabled\': isDisabledRegion}"> <div class="watermark-bucket watermark"></div> <breadcrumbs class=breadcrumbs-standard></breadcrumbs> </div> <div ng-if=isDisabledRegion class=bucket-details> <awsui-alert class=awsui-alert--has-button visible=!cjc.versioningEnabled type=error> <span dom-region=header> <span ng-bind-html="\'resource.access.denied\'|translate"></span> <a href={{iamLink}} target=_blank><awsui-button>My Account</awsui-button></a> </span> <span dom-region=content> <span translate=bucket.in_invalid_region></span> </span> </awsui-alert> </div> <awsui-tabs ng-if=!isDisabledRegion class="bucket-tabs bucket-details-tabs" tabs=tabs ng-model=selectedTab ng-switch=selectedTab ng-click=setTabParam(selectedTab)> <div ng-switch-default> <ng-include src="\'../partials/objects.html\'"></ng-include> </div> <div ng-switch-when=properties> <ng-include src="\'../partials/bucket-properties-tab.html\'"></ng-include> </div> <div class="access-public-label show-public-on-tab" ng-if="access.bucketPublic && tabs.length > 1" translate>world.access.public.label</div> <div ng-switch-when=permissions> <bucketpermissions access=access analyze-access=analyzeAccess(cacheAllowed) block-public-access-settings=blockPublicAccessSettings></bucketpermissions> </div> <div ng-switch-when=management fac-id=s3-si> <storage-management></storage-management> </div> </awsui-tabs> <div operation-manager selected-tab=selectedTab></div> </sidebar-navigation> '},function(e,t){e.exports='<sidebar-navigation> <awsui-alert class="notification dark" type=info ng-if=notificationShow> <targetmbox></targetmbox> <div class="notificationdoc awsui-util-f-r"><a href={{docLink}} target=_blank class="awsui-icon awsui-icon-link-light" translate=notification.doc></a></div> </awsui-alert> <div class=bucket-list> <div class=buckets-header> <div class=breadcrumbs> <span class="s3-logo-icon logo"></span> <span translate>lamb.label.allbuckets</span> </div> <div class=useful-links> <div ng-if=showVideo() class=hint-button fac-id=s3-intro-video> <span class="introvideo hint-icons"></span><awsui-button variant=link click=goToVideo() text="{{\'button.introvideo\' | translate}}" class=switch-back-button></awsui-button> </div> </div> </div> <div> <div class=action-strip sticky-nav=fix-to-top scroll-container=.sidebar-nav-main-content> <search ng-if=!showEmptyScreen filters=filters markers=markers is-lamb-page=true data-e2e-id=lambPageSearch> <search-filters ng-if="isFeatureEnabled(\'s3-ld\')"> <dropdown-simple class="search-filter-dropdown access-type-filter" items=accessTypeFilters get-count=getAccessTypeCount(item) selected-item=filters.accessType fill-height=true></dropdown-simple> </search-filters> </search> <awsui-button class="bucket-action-strip-button action-button-spacing" icon=plus text="{{ \'bucketactionstrip.createbucket\' | translate }}" variant=primary click=showCreateBucketModal() data-disabled="!isFeatureEnabled(\'s3-cb\')"></awsui-button> <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.editlockdown\' | translate }}" variant=normal click=editPublicAccess() ng-if="isFeatureEnabled(\'s3-ld\')" data-disabled=!hasSelectedBuckets()></awsui-button> <awsui-tooltip text={{emptyBucketTooltip()}} position=bottom size=small> <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.emptybucket\' | translate }}" variant=normal click=emptyBucket() data-disabled="!isFeatureEnabled(\'s3-eb\') || !hasSingleSelectedBucket()"></awsui-button> </awsui-tooltip> <awsui-tooltip text={{deleteBucketTooltip()}} position=bottom size=small> <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.deletebucket\' | translate }}" variant=normal click=deleteBucket() data-disabled="!isFeatureEnabled(\'s3-db\') || !hasSingleSelectedBucket()"></awsui-button> </awsui-tooltip> <awsui-button class=refresh-button icon=refresh variant=standalone-icon loading=isRefreshing click=reloadBuckets() data-disabled=isReloadDisabled()></awsui-button> <div class=num-regions> <label class=counter-literal data-e2e-id=numberOfRegions>{{ numRegions }}</label> <label class="counter-literal counter-text" translate>lamb.label.regions</label> </div> <div ng-if="!isFeatureEnabled(\'s3-ld\')" class=num-public-buckets fac-id=s3-access ng-click=showPublic()> <label class="counter-literal public-count" data-e2e-id=numberOfPublicBuckets>{{ !bucketsLeftToAnalyze ? numPublic : numPublic || \'-\'}}</label> <awsui-tooltip text="{{\'world.access.public.info\' | translate}}" position=bottom size=small> <label class="counter-literal counter-text public-text" translate>world.access.public.label</label> </awsui-tooltip> </div> <div class=num-buckets> <label class=counter-literal data-e2e-id=numberOfBuckets>{{ bucketList.length}}</label> <label class="counter-literal counter-text" translate>lamb.label.buckets</label> </div> </div> </div> <awsui-alert class=lamb-error type=error header="{{\'error.header\'|translate}}" visible=error>{{error}}</awsui-alert> <div class="columbia-table bucket-table"> <empty-state ng-if=showEmptyBucketScreen() open-modal=showCreateBucketModal type="\'bucket\'"></empty-state> <table ng-if=!showEmptyBucketScreen() class="table table-condensed fix-width-table"> <thead> <tr> <th ng-if="isFeatureEnabled(\'s3-ld\')" class=checkbox-column><awsui-checkbox data-e2e-id=selectAllBucketsCheckbox ng-model=tableSelection.allItemsSelected change=tableSelection.updateAllItemsSelection()></awsui-checkbox></th> <th ng-click="setSortOrder(\'Name\')" class=primary-column> <a translate=lamb.column.name></a> <table-sort-icon active="sortColumnName===\'Name\'" descending=reverseSortOrder></table-sort-icon> </th> <th ng-if="!isFeatureEnabled(\'s3-ld\')" fac-id=s3-access ng-click="setSortOrder(\'Access\')" class=access-column> <a translate=lamb.column.access></a> <awsui-tooltip text="{{\'lamb.column.accessinfo\' | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <table-sort-icon active="sortColumnName===\'Access\'" descending=reverseSortOrder ng-if=!bucketsLeftToAnalyze></table-sort-icon> <span class="awsui-spinner awsui-spinner-disabled card-spinner" ng-if=bucketsLeftToAnalyze></span> </th> <th ng-if="isFeatureEnabled(\'s3-ld\')" fac-id=s3-access ng-click="setSortOrder(\'publicAccessType\')" class=access-column> <a translate=lamb.column.access></a> <awsui-tooltip class=tooltip-wrap-enabled text="{{\'lockdown.access.column_tooltip\' | translate}}" position=bottom size=medium> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <table-sort-icon active="sortColumnName===\'publicAccessType\'" descending=reverseSortOrder ng-if=!bucketsLeftToAnalyze></table-sort-icon> <span class="awsui-spinner awsui-spinner-disabled card-spinner" ng-if=bucketsLeftToAnalyze></span> </th> <th ng-click="setSortOrder(\'Location\')" ng-show=isAccessFilterDisabled()> <a translate=lamb.column.region></a> <table-sort-icon active="sortColumnName===\'Location\'" descending=reverseSortOrder></table-sort-icon> </th> <th ng-click="setSortOrder(\'CreationDate\')" ng-show=isAccessFilterDisabled()> <a translate=lamb.column.creationdate></a> <table-sort-icon active="sortColumnName===\'CreationDate\'" descending=reverseSortOrder></table-sort-icon> </th> <th ng-click="setSortOrder(\'Read\')" ng-show="filters.accessFilters.length > 0" fac-id=s3-access> <a translate=lamb.column.read></a> <table-sort-icon active="sortColumnName===\'Read\'" descending=reverseSortOrder></table-sort-icon> </th> <th ng-click="setSortOrder(\'Write\')" ng-show="filters.accessFilters.length > 0" fac-id=s3-access> <a translate=lamb.column.write></a> <table-sort-icon active="sortColumnName===\'Write\'" descending=reverseSortOrder></table-sort-icon> </th> <th ng-click="setSortOrder(\'Source\')" ng-show="filters.accessFilters.length > 0" fac-id=s3-access> <a translate=lamb.column.source></a> <table-sort-icon active="sortColumnName===\'Source\'" descending=reverseSortOrder></table-sort-icon> </th> </tr> </thead> <tbody> <tr class=unselectable unselectable=on onselectstart=return!1 ng-show=!isLoadingPage ng-repeat="bucket in bucketList | orderBy:sortColumnName:reverseSortOrder" ng-click="clickBucketRow($event, bucket)" class=bucket-row ng-class="{\'row-selected\': bucket.selected, \'row-hover\' : hoverBucketRow && !bucket.selected && !bucket.disabled, \'disabled-region\' : bucket.disabled }" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false"> <td ng-if="isFeatureEnabled(\'s3-ld\')" class=checkbox-column><awsui-checkbox disabled=bucket.disabled checked=bucket.selected change=tableSelection.toggleItem(bucket) ng-click="clickCheckBox($event, bucket)"></awsui-checkbox></td> <td class="awsui-icon bucket truncate primary-column" ng-class="{\'awsui-icon-light\': bucket.selected}"><a ng-show=!bucket.disabled class=list-view-item-name ng-href="buckets/{{bucket.Name}}/?region={{regionFromUrl}}&tab=overview" ng-click="selectBucket(bucket.Name, \'overview\')">{{bucket.Name}}</a><span ng-show=bucket.disabled class="list-view-item-name list-view-item-name-disabled">{{bucket.Name}}</span></td> <td fac-id=s3-access class=access-column> <span ng-if="!isFeatureEnabled(\'s3-ld\')" ng-class="{\'public-text\': bucket.isPublic}">{{bucket.Access}}</span> <span ng-if="isFeatureEnabled(\'s3-ld\')" ng-class="{\'public-text\': bucket.publicAccessType === \'public\'}">{{ bucket.publicAccessLabel }}</span> </td> <td ng-show=isAccessFilterDisabled()>{{ getBucketLocationText(bucket) }}</td> <td ng-show=isAccessFilterDisabled()>{{bucket.CreationDate | date: dateFormat }}</td> <td ng-show="filters.accessFilters.length > 0" fac-id=s3-access>{{bucket.Read}}</td> <td ng-show="filters.accessFilters.length > 0" fac-id=s3-access>{{bucket.Write}}</td> <td ng-show="filters.accessFilters.length > 0" class=bucket-source fac-id=s3-access ng-click="selectBucket(bucket.Name, \'permissions\')">{{bucket.Source}}</td> </tr> <tr> <storage-console-config-panel ng-mouseenter=hoverSidePanelAction(true) ng-mouseleave=hoverSidePanelAction(false) class=bucket-side-panel ng-class="{\'side-config-panel bucket-side-panel\': panelOpen, \'hide-config-panel bucket-side-panel\': panelHide}" panel-open=panelOpen> <header> <div class=bucket-side-panel-header> <div class="truncate side-panel-header-name">{{ configPanelBucket.Name }}</div> <span class=panel-close-icon ng-click=closePanel()></span> </div> <awsui-button size=small text="{{ \'bucketproperties.sideconfigpanel.copyarn\' | translate }}" click=copyARNToClipboard($event)></awsui-button> </header> <content> <ul class=bucket-panel-config-lists ng-repeat="(configTitle, configContent) in configData" ng-click=moveToBucketTab(configTitle)> <li> <div class=subtitle translate=bucketproperties.{{configTitle}}></div> <ul class=bucket-config-panel-content> <li ng-repeat="(configKey, configValue) in configContent"> <div class="truncate config-panel-content-left" translate=bucketproperties.sideconfigpanel.{{configKey}}></div> <div class="truncate config-panel-content-right">{{configValue}}</div> </li> </ul> </li> </ul> </content> </storage-console-config-panel> </tr> </tbody> </table> <div class=access-warning fac-id=s3-access ng-if="!isFeatureEnabled(\'s3-ld\')" ng-show="!isLoadingPage && !showEmptyBucketScreen()"> <translate>lamb.column.tooltip.access.disclaimer</translate> <a ng-href={{accessDocLink}} translate target=_blank>learn.more</a> </div> <div ng-if=isLoadingPage class=loading-spinner> <span class="awsui-spinner awsui-spinner-large"></span> </div> </div> </div> <div ng-if=!isLoadingPage operation-manager></div> <create-bucket-modal ng-if=isCreateBucketModalOpen.flag is-open=isCreateBucketModalOpen bucket-list=unfilteredBucketList regions=regions num-regions=numRegions load-buckets=loadBuckets></create-bucket-modal> <bucket-confirmation-modal ng-if=isConfirmationModalOpen.flag header-title=bucketConfirmationDetails.headerTitle is-open=isConfirmationModalOpen warning-message=bucketConfirmationDetails.warningMessage operation=bucketConfirmationDetails.operation is-delete=bucketConfirmationDetails.isDelete validation-messages=bucketConfirmationDetails.validationMessages review-considerations=bucketConfirmationDetails.reviewConsiderations> </bucket-confirmation-modal> <edit-public-access-modal ng-if=editPublicAccessModal.isOpen.flag is-open=editPublicAccessModal.isOpen selected-buckets=editPublicAccessModal.selectedBuckets public-buckets-count=editPublicAccessModal.publicBucketsCount bucket-changed-callback=analyzeAccess></edit-public-access-modal> </sidebar-navigation> '},function(e,t){e.exports="<sidebar-navigation> <div class=account-settings__page> <public-access-settings-panel></public-access-settings-panel> </div> </sidebar-navigation>"},function(e,t){e.exports='<sidebar-navigation class=side-navigation--allow-overflow-x> <div class=job-management-preview-banner translate=job_management.preview_message translate-compile ng-if=vm.isPreview></div> <div class="job-management-list page-container"> <h2 class=page-container__title translate=job_management.list.page_title></h2> <p class=page-container__description> <span translate=job_management.list.description_1></span> <external-link href="{{ vm.cloudWatchEventsLink }}" text="{{\'job_management.list.description_cloudwatch_link\' | translate}}"></external-link><span translate=job_management.list.description_2></span> <learn-more-link href="{{ vm.learnMoreLink }}"></learn-more-link> </p> <awsui-alert ng-if=vm.error class=page-container__error type=error header="{{ vm.error.header }}"> <div ng-if=vm.error.content ng-bind-html=vm.error.content></div> </awsui-alert> <awsui-alert dismissible=false ng-if=vm.clientSideFilteringDisabled()><span ng-bind-html="\'job_management.list.filtering_disabled_notification\' | translate:{ maxJobs: vm.maxJobs }"></span></awsui-alert> <awsui-alert dismissible=true ng-if=vm.successAlert type=success header={{vm.successAlert.header}}> <div ng-if=vm.successAlert.content ng-bind-html=vm.successAlert.content></div> </awsui-alert> <div class="search-strip search-strip--wrap"> <div class=search-container> <div class=search-box ng-class="{ \'search-box__disabled\': vm.clientSideFilteringDisabled() }"> <span class=search-icon ng-if=!noBackendCalls><i class="awsui-icon search"></i></span> <span> <input type=text class=input-field ng-model=vm.filters.search ng-change=vm.filterJobs() placeholder="{{ \'job_management.list.search_placeholder\' | translate }}" ng-disabled=vm.clientSideFilteringDisabled() /> </span> </div> </div> <div class=filter-container> <dropdown-simple class="search-filter-dropdown status-filter" items=vm.statusFilters selected-item=vm.filters.status fill-height=true label="{{ \'job_management.list.status_filter_label\' | translate }}" alt-style=true change=vm.loadJobs()></dropdown-simple> </div> <div class=filter-container> <dropdown-simple class="search-filter-dropdown region-filter" items=vm.regionFilters selected-item=vm.filters.region fill-height=true label="{{ \'job_management.list.region_filter_label\' | translate }}" alt-style=true change=vm.changeRegion(vm.filters.region)></dropdown-simple> </div> </div> <div class=action-strip> <awsui-button class=action-button-spacing icon=plus text="{{ \'job_management.actions.create\' | translate }}" variant=primary href="{{ vm.getCreatePath() }}"></awsui-button><awsui-button ng-repeat="action in vm.actions" class=action-button-spacing text="{{ \'job_management.actions.\' + action | translate }}" variant=normal href="{{ vm.getActionPath(action) }}" data-disabled=!vm.isActionEnabled(action)></awsui-button> <div class=refresh-button> <awsui-button icon=refresh variant=standalone-icon loading=vm.isLoading click=vm.loadJobs()></awsui-button> </div> </div> <div class=columbia-table> <div class="pages-row pages-row-top"> <job-management-pagination start=vm.getPaginationStart() end=vm.getPaginationEnd() total=vm.getPaginationTotal() prev-page=vm.prevPage() next-page=vm.nextPage() prev-disabled=vm.prevDisabled() next-disabled=vm.nextDisabled() disabled=vm.isLoading incomplete=vm.jobListTruncated></job-management-pagination> </div> <awsui-radio-group class=radio-group--unstyled ng-model=vm.selectedJobId ng-change=vm.selectJob(vm.selectedJobId)> <table class="table table-condensed job-list-table"> <thead> <tr> <th class=checkbox-column></th> <th ng-repeat="column in vm.columns" ng-click=vm.sortBy(column) ng-class=vm.getHeaderClass(column)> <a translate="job_management.properties.{{ column.name }}"></a> <awsui-tooltip ng-if=column.tooltip text="{{column.tooltip | translate}}" position="{{ column.tooltipPosition || \'bottom\' }}" size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <table-sort-icon disabled=vm.clientSideFilteringDisabled() active="vm.sortColumn === column" descending=vm.sortDescending></table-sort-icon> </th> </tr> </thead> <tbody> <tr ng-repeat="job in vm.filteredJobs | limitTo:vm.resultsPerPage:vm.paginationStart" ng-class="{\'row-selected\': vm.isSelected(job), \'row-hover\': hoverBucketRow && !vm.isSelected(job) }" ng-click=vm.selectJob(job.JobId) ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false"> <td class=checkbox-column> <awsui-radio-button class=radio-button--small value={{job.JobId}}></awsui-radio-button> </td> <td ng-repeat="column in vm.columns" ng-class=vm.getCellClass(column) ng-bind-html=column.getData(job)></td> </tr> </tbody> </table> </awsui-radio-group> <div class=page-container__empty-message ng-if="!vm.isLoading && !vm.error && vm.filteredJobs.length === 0"> <h4 translate=job_management.list.empty_header></h4> <p translate=job_management.list.empty_message></p> </div> <div class=pages-row> <job-management-pagination start=vm.getPaginationStart() end=vm.getPaginationEnd() total=vm.getPaginationTotal() prev-page=vm.prevPage() next-page=vm.nextPage() prev-disabled=vm.prevDisabled() next-disabled=vm.nextDisabled() disabled=vm.isLoading incomplete=vm.jobListTruncated ng-if="!vm.isLoading && vm.filteredJobs.length > 0"></job-management-pagination> </div> </div> </div> </sidebar-navigation> '},function(e,t){e.exports='<sidebar-navigation open=false> <div class="page-container detail-page"> <div class=detail-page__header> <job-management-breadcrumbs item="{{ \'job_management.details.job_id_title\' | translate:{ jobId: vm.jobId } }}"></job-management-breadcrumbs> <h2 class=detail-page__title translate=job_management.details.job_id_title translate-values="{ jobId: vm.jobId }"></h2> </div> <div class=detail-page__content> <awsui-alert dismissible=true ng-if=vm.successAlert type=success header={{vm.successAlert.header}}> <div ng-if=vm.successAlert.content ng-bind-html=vm.successAlert.content></div> </awsui-alert> <awsui-alert class=detail-page__info type=info ng-if=vm.infoMessage> <span ng-bind-html=vm.infoMessage></span> </awsui-alert> <div> <awsui-button ng-repeat="action in vm.actions" class=action-button-spacing variant=normal text="{{ \'job_management.actions.\' + action | translate }}" href="{{ vm.getActionPath(action) }}" disabled=!vm.isEnabled(action)> </awsui-button> <div class=refresh-button> <awsui-button icon=refresh variant=standalone-icon loading=vm.isLoading click=vm.loadJob()></awsui-button> </div> </div> <awsui-alert ng-if=vm.error class=detail-page__error type=error header="{{ vm.error.header }}"> <div ng-if=vm.error.content ng-bind-html=vm.error.content></div> </awsui-alert> <properties-display definition=vm.propertiesDefinition ng-if=vm.job></properties-display> </div> </div> </sidebar-navigation>'},function(e,t){e.exports='<sidebar-navigation open=false> <div class="page-container detail-page"> <div class=detail-page__header> <job-management-breadcrumbs item="{{ \'job_management.confirm_and_run.job_id_title\' | translate:{ jobId: vm.jobId } }}"></job-management-breadcrumbs> <h2 class=detail-page__title translate=job_management.confirm_and_run.job_id_title translate-values="{ jobId: vm.jobId }"></h2> </div> <div class=detail-page__content> <awsui-alert ng-if=vm.error class=detail-page__error type=error header="{{ vm.error.header }}"> <div ng-if=vm.error.content ng-bind-html=vm.error.content></div> </awsui-alert> <div ng-if=vm.job> <awsui-alert class=detail-page_info type=info> <h4 translate=job_management.confirm_and_run.warning_legal_disclaimer_heading_1></h4> <p translate=job_management.confirm_and_run.warning_legal_disclaimer_text_1 translate-values="{ s3DocLink: vm.s3PricingLink, lambdaDocLink: vm.lambdaPricingLink  }" translate-compile></p> <br/> <h4 translate=job_management.confirm_and_run.warning_legal_disclaimer_heading_2></h4> <p translate=job_management.confirm_and_run.warning_legal_disclaimer_text_2></p> </awsui-alert> <properties-display definition=vm.propertiesDefinition></properties-display> <awsui-alert ng-if=vm.actionError class=detail-page__action-error type=error header="{{ vm.actionError.header }}"> <div ng-if=vm.actionError.content ng-bind-html=vm.actionError.content></div> </awsui-alert> <div class=page-container__buttons-right> <awsui-button class=action-button-spacing variant=normal text="{{ \'button.cancel\' | translate }}" click=vm.cancel() disabled=vm.isWorking> </awsui-button> <awsui-button class=action-button-spacing variant=primary text="{{ \'job_management.actions.run_job\' | translate }}" click=vm.performAction() loading=vm.isWorking> </awsui-button> </div> </div> </div> </div> </sidebar-navigation>'},function(e,t){e.exports='<sidebar-navigation open=false> <div class="page-container detail-page"> <div class=detail-page__header> <job-management-breadcrumbs item="{{ \'job_management.cancel.job_id_title\' | translate:{ jobId: vm.jobId } }}"></job-management-breadcrumbs> <h2 class=detail-page__title translate=job_management.cancel.job_id_title translate-values="{ jobId: vm.jobId }"></h2> </div> <div class=detail-page__content> <awsui-alert ng-if=vm.error class=detail-page__error type=error header="{{ vm.error.header }}"> <div ng-if=vm.error.content ng-bind-html=vm.error.content></div> </awsui-alert> <div ng-if=vm.job> <awsui-alert class=detail-page__warning type=warning header="{{ \'job_management.cancel.warning_header\' | translate }}"> <p translate=job_management.cancel.warning_content></p> </awsui-alert> <div class=page-container__fixed-width-container> <awsui-control-group label="{{ \'job_management.cancel.status_update_reason_label\' | translate }} - {{ \'input.optional\' | translate }}"> <awsui-textarea ng-model=vm.statusUpdateReason> </awsui-textarea></awsui-control-group> </div> <properties-display definition=vm.propertiesDefinition></properties-display> <awsui-alert ng-if=vm.actionError class=detail-page__action-error type=error header="{{ vm.actionError.header }}"> <div ng-if=vm.actionError.content ng-bind-html=vm.actionError.content></div> </awsui-alert> <div class=page-container__buttons-right> <awsui-button class=action-button-spacing variant=normal text="{{ \'job_management.actions.do_not_cancel\' | translate }}" click=vm.cancel() disabled=vm.isWorking> </awsui-button> <awsui-button class=action-button-spacing variant=primary text="{{ \'job_management.actions.cancel_job\' | translate }}" click=vm.performAction() loading=vm.isWorking> </awsui-button> </div> </div> </div> </div> </sidebar-navigation>'},function(e,t){e.exports='<sidebar-navigation open=false> <div class="page-container detail-page"> <div class=detail-page__header> <job-management-breadcrumbs item="{{ \'job_management.edit_priority.job_id_title\' | translate:{ jobId: vm.jobId } }}"></job-management-breadcrumbs> <h2 class=detail-page__title translate=job_management.edit_priority.job_id_title translate-values="{ jobId: vm.jobId }"></h2> </div> <div class=detail-page__content> <awsui-alert ng-if=vm.error class=detail-page__error type=error header="{{ vm.error.header }}"> <div ng-if=vm.error.content ng-bind-html=vm.error.content></div> </awsui-alert> <div ng-if=vm.job> <p class=page-container__description> <span translate=job_management.edit_priority.info></span> <learn-more-link href="{{ vm.docLink }}"></learn-more-link> </p> <div class=properties-display> <h3 class=properties-display__section-title translate=job_management.properties.priority></h3> <div class=properties-display__property> <h4 class=properties-display__property-title translate=job_management.edit_priority.current_priority></h4> <div class=properties-display__property-value>{{ vm.job.Priority }}</div> </div> <div class=page-container__small-width-container> <awsui-control-group label="{{ \'job_management.edit_priority.new_priority\' | translate }}" instructional="{{ \'input.positive_numbers\' | translate }}" validation-message="{{ vm.validationMessage | translate }}" class=awsui-control-group--replace-validation-message> <awsui-textfield type=text autocomplete=off ng-model=vm.newPriority placeholder="{{ \'job_management.edit_priority.input_placeholder\' | translate }}" ng-change=vm.validatePriority()></awsui-textfield> </awsui-control-group> </div> </div> <properties-display definition=vm.propertiesDefinition></properties-display> <awsui-alert ng-if=vm.actionError class=detail-page__action-error type=error header="{{ vm.actionError.header }}"> <div ng-if=vm.actionError.content ng-bind-html=vm.actionError.content></div> </awsui-alert> <div class=page-container__buttons-right> <awsui-button class=action-button-spacing variant=normal text="{{ \'button.cancel\' | translate }}" click=vm.cancel() disabled=vm.isWorking> </awsui-button> <awsui-button class=action-button-spacing variant=primary text="{{ \'button.save\' | translate }}" click=vm.performAction() loading=vm.isWorking disabled=!vm.isValid()> </awsui-button> </div> </div> </div> </div> </sidebar-navigation>'},function(e,t){e.exports='<sidebar-navigation open=false> <div class="page-container create-page"> <div class=create-page__header> <h2 class=create-page__title translate={{cjc.jobMgmtTitle}}></h2> <ol class=create-page__steps> <li class=create-page__step ng-repeat="step in cjc.steps" ng-class="{ \'create-page__step--done\': cjc.currentStepIndex > $index, \'create-page__step--current\': cjc.currentStepIndex === $index }"> {{ step.name }} </li> </ol> </div> <div class=create-page__content> <awsui-alert ng-if=cjc.error class=detail-page__error type=error header="{{ cjc.error.header }}"> <div ng-if=cjc.error.content ng-bind-html=cjc.error.content></div> </awsui-alert> <span class=awsui-spinner ng-if=cjc.isLoadingJob></span> <form name=cjc.form ng-switch=cjc.getSelectedStep().value ng-if="!cjc.error && !cjc.isLoadingJob"> <awsui-alert type=info ng-if=cjc.isClone> <p translate=job_management.clone.warning translate-values="{ jobId: cjc.jobId }"></p> </awsui-alert> <div ng-switch-when=MANIFEST> <awsui-alert type=info ng-if=cjc.manifestFromInventory> <p translate=job_management.create.inventory_alert></p> </awsui-alert> <h3 class=create-page__heading translate=job_management.create.region.title></h3> <p class=page-container__description> <span translate=job_management.create.region.desc></span> </p> <awsui-control-group label="{{ \'createbucketmodal.label.region\' | translate }}"> <div class=page-container__fixed-width-container> <awsui-select class=awsui-select--alt items=cjc.regionFilters ng-model=cjc.currentRegion ng-change=cjc.changeRegion(cjc.currentRegion) data-e2e-id=batchOpsRegionSelector></awsui-select> </div> </awsui-control-group> <h3 class=create-page__heading translate=job_management.create.manifest.title></h3> <p class=page-container__description translate=job_management.create.manifest.description translate-values="{ inventoryLink: cjc.docLinks.inventory }" translate-compile></p> <awsui-control-group class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.manifest_format\' | translate }}"> <awsui-radio-group class=radio-group--unstyled ng-model=cjc.selectedManifestFormat data-e2e-id=manifestFormatSelector> <awsui-radio-button ng-repeat="manifest in cjc.manifestSelector" class=radio-button--small value={{manifest.value}}>{{manifest.name}}</awsui-radio-button> </awsui-radio-group> </awsui-control-group> <awsui-control-group class=awsui-control-group--checkbox label="{{ \'job_management.properties.manifest_csv_format\' | translate }}" ng-if=cjc.isCSVManifest()> <p class=awsui-control-group__description> <span translate=job_management.create.manifest.csv_description></span> <learn-more-link href="{{ cjc.docLinks.createJobManifestFormat }}"></learn-more-link> </p> <awsui-checkbox ng-model=cjc.versionIDinManifest class=awsui-checkbox--normal-weight> <span translate=job_management.properties.manifest_versions_included></span> </awsui-checkbox> </awsui-control-group> <awsui-control-group label="{{ \'job_management.properties.path_to_manifest\' | translate }}"> <span dom-region=control class=input-with-buttons> <awsui-textfield text-maxlength=10 class=input-with-buttons__input data-e2e-id=manifestPathInput name=manifestPath ng-model=cjc.manifestPath ng-model-options="{ debounce: 300 }" required ng-pattern="cjc.isManifestInventoryReport() ? cjc.s3InventoryReportPattern : cjc.s3PathPattern" placeholder="{{ \'input.placeholder_enter\' | translate:{ example: cjc.getManifestPlaceHolderPath() } }}" ng-change=cjc.processManifestETag() awsui-maxlength=1990></awsui-textfield> <awsui-button class=action-button-spacing text="{{ \'button.browse\' | translate }}" variant=normal click=cjc.browseManifest()></awsui-button> <awsui-button class=action-button-spacing disabled="!cjc.manifestPath || cjc.manifestPathValidationMessage" text="{{ \'button.view\' | translate }}" variant=normal href="{{ cjc.getObjectPathLink(cjc.manifestPath) }}" target=_blank></awsui-button> </span> <span dom-region=instructional> <span translate=job_management.create.format_instruction translate-values="{ example: \'s3://mybucket/myprefix/myobject\' }"></span> <learn-more-link href="{{ cjc.docLinks.createJobManifest }}"></learn-more-link> </span> <span dom-region=validationMessage ng-if="!cjc.showManifestBucketBrowser && (cjc.manifestPathValidation() || cjc.manifestPathValidationMessage)" ng-bind-html="cjc.manifestPathValidation() || (cjc.manifestPathValidationMessage | translate)"></span> </awsui-control-group> <div class=page-container__fixed-width-container> <awsui-control-group label="{{ \'job_management.properties.manifest_version_id\' | translate }} - {{ \'input.optional\' | translate }}"> <span dom-region=control> <awsui-textfield data-e2e-id=manifestVersionId ng-model=cjc.manifestVersionId placeholder="{{ \'job_management.create.manifest.version_id_placeholder\' | translate }}" awsui-maxlength=1990></awsui-textfield> </span> <span dom-region=instructional> <span translate=job_management.create.manifest.version_id_instruction></span> <learn-more-link href="{{ cjc.docLinks.createJobManifest }}"></learn-more-link> </span> </awsui-control-group> </div> <awsui-alert class="mt-4 awsui-alert--has-button" visible=cjc.etagPermissionsError type=error> <span dom-region=header> <span translate=job_management.create.manifest.etag_permission_error.header></span> <awsui-button class=action-button-spacing text="{{ \'button.retry\' | translate }}" variant=normal click=cjc.processManifestETag()></awsui-button> </span> <span dom-region=content> <span translate=job_management.create.manifest.etag_permission_error.content></span> </span> </awsui-alert> <div class=properties-display__property> <h4 class=properties-display__property-title> <span translate="{{ \'job_management.properties.manifest_etag\' }}"></span> <awsui-tooltip text="{{ \'job_management.create.manifest_etag_tooltip\' | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </h4> <div style=margin-top:5px class="properties-display__property-value readonly-field"> <span dom-region=control data-e2e-id=manifestEtag> <span ng-if=cjc.loadingEtag class=awsui-spinner></span> <span ng-if="!cjc.loadingEtag && cjc.etagPermissionsError" translate=error.insufficient_permissions class=text-color-light></span> <span ng-if="!cjc.loadingEtag && !cjc.etagPermissionsError">{{cjc.manifestETag || "-"}}</span> </span> </div> </div> </div> <div ng-switch-when=ACTION> <div> <h3 class=create-page__heading translate=job_management.create.operation.title></h3> <p class=page-container__description> <span translate=job_management.create.operation.description></span> <learn-more-link href="{{ cjc.docLinks.operations }}"></learn-more-link> </p> <awsui-control-group data-e2e-id=operationSelector class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.operation\' | translate }}"> <awsui-radio-group class=radio-group--unstyled name=operationType ng-model=cjc.operationType required ng-change=cjc.changeOperationType()> <awsui-radio-button ng-repeat="job in cjc.availableJobs" class=radio-button--small value={{job.value}} disabled=job.disabled> <span>{{job.name}}</span> <awsui-tooltip ng-if=job.tooltip text="{{job.tooltip | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </awsui-radio-button> </awsui-radio-group> </awsui-control-group> </div> <div ng-if="cjc.operationType === \'S3PutObjectCopy\'"> <h3 class=create-page__subheading translate="job_management.operation.{{ cjc.operationType.toLowerCase() }}"></h3> <p translate=job_management.create.operation.copy_destination_description translate-values="{ region: cjc.getCurrentRegionName() }"></p> <awsui-alert class="alert-exclamation-triangle mt-4" type=info ng-if=!cjc.validatePathCharacters(cjc.operation.TargetResource) header="{{ \'job_management.create.operation.copy_destination_warning_header\' | translate }}" content="{{ \'job_management.create.operation.copy_destination_warning_content\' | translate }}"></awsui-alert>  <awsui-control-group label="{{ \'job_management.properties.copy_destination_bucket\' | translate }}"> <span dom-region=control class=input-with-buttons> <awsui-textfield data-e2e-id=putcopyDestination ng-model-options="{ debounce: 300 }" class=input-with-buttons__input ng-model=cjc.operation.TargetResource name=targetResource required ng-pattern=cjc.s3BucketPattern ng-change=cjc.checkTargetBucket() placeholder="{{ \'input.placeholder_enter\' | translate:{ example: \'s3://mybucket\' } }}" awsui-maxlength=1990></awsui-textfield> <awsui-button class=action-button-spacing text="{{ \'button.browse\' | translate }}" variant=normal click=cjc.browsePutCopyDestination()></awsui-button> <awsui-button class=action-button-spacing disabled="!(cjc.operation && cjc.operation.TargetResource)" text="{{ \'button.view\' | translate }}" variant=normal href="{{ cjc.getPrefixPathLink(cjc.operation.TargetResource) }}" target=_blank></awsui-button> <awsui-button class=action-button-spacing text="{{ \'bucketactionstrip.createbucket\' | translate }}" variant=normal click=cjc.showCreateBucketModal()></awsui-button> </span> <span dom-region=instructional> <span translate=job_management.create.format_instruction translate-values="{ example: \'s3://mybucket\' }"></span> <learn-more-link href="{{ cjc.docLinks.pathFormat }}"></learn-more-link> </span> <span dom-region=validationMessage ng-if="!cjc.showCopyDestinationBucketBrowser && (cjc.showBucketPathValidation(cjc.form.targetResource) || cjc.targetBucketValidationMessage)" ng-bind-html="cjc.showBucketPathValidation(cjc.form.targetResource) || (cjc.targetBucketValidationMessage | translate:{ bucketName: cjc.targetResourceBucket, region: cjc.getCurrentRegionName() })"></span> </awsui-control-group> <awsui-alert class="awsui-alert--has-button mt-4" visible=!cjc.versioningEnabled type=warning> <span dom-region=header> <span ng-bind-html=cjc.getVersioningHeader()></span> <awsui-button class=action-button-spacing text="{{ \'job_management.create.operation.versioning_warning_button\' | translate }}" variant=normal click=cjc.enableVersioning()></awsui-button> </span> <span dom-region=content> <span translate=job_management.create.operation.versioning_warning_content></span> </span> </awsui-alert> <awsui-control-group class=awsui-control-group--checkbox ng-if=!cjc.versioningEnabled> <awsui-checkbox data-e2e-id=putCopyDestVersionDisabledAck class=awsui-checkbox--normal-weight ng-if=!cjc.versioningEnabled ng-model=cjc.versioningAcknowledgement> <span translate=job_management.create.operation.versioning_acknowledgement></span> </awsui-checkbox> </awsui-control-group> <h3 class=create-page__subheading translate=job_management.properties.operation_storage_class></h3> <storage-class-table data-e2e-id=putCopyStorageClassControl storageclassvalue=cjc.operation.StorageClass on-select-storage-class=cjc.onSelectStorageClass deep-archive-fac-prefix=batchops-></storage-class-table> <h3 class=create-page__subheading translate=job_management.properties.operation_encryption></h3> <p> <span translate=job_management.create.operation.encryption_description></span> <learn-more-link href="{{ cjc.docLinks.serverSideEncryption }}"></learn-more-link> </p> <awsui-control-group label="{{ \'job_management.properties.operation_encryption_full\' | translate }}" class=awsui-control-group--radio-buttons> <server-side-encryption data-e2e-id=putCopySSEControl selected-encryption=cjc.selectedEncryption></server-side-encryption> </awsui-control-group> <h3 class=create-page__subheading translate=job_management.properties.operation_acl></h3> <p> <span translate=job_management.create.operation.acl_description></span> <learn-more-link href="{{ cjc.docLinks.acl }}"></learn-more-link> </p> <access-control-list data-e2e-id=putCopyReplaceACLControl ng-model=cjc.operation.AccessControlGrants owner-id=cjc.accountOwnerId owner-label-translation=job_management.create.operation.copy_owner_label></access-control-list> <h3 class=create-page__subheading translate=job_management.properties.operation_tags></h3> <p> <span translate=job_management.create.operation.tags_description></span> <learn-more-link href="{{ cjc.docLinks.tags }}"></learn-more-link> </p> <awsui-control-group data-e2e-id=putCopyReplaceTagOptions class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.operation_tags_full\' | translate }}"> <awsui-radio-group class=radio-group--unstyled ng-model=cjc.operation.TaggingDirective> <awsui-radio-button ng-repeat="tagAction in cjc.putCopyTagActions" class=radio-button--small value={{tagAction.value}}>{{tagAction.name}}</awsui-radio-button> </awsui-radio-group> </awsui-control-group> <div class=mt-3 ng-if="cjc.operation.TaggingDirective === \'REPLACE\'"> <object-tags-editor data-e2e-id=putCopyReplaceTagControl ng-model=cjc.operation.NewObjectTagging required></object-tags-editor> </div> <h3 class=create-page__subheading translate=job_management.properties.operation_metadata></h3> <p> <span translate=job_management.create.operation.metadata_description></span> <learn-more-link href="{{ cjc.docLinks.metadata }}"></learn-more-link> </p> <awsui-control-group data-e2e-id=putCopyReplaceMDOptions class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.operation_metadata_full\' | translate }}"> <awsui-radio-group class=radio-group--unstyled ng-model=cjc.metadataDirective> <awsui-radio-button ng-repeat="mdAction in cjc.putCopyMetadataActions" class=radio-button--small value={{mdAction.value}}>{{mdAction.name}}</awsui-radio-button> </awsui-radio-group> </awsui-control-group> <div class=mt-3 ng-if="cjc.metadataDirective === \'REPLACE\'"> <object-metadata-editor data-e2e-id=putCopyReplaceMDControl ng-model=cjc.operation.NewObjectMetadata></object-metadata-editor> </div> </div> <div ng-if="cjc.operationType === \'LambdaInvoke\'"> <h3 class=create-page__subheading translate="job_management.operation.{{ cjc.operationType.toLowerCase() }}"></h3> <p translate=job_management.create.operation.lambda_description translate-values="{ region: cjc.getCurrentRegionName() }"></p> <lambda-selector data-e2e-id=createJobLambdaSelector ng-model=cjc.operation.FunctionArn required></lambda-selector> </div> <div ng-if="cjc.operationType === \'S3PutObjectTagging\'"> <h3 class=create-page__subheading translate="job_management.operation.{{ cjc.operationType.toLowerCase() }}"></h3> <p translate=job_management.create.operation.replace_tags_description></p> <object-tags-editor data-e2e-id=replaceTagsControl ng-model=cjc.operation.TagSet required></object-tags-editor> </div> <div ng-if="cjc.operationType === \'S3PutObjectAcl\'"> <h3 class=create-page__subheading translate="job_management.operation.{{ cjc.operationType.toLowerCase() }}"></h3> <p> <span translate=job_management.create.operation.replace_acl_description></span> <learn-more-link href="{{ cjc.docLinks.acl }}"></learn-more-link> </p> <access-control-list data-e2e-id=replaceAclControl ng-model=cjc.operation.AccessControlPolicy.AccessControlList.Grants owner-id=cjc.operation.AccessControlPolicy.AccessControlList.Owner.ID owner-editable=true owner-label-translation=job_management.create.operation.replace_acl_owner_label owner-desc-translation=job_management.create.operation.replace_acl_owner_desc></access-control-list> </div> <div ng-if="cjc.operationType === \'S3InitiateRestoreObject\'"> <h3 class=create-page__subheading translate="job_management.operation.{{ cjc.operationType.toLowerCase() }}"></h3> <p> <span translate=job_management.create.operation.glacier_restore_description></span> <external-link href="{{ cjc.glacierPricingLink }}" text="{{ \'job_management.create.operation.glacier_restore_description_link\' | translate }}"></external-link> </p> <awsui-control-group validation-message="{{ cjc.showValidation(cjc.form.glacierDays) && \'input.positive_numbers\' | translate }}" label="{{ \'job_management.properties.operation_glacier_restore_num_days\' | translate }}"> <p class=awsui-control-group__description translate=job_management.create.operation.glacier_restore_num_days_description></p> <div> <awsui-textfield data-e2e-id=glacierDaysInput class=job-management-create__glacier-days name=glacierDays ng-pattern=cjc.glacierDaysPattern required ng-model=cjc.operation.ExpirationInDays placeholder="{{ \'input.enter_number\' | translate }}"></awsui-textfield> <span translate=job_management.create.operation.glacier_restore_days></span> </div> </awsui-control-group> <awsui-control-group class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.operation_glacier_restore_speed\' | translate }}"> <awsui-radio-group data-e2e-id=glacierTierSelector class=radio-group--unstyled ng-model=cjc.operation.GlacierJobTier> <div ng-repeat="rspeed in cjc.retrievalSpeedList"> <awsui-radio-button class=radio-button--small value={{rspeed.value}}> <div class=radio-button__label-main>{{rspeed.name}}</div> <div class=radio-button__label-desc>{{rspeed.desc}}</div> </awsui-radio-button> </div> </awsui-radio-group> </awsui-control-group> </div> </div> <div ng-switch-when=OPTIONS> <div> <h3 class=create-page__heading translate=job_management.create.options.title></h3> <awsui-control-group class=awsui-control-group--replace-validation-message label="{{ \'job_management.properties.job_description\' | translate }} - {{ \'input.optional\' | translate }}"> <div class=page-container__fixed-width-container> <awsui-textfield data-e2e-id=descriptionInput name=jobDescription ng-model=cjc.jobDescription awsui-maxlength=256></awsui-textfield> </div> </awsui-control-group> <awsui-control-group class=awsui-control-group--replace-validation-message label="{{ \'job_management.properties.priority\' | translate }}" instructional="{{ \'input.positive_numbers\' | translate }}" validation-message="{{ cjc.showValidation(cjc.form.jobPriority) && \'input.positive_numbers\' | translate }}"> <p class=awsui-control-group__description> <span translate=job_management.create.options.priority_description></span> <learn-more-link href="{{ cjc.docLinks.createPriority }}"></learn-more-link> </p> <div class=page-container__small-width-container> <awsui-textfield autocomplete=off name=jobPriority data-e2e-id=priorityInput ng-pattern=cjc.numberPattern required ng-model=cjc.jobPriority placeholder="{{ \'input.enter_number\' | translate }}" awsui-maxlength=9></awsui-textfield> </div> </awsui-control-group> <h4 class=create-page__subheading translate=job_management.create.options.report_title></h4> <p> <span translate=job_management.create.options.report_description></span> <learn-more-link href="{{ cjc.docLinks.report }}"></learn-more-link> </p> <awsui-control-group class=awsui-control-group--checkbox> <awsui-checkbox ng-model=cjc.generateCompletionReport data-e2e-id=generateReportCheckbox><span translate=job_management.properties.generate_report></span></awsui-checkbox> </awsui-control-group> <div ng-if=cjc.generateCompletionReport> <awsui-control-group data-e2e-id=reportScopeSelector class=awsui-control-group--radio-buttons label="{{ \'job_management.properties.report_scope\' | translate }}"> <awsui-radio-group class=radio-group--unstyled ng-model=cjc.reportScope> <awsui-radio-button ng-repeat="report in cjc.jobReportScope" class=radio-button--small value={{report.value}}>{{report.name}}</awsui-radio-button> </awsui-radio-group> </awsui-control-group> <awsui-control-group label="{{ \'job_management.properties.report_destination_full\' | translate }}" validation-message="{{ !cjc.showReportBucketBrowser && cjc.showPathValidation(cjc.form.jobReportDestination) || \'\' }}"> <span dom-region=control> <p class=awsui-control-group__description translate=job_management.create.options.report_destination_description translate-values="{ suffix: \'/job-{job-id}/report.json\' }"></p> <div class=input-with-buttons> <awsui-textfield data-e2e-id=reportDestinationInput class=input-with-buttons__input name=jobReportDestination ng-pattern=cjc.s3PathPattern required ng-model=cjc.jobReportDestination placeholder="{{ \'input.placeholder_enter\' | translate:{ example: \'s3://path/to/destination\' } }}" awsui-maxlength=630 ng-change=cjc.updatePolicyTemplate()></awsui-textfield> <awsui-button class=action-button-spacing text="{{ \'button.browse\' | translate }}" variant=normal click=cjc.browseReport()></awsui-button> <awsui-button class=action-button-spacing disabled=!cjc.jobReportDestination text="{{ \'button.view\' | translate }}" variant=normal href="{{ cjc.getPrefixPathLink(cjc.jobReportDestination) }}" target=_blank></awsui-button> <awsui-button class=action-button-spacing text="{{ \'bucketactionstrip.createbucket\' | translate }}" variant=normal click=cjc.showCreateBucketModal()></awsui-button> </div> </span> <span dom-region=instructional> <span translate=job_management.create.format_instruction translate-values="{ example: \'s3://mybucket/myprefix\' }"></span> <span translate=job_management.create.format_instruction_prefix></span> <learn-more-link href="{{ cjc.docLinks.pathFormat }}"></learn-more-link> </span> </awsui-control-group> </div> <h4 class=create-page__subheading translate=job_management.create.options.permissions_title></h4> <p> <span translate=job_management.create.options.permissions_description translate-values="{ batchOpIAMLink: cjc.docLinks.permissions, iamRoleLink: cjc.docLinks.roles }" translate-compile></span> </p> <awsui-expandable-section class=awsui-expandable-section--normal header="{{ \'job_management.create.options.view_role_trust_policy_label\' | translate }}" expanded=false> <awsui-tabs tabs=cjc.policyTabs ng-model=cjc.selectedTab ng-switch=cjc.selectedTab class=awsui-tabs--normal> <div ng-switch-default> <p translate=job_management.create.options.policy_template_message translate-compile ng-if="cjc.operationType !== \'LambdaInvoke\'"></p> <awsui-button class=mb-4 data-e2e-id=copyPolicyTemplateBtn text="{{ \'job_management.create.options.permissions_copy_policy_template\' | translate }}" variant=normal click=cjc.copyPolicyToClipboard(cjc.iamPolicyDocument)></awsui-button> <pre class=mb-0>{{cjc.iamPolicyDocument}}</pre> </div> <div ng-switch-when=trust> <awsui-button class=mb-4 data-e2e-id=copyTrustPolicyTemplateBtn text="{{ \'job_management.create.options.permissions_copy_trust_policy\' | translate }}" variant=normal click=cjc.copyPolicyToClipboard(cjc.trustPolicy)></awsui-button> <pre class=mb-0>{{cjc.trustPolicy}}</pre> </div> </awsui-tabs> </awsui-expandable-section> <awsui-control-group class=awsui-control-group--radio-buttons label="{{ \'job_management.create.options.permissions_label\' | translate }}"> <awsui-radio-group data-e2e-id=iamRoleTypeSelector class=radio-group--unstyled ng-model=cjc.selectedIAMRoleAction> <awsui-radio-button ng-repeat="permission in cjc.jobPermissions" class=radio-button--small value={{permission.value}}>{{permission.name}}</awsui-radio-button> </awsui-radio-group> </awsui-control-group> <div ng-if="cjc.selectedIAMRoleAction === \'EXISTING_ROLE\'"> <awsui-alert type=error visible=cjc.listRolesError> <error-message error=cjc.listRolesError></error-message> </awsui-alert> <awsui-control-group label="{{ \'job_management.properties.iam_role\' | translate }}"> <div class=input-with-buttons> <awsui-select data-e2e-id=iamRoleSelector class="input-with-buttons__input awsui-select--alt" id=existing-iam-role-id disabled=cjc.isLoadingRoles items=cjc.iamRoleList ng-model=cjc.selectedIAMRole required placeholder="{{ \'job_management.create.options.iam_role_select_placeholder\' | translate }}"></awsui-select> <awsui-button class=action-button-spacing icon=refresh variant=standalone-icon loading=cjc.isLoadingRoles click=cjc.listRoles()></awsui-button> <awsui-button class=action-button-spacing disabled=!cjc.selectedIAMRole icon=external-link icon-align=right text="{{ \'button.view\' | translate }}" variant=normal href="{{ cjc.getRoleLink() }}" target=_blank></awsui-button> </div> </awsui-control-group> </div> <awsui-control-group ng-if="cjc.selectedIAMRoleAction === \'CUSTOM_ROLE_ARN\'" label="{{ \'job_management.properties.iam_role_arn\' | translate }}" validation-message="{{ cjc.showValidation(cjc.form.customIAMRoleArn) && \'iam_role.arn_validation_message\' | translate }}"> <div dom-region=control class=page-container__fixed-width-container> <awsui-textfield data-e2e-id=customIamRoleInput ng-model=cjc.customIAMRoleArn name=customIAMRoleArn ng-pattern=cjc.arnPattern required placeholder="{{ \'job_management.create.options.iam_role_arn_placeholder\' | translate }}" awsui-maxlength=2048></awsui-textfield> </div> <span dom-region=instructional> <span translate=job_management.create.format_instruction translate-values="{ example: \'arn:partition:service:region:account:resource\' }"></span> <learn-more-link href="{{ cjc.docLinks.arn }}"></learn-more-link> </span> </awsui-control-group> </div> </div> <div ng-switch-when=REVIEW> <h3 class=create-page__heading translate=job_management.create.review.title></h3> <awsui-alert dismissible=false><span ng-bind-html="\'job_management.create.review.warning\' | translate:{ actionName: (cjc.createBtnTitle | translate) }"></span></awsui-alert> <h4 class="create-page__subheading create-page__subheading-with-button"> <span translate=job_management.properties.groups.region_and_manifest></span> <awsui-button class=create-page__heading-button text="{{ \'button.edit\' | translate }}" variant=normal click="cjc.currentStepIndex=0"></awsui-button> </h4> <properties-display data-e2e-id=regionAndManifestProperties definition=cjc.reviewRegionAndManifestProperties></properties-display> <h4 class="create-page__subheading create-page__subheading-with-button"> <span translate=job_management.properties.groups.operation></span> <awsui-button class=create-page__heading-button text="{{ \'button.edit\' | translate }}" variant=normal click="cjc.currentStepIndex=1"></awsui-button> </h4> <properties-display data-e2e-id=operationProperties definition=cjc.reviewOperationProperties></properties-display> <h4 class="create-page__subheading create-page__subheading-with-button"> <span translate=job_management.properties.groups.additional_options></span> <awsui-button class=create-page__heading-button text="{{ \'button.edit\' | translate }}" variant=normal click="cjc.currentStepIndex=2"></awsui-button> </h4> <properties-display data-e2e-id=additionalOptionsProperties definition=cjc.reviewOptionsProperties></properties-display> </div> <awsui-alert ng-if="cjc.actionError && cjc.currentStepIndex == 3" class=detail-page__action-error type=error header="{{ cjc.actionError.header }}"> <div ng-if=cjc.actionError.content ng-bind-html=cjc.actionError.content></div> </awsui-alert> <div class=page-container__buttons-right> <awsui-button class=action-button-spacing data-e2e-id=cancelButton text="{{ \'button.cancel\' | translate }}" variant=normal click=cjc.cancel()></awsui-button> <awsui-button class=action-button-spacing data-e2e-id=previousButton text="{{ \'button.previous\' | translate }}" variant=normal click=cjc.previous() ng-if="cjc.currentStepIndex > 0"></awsui-button> <awsui-button class=action-button-spacing data-e2e-id=nextButton text="{{ \'button.next\' | translate }}" variant=primary disabled="cjc.form.$invalid || cjc.isNextDisabled()" click=cjc.next() ng-if="cjc.currentStepIndex < 3"></awsui-button> <awsui-button class=action-button-spacing data-e2e-id=createJobButton text="{{ cjc.createBtnTitle | translate}}" variant=primary disabled=cjc.isNextDisabled() click=cjc.create() loading=cjc.isWorking ng-if="cjc.currentStepIndex == 3"></awsui-button> </div> </form> </div> </div> </sidebar-navigation> <bucket-browser ng-if=cjc.showCopyDestinationBucketBrowser region-filter=cjc.currentRegion is-open=cjc.showCopyDestinationBucketBrowser on-selected=cjc.onSelectPutCopyDest selected-path=cjc.operation.TargetResource title="{{ \'job_management.bucketbrowser.title.choosebucket\' | translate }}" is-bucket-selector=true only-buckets=true></bucket-browser> <bucket-browser ng-if=cjc.showReportBucketBrowser is-open=cjc.showReportBucketBrowser on-selected=cjc.onSelectReport selected-path=cjc.jobReportDestination title="{{ \'job_management.bucketbrowser.title.choosebucket\' | translate }}" is-bucket-selector=true></bucket-browser> <bucket-browser ng-if=cjc.showManifestBucketBrowser is-open=cjc.showManifestBucketBrowser on-selected=cjc.onSelectManifest selected-path=cjc.manifestPath title="{{ \'job_management.bucketbrowser.title.choosemanifest\' | translate }}"></bucket-browser> <create-bucket-modal ng-if=cjc.isCreateBucketModalOpen.flag is-open=cjc.isCreateBucketModalOpen bucket-list=cjc.bucketList regions=cjc.regions num-regions=cjc.numRegions load-buckets=cjc.loadBuckets on-create=cjc.createBucketCallBack disable-region-selection=cjc.disableRegionSelector></create-bucket-modal>'},function(e,t){e.exports='<sidebar-navigation class=sidebar-navigation> <div class=feature-spotlight-page fac-id=s3-spotlight> <div class=feature-spotlight-page__header> <h3 translate=spotlight.header.title></h3> </div> <div class=feature-spotlight-page__description> <span translate=spotlight.description.text translate-compile></span> </div> <div class=feature-spotlight-page__features> <div ng-repeat="feature in features"> <div class=feature-spotlight-page__card> <div class=feature-spotlight-page__text-container> <p translate={{feature.subtitle}}></p> <p translate={{feature.body}}></p> <p translate={{feature.learn}} translate-compile></p> </div> </div> </div> </div> </div> </sidebar-navigation>'},function(e,t){e.exports='<awsui-alert type=error header="{{\'error.header\'|translate}}" visible=currLocation.objects.error> <error-message error=currLocation.objects.error></error-message> </awsui-alert> <div ng-hide=objectListError class=object-list filedrop> <div ng-class="{ \'object-nav-wrapper\': !showEmptyScreen, \'object-nav-wrapper-empty\': showEmptyScreen }"> <div class=action-strip sticky-nav=fix-to-top scroll-container=.sidebar-nav-main-content> <search ng-if=!showEmptyScreen fetch-one-page-prefix=fetchOnePagePrefix(prefix) fetch-one-page-tag=fetchOnePageTag() filters=filters markers=markers versionskeymarkers=versionsIdMarkers versionsidmarkers=versionsIdMarkers showversions=showVersions tag-continuation-tokens=tagContinuationTokens> </search> <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.upload\' | translate }}" ng-click=openUploadModal() variant=primary icon=upload data-disabled="!isFeatureEnabled(\'s3-up\')"></awsui-button> <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.createfolder\' | translate }}" ng-click=showCreateFolder() variant=primary icon=plus data-disabled="!isFeatureEnabled(\'s3-cf\')"></awsui-button> <awsui-button class="bucket-action-strip-button action-button-spacing" data-e2e-id=button-download text="{{ \'objectactionstrip.download\' | translate }}" ng-click=downloadSelectedObject(!isDownloadable()) data-disabled=!isDownloadable()></awsui-button> <action-dropdown class=moredropdown get-selected-objects=getSelectedObjects get-selected-folders=getSelectedFolders is-single-object-only-selected=isSingleObjectOnlySelected tag-filter-length=filters.tagFilters.length text="{{ \'objectactionstrip.actions\' | translate }}" items=more_dropdown bucketname=bucketName show-versions=showVersions show-deleted=showDeleted disable-make-public=disableMakePublic></action-dropdown> <div ng-if=showVersionedView class=version-text> {{\'objectactionstrip.versiontext\' | translate}} </div> <awsui-button-group ng-if="isVersionedBucket && !showVersionedView" class=bucket-action-show-deleted-objs fac-id=s3-sdo> <awsui-button ng-class="{selected: !showDeleted}" ng-click=showAllObjects() text="{{ \'objectactionstrip.showall\' | translate }}"></awsui-button> <awsui-button ng-class="{selected: showDeleted}" ng-click=showDeletedObjects() text="{{ \'objectactionstrip.showdeleted\' | translate }}"></awsui-button> </awsui-button-group> <awsui-button-group ng-if="isVersionedBucket && showVersionedView" class=bucket-action-show-obj-version> <awsui-button ng-class="{selected: !showVersions}" ng-click=hideObjectVersions() text="{{ \'objectactionstrip.hide\' | translate }}"></awsui-button> <awsui-button ng-class="{selected: showVersions}" ng-click=showObjectVersions() text="{{ \'objectactionstrip.show\' | translate }}"></awsui-button> </awsui-button-group> <div class=refresh-button> <span class=object-bucket-region ng-bind=bucketRegion.text></span> <awsui-button id=refreshButton icon=refresh variant=standalone-icon loading=isRefreshing click="fetchObjects(false, false)"></awsui-button> </div> </div> </div> <empty-state ng-if=showEmptyScreen right-click=rightClick($event) open-modal=openUploadModal type="\'object\'"></empty-state> <div ng-if=noResultsMessage class=no-results right-click=rightClick($event)>{{noResultsMessage}}</div> <div class=columbia-table ng-class="showVersions ? \'object-table-versioned\' : \'object-table\'" ng-if="!showEmptyScreen && !noResultsMessage" right-click=rightClick($event)> <div class="pages-row pages-row-top"> <div class=pages> <awsui-button id=fetchPreviousPageBtn icon=angle-left variant=standalone-icon click=fetchPreviousPageOfObjects() data-disabled=isFetchPreviousPageDisabled()></awsui-button> <span ng-if=endKeyNum id=paginationNumbering>{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span> <awsui-button id=fetchNextPageBtn icon=angle-right variant=standalone-icon click=fetchNextPageOfObjects() data-disabled=isFetchNextPageDisabled()></awsui-button> </div> </div> <table class="table table-condensed fix-width-table"> <thead> <tr class=black-header> <th class=checkbox-column><awsui-checkbox data-e2e-id=selectAllObjectsCheckbox ng-model=tableSelection.allItemsSelected change=tableSelection.updateAllItemsSelection()></awsui-checkbox></th> <th ng-if=!showVersions ng-click="setSortOrder(\'Key\')"> <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position=bottom> <a translate=objects.column.key></a> <table-sort-icon active="sortColumnName===\'Key\'" descending=reverseSortOrder></table-sort-icon> </awsui-tooltip> </th> <th ng-if=!showVersions ng-click="setSortOrder(\'LastModified\')"> <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position=bottom> <a translate=last.modified></a> <table-sort-icon active="sortColumnName===\'LastModified\'" descending=reverseSortOrder></table-sort-icon> </awsui-tooltip> </th> <th ng-if=!showVersions ng-click="setSortOrder(\'Size\')"> <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position=bottom> <a translate=objects.column.size></a> <table-sort-icon active="sortColumnName===\'Size\'" descending=reverseSortOrder></table-sort-icon> </awsui-tooltip> </th> <th ng-if=!showVersions ng-click="setSortOrder(\'StorageClass\')"> <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position=bottom> <a translate=objects.column.storageclass></a> <table-sort-icon active="sortColumnName===\'StorageClass\'" descending=reverseSortOrder></table-sort-icon> </awsui-tooltip> </th> <th ng-if=showVersions> <span> {{ \'objects.column.key\' | translate }} </span> </th> <th ng-if=showVersions> <span> {{ \'objects.column.versionid\' | translate }} </span> </th> <th ng-if=showVersions> <span> {{ \'last.modified\' | translate }} </span> </th> <th ng-if=showVersions> <span> {{ \'objects.column.size\' | translate }} </span> </th> <th ng-if=showVersions> <span> {{ \'objects.column.storageclass\' | translate }} </span> </th> </tr> </thead> <tbody ng-hide=currLocation.loading> <tr ng-if=createFolder.displayed> <td></td> <td class="awsui-icon folder-open"> <update-object show-operation=createFolder.displayed default-encryption-enabled=defaultEncryptionEnabled fetch-objects=fetchObjects current-marker=currentMarker default-placeholder="{{\'createfolder.input.defaultvalue\' | translate}}" operation=operation reset-selection=resetSelection /> </td> <td></td> <td></td> <td></td> </tr> <tr class=unselectable unselectable=on onselectstart=return!1 ng-repeat="folder in currLocation.folders.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': folder.selected, \'row-hover\' : hoverFolder && !folder.selected }" ng-mouseenter="hoverFolder = true" ng-mouseleave="hoverFolder = false" ng-show=currLocation.folders.relativePaths.length ng-click="clickObjectRow($event, folder)" ng-dblclick=navigateIntoFolder(folder.Prefix) right-click="rightClick($event, folder)"> <td class=checkbox-column> <awsui-checkbox checked=folder.selected change=tableSelection.toggleItem(folder) ng-click="clickCheckBox($event, folder)"></awsui-checkbox> </td> <td class="awsui-icon folder-open truncate" ng-class="{\'awsui-icon-light\': folder.selected && !panelHide}"> <a class="list-view-item-name object-name" ng-click="navigateIntoFolder(folder.Prefix); $event.stopPropagation()" ng-if="!folder.beingRenamed && folder.Prefix !== \'\'"> {{ folder.Prefix }} </a> <a class="list-view-item-name object-name empty-folder-name" ng-click="navigateIntoFolder(folder.Prefix); $event.stopPropagation()" ng-if="!folder.beingRenamed && folder.Prefix === \'\'"></a> <span ng-if=folder.beingRenamed> <update-object show-operation=folder.beingRenamed default-encryption-enabled=defaultEncryptionEnabled fetch-objects=fetchObjects current-marker=currentMarker default-value={{folder.Prefix}} operation=operation reset-selection=resetSelection /> </span> </td> <td> -- </td> <td> -- </td> <td> -- </td> <td ng-if=showVersions> -- </td> </tr> <tr ng-if=showVersions class=unselectable unselectable=on onselectstart=return!1 ng-repeat="obj in currLocation.objects.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': obj.selected , \'row-hover\' : hoverObj && !obj.selected, \'not-version-row\': !obj.isVersionRow, \'version-row\': obj.isVersionRow}" ng-mouseenter="hoverObj = true" ng-mouseleave="hoverObj = false" data-disabled=!obj.isVersionRow ng-click="clickObjectRow($event, obj)" ng-dblclick=openObjectInBrowser(obj) right-click="rightClick($event, obj)"> <td ng-if=obj.isVersionRow class=checkbox-column><awsui-checkbox checked=obj.selected change=tableSelection.toggleItem(obj) ng-click="clickCheckBox($event, obj)"></awsui-checkbox></td> <td ng-if=obj.isVersionRow class=truncate> <span class=awsui-icon ng-class=getIconClass(obj) ng-click=openObjectInBrowser(obj)></span> <a class="list-view-item-name object-name" ng-click=goToObjectDetails(obj) ng-show=!obj.beingRenamed> {{ obj.LastModified | date:"medium" }} <span ng-if="obj.ETag && obj.IsLatest === \'true\'"> ({{ \'versionsdropdown.label.latestVersion\' | translate }})</span> <span ng-if=!obj.ETag> ({{ \'versionsdropdown.label.deleteMarker\' | translate }})</span> </a> <span ng-if=obj.beingRenamed> <update-object show-operation=obj.beingRenamed default-encryption-enabled=defaultEncryptionEnabled fetch-objects=fetchObjects current-marker=currentMarker default-value={{obj.Key}} operation=operation reset-selection=resetSelection /> </span> </td> <td class=truncate ng-if="obj.isVersionRow && obj.VersionId !== \'\'">{{ obj.VersionId }}</td> <td class=truncate ng-if="obj.isVersionRow && obj.VersionId === \'\'"> -- </td> <td ng-if=obj.isVersionRow></td> <td ng-if="obj.isVersionRow &&  obj.Size">{{ obj.Size | humanReadableBytes }}</td> <td ng-if="obj.isVersionRow && (obj.Size === \'\' || !obj.Size)"> -- </td> <td ng-if="obj.isVersionRow && obj.StorageClass">{{ getStorageClassTranslation(obj.StorageClass) }}</td> <td ng-if="obj.isVersionRow && (obj.StorageClass === \'\' || !obj.StorageClass)"> -- </td> <td ng-if=!obj.isVersionRow></td> <td ng-if=!obj.isVersionRow class=truncate> <a ng-if=!obj.isVersionRow class="list-view-item-name object-name" ng-click=goToObjectDetails(obj) ng-show=!obj.beingRenamed> {{ obj.Key }} </a> </td> <td ng-if=!obj.isVersionRow></td> <td ng-if=!obj.isVersionRow> {{ obj.LastModified | date:"medium" }} </td> <td ng-if=!obj.isVersionRow></td> <td ng-if=!obj.isVersionRow></td> </tr> <tr ng-if=!showVersions class=unselectable unselectable=on onselectstart=return!1 ng-repeat="obj in currLocation.objects.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': obj.selected , \'row-hover\' : hoverObj && !obj.selected}" ng-mouseenter="hoverObj = true" ng-mouseleave="hoverObj = false" ng-click="clickObjectRow($event, obj)" ng-dblclick=openObjectInBrowser(obj) right-click="rightClick($event, obj)"> <td class=checkbox-column><awsui-checkbox checked=obj.selected change=tableSelection.toggleItem(obj) ng-click="clickCheckBox($event, obj)"></awsui-checkbox></td> <td class=truncate> <span class=awsui-icon ng-class=getIconClass(obj) ng-click=openObjectInBrowser(obj)></span> <a class="list-view-item-name object-name" ng-click=goToObjectDetails(obj) ng-show=!obj.beingRenamed> {{ obj.Key }} </a> <span ng-if=obj.beingRenamed> <update-object show-operation=obj.beingRenamed default-encryption-enabled=defaultEncryptionEnabled fetch-objects=fetchObjects current-marker=currentMarker default-value={{obj.Key}} operation=operation reset-selection=resetSelection /> </span> </td> <td ng-if="obj.LastModified !== \'\'">{{ obj.LastModified | date: dateFormat }}</td> <td ng-if="obj.LastModified === \'\'"> -- </td> <td ng-if="obj.Size !== \'\'">{{ obj.Size | humanReadableBytes }}</td> <td ng-if="obj.Size === \'\'"> -- </td> <td ng-if="obj.StorageClass !== \'\'">{{ getStorageClassTranslation(obj.StorageClass)}}</td> <td ng-if="obj.StorageClass === \'\'"> -- </td> </tr> </tbody> </table> <div class=pages-row> <div class=pages> <awsui-button icon=angle-left variant=standalone-icon click=fetchPreviousPageOfObjects() data-disabled=isFetchPreviousPageDisabled()></awsui-button> <span ng-if=endKeyNum>{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span> <awsui-button icon=angle-right variant=standalone-icon click=fetchNextPageOfObjects() data-disabled=isFetchNextPageDisabled()></awsui-button> </div> </div> </div> <storage-console-config-panel class="objects-side-panel download-side-panel" ng-mouseenter=hoverDownloadPanel(true) ng-mouseleave=hoverDownloadPanel(false) ng-class="{\'side-config-panel\': downloadAsPanel, \'hide-config-panel\': !downloadAsPanel}" panel-open=downloadAsPanel> <header> <span class="side-panel-header download-as-panel-header" translate=object.download.destination></span> <span class=panel-close-icon ng-click=closeDownloadAsPanel()></span> </header> <content> <div class=download-as-directions> <div class=download-as-directions-text translate=object.download.directions></div> <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href={{downloadPanel.url}} id=downloadAsLink>{{ getSelectedObjects()[0].Key }}</a> <div class=download-as-directions-text ng-show="!downloadAsPanelGenerating && downloadPanelError" translate=object.download.error></div> <span ng-show=downloadAsPanelGenerating class="awsui-spinner awsui-spinner-light"></span> </div> </content> </storage-console-config-panel> <storage-console-config-panel class=objects-side-panel ng-mouseenter=hoverObjectPropertiesPanel(true) ng-mouseleave=hoverObjectPropertiesPanel(false) ng-class="{\'side-config-panel\': objectPropertiesPanel.show, \'hide-config-panel\': !objectPropertiesPanel.show, \'deleted-version\': objectSelectedForSidePanel.obj.ETag === undefined}" panel-open=objectPropertiesPanel.show> <header> <div class="truncate side-panel-header"> {{ objectPropertiesConfig.overview.Key }} </div> <span class=panel-close-icon ng-click=closeObjectPropertiesPanel()></span> <awsui-button ng-if=isDownloadable() class=sidepanel-header-button data-e2e-id=sidepanel-button-download ng-click=downloadSelectedObject(objectSelectedForSidePanel.obj.disableDownload) text="{{ \'objects.button.download\' | translate }}"></awsui-button> <awsui-button ng-if="!isFeatureEnabled(\'s3-deep-archive\') && objectPropertiesConfig.properties.StorageClass === \'Glacier\' && !isDownloadable()" class="sidepanel-header-button sidepanel-header-button-restore" ng-click=moreDropdownItemInitiateRestore.action() text="{{ \'objects.button.restorefromglacier\' | translate }}"></awsui-button> <awsui-button ng-if="isFeatureEnabled(\'s3-deep-archive\') && isRestoreStorageClass() && !isDownloadable()" class="sidepanel-header-button sidepanel-header-button-restore" ng-click=moreDropdownItemInitiateRestore.action() text="{{ \'objects.button.restore\' | translate }}"></awsui-button> <awsui-button class=sidepanel-header-button ng-click="$event.stopPropagation(); copySelectedObjectPath(getSelectedObjects()[0].Key)" text="{{ \'objects.button.copypath\' | translate }}"></awsui-button> <awsui-button ng-if=s3SelectEnabled class="sidepanel-s3select-button sidepanel-header-button" ng-click="$event.stopPropagation(); moveToObjectTab(objectTabs.SELECT);" text="{{\'objects.select.title\' | translate}}"></awsui-button> <span class=copy-message ng-class="{ \'fade-in\' : copyFinished.flag, \'fade-out\' : !copyFinished.flag}" translate=copytoclipboard.path></span> </header> <content> <div ng-if=!showVersions class=sidepanel-version-section> <div class=version-label-container ng-click=listVersions($event)> <span class=version-label> {{ objectSelectedForSidePanel.obj.versionLabel }}</span> <div class=versions-dropdown-caret></div> </div> <versions-dropdown bucket=bucketForVersionsDropdown.name error=objectSelectedForSidePanel.error get-metadata="getMetadata(operation, versionId)" set-up-metadata=setUpObjectMetadataForPropertiesPanel(obj) update-obj-metadata=updateObjMetadata(obj) update-obj-acl=updateObjAcl(obj) on-switch-version=toggleS3SelectEnabledForObject(obj) key=versionDropdownKey.name obj=objectSelectedForSidePanel.obj versions=objectSelectedForSidePanel.versions show-versions-dropdown=showVersionsDropdown objects-page=objectsPage.show refresh=refreshAndClearObjectsCacheForCurrentBucket() object-properties-panel=objectPropertiesPanel versions-dropdown-selected-object=versionsDropdownSelectedObject.obj> </versions-dropdown> <div ng-if=!$last class=sidepanel-version-section-divider></div> </div> <div ng-if=!showVersions class=version-placeholder></div> <div class=object-panel-configcontent ng-class="{\'versionview\': showVersions}"> <div class=objects-panel-config-lists ng-repeat="(configTitle, configContent) in objectPropertiesConfig" ng-click=moveToObjectTab(configTitle)> <table ng-if="configTitle !== \'permissions\'"> <tr class=objects-config-panel-content ng-repeat="(configKey, configValue) in configContent" ng-class="{\'latestversion\': objectSelectedForSidePanel.obj.IsLatest === \'true\' || !showVersions, \'config-panel-content-readonly\': isPropertyReadOnly(configKey)}"> <td class=subtitle>{{ getPropertyTitleConditionally($first, \'objects.details.\', configTitle) }}</td> <td class=config-panel-content-left translate=objects.details.{{configKey}} ng-click="takeActionFromSidePanel(configTitle, configKey, $event)"></td> <td ng-if="configKey !== \'Link\' && configKey !== \'RestoreTier\'" class=config-panel-content-right data-e2e-id=sidepanel-{{configKey}}-value>{{configValue}}</td> <td ng-if="configKey === \'RestoreTier\'" class=config-panel-content-right><span data-e2e-id=sidepanel-{{configKey}}-value>{{configValue.value}}</span> <a data-e2e-id=sidepanel-restore-tier-upgrade-link ng-if=configValue.canUpgrade ng-click=restoreFromGlacier() translate=objects.details.RestoreTierUpgrade></a></td> <td ng-if="configKey === \'Link\'" class="config-panel-content-right link"><a href={{configValue}}>{{configValue}}</a></td> </tr> </table> <table ng-if="configTitle === \'permissions\'"> <tr class=objects-config-panel-content> <td class=subtitle><span translate=objects.details.permissions></span></td> <td class=config-panel-content-left translate=objects.details.owner></td> <td class=config-panel-content-right>{{ configContent.owner }}</td> </tr> </table> <table class=object-side-panel-permissions-table ng-repeat="(permissionHeader, properties) in configContent.grantees"> <tr class=objects-config-panel-content> <td></td> <td class="config-panel-content-left config-panel-content-subheading"><span translate=objects.details.{{permissionHeader}}></span></td> <td class=config-panel-content-right></td> </tr> <tr class=objects-config-panel-content ng-repeat="(permissionKey, permissionValue) in properties"> <td class=subtitle></td> <td class=config-panel-content-left><span translate=objects.details.{{permissionKey}}></span></td> <td class=config-panel-content-right>{{ permissionValue }} {{ \'objects.details.grantees\' | translate }}</td> </tr> </table> <div ng-if=!$last class=bucket-config-panel-divider></div> </div> </div> <awsui-alert class=version-dropdown-error ng-if="objectSelectedForSidePanel.error !== \'\'" type=error> {{ objectSelectedForSidePanel.error }} </awsui-alert> </content> </storage-console-config-panel> </div> <upload-modal modal-open=isUploadModalDisplayed current-path=currentPath fetch-objects=fetchObjects operation=operations.dragAndDropOperation selected=selected flags=flags filedrop></upload-modal> <initiate-restore-modal ng-if=initiateRestoreObj.isDisplayed.flag is-open=initiateRestoreObj.isDisplayed selected-restore-objects=selectedRestoreObjects object-headers=initiateRestoreObj.headers> </initiate-restore-modal> <confirmation-dialog-modal ng-if="operation && isConfirmationModalOpen.dialogOpen.flag" is-open=isConfirmationModalOpen count-info=countInfo operation=operation object-metadata=objectMetadata> </confirmation-dialog-modal> <dialog-modal class="change-storage-class-modal large-modal" is-open=changeStorageClassModalObj.isOpen close-callback=closeConfirmationModal header-title="\'storageclass.modal.title\'| translate"> <dialog-modal-header> <p translate=mutiselectpanel.files translate-values="{totalObjs: {{countInfo.objects}} }"></p> </dialog-modal-header> <dialog-modal-content> <storage-class-table storageclassvalue=panelSettingValues.setting on-select-storage-class=onSelectStorageClass class=storage-class-container--dark theme=dark></storage-class-table> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=csc-modal-cancel text="{{ \'button.cancel\' | translate }}" variant=normal click=closeCSCModal()></awsui-button> <awsui-button id=csc-modal-save text="{{ \'button.save\' | translate }}" variant=primary click=saveStorageClass($event) data-disabled=!panelSettingValues.setting loading=isConfirming class="awsui-util-f-r primary-button"></awsui-button> </dialog-modal-footer> </dialog-modal> <storage-console-config-panel class=multiselect-config-panel ng-class="{\'side-config-panel objects-side-panel\': isConfirmationModalOpen.sidePanelOpen,\n                                  \'hide-config-panel objects-side-panel\': !isConfirmationModalOpen.sidePanelOpen}" panel-open=isConfirmationModalOpen.sidePanelOpen is-side-panel=true ng-mouseenter=hoverConfirmationPanel(true) ng-mouseleave=hoverConfirmationPanel(false)> <header> <span class="side-panel-header multi-selected-configpanel-header">{{modalInfo.headTitle}}</span> <span class=panel-close-icon ng-click=cancelConfirmationPanel($event)></span> <p translate=mutiselectpanel.files translate-values="{totalObjs: {{countInfo.objects}} }"></p> </header> <content> <div ng-if="panelSettingValues.docLink !== undefined" style=margin-top:10px> <span class=sidepanel-radio-description style=color:#fff translate=uploadmodal.properties.storage.description></span> <br/> <awsui-button target=_blank href={{panelSettingValues.docLink}} variant=link icon=external-link> <span translate>learn.more</span> </awsui-button> </div> <div class=initialrestore-panel ng-if="opName === moreDropdownItemInitiateRestore.opName"> <table> <tr> <td class=initialrestore-toptext translate=confirmationsidepanel.initiaterestore.toptext></td> </tr> <tr> <td> <form class=initial-restore-panel-value name=initialRestorePanel autocomplete=off> <awsui-control-group validation-message="{{  (initialRestorePanel.initialRestoreValue.$error.required ? \'initialrestorevalue.emptywarning \' : panelSettingValues.inputErrorMsg) | translate }}"> <awsui-textfield name=initialRestoreValue ng-model=panelSettingValues.setting ng-change=validateInitialRestoreValue(panelSettingValues) required></awsui-textfield> </awsui-control-group> </form> </td> </tr> <tr> <td class=initialrestore-bottomtext translate=confirmationsidepanel.initiaterestore.bottomtext></td> </tr> </table> </div> <div class=sidepanel-change-metadata ng-if="opName === moreDropdownItemChangeMetadata.opName"> <table class=sidepanel-metadata-table> <thead> <tr> <td translate=objectproperties.tags.key class=sidepanel-metadata-key-header></td> <td translate=objectproperties.tags.value class=sidepanel-metadata-value-header></td> </tr> </thead> <tbody> <tr ng-repeat="metadata in panelSettingValues.values"> <td class=sidepanel-metadata-key> <awsui-control-group validation-message="{{ metadata.metadataKey.error }}"> <dropdown items=predefinedMetadata selected-item=metadata.metadataKey filter=true placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown> </awsui-control-group> </td> <td class=sidepanel-metadata-value> <awsui-control-group validation-message="{{ metadata.metadataValue.error || metadata.metadataValue.inputError }}"> <dropdown ng-if="metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length > 2" items=metadata.metadataKey.dropDownValue selected-item=metadata.metadataValue enable-input=true filter=true input-field=metadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"> </dropdown> <dropdown ng-if="metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length <= 2" items=metadata.metadataKey.dropDownValue selected-item=metadata.metadataValue enable-input=true input-field=metadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"> </dropdown> <awsui-textfield ng-if="metadata.metadataKey && !metadata.metadataKey.dropDownValue" ng-model=metadata.metadataValue.text ng-change=clearMetadataErrorMsg(metadata.metadataValue)></awsui-textfield> </awsui-control-group> </td> <td class=sidepanel-metadata-delete><a href class=remove-metadata ng-click=removeMetadata($index)>X</a></td> </tr> </tbody> </table> <awsui-button ng-click=addMetadata($event) icon=plus class=sidepanel-addmetadata-button text="{{\'objectproperties.metadata.addnew\' | translate}}"></awsui-button> <awsui-alert class=error-error type=error header="{{ \'error.header\' | translate }}" ng-if="sidepanelMetadataValidationError && sidepanelMetadataValidationError.text"> <p translate=objectdetail.metadata.multisamekeywarning translate-values="{ errorMsg : \'{{sidepanelMetadataValidationError.text}}\' }"></p> </awsui-alert> </div> <div class=add-object-tags ng-if="opName === moreDropdownItemAddObjectTags.opName"> <table class=tagging-table> <thead> <tr> <td translate=objectproperties.tags.key class=key-header></td> <td translate=objectproperties.tags.value class=value-header></td> </tr> </thead> <tbody> <tr ng-repeat="tag in panelSettingValues.values"> <td> <awsui-textfield class=tag-input ng-model=tag.Key></awsui-textfield> </td> <td> <awsui-textfield class=tag-input ng-model=tag.Value></awsui-textfield> </td> <td><a href class=remove-tag ng-click=removeTag($index)>X</a></td> </tr> </tbody> </table> <awsui-button ng-click=addTag($event) data-disabled="panelSettingValues.values.length >= panelSettingValues.setting.maxKeys || isAnyKeyEmpty()" icon=plus class=object-properties-button text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button> <awsui-alert class=error-alert type=error ng-show=tagError>{{tagErrorMessage}}</awsui-alert> <awsui-alert class=objecttag-replication-warning dismissible=false type=warning fac-id=s3-crr> <p translate=replicationcard.warningmsg></p> </awsui-alert> </div> <div ng-repeat="value in panelSettingValues.values" ng-if=sidePanelRadioGroupVisible(opName)> <div class=awsui-row> <awsui-radio-group class=sidepanel-radio-settings ng-model=panelSettingValues.setting ng-change=updateConfigPanel()> <awsui-radio-button value={{value[0]}} ng-model=panelSettingValues.setting label="{{ value[1] }}"></awsui-radio-button> </awsui-radio-group> <div class=sidepanel-radio-description translate={{value[2]}}></div> <p class=learn-more ng-if="value[3] !== undefined"><a ng-href={{value[3]}} target=_blank translate>learn.more</a></p> </div> </div> <div ng-if="opName === moreDropdownItemChangeEncryption.opName" fac-id=s3-kms class=configure-kms-key> <awsui-control-group validation-message="{{ KMSServiceError }}"> <dropdown ng-if="panelSettingValues.setting === awsKMS" items=kmsKeys placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled=KMSServiceError selected-item=panelSettingValues.kmsOption.kmsId filter=true> </dropdown> </awsui-control-group> <awsui-textfield ng-if="panelSettingValues.setting === awsKMS && panelSettingValues.kmsOption.kmsId.value === customARN" ng-model=panelSettingValues.kmsOption.kmsARN> </awsui-textfield> </div> </content> <footer> <awsui-button id=save-confirmation-panel-btn ng-click=saveConfirmationPanel($event) text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading=isCounting.flag variant=primary></awsui-button> <awsui-button ng-click=cancelConfirmationPanel($event) text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button> </footer> </storage-console-config-panel> <action-dropdown class=context-menu id=context-menu get-selected-objects=getSelectedObjects get-selected-folders=getSelectedFolders is-single-object-only-selected=isSingleObjectOnlySelected tag-filter-length=filters.tagFilters.length text="{{ \'objectactionstrip.actions\' | translate }}" items=more_dropdown bucketname=bucketName show-versions=showVersions show-deleted=showDeleted disable-make-public=disableMakePublic> </action-dropdown> '},function(e,t){e.exports='<div class=card-enabled-icon></div> <awsui-alert ng-repeat="alert in objectPropertiesAlerts" visible=alert.visible type="{{ alert.type }}" header="{{ alert.header }}" dismissible=alert.dismissible>{{ alert.text }}</awsui-alert> <div class=awsui-grid> <div class="awsui-container properties-cards"> <div class="wrapper awsui-row"> <bucket-versioning id=bucket-versioning-card card-open=toggleVersioning versioning=versioning></bucket-versioning> <bucket-logging id=bucket-logging-card card-open=toggleLogging logging=logging></bucket-logging> <bucket-website id=bucket-website-card card-open=toggleWebsite website=website></bucket-website> <cloud-trail id=bucket-data-events event-selectors=eventSelectors card-open=toggleEventSelectors></cloud-trail> <default-encryption id=default-encryption-card existing-bucket=true card-open=toggleDefaultEncryption ng-if=enableDefaultEncryption></default-encryption> </div> <hr class=properties-headers-line-space> <div class=properties-headers> <h1 translate=bucketproperties.title.advancedsettings></h1> </div> <div class="wrapper awsui-row"> <bucket-object-retention-card id=bucket-object-retention-card fac-id=s3-sharpie display-alert="displayAlert(text, header, type)" card-open=toggleObjectRetention></bucket-object-retention-card> <bucket-tagging id=bucket-tagging-card card-open=toggleTagging bucket-tags=bucketTags.tagSet></bucket-tagging> <bucket-replication-v1 id=bucket-crr-card ng-if=displayCRRV1 card-open=toggleCRR versioning-status=versioning.selectedValue></bucket-replication-v1> <bucket-accelerate id=bucket-accelerate-card ng-if=displayAcceleration card-open=toggleAccelerate></bucket-accelerate> <events id=bucket-events-card card-open=toggleEvents></events> <bucket-requester-pays id=bucket-requesterpays-card card-open=toggleRequesterPays></bucket-requester-pays> </div> </div> </div>'},function(e,t){e.exports='<div class=line-chart-container> <div class=metrics-line-chart-heading>{{ heading }}</div> <div id="{{ chartid }}" class=chartgraph></div> </div> '},function(e,t){e.exports='<div class=line-chart-container> <div class=analytics-line-chart-heading>{{ heading }}</div> <div id="{{ chartid }}" class=chartgraph></div> </div> '},function(e,t,n){function r(e){return n(i(e))}function i(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./de.js":128,"./en.js":129,"./es.js":130,"./fr.js":131,"./it.js":132,"./ja.js":133,"./ko.js":134,"./pt_br.js":135,"./zh_cn.js":136,"./zh_tw.js":137};r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=474},,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return n(i(e))}function i(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./de.js":128,"./en.js":129,"./es.js":130,"./fr.js":131,"./it.js":132,"./ja.js":133,"./ko.js":134,"./pt_br.js":135,"./zh_cn.js":136,"./zh_tw.js":137};r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=495},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("fileread",function(){return{restrict:"A",link:function(e,t,n){t.bind("change",function(t){e.filesSelected(t.target),this.value=""})}}})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t,n){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){function i(i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C,_,w,T,R,O,k,I,P){function N(){var e=i("orderBy")(s.bucketList,s.sortColumnName,s.reverseSortOrder),n=t.filter(e,function(e){return!e.disabled});s.tableSelection.updateAvailableItems(n)}function M(e){return e?l.instant("lockdown.access.labels."+e):l.instant(p.LABELS.ERROR)}function L(){s.accessTypeFilters.forEach(function(e){return e.count=0})}function x(e){var n=t.find(s.accessTypeFilters,{value:e});n&&n.count++}function D(){s.accessTypeFilters.forEach(function(e){e.count=0}),s.bucketList&&s.bucketList.forEach(function(e){e.publicAccessType?(x(e.publicAccessType),x(w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_ALL)):null===e.publicAccessType&&(x(w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_UNKNOWN),x(w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_ALL))})}function j(){s.numRegions=t.without(t.uniq(t.pluck(s.bucketList,"Location")),void 0).length,s.numPublic=t.filter(s.bucketList,{isPublic:!0}).length}function B(e,t,n,r){t&&e!==t||e?(T.log(n,0,r),s.bucketPanelInfoError=e):T.log(n,1,r)}function F(t,n,r){e.forEach(t,function(e){var t=o(e.scopeBinding);(!e.facId||e.facId&&A.isFeatureEnabled(e.facId))&&e.servicesCall(n,r).then(function(n){T.log(e.name,1,r),e.hasOwnProperty("granteeCount")?n=Object.keys(n).length:e.hasOwnProperty("settingsCheck")&&(n=e.settingsCheck(n)),n&&"Suspended"!==n?e.isNumber?t.assign(s,n+" "+e.resultDisplay):e.resultDisplay?t.assign(s,e.resultDisplay):t.assign(s,n):t.assign(s,e.defaultValue)}).catch(function(n){t.assign(s,e.defaultValue),B(n,e.nomessage,e.name,r)})})}function U(e,t){m.getBucketProperty(t,e,"website").then(function(e){var n=e.response;T.log("getBucketWebsite",1,t);var r=n.WebsiteConfiguration;r.RedirectAllRequestsTo?s.configData.properties.staticWebHost=l.instant("bucketproperty.websitehosting.redirectAll"):r.IndexDocument&&(s.configData.properties.staticWebHost=l.instant("bucketproperty.websitehosting.enableHosting"))}).catch(function(e){s.configData.properties.staticWebHost=l.instant("bucketproperty.disabled"),B(e,J,"getBucketWebsite",t)}),v.getVersioningAndMFAStatus(e).then(function(e){T.log("getVersioningAndMFAStatus",1,t),s.configData.properties.versioning=e.Status?l.instant("bucketproperty."+e.Status.toLowerCase()):l.instant("bucketproperty.disabled"),s.configData.properties.mfaDelete=e.MfaDelete?l.instant("bucketproperty."+e.MfaDelete.toLowerCase()):l.instant("bucketproperty.disabled")}).catch(function(){T.log("getVersioningAndMFAStatus",0,t),s.configData.properties.versioning="-",s.configData.properties.mfaDelete="-"})}function K(){s.tableSelection.resetSelection()}var V=new y("InitialLAMBcall","StartLAMBcall");s.unfilteredBucketList=null,s.bucketsLeftToAnalyze=0,s.regionFromUrl=a.search().region;var G=l.instant("accesssearch.publicread"),Y=l.instant("accesssearch.publicwrite");s.dateFormat=w.DATE_FORMAT;var W=A.isFeatureEnabled(w.FAC.PUBLIC_ACCESS_BLOCK);s.tableSelection=I.get(W,function(){s.hasSingleSelectedBucket()?s.openConfigPanel(s.getSelectedBuckets()[0]):s.closePanel()});var z=void 0;s.getDisabledRegionsPromise=function(){return z=z||P.getDisabledRegions().then(function(e){return e.forEach(function(e){var t=s.regions.find(function(t){return t.value===e});t&&(t.disabled=!0,t.comment=l.instant("disabled.region"))}),e})},s.hasSelectedBuckets=function(){return s.getSelectedBuckets().length>0},s.hasSingleSelectedBucket=function(){return 1===s.getSelectedBuckets().length},s.getSelectedBuckets=function(){return s.tableSelection.getSelectedItems()},s.isDisabledRegion=function(e){var n=t.find(s.regions,function(t){return t.value===e});return t.get(n,"disabled",!1)},s.clickBucketRow=function(e,t){s.isDisabledRegion(t.Region)||(e.ctrlKey||e.metaKey?s.tableSelection.toggleItem(t):e.shiftKey?s.tableSelection.shiftSelect(t):s.tableSelection.selectOneItem(t))},s.clickCheckBox=function(e,t){e&&(e.stopPropagation(),e.shiftKey&&(e.preventDefault(),s.tableSelection.shiftSelect(t)))},s.loadBuckets=function(n){var r=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=arguments.length<=2||void 0===arguments[2]||arguments[2];s.numPublic=0,T.log("LoadBucketsReceived",1,n),h.Clog.setPageId(w.CLOG_PAGE_ID),L(),m.listAllMyBuckets(n,i).then(function(r){s.bucketList=r.response.ListAllMyBucketsResult.Buckets.Bucket,s.unfilteredBucketList=s.bucketList,N(),O.customerReady("Lamb"),T.log(w.OPERATION_NAME.LOAD_BUCKETS,1,n);var i=s.bucketList.map(function(n){return v.getBucketLocation(n.Name).then(function(e){j(),s.regions.forEach(function(r){r.value===e&&(n.Location=r.text,n.Region=r.value,t.contains(w.OPT_IN_REGION_LIST,n.Region)?s.getDisabledRegionsPromise().then(function(e){n.disabled=t.contains(e,n.Region),n.disabled||A.isFeatureEnabled(w.FAC.BULK_ANALYZE_ACCESS)||s.analyzeAccess(n)}):A.isFeatureEnabled(w.FAC.BULK_ANALYZE_ACCESS)||s.analyzeAccess(n))})},e.noop)});A.isFeatureEnabled(w.FAC.BULK_ANALYZE_ACCESS)&&u.all(i).finally(function(){return s.bulkAnalyzeAccess(s.bucketList)})}).catch(function(e){var t=R.handleErrors(e);O.customerReady("Lamb"),T.log(w.OPERATION_NAME.LOAD_BUCKETS,0,n,{errorMessage:t}),s.error=t}).finally(function(){s.isRefreshing=!1,r&&(s.isLoadingPage=!1),s.filterBucketList()})},s.isReloadDisabled=function(){return!!A.isFeatureEnabled(w.FAC.ACCESS)&&0!==s.bucketsLeftToAnalyze},s.analyzeAccess=function(e){var t=A.isFeatureEnabled(w.FAC.PUBLIC_ACCESS_BLOCK);if(!A.isFeatureEnabled(w.FAC.ACCESS+"-"+e.Region)&&!t)return void(e.Access=l.instant(p.LABELS.NOT_SUPPORTED));var n=new y(w.OPERATION_NAME.ANALYZE_ACCESS);return s.bucketsLeftToAnalyze++,v.analyzeAccess(e.Name,n).then(function(n){if(t)e.publicAccessType=n.access_type,e.publicAccessLabel=M(e.publicAccessType);else{var r=g.getAccessStatus(n),i=g.getAccessLabels(n,r);e.Access=i.bucketPublic,e.Read=i.bucketReadPublic,e.Write=i.bucketWritePublic,e.Source=i.source,e.isPublic=r.bucketPublic,e.isReadPublic=r.bucketReadPublic,e.isWritePublic=r.bucketWritePublic}}).catch(function(n){t?(e.publicAccessType=null,e.publicAccessLabel=l.instant(p.LABELS.ERROR)):e.Access=n.errorMessageLocalized||l.instant(p.LABELS.ERROR)}).finally(function(){s.bucketsLeftToAnalyze--,t&&D(),s.filterBucketList()})},s.bulkAnalyzeAccess=function(t){var n=u.resolve([]);t.some(function(e){return w.OPT_IN_REGION_LIST.includes(e.Region)})&&(n=s.getDisabledRegionsPromise()),n.then(function(n){var r=t.filter(function(e){return e.Region&&!n.includes(e.Region)});return s.bucketsLeftToAnalyze=r.length,u.when(f.analyzeAccess(r),e.noop,e.noop,function(e){var t=e.bucket,n=e.AccessType;t.publicAccessType=n,t.publicAccessLabel=M(t.publicAccessType),s.bucketsLeftToAnalyze--,D(),s.filterBucketList()}).then(function(){D(),s.filterBucketList()})})},s.showPublic=function(){-1===s.filters.accessFilters.indexOf(G)&&s.filters.accessFilters.push(G),-1===s.filters.accessFilters.indexOf(Y)&&s.filters.accessFilters.push(Y)},s.$watchCollection("filters.accessFilters",function(e,t){e!==t&&s.filterBucketList()}),s.filterBucketList=function(){s.bucketList=i("filter")(s.unfilteredBucketList,s.filters.input);var e=s.filters.accessFilters;e&&0!==e.length&&(2===e.length?s.bucketList=t.filter(s.bucketList,function(e){return e.isReadPublic||e.isWritePublic}):e.indexOf(G)>-1?s.bucketList=t.filter(s.bucketList,{isReadPublic:!0}):e.indexOf(Y)>-1&&(s.bucketList=t.filter(s.bucketList,{isWritePublic:!0})));var n=s.filters.accessType;if(n&&n.value!==w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_ALL){var r=n.value===w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_UNKNOWN?null:n.value;s.bucketList=t.filter(s.bucketList,{publicAccessType:r})}s.tableSelection.checkIfAllKeysAreSelected(),N(),j()},s.$watch("filters.accessType",function(){return s.filterBucketList()}),s.$watch("filters.input",function(){return s.filterBucketList()}),s.filters={},function(){s.accessTypeFilters=[w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_ALL].concat(r(w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPES),[w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_UNKNOWN]).map(function(e){return{value:e,text:M(e),count:0}}),s.filters.accessType=s.accessTypeFilters[0]}(),T.setEndpoint(),s.docLink=b.getMarketingUrl(w.LEARN_MORE_LINKS.LAMB.MAIN),s.accessDocLink=b.getDocUrl(w.LEARN_MORE_LINKS.LAMB.ACCESS),s.currentRegion=C.getCurrentRegion(),s.isConfirmationModalOpen={flag:!1},s.bucketConfirmationDetails={headerTitle:"",warningMessage:"",operation:"",isDelete:!1},s.isLoadingPage=!0,s.loadBuckets(V,!0),s.isRefreshing=!1,s.panelHide=!0,s.selectBucket=function(e,t){a.path(""+w.DELIMITER+w.PATH_SEGMENTS.BUCKETS+w.DELIMITER+e+w.DELIMITER).search("tab",t)},s.configData={properties:{eventsCount:null,versioning:null,mfaDelete:null,logging:null,staticWebHost:null,tags:null,requesterpays:null},permissions:{owner:null,blockPublicAccess:null,bucketPolicy:null,accessControlList:null,corsConfiguration:null},management:{lifecycle:null}},A.isFeatureEnabled(w.FAC.OBJECT_RETENTION)&&(s.configData.properties.objectRetention=null),R.CRRFACHandle().v1&&(s.configData.properties.replication=null),R.CRRFACHandle().v2&&(s.configData.management.replication=null),A.isFeatureEnabled(w.FAC.ACCELERATE)&&(s.configData.properties.accelerate=null),A.isFeatureEnabled(w.FAC.ANALYTICS)&&(s.configData.management.analytics=null),A.isFeatureEnabled(w.FAC.INVENTORY)&&(s.configData.management.inventory=null),A.isFeatureEnabled(w.FAC.METRICS)&&(s.configData.management.metrics=null),A.isFeatureEnabled(w.FAC.PUBLIC_ACCESS_BLOCK)||delete s.configData.permissions.blockPublicAccess,s.regions=[],R.getFACRegions(C.regionMapping,s.regions),s.configPanelBucket=null,s.openConfigPanel=function(e){s.panelHide=!1,s.configPanelBucket=e,s.panelOpen=!0,s.getConfigData(e.Name)},s.notificationShow=!0,s.closeNotification=function(){s.notificationShow=!1};var $=l.instant("bucketlambda.replicationconfig.notexist"),H=l.instant("bucketlambda.corsconfig.notexist"),q=l.instant("bucketlambda.tag.notexist"),J=l.instant("bucketlambda.website.notexist");s.bucket_more_dropdown=[{items:[{id:"pasteinto",text:l.instant("moreDropDown.pasteinto")}]},{items:[{id:"managecloudtraillog",text:l.instant("moreDropDown.managecloudtraillog")}]}];var X=[{servicesCall:v.getEventCount,scopeBinding:"configData.properties.eventsCount",resultDisplay:l.instant("bucketsidepanel.activenotification"),defaultValue:"0 ".concat(l.instant("bucketsidepanel.activenotification")),name:"getEventCount",isNumber:!0},{servicesCall:v.isLoggingEnabled,scopeBinding:"configData.properties.logging",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isLoggingEnabled"},{servicesCall:v.getTagCount,scopeBinding:"configData.properties.tags",resultDisplay:" ".concat(l.instant("bucketsidepanel.tags")),defaultValue:"0 ".concat(l.instant("bucketsidepanel.tags")),name:"getTagCount",isNumber:!0,nomessage:q},{servicesCall:v.isReplicationEnabled,scopeBinding:R.CRRFACHandle().v2?"configData.management.replication":"configData.properties.replication",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isReplicationEnabled",nomessage:$,facId:w.FAC.CRR},{servicesCall:v.getBucketAccelerate,scopeBinding:"configData.properties.accelerate",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"getBucketAccelerate",nomessage:l.instant("bucketproperty.disabled"),facId:w.FAC.ACCELERATE},{servicesCall:v.getBucketOwnerDisplayName,scopeBinding:"configData.permissions.owner",resultDisplay:"",defaultValue:l.instant("bucketproperty.no"),name:"getBucketOwnerDisplayName"},{servicesCall:v.isCORSEnabled,scopeBinding:"configData.permissions.corsConfiguration",resultDisplay:l.instant("bucketproperty.yes"),defaultValue:l.instant("bucketproperty.no"),name:"isCORSEnabled",nomessage:H},{servicesCall:v.getBucketGrantees,scopeBinding:"configData.permissions.accessControlList",resultDisplay:" ".concat(l.instant("bucketsidepanel.grantees")),defaultValue:"0 ".concat(l.instant("bucketsidepanel.grantees")),granteeCount:!0,name:"getBucketGrantees",isNumber:!0},{servicesCall:v.getBucketPolicy,scopeBinding:"configData.permissions.bucketPolicy",resultDisplay:l.instant("bucketproperty.yes"),defaultValue:l.instant("bucketproperty.no"),name:"getBucketPolicy"},{servicesCall:v.isLifecycleEnabled,scopeBinding:"configData.management.lifecycle",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isLifecycleEnabled"},{servicesCall:v.isAnalyticsEnabled,scopeBinding:"configData.management.analytics",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isAnalyticsEnabled",facId:w.FAC.ANALYTICS},{servicesCall:v.isMetricsEnabled,scopeBinding:"configData.management.metrics",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isMetricsEnabled",facId:w.FAC.METRICS},{servicesCall:v.isInventoryEnabled,scopeBinding:"configData.management.inventory",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isInventoryEnabled",facId:w.FAC.INVENTORY},{servicesCall:v.isRequesterPaysEnabled,scopeBinding:"configData.properties.requesterpays",resultDisplay:l.instant("bucketproperty.enabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isRequesterPaysEnabled"},{servicesCall:k.getBucketSettings,scopeBinding:"configData.permissions.blockPublicAccess",defaultValue:l.instant("bucketproperty.disabled"),settingsCheck:function(e){return l.instant(e.blockPublicAcls||e.ignorePublicAcls||e.blockPublicPolicy||e.restrictPublicBuckets?"bucketproperty.enabled":"bucketproperty.disabled")},name:"getBucketPABSettings",facId:w.FAC.PUBLIC_ACCESS_BLOCK}];A.isFeatureEnabled(w.FAC.OBJECT_RETENTION)&&X.push({servicesCall:v.isObjectRetentionEnabled,scopeBinding:"configData.properties.objectRetention",resultDisplay:l.instant("bucketproperty.pemanentlyenabled"),defaultValue:l.instant("bucketproperty.disabled"),name:"isObjectRetentionEnabled"});var Z=null;if(s.hoverSidePanelAction=function(e){Z||(Z=n(".storage-console-config-panel")),R.bodyFreezeScroll(e,Z)},s.getConfigData=function(e){var t=new y("BucketProperties","getBucketConfigProperties");F(X,e,t),U(e,t)},s.closePanel=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];s.panelHide=!0,s.configPanelBucket=null,e&&s.hoverSidePanelAction(!1)},s.copyARNToClipboard=function(e){if(e.stopPropagation(),s.configPanelBucket){var t=R.getBucketARN(s.configPanelBucket.Name);R.copyToClipboard(t)}},s.isCreateBucketModalOpen={flag:!1},s.showCreateBucketModal=function(){s.getDisabledRegionsPromise();var e=new y("CreateBucket","populateBucketSelectorDropdown");m.listAllMyBuckets(e).then(function(t){var n=t.response;T.log("listBucketsComplete",1,e),s.bucketList=n.ListAllMyBucketsResult.Buckets.Bucket,s.filterBucketList(),s.bucketList.forEach(function(e){v.getBucketLocation(e.Name).then(function(t){C.regionMapping.forEach(function(n){n.value===t&&(e.Location=n.text,e.Region=n.value)})})})}),s.isCreateBucketModalOpen.flag=!0,R.analyticsTrackClick(w.ANALYTICS.CREATE_BUCKET_MODAL,w.ANALYTICS.DETAILS),R.analyticsTrackClick(w.ANALYTICS.START_CREATE_BUCKET,w.ANALYTICS.CREATE_BUCKET_S3),R.analyticsTrackView(w.ANALYTICS.NAME_REGION_CREATE_BUCKET,w.ANALYTICS.CREATE_BUCKET_S3),R.bodyFreezeScroll(s.isCreateBucketModalOpen.flag)},s.moveToBucketTab=function(e){s.hoverSidePanelAction(!1),c.scrollTo(0,0),a.path("/"+w.PATH_SEGMENTS.BUCKETS+"/"+s.configPanelBucket.Name).search("tab",e)},s.reloadBuckets=function(){s.isRefreshing=!0;var e=new y("RefreshLAMB","RefreshLAMB");s.loadBuckets(e,!1,!1)},s.validateBucketDeletion=function(){var e=s.getSelectedBuckets()[0].Name,t={bucket:e},n={},r=new y(w.OPERATION_NAME.VALIDATE_BUCKET_DELETION);return r.changeInitialBucketForOperation(e),m.getBucketLocation(r,e,n).then(function(){return t.region=n.region,r.bucketRegion=n.region,_.makeS3ConsoleOperationRequest(t,w.CWS_OPERATION_NAME.VALIDATE_BUCKET_DELETION,{},r)}).then(function(e){return T.log(w.CWS_OPERATION_NAME.VALIDATE_BUCKET_DELETION,1,r),e.data}).catch(function(){return T.log(w.CWS_OPERATION_NAME.VALIDATE_BUCKET_DELETION,0,r),{}})},s.deleteBucket=function(){s.validateBucketDeletion().then(function(e){var n=s.getSelectedBuckets()[0].Name,r=E.createBulkOperation(w.OPERATION_NAME.DELETE_BUCKET,[],[{Prefix:""}],1e3,{});r.changeInitialBucketForOperation(n),r.defer.promise.then(function(){t.remove(s.bucketList,function(e){return e.Name===r.initialBucket}),s.reloadBuckets(),S.evictAllBucketData(r.initialBucket),K()}),s.bucketConfirmationDetails.headerTitle=l.instant("confirmationmodal.deletebucket.title"),s.bucketConfirmationDetails.warningMessage=l.instant("confirmationmodal.deletebucketwarning",{bucketName:n}),s.bucketConfirmationDetails.reviewConsiderations=void 0===e.isBucketEmpty||void 0===e.hasWebsiteEnabled||void 0===e.hasElbAccess;var i=[];!1===e.isBucketEmpty&&(i.push(l.instant("confirmationmodal.deletebucket.notemptybucket")),i.push(l.instant("confirmationmodal.deletebucket.longoperationwarning"))),e.hasWebsiteEnabled&&i.push(l.instant("confirmationmodal.deletebucket.websiteenabled")),e.hasElbAccess&&i.push(l.instant("confirmationmodal.deletebucket.elbaccess")),s.bucketConfirmationDetails.operation=r,s.bucketConfirmationDetails.isDelete=!0,s.bucketConfirmationDetails.validationMessages=i,s.isConfirmationModalOpen.flag=!0})},s.emptyBucket=function(){var e=s.getSelectedBuckets()[0].Name,t=l.instant("confirmationmodal.emptybucketwarning"),n=E.createBulkOperation(w.OPERATION_NAME.EMPTY_BUCKET,[],[{Prefix:""}],1e3,{});n.changeInitialBucketForOperation(e),n.defer.promise.then(function(){S.evictBucketObjects(e)}),s.bucketConfirmationDetails.headerTitle=l.instant("confirmationmodal.emptybucket.title"),s.bucketConfirmationDetails.warningMessage=t+' "'+e+'" ?',s.bucketConfirmationDetails.operation=n,s.bucketConfirmationDetails.isDelete=!1,s.isConfirmationModalOpen.flag=!0},s.tableFiltering={},s.clearFilter=function(){s.tableFiltering.filterText=""},s.setSortOrder=function(e){s.sortColumnName=e,s.reverseSortOrder=!s.reverseSortOrder,N()},s.isFeatureEnabled=function(e){return A.isFeatureEnabled(e)},s.showEmptyBucketScreen=function(){return A.isFeatureEnabled(w.FAC.ACCESS)?0===t.get(s.bucketList,"length")&&0===t.get(s.filters,"accessFilters.length"):0===t.get(s.bucketList,"length")},s.isAccessFilterDisabled=function(){return!s.filters.accessFilters||0===t.get(s.filters,"accessFilters.length")},a.search().bucket){var Q=a.search().bucket,ee=a.search().prefix;ee&&""!==ee&&"/"!==ee.slice(-1)&&(ee+="/"),delete a.search().bucket,delete a.search().prefix,a.path("/"+w.PATH_SEGMENTS.BUCKETS+"/"+Q+"/"+(ee||"")),a.replace()}""===V.initialBucket&&-1===a.path().indexOf(w.PATH_SEGMENTS.BUCKETS+"/")&&a.path(""+w.DELIMITER+w.PATH_SEGMENTS.HOME),S.resetLocationAndMarkers(),s.editPublicAccessModal={isOpen:{flag:!1},selectedBuckets:{},publicBucketsCount:0},s.editPublicAccess=function(){var e=s.getSelectedBuckets();e.length>0&&(s.editPublicAccessModal.publicBucketsCount=t.filter(e,{publicAccessType:w.BUCKET_PUBLIC_ACCESS_BLOCK.ACCESS_TYPE_PUBLIC}).length,s.editPublicAccessModal.isOpen.flag=!0,s.editPublicAccessModal.selectedBuckets=e)},s.$on("$destroy",function(){s.tableSelection.resetSelection(!1)}),s.emptyBucketTooltip=function(){if(s.getSelectedBuckets().length>1)return l.instant("bucketactionstrip.tooltips.multipleselected.empty")},s.deleteBucketTooltip=function(){if(s.getSelectedBuckets().length>1)return l.instant("bucketactionstrip.tooltips.multipleselected.delete")},s.goToVideo=function(){c.open(w.YOUTUBE_VIDEO_LINK,"_blank").opener=null},s.showVideo=function(){var e=C.getCurrentRegion();return-1===w.FALLBACK_REGION_LIST.CN.indexOf(e)&&-1===w.FALLBACK_REGION_LIST.ISO.indexOf(e)},s.getBucketLocationText=function(e){return e.disabled?e.Location+" - "+l.instant("disabled.region"):e.Location}}e.module("s3").controller("LambController",["$filter","$location","$parse","$scope","$window","$translate","$q","$timeout","AnalyzeAccessConstants","AnalyzeAccessService","AnalyzeAccessUtilService","APIProxyService","AWSC","AwsUrlsService","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","FAC","Region","S3CWSAPIService","S3Constants","SCLogService","UtilService","PerformanceUtilsService","PublicAccessService","TableSelectionService","RegionStatesService",i])}()}).call(t,n(0),n(2),n(6))},function(e,t,n){"use strict";(function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(i,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C,_,w,T,R,O,k,I,P,N,M,L,x,D,j,B,F,U,K,V,G,Y,W,z,$){function H(){var e=[];if(u.currLocation.folders.relativePaths){var n=u.currLocation.folders.relativePaths;n=i("orderBy")(n,u.sortColumnName,u.reverseSortOrder),e=e.concat(n)}if(u.currLocation.objects.relativePaths){var r=u.currLocation.objects.relativePaths;u.showVersions&&(r=t.filter(r,function(e){return e.isVersionRow})),r=i("orderBy")(r,u.sortColumnName,u.reverseSortOrder),e=e.concat(r)}u.tableSelection.updateAvailableItems(e)}function q(){return u.isSingleObjectOnlySelected()}function J(e){for(var t in u.currLocation.objects.relativePaths){var n=u.currLocation.objects.relativePaths[t];if(n.Key===e.Key&&n.selected)return void(u.currLocation.objects.relativePaths[t]=e)}}function X(){if(u.objectPropertiesConfig={},q()){var n=function(){var n=u.getSelectedObjects()[0];if(u.objectSelectedForSidePanel={},u.objectSelectedForSidePanel.obj=e.copy(n),u.objectSelectedForSidePanel.obj.disableDownload=!1,u.objectSelectedForSidePanel.error="",u.versionDropdownKey={},u.versionDropdownKey.name=M.getCurrentAbsoluteFolderPath()?M.getCurrentAbsoluteFolderPath()+n.Key:n.Key,u.objectSelectedForSidePanel.obj.versionLabel=p.instant("versionsdropdown.label.latestVersion"),u.versionsDropdownSelectedObject={obj:t.cloneDeep(n)},u.versionsDropdownSelectedObject.obj.Key=M.relativeToAbsoluteObjectPath(u.versionsDropdownSelectedObject.obj.Key),u.showVersions||function(){var e=new A(x.OPERATION_NAME.LIST_VERSIONS);P.listVersions(u.bucketName,u.versionDropdownKey.name,e).then(function(t){u.objectSelectedForSidePanel.versions=t,u.objectSelectedForSidePanel.versionId=t&&t[0]&&t[0].VersionId,D.log(He,1,e,{objectKey:u.versionDropdownKey.name,versions:t})}).catch(function(t){u.objectSelectedForSidePanel.error=B.handleErrors(t),D.log(He,0,e,t)})}(),t.isEmpty(n.ETag)&&!u.showDeleted&&!u.showVersions){var r=new A(x.OPERATION_NAME.GET_OBJECT_DETAILS),i={bucket:u.bucketName,prefix:n.Path+n.Key,maxKeys:1,cacheAllowed:!0};return m.listObjects(r,i).then(function(e){var t=e.response.ListBucketResult.Contents[0];t.ETag=t.ETag.replace(/[\\"]+/g,""),t.Path=n.Path,t.VersionId=n.VersionId,t.selected=!0,-1!==t.Key.lastIndexOf(x.DELIMITER)&&(t.Key=t.Key.substring(t.Key.lastIndexOf(x.DELIMITER)+1)),J(t),X()}),{v:void 0}}u.setUpObjectMetadataForPropertiesPanel(n),u.updateObjAcl(n),u.updateObjMetadata(n).then(function(){u.isSingleObjectOnlySelected()&&(u.showVersionsDropdown.show=!1,Z(n),u.isConfirmationModalOpen.sidePanelOpen=!1)})}();if("object"===(void 0===n?"undefined":a(n)))return n.v}else u.objectPropertiesPanel.show=!1}function Z(e){u.toggleS3SelectEnabledForObject(e),u.objectPropertiesPanel.show=!0}function Q(){u.isSingleObjectOnlySelected()?u.downloadAsPanel&&u.openDownloadAsPanel():u.downloadAsPanel=!1}function ee(){u.selectedKeys=u.tableSelection.getSelectedItems(),u.selectedFolders=t.filter(u.selectedKeys,function(e){return e.Prefix}),u.selectedObjects=t.filter(u.selectedKeys,function(e){return e.Key}),X(),Q()}function te(){var e=0,t=u.getSelectedKeys();1===t.length&&t[0].Key&&u.currLocation.objects.relativePaths.forEach(function(n){n.Key===t[0].Key?n.beingRenamed=!0:e++})}function ne(e){B.analyticsTrackClick(x.ANALYTICS.CONFIRMATION_MODAL,e)}function re(){if(u.sidepanelMetadataValidationError={text:null},u.opName===x.OPERATION_NAME.ADD_OBJECT_TAG){var e=u.operation.panelSettingValues&&u.operation.panelSettingValues.values;if(e)for(var t=e.length,n=0;n<t;n++)for(var r=e[n].Key,i=0,a=0,o=0;o<t;o++){if(e[o].Key===r&&++i>1)return u.tagError=!0,u.tagErrorMessage=p.instant("objectproperties.tags.duplicatekeynames"),!1;if(""===e[o].Key&&++a>0)return u.tagError=!0,u.tagErrorMessage=p.instant("objectproperties.tags.emptykeyname"),!1}}if(u.opName===x.OPERATION_NAME.CHANGE_METADATA){var s=u.operation.panelSettingValues&&u.operation.panelSettingValues.values;if(s)return P.isValid(s,u.sidepanelMetadataValidationError)}return!0}function ie(e,t){if(e===x.OPERATION_NAME.PASTE)u.operation=C.getClipboardOperation();else{var n=0;e===x.OPERATION_NAME.RENAME&&(n=1);var r=t?null:Ze[e];u.operation=S.createBulkOperation(e,u.getSelectedObjects(),u.getSelectedFolders(),n,r)}u.operation.defer.promise.then(function(){ae(u.operation)},function(){},function(){ae(u.operation)})}function ae(e){u.switchedFromSidePanel&&ee(),u.showDeleted?(y.evictBucketObjects(e.initialBucket),u.showAllObjects()):e.name===x.OPERATION_NAME.DELETE_OBJECTS||e.name===x.OPERATION_NAME.CHANGE_STORAGE_CLASS||e.name===x.OPERATION_NAME.RESTORE_OBJECTS?(y.evictBucketObjects(e.initialBucket),u.refreshWithSelection()):e.name!==x.OPERATION_NAME.COPY&&e.name!==x.OPERATION_NAME.CUT||(y.evictBucketObjects(e.initialBucket),y.evictBucketObjects(e.dstBucket),u.refreshWithSelection())}function oe(e){return!Boolean(e.ETag)}function se(e,t){var n=[],r=M.relativeToAbsoluteObjectPath(t.Key);return Y.getObjectRetention(e,u.bucketName,{objectKey:r,versionId:t.VersionId}).catch(function(e){return n.push(e),{objectRetentionEnabled:!1}}).then(function(n){return n.objectRetentionEnabled?p.instant("bucketproperty.enabled"):ce(e,t)}).catch(function(e){return n.push(e),le(n)})}function ce(e,t){var n=M.relativeToAbsoluteObjectPath(t.Key);return Y.getObjectLegalHold(e,u.bucketName,{objectKey:n,versionId:t.VersionId}).then(function(e){return e?p.instant("bucketproperty.enabled"):p.instant("bucketproperty.disabled")})}function le(e){return e.map(function(e){return e.code}).includes(x.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.ACCESS_DENIED)?p.instant("resource.access.denied"):c.reject(e[0])}function ue(){u.batchOps.error=null,u.batchOps.numKeysOperatedOn=null}function de(e){switch(e){case x.INITIATE_RESTORE.BULK_RETRIEVAL:return p.instant("objectdetails.value.restoretier.bulk");case x.INITIATE_RESTORE.STANDARD_RETRIEVAL:return p.instant("objectdetails.value.restoretier.standard");case x.INITIATE_RESTORE.EXPEDITED_RETRIEVAL:return p.instant("objectdetails.value.restoretier.expedited");default:return e}}function pe(){var e=new A("GetKMSKeysForObjectSSE");return u.kmsKeys=[],G.getKMSKeysById(e,u.bucketName,x.OBJECT_SSE.CUSTOM_ARN).then(function(e){u.kmsKeys=e}).catch(function(e){throw u.KMSServiceError=e,e})}function fe(){var e=u.operation.selectedKeys&&u.operation.selectedKeys[0],t=e.Key,n=e.VersionId||null,r=u.bucketName;return V.getObjectTags(r,t,n)}function ge(e,t){return e&&e.Grantee?e.Grantee.DisplayName||function(e){return e.URI?e.URI.split("/").pop():e.ID}(e.Grantee):t}function me(e){return"string"!=typeof e?"":e}function he(e,n){u.showEmptyScreen=!1,u.noResultsMessage=void 0;var r=me(e.Prefix);Fe&&-1!==r.indexOf(Fe)&&(r=r.substring(0,r.length-Fe.length));var i=void 0,a=0;if(u.showVersions){var o=F.getAllVersionsForDisplay(e,r);i=o.allVersions,a=o.nonVersionRowCount}else i=M.absoluteToRelativeObjectPaths(e.Contents,r);u.currLocation.objects.relativePaths=n?i:u.currLocation.objects.relativePaths.concat(i),u.showVersions&&e.CommonPrefixes&&(e.CommonPrefixes=B.transformObjectToArray(e.CommonPrefixes));var s=M.absoluteToRelativeFolderPaths(e.CommonPrefixes,r);u.currLocation.folders.relativePaths=n?s:u.currLocation.folders.relativePaths.concat(s),U.customerReady("Objects");var c=0;if(i&&(c+=i.length),s&&(c+=s.length),0===c&&(""===me(e.Prefix)?u.showDeleted?u.noResultsMessage=p.instant("objectlisting.nodeletedobjects"):u.showEmptyScreen=!0:u.noResultsMessage=Fe?p.instant("prefixsearch.noresults"):p.instant("objectlisting.noobjects")),u.showVersions)if(t.isEmpty(u.filters.prefixFilters)){var l=t.isEmpty(u.versionsCurrentIdMarker)?"":u.versionsCurrentIdMarker,d=t.isEmpty(u.versionsCurrentKeyMarker)?"":u.versionsCurrentKeyMarker,f=_e(d,l);u.startKeyNum=0===c?0:u.maxKeys*(f+1)+1,u.endKeyNum=u.maxKeys*(f+1)+c-a}else u.startKeyNum=0===c?0:u.maxKeys*u.versionsKeyMarkers.length+1,u.endKeyNum=u.maxKeys*u.versionsKeyMarkers.length+c-a;else if(t.isEmpty(u.filters.prefixFilters)){var g=t.isEmpty(u.currentMarker)?"":u.currentMarker,f=we(g);u.startKeyNum=0===c?0:u.maxKeys*(f+1)+1,u.endKeyNum=u.maxKeys*(f+1)+c}else u.startKeyNum=0===c?0:u.maxKeys*u.markers.length+1,u.endKeyNum=u.maxKeys*u.markers.length+c;H(),u.isRefreshing=!1,u.fetchPageInProgress=!1}function be(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];u.filters.input="",u.isConfirmationModalOpen.sidePanelOpen=!1,u.resetSelection(),u.isRefreshing=!0,I.listObjects(e,t,u.maxKeys,x.DELIMITER,n).then(function(e){var t=e.response.ListBucketResult;u.currentMarker=t.ContinuationToken,u.nextMarker=t.NextContinuationToken,he(t,!0),Oe()}).catch(function(e){Re(e)})}function ve(e,t,n){var r=arguments.length<=3||void 0===arguments[3]||arguments[3];u.isConfirmationModalOpen.sidePanelOpen=!1,u.resetSelection(),u.isRefreshing=!0,I.listObjectVersions(e,t,n,u.maxKeys,x.DELIMITER,r).then(function(e){var t=e.response.ListVersionsResult;u.versionsCurrentKeyMarker=t.KeyMarker,u.versionsCurrentIdMarker=t.VersionIdMarker,u.versionsNextKeyMarker=t.NextKeyMarker,u.nextVersionIdMarker=t.NextVersionIdMarker,he(t,!0),Oe()}).catch(function(e){Re(e)})}function Ee(e){var t={Contents:e.deletedFiles,CommonPrefixes:e.folders},n={Contents:e.cachedDeletedFiles,CommonPrefixes:e.cachedFolders};he(t,!0),u.startKeyNum=qe.currentPage*u.maxKeys+1,u.endKeyNum=u.startKeyNum+t.Contents.length+t.CommonPrefixes.length-1,y.setPageOfDeletedObjects(t,qe.currentPage),qe.lastCachedPage=qe.currentPage,n.Contents.length+n.CommonPrefixes.length>0&&y.setPageOfDeletedObjects(n,qe.currentPage+1),qe.nextKeyMarker=e.NextKeyMarker,qe.nextVersionIdMarker=e.NextVersionIdMarker,qe.isTruncated=B.convertStringToBoolean(e.IsTruncated)}function Se(e){u.currLocation.folders.relativePaths=[],u.currLocation.objects.relativePaths=[],u.isRefreshing=!0,qe.currentPage=0,qe.lastCachedPage=0,u.startKeyNum=0,u.endKeyNum=0,y.resetDeletedObjects(),k.listDeletedObjects(new A(x.LIST_DELETED_OBJECTS),e).then(function(e){Ee(e)},function(e){Re(e)})}function ye(n){var r=K.convertXmlStringToJson(n.response).TagQueryResult,i=!0;if(r.Contents){var a=[].concat(r.Contents);e.forEach(a,function(e){return i=Ae(e.Key)})}!0===r.IsTruncated&&t.isString(r.NextContinuationToken)?i?u.fetchOnePageTag(r.NextContinuationToken,!1):(u.tagContinuationTokens.push(r.NextContinuationToken),u.isRefreshing=!1,u.showAllObjects()):(0===u.currLocation.objects.relativePaths.length&&(u.noResultsMessage=p.instant("tagsearch.noresults")),u.isRefreshing=!1,u.showAllObjects()),u.fetchPageInProgress=!1}function Ae(e,t){var n=e.split("/"),r=n[n.length-1],i={ETag:"",Key:r,LastModified:"",Owner:{DisplayName:"",ID:""},Path:n.length>1?e.substring(0,e.lastIndexOf(r)):"",Size:"",StorageClass:"",VersionId:t,beingRenamed:!1};return u.endKeyNum-u.startKeyNum<u.maxKeys-1?(u.currLocation.objects.relativePaths.push(i),0===u.startKeyNum&&(u.startKeyNum=1),u.endKeyNum++,!0):(u.nextTagObjs?u.nextTagObjs.push(i):u.nextTagObjs=[i],!1)}function Ce(){qe.currentPage>qe.lastCachedPage&&(qe.lastCachedPage=qe.currentPage);var e=y.getPageOfDeletedObjects(qe.currentPage);he(e,!0),u.startKeyNum=qe.currentPage*u.maxKeys+1,u.endKeyNum=u.startKeyNum+e.Contents.length+e.CommonPrefixes.length-1}function _e(e,n){var r=y.returnVersionMarkers(),i=M.getFolderNamesList(),a=-1,o=r.length,s=i.length,c=i[s-1];if(o>=s){var l=r[s-1][c];if(!t.isEmpty(l))for(var u=0;u<l.length;u++)if(l[u].marker===e&&l[u].id===n){a=u;break}}return a}function we(e){var n=y.returnMarkers(),r=M.getFolderNamesList(),i=-1,a=n.length,o=r.length,s=r[o-1];if(a>=o){var c=n[o-1][s];t.isEmpty(c)||(i=c.indexOf(e))}return i}function Te(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];I.listObjects(e,t,u.maxKeys,x.DELIMITER,n).then(function(e){var t=e.response.ListBucketResult;he(t),t.IsTruncated&&B.convertStringToBoolean(t.IsTruncated)?Te(t.NextContinuationToken):Oe()}).catch(function(e){Re(e)})}function Re(e){u.currLocation.objects.error=B.handleErrors(e),U.customerReady("Objects"),u.currLocation.loading=!1,u.isRefreshing=!1}function Oe(){u.timing.fetchAllObjects.duration=(new Date).getTime()-u.timing.fetchAllObjects.start,u.currLocation.loading=!1,u.currLocation.objects.error=!1,u.isRefreshing=!1,u.fetchPageInProgress=!1}var ke,Ie,Pe,Ne=new A("assetLoaded");if(window.perfTiming)for(var Me in window.perfTiming)D.log("asset"+Me,window.perfTiming[Me],Ne);var Le={label:p.instant("details.tab.management"),id:"management"};u.currLocation={objects:{relativePaths:[],error:null},folders:{relativePaths:[]}},u.tabs=[{label:p.instant("details.tab.overview"),id:x.TABS.OBJECT_LIST.OVERVIEW},{label:p.instant("details.tab.properties"),id:x.TABS.OBJECT_LIST.PROPERTIES},{label:p.instant("details.tab.permissions"),id:x.TABS.OBJECT_LIST.PERMISSIONS}],u.dateFormat=x.DATE_FORMAT,u.createFolder={displayed:!1},u.displayCRRV1=B.CRRFACHandle().v1;var xe=(ke={},r(ke,x.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:p.instant("confirmationmodal.storageclass.title")}),r(ke,x.OPERATION_NAME.CHANGE_SSE,{headTitle:p.instant("confirmationmodal.sse.title")}),r(ke,x.OPERATION_NAME.CHANGE_METADATA,{headTitle:p.instant("confirmationmodal.metadata.title")}),r(ke,x.OPERATION_NAME.INITIATE_RESTORE,{headTitle:p.instant("initiaterestoremodal.header.title.glacier")}),r(ke,x.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:p.instant("confirmationmodal.addtags.title")}),ke),De=(Ie={},r(Ie,x.OPERATION_NAME.CHANGE_STORAGE_CLASS,{values:[[x.STORAGE_CLASSES.STANDARD,p.instant("storageclasses.standard"),"storageclass.standarddescription"],[x.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,p.instant("storageclasses.standardia"),"storageclass.siadescription"]],setting:void 0,docLink:b.getDocUrl(x.LEARN_MORE_LINKS.STORAGE_CLASS)}),r(Ie,x.OPERATION_NAME.CHANGE_SSE,{values:[[x.OBJECT_SSE.NONE,p.instant("sse.none"),""],[x.OBJECT_SSE.AES256,p.instant("sse.aes256"),"sidepanel.sse.aes256description",b.getDocUrl(x.LEARN_MORE_LINKS.AES256_ENCRYPTION)]],setting:void 0}),r(Ie,x.OPERATION_NAME.CHANGE_METADATA,{values:[{metadataKey:null,metadataValue:null}],setting:void 0}),r(Ie,x.OPERATION_NAME.INITIATE_RESTORE,{inputErrorMsg:"",setting:void 0}),r(Ie,x.OPERATION_NAME.ADD_OBJECT_TAG,{values:[{Key:"",Value:""}],setting:{maxKeys:x.TAGGING.MAX_ALLOWED_TAGS}}),Ie);if(R.isFeatureEnabled(x.FAC.ONEZONE_IA)){var je=[x.STORAGE_CLASSES.ONEZONE_IA,p.instant("storageclass.zia"),"storageclass.ziadescription"];De[x.OPERATION_NAME.CHANGE_STORAGE_CLASS].values.push(je)}if(R.isFeatureEnabled(x.FAC.S3_RRS)){var Be=[x.STORAGE_CLASSES.REDUCED_REDUNDANCY,p.instant("storageclasses.rrs"),"storageclass.rrsdescription"];De[x.OPERATION_NAME.CHANGE_STORAGE_CLASS].values.push(Be)}var Fe=o.search().prefixSearch;u.customARN=x.OBJECT_SSE.CUSTOM_ARN,u.awsKMS=x.OBJECT_SSE.KMS_ENCRYPTION;var Ue,Ke=x.OBJECT_SSE.NONE;if(R.isFeatureEnabled(x.FAC.KMS)){var Ve=[x.OBJECT_SSE.KMS_ENCRYPTION,p.instant("sse.aws.kms"),""];De[x.OPERATION_NAME.CHANGE_SSE].values.push(Ve)}if(!R.isFeatureEnabled(x.FAC.NO_ENC)){var Ge=De[x.OPERATION_NAME.CHANGE_SSE].values;Ge=t.reject(Ge,function(e){return e[0]===x.OBJECT_SSE.NONE}),De[x.OPERATION_NAME.CHANGE_SSE].values=Ge,De[x.OPERATION_NAME.CHANGE_SSE].setting=x.OBJECT_SSE.AES256}u.maxKeys=x.LIST_OBJECTS_MAX_KEYS_PER_LISTING,u.toggleVersioning=!1,u.toggleLogging=!1,u.toggleWebsite=!1,u.toggleEvents=!1,u.toggleAccelerate=!1,u.toggleCRR=!1,u.toggleTagging=!1,u.toggleRequesterPays=!1,u.toggleEventSelectors=!1,u.toggleDefaultEncryption=!1,u.objectPropertiesAlerts=[],u.disabledButton=!0,u.versioning={selectedValue:x.BUCKET_PROPERTIES.DISABLE},u.website={selectedValue:x.BUCKET_PROPERTIES.DISABLE,websiteEnabledOption:"",websiteEnabledContent:""},u.logging={selectedValue:x.BUCKET_PROPERTIES.DISABLE},u.eventSelectors={trailNames:[],access:{read:!1,write:!1},targetTrail:"",trailRegionMapping:{}},u.bucketTags={tagSet:{tags:[]}},u.selectedTab=o.search().tab||x.TABS.OBJECT_LIST.OVERVIEW,u.confirmationSelectedFiles={folders:[],objects:[],currFolderPathPrefix:""},u.isUploadModalDisplayed={flag:!1},u.initiateRestoreObj={isDisplayed:{flag:!1},headers:[]},u.changeStorageClassModalObj={isOpen:{flag:!1}},u.flags={uploadDisabled:!1},u.isRefreshing=!1,u.isConfirmationModalOpen={flag:!1,sidePanelOpen:!1,dialogOpen:{flag:!1},isRestorePanel:!1},u.objectPropertiesPanel={show:!1},u.showDeleted=!1,u.copyFinished={flag:!1},u.showVersions=!1,u.predefinedMetadata=P.getPredefinedMetadata(),u.startWithMarker="",u.startWithVersionKeyMarker="",u.startWithVersionIdMarker="",u.objectTabs=x.TABS.OBJECT_LIST,u.tableSelection=W.get(!0,ee),u.iamLink=B.getIamAccountSettingsLink(),u.filters={input:"",prefixFilters:[],tagFilters:[]},h.Clog.setPageId(x.CLOG_OBJECTS_PAGE_ID),u.tagQueryDeferred=c.defer(),u.getIconClass=function(e){return e.selected?"awsui-icon-light "+B.getIconClassFromFilename(e.Key):B.getIconClassFromFilename(e.Key)},u.hoverObjectPropertiesPanel=function(e){B.bodyFreezeScroll(e,!0)},u.displayAlert=function(e,t,n){u.objectPropertiesAlerts.push({visible:!0,header:t,text:e,type:n,dismissible:!0})},u.moveToObjectTab=function(e){u.hoverObjectPropertiesPanel(!1);var n=u.getSelectedObjects()[0],r=n.Path?n.Path+n.Key:n.Key;n.ETag&&(t.isEmpty(n.ETag)||y.setCurrentObject(n),o.path("/"+x.PATH_SEGMENTS.OBJECT_DETAILS+"/"+M.getCurrentBucket()+"/"+encodeURIComponent(M.relativeToAbsoluteObjectPath(r)).replace(/%2F/g,"/")).search("tab",e))},u.hoverDownloadPanel=function(e){B.bodyFreezeScroll(e,!0)},u.hoverConfirmationPanel=function(e){B.bodyFreezeScroll(e,!0)},u.$watch("isConfirmationModalOpen",function(e){B.bodyFreezeScroll(!!e.dialogOpen.flag)},!0),u.$watch("initiateRestoreObj.isDisplayed",function(e){B.bodyFreezeScroll(!!e.flag)},!0),u.$watch("isUploadModalDisplayed",function(e){B.bodyFreezeScroll(!!e.flag)},!0),u.moreDropdownItemOpen={id:"open",text:p.instant("objectMoreDropDown.open"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.OPEN)}},u.moreDropdownItemGetInfo={id:"getinfo",text:p.instant("objectMoreDropDown.gettotalsize"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.GET_INFO)}},u.moreDropdownItemDownload={id:"download",text:p.instant("objectMoreDropDown.download"),disabled:!1,action:function(){u.openDownloadAsPanel()},facID:"s3-download"},u.moreDropdownItemSelect={id:"select",text:p.instant("objects.select.title"),disabled:!1,action:function(){u.moveToObjectTab(x.TABS.OBJECT_LIST.SELECT)},facID:"s3-select"},u.moreDropdownItemRename={id:"rename",text:p.instant("objectMoreDropDown.rename"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.RENAME)},opName:x.OPERATION_NAME.RENAME,facID:"s3-rename"},u.moreDropdownItemDelete={id:"delete",text:p.instant("objectMoreDropDown.delete"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.DELETE_OBJECTS)},opName:x.OPERATION_NAME.DELETE_OBJECTS,facID:"s3-delete"},u.moreDropdownItemUndoDelete={id:"undodelete",text:p.instant("objectMoreDropDown.undodelete"),disabled:!0,action:function(){u.takeActions(x.OPERATION_NAME.RESTORE_OBJECTS)},opName:x.OPERATION_NAME.RESTORE_OBJECTS,facID:"s3-delete"},u.moreDropdownItemUndoCut={id:"cut",text:p.instant("objectMoreDropDown.cut"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.CUT)},opName:x.OPERATION_NAME.CUT,facID:"s3-copy"},u.moreDropdownItemUndoCopy={id:"copy",text:p.instant("objectMoreDropDown.copy"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.COPY)},opName:x.OPERATION_NAME.COPY,facID:"s3-copy"},u.moreDropdownItemUndoPaste={id:"paste",text:p.instant("objectMoreDropDown.paste"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.PASTE)},opName:x.OPERATION_NAME.PASTE,facID:"s3-copy"},u.moreDropdownItemChangeStorageClass={id:"changestorageclass",text:p.instant("objectMoreDropDown.changestorageclass"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.CHANGE_STORAGE_CLASS)},opName:x.OPERATION_NAME.CHANGE_STORAGE_CLASS,facID:"s3-change-storage-class"},u.moreDropdownItemInitiateRestore={id:"initialrestore",text:R.isFeatureEnabled(x.FAC.DEEP_ARCHIVE)?p.instant("objectMoreDropDown.restore"):p.instant("objectMoreDropDown.restorefromglacier"),disabled:!0,action:function(){u.takeActions(x.OPERATION_NAME.INITIATE_RESTORE)},opName:x.OPERATION_NAME.INITIATE_RESTORE,facID:"s3-initiate-restore"},u.moreDropdownItemChangeEncryption={id:"changeencryption",text:p.instant("objectMoreDropDown.changeencryption"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.CHANGE_SSE)},opName:x.OPERATION_NAME.CHANGE_SSE,facID:"s3-change-encryption"},u.moreDropdownItemChangeMetadata={id:"changemetadata",text:p.instant("objectMoreDropDown.changemetadata"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.CHANGE_METADATA)},opName:x.OPERATION_NAME.CHANGE_METADATA},u.moreDropdownItemMakeObjectPublic={id:"makeobjectpublic",text:p.instant("objectdetails.button.makepublic"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.MAKE_PUBLIC)},opName:x.OPERATION_NAME.MAKE_PUBLIC,facID:"s3-make-public"},u.moreDropdownItemAddObjectTags={id:"addobjecttags",text:p.instant("objectMoreDropDown.addtags"),disabled:!1,action:function(){u.takeActions(x.OPERATION_NAME.ADD_OBJECT_TAG)},opName:x.OPERATION_NAME.ADD_OBJECT_TAG,facID:x.FAC.OBJECT_TAGGING},u.more_dropdown=[{items:[u.moreDropdownItemOpen,u.moreDropdownItemDownload,u.moreDropdownItemGetInfo]},{items:[u.moreDropdownItemChangeStorageClass,u.moreDropdownItemInitiateRestore,u.moreDropdownItemChangeEncryption,u.moreDropdownItemChangeMetadata,u.moreDropdownItemAddObjectTags,u.moreDropdownItemMakeObjectPublic,u.moreDropdownItemRename]},{items:[u.moreDropdownItemDelete,u.moreDropdownItemUndoDelete,u.moreDropdownItemUndoCut,u.moreDropdownItemUndoCopy,u.moreDropdownItemUndoPaste]},{items:[u.moreDropdownItemSelect]}],u.sidePanelRadioGroupVisible=function(e){return!t.contains([u.moreDropdownItemUndoDelete.opName,u.moreDropdownItemAddObjectTags.opName,u.moreDropdownItemChangeMetadata.opName],e)},t.each(u.more_dropdown,function(e){e.items=t.filter(e.items,function(e){var t=e.facID;return!t||R.isFeatureEnabled(t)})}),u.batchOps={error:null,numKeysOperatedOn:null,size:20},u.timing={fetchAllObjects:{start:null,end:null,duration:null}},u.validateInitialRestoreValue=function(e){isNaN(e.setting)||parseInt(e.setting)<1?e.inputErrorMsg="initialrestorevalue.invalidwarning":e.inputErrorMsg=""},u.startKeyNum=0,u.fetchPageInProgress=!1,u.markers=[],u.versionsKeyMarkers=[],u.versionsIdMarkers=[],u.tagContinuationTokens=[],u.sortColumnName="",u.reverseSortOrder=!1,function(){ue(),u.flags.uploadDisabled=!1,u.isUploadModalDisplayed.flag=!1,u.initiateRestoreObj.isDisplayed.flag=!1}(),u.downloadAsPanel=!1,u.operations={},u.objectSelectedForSidePanel={};var Ye=["Key","VersionId","Size","ExpirationDate","ExpirationRule","ETag","LastModified","Link"],We=["Key","Size","ExpirationDate","ExpirationRule","ETag","LastModified","Link"],ze=x.PROPERTIES_TITLE_OPNAME_MAPPING;R.isFeatureEnabled(x.FAC.OBJECT_RETENTION)||delete ze.Retention;var $e=Object.keys(ze),He=x.VERSIONS.LIST_VERSIONS_COMPLETED,qe={isTruncated:!0,currentPage:0,lastCachedPage:0},Je=["Retention"];u.createFolder={show:!1},u.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};var Xe={flag:!0,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};u.countInfo=t.cloneDeep(Xe),u.bucketName=l[x.PATH_SEGMENTS.BUCKET_NAME],u.setSortOrder=function(e){u.sortColumnName=e,u.reverseSortOrder=!u.reverseSortOrder,H()},u.showCreateFolder=function(){u.operation=new A("CreateFolder"),u.createFolder.displayed=!0,u.showEmptyScreen=!1,u.noResultsMessage=!1},u.navigateIntoFolder=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=""+o.path()+encodeURIComponent(e)+x.DELIMITER,r=encodeURIComponent(n).replace(/%2F/g,"/");if(t){var i=o.absUrl().replace(encodeURIComponent(o.path()).replace(/%2F/g,"/"),r);f.open(i,"_blank").opener=null}else{var a=M.getFolderNamesList(),s=a.length;u.showVersions?y.addVersionMarkersList(s,e):y.addMarkersList(s,e),o.path(n).search(x.CURRENT_VERSIONS_KEY_MARKER,null).search(x.CURRENT_VERSIONS_ID_MARKER,null).search(x.PREFIX_SEARCH_PARAM,null).search(x.CURRENT_MARKER,null)}},u.closeObjectPropertiesPanel=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];u.objectPropertiesPanel.show=!1,u.switchedFromSidePanel=!1,e&&u.hoverObjectPropertiesPanel(!1)},u.closeDownloadAsPanel=function(){u.downloadAsPanel=!1,u.hoverDownloadPanel(!1)},u.openDownloadAsPanel=function(){u.objectPropertiesPanel.show=!1,u.downloadAsPanel=!0,u.downloadAsPanelGenerating=!0,u.downloadPanelError=!1,u.downloadPanel={},w.generatePresignedUrlForCurrentObject(u.getSelectedObjects()[0]).then(function(e){u.downloadAsPanelGenerating=!1,u.downloadPanel.url=e.data.presignedUrl},function(e){u.downloadAsPanelGenerating=!1,u.downloadPanelError=!0})},u.downloadSelectedObject=function(){!(arguments.length<=0||void 0===arguments[0])&&arguments[0]||w.downloadCurrentSelection(u.versionsDropdownSelectedObject.obj,!1).catch(function(e){e.error&&e.error.status&&(u.batchOpsError=e.error.status)})},u.showAllObjects=function(){if(!u.fetchPageInProgress){u.fetchPageInProgress=!0;var e=o.path();o.path(e).search(x.SHOW_DELETED_PARAM,"false"),o.path(e)}},u.showDeletedObjects=function(){if(!u.fetchPageInProgress){u.fetchPageInProgress=!0,y.resetDeletedObjects();var e=o.path();o.path(e).search(x.SHOW_DELETED_PARAM,"true"),o.path(e)}},u.showObjectVersions=function(){if(!u.fetchPageInProgress&&!u.showVersions){u.fetchPageInProgress=!0;var e=o.path();o.path(e).search(x.SHOW_VERSION_PARAM,"true").search(x.CURRENT_MARKER,null),o.path(e),D.log(x.OBJECT_VERSION_OPERATION.SHOW_VERSIONS,1,new A("ShowObjectVersions"))}},u.hideObjectVersions=function(){if(!u.fetchPageInProgress&&u.showVersions){u.fetchPageInProgress=!0;var e=o.path();o.path(e).search(x.SHOW_VERSION_PARAM,"false").search(x.CURRENT_VERSIONS_ID_MARKER,null).search(x.CURRENT_VERSIONS_KEY_MARKER,null),o.path(e),D.log(x.OBJECT_VERSION_OPERATION.HIDE_VERSIONS,1,new A("HideObjectVersions"))}},u.getSelectedFolders=function(){return u.selectedFolders||[]},u.getSelectedObjects=function(){return u.selectedObjects||[]},u.getSelectedKeys=function(){return u.selectedKeys||[]},u.isSingleObjectOnlySelected=function(){return 1===u.getSelectedObjects().length&&0===u.getSelectedFolders().length},u.isDownloadable=function(){if(!u.isSingleObjectOnlySelected())return!1;var e=u.getSelectedObjects()[0];return!B.isStorageClassRestorable(e.StorageClass)||e.withinRestoreExpiry},u.showVersionsDropdown={show:!1},u.objectsPage={show:!0},u.bucketForVersionsDropdown={name:u.bucketName},u.listVersions=function(e){e.stopPropagation(),u.showVersionsDropdown.show?u.showVersionsDropdown.show=!1:(u.showVersionsDropdown.show=!0,B.analyticsTrackClick(x.ANALYTICS.LATEST_VERSION,x.ANALYTICS.DETAILS))},u.toggleS3SelectEnabledForObject=function(e){u.s3SelectEnabled=v.s3SelectEnabledForObject(e)},u.resetSelection=function(){u.tableSelection.resetSelection()},u.clickObjectRow=function(e,t){u.showVersions&&!t.isVersionRow||(e.ctrlKey||e.metaKey?u.tableSelection.toggleItem(t):e.shiftKey?u.tableSelection.shiftSelect(t):u.tableSelection.selectOneItem(t))},u.clickCheckBox=function(e,t){e&&(e.stopPropagation(),e.shiftKey&&(e.preventDefault(),u.tableSelection.shiftSelect(t)))};var Ze=(Pe={},r(Pe,x.OPERATION_NAME.DELETE_OBJECTS,{numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),r(Pe,x.OPERATION_NAME.RESTORE_OBJECTS,{numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),r(Pe,x.OPERATION_NAME.MAKE_PUBLIC,{numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),r(Pe,x.OPERATION_NAME.CUT,{isCut:!0,numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),r(Pe,x.OPERATION_NAME.COPY,{isCut:!1,numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),r(Pe,x.OPERATION_NAME.RENAME,{isRename:!0,numberOfKeysPerBulkOperation:x.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),Pe);u.addTag=function(e){if(0===n(e.target).parents(".awsui-button-disabled").length){var t={Key:"",Value:""};u.panelSettingValues.values?u.panelSettingValues.values.push(t):u.panelSettingValues.values=[t]}},u.isAnyKeyEmpty=function(){return!t.isEmpty(u.panelSettingValues.values)&&t.some(u.panelSettingValues.values,function(e){return t.isEmpty(e.Key)})},u.removeTag=function(e){u.panelSettingValues.values.splice(e,1)},u.isPropertyReadOnly=function(e){return Je.includes(e)},u.takeActionFromSidePanel=function(e,t,n){if(u.objectSelectedForSidePanel.obj.ETag){if(u.isPropertyReadOnly(t))return n.preventDefault(),void n.stopPropagation();e!==x.TABS.OBJECT_LIST.PROPERTIES||u.isRestoreStorageClass()||(!u.showVersions&&u.objectSelectedForSidePanel.obj.versionLabel===p.instant("versionsdropdown.label.latestVersion")||u.showVersions&&"true"===u.objectSelectedForSidePanel.obj.IsLatest||t&&"Tags"===t)&&(n.stopPropagation(),u.switchedFromSidePanel=!0,u.takeActions(ze[t]))}},u.restoreFromGlacier=function(){u.takeActions(x.OPERATION_NAME.INITIATE_RESTORE)},u.isRestoreStorageClass=function(){var e=u.objectPropertiesConfig.properties.StorageClass;return e===B.getStorageClassTranslations()[x.STORAGE_CLASSES.DEEP_ARCHIVE]&&(e=x.STORAGE_CLASSES.DEEP_ARCHIVE),B.isStorageClassRestorable(e)},u.takeActions=function(e){u.opName=e,u.isConfirmationModalOpen.flag=!1,u.isConfirmationModalOpen.dialogOpen.flag=!1,u.tagError=!1,u.isConfirmationModalOpen.sidePanelOpen=!1,u.isConfirmationModalOpen.isRestorePanel=!1,u.countInfo=t.cloneDeep(Xe),u.panelSettingValues=null,u.operation=null,u.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:!1,text:""}},ne(e);var n=void 0;switch(e){case x.OPERATION_NAME.PASTE:u.isConfirmationModalOpen.flag=!0,u.isConfirmationModalOpen.dialogOpen.flag=!0,ie(e);break;case x.OPERATION_NAME.COPY:case x.OPERATION_NAME.CUT:ie(e),C.setClipboardOperation(u.operation);break;case x.OPERATION_NAME.INITIATE_RESTORE:u.selectedRestoreObjects=u.getSelectedObjects(),R.isFeatureEnabled("s3-gl-tier-"+u.bucketRegion.value)?u.initiateRestoreObj.isDisplayed.flag=!0:(ie(e,!0),u.isConfirmationModalOpen.isRestorePanel=!0,u.modalInfo=xe[e],u.panelSettingValues=t.cloneDeep(De)[u.operation.name],u.operation.panelSettingValues=u.panelSettingValues,u.isConfirmationModalOpen.sidePanelOpen=!0,n={currFolderPathPrefix:u.operation.initialPath,folders:u.operation.selectedFolders,objects:u.operation.selectedKeys},u.countInfo.countFinish=!0,u.isCounting={flag:!1},_.countAllFiles(n,u.countInfo,u.operation,u.isCounting));break;case x.OPERATION_NAME.CHANGE_STORAGE_CLASS:if(ie(e,!0),u.modalInfo=xe[e],u.panelSettingValues=t.cloneDeep(De)[u.operation.name],u.isSingleObjectOnlySelected()){var r=u.getSelectedObjects()[0];u.panelSettingValues.setting=r.StorageClass}u.operation.panelSettingValues=u.panelSettingValues,u.changeStorageClassModalObj.isOpen.flag=!0,n={currFolderPathPrefix:u.operation.initialPath,folders:u.operation.selectedFolders,objects:u.operation.selectedKeys},u.countInfo.countFinish=!0,u.isCounting={flag:!1},_.countAllFiles(n,u.countInfo,u.operation,u.isCounting);break;case x.OPERATION_NAME.CHANGE_SSE:ie(e,!0),u.modalInfo=xe[e],u.panelSettingValues=t.cloneDeep(De)[u.operation.name],Ke&&u.isSingleObjectOnlySelected()&&(Ke===x.OBJECT_SSE.KMS_ENCRYPTION?(u.panelSettingValues.setting=Ke,pe().then(function(){u.panelSettingValues.kmsOption={kmsId:B.getKMSAliasForArn(Ue,u.kmsKeys)}})):u.panelSettingValues.setting=x.OBJECT_SSE[Ke]),u.operation.panelSettingValues=u.panelSettingValues,u.isConfirmationModalOpen.sidePanelOpen=!0,n={currFolderPathPrefix:u.operation.initialPath,folders:u.operation.selectedFolders,objects:u.operation.selectedKeys},u.countInfo.countFinish=!0,u.isCounting={flag:!1},_.countAllFiles(n,u.countInfo,u.operation,u.isCounting);break;case x.OPERATION_NAME.ADD_OBJECT_TAG:ie(e,!0),u.modalInfo=xe[e],u.panelSettingValues=t.cloneDeep(De)[u.operation.name],u.operation.panelSettingValues=u.panelSettingValues,n={currFolderPathPrefix:u.operation.initialPath,folders:u.operation.selectedFolders,objects:u.operation.selectedKeys},u.isConfirmationModalOpen.sidePanelOpen=!0,u.switchedFromSidePanel&&fe().then(function(e){u.panelSettingValues.values=e,u.panelSettingValues.disableFetchTag=!0}),u.countInfo.countFinish=!0,u.isCounting={flag:!1},_.countAllFiles(n,u.countInfo,u.operation,u.isCounting);break;case x.OPERATION_NAME.CHANGE_METADATA:ie(e,!0),u.modalInfo=xe[e],u.panelSettingValues=t.cloneDeep(De)[u.operation.name],u.operation.panelSettingValues=u.panelSettingValues,u.isSingleObjectOnlySelected()?t.isEmpty(u.objectMetadata)||(u.panelSettingValues.values.length=0,t.forEach(u.objectMetadata,function(e,n){n===x.USER_DEFINED_METADATA[4]?u.panelSettingValues.values.push({metadataKey:{value:x.USER_DEFINED_METADATA[4],text:p.instant("objectdetail.metadata.content-type"),dropDownValue:x.CONTENT_TYPE_VALUES},metadataValue:{text:e}}):n===x.USER_DEFINED_METADATA[1]?u.panelSettingValues.values.push({metadataKey:{value:x.USER_DEFINED_METADATA[1],text:p.instant("objectdetail.metadata.content-disposition"),dropDownValue:x.CONTENT_DISPOSITION},metadataValue:{text:e}}):n===x.USER_DEFINED_METADATA[6]?u.panelSettingValues.values.push({metadataKey:t.find(u.predefinedMetadata,{value:n}),metadataValue:{text:e,value:e}}):u.panelSettingValues.values.push({metadataKey:{text:n,value:n},metadataValue:{text:e,value:e}})})):u.objectMetadata={},u.isConfirmationModalOpen.sidePanelOpen=!0,n={currFolderPathPrefix:u.operation.initialPath,folders:u.operation.selectedFolders,objects:u.operation.selectedKeys},u.countInfo.countFinish=!0,u.isCounting={flag:!1},_.countAllFiles(n,u.countInfo,u.operation,u.isCounting);break;case x.OPERATION_NAME.RENAME:ie(e),C.setClipboardOperation(u.operation),te();break;case x.OPERATION_NAME.GET_INFO:u.isConfirmationModalOpen.flag=!0,u.isConfirmationModalOpen.dialogOpen.flag=!0,ie(e);break;case x.OPERATION_NAME.OPEN:var i=u.getSelectedFolders();i.length>0&&t.forEach(i,function(e){u.navigateIntoFolder(e.Prefix,!0)});var a=u.getSelectedObjects();a.length>0&&t.forEach(a,function(e){u.openObjectInBrowser(e)});break;default:u.isConfirmationModalOpen.flag=!0,u.isConfirmationModalOpen.dialogOpen.flag=!0,ie(e)}u.closeObjectPropertiesPanel(!1)},u.closeCSCModal=function(){u.changeStorageClassModalObj.isOpen.flag=!1},u.saveStorageClass=function(e){u.closeCSCModal(),u.saveConfirmationPanel(e)},u.saveConfirmationPanel=function(e){e.stopPropagation(),re()&&(u.isConfirmationModalOpen.sidePanelOpen=!1,u.isConfirmationModalOpen.flag=!0,u.isConfirmationModalOpen.isRestorePanel=!1,u.isConfirmationModalOpen.dialogOpen.flag=!0)},u.cancelConfirmationPanel=function(e){e.stopPropagation(),t.isEmpty(u.operation)||N.cancelOperation(u.operation),u.isConfirmationModalOpen.countFinish=!1,u.isConfirmationModalOpen.sidePanelOpen=!1,u.isConfirmationModalOpen.isRestorePanel=!1,u.panelSettingValues=null,u.sidepanelMetadataValidationError=null,u.operation=null,u.switchedFromSidePanel&&ee()},u.refreshAndClearObjectsCacheForCurrentBucket=function(){y.evictBucketObjects(M.getCurrentBucket()),u.refreshWithSelection()},u.refreshWithSelection=function(){u.isRefreshing=!0,u.tagContinuationTokens=[],u.filters.prefixFilters=[],u.filters.tagFilters=[],y.resetLocationAndMarkers(),u.fetchObjects(!1)},u.batchOpsAlertDismissed=function(){u.batchOps.error=null},u.goToObjectDetails=function(e){if(!u.showDeleted&&(!u.showVersions||e.isVersionRow&&e.ETag)){var n=e.Path?e.Path+e.Key:e.Key;t.isEmpty(e.ETag)||y.setCurrentObject(e),o.path("/"+x.PATH_SEGMENTS.OBJECT_DETAILS+"/"+M.getCurrentBucket()+"/"+encodeURIComponent(M.relativeToAbsoluteObjectPath(n)).replace(/%2F/g,"/")),u.showVersions&&o.search(x.VERSION_ID_PARAM,e.VersionId)}},u.openObjectInBrowser=function(e){!e.ETag||B.isStorageClassRestorable(e.StorageClass)&&!e.withinRestoreExpiry||(!u.showVersions||u.showVersions&&e.isVersionRow)&&w.openInBrowser(e.Key,e.Size,e.VersionId)},u.setUpObjectMetadataForPropertiesPanel=function(e){u.objectPropertiesConfig={},u.objectMetadata={};var n=void 0;n=u.showVersions?Ye:We;var r={overview:n,properties:$e,permissions:[]};if(!u.isFeatureEnabled(x.FAC.OBJECT_TAGGING)){var a=r.properties.indexOf("Tags");r.properties.splice(a,1)}t.map(r,function(n,r){u.objectPropertiesConfig[r]={},t.map(n,function(t){u.objectPropertiesConfig[r][t]="Size"===t?i("humanReadableBytes")(e[t]):e[t]})});var o=M.relativeToAbsoluteObjectPath(e.Key),s=e.VersionId;o=e.Path?e.Path+o:o;var c=new A(x.OPERATION_NAME.GET_METADATA);L.getMetadata(u.bucketName,o,s,c).then(function(e){if("error"===t.get(e,"data.requestStatus")&&t.get(e,"data.errorCode").includes(x.HTTP_STATUS_CODES.BAD_REQUEST))D.log("getObjectMetadataCWS",c,0),u.objectPropertiesConfig.properties.Metadata=p.instant("objectproperties.error.metadataresticted");else if(u.isSingleObjectOnlySelected()){D.log("getObjectMetadataCWS",c,1);var n=t.get(e,"data.metadata");n&&(u.objectMetadata=t.pick(n,function(e,t){return x.USER_DEFINED_METADATA.indexOf(t)>-1||0===t.indexOf(x.USER_DEFINED_METADATA_PREFIX)})),u.objectPropertiesConfig.properties.Metadata=Object.keys(u.objectMetadata).length,u.initiateRestoreObj.headers=n}}).catch(function(e){u.isSingleObjectOnlySelected()&&(D.log("getObjectMetadataCWS",c,0,{error:e}),u.objectPropertiesConfig.properties.Metadata="-")});var l=u.objectPropertiesConfig.overview,d=u.objectPropertiesConfig.properties;l.LastModified=i("date")(l.LastModified,u.dateFormat),u.showDeleted&&(l.Size="-"),void 0===l.Size&&(l.Size="-"),d.StorageClass=d.StorageClass?B.getStorageClassTranslations()[d.StorageClass]:"-",d.Encryption=B.getEncryptionTranslations()[d.Encryption],(u.showDeleted||t.isEmpty(d.Encryption))&&(d.Encryption="-"),R.isFeatureEnabled(x.FAC.OBJECT_RETENTION)&&(oe(l)?d.Retention="-":E.isObjectRetentionEnabled(u.bucketName,c).catch(function(){return!0}).then(function(e){e?se(c,l).then(function(e){return d.Retention=e}).catch(function(e){d.Retention="-",u.objectSelectedForSidePanel.error=p.instant(e.text)}):d.Retention=p.instant("bucketproperty.disabled")})),l.ETag=l.ETag?l.ETag.replace(/[\\"]+/g,""):"-",l.Link="-",l.ExpirationDate=l.ExpirationDate?i("date")(new Date(l.ExpirationDate),u.dateFormat):"N/A",l.ExpirationRule=l.ExpirationRule?l.ExpirationRule:"N/A",m.getBucketLocation(u.operation,u.bucketName,{}).then(function(e){var t=u.showDeleted||"-"===l.ETag?"":M.getObjectLink(o,e.region,s);l.Link=l.Path?l.Path+t:t})},u.updateObjMetadataForTest=function(e){u.updateObjMetadata(e)},u.isCurrentlySelectedObject=function(e){var t=u.getSelectedObjects();return 1===t.length&&t[0]===e},u.updateObjMetadata=function(e){var n=c.defer(),r=new A("getObjectMetadata"),a=M.relativeToAbsoluteObjectPath(e.Key);a=e.Path?e.Path+a:a;var o=e.VersionId,s=M.getCurrentBucket();return m.getObjectMetadata(r,s,a,o).then(function(o){if(D.log("getObjectMetadata",1,r,{bucket:s,key:a}),u.objectPropertiesConfig||(u.objectPropertiesConfig={}),u.objectPropertiesConfig.properties||(u.objectPropertiesConfig.properties={}),u.objectPropertiesConfig.overview||(u.objectPropertiesConfig.overview={}),u.isCurrentlySelectedObject(e)&&(Ke=x.OBJECT_SSE.NONE,u.objectPropertiesConfig.properties.Encryption=B.getEncryptionTranslations()[Ke],u.objectPropertiesConfig.overview.ExpirationDate="N/A",u.objectPropertiesConfig.overview.ExpirationRule="N/A",o.headers()&&u.isSingleObjectOnlySelected())){var c=t.findIndex(u.currLocation.objects.relativePaths,{Key:e.Key}),l=o.headers(),d=l[x.HEADERS.X_AMZ_RESTORE];if(d){var f=B.extractFromQuotes(d);"true"===f?(c>-1&&(u.currLocation.objects.relativePaths[c].withinRestoreExpiry=!1),u.objectPropertiesConfig.overview.Restoration=p.instant("objectdetails.value.restoration")):"false"===f&&(u.objectPropertiesConfig.overview.RestorationExpiry=i("date")(new Date(B.extractFromQuotes(d,1)),u.dateFormat),c>-1&&(u.currLocation.objects.relativePaths[c].withinRestoreExpiry=!t.isEmpty(u.objectPropertiesConfig.overview.RestorationExpiry)))}if(R.isFeatureEnabled(x.FAC.RESTORE_SPEED_PROMOTION)){var g=l[x.HEADERS.X_AMZ_RESTORE_REQUEST_DATE];g&&(u.objectPropertiesConfig.overview.RestoreRequestDate=i("date")(new Date(B.extractFromQuotes(g,1)),u.dateFormat));var m=l[x.HEADERS.X_AMZ_RESTORE_TIER];if(m){var h=e.StorageClass===x.STORAGE_CLASSES.DEEP_ARCHIVE?x.INITIATE_RESTORE.STANDARD_RETRIEVAL:x.INITIATE_RESTORE.EXPEDITED_RETRIEVAL;u.objectPropertiesConfig.overview.RestoreTier={value:de(m),canUpgrade:m!==h}}}if(l[x.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]&&(Ke=l[x.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION],u.objectPropertiesConfig.properties.Encryption=B.getEncryptionTranslations()[Ke],Ke===x.OBJECT_SSE.KMS_ENCRYPTION&&(Ue=l[x.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID])),l[x.HEADERS.X_AMZ_EXPIRATION]){var b=l[x.HEADERS.X_AMZ_EXPIRATION];u.objectPropertiesConfig.overview.ExpirationDate=i("date")(new Date(B.extractFromQuotes(b,0)),u.dateFormat),u.objectPropertiesConfig.overview.ExpirationRule=B.extractFromQuotes(b,1)}if(l[x.HEADERS.X_AMZ_REPLICATION_STATUS]&&(u.objectPropertiesConfig.overview.ReplicationStatus=l[x.HEADERS.X_AMZ_REPLICATION_STATUS]),u.isFeatureEnabled(x.FAC.OBJECT_TAGGING)){var v=l[x.HEADERS.X_AMZ_TAGGING_COUNT]||0;t.isNaN(parseInt(v))||(u.objectPropertiesConfig.properties.Tags=p.instant("objectproperties.tags.keyvalue",{count:v}))}}n.resolve()}).catch(function(e){return B.isObjectWithSSECEncryption(e)?(u.objectPropertiesConfig.properties.Encryption=B.getEncryptionTranslations().SSEC,V.getObjectTags(s,a,o).then(function(e){var t=e.length;u.objectPropertiesConfig.properties.Tags=p.instant("objectproperties.tags.keyvalue",{count:t}),n.resolve()})):c.reject(e)}).catch(function(e){var t={};t.error=B.handleErrors(e),t.key=a,t.bucket=s,D.log("getObjectMetadata",0,r,t),u.objectPropertiesConfig||(u.objectPropertiesConfig={}),u.objectPropertiesConfig.properties||(u.objectPropertiesConfig.properties={}),u.objectPropertiesConfig.overview||(u.objectPropertiesConfig.overview={}),u.objectPropertiesConfig.properties.Encryption=B.getErrorMessage(e),u.objectPropertiesConfig.overview.ExpirationDate="",u.objectPropertiesConfig.overview.ExpirationRule="",u.isFeatureEnabled(x.FAC.OBJECT_TAGGING)&&(u.objectPropertiesConfig.properties.Tags=B.getErrorMessage(e)),n.resolve()}),n.promise},u.updateConfigPanel=function(){u.panelSettingValues.setting===x.OBJECT_SSE.KMS_ENCRYPTION&&pe()},u.updateObjAclForTest=function(e){u.updateObjAcl(e)},u.updateObjAcl=function(e){var t=new A("getObjectAcl"),n=M.getCurrentBucket(),i=M.relativeToAbsoluteObjectPath(e.Key);m.getObjectAcl(t,n,i,e.VersionId).then(function(a){if(a&&a.response&&a.response.AccessControlPolicy&&a.response.AccessControlPolicy.AccessControlList){var o,s=a.response.AccessControlPolicy,c=(o={},r(o,x.ACL_PERMISSIONS.READ,[]),r(o,x.ACL_PERMISSIONS.WRITE,[]),r(o,x.ACL_PERMISSIONS.READ_ACP,[]),r(o,x.ACL_PERMISSIONS.WRITE_ACP,[]),o),l=s.AccessControlList.Grant,d=s.Owner.DisplayName,p=function(e){var t=ge(e,d);if(e.Permission===x.ACL_PERMISSIONS.FULL_CONTROL)for(var n in c)-1===c[n].indexOf(t)&&c[n].push(t);else-1===c[e.Permission].indexOf(t)&&c[e.Permission].push(t)};l&&(Array.isArray(l)?l.forEach(function(e){p(e)}):p(l),u.isCurrentlySelectedObject(e)&&(u.objectPropertiesConfig||(u.objectPropertiesConfig={}),u.objectPropertiesConfig.permissions||(u.objectPropertiesConfig.permissions={}),u.objectPropertiesConfig.permissions.owner=d,u.objectPropertiesConfig.permissions.grantees={},u.objectPropertiesConfig.permissions.grantees.object={},u.objectPropertiesConfig.permissions.grantees.object[x.ACL_PERMISSIONS.READ]=c[x.ACL_PERMISSIONS.READ].length,u.objectPropertiesConfig.permissions.grantees.objectPermissions={},u.objectPropertiesConfig.permissions.grantees.objectPermissions[x.ACL_PERMISSIONS.READ_ACP]=c[x.ACL_PERMISSIONS.READ_ACP].length,u.objectPropertiesConfig.permissions.grantees.objectPermissions[x.ACL_PERMISSIONS.WRITE_ACP]=c[x.ACL_PERMISSIONS.WRITE_ACP].length)),D.log("getObjectAcl",1,t,{bucket:n,key:i})}},function(e){var r={};r.key=i,r.bucket=n,r.error=B.handleErrors(e),D.log("getObjectAcl",0,t,r),u.objectPropertiesConfig||(u.objectPropertiesConfig={}),u.objectPropertiesConfig.permissions||(u.objectPropertiesConfig.permissions={}),u.objectPropertiesConfig.permissions=B.handleErrors(e)})},u.fetchObjects=function(e){var n=arguments.length<=1||void 0===arguments[1]||arguments[1],r=arguments.length<=2||void 0===arguments[2]?"":arguments[2];u.isRefreshing=!0,u.filters.tagFilters=[],u.filters.prefixFilters=[],u.filters.input="",u.sortColumnName="",u.isConfirmationModalOpen.sidePanelOpen=!1,u.resetSelection(),u.timing.fetchAllObjects.start=(new Date).getTime();var i=M.getCurrentAbsoluteFolderPath();if(void 0===i&&(i=""),u.markers=[],u.versionsKeyMarkers=[],u.versionsIdMarkers=[],u.showDeleted)Se(i);else if(u.showVersions)if(t.isEmpty(u.startWithVersionKeyMarker))ve(i,r,"",n);else{var a=u.startWithVersionKeyMarker,s=t.isEmpty(u.startWithVersionIdMarker)?"":u.startWithVersionIdMarker,c=_e(a,s);if(c<0){var l=o.path();o.path(l).search(x.CURRENT_VERSIONS_KEY_MARKER,null).search(x.CURRENT_VERSIONS_ID_MARKER,null)}else ve(i,a,s,n)}else if(e)Te(i,r,n);else if(t.isEmpty(u.startWithMarker))be(i,r,n);else{var c=we(u.startWithMarker);if(c<0){var l=o.path();o.path(l).search(x.CURRENT_MARKER,null)}else be(i,u.startWithMarker,n)}},u.fetchOnePagePrefix=function(e,t,n){u.markers=[],u.versionsKeyMarkers=[],u.versionsIdMarkers=[],u.showVersions?ve(e,t,n):be(e,t)},u.fetchOnePageTag=function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];u.showEmptyScreen=!1,u.noResultsMessage=void 0,u.isConfirmationModalOpen.sidePanelOpen=!1,u.resetSelection(),t&&(u.currLocation.folders.relativePaths=[],u.currLocation.objects.relativePaths=u.nextTagObjs||[],u.startKeyNum=0===u.tagContinuationTokens.length?0:u.maxKeys*u.markers.length+1,u.endKeyNum=u.startKeyNum,u.isRefreshing=!0),u.tagQueryDeferred=c.defer(),u.tagQueryDeferred.promise.then(function(e){return ye(e)},function(e){e.status===x.HTTP_STATUS_CODES.METHOD_NOT_ALLOWED?u.currLocation.objects.error=p.instant("prefixtagsearch.methodnotallowed"):u.currLocation.objects.error=p.instant("utilities.unknown.error"),u.isRefreshing=!1,u.fetchPageInProgress=!1,u.showAllObjects()}),I.tagQuery(u.filters.tagFilters,u.maxKeys,e).then(function(e){return u.tagQueryDeferred.resolve(e)},function(e){return u.tagQueryDeferred.reject(e)})},u.fetchNextPageOfObjects=function(){if(!u.fetchPageInProgress){u.fetchPageInProgress=!0;var e=M.getCurrentAbsoluteFolderPath();void 0===e&&(e="");var n=M.getFolderNamesList();if(u.showDeleted)qe.currentPage++,qe.currentPage<=qe.lastCachedPage||!qe.isTruncated?(Ce(),u.fetchPageInProgress=!1):k.fetchDeletedPageOfObjects(e,qe.currentPage,qe.nextKeyMarker,qe.nextVersionIdMarker).then(function(e){Ee(e),u.fetchPageInProgress=!1},function(e){Re(e),u.fetchPageInProgress=!1});else if(u.showVersions)if(e=e.concat(Fe||""),t.isEmpty(u.filters.prefixFilters)){var r=t.isEmpty(u.nextVersionIdMarker)?"":u.nextVersionIdMarker,i=t.isEmpty(u.versionsNextKeyMarker)?"":u.versionsNextKeyMarker;y.addVersionMarker({marker:u.versionsCurrentKeyMarker,id:u.versionsCurrentIdMarker},{marker:u.versionsNextKeyMarker,id:u.nextVersionIdMarker},n.length-1,n[n.length-1]);var a=o.path();o.path(a).search(x.CURRENT_VERSIONS_KEY_MARKER,i).search(x.CURRENT_VERSIONS_ID_MARKER,r)}else u.versionsKeyMarkers.push(u.versionsCurrentKeyMarker),u.versionsIdMarkers.push(u.versionsCurrentIdMarker),u.startKeyNum=u.maxKeys*u.versionsKeyMarkers.length+1,ve(e,u.versionsNextKeyMarker,u.nextVersionIdMarker);else if(u.tagContinuationTokens.length>0)u.fetchOnePageTag(u.tagContinuationTokens[u.tagContinuationTokens.length-1]);else if(e=e.concat(Fe||""),t.isEmpty(u.filters.prefixFilters)){y.addMarker(u.currentMarker,u.nextMarker,n.length-1,n[n.length-1]);var a=o.path();o.path(a).search(x.CURRENT_MARKER,u.nextMarker)}else u.markers.push(u.currentMarker),u.startKeyNum=u.maxKeys*u.markers.length+1,be(e,u.nextMarker)}},u.fetchPreviousPageOfObjects=function(){if(u.showDeleted)qe.currentPage--,Ce();else{var e=M.getCurrentAbsoluteFolderPath();void 0===e&&(e=""),e=e.concat(Fe||"");var n=M.getFolderNamesList(),r=n.length;if(u.showVersions)if(t.isEmpty(u.filters.prefixFilters)){var i=t.isEmpty(u.versionsCurrentIdMarker)?"":u.versionsCurrentIdMarker,a=t.isEmpty(u.versionsCurrentKeyMarker)?"":u.versionsCurrentKeyMarker,s="",c="",l=_e(a,i);if(l>0){var d=y.getVersionMarkers(r-1,n[r-1]);s=d[l-1].marker,c=d[l-1].id}var p=o.path();o.path(p).search(x.CURRENT_VERSIONS_KEY_MARKER,s).search(x.CURRENT_VERSIONS_ID_MARKER,c)}else{var f=u.versionsKeyMarkers.pop(),g=u.versionsIdMarkers.pop();u.startKeyNum=u.maxKeys*u.versionsKeyMarkers.length+1,f&&0!==Object.keys(f).length||(f=""),g&&0!==Object.keys(g).length||(g=""),ve(e,f,g)}else if(t.isEmpty(u.filters.prefixFilters)){var m=t.isEmpty(u.currentMarker)?"":u.currentMarker,l=we(m),h="";if(l>0){var b=y.getMarkers(r-1,n[r-1]);h=b[l-1]}var p=o.path();o.path(p).search(x.CURRENT_MARKER,h)}else{var h=u.markers.pop();h&&0!==Object.keys(h).length||(h=""),u.startKeyNum=u.maxKeys*u.markers.length+1,be(e,h)}}},u.openUploadModal=function(){u.currentPath=M.getAbsolutePathWithBucket(),u.flags.uploadDisabled=!0,B.analyticsTrackClick(x.ANALYTICS.UPLOAD_OBJECTS_MODAL,x.ANALYTICS.DETAILS),B.analyticsTrackClick(x.ANALYTICS.START_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3),B.analyticsTrackView(x.ANALYTICS.SELECT_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3),u.isUploadModalDisplayed.flag=!0};var Qe=s.$on("fileDropEvent",function(e,t){u.isUploadModalDisplayed.flag||(e.defaultFired=!0,u.operations.dragAndDropOperation=j.createUploadOperation(),T.createExplorer(t,u.operations.dragAndDropOperation).then(function(e){u.operations.dragAndDropOperation.explorers.push(e),u.selected={selectedItems:e.getSelectedItems()},u.flags.uploadDisabled=!1},function(e){u.error=e}),u.openUploadModal())});u.getPropertyTitleConditionally=function(e,t,n){return e?p.instant(t+n):""},u.setTabParam=function(e){o.search("tab",e),B.analyticsTrackClick(""+x.ANALYTICS.TAB_VIEW+e,x.ANALYTICS.DETAILS)},u.$on("$destroy",function(){Qe(),u.tableSelection.resetSelection(!1)}),u.getStorageClassTranslation=function(e){return B.getStorageClassTranslations()[e]},u.isFeatureEnabled=function(e){return R.isFeatureEnabled(e)},u.isFetchPreviousPageDisabled=function(){if(u.fetchPageInProgress)return!0;if(u.showDeleted)return 0===qe.currentPage;if(u.showVersions){if(t.isEmpty(u.filters.prefixFilters)){var e=t.isEmpty(u.versionsCurrentIdMarker)?"":u.versionsCurrentIdMarker;return _e(t.isEmpty(u.versionsCurrentKeyMarker)?"":u.versionsCurrentKeyMarker,e)<0}return 0===u.versionsKeyMarkers.length}return t.isEmpty(u.filters.prefixFilters)?we(t.isEmpty(u.currentMarker)?"":u.currentMarker)<0:0===u.markers.length},u.isFetchNextPageDisabled=function(){return!(!u.fetchPageInProgress&&(u.showDeleted?qe.isTruncated||qe.currentPage!==qe.lastCachedPage||y.getPageOfDeletedObjects(qe.currentPage+1):u.showVersions?u.versionsNextKeyMarker:u.nextMarker))},u.copySelectedObjectPath=function(e){var t=new A(x.OPERATION_NAME.COPY_OBJECT_PATH);D.log(x.OPERATION_NAME.COPY_OBJECT_PATH,1,t,{path:e}),B.copyPathToClipboard(e,u.copyFinished)},u.rightClick=function(n,r){D.log(x.CONTEXT_MENU.OBJECT.METRIC_NAME,1,{details:r}),n.stopPropagation();var i=e.element("#context-menu");if(i.css({position:"absolute",top:n.pageY-x.CONTEXT_MENU.OBJECT.Y_OFFSET,left:n.pageX}),r){var a=t.pluck(u.getSelectedObjects(),"Key").concat(t.pluck(u.getSelectedFolders(),"Prefix"));0!==a.length&&-1!==t.indexOf(a,r.Key||r.Prefix)||u.clickObjectRow(n,r)}d(function(){i.find("awsui-button-dropdown").find("button").trigger("click")},0,!1)},u.addMetadata=function(e){e.stopPropagation(),u.panelSettingValues.values.push({metadataKey:null,metadataValue:null})},u.clearMetadataErrorMsg=function(e){e.inputError=null},u.removeMetadata=function(e){u.panelSettingValues.values.splice(e,1)};var et=function(){R.isFeatureEnabled(x.FAC.PUBLIC_ACCESS_BLOCK)&&z.getAllSettings(u.bucketName).then(function(e){var t=e.accountSettings,n=e.bucketSettings;u.disableMakePublic=t.blockPublicAcls||n.blockPublicAcls,u.blockPublicAccessSettings={accountSettings:t,bucketSettings:n}})},tt=new A(x.OPERATION_NAME.ANALYZE_ACCESS);u.access={},u.analyzeAccess=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];et();var t=c.defer();return O.isRegionalFeatureEnabled(x.FAC.ACCESS).then(function(n){n||R.isFeatureEnabled(x.FAC.PUBLIC_ACCESS_BLOCK)?E.analyzeAccess(u.bucketName,tt,e).then(function(e){var n=g.getAccessStatus(e);u.access.bucketPublic=n.bucketPublic,u.access.aclPublic=n.aclPublic,u.access.policyPublic=n.policyPublic,t.resolve()}).catch(function(e){t.reject(e)}):t.resolve()}).catch(function(e){t.reject(e)}),t.promise},u.onSelectStorageClass=function(e){u.panelSettingValues.setting=e},function(){D.setEndpoint(),u.isFeatureEnabled("s3-si")&&u.tabs.push(Le),u.showVersionedView=!1,E.getBucketRegion(u.bucketName).then(function(e){if(t.contains(x.OPT_IN_REGION_LIST,e.id))return $.getDisabledRegions().then(function(n){u.isDisabledRegion=t.contains(n,e.id)})}).then(function(){if(u.isDisabledRegion)return void U.customerReady("Objects");if(l[x.SHOW_DELETED_PARAM]&&(u.showDeleted=B.convertStringToBoolean(l[x.SHOW_DELETED_PARAM])),l[x.SHOW_VERSION_PARAM]&&(u.showVersions=B.convertStringToBoolean(l[x.SHOW_VERSION_PARAM])),u.startWithMarker="",u.startWithVersionKeyMarker="",u.startWithVersionIdMarker="",l[x.CURRENT_MARKER]&&(u.startWithMarker=l[x.CURRENT_MARKER]),l[x.CURRENT_VERSIONS_ID_MARKER]&&(u.startWithVersionIdMarker=l[x.CURRENT_VERSIONS_ID_MARKER]),l[x.CURRENT_VERSIONS_KEY_MARKER]&&(u.startWithVersionKeyMarker=l[x.CURRENT_VERSIONS_KEY_MARKER]),l[x.PREFIX_SEARCH_PARAM]){t.isEmpty(Fe)||(u.filters.prefixFilters.length=0,u.filters.prefixFilters.push(Fe));var e=(M.getCurrentAbsoluteFolderPath()||"").concat(Fe);u.fetchOnePagePrefix(e)}var n=M.getFolderNamesList();y.initializeMarkers(n);var r=t.last(o.path().split("/buckets/"+u.bucketName));"/"!==r&&""!==r&&(u.tabs.length=0,u.tabs.push({label:p.instant("details.tab.overview"),id:x.TABS.OBJECT_LIST.OVERVIEW})),t.isEmpty(Fe)&&u.fetchObjects(!1),E.getVersioningStatus(u.bucketName).then(function(e){u.isVersionedBucket=e===x.BUCKET_PROPERTIES.VERSIONING.ENABLED||e===x.BUCKET_PROPERTIES.VERSIONING.SUSPENDED,R.isFeatureEnabled(x.FAC.VERSIONED_VIEW)&&u.isVersionedBucket&&(u.showVersionedView=!0)}).finally(function(){E.getBucketRegion(u.bucketName).then(function(e){u.bucketRegion=e,u.analyzeAccess(),O.isRegionalFeatureEnabled(x.FAC.ACCELERATE,u.bucketRegion.value).then(function(e){u.displayAcceleration=e}),O.isRegionalFeatureEnabled(x.FAC.DEFAULT_ENCRYPTION,u.bucketRegion.value).then(function(e){u.enableDefaultEncryption=e})})});var i=new A(x.OPERATION_NAME.GET_DEFAULT_ENCRYPTION);m.getBucketProperty(i,u.bucketName,"defaultEncryption").then(function(){u.defaultEncryptionEnabled=!0},function(e){u.defaultEncryptionEnabled=!1})}).catch(function(e){Re(e)})}()}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.module("s3").controller("ObjectController",["$filter","$location","$rootScope","$q","$routeParams","$scope","$timeout","$translate","$window","AnalyzeAccessUtilService","APIProxyService","AWSC","AwsUrlsService","S3SelectService","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","CopyService","CountService","DownloadService","DirectoryExplorerService","FAC","FACService","ListDeletedObjectsService","ObjectListingService","ObjectPropertiesService","OperationDispatcherService","PathService","S3CWSAPIService","S3Constants","SCLogService","UploadOperationService","UtilService","VersioningUtilService","PerformanceUtilsService","XMLParser","ApiClientService","KMSPropertiesService","SharpieAPI","TableSelectionService","PublicAccessService","RegionStatesService",i])}).call(t,n(0),n(2),n(6))},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A){function C(){return n.reject()}function _(e){return e.catch(function(){return C()})}function w(e){var t=new u(m.BUCKET_PROPERTIES.VERSIONING.ENABLE_BUCKET_VERSIONING);return _(s.enableBucketVersioning(e,t))}function T(e,t){var n=new u(m.BUCKET_PROPERTIES.TAGGING.PUT_BUCKET_TAGGING);return _(s.putBucketTagging(e,t,n))}function R(e,t){var n=new u(m.OPERATION_NAME.PUT_DEFAULT_ENCRYPTION);return _(s.putBucketDefaultEncryption(e,t,n))}function O(e){var t=new u(m.BUCKET_PERMISSIONS.PUT_BUCKET_PERMISSIONS_REQUEST);return s.putBucketACL(e,f.updateAcl(r.sourceBucketPermissions,r.currPermissions),t).catch(function(e){return C(e)})}function k(e){var t={params:{id:"EntireBucket"}},n=E.create("MetricsConfiguration",{xmlns:"http://s3.amazonaws.com/doc/2006-03-01/"}).addNode("Id",t.params.id).build(),r=new u(m.OPERATION_NAME.METRICS_PUT_CONFIG);return o.putBucketProperty(r,e,"metrics",n,t).then(function(){h.log("putBucketMetrics",1,r)}).catch(function(){h.log("putBucketMetrics",0,r)})}function I(){var e=new u("DescribeTrails");s.describeTrails(e,r.createBucketValues.region.value).then(function(t){r.createBucketProperties.getResponse.eventSelectors.trailRegionMapping={},r.createBucketProperties.getResponse.eventSelectors.trailNames=[],c.populateTrailNames(t,r.createBucketProperties.getResponse.eventSelectors.trailNames,r.createBucketProperties.getResponse.eventSelectors.trailRegionMapping),h.log("DescribeTrails",1,e)}).catch(function(t){var n=b.handleErrors(t);h.log("DescribeTrails",0,e,{error:n}),r.createBucketProperties.getResponse.eventSelectors.errorMessage=n})}function P(e,t,n,r){e.push({Grantee:{Type:m.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:t}),h.log("LogDeliveryGroupGranteeAdded",1,n,{bucketName:r})}function N(e,n,r,i){var a=new u(m.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING),o=!1;return a.step=m.BUCKET_PROPERTIES.GET_BUCKET_ACL,s.getBucketACL(n,a).then(function(c){var l=b.transformObjectToArray(c);return-1===t.findIndex(c,{Grantee:{URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:m.ACL_PERMISSIONS.WRITE})&&(P(l,m.ACL_PERMISSIONS.WRITE,a,e),o=!0),-1===t.findIndex(c,{Grantee:{URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:m.ACL_PERMISSIONS.READ_ACP})&&(P(l,m.ACL_PERMISSIONS.READ_ACP,a,e),o=!0),o?(a.step=m.BUCKET_PROPERTIES.PUT_BUCKET_ACL,s.putBucketACL(n,l,a).then(function(){return a.step=m.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING,s.enableBucketLogging(e,n,r,i,a).then(function(){}).catch(function(e){return C(e)})}).catch(function(e){return C(e)})):s.enableBucketLogging(e,n,r,i,a).then(function(){}).catch(function(e){return C(e)})}).catch(function(e){return C(e)})}function M(e){var t=new u(m.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING);return y.putBucketObjectLockConfiguration(t,e).catch(function(e){return C(e)})}function L(){var e=new u("SaveEventSelectors"),n=r.createBucketValues.name;r.createBucketProperties.getResponse.eventSelectors.access.read&&r.createBucketProperties.getResponse.eventSelectors.access.write||r.createBucketProperties.getResponse.eventSelectors.access.read;var i=r.createBucketProperties.getResponse.eventSelectors.targetTrail;return s.getEventSelectors(r.createBucketProperties.getResponse.eventSelectors.targetTrail,e,r.createBucketProperties.getResponse.eventSelectors.trailRegionMapping[i]).then(function(a){var o=t.get(a,"response.EventSelectors");if(o){var l=c.generateEventSelectorsConfig(o,r.createBucketProperties.getResponse.eventSelectors.targetTrail,r.createBucketProperties.getResponse.eventSelectors.access,n);return h.log("GetEventSelectors",1,e,{bucketName:n}),s.putEventSelectors(l,e,r.createBucketProperties.getResponse.eventSelectors.trailRegionMapping[i]).then(function(t){h.log("PutEventSelectors",1,e,{bucketName:n})}).catch(function(t){return h.log("PutEventSelectors",0,e,{bucketName:n,error:b.handleErrors(t)}),C(t)})}}).catch(function(t){return h.log("GetEventSelectors",0,e,{bucketName:n,error:b.handleErrors(t)}),C(t)})}function x(e,i){var a=n.resolve();r.createBucketProperties.getResponse.versioning.enabled&&(a=a.then(function(){return w(e)})),r.createBucketProperties.getResponse.cloudwatch.enabled&&(a=a.then(function(){return k(e)}));var o=r.createBucketProperties.getResponse.tagging.tags.filter(function(e){return!t.isEmpty(e.Key)});o.length>0&&(a=a.then(function(){return T(e,o)})),r.createBucketProperties.getResponse.logging.enabled&&!t.isEmpty(r.createBucketProperties.getResponse.logging.targetBucket)&&function(){var t=r.createBucketProperties.getResponse.logging.targetBucket,n=r.createBucketProperties.getResponse.logging.targetPrefix,i=b.transformObjectToArray(r.createBucketProperties.getResponse.logging.targetGrants);a=a.then(function(){return N(e,t,n,i)})}(),r.createBucketProperties.getResponse.objectRetention.enabled&&r.createBucketProperties.getResponse.versioning.enabled&&(a=a.then(function(){return M(e)})),JSON.stringify(f.updateAcl(r.sourceBucketPermissions,r.currPermissions))!==JSON.stringify(f.updateAcl(r.defaultAcls,r.defaultAcls))&&(a=a.then(function(){return O(e)})),r.createBucketProperties.getResponse.eventSelectors.enabled&&!t.isEmpty(r.createBucketProperties.getResponse.eventSelectors.targetTrail)&&(a=a.then(function(){return L()})),t.get(r.createBucketProperties.getResponse,"defaultEncryption")&&r.createBucketProperties.getResponse.defaultEncryption.enabled&&(a=a.then(function(){return R(e,r.createBucketProperties.getResponse.defaultEncryption)}));var s=r.publicAccess.currentSettings;return r.isPublicAccessBlockAvailable&&(s.blockPublicAcls||s.ignorePublicAcls||s.blockPublicPolicy||s.restrictPublicBuckets)&&(a=a.then(function(){return A.putSingleBucketSettings(s,e,i)})),a}function D(e){return r.bucketList&&r.bucketList.length>0&&r.bucketList.some(function(t){return t.Name===e})}function j(e){var n=r.createBucketProperties.getResponse[e.value],i={name:e.name},o={enabled:a.instant("createbucketmodal.review.enabled"),permanentlyEnabled:a.instant("bucketproperty.pemanentlyenabled"),disabled:a.instant("createbucketmodal.review.disabled"),activenotifs:a.instant("createbucketmodal.review.activenotifications"),tags:a.instant("createbucketmodal.review.tags"),none:a.instant("sse.none")};switch(e.value){case"versioning":i.status=n.enabled?o.enabled:o.disabled;break;case"logging":i.status=n.enabled&&!t.isEmpty(n.targetBucket)?o.enabled:o.disabled;break;case"cloudwatch":i.status=n.enabled?o.enabled:o.disabled;break;case"tagging":i.status=n.tags.filter(function(e){return!t.isEmpty(e.Key)}).length+" "+o.tags;break;case"eventSelectors":i.status=n.enabled&&!t.isEmpty(n.targetTrail)?o.enabled:o.disabled;break;case"defaultEncryption":var s=r.createBucketProperties.getResponse.defaultEncryption,c=s.encryption,l=s.enabled;i.status=l?c:o.none;break;case"objectRetention":var u=n.enabled,d=r.createBucketProperties.getResponse.versioning.enabled;i.status=u&&d?o.permanentlyEnabled:o.disabled}return i}r.STEP={NAME_AND_REGION:{name:"NAME_AND_REGION",value:a.instant("createbucketmodal.label.nameandregion")},PROPERTIES:{name:"PROPERTIES",value:a.instant("createbucketmodal.label.configureoptions")},PERMISSIONS:{name:"PERMISSIONS",value:a.instant("createbucketmodal.label.setpermissions")},REVIEW:{name:"REVIEW",value:a.instant("createbucketmodal.label.review")}},r.versioningEnabled=!0,r.docLink={versioning:S.getDocUrl(m.LEARN_MORE_LINKS.VERSIONING),bucketLogging:S.getDocUrl(m.LEARN_MORE_LINKS.LOGGING),bucketTagging:S.getDocUrl(m.LEARN_MORE_LINKS.TAGGING)},r.state=r.STEP.NAME_AND_REGION,r.headerTitle=a.instant("createbucketmodal.header.title"),r.createBucketValues={firstLoad:!0},r.createBucketValues.region=t.find(r.regions,function(e){return e.value===g.getCurrentRegion()});var B={getResponse:c.getNewBucketDefaultProperties()};r.createBucketProperties=t.cloneDeep(B),r.forCreateBucketModal=!0,r.defaultAcls=t.cloneDeep(m.BUCKET_PERMISSIONS.INITIALIZE_ACLS),r.currPermissions=t.cloneDeep(m.BUCKET_PERMISSIONS.INITIALIZE_ACLS),r.sourceBucketPermissions={grantees:{},aclGrants:{},owner:{}},r.isCreatingBucket=!1,r.propertyStatuses=[],r.isAddingAwsAccountAcl={flag:!1},function(){var e=new u(m.BUCKET_PERMISSIONS.GET_BUCKET_OWNER);o.getBucketOwner(e).then(function(n){h.log("getBucketOwner",1,e),r.currPermissions.ownerName=n.DisplayName,r.defaultAcls.userPermissions[0].detail=t.clone(n),r.currPermissions.userPermissions[0].detail=t.clone(n)}).catch(function(t){h.log("getBucketOwner",0,e),r.sourceBucketPermissions.owner.isError=!0,r.sourceBucketPermissions.owner.errorMessage=b.handleErrors(t)})}(),r.bucketNameValidationErrors=[],r.MODAL_TYPE=m.MODAL_TYPE,r.aclsSummaries=[{summaryTitle:a.instant("modal.acl.summary.users"),value:r.currPermissions.userPermissions.length},{summaryTitle:a.instant("modal.acl.summary.publicacls"),value:a.instant("modal.acl.summary.disabled")},{summaryTitle:a.instant("modal.acl.summary.systemacls"),value:a.instant("modal.acl.summary.disabled")}],r.isPublicAccessBlockAvailable=d.isFeatureEnabled(m.FAC.PUBLIC_ACCESS_BLOCK),r.publicAccess={defaultSettings:t.cloneDeep(m.BUCKET_PERMISSIONS.PUBLIC_ACCESS_BLOCK_DEFAULTS),currentSettings:t.cloneDeep(m.BUCKET_PERMISSIONS.PUBLIC_ACCESS_BLOCK_DEFAULTS)},r.publicAccessSettingsConfig=A.getSettingsDetailOptions(),r.permissionsSummaries=[{title:a.instant("modal.acl.summary.systemacls"),value:a.instant("modal.acl.summary.disabled")}],i(function(){e.element(document).find("#bucket-name input").focus()}),r.createBucket=function(e,t){b.analyticsTrackClick(m.ANALYTICS.END_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),r.isCreatingBucket=!0;var n=new u("CreateBucket","CreateBucketRequestReceived");h.log("CreateBucketRequestReceived",1,n,{bucketName:e,region:t.value});var i=r.createBucketProperties.getResponse.objectRetention.enabled;o.createBucket(n,e,t.value,i).then(function(){b.analyticsTrackClick(m.ANALYTICS.SUCCESS_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),l.evictLamb(),h.log("CreateBucketSuccess",1,n,{bucketName:e,region:t.value}),x(e,t.value).then(function(){r.closeCreateBucketModal()},function(){r.createS3BucketWarning=a.instant("createbucketmodal.errormsg",{bucketName:e})}).finally(function(){r.loadBuckets(n),r.onCreate&&r.onCreate(e)})}).catch(function(i){r.createS3BucketError=b.handleErrors(i),h.log("CreateBucketSuccess",0,n,{bucketName:e,region:t.value,errorMessage:i})}).finally(function(){r.isCreatingBucket=!1,r.createS3BucketError&&r.setState(r.STEP.REVIEW)})},r.createBucketNow=function(e,t){r.isCreatingBucket=!0,r.isBucketNameAvailable(e).then(function(){r.createBucket(e,t)}).catch(function(){r.isCreatingBucket=!1})},r.resetErrors=function(){r.createS3BucketError=void 0,r.createS3BucketWarning=null},r.closeCreateBucketModal=function(){r.isOpen.flag=!1,r.resetErrors(),r.createBucketValues.region=t.find(r.regions,function(e){return e.value===g.getCurrentRegion()}),r.createBucketValues.name="",r.createBucketValues.copySettingsSourceBucket=void 0,r.state=r.STEP.NAME_AND_REGION,r.createBucketProperties=t.cloneDeep(B),r.sourceBucketPermissions.aclGrants={},r.sourceBucketPermissions.grantees={},r.currPermissions.publicPermissions=t.cloneDeep(r.defaultAcls.publicPermissions),r.currPermissions.userPermissions=t.cloneDeep(r.defaultAcls.userPermissions),r.currPermissions.systemPermissions=t.cloneDeep(r.defaultAcls.systemPermissions),r.currPermissions.awsAccountPermissions=t.cloneDeep(r.defaultAcls.awsAccountPermissions),r.publicAccess.currentSettings=t.cloneDeep(r.publicAccess.defaultSettings),r.bucketNameValidationErrors=[],b.bodyFreezeScroll(!1)},r.goToPreviousState=function(){r.bucketNameValidationErrors=[],r.previousState()},r.isBucketNameAvailable=function(e){return o.headBucket(new u("checkBucketAvailability"),e).then(function(e){return r.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.access.error")],n.reject(!1)}).catch(function(e){return e.status===m.HTTP_STATUS_CODES.NOT_FOUND?(b.analyticsTrackClick(m.ANALYTICS.NAME_REGION_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),b.analyticsTrackView(m.ANALYTICS.SET_PROP_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),p.isRegionalFeatureEnabled(m.FAC.DEFAULT_ENCRYPTION,r.createBucketValues.region.value).then(function(e){r.enableDefaultEncryption=e}),n.resolve(!0)):(r.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.access.error")],n.reject(!1))})},r.generateSummary=function(){if(r.state===r.STEP.NAME_AND_REGION)r.checkingName=!0,r.isBucketNameAvailable(r.createBucketValues.name).then(function(){I(),r.nextState()}).finally(function(){r.checkingName=!1});else if(r.state===r.STEP.PROPERTIES){b.analyticsTrackClick(m.ANALYTICS.SET_PROP_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),b.analyticsTrackView(m.ANALYTICS.SET_PERM_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3);var e=[{name:a.instant("bucketproperties.versioning.label.versioning"),value:"versioning"},{name:a.instant("bucketproperties.logging.label.logging"),value:"logging"},{name:a.instant("bucketproperties.tagging.label.tagging"),value:"tagging"},{name:a.instant("bucketproperties.dataevents.label.dataevents"),value:"eventSelectors"},{name:a.instant("bucketproperties.defaultencryption.title"),value:"defaultEncryption"},{name:a.instant("createbucket.properties.cloudwatch.label.cloudwatchrequestmetrics"),value:"cloudwatch"}];d.isFeatureEnabled(m.FAC.OBJECT_RETENTION)&&e.push({name:a.instant("bucketproperties.objectretention.label"),value:"objectRetention"}),r.propertyStatuses=e.map(function(e){return j(e)}),r.nextState()}else r.state===r.STEP.PERMISSIONS&&(b.analyticsTrackClick(m.ANALYTICS.SET_PERM_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),b.analyticsTrackView(m.ANALYTICS.REVIEW_CREATE_BUCKET,m.ANALYTICS.CREATE_BUCKET_S3),!0===r.isAddingAwsAccountAcl.flag?r.isAddingAwsAccountAcl.warningMsg=a.instant("uploadmodal.awsaccounts.warningmsg"):(r.isAddingAwsAccountAcl.warningMsg=null,r.aclsSummaries[0].value=r.currPermissions.awsAccountPermissions.length+r.currPermissions.userPermissions.length,r.aclsSummaries[1].value=F(r.currPermissions.publicPermissions),r.aclsSummaries[2].value=F(r.currPermissions.systemPermissions),r.permissionsSummaries[0].value=F(r.currPermissions.systemPermissions),r.nextState()))},r.validateBucketName=function(){var e=[];b.isValidBucketName(r.createBucketValues.name,e)?D(r.createBucketValues.name)?r.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.exists.error")]:r.bucketNameValidationErrors=[]:r.bucketNameValidationErrors=e,t.isEmpty(r.bucketNameValidationErrors)&&r.resetErrors()};var F=function(e){return t.map(e,"permissions").filter(function(e){return e&&(e.READ||e.READ_ACP||e.WRITE||e.WRITE_ACP)}).length>0?a.instant("modal.acl.summary.enabled"):a.instant("modal.acl.summary.disabled")}}e.module("s3").directive("createBucketModal",[function(){return{restrict:"E",scope:{isOpen:"=",bucketList:"=",regions:"=",loadBuckets:"=",onCreate:"=?",disableRegionSelection:"<?"},template:n(500),controller:"CreateBucketController"}}]),e.module("s3").controller("CreateBucketController",["$q","$scope","$timeout","$translate","APIProxyService","BucketPropertiesService","BucketPropertiesUtilService","CachingService","ConsoleOperation","FAC","FACService","PermissionsUtilService","Region","S3Constants","SCLogService","UtilService","XMLParser","XmlBuilderService","AwsUrlsService","SharpieAPI","PublicAccessService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<modal id=create-bucket-modal class="create-bucket-modal large-modal" ng-class="{\'overflow-y-visible\': state===STEP.NAME_AND_REGION}" id=create-S3-bucket-modal is-open=isOpen steps=STEP state=state close-callback=closeCreateBucketModal header-title=headerTitle next-state=nextState previous-state=previousState set-state=setState> <modal-content> <div id=content class=create-bucket-modal-content> <div class=createbucketbodycontent ng-if="state === STEP.NAME_AND_REGION"> <p class=subheader translate=createbucketmodal.label.nameandregion></p> <p class=label translate=createbucketmodal.label.name></p> <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <div class=bucketname-and-region> <awsui-control-group> <span dom-region=validationMessage ng-if="bucketNameValidationErrors.length > 0"> <label ng-repeat="message in bucketNameValidationErrors">{{message}}</label><br> </span> <span dom-region=control> <awsui-textfield id=bucket-name class=create-bucket-modal-input autocomplete=true ng-keyup=validateBucketName() placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model=createBucketValues.name> </awsui-textfield> </span> </awsui-control-group> </div> <p class=label translate=createbucketmodal.label.region></p> <dropdown disabled=disableRegionSelection items=regions id=bucket-region selected-item=createBucketValues.region placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter=true></dropdown> <div class=modal-content-divider></div> <p class=subheader translate=createbucketmodal.label.copysettings></p> <bucket-selector class=bucket-selector enable-deselect=true get-source-bucket-properties=createBucketProperties.getResponse get-source-bucket-permissions=sourceBucketPermissions curr-bucket-permissions=currPermissions copy-settings-source-bucket=createBucketValues.copySettingsSourceBucket bucket-list=bucketList operation=operation default-acls=defaultAcls current-public-access-settings=publicAccess.currentSettings default-public-access-settings=publicAccess.defaultSettings></bucket-selector> </div> <div class=createbucketproperites-container ng-if="state === STEP.PROPERTIES"> <div class="subheader wide-subheader" translate=createbucketmodal.label.properties></div> <div class=properties-section> <bucket-properties-section tags=createBucketProperties.getResponse.tagging.tags versioning-enabled=createBucketProperties.getResponse.versioning.enabled object-retention=createBucketProperties.getResponse.objectRetention server-access-logging-config=createBucketProperties.getResponse.logging cloud-trail-config=createBucketProperties.getResponse.eventSelectors encryption-config=createBucketProperties.getResponse.defaultEncryption bucket-name=createBucketValues.name region=createBucketValues.region.id bucket-list=bucketList></bucket-properties-section> </div> <div class="subheader wide-subheader" translate=createbucketmodal.label.management></div> <div class=properties-section> <bucket-management-section cloud-watch-enabled=createBucketProperties.getResponse.cloudwatch.enabled></bucket-management-section> </div> </div> <div ng-if="state === STEP.PERMISSIONS" class=createbucketpermissionsstep> <div ng-if=isPublicAccessBlockAvailable> <div class=permissions-note translate=createbucketmodal.permissions.note></div> <bucket-public-access-section mode=bucket public-access-settings=publicAccess.currentSettings></bucket-public-access-section> <modal-system-permissions system-permissions=currPermissions.systemPermissions has-public-access-block></modal-system-permissions> </div> <div ng-if=!isPublicAccessBlockAvailable> <modal-permissions public-permissions=currPermissions.publicPermissions user-permissions=currPermissions.userPermissions aws-account-permissions=currPermissions.awsAccountPermissions is-adding-account=isAddingAwsAccountAcl system-permissions=currPermissions.systemPermissions show-system-permissions=true modal-type=MODAL_TYPE.CREATE_BUCKET></modal-permissions> </div> </div> <div ng-if="state === STEP.REVIEW" class=createbucketbodycontent> <table id=review-table class=review-table> <tr> <td class=review-subheader translate=createbucketmodal.label.nameandregion></td> <td class=edit-button> <awsui-button class=button-in-darkbg class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link ng-click=setState(STEP.NAME_AND_REGION)> </awsui-button> </td> </tr> </table> <table class=details-table> <tr> <td class=review-nameregion><span class=review-detail-title translate=createbucketmodal.label.name></span><span class=review-detail-content> {{createBucketValues.name}}</span></td> <td><span class=review-detail-title translate=createbucketmodal.label.region></span><span class=review-detail-content> {{createBucketValues.region.text}}</span></td> </tr> </table> <table class=review-table> <tr> <td class=review-subheader translate=createbucketmodal.label.options></td> <td class=edit-button> <awsui-button class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link click=setState(STEP.PROPERTIES)> </awsui-button> </td> </tr> </table> <table class=details-table> <tr ng-repeat="property in propertyStatuses"> <td class=review-detail-title>{{property.name}}</td> <td class=review-detail-content>{{property.status}}</td> </tr> </table> <table class=review-table> <tr> <td class=review-subheader translate=createbucketmodal.label.permissions></td> <td class=edit-button> <awsui-button class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link click=setState(STEP.PERMISSIONS)> </awsui-button> </td> </tr> </table> <div ng-if=isPublicAccessBlockAvailable class=review-detail-content> <checkbox-tree dark-mode=true is-editing=false checkbox-config=publicAccessSettingsConfig settings-data=publicAccess.currentSettings></checkbox-tree> </div> <table class=details-table> <tr ng-if=!isPublicAccessBlockAvailable ng-repeat="acl in aclsSummaries"> <td class=review-detail-title>{{acl.summaryTitle}}</td> <td class=review-detail-content>{{acl.value}}</td> </tr> <tr ng-if=isPublicAccessBlockAvailable ng-repeat="setting in permissionsSummaries"> <td class=review-detail-title>{{setting.title}}</td> <td class=review-detail-content>{{setting.value}}</td> </tr> </table> <awsui-alert visible=createS3BucketWarning class="block small-top-margin" type=warning dismissible=false header="{{ \'warning.header\' | translate }}"> {{ createS3BucketWarning }} </awsui-alert> <awsui-alert visible=createS3BucketError class="block small-top-margin" type=error dismissible=false header="{{ \'createbucketmodal.error.header\' | translate }}"> {{ createS3BucketError }} </awsui-alert> </div> </div> </modal-content> <modal-footer> <div class=create-bucket-modal-footer> <awsui-button id=next ng-if="state !== STEP.REVIEW" loading=checkingName variant=primary text="{{ \'createbucketmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click=generateSummary() data-disabled="!createBucketValues.name || bucketNameValidationErrors.length > 0 || !createBucketValues.region"> </awsui-button> <awsui-button id=create-primary ng-if="state === STEP.REVIEW" variant=primary text="{{ \'createbucketmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click="createBucket(createBucketValues.name, createBucketValues.region)" loading=isCreatingBucket data-disabled="!createBucketValues.name || !createBucketValues.region || createS3BucketWarning"> </awsui-button> <awsui-button id=cancel text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant=normal ng-if="state === STEP.NAME_AND_REGION" class=awsui-util-f-r click=closeCreateBucketModal()> </awsui-button> <awsui-button id=previous text="{{ \'createbucketmodal.footer.previous\' | translate }}" variant=normal ng-if="state !== STEP.NAME_AND_REGION" class=awsui-util-f-r click=goToPreviousState() data-disabled=createS3BucketWarning> </awsui-button> <awsui-button id=create-secondary ng-if="state === STEP.NAME_AND_REGION" variant=normal text="{{ \'createbucketmodal.footer.createnow\' | translate }}" class=awsui-util-f-l click="createBucketNow(createBucketValues.name, createBucketValues.region)" loading=isCreatingBucket data-disabled="createS3BucketError || !createBucketValues.name || !createBucketValues.region || bucketNameValidationErrors.length > 0 "> </awsui-button> </div> </modal-footer> </modal> '},function(e,t,n){"use strict";(function(e){e.module("s3").directive("learnMoreLink",[function(){return{scope:{href:"@",light:"<"},template:n(502)}}])}).call(t,n(0))},function(e,t){e.exports="<external-link light=light href={{href}} text=\"{{ 'learn.more' | translate }}\"></external-link>"},function(e,t,n){"use strict";(function(e){e.module("s3").directive("externalLink",[function(){return{scope:{href:"@",text:"@",light:"<"},transclude:!0,template:n(504)}}])}).call(t,n(0))},function(e,t){e.exports='<a class="awsui-hover-child-icons external-link" ng-class="{\'external-link--light\': light}" ng-href={{href}} target=_blank><span ng-transclude>{{text}}</span>&nbsp;<span class="awsui-icon awsui-icon-link external-link" ng-class="{\'awsui-icon-link-light\': light}"></span></a>'},function(e,t,n){"use strict";(function(e){!function(){function t(e,t,n,r,i){function a(e,t,n,r,i,a,o,s){return{id:e,name:t,designedFor:n,azs:r,minStorageDuration:i,minBillableObjectSize:a,autoTiering:o,retrievalFees:s}}var o=this;o.deepArchiveFacPrefix=o.deepArchiveFacPrefix||"",o.docsUrls={learnMore:i.getDocUrl(n.LEARN_MORE_LINKS.STORAGE_CLASS_INTRO),pricing:i.getMarketingUrl(n.PRICING_LINKS.S3)},o.headers=[t.instant("storageclass.selector.header.storageclass"),t.instant("storageclass.selector.header.designedfor"),t.instant("storageclass.selector.header.azs"),t.instant("storageclass.selector.header.minduration"),t.instant("storageclass.selector.header.minsize"),t.instant("storageclass.selector.header.monitoring"),t.instant("storageclass.selector.header.fees")],o.availableStorageClasses=[],o.availableStorageClasses.push(a("STANDARD",t.instant("storageclass.selector.standard.name"),t.instant("storageclass.selector.standard.designedfor"),t.instant("storageclass.selector.3azs"),"-","-","-","-")),r.isFeatureEnabled(n.FAC.ISIDORE)&&o.availableStorageClasses.push(a("INTELLIGENT_TIERING",t.instant("storageclass.selector.isidore.name"),t.instant("storageclass.selector.isidore.designedfor"),t.instant("storageclass.selector.3azs"),t.instant("storageclass.selector.30days"),"-",t.instant("storageclass.selector.perobjectfee"),"-")),o.availableStorageClasses.push(a("STANDARD_IA",t.instant("storageclass.selector.standardia.name"),t.instant("storageclass.selector.standardia.designedfor"),t.instant("storageclass.selector.3azs"),t.instant("storageclass.selector.30days"),t.instant("storageclass.selector.object.size.128kb"),"-",t.instant("storageclass.selector.pergbfee"))),o.availableStorageClasses.push(a("ONEZONE_IA",t.instant("storageclass.selector.onezoneia.name"),t.instant("storageclass.selector.onezoneia.designedfor"),t.instant("storageclass.selector.1azs"),t.instant("storageclass.selector.30days"),t.instant("storageclass.selector.object.size.128kb"),"-",t.instant("storageclass.selector.pergbfee"))),r.isFeatureEnabled(n.FAC.GLACIER)&&o.availableStorageClasses.push(a("GLACIER",t.instant("storageclass.selector.glacier.name"),t.instant("storageclass.selector.glacier.designedfor"),t.instant("storageclass.selector.3azs"),t.instant("storageclass.selector.90days"),"-","-",t.instant("storageclass.selector.pergbfee"))),r.isFeatureEnabled(o.deepArchiveFacPrefix+n.FAC.DEEP_ARCHIVE)&&o.availableStorageClasses.push(a("DEEP_ARCHIVE",t.instant("storageclass.selector.deeparchive.name"),t.instant("storageclass.selector.deeparchive.designedfor"),t.instant("storageclass.selector.3azs"),t.instant("storageclass.selector.180days"),"-","-",t.instant("storageclass.selector.pergbfee"))),r.isFeatureEnabled(n.FAC.S3_RRS)&&o.availableStorageClasses.push(a("REDUCED_REDUNDANCY",t.instant("storageclass.selector.rr.name"),t.instant("storageclass.selector.rr.designedfor"),t.instant("storageclass.selector.3azs"),"-","-","-","-")),o.selectStorageClass=function(e){o.storageclassvalue=e.id,o.onSelectStorageClass(o.storageclassvalue)}}e.module("s3").directive("storageClassTable",function(){return{restrict:"E",scope:{storageclassvalue:"<",onSelectStorageClass:"<",theme:"@",deepArchiveFacPrefix:"@?"},template:n(506),controllerAs:"scs",transclude:!0,bindToController:!0,controller:"StorageClassController"}}),e.module("s3").controller("StorageClassController",["$scope","$translate","S3Constants","FAC","AwsUrlsService",t])}()}).call(t,n(0))},function(e,t){e.exports='<div class=storage-class-container> <p class=storage-class-containe__description> {{\'storageclass.selector.description\' | translate}} <external-link href={{scs.docsUrls.learnMore}} text="{{\'storageclass.selector.description_learnmore\' | translate}}" light="scs.theme === \'dark\'"></external-link> {{\'storageclass.selector.description_orsee\' | translate}} <external-link text="{{\'storageclass.selector.description_s3pricing\' | translate}}" href={{scs.docsUrls.pricing}} light="scs.theme === \'dark\'"></external-link> </p> <div> <awsui-radio-group class=radio-group--unstyled ng-model=scs.storageclassvalue> <table class=storage-class-table> <thead> <tr class=header> <th width=40px></th> <th ng-repeat="header in scs.headers">{{header}}</th> </tr> </thead> <tr ng-repeat="storageclass in scs.availableStorageClasses" ng-click=scs.selectStorageClass(storageclass) unselectable=on class=storage-class-row ng-class="{\'storage-class-row-selected\': scs.storageclassvalue === storageclass.id}"> <td class=td-radio-btn width=40px> <awsui-radio-button class="radio-button radio-button--small" value={{storageclass.id}} data-e2e-id=sct-radio-{{storageclass.id}} ng-model=scs.storageclassvalue></awsui-radio-button> </td> <td width=135px>{{storageclass.name}}</td> <td width=210px>{{storageclass.designedFor}}</td> <td width=80px>{{storageclass.azs}}</td> <td width=85px>{{storageclass.minStorageDuration}}</td> <td width=80px>{{storageclass.minBillableObjectSize}}</td> <td width=100px>{{storageclass.autoTiering}}</td> <td width=100px>{{storageclass.retrievalFees}}</td> </tr> </table> <div style=width:1000px> <awsui-alert class="modal-warning-space modal-warning alert-exclamation-triangle" type=warning visible="scs.storageclassvalue === \'GLACIER\'" type=warning> <p style=color:#000;font-size:14px translate=storageclass.selector.glacier.warning></p> </awsui-alert> <awsui-alert class="modal-warning-space modal-warning alert-exclamation-triangle" type=warning visible="scs.storageclassvalue === \'DEEP_ARCHIVE\'" type=warning> <p style=color:#000;font-size:14px translate=storageclass.selector.glacierdeeparchive.warning></p> </awsui-alert> <awsui-alert class="modal-warning-space modal-warning" visible="scs.storageclassvalue === \'REDUCED_REDUNDANCY\'" type=warning> <span class="alert-exclamation-triangle awsui-alert-icon awsui-icon awsui-icon-big"></span> <h3 class=warning-title translate=storageclass.selector.reduced_redundancy.warning.header></h3> <p class=warning-message translate=storageclass.selector.reduced_redundancy.warning.msg></p> </awsui-alert> </div> </awsui-radio-group> </div> </div>'},function(e,t,n){"use strict";(function(e){function t(e,t){function n(t){var n=e.onKeyboardScroll;if([r,i].includes(t.keyCode)){switch(t.preventDefault(),t.keyCode){case r:n({step:1});break;case i:n({step:-1})}e.$apply()}}var r=38,i=40;this.$onDestroy=function(){t.off("keydown",e.keydownHandler)},e.keydownHandler=n,t.on("keydown",e.keydownHandler)}e.module("s3").directive("onKeyboardScroll",[function(){return{restrict:"A",scope:{onKeyboardScroll:"&"},controller:"OnKeyboardScrollController"}}]),e.module("s3").controller("OnKeyboardScrollController",["$scope","$element",t])}).call(t,n(0))},function(e,t,n){"use strict";(function(e){function t(e,t,n){e.docLink=t.getDocUrl(n.LEARN_MORE_LINKS.VERSIONING)}e.module("s3").directive("bucketPropertiesVersioning",[function(){return{restrict:"E",scope:{versioningEnabled:"="},template:n(509),controller:"BucketPropertiesVersioningController"}}]),e.module("s3").controller("BucketPropertiesVersioningController",["$scope","AwsUrlsService","S3Constants",t])}).call(t,n(0))},function(e,t){e.exports="<p class=label translate=bucketproperties.versioning.label.versioning></p> <awsui-checkbox class=mt-2 ng-model=versioningEnabled data-e2e-id=bucketVersioningCheckbox> <span class=bucket-property-description translate=createbucket.properties.versioning.summary></span> <span> <learn-more-link light=true href={{docLink}}></learn-more-link></span> </awsui-checkbox>"},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i){e.docLink=n.getDocUrl(r.LEARN_MORE_LINKS.ENCRYPTION),e.encryptionConstants=r.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION,e.encryptionOptions=[{apiValue:e.encryptionConstants.API_PARAMS.AES256,value:e.encryptionConstants.AES256,description:t.instant("bucketproperties.defaultencryption.aes256description"),text:e.encryptionConstants.AES256}],i.isFeatureEnabled(r.FAC.KMS)&&e.encryptionOptions.push({apiValue:e.encryptionConstants.API_PARAMS.AWSKMS,value:e.encryptionConstants.AWSKMS,description:t.instant("bucketproperties.defaultencryption.kmsdescription"),text:e.encryptionConstants.AWSKMS}),e.defaultSelectedEncryption=e.encryptionConstants.AES256,e.KMSValue=e.encryptionConstants.AWSKMS}e.module("s3").directive("bucketPropertiesEncryption",[function(){return{restrict:"E",scope:{encryptionConfig:"=?",kmsKeys:"<"},template:n(511),controller:"BucketPropertiesEncryptionController"}}]),e.module("s3").controller("BucketPropertiesEncryptionController",["$scope","$translate","AwsUrlsService","S3Constants","FAC",t])}).call(t,n(0))},function(e,t){e.exports='<p class=label translate=bucketproperties.defaultencryption.title></p> <awsui-checkbox class=mt-2 ng-model=encryptionConfig.enabled data-e2e-id=encryptionEnabledCheckbox> <span class=bucket-property-description translate=createbucket.properties.encryption.summary></span> <span> <learn-more-link light=true href={{docLink}}></learn-more-link></span> </awsui-checkbox> <div ng-if=encryptionConfig.enabled class=properties-section> <awsui-radio-group ng-model=encryptionConfig.encryption> <div ng-repeat="encryptionOption in encryptionOptions"> <awsui-radio-button class=encryption-radio-btn value={{encryptionOption.value}} data-e2e-id={{encryptionOption.value}}> <span class="radio-button-label ml-2"> <span>{{encryptionOption.text}}</span> <span class=radio-button-label__description>{{encryptionOption.description}}</span> </span> </awsui-radio-button> <div ng-if="encryptionOption.value === KMSValue && encryptionConfig.encryption === KMSValue" class=kms-arn-selector fac-id=s3-kms> <dropdown id=default-encryption-kms-dropdown items=kmsKeys placeholder="{{\'objectproperties.placeholder.kmskeys\' | translate}}" selected-item=encryptionConfig.kmsId filter=true dropdown-disabled=true data-e2e-id=kmsKeysDropdown></dropdown> <awsui-textfield class="custom-kms-arn mt-3" ng-if="encryptionConfig.kmsId.value === encryptionConstants.CUSTOM_ARN" ng-model=encryptionConfig.customKMSARN data-e2e-id=customKmsArnInput></awsui-textfield> </div> </div> </awsui-radio-group> </div>'},function(e,t,n){"use strict";(function(e){function t(e,t,n){e.docLink=t.getDocUrl(n.LEARN_MORE_LINKS.LOGGING)}e.module("s3").directive("bucketPropertiesServerAccessLogging",[function(){return{restrict:"E",scope:{loggingConfig:"=",loggingBucketOptions:"<",createdBucketName:"<"},template:n(513),controller:"BucketPropertiesServerAccessLoggingController"}}]),e.module("s3").controller("BucketPropertiesServerAccessLoggingController",["$scope","AwsUrlsService","S3Constants",t])}).call(t,n(0))},function(e,t){e.exports='<p class=label translate=bucketproperties.logging.label.logging></p> <awsui-checkbox class=mt-2 ng-model=loggingConfig.enabled data-e2e-id=serverAccessLoggingEnabledCheckbox> <span class=bucket-property-description translate=createbucket.properties.logging.summary></span> <span> <learn-more-link light=true href={{docLink}}></learn-more-link></span> </awsui-checkbox> <div class=properties-section ng-if=loggingConfig.enabled> <div> <awsui-alert type=info class=info-alert ng-if="createdBucketName === loggingConfig.targetBucket"> <span translate>createbucket.properties.logging.alert</span> </awsui-alert> </div> <div> <label class="label pl-0" translate=bucketproperties.logging.label.targetbucket></label> </div> <div> <awsui-select class=mt-2 items=loggingBucketOptions placeholder="{{\'bucketproperties.logging.placeholder.selectbucket\' | translate}}" ng-model=loggingConfig.targetBucket></awsui-select> </div> <div class=mt-3> <label class="label pl-0" translate=bucketproperties.logging.label.targetprefix></label> </div> <div> <input type=text class="bucket-property-input mt-2" ng-model=loggingConfig.targetPrefix placeholder="{{\'bucketproperties.logging.placeholder.entertargetprefix\' | translate}}"> </div> </div>'},function(e,t,n){"use strict";(function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,n,i){function a(e){return t.isEmpty(e.Key)&&t.isEmpty(e.Value)}function o(){0===e.tags.length&&e.addTag()}var s={Key:"",Value:""};e.docLink=n.getDocUrl(i.LEARN_MORE_LINKS.TAGGING),e.removeTag=function(n){e.tags=t.filter(e.tags,function(e,t){return t!==n}),o()},e.addTag=function(){e.tags=[].concat(r(e.tags),[t.clone(s)])},e.showDeleteButton=function(){var t=e.tags;return t.length>1||!a(t[0])},e.disableAddTagButton=function(){return a(t.last(e.tags))},o()}e.module("s3").directive("bucketPropertiesTagging",[function(){return{restrict:"E",scope:{tags:"="},template:n(515),controller:"BucketPropertiesTaggingController"}}]),e.module("s3").controller("BucketPropertiesTaggingController",["$scope","AwsUrlsService","S3Constants",i])}).call(t,n(0),n(2))},function(e,t){e.exports='<p class=label translate=bucketproperties.tagging.label.tags></p> <div class=mt-2> <span class="bucket-property-description ml-0" translate=createbucket.properties.tagging.summary></span> <learn-more-link light=true href={{docLink}}></learn-more-link> </div> <div class=tags-container> <div ng-repeat="tag in tags" class="tag-entry mt-3"> <input type=text ng-model=tag.Key class=tag-input placeholder="{{\'bucketproperties.tagging.label.key\' | translate}}" data-e2e-id="{{\'tagKeyInput\' + $index}}"> <input type=text ng-model=tag.Value class="tag-input ml-3" placeholder="{{\'bucketproperties.tagging.label.value\' | translate}}" data-e2e-id="{{\'tagValueInput\' + $index}}"> <awsui-button ng-if=showDeleteButton() class=remove-tag variant=standalone-icon ng-click=removeTag($index) data-e2e-id="{{\'removeTagButton\' + $index}}"> <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-click=removeTag($index) data-e2e-id="{{\'removeTagButton\' + $index}}"></span> </awsui-button> </div> <div class=mt-3> <awsui-button id=add-bucket-tag ng-click=addTag() class=bucket-properties-buttons text="{{\'bucketproperties.tagging.label.addanother\' | translate}}" icon=plus data-disabled=disableAddTagButton() data-e2e-id=addTagButton></awsui-button> </div> </div>'},function(e,t,n){"use strict";(function(e){function t(e,t,n){e.docLink=t.getDocUrl(n.LEARN_MORE_LINKS.CLOUDTRAIL_NEW_LINK),e.pricingLink=t.getMarketingUrl(n.PRICING_LINKS.CLOUDTRAIL),e.cloudtrailLink=t.getConsoleServiceUrl(n.AWS_SERVICE_LINKS.CLOUDTRAIL,"us-east-1","#/configuration")}e.module("s3").directive("bucketPropertiesCloudTrail",[function(){return{restrict:"E",scope:{cloudTrailConfig:"="},template:n(517),controller:"BucketPropertiesCloudTrailController"}}]),e.module("s3").controller("BucketPropertiesCloudTrailController",["$scope","AwsUrlsService","S3Constants",t])}).call(t,n(0))},function(e,t){e.exports='<p class=label translate=bucketproperties.dataevents.label.dataevents></p> <awsui-checkbox class=mt-2 ng-model=cloudTrailConfig.enabled data-e2e-id=cloudTrailEnableCheckbox> <span class=bucket-property-description> <span translate=createbucket.properties.cloudtrail.summarystart></span> <external-link href={{pricingLink}} light=true text="{{\'createbucket.properties.cloudtrail.link.pricing\' | translate}}" class=nowrap-text></external-link> <span translate=createbucket.properties.cloudtrail.summaryor></span> <learn-more-link href={{docLink}} light=true class="nowrap-text lower-case"></learn-more-link> </span> </awsui-checkbox> <div ng-if=cloudTrailConfig.enabled class=properties-section> <p class=label translate=createbucket.properties.cloudtrail.label.trail></p> <awsui-select id=trail-dropdown class=event-selectors-dropdown items=cloudTrailConfig.trailNames placeholder="{{\'createbucket.properties.cloudtrail.placeholder\' | translate}}" ng-model=cloudTrailConfig.targetTrail data-e2e-id=cloudTrailDropdown></awsui-select> <div class=mt-2> <span class="bucket-property-description ml-0" translate=createbucket.properties.cloudtrail.traildescription></span> <external-link light=true href={{cloudtrailLink}} text="{{\'createbucket.properties.cloudtrail.link.awscloudtrail\' | translate}}"></external-link> </div> <div class=mt-3> <p class="label bucket-property" translate=bucketproperties.dataevents.label.events></p> <div class="h-container mt-2"> <awsui-checkbox ng-model=cloudTrailConfig.access.read data-e2e-id=readAccessCheckbox> <span class=bucket-property-description translate=createbucket.properties.cloudtrail.access.read></span> </awsui-checkbox> <awsui-checkbox class=ml-4 ng-model=cloudTrailConfig.access.write data-e2e-id=writeAccessCheckbox> <span class=bucket-property-description translate=createbucket.properties.cloudtrail.access.write></span> </awsui-checkbox> </div> </div> </div>'},function(e,t,n){"use strict";(function(e){function t(e,t,n,r){e.crrWithObjectLockEnabled=n.isFeatureEnabled(r.FAC.CRR_WITH_OBJECT_LOCK),e.docLink=t.getDocUrl(r.LEARN_MORE_LINKS.OBJECT_RETENTION)}e.module("s3").directive("bucketPropertiesAdvanced",[function(){return{restrict:"E",scope:{versioningEnabled:"<",objectRetention:"="},template:n(519),controller:"BucketPropertiesAdvancedController"}}]),e.module("s3").controller("BucketPropertiesAdvancedController",["$scope","AwsUrlsService","FAC","S3Constants",t])}).call(t,n(0))},function(e,t){e.exports='<awsui-expandable-section id=expand-object-retention header="{{ \'bucketproperties.advancedsettings.label\' | translate }}"> <p class=label translate=bucketproperties.objectretention.label></p> <awsui-checkbox class=mt-2 data-disabled=!versioningEnabled ng-model=objectRetention.enabled data-e2e-id=bucketObjectRetentionCheckbox> <span class=bucket-property-description translate=bucketproperties.objectretention.enable.label></span> <span> <learn-more-link light=true href={{docLink}}></learn-more-link></span><br> <span class="ml-2 bucket-property-subdescription" ng-if=!versioningEnabled translate=bucketproperties.objectretention.versioningshouldbeenabled.label></span> </awsui-checkbox> <div ng-if="objectRetention.enabled && versioningEnabled"> <awsui-alert header="{{ \'bucketproperties.objectretention.alert.permanentlyenabled.title\' | translate }}" type=warning> <span translate>bucketproperties.objectretention.alert.permanentlyenabled.text</span> <span> </span> <learn-more-link light=true href={{docLink}}></learn-more-link> </awsui-alert> <awsui-alert ng-if=!crrWithObjectLockEnabled header="{{ \'bucketproperties.objectretention.alert.crrunsupported.title\' | translate }}" type=warning> <span translate>bucketproperties.objectretention.alert.crrunsupported.text</span> <span> </span> <learn-more-link light=true href={{docLink}}></learn-more-link> </awsui-alert> </div> </awsui-expandable-section> '},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i,a,o,s,c,l){e.encryptionKmsKeys=[],e.loggingBucketOptions=function(e,n,r){var i=[{value:n,text:n}];return e.forEach(function(e){t.getBucketLocation(e.Name).then(function(t){r===t&&i.push({value:e.Name,text:e.Name})})}),i}(e.bucketList,e.bucketName,e.region),function(){var o=new a("RefreshTrails");t.describeTrails(o,e.region).then(function(t){e.cloudTrailConfig.trailNames.length=0,e.cloudTrailConfig.trailRegionMapping={},i.populateTrailNames(t,e.cloudTrailConfig.trailNames,e.cloudTrailConfig.trailRegionMapping),r.log("DescribeTrails",1,o)}).catch(function(t){var i=n.handleErrors(t);r.log("DescribeTrails",0,o,{error:i}),e.cloudTrailsErrormessage=i})}(),c.isFeatureEnabled(o.FAC.KMS)&&function(){var t=new a(o.OPERATION_NAME.GET_KMS_DEFAULT_ENCRYPTION),n={region:e.region},r=e.bucketName;return s.getKMSKeysByArn(t,r,o.OBJECT_SSE.CUSTOM_ARN,n)}().then(function(t){e.encryptionKmsKeys=t}).catch(function(t){e.sseError=t}),l.isRegionalFeatureEnabled(o.FAC.DEFAULT_ENCRYPTION,e.region).then(function(t){e.enableDefaultEncryption=t})}e.module("s3").directive("bucketPropertiesSection",[function(){return{restrict:"E",scope:{bucketName:"<",region:"<",bucketList:"<",tags:"=",versioningEnabled:"=",objectRetention:"=",serverAccessLoggingConfig:"=",cloudTrailConfig:"=",encryptionConfig:"="},template:n(521),controller:"BucketPropertiesSectionController"}}]),e.module("s3").controller("BucketPropertiesSectionController",["$scope","BucketPropertiesService","UtilService","SCLogService","BucketPropertiesUtilService","ConsoleOperation","S3Constants","KMSPropertiesService","FAC","FACService",t])}).call(t,n(0))},function(e,t){e.exports='<div class=bucket-property> <bucket-properties-versioning versioning-enabled=versioningEnabled></bucket-properties-versioning> </div> <div class=bucket-property> <bucket-properties-server-access-logging logging-config=serverAccessLoggingConfig logging-bucket-options=loggingBucketOptions created-bucket-name=bucketName></bucket-properties-server-access-logging> </div> <div class="bucket-property mb-2"> <bucket-properties-tagging tags=tags></bucket-properties-tagging> </div> <div class=bucket-property> <bucket-properties-cloud-trail cloud-trail-config=cloudTrailConfig></bucket-properties-cloud-trail> </div> <div class=bucket-property> <bucket-properties-encryption encryption-config=encryptionConfig kms-keys=encryptionKmsKeys ng-if=enableDefaultEncryption></bucket-properties-encryption> </div> <div class="bucket-property dark" fac-id=s3-sharpie> <bucket-properties-advanced versioning-enabled=versioningEnabled object-retention=objectRetention></bucket-properties-advanced> </div> '},function(e,t,n){"use strict";(function(e){function t(e,t,n){e.docLink=t.getDocUrl(n.LEARN_MORE_LINKS.CLOUDWATCH),e.pricingLink=t.getMarketingUrl(n.PRICING_LINKS.CLOUDWATCH)}e.module("s3").directive("bucketManagementCloudWatch",[function(){return{restrict:"E",scope:{cloudWatchEnabled:"="},template:n(523),controller:"BucketManagementCloudWatchController"}}]),e.module("s3").controller("BucketManagementCloudWatchController",["$scope","AwsUrlsService","S3Constants",t])}).call(t,n(0))},function(e,t){e.exports='<p class=label translate=createbucket.properties.cloudwatch.label.cloudwatchrequestmetrics></p> <awsui-checkbox class=mt-2 ng-model=cloudWatchEnabled data-e2e-id=cloudWatchEnabledCheckbox> <span class=bucket-property-description> <span translate=createbucket.properties.cloudwatch.summarystart></span> <external-link href={{pricingLink}} light=true text="{{\'createbucket.properties.cloudwatch.link.pricing\' | translate}}" class=nowrap-text></external-link> <span translate=createbucket.properties.cloudwatch.summaryor></span> <learn-more-link href={{docLink}} light=true class="nowrap-text lower-case"></learn-more-link> </span> </awsui-checkbox>'},function(e,t,n){"use strict";(function(e){e.module("s3").directive("bucketManagementSection",[function(){return{restrict:"E",scope:{cloudWatchEnabled:"="},template:n(525)}}])}).call(t,n(0))},function(e,t){e.exports="<div class=bucket-property> <bucket-management-cloud-watch cloud-watch-enabled=cloudWatchEnabled></bucket-management-cloud-watch> </div> "},function(e,t,n){"use strict";(function(e,t){e.module("s3").factory("APIProxyService",["CachingService","FAC","Md5GenerationService","SCLogService","S3Service","S3WrapperService","S3Constants","UtilService","KMSService","GlacierService","$q","$window","UUIDService","$cookies",function(n,r,i,a,o,s,c,l,u,d,p,f,g,m){function h(e,t,n,r){return X(e,t,{path:t+"/"+n,params:{versionId:r}}).then(function(t){return J(o.getObjectMetadata,t,c.PROXY_API_NAMES.S3.GET_OBJECT_METADATA,e)})}function b(e){function r(t,n){return le.makeProxyRequest(t,n,c.PROXY_API_NAMES.S3.LAMB,e)}if(arguments.length<=1||void 0===arguments[1]||arguments[1]){var i=n.getLamb();if(i)return p.when(i)}var a=l.getRegionOrder();return t.remove(a,function(e){return e===c.DEFAULT_REGION[l.getCloudSystem()]}),a.unshift(c.DEFAULT_REGION[l.getCloudSystem()]),s.lambWithFallback(a,r).then(function(e){var r=t.get(e,"response.ListAllMyBucketsResult.Buckets");return r.Bucket=N(r.Bucket),n.putLamb(e),e})}function v(e){var r=n.getLamb();return r?p.when(r.response.ListAllMyBucketsResult.Owner):J(o.listAllMyBuckets,{region:c.DEFAULT_REGION[l.getCloudSystem()]},c.PROXY_API_NAMES.S3.LAMB,e).then(function(e){return t.get(e,"response.ListAllMyBucketsResult.Owner")})}function E(e,t,n){return n=n||l.getDefaultRegion(),J(o.headBucket,{path:t,region:n},c.PROXY_API_NAMES.S3.HEAD_BUCKET,e)}function S(e){var t={path:e.initialBucket};return X(e,e.initialBucket,t).then(function(t){return J(o.deleteBucket,t,e.name,e)})}function y(e,t,n,r,i){var a=p.defer();n=n||"";var s={path:t+"/"+n+r+"/"};return i&&(s.headers=i),X(e,t,s).then(function(t){J(o.putObject,t,c.PROXY_API_NAMES.S3.PUT_OBJECT,e).then(function(e){a.resolve(e)}).catch(function(e){a.reject(e)})}).catch(function(e){a.reject(e)}),a.promise}function A(e,t,n){var r=p.defer();return X(e,t,{path:t+"/"+n}).then(function(t){J(o.headObject,t,c.PROXY_API_NAMES.S3.HEAD_OBJECT,e).then(function(e){r.resolve(e)}).catch(function(e){r.reject(e)})}).catch(function(e){r.reject(e)}),r.promise}function C(e,t,n,r){var i;i="us-east-1"===n?"":'<CreateBucketConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><LocationConstraint>'+n+"</LocationConstraint></CreateBucketConfiguration>";var a={content:i,path:t,region:n};return r&&(a.headers={"x-amz-bucket-object-lock-enabled":"true"}),J(o.createBucket,a,c.PROXY_API_NAMES.S3.CREATE_BUCKET,e).then(function(e){return e}).catch(function(e){return e.response&&e.response.Error&&e.response.Error.Message?p.reject(e.response.Error.Message):p.reject(e)})}function _(e,t){var n={path:t.bucket,params:{prefix:t.prefix,"max-keys":t.maxKeys,"list-type":2,"fetch-owner":!0,delimiter:t.delimiter},cacheAllowed:t.cacheAllowed};return t.marker&&""!==t.marker&&(n.params["continuation-token"]=t.marker),r.isFeatureEnabled("s3-log-response-data")&&(n.details={shouldLogResponseData:!0}),X(e,t.bucket,n).then(function(t){return te(e,t)})}function w(e,t){var n=p.defer(),r={path:t.bucket,params:{delimiter:t.delimiter,"key-marker":t.keyMarker,"max-keys":t.maxKeys,prefix:t.prefix,"version-id-marker":t.versionIdMarker},cacheAllowed:t.cacheAllowed};return X(e,t.bucket,r).then(function(t){J(o.listVersions,t,c.PROXY_API_NAMES.S3.LIST_VERSION,e).then(function(e){n.resolve(e)}).catch(function(e){n.reject(e)})}).catch(function(e){n.reject(e)}),n.promise}function T(e,t,n,r){return X(e,t,{path:t+"/"+n,params:{versionId:r}}).then(function(t){return ne(e,t)})}function R(e,t,n){var r=p.defer();return X(e,t,{path:t,content:n}).then(function(t){J(o.tagQuery,t,c.PROXY_API_NAMES.S3.TAG_QUERY,e).then(function(e){return r.resolve(e)},function(e){return r.reject(e)})}),r.promise}function O(e,n,r){var i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],a=p.defer(),o={path:n+"/"+r};return t.isEmpty(i)||(o.params={versionId:i}),X(e,n,o).then(function(t){re(e,t).then(function(e){a.resolve(e)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise}function k(e,n,r,i){var a=arguments.length<=4||void 0===arguments[4]?null:arguments[4],s=p.defer(),l={path:n+"/"+r,content:i};return t.isEmpty(a)||(l.params={versionId:a}),X(e,n,l).then(function(t){J(o.putObjectTag,t,c.PROXY_API_NAMES.S3.PUT_OBJECT_TAG,e).then(function(e){s.resolve(e)},function(e){s.reject(e)})}),s.promise}function I(e,t,n,r,i){var a={path:t+"/"+n,content:r};return i&&(a.params={versionId:i}),X(e,t,a).then(function(t){return J(o.putObjectAcl,t,c.PROXY_API_NAMES.S3.PUT_OBJECT_ACL,e).then(function(e){return e},function(e){return e})}).catch(function(e){return e.response?p.reject(e.response.Error.Message):p.reject(e)})}function P(e,t,n){return X(e,t,n).then(function(t){return J(o.getObjectInventory,t,"S3-GetObjectInventory",e).then(function(e){return e})}).catch(function(e){return e.response?p.reject(e.response.Error.Message):p.reject(e)})}function N(t){return t?e.isArray(t)?t:new Array(t):[]}function M(e,t,n,r,i){return X(i,e,{content:"",path:e+"/"+t,params:{uploads:""},headers:n,config:{timeout:r}}).then(function(e){return J(o.initiateMultipartUpload,e,c.PROXY_API_NAMES.S3.INITIAL_MULTIPART_UPLOAD,i)})}function L(e,t,n,r,i,a){return X(a,e,{content:n,path:e+"/"+t,params:{uploadId:r},config:{timeout:i}}).then(function(e){return J(o.completeMultipartUpload,e,c.PROXY_API_NAMES.S3.COMPLETE_MULTIPART_UPLOAD,a)})}function x(t,r,i){var a=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=arguments.length<=4||void 0===arguments[4]||arguments[4],s=!(arguments.length<=5||void 0===arguments[5])&&arguments[5];return o&&D(r,i)||X(t,r,{path:r}).then(function(s){return e.extend(s,a),J(oe[i].getterFunction,s,c.PROXY_API_NAMES.S3.GET_PROPERTY_PREFIX+i,t).then(function(e){return o&&n.putBucketProperty(r,i,e),e})}).catch(function(e){return!s&&e.response&&e.response.Error&&e.response.Error.Message?p.reject(e.response.Error.Message):p.reject(e)})}function D(e,t){var r=n.getBucketProperty(e,t);if(r)return p.when(r)}function j(e,r,i){var a=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=t.extend({path:r},a);return X(e,r,o).then(function(t){return J(oe[i].deleteFunction,t,c.PROXY_API_NAMES.S3.DELETE_PROPERTY_PREFIX+i,e).then(function(e){return n.evictBucketProperty(r,i),e})}).catch(function(e){return e.response&&e.response.Error&&e.response.Error.message?p.reject(e.response.Error.Message):p.reject(e)})}function B(e,r,a,o){var s=arguments.length<=4||void 0===arguments[4]?{}:arguments[4],l=!(arguments.length<=5||void 0===arguments[5])&&arguments[5],u=t.extend({path:r,content:o},s);return-1!==se.indexOf(a)&&(u.headers={"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":(new Date).toUTCString(),"Content-MD5":i.getContentMd5(o)}),X(e,r,u).then(function(t){return J(oe[a].putterFunction,t,c.PROXY_API_NAMES.S3.PUT_PROPERTY_PREFIX+a,e).then(function(e){return n.evictBucketProperty(r,a),e})}).catch(function(e){if(!l&&e.response&&e.response.Error&&e.response.Error.Message){var t=e.response.Error,n=t.ArgumentValue1?t.Message+". "+t.ArgumentValue1+". ("+t.ArgumentName1+")":t.Message;return p.reject(n)}return p.reject(e)})}function F(e,t,n,r){return r||(r={"response-content-type":"text"}),X(e,t,{path:t+"/"+n}).then(function(t){return t.params=r,ce(e,t)})}function U(e,t,n){var r=n.objectKey,a=n.versionId,s=arguments.length<=3||void 0===arguments[3]?"":arguments[3],l=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],u={"Content-MD5":i.getContentMd5(s)};return l&&(u[c.HEADERS.X_AMZ_BYPASS_GOV_RETENTION]="true"),X(e,t,{headers:u,path:t+"/"+r,params:{versionId:a},content:s}).then(function(t){return J(o.putObjectRetention,t,c.PROXY_API_NAMES.S3.PUT_OBJECT_RETENTION_CONFIG,e).then(function(e){return e.response})})}function K(e,t,n){var r=n.objectKey,i=n.versionId;return X(e,t,{path:t+"/"+r,params:{versionId:i}}).then(function(t){return J(o.getObjectRetention,t,c.PROXY_API_NAMES.S3.GET_OBJECT_RETENTION_CONFIG,e).then(function(e){return e.response})})}function V(e,t,n){var r=n.objectKey,a=n.versionId,s=arguments.length<=3||void 0===arguments[3]?"":arguments[3],l={"Content-MD5":i.getContentMd5(s)};return X(e,t,{headers:l,path:t+"/"+r,params:{versionId:a},content:s}).then(function(t){return J(o.putObjectLegalHold,t,c.PROXY_API_NAMES.S3.PUT_OBJECT_LEGAL_HOLD,e).then(function(e){return e.response})})}function G(e,t,n){var r=n.objectKey,i=n.versionId;return X(e,t,{path:t+"/"+r,params:{versionId:i}}).then(function(t){return J(o.getObjectLegalHold,t,c.PROXY_API_NAMES.S3.GET_OBJECT_LEGAL_HOLD,e).then(function(e){return e.response})})}function Y(e,t,n){function r(t){J(u.listKeysForService,{Service:"s3",region:n.region,Limit:1e3},c.PROXY_API_NAMES.KMS.LIST_KEYS,e).then(function(n){a.log("ListKeysForService",1,e),t.resolve(n)}).catch(function(n){a.log("ListKeysForService",0,e,n),t.reject(n)})}var i=p.defer();return n.region?r(i):X(e,t,n).then(function(){a.log("GetBucketLocation",1,e),r(i)}).catch(function(t){a.log("GetBucketLocation",0,e,t),i.reject(t)}),i.promise}function W(e,t){var n=p.defer();return J(u.putKeyPolicy,{Service:"s3",region:l.extractRegionFromKmsArn(t.keyArn),KeyId:l.extractKeyIDFromKmsArn(t.keyArn),Policy:t.policy,PolicyName:"default"},c.PROXY_API_NAMES.KMS.PUT_POLICY,e).then(function(t){a.log("PutKeyPolicy",1,e),n.resolve(t)}).catch(function(t){a.log("PutKeyPolicy",0,e,t),n.reject(t)}),n.promise}function z(e,t){var n=p.defer();return J(u.getKeyPolicy,{Service:"s3",region:l.extractRegionFromKmsArn(t.keyArn),KeyId:l.extractKeyIDFromKmsArn(t.keyArn),PolicyName:"default"},c.PROXY_API_NAMES.KMS.GET_POLICY,e).then(function(t){a.log("GetKeyPolicy",1,e),n.resolve(JSON.parse(t.response.Policy))}).catch(function(t){a.log("GetKeyPolicy",0,e,t),n.reject(t)}),n.promise}function $(e,n,r){var i=p.defer();return J(d.listProvisionedCapacity,{region:r},c.PROXY_API_NAMES.GLACIER.LIST_PROVISIONED_CAPACITY,e).then(function(n){a.log("ListProvisionedCapacity",1,e);var r=t.get(n,"response.ProvisionedCapacityList");i.resolve(r)}).catch(function(t){a.log("ListProvisionedCapacity",0,e,t),i.reject(t)}),i.promise}function H(e,t,n){var r=p.defer();return J(d.purchaseProvisionedCapacity,{region:n,content:JSON.stringify({})},c.PROXY_API_NAMES.GLACIER.PURCHASE_PROVISIONED_CAPACTIY,e).then(function(t){a.log("PurchaseProvisionedCapacity",1,e),r.resolve(t)}).catch(function(t){a.log("PurchaseProvisionedCapacity",0,e,t),r.reject(t)}),r.promise}function q(e,t,n){var r={bucket:t,continutationToken:n};return J(o.listBucketIsidoreConfiguration,r,c.PROXY_API_NAMES.S3.LIST_BUCKET_ISIDORE_CONFIGURATION,e).then(function(e){return e.response}).catch(function(e){return e.response&&e.response.Error&&e.response.Error.Message?p.reject(e.response.Error.Message):p.reject(e)})}var J=function(e,n,r,i){i.step=c.LOGGING.S3_REQUEST_PREFIX+r,n=t.clone(n),n.path&&(n.path=l.escapePath(n.path)),n.config||(n.config={}),n.config.headers||(n.config.headers={});var o=g.generateUUID();n.config.headers[c.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_REQUEST_ID]=o,n.config.headers[c.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_OP_ID]=i.id,n.config.headers[c.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_OP_NAME]=r,n.config.headers[c.S3_REQUEST_HEADERS.XSRF_TOKEN]=m.get(c.XSRF_TOKEN_COOKIE),a.log(i.step.replace(/ /g,""),1,i,n);var s=r.replace(/ /g,""),u=f.Date.now();return e(n).then(function(e){var t=f.Date.now(),n={},r=e.headers();return n[c.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=r[c.S3_RESPONSE_HEADERS.X_AMZ_ID_2],n[c.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=r[c.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID],n[c.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_REQUEST_ID]=o,a.logWithOneBox(c.REQUEST_METRICS.CLIENT_DROP_METRIC,0,i,n),a.logWithOneBox(""+c.REQUEST_METRICS.S3_STATUS_PREFIX+e.status,1,i,n),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.STATUS_CODE_INFIX+e.status,1,i,n),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,i),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,i),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.LATENCY_SUFFIX,t-u,i),e&&e.response&&e.response.error?(a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.SESSION_TIMEOUT_SUFFIX,1,i),p.reject(l.handleErrors(e.response.error))):e}).catch(function(e){var n=f.Date.now(),r={};if(!e||!e.headers)return p.reject(e);var l=e.headers();r[c.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=l[c.S3_RESPONSE_HEADERS.X_AMZ_ID_2],r[c.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=l[c.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID],r[c.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_REQUEST_ID]=o;var d=e.status>=c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD,g=t.has(e,"response.Error.Code")&&"SlowDown"===e.response.Error.Code;return d?g?(a.logWithOneBox(c.REQUEST_METRICS.CLIENT_DROP_METRIC,0,i,r),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,i),a.logWithSimplifiedOperation(c.REQUEST_METRICS.SLOWDOWN_METRIC,1,i,r)):(a.logWithOneBox(c.REQUEST_METRICS.CLIENT_DROP_METRIC,1,i,r),a.logWithSimplifiedOperation(c.REQUEST_METRICS.CLIENT_DROP_DEBUG_METRIC,1,i,t.merge({},r,{request:e.request,response:e.response,status:e.status})),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,i)):(a.logWithOneBox(c.REQUEST_METRICS.CLIENT_DROP_METRIC,0,i,r),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,i)),e.status>=c.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&e.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD?a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,i):a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,i),e.status===c.HTTP_STATUS_CODES.UNKNOWN_ERROR&&(r[c.POSSIBLE_NETWORK_ERROR]=e.statusText,r[c.NETWORK_STATUS]=window.navigator.onLine?"ONLINE":"OFFLINE"),a.logWithOneBox(""+c.REQUEST_METRICS.S3_STATUS_PREFIX+e.status,1,i,r),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.STATUS_CODE_INFIX+e.status,1,i,r),a.logWithSimplifiedOperation(""+s+c.REQUEST_METRICS.LATENCY_SUFFIX,n-u,i),p.reject(e)})},X=function(e,t,n){if(l.isIE()){var r=p.defer();return Q(e,t,n).then(function(e){r.resolve(e)}).catch(function(i){i&&i.status===c.HTTP_STATUS_CODES.ACCESS_DENIED?Z(e,t,n).then(function(e){r.resolve(e)}).catch(function(e){r.reject(e)}):r.reject(i)}),r.promise}return Z(e,t,n)},Z=function(e,t,n){function r(t,n){return J(t,n,c.PROXY_API_NAMES.S3.HEAD_BUCKET,e)}return ee(e,t,s.getBucketLocationWithFallback,r,n)},Q=function(e,t,n){function r(t,n){return J(t,n,c.PROXY_API_NAMES.S3.GET_BUCKET_LOCATION,e)}return ee(e,t,s.getBucketLocation,r,n)},ee=function(e,t,r,i,a){var o=n.getBucketLocation(t);if(o)return a&&(a.region=o),p.when(a);var s=l.getRegionOrder();return r(t,s,i).then(function(e){return n.putBucketLocation(t,e),a&&(a.region=e),a})},te=function(e,t){var r=t.cacheAllowed;if(delete t.cacheAllowed,r){var i=n.getBucketObjects(t.path,JSON.stringify(t));if(i)return p.when(i)}var s=c.PROXY_API_NAMES.S3.LIST_OBJECT,l=""+s+c.REQUEST_METRICS.STATUS_CODE_INFIX+"InvalidBucketName";return t.path?a.logWithSimplifiedOperation(l,0,e):a.logWithSimplifiedOperation(l,1,e),J(o.listObjects,t,c.PROXY_API_NAMES.S3.LIST_OBJECT,e).then(function(e){var a=e.response.ListBucketResult;return a.Contents&&(a.Contents=N(a.Contents),a.Contents=a.Contents.map(function(e){return e.Size=parseInt(e.Size),e})),a.CommonPrefixes&&(a.CommonPrefixes=N(a.CommonPrefixes)),(!r||r&&!i)&&n.putBucketObjects(t.path,JSON.stringify(t),e),e})},ne=function(e,t){return J(o.getObjectAcl,t,c.PROXY_API_NAMES.S3.GET_OBJECT_ACL,e).then(function(e){var t=e.response.AccessControlPolicy.AccessControlList;return t.Grant=N(t.Grant),e})},re=function(e,t){var n=p.defer();return J(o.getObjectTag,t,c.PROXY_API_NAMES.S3.GET_OBJECT_TAG,e).then(function(e){return n.resolve(e)},function(e){return n.reject(e)}),n.promise},ie=function(e,t,n){return X(e,t,n).then(function(t){return J(o.deleteObjectInventoryConfig,t,"S3-DeleteObjectInventoryConfig",e).then(function(e){return e})}).catch(function(e){return e.response?p.reject(e.response.Error.Message):p.reject(e)})},ae=function(e,t,n){return X(e,t,n).then(function(t){return J(o.putObjectInventoryConfig,t,"S3-PutObjectInventoryConfig",e).then(function(e){return e})}).catch(function(e){return e.response?p.reject(e.response.Error.Message):p.reject(e)})},oe={acl:{name:"acl",getterFunction:function(e){return o.getBucketAcl(e)},putterFunction:function(e){return o.putBucketAcl(e)}},cors:{name:"cors",getterFunction:function(e){return o.getBucketCORS(e)},putterFunction:function(e){return o.putBucketCORS(e)},deleteFunction:function(e){return o.deleteBucketCORS(e)}},policy:{name:"policy",getterFunction:function(e){return o.getBucketPolicy(e)},putterFunction:function(e){return o.putBucketPolicy(e)},deleteFunction:function(e){return o.deleteBucketPolicy(e)}},logging:{name:"logging",getterFunction:function(e){return o.getBucketLogging(e)},putterFunction:function(e){return o.putBucketLogging(e)}},lifecycle:{name:"lifecycle",getterFunction:function(e){return o.getLifecycleConfiguration(e)},putterFunction:function(e){return o.putLifecycleConfiguration(e)},deleteFunction:function(e){return o.deleteLifecycleConfiguration(e)}},website:{name:"website",getterFunction:function(e){return o.getBucketWebsite(e)},putterFunction:function(e){return o.putBucketWebsite(e)},deleteFunction:function(e){return o.deleteBucketWebsite(e)}},notification:{name:"notification",getterFunction:function(e){return o.getBucketNotification(e)},putterFunction:function(e){return o.putBucketNotification(e)}},versioning:{name:"versioning",getterFunction:function(e){return o.getBucketVersioning(e)},putterFunction:function(e){return o.putBucketVersioning(e)}},replication:{name:"replication",getterFunction:function(e){return o.getBucketReplication(e)},putterFunction:function(e){return o.putBucketReplication(e)},deleteFunction:function(e){return o.deleteBucketReplication(e)}},tagging:{name:"tagging",getterFunction:function(e){return o.getBucketTagging(e)},putterFunction:function(e){return o.putBucketTagging(e)},deleteFunction:function(e){return o.deleteBucketTagging(e)}},requestPayment:{name:"requestPayment",getterFunction:function(e){return o.getRequestPayment(e)},putterFunction:function(e){return o.putRequestPayment(e)}},metrics:{name:"metrics",getterFunction:function(e){return o.getBucketMetrics(e)},putterFunction:function(e){return o.putBucketMetrics(e)},deleteFunction:function(e){return o.deleteBucketMetrics(e)}},analytics:{name:"analytics",getterFunction:function(e){return o.getBucketAnalytics(e)},putterFunction:function(e){return o.putBucketAnalytics(e)},deleteFunction:function(e){return o.deleteBucketAnalytics(e)}},accelerate:{name:"accelerate",getterFunction:function(e){return o.getBucketAccelerate(e)},putterFunction:function(e){return o.putBucketAccelerate(e)}},retention:{name:"retention",getterFunction:function(e){return o.getObjectLockConfiguration(e)},putterFunction:function(e){return o.putObjectLockConfiguration(e)}},isidore:{name:"isidore",getterFunction:function(e){return o.getBucketIsidoreConfiguration(e)},putterFunction:function(e){return o.putBucketIsidoreConfiguration(e)},deleteFunction:function(e){return o.deleteBucketIsidoreConfiguration(e)}},defaultEncryption:{name:"defaultEncryption",getterFunction:function(e){return o.getBucketDefaultEncryption(e)},putterFunction:function(e){return o.putBucketDefaultEncryption(e)},deleteFunction:function(e){return o.deleteBucketDefaultEncryption(e)}}},se=["tagging","cors","replication","lifecycle","retention"],ce=function(e,t){return J(o.getObject,t,c.PROXY_API_NAMES.S3.GET_OBJECT,e).then(function(e){return e.response}).catch(function(e){return e.response&&e.response.Error&&e.response.Error.Message?p.reject(e.response.Error.Message):p.reject(e)})},le={bucketPropertiesMap:oe,completeMultipartUpload:L,createBucket:C,deleteBucket:S,deleteBucketProperty:j,getBucketProperty:x,getBucketLocation:X,getBucketOwner:v,getObject:F,getObjectAcl:T,getObjectMetadata:h,getObjectTag:O,makeProxyRequest:J,putObjectTag:k,getObjectInventory:P,deleteObjectInventoryConfig:ie,putObjectInventoryConfig:ae,headBucket:E,headObject:A,initiateMultipartUpload:M,listAllMyBuckets:b,listObjects:_,listVersions:w,putBucketProperty:B,putObject:y,putObjectAcl:I,tagQuery:R,getKmsKeys:Y,getKMSKeyPolicy:z,putKMSKeyPolicy:W,listProvisionedCapacity:$,purchaseProvisionedCapacity:H,listBucketIsidoreConfiguration:q,putObjectRetention:U,getObjectRetention:K,putObjectLegalHold:V,getObjectLegalHold:G};return le}])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.module("s3").factory("S3CWSAPIService",["$q","APIProxyService","S3Constants","$http","UtilService","UUIDService","SCLogService","ConsoleOperation","Region","S3CWSEndpoint","S3CWSCommandEndpoint","$cookies",function(e,r,i,a,o,s,c,l,u,d,p,f){function g(n,r,l,u,d){u||(u={}),u.headers||(u.headers={}),u.headers[i.HEADERS.OPERATION]=l;var p=s.generateUUID();r.cwsRequestId=p;var g=i.OPERATION.CWS_OP_ID;return u.headers[i.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_REQUEST_ID]=p,u.headers[i.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_OP_ID]=d.id,u.headers[i.S3_REQUEST_HEADERS.X_AMZ_S3_CONSOLE_OP_NAME]=l,u.headers[i.S3_REQUEST_HEADERS.XSRF_TOKEN]=f.get(i.XSRF_TOKEN_COOKIE),{}[g]=p,d.step=i.LOGGING.CWS_REQUEST_PREFIX+l,a.post(n,r,u).then(function(t){var n={};return n[g]=p,d.step=i.LOGGING.CWS_RESPONSE_PREFIX+l,c.logWithOneBox(i.REQUEST_METRICS.CLIENT_DROP_METRIC,0,d,n),c.logWithOneBox(""+i.REQUEST_METRICS.S3_STATUS_PREFIX+t.status,1,d,n),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.STATUS_CODE_INFIX+t.status,1,d,n),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,d),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,d),t&&t.data&&t.data.error?(c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.SESSION_TIMEOUT_SUFFIX,1,d),e.reject(o.handleErrors(t.data.error))):t},function(n){var a={};return a[g]=p,a.message=n.statusText,d.step=i.LOGGING.CWS_RESPONSE_PREFIX+l,n.status>=i.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD?(c.logWithOneBox(i.REQUEST_METRICS.CLIENT_DROP_METRIC,1,d,a),c.logWithSimplifiedOperation(i.REQUEST_METRICS.CLIENT_DROP_DEBUG_METRIC,1,d,t.merge({},a,{request:r,response:n.data,status:n.status})),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,d)):(c.logWithOneBox(i.REQUEST_METRICS.CLIENT_DROP_METRIC,0,d,a),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,d)),n.status>=i.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&n.status<i.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD?c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,d):c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,d),c.logWithOneBox(""+i.REQUEST_METRICS.S3_STATUS_PREFIX+n.status,1,d,a),c.logWithSimplifiedOperation(""+l+i.REQUEST_METRICS.STATUS_CODE_INFIX+n.status,1,d,a),e.reject(n)})}var m=function(e,t,r,a){var o="/s3/batchOpsServlet-proxy";if(t!==i.CWS_OPERATION_NAME.ANALYZE_ACCESS){var s=e.region||u.getCurrentRegion();o="object"===(void 0===d?"undefined":n(d))?d[s]:d}return g(o,e,t,r,a)};return{makeS3ConsoleOperationRequest:m,makeS3ConsoleCommandRequest:function(e,t,r,i,a){var o=e.region||a||u.getCurrentRegion();return g("object"===(void 0===p?"undefined":n(p))?p[o]:p,e,t,r,i)},makePublic:function(e,t,n){e||(e=new l("FAKE CWS CALL OPERATION IN "+i.CWS_OPERATION_NAME.MAKE_PUBLIC));var a={};return a.bucket=e.initialBucket,a.region=n,a.keys=t,r.getBucketLocation(e,a.bucket,a).then(function(t){return m(t,i.CWS_OPERATION_NAME.MAKE_PUBLIC,{},e)})},fetchPresignedUrl:function(e,t,n,a,o,s,c,u){u||(u=new l("FAKE CWS CALL OPERATION IN "+i.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL));var d={};d.bucket=e,d.key=t,d.httpMethod=n,d.headerOverrides=a,d.subresourceMap=o,d.customRequestHeaders=c;var p={};return s&&(p.timeout=s),r.getBucketLocation(u,e,d).then(function(e){return m(e,i.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL,p,u)})},generateCount:function(e,t,n,a){var o={};return o.bucket=e,o.folders=t,o.continuationTokens=n,r.getBucketLocation(a,e,o).then(function(e){return m(e,i.CWS_OPERATION_NAME.GENERATE_COUNT,{},a)})},generateVersionsCount:function(e,t,n,a,o){var s={};return s.bucket=e,s.folders=t,s.keyMarkers=n,s.versionIdMarkers=a,r.getBucketLocation(o,e,s).then(function(e){return m(e,i.CWS_OPERATION_NAME.GENERATE_VERSIONS_COUNT,{},o)})},getMetadata:function(e,t,n,a){var o={};return o.bucket=e,o.key=t,o.versionId=n,r.getBucketLocation(a,e,o).then(function(e){return m(e,i.CWS_OPERATION_NAME.GET_METADATA,{},a)})},wasOperationSuccessful:function(e){return"success"===e.data.requestStatus}}}])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){e.module("s3").factory("FileUpload",["$translate","S3Constants",function(n,r){function i(i,a,o,s,c,l,u,d){function p(){return a}function f(){return i}function g(){return o}function m(){return s}function h(){return c}function b(){return l}function v(){return D}function E(e){D=e}function S(){return u&&u.storageClass?u.storageClass:r.STORAGE_CLASSES.STANDARD}function y(){if(u&&u.serverSideEncryption&&u.serverSideEncryption===r.OBJECT_SSE.KMS_ENCRYPTION)return u.kmsId}function A(){if(u&&u.serverSideEncryption&&u.serverSideEncryption===r.OBJECT_SSE.KMS_ENCRYPTION&&u.kmsId===r.UPLOAD.CUSTOM_ARN)return u.kmsARN}function C(){if(u&&u.metadata)return u.metadata}function _(){if(u&&u.tags){var n="";return e.forEach(u.tags,function(e,r){e=t.isEmpty(e)?"":e;var i=encodeURIComponent(r)+"="+encodeURIComponent(e)+"&";n=n.concat(i)}),n.slice(0,-1)}}function w(e){var n=_();t.isEmpty(n)||(e[r.HEADERS.X_AMZ_TAGGING]=n)}function T(e){var n="";if(u&&u.permissions)return u.permissions.publicPermissions&&u.permissions.publicPermissions.forEach(function(t){!0===t.permissions[e]&&(n+=n.length>0?", ":"",n+='uri="'+t.detail.URI+'"')}),u.permissions.userPermissions&&(Array.isArray(u.permissions.userPermissions)||(u.permissions.userPermissions=[u.permissions.userPermissions]),u.permissions.userPermissions.forEach(function(t){!0===t.permissions[e]&&(n+=n.length>0?", ":"",n+='id="'+t.detail.ID+'"')})),u.permissions.awsAccountPermissions&&u.permissions.awsAccountPermissions.length>0&&u.permissions.awsAccountPermissions.forEach(function(r){!0===r.permissions[e]&&(n+=n.length>0?", ":"",t.isEmpty(r.detail.EmailAddress)?n+='id="'+r.detail.ID+'"':n+='emailAddress="'+r.detail.EmailAddress+'"')}),n}function R(e){var t=T(r.ACL_PERMISSIONS.READ);""!==t&&(e[r.HEADERS.X_AMZ_GRANT_READ]=t);var n=T(r.ACL_PERMISSIONS.READ_ACP);""!==n&&(e[r.HEADERS.X_AMZ_GRANT_READ_ACP]=n);var i=T(r.ACL_PERMISSIONS.WRITE);""!==i&&(e[r.HEADERS.X_AMZ_GRANT_WRITE]=i);var a=T(r.ACL_PERMISSIONS.WRITE_ACP);""!==a&&(e[r.HEADERS.X_AMZ_GRANT_WRITE_ACP]=a),u&&!u.permissions&&(e[r.HEADERS.X_AMZ_ACL]=r.HEADERS.X_AMZ_ACL_PRIVATE)}function O(e){var n=t.get(u,"serverSideEncryption");if(n===r.OBJECT_SSE.KMS_ENCRYPTION)e[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=r.OBJECT_SSE.KMS_ENCRYPTION,e[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]=y()===r.UPLOAD.CUSTOM_ARN?A():y();else if(n===r.OBJECT_SSE.AES256)e[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=r.OBJECT_SSE.AES256;else if(n===r.OBJECT_SSE.NONE);else if(n)throw"$translate.instant('upload.encryption.error'): "+n}function k(){var t={};if(t[r.HEADERS.X_AMZ_STORAGE_CLASS]=S(),O(t),R(t),w(t),C()){var n=C();t=e.extend({},t,n)}return t[r.HEADERS.CONTENT_TYPE]||(t[r.HEADERS.CONTENT_TYPE]=void 0),t}function I(){return x}function P(e){x=e}function N(){return j}function M(){return B}function L(){return F}var x,D=n.instant("utilities.unknown.error"),j={};this.addEtag=function(e,t){j[e]=t};var B=Math.ceil(a.size/d),F=0;this.incrementCompletedParts=function(){F+=1},Object.defineProperties(this,{filePointer:{get:p},id:{get:f},cancelDeferredObject:{get:g},uploadDeferredObject:{get:m},destKey:{get:h},destBucket:{get:b},errorMessage:{get:v,set:E},headers:{get:k},timeoutPromise:{get:I,set:P},etags:{get:N},numberOfParts:{get:M},completedParts:{get:L}})}return i}])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("PathService",["$routeParams","$location","S3Constants",function(e,t,n){function r(){var r=t.path();return 0===r.indexOf("/"+n.PATH_SEGMENTS.BUCKETS+"/")&&e[n.PATH_SEGMENTS.KEY_PREFIX]?decodeURIComponent(e[n.PATH_SEGMENTS.KEY_PREFIX]):0===r.indexOf("/"+n.PATH_SEGMENTS.OBJECT_DETAILS+"/")&&e[n.PATH_SEGMENTS.KEY_PREFIX]?decodeURIComponent(e[n.PATH_SEGMENTS.KEY_PREFIX].substring(0,e[n.PATH_SEGMENTS.KEY_PREFIX].lastIndexOf(n.DELIMITER)+1)):void 0}this.getCurrentBucket=function(){return i()};var i=function(){var r=t.path();if(0===r.indexOf("/"+n.PATH_SEGMENTS.BUCKETS+"/")||0===r.indexOf("/"+n.PATH_SEGMENTS.OBJECT_DETAILS+"/"))return e[n.PATH_SEGMENTS.BUCKET_NAME]};this.getCurrentAbsoluteFolderPath=function(){return r()},this.relativeToAbsoluteFolderPath=function(e){var t=r();return void 0!==t?t+e+n.DELIMITER:e+n.DELIMITER},this.relativeToAbsoluteObjectPath=function(e){return o(e)};var a=function(e){var t=new RegExp(/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/),n=new RegExp(/(\d+\.){3}\d+/),r=new RegExp(/\.\./);return!(!e.match(t)||e.match(n)||e.match(r))&&null===e.match(/\./)};this.getObjectLink=function(e,t){var r=arguments.length<=2||void 0===arguments[2]?"":arguments[2],o=n.S3_ENDPOINTS[t]||n.S3_DEFAULT_ENDPOINT,s=i(),c=encodeURIComponent(e).replace(/%20/g,"+").replace(/%2F/g,"/"),l=void 0;return l=a(s)?"https://"+s+"."+o+"/"+c:"https://"+o+"/"+s+"/"+c,r&&(l=l+"?"+n.VERSION_ID_PARAM+"="+r),l};var o=function(e){var t=r();return void 0!==t?t+e:e};this.getAbsolutePathWithBucket=function(){var e=i(),t=r(),a=e;return t&&(a=""+e+n.DELIMITER+t),a},this.getAbsolutePathToObjectWithBucket=function(e){var t=i(),r=o(e),a=t;return r&&(a=""+t+n.DELIMITER+r),a},this.absoluteToRelativeObjectPaths=function(e,t){if(e)return e=e.filter(function(e){return e.Key!==t}),e.forEach(function(e){e.Key===t?e.Key=n.DELIMITER:e.Key=e.Key.replace(t,""),e.beingRenamed=!1}),e},this.absoluteToRelativeFolderPaths=function(e,t){if(e)return e.forEach(function(e){e.Prefix=e.Prefix.replace(t,"").replace(n.DELIMITER,""),e.beingRenamed=!1}),e},this.getCurrentObject=function(){var e="/"+n.PATH_SEGMENTS.BUCKETS+"/",r="/"+n.PATH_SEGMENTS.OBJECT_DETAILS+"/",a=t.path();return 0===a.indexOf(e)?decodeURIComponent(a.split(""+e+i()+"/")[1]):0===a.indexOf(r)?decodeURIComponent(a.split(""+r+i()+"/")[1]):void 0},this.getObjectVersion=function(){return e[n.VERSION_ID_PARAM]},this.getUrlForBucketAndPrefix=function(e,t,r){var i=e.split("/s3/")[0],a=e.split("region=")[1].split("&")[0];return t?i+"/s3/buckets/"+t+n.DELIMITER+r+"?region="+a+"&tab=overview":i+"/s3/home?region="+a},this.getFolderList=function(){var r=e.bucketName,i=t.path(),a=i.indexOf("/"+n.PATH_SEGMENTS.OBJECT_DETAILS+"/");i=i.substring(i.indexOf(r));var o=i.split(n.DELIMITER),s="",c="",l=[];return o.pop(),o.forEach(function(e){s+="/"+encodeURIComponent(e),c+="/"+decodeURIComponent(e),l.push({displayName:decodeURIComponent(e),name:e,path:""+s+n.DELIMITER})}),0!==a&&delete l[l.length-1].path,l},this.getFolderNamesList=function(){var r=e.bucketName,i=t.path();i=i.substring(i.indexOf(r));var a=i.split(n.DELIMITER);return a.pop(),a}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){e.module("s3").service("CachingService",["S3Constants","$cacheFactory","$location",function(r,i,a){var o,s=i(".bucketLocationCache",{capacity:r.CACHE.SIZE.BUCKET_LOCATION}),c=i(".lambCache",{capacity:r.CACHE.SIZE.LAMB}),l=i(".accessCache",{capacity:r.CACHE.SIZE.ACCESS}),u={},d=[],p=[],f=[];this.putLamb=function(e){c.put("lamb",e)},this.evictLamb=function(){c.removeAll()},this.getLamb=function(){return c.get("lamb")},this.getBucketLocation=function(e){return s.get(e)},this.putBucketLocation=function(e,t){s.put(e,t)},this.evictBucketLocation=function(e){s.remove(e)},this.getBucketProperty=function(e,t){var n=i.get(e+".properties");if(n)return n.get(t)},this.putBucketProperty=function(e,t,n){i.get(e+".properties")||i(e+".properties",{capacity:r.CACHE.SIZE.BUCKET_PROPERTIES}),i.get(e+".properties").put(t,n)},this.evictBucketProperty=function(e,t){var n=i.get(e+".properties");n&&n.remove(t)},this.evictAllBucketProperties=function(e){var t=i.get(e+".properties");t&&t.removeAll()},this.getBucketObjects=function(e,t){var n=i.get(e+".objects");if(n)return n.get(t)},this.putBucketObjects=function(e,t,n){i.get(e+".objects")||i(e+".objects",{capacity:r.CACHE.SIZE.LIST_OBJECTS}),i.get(e+".objects").put(t,n)},this.evictBucketObjects=function(e){var t=i.get(e+".objects");t&&t.removeAll()},this.evictAllBucketData=function(e){s.remove(e),this.evictBucketObjects(e),this.evictAllBucketProperties(e)},this.setCurrentObject=function(e){o=e},this.getCurrentObject=function(){return o},this.setCurrentVersions=function(t,n,r){e.isObject(u[t])||(u[t]={}),u[t][n]=r},this.getMarkers=function(e,t){return p[e][t]},this.addMarker=function(e,t,r,i){this.addMarkersList(r,i);var a=p[r][i].indexOf(e);p[r][i]=[].concat(n(p[r][i].slice(0,a+1)),[t])},this.addMarkersList=function(e,t){if(e>=p.length)for(var n=e-p.length,r=0;r<=n;r++)p.push({});p[e][t]||(p[e][t]=[])},this.returnMarkers=function(){return p},this.resetMarkers=function(){p=[]},this.resetLocationAndMarkers=function(){p=[],f=[],a.search(r.CURRENT_MARKER,null),a.search(r.CURRENT_VERSIONS_ID_MARKER,null),a.search(r.CURRENT_VERSIONS_KEY_MARKER,null)},this.getVersionMarkers=function(e,t){return f[e][t]},this.addVersionMarker=function(e,r,i,a){this.addVersionMarkersList(i,a);var o=f[i][a].findIndex(function(n){return t.isEqual(n,e)});f[i][a]=[].concat(n(f[i][a].slice(0,o+1)),[t.clone(r)])},this.addVersionMarkersList=function(e,t){if(e>=f.length)for(var n=e-f.length,r=0;r<=n;r++)f.push({});f[e][t]||(f[e][t]=[])},this.returnVersionMarkers=function(){return f},this.initializeMarkers=function(e){if(e.length>p.length)for(var t=e.length-p.length,n=0;n<t;n++)p.push({});if(p[e.length-1][e[e.length-1]]||(p[e.length-1][e[e.length-1]]=[]),e.length>f.length)for(var t=e.length-f.length,n=0;n<t;n++)f.push({});f[e.length-1][e[e.length-1]]||(f[e.length-1][e[e.length-1]]=[])},this.getCurrentVersions=function(e,t){if(u[e])return u[e][t]},this.deleteCurrentVersions=function(e,t){u[e]&&delete u[e][t]},this.setPageOfDeletedObjects=function(e,t){d[t]=e},this.getPageOfDeletedObjects=function(e){return d[e]},this.resetDeletedObjects=function(){d=[]},this.getAccessAnalysis=function(e){return l.get(e)},this.putAccessAnalysis=function(e,t){l.put(e,t)},this.evictAccessAnalysis=function(e){l.remove(e)},this.evictAllAccessAnalysis=function(){l.removeAll()}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("UploadRequestsService",["$q","S3Constants","S3CWSAPIService","APIProxyService","SCLogService","XMLParser",function(e,n,r,i,a,o){function s(e){return e===n.SESSION_TIMEOUT_MESSAGE||t.get(e,"error[0]")===n.SESSION_TIMEOUT_MESSAGE}function c(e,t,n){s(n)&&(e=1,a.log("UploadPresignedUrlSessionTimeout",1)),a.log("UploadPresignedUrl",e,t,n)}this.initiateMultipartUpload=function(t,r,c,l,u){return i.initiateMultipartUpload(r,t,c,l,u).then(function(t){var r=t.response,i=t.headers();return(r=o.convertXmlStringToJson(r))&&r.InitiateMultipartUploadResult&&r.InitiateMultipartUploadResult.UploadId?(a.logS3("InitiateMultipart",1,u,i[n.HEADERS.X_AMZ_ID_2],i[n.HEADERS.X_AMZ_REQUEST_ID],t),r.InitiateMultipartUploadResult.UploadId):(a.logS3("InitiateMultipart",0,u,i[n.HEADERS.X_AMZ_ID_2],i[n.HEADERS.X_AMZ_REQUEST_ID],t),e.reject(r))},function(t){if(s(t))a.log("InitiateMPUSessionTimeout",1),a.log("InitiateMultipart",0,u,t);else{var r=t.headers(),i=Number(t.status<n.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);a.logS3("InitiateMultipart",i,u,r[n.HEADERS.X_AMZ_ID_2],r[n.HEADERS.X_AMZ_REQUEST_ID],t)}return e.reject(t)})},this.completeMultipartUpload=function(r,o,c,l,u,d){var p="<CompleteMultipartUpload>";for(var f in l){var g="<Part><PartNumber>"+f+"</PartNumber>";g+="<ETag>"+l[f]+"</ETag>",g+="</Part>",p+=g}return p+="</CompleteMultipartUpload>",i.completeMultipartUpload(o,r,p,c,u,d).then(function(t){var r=t.headers();return t.response&&t.response.CompleteMultipartUploadResult?(a.logS3("CompleteMultipartUpload",1,d,r[n.HEADERS.X_AMZ_ID_2],r[n.HEADERS.X_AMZ_REQUEST_ID],t),t.response.CompleteMultipartUploadResult):(a.logS3("CompleteMultipartUpload",0,d,r[n.HEADERS.X_AMZ_ID_2],r[n.HEADERS.X_AMZ_REQUEST_ID],t),e.reject({statusText:t.response}))},function(r){if(s(r))return a.log("CompleteMPUSessionTimeout",1),a.log("CompleteMultipartUpload",0,d,r),e.reject(r);var i=r.headers();return a.logS3("CompleteMultipartUpload",0,d,i[n.HEADERS.X_AMZ_ID_2],i[n.HEADERS.X_AMZ_REQUEST_ID],r),e.reject({statusText:t.get(r,"response.Error.Message","")})})},this.generatePresignedUrlForUpload=function(t,i,a,o,s,l){return r.fetchPresignedUrl(i,t,"PUT",{},o,a,s).then(function(t){return t.data&&t.data.presignedUrl?(c(1,l,t),t):(c(0,l,t),e.reject(t))},function(t){return c(Number(t.status<n.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD),l,t),e.reject(t)})}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("ReadAndSendBlobService",["$http","$q","$window","S3Constants","SCLogService",function(e,t,n,r,i){this.readAndPutBlobToUrl=function(s,c,l,u,d,p){var f=t.defer();u&&!u[r.HEADERS.CONTENT_TYPE]&&(u["Content-Type"]=void 0);var g={method:"PUT",url:l,data:c,headers:u,timeout:d,uploadEventHandlers:{progress:function(e){e.lengthComputable&&e.loaded&&e.total&&f.notify({fileId:s,uploadedBytes:e.loaded,totalBytes:e.total})}},transformRequest:[]};i.log("UploadReader",1,p,g);var m=n.Date.now();return e(g).then(a(f,p,m),o(f,p)),f.promise};var a=function(e,t,a){return function(o){var s=n.Date.now();e.resolve(o),i.log("UploadPutTime",s-a,t);var c=o.headers();i.logS3("UploadPutRequest",1,t,c[r.HEADERS.X_AMZ_ID_2],c[r.HEADERS.X_AMZ_REQUEST_ID],o)}},o=function(e,t){return function(n){var a=n.headers();i.log("UploadPut"+r.REQUEST_METRICS.STATUS_CODE_INFIX+n.status,1,t,n);var o=Number(n.status<r.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);i.logS3("UploadPutRequest",o,t,a[r.HEADERS.X_AMZ_ID_2],a[r.HEADERS.X_AMZ_REQUEST_ID]),-1===n.status?n.statusText="OptionsRequestDenied":0===n.status&&(n.statusText="OptionsResponseMissingHeaders"),e.reject(n)}}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").service("UploadService",["$http","$q","$timeout","$translate","CachingService","S3Constants","FileUpload","UploadRequestsService","ReadAndSendBlobService","SCLogService","MD5CalculationService","UtilService",function(r,i,a,o,s,c,l,u,d,p,f,g){function m(e,t,n,r,i){r.uploadedEtag=t[0].headers().etag;var a=i?"MD5MPVerification":"MD5Verification";_(r.calculatedEtag,r.uploadedEtag)?w(n.filePointer)?(r.errorReason=v,p.log("UploadFileChanged",1,e,r)):(r.errorReason=E,p.log(a,0,e,r)):p.log(a,1,e,r)}var h=0,b={},v="FileChanged",E="EtagsDoNotMatch",S=n({},v,o.instant("upload.verification.filechangederror")),y=function(){return++h},A=function(e){b[e]&&a.cancel(b[e].timeoutPromise)},C=function(e,t){return function(n){A(e),n=g.transformObjectToArray(n);var r=n[0],i={fileName:b[e].filePointer.name,calculatedEtag:b[e].md5};r&&r.headers()&&r.headers().etag?N(t)&&t.shouldPerformETagVerification?(m(t,n,b[e],i,!1),i.errorReason?P(e,{statusText:i.errorReason},t):k(e,r.headers().etag,t)):k(e,r.headers().etag,t):(p.log("UploadNoEtagFromS3",1,t),P(e,{statusText:"No etag was provided by S3"},t))}},_=function(e,t){return e!==t.substring(1,t.length-1)},w=function(e){return e.lastModified&&e.lastModified!==e.initialLastModified},T=function(e,n){if(b[n].isCancelled)return o.instant("upload.cancelled");var r=g.transformObjectToArray(e)[0];return r.statusText?t.get(S,r.statusText,r.statusText):g.handleErrors(r)},R=function(e,t){return function(n){A(e),P(e,n,t)}},O=function(e,t){return function(n){k(e,n.ETag||"",t)}},k=function(e,n,r){var i={};i.id=e,i.name=b[e].filePointer.name,i.etag=n.substring(1,n.length-1),i.operation=r,Object.keys(b[e].etags).length>0&&(i.multiPartEtags=t.mapValues(b[e].etags,function(e){return e.substring(1,e.length-1)})),b[e].uploadDeferredObject.resolve(i),delete b[e]},I=function(e,t){return function(n){P(e,n,t)}},P=function(e,t,n){var r={};r.errorMessage=T(t,e),r.name=b[e].filePointer.name,r.id=e,r.operation=n,r.isCancelled=b[e].isCancelled,b[e].uploadDeferredObject.reject(r),delete b[e]},N=function(e){return!e.options.serverSideEncryption||e.options.serverSideEncryption===c.OBJECT_SSE.NONE},M=function(e,t,n,r,i){var a=d.readAndPutBlobToUrl(e,b[e].filePointer,t,r,n.promise,i);a.then(null,null,function(t){b[e].uploadedByte=t.uploadedBytes,b[e].totalBytes=t.totalBytes,F(b[e],i)}),a.then(C(e,i),R(e,i),function(t){t.destKey=b[e].destKey,t.destBucket=b[e].destBucket,t.operation=i,b[e].uploadDeferredObject.notify(t)}),b[e]&&F(b[e],i)},L=function(e,r){var i=a(function(){e.cancelDeferredObject.resolve(e.id),e.errorMessage="Upload timed out."},c.UPLOAD.TIMEOUT_MSECS);e.timeoutPromise=i,f.calculateMD5(b[e.id].filePointer,e.id,r.id).then(function(i){var a=t.assign({},e.headers,n({},c.HEADERS.CONTENT_MD5,g.hexToBase64(i)));e.md5=i,u.generatePresignedUrlForUpload(e.destKey,e.destBucket,e.cancelDeferredObject.promise,{},a,r).then(function(t){M(e.id,t.data.presignedUrl,e.cancelDeferredObject,a,r)},function(t){P(e.id,t,r)}),F(e,r)})},x=function(e,n,r){return function(i){e.calculatedMD5s[n.partNumber]=i;var a=g.hexToBase64(i);return u.generatePresignedUrlForUpload(e.destKey,e.destBucket,e.cancelDeferredObject.promise,n,{"Content-MD5":a},r).then(function(e){return t.assign({},e,{MD5:a})})}},D=function(e,t,n,r,i){return function(a){var o=e.filePointer.slice(t,n);o.name=e.filePointer.name;var s=d.readAndPutBlobToUrl(e.id,o,a.data.presignedUrl,{"Content-MD5":a.MD5},e.cancelDeferredObject.promise,r);return s.then(null,null,function(t){e.uploadedByte=t.uploadedBytes+(i-1)*c.UPLOAD.PART_SIZE_IN_BYTES,e.totalBytes=e.totalBytes,F(e,r)}),s}},j=function(e,t,n){return function(r){r=g.transformObjectToArray(r);var a=r[0];if(!a||!a.headers()||!a.headers().etag)return i.reject(r[0]);var o={partNumber:t,fileName:e.filePointer.name,calculatedEtag:e.calculatedMD5s[t]};if(N(n)&&n.shouldPerformETagVerification&&(m(n,r,e,o,!0),o.errorReason))return i.reject({statusText:o.errorReason});e.incrementCompletedParts(),e.uploadedByte+=Math.min(c.UPLOAD.PART_SIZE_IN_BYTES,e.totalBytes-(t-1)*c.UPLOAD.PART_SIZE_IN_BYTES),e.progress=100*e.uploadedByte/e.totalBytes,e.addEtag(t,a.headers().etag)}},B=function(e,t,n,r){var a=0,s=c.UPLOAD.PART_SIZE_IN_BYTES,l=function(t){t&&(t.operation=r,e.uploadDeferredObject.notify(t))},u=function(e){return n.reject(e),i.reject(e)};e.uploadedByte=0,e.totalBytes=e.filePointer.size,e.calculatedMD5s={};for(var d=i.when(),p=1;p<=e.numberOfParts;p++){var g=e.filePointer.slice(a,s);d=d.then(function(t){return function(){return f.calculateMD5(t,e.id,r.id)}}(g)),d=d.then(x(e,{uploadId:t,partNumber:p},r)),d=d.then(D(e,a,s,r,p)).then(j(e,p,r),u,l),a+=c.UPLOAD.PART_SIZE_IN_BYTES,s+=c.UPLOAD.PART_SIZE_IN_BYTES}if(!d)return void n.reject({statusText:o.instant("upload.unexpected.error")});d.then(function(){n.resolve(t)})},F=function(e,t){var n={};n.destKey=e.destKey,n.destBucket=e.destBucket,n.id=e.id,n.fileName=e.filePointer.name,n.uploadedByte=e.uploadedByte,n.totalBytes=e.totalBytes,n.progress=e.completedParts/e.numberOfParts*100,n.operation=t,e.uploadDeferredObject.notify(n)},U=function(e,t){return function(n){var r=i.defer();return F(e,t),B(e,n,r,t),r.promise}},K=function(e,t){if(e.numberOfParts>c.UPLOAD.MAX_NUMBER_OF_PARTS||e.numberOfParts<=c.UPLOAD.MIN_NUMBER_OF_PARTS)return void I(e.id,t)({statusText:"A multipart upload needs between 2 and 10000 parts to be a valid upload."});u.initiateMultipartUpload(e.destKey,e.destBucket,e.headers,e.cancelDeferredObject.promise,t).then(U(e,t)).then(function(n){return u.completeMultipartUpload(e.destKey,e.destBucket,n,e.etags,e.cancelDeferredObject.promise,t)}).then(O(e.id,t)).catch(I(e.id,t))},V=function(e,t){p.log("UploadFileSize",e.filePointer.size,t,{name:e.filePointer.name}),e.filePointer.size<=c.UPLOAD.PART_SIZE_IN_BYTES?L(e,t):K(e,t)};this.upload=function(t,n,r,a,o,u){if(!r)return void p.log("UploadNoBucketError",1,o);if(s.evictBucketObjects(r),!a||void 0!==b[a])return void p.log("InvalidUploadFileId",1,o);var d=i.defer(),f=i.defer(),m=t.name;n&&(m=n+m);var h=e.copy(u);h.metadata["Content-Type"]||(h.metadata["Content-Type"]=g.getContentType(t));var v=new l(a,t,d,f,m,r,h,c.UPLOAD.PART_SIZE_IN_BYTES);return b[a]=v,V(v,o),s.deleteCurrentVersions(r,m),v.uploadDeferredObject.promise},this.cancelUpload=function(e,t){b[e]?(b[e].cancelDeferredObject.resolve(e),b[e].isCancelled=!0,p.log("UploadCancel",1,t)):p.log("UploadCancel",0,t)},this.fileSelected=function(){return y()}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("DirectoryExplorerService",["$q","ConsoleOperation","S3Constants","SCLogService","UploadService","UtilService",function(e,t,n,r,i,a){function o(t,i){function o(t,a,s,l,p,f,g){var b=[];a.readEntries(function(v){var E=void 0;if(0!==v.length){for(var S in v)if(E=v[S],E.isDirectory)p.enqueue(E);else{l++,I++;var y=u(E);b.push(y),y.then(function(e){s+=e,e>n.UPLOAD.MAX_OBJECT_SIZE&&(g=!0)})}e.all(b).then(function(){o(t,a,s,l,p,f,g)},function(e){var n=c(t,s,l);r.log(i.name+m,0,i,{error:e,explorerId:C,folder:n}),f.resolve(n)})}else if(0===p.getLength())r.log(i.name+h,1,i,{explorerId:C,folderSize:s,folderName:t.name,fullPath:t.fullPath,objsCount:l,hasOversizedObjects:g}),f.resolve(c(t,s,l,g));else{var A=d(p.dequeue().createReader());o(t,A,s,l,p,f,g)}},function(e){r.log(i.name+h,0,i,{error:e,explorerId:C}),f.reject(e)})}function s(){var t=e.defer();if(P||(P=y(),N=P?d(P.createReader()):void 0),!N){if(0===M.getLength())return r.log(i.name+g,1,i,{explorerId:C,selectedItems:E()}),t.resolve(void 0),t.promise;P=y(),N=d(P.createReader()),x=!0}return p(t,i),t.promise}function p(t,n){var i=void 0,a=[],o=[];N.readEntries(function(s){var u=void 0;0===s.length?(x&&(u=c(P,0,0)),P=y(),N=P?d(P.createReader()):void 0,x=!0):x=!1;for(var p in s)i=s[p],i.isDirectory?M.enqueue(i):l(i,a,o,P.fullPath.substr(1)+"/",n);e.all(o).then(function(){t.resolve({fileList:a,emptyFolderToBeUploaded:u})},function(e){r.log(n.name+g,0,n,{error:e,explorerId:C}),t.reject(e)})},function(e){r.log(n.name+g,0,n,{error:e,explorerId:C}),t.reject(e)})}function E(){return{currFolderPathPrefix:"",folders:k,objects:O,totalObjCount:I}}function S(e){for(var t in e)L[e[t]]=!0;r.log(i.name+b,1,i,{explorerId:C,originalFolders:E().folders,newlyOveriddenFolders:e})}function y(){for(var e=M.dequeue();e;){if(e.fullPath!=="/"+e.name||!L[e.name])return e;r.log(i.name+v,1,i,{explorerId:C,skippedFolderName:e.name}),e=M.dequeue()}}for(var A=e.defer(),C=i.explorers.length+1,_={getNext:s,getSelectedItems:E,explorerId:C,setOverriddenFolders:S},w=void 0,T=[],R=[],O=[],k=[],I=0,P=void 0,N=void 0,M=void 0,L={},x=!0,D=t.length,j=0;j<D;j++)(w=t[j].webkitGetAsEntry())&&(w.isDirectory?T.push(w):l(w,O,R,"",i).then(function(){I++},function(e){r.log(i.name+f,0,i,{error:e,explorerId:C}),A.reject(e)}));for(var B in T){var F=e.defer();P=T[B],o(P,d(P.createReader()),0,0,a.createQueue(),F,!1),R.push(F.promise),F.promise.then(function(e){k.push(e),0===e.objsCount&&I++})}return e.all(R).then(function(){M=a.createQueue(T),P=void 0,N=void 0,r.log(i.name+f,1,i,{explorerId:C,selectedItems:E()}),A.resolve(_)},function(e){r.log(i.name+f,0,i,{error:e,explorerId:C}),A.reject(e)}),A.promise}function s(e,t,n){return{file:e,fullPath:n,id:t,Key:e.name,Size:e.size}}function c(e,t,n,r){var i=e.fullPath.substr(1);return i=i.substr(0,i.length-e.name.length-1),i=""===i?i:i+"/",{folderSize:t,fullPath:i,Prefix:e.name,objsCount:n||1,hasOversizedObjects:r}}function l(t,n,r,a,o){var c=e.defer();return r.push(c.promise),t.file(function(e){var t=i.fileSelected(e,o);n.push(s(e,t,a)),c.resolve()},function(e){c.reject(e)}),c.promise}function u(t){var n=e.defer();return t.file(function(e){n.resolve(e.size)}),n.promise}function d(e){function t(t,i){0===r.length?e.readEntries(function(e){e.length>n?(r=e,t(r.splice(0,n))):t(e)},i):t(r.splice(0,n))}var n=3,r=[];return{readEntries:t}}var p={createExplorer:o,processFile:s},f="CreatedExplorer",g="ExplorerTraversalComplete",m="GetFolderSize",h="InitialFolderTraversal",b="OverrideFolders",v="SkipOverriddenFolder";return p}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y){function A(e,t){for(var r=t?n.operation.explorers.length-1:n.operation.explorers.length,i=[],a=0;a<e.length;a++)i.push(e[a].Prefix);for(var o=0;o<r;o++)n.operation.explorers[o].setOverriddenFolders(i);h.log(n.operation.name+R,1,n.operation,{folderNames:i,numberOfExplorersOverridden:r,selectedFilesData:n.getSelectedFilesData()})}function C(e){e.then(function(e){for(var r=e.getSelectedItems(),i=r.folders,a=r.objects,o=void 0,s=void 0,c=function(e){return o.Prefix!==e.Prefix},l=function(e){return s.Key!==e.Key},u=0;u<i.length;u++)o=i[u],n.selectedItems.folders=t.filter(n.selectedItems.folders,c);for(var d=0;d<a.length;d++)s=a[d],n.selectedItems.objects=t.filter(n.selectedItems.objects,l);n.selectedItems.folders=n.selectedItems.folders.concat(i),n.selectedItems.objects=n.selectedItems.objects.concat(a),n.operation.explorers.push(e),n.operation.explorers.length>1&&(h.log(n.operation.name+T,1,n.operation,{newExplorerId:e.explorerId,numberOfExplorersCreated:n.operation.explorers.length,selectedItems:e.getSelectedItems()}),A(i,!0)),k.dequeue(),k.getLength()>0?C(k.peek()):n.uploadDisabled=!1},function(e){n.error=e})}function _(e){for(var t=0;t<n.selectedItems.objects.length;t++)if(n.selectedItems.objects[t].Key===e)return t;return-1}function w(){n.kmsKeys=[];var e=new l("GetKMSKeysForUpload"),t=g.getCurrentBucket();return S.getKMSKeysById(e,t,m.UPLOAD.CUSTOM_ARN).then(function(e){n.kmsKeys=e,n.errorMessage===n.KMSServiceError&&(n.errorMessage=null),n.KMSServiceError=null}).catch(function(e){n.KMSServiceError=e,n.errorMessage=e})}var T="MultipleDropEvents",R="OverrideExplorers",O=t.cloneDeep(m.BUCKET_PERMISSIONS.INITIALIZE_ACLS);s.getBucketOwner(new l("getBucketOwner")).then(function(e){O.userPermissions[0].detail=e,n.options.permissions.userPermissions[0].detail=e});var k=v.createQueue();n.operation=null,n.S3Constants=m,n.docsUrls={uploadObjects:c.getDocUrl(m.LEARN_MORE_LINKS.UPLOAD_OBJECTS)},n.predefinedMetadata=p.getPredefinedMetadata(),n.$watchCollection("selected",function(){n.selectedItems=n.selected.selectedItems}),n.$watchCollection("flags",function(){n.uploadDisabled=n.flags.uploadDisabled}),n.STEP={SELECT_FILES:{name:"SELECT_FILES",value:a.instant("uploadmodal.label.selectfiles")},PERMISSIONS:{name:"PERMISSIONS",value:a.instant("uploadmodal.label.setpermissions")},PROPERTIES:{name:"PROPERTIES",value:a.instant("uploadmodal.label.setproperties")},REVIEW:{name:"REVIEW",value:a.instant("uploadmodal.label.review")}},n.state=n.STEP.SELECT_FILES,n.headerTitle=a.instant("uploadmodal.header.title"),n.currentTagging={Key:"",Value:""},n.MODAL_TYPE=m.MODAL_TYPE;var I=i.$on("fileDropEvent",function(e,t){if(n.modalOpen.flag&&!e.defaultFired){n.state=n.STEP.SELECT_FILES,n.uploadDisabled=!0,n.operation||(n.operation=b.createUploadOperation());var r=u.createExplorer(t,n.operation);k.enqueue(r),1===k.getLength()?C(k.peek()):h.log(n.operation.name+"SimultaneousDrop",1,n.operation,{numberOfDropsToBeProcessed:k.getLength()})}});if(n.goToNextState=function(){if(n.state===n.STEP.SELECT_FILES)v.analyticsTrackClick(m.ANALYTICS.SELECT_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),v.analyticsTrackView(m.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3);else if(n.state===n.STEP.PERMISSIONS){if(v.analyticsTrackClick(m.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),v.analyticsTrackView(m.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),!0===n.isAddingAwsAccountAcl.flag)return void(n.isAddingAwsAccountAcl.warningMsg=a.instant("uploadmodal.awsaccounts.warningmsg"));n.isAddingAwsAccountAcl.warningMsg=null}else if(n.state===n.STEP.PROPERTIES){if(v.analyticsTrackClick(m.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),v.analyticsTrackView(m.ANALYTICS.REVIEW_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),!t.isEmpty(n.tmpMetadata.metadataKey)||!t.isEmpty(n.tmpMetadata.metadataValue))return void(n.metadataWarningMsg=a.instant("uploadmodal.metadata.warningmsg"));if(n.metadataWarningMsg=null,!t.isEmpty(n.currentTagging.key))return void(n.taggingError=a.instant("uploadmodal.tag.warningmsg"));n.taggingError=null}n.nextState()},n.removeItemFromUpload=function(e){e.Key?(n.selectedItems.objects=t.filter(n.selectedItems.objects,function(t){return e.Key!==t.Key}),h.log(n.operation.name+"FileRemoved",1,n.operation,{fileName:e.Key})):e.Prefix&&(n.selectedItems.folders=t.filter(n.selectedItems.folders,function(t){return e.Prefix!==t.Prefix}),A([e],!1),h.log(n.operation.name+"FolderRemoved",1,n.operation,{folderName:e.Prefix})),n.haveSelectedItems()||(n.uploadDisabled=!0)},n.filesSelected=function(e){n.operation||(n.operation=b.createUploadOperation()),n.$apply(function(){if(e&&e.files&&e.files.length>0){n.operation.newlySelectedFiles=e.files,h.log("FilesSelectedFor"+n.operation.name,e.files.length,n.operation);for(var t=0;t<e.files.length;t++){var r=e.files[t],i=_(r.name),a=b.selectFile(r,n.operation);i>-1?n.selectedItems.objects.splice(i,1,u.processFile(r,a)):n.selectedItems.objects.push(u.processFile(r,a))}n.uploadDisabled=!1}})},n.uploadNow=function(){function r(){n.$parent.refreshAndClearObjectsCacheForCurrentBucket()}if(!n.operation||!n.selectedItems.objects&&!n.selectedItems.folders||0===n.selectedItems.objects.length&&0===n.selectedItems.folders.length)throw"No file selected";v.analyticsTrackClick(m.ANALYTICS.END_UPLOAD_FILE,m.ANALYTICS.UPLOAD_FILE_S3),!t.eq(e.toJson(n.options.permissions),e.toJson(O))||n.options.permissions.awsAccountPermissions&&0!==n.options.permissions.awsAccountPermissions.length||(n.options.permissions=void 0);var i=new l(m.OPERATION_NAME.GET_DEFAULT_ENCRYPTION),a=!0;s.getBucketProperty(i,g.getCurrentBucket(),"defaultEncryption").then(function(e){if(t.get(e,"response")){h.log("GetDefaultEncryptionForUpload",1,i);var n=E.convertXmlStringToJson(e.response);t.get(n,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.SSEAlgorithm")===m.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AWSKMS&&(a=!1)}else h.log("GetDefaultEncryptionForUpload",0,i)}).catch(function(e){e!==m.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NOT_FOUND_ERROR?(h.log("GetDefaultEncryptionForUpload",0,i),a=!1):h.log("GetDefaultEncryptionForUpload",1,i)}).finally(function(){b.setupUploadOperation(n.operation,n.selectedItems.folders,n.selectedItems.objects,n.getSelectedFilesData(),n.options,r,a),n.clearFileInput(),f.addOperation(n.operation),n.closeModal(),n.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]},n.resetOptions()})},n.clearFileInput=function(){var e=r("#uploadInput");e&&e.get(0)&&(e.wrap("<form>").closest("form").get(0).reset(),e.unwrap())},n.closeModal=function(){n.state===n.STEP.SELECT_FILES&&n.clearFileInput(),n.state=n.STEP.SELECT_FILES,n.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]},n.modalOpen.flag=!1,n.uploadDisabled=!0,n.operation=void 0,n.resetOptions()},n.haveSelectedItems=function(){return n.selectedItems&&n.selectedItems.folders&&!t.isEmpty(n.selectedItems.folders)||n.selectedItems&&n.selectedItems.objects&&!t.isEmpty(n.selectedItems.objects)},n.addMetadataOptionsHeader=function(e){if(n.metadataErrorMsg="",n.metadataWarningMsg=null,p.isValid([e])){var r=p.getMetadataMap([e]),i=Object.keys(r)[0],a=n.predefinedMetadata[t.findIndex(n.predefinedMetadata,{value:i})];a=t.isEmpty(a)?i:a.text,Object.keys(n.options.metadata).indexOf(i)>-1?n.metadataErrorMsg=a:(n.options.displayMetadata[a]=r[i],n.options.metadata[i]=r[i],n.tmpMetadata={})}},n.clearMetadataErrorMsg=function(e){e.inputError=null},n.metaErrorReset=function(){n.metadataErrorMsg=""},n.resetMetadataOptionsHeader=function(){n.tmpMetadata={},n.metadataErrorMsg=null,n.metadataWarningMsg=null},n.resetTagKeyValue=function(){n.currentTagging.key="",n.currentTagging.value="",n.taggingError=null},n.deleteMetadataHeader=function(e){var r=n.predefinedMetadata[t.findIndex(n.predefinedMetadata,{text:e})];r=t.isEmpty(r)?e:r.value,delete n.options.displayMetadata[e],delete n.options.metadata[r]},n.addTag=function(e,r){if(!t.isEmpty(e)){if(Object.keys(n.options.tags).indexOf(e)>-1)return void(n.taggingError=a.instant("objectproperties.tags.duplicatekeynames"));if(Object.keys(n.options.tags).length>=m.TAGGING.MAX_ALLOWED_TAGS)return void(n.taggingError=a.instant("objectproperties.tags.morethantentagswarning"));n.taggingError=null,n.options.tags[e]=r,n.currentTagging={Key:"",Value:""}}},n.deleteTag=function(e){delete n.options.tags[e]},n.updateTaggingError=function(e){Object.keys(n.options.tags).indexOf(e)>-1||Object.keys(n.options.tags).length>=m.TAGGING.MAX_ALLOWED_TAGS||(n.taggingError=null)},n.resetOptions=function(){n.isAddingAwsAccountAcl={flag:!1},n.options={storageClass:m.STORAGE_CLASSES.STANDARD,metadata:{},displayMetadata:{},tags:{}},n.metadataHeaders={acceptedHeaders:[],headerNames:[m.HEADERS.CACHE_CONTROL,m.HEADERS.CONTENT_DISPOSITION,m.HEADERS.CONTENT_ENCODING,m.HEADERS.CONTENT_LENGTH,m.HEADERS.CONTENT_TYPE,m.HEADERS.EXPECT,m.HEADERS.EXPIRES,m.HEADERS.X_AMZ_WEBSITE_REDIRECT_LOCATION]},n.metadataHeaders.headers=n.metadataHeaders.headerNames.map(function(e){return{value:e,text:e,disabled:!1}}),n.metadataErrorMsg="",n.errorMessage=null,n.KMSServiceError=null,n.tmpMetadata={},n.taggingError=null,n.currentTagging={Key:"",Value:""},n.options.permissions=t.cloneDeep(O)},n.getSelectedFilesData=function(){if(n.hasOversizedObjects=!1,!n.selectedItems)return{files:0,size:0};var e=0,t=0,r=void 0,i=void 0;for(var a in n.selectedItems.folders)r=n.selectedItems.folders[a],t+=r.objsCount,e+=r.folderSize,r.hasOversizedObjects&&(n.hasOversizedObjects=!0);for(var o in n.selectedItems.objects)i=n.selectedItems.objects[o],t++,e+=i.Size,i.Size>m.UPLOAD.MAX_OBJECT_SIZE&&(n.hasOversizedObjects=!0);return{files:t,size:e}},n.getGranteeCount=function(){var e=0;return Object.keys(n.options.permissions||{}).forEach(function(r){n.options.permissions[r].forEach(function(n){void 0!==t.findKey(n.permissions,function(e){return!0===e})&&e++})}),e},n.$on("$destroy",function(){I()}),n.resetOptions(),n.getStorageClassTranslation=function(){return v.getStorageClassTranslations()[n.options.storageClass]},n.getStorageClassDocUrl=function(){return c.getDocUrl(m.LEARN_MORE_LINKS.STORAGE_CLASS)},n.getEncryptionTranslation=function(){var e=n.options.serverSideEncryption===m.OBJECT_SSE.NONE?"uploadmodal.review.encryption.no":"uploadmodal.review.encryption.yes";return a.instant(e)},n.getEncryptionDescriptionTranslation=function(){var e="uploadmodal.properties.encryption.description";return d.isFeatureEnabled(m.FAC.KMS)||(e="uploadmodal.properties.nokms.encryption.description"),a.instant(e)},n.updateKMSKey=function(e){e===m.OBJECT_SSE.KMS_ENCRYPTION?w():(t.isEmpty(n.errorMessage)||n.errorMessage!==n.KMSServiceError||(n.errorMessage=null),n.KMSServiceError=null)},n.setEncryptionOption=function(){n.options.serverSideEncryption||(d.isFeatureEnabled(m.FAC.NO_ENC)?n.options.serverSideEncryption=m.OBJECT_SSE.NONE:n.options.serverSideEncryption=m.OBJECT_SSE.AES256)},n.isDragAndDropAvailable=function(){return void 0!==o.DataTransferItem},n.onSelectStorageClass=function(e){n.options.storageClass=e},d.isFeatureEnabled(m.FAC.PUBLIC_ACCESS_BLOCK)){var P=g.getCurrentBucket();y.getAllSettings(P).then(function(e){var t=e.accountSettings,r=e.bucketSettings;if(t.blockPublicAcls||r.blockPublicAcls){var i=t.blockPublicAcls&&r.blockPublicAcls?"both":t.blockPublicAcls?"account":"bucket";n.blockPublicACLsMessage=a.instant("lockdown.warning.blocked.acls."+i)}})}}e.module("s3").controller("UploadController",["$scope","$rootScope","$translate","$window","APIProxyService","AwsUrlsService","ConsoleOperation","DirectoryExplorerService","FAC","ObjectPropertiesService","OperationDispatcherService","PathService","S3Constants","SCLogService","UploadOperationService","UtilService","XMLParser","KMSPropertiesService","PublicAccessService",i]),e.module("s3").directive("uploadModal",[function(){return{scope:{modalOpen:"=",currentPath:"=",fetchObjects:"=",operation:"=",selected:"=",flags:"="},template:n(536),controller:"UploadController"}}])}()}).call(t,n(0),n(2),n(6))},function(e,t){e.exports='<modal is-open=modalOpen close-callback=closeModal id=uploadModal current-path=currentPath steps=STEP state=state header-title=headerTitle next-state=nextState previous-state=previousState set-state=setState class="upload-modal large-modal"> <modal-content> <div class=upload-modal-selected-files-properties ng-show="haveSelectedItems() && state !== STEP.REVIEW"> <div class="upload-modal-selected-files-properties-inner-div truncate"> <span class=upload-modal-selected-files-properties-span> {{ getSelectedFilesData().files }} <span translate=uploadmodal.label.files></span> </span> <span class=upload-modal-selected-files-properties-span> <span class=upload-modal-selected-files-properties-span-header translate=uploadmodal.label.size></span> {{ getSelectedFilesData().size | humanReadableBytes }} </span> <span class=upload-modal-selected-files-properties-span> <span class=upload-modal-selected-files-properties-span-header translate=uploadmodal.label.path></span> {{ currentPath }} </span> </div> </div> <div class=upload-modal-content> <div ng-if="state === STEP.SELECT_FILES"> <div class=upload-modal-over-80gb-warning> <span translate=uploadmodal.largefiles.info></span> <learn-more-link light=true href={{docsUrls.uploadObjects}}></learn-more-link> <awsui-alert type=error header="{{\'uploadmodal.largefiles.header\'|translate}}" ng-if=hasOversizedObjects>{{\'uploadmodal.largefiles.error\'|translate}}</awsui-alert> </div> <div id=upload-modal-initial-select ng-show=!haveSelectedItems()> <div class="file-and-folder drag-and-drop-image"></div> <div ng-if=isDragAndDropAvailable() class=drag-and-drop-text translate=uploadmodal.label.draganddrop></div> <div ng-if=!isDragAndDropAvailable() class=drag-and-drop-no-text></div> <input type=file id=uploadInput name=uploadInput fileread multiple=multiple /> <label id=uploadInputNoFilesSelected for=uploadInput>{{ \'uploadmodal.label.add.files\' | translate }}</label> </div> <label ng-if="!haveSelectedItems() && !isDragAndDropAvailable()" class=drag-and-drop-info translate=uploadmodal.label.draganddropinfo></label> <awsui-alert type=error header=Error ng-show=errorMessage> {{ errorMessage }} </awsui-alert> <file-list-in-modal remove-item-from-upload=removeItemFromUpload(item) close-icon-show=true for-uploads=true selected=selected></file-list-in-modal> </div> <div ng-if="state === STEP.PERMISSIONS" class=upload-modal-permissions-content> <modal-permissions public-permissions=options.permissions.publicPermissions user-permissions=options.permissions.userPermissions aws-account-permissions=options.permissions.awsAccountPermissions is-adding-account=isAddingAwsAccountAcl modal-type=MODAL_TYPE.UPLOAD block-public-acls-message=blockPublicACLsMessage></modal-permissions> </div> <div ng-if="state === STEP.PROPERTIES" class=upload-modal-property-content> <div class=upload-modal-properties-group> <div> <h2 class=upload-modal-properties-group-header translate=uploadmodal.label.storage-class></h2> </div> <storage-class-table storageclassvalue=options.storageClass on-select-storage-class=onSelectStorageClass theme=dark class=storage-class-container--dark></storage-class-table> </div> <div class=upload-modal-properties-group> <div> <h2 class=upload-modal-properties-group-header translate=uploadmodal.label.encryption></h2> </div> <h2 class=upload-modal-properties-group-desc> {{ getEncryptionDescriptionTranslation() }} </h2> <awsui-radio-group ng-model=options.serverSideEncryption ng-init=setEncryptionOption() ng-change=updateKMSKey(options.serverSideEncryption)> <table class=upload-modal-radio-button-properties> <tr> <td fac-id=s3-no-enc> <awsui-radio-button class="radio-button with-info" value={{S3Constants.OBJECT_SSE.NONE}}>{{ \'uploadmodal.label.none\' | translate }}</awsui-radio-button> <awsui-tooltip text="{{ \'uploadmodal.properties.defaultencryption.info\' | translate }}" position=bottom size=small> <i class="awsui-icon info-circle awsui-icon-link"></i> </awsui-tooltip> </td> <td> <awsui-radio-button class=radio-button value={{S3Constants.OBJECT_SSE.AES256}}>{{ \'uploadmodal.label.AES256\' | translate }}</awsui-radio-button> </td> <td fac-id=s3-kms> <awsui-radio-button class=radio-button value={{S3Constants.OBJECT_SSE.KMS_ENCRYPTION}}>{{ \'uploadmodal.label.kms\' | translate }}</awsui-radio-button> </td> </tr> </table> </awsui-radio-group> <awsui-select ng-if="options.serverSideEncryption===S3Constants.OBJECT_SSE.KMS_ENCRYPTION && !KMSServiceError" items=kmsKeys placeholder="{{ \'uploadmodal.placeholder.kmskeys\' | translate }}" ng-model=options.kmsId class=upload-modal-properties-kms-dropdown> </awsui-select> <awsui-textfield class=upload-modal-kms-textfield ng-if="options.kmsId===\'CUSTOM_ARN\' || options.serverSideEncryption===S3Constants.OBJECT_SSE.KMS_ENCRYPTION && KMSServiceError" ng-model=options.kmsARN placeholder="{{ \'uploadmodal.kms.customarn\' | translate }}"></awsui-textfield> </div> <div class=upload-modal-properties-group> <div> <h2 class=upload-modal-properties-group-header translate=uploadmodal.label.metadata></h2> </div> <h2 class=upload-modal-properties-group-desc translate=uploadmodal.properties.metadata.description></h2> <table class=upload-modal-metadata-properties> <thead> <th class=header-key translate=uploadmodal.metadata.label.header></th> <th class=header-value translate=uploadmodal.metadata.label.value></th> <th></th> </thead> <tbody> <tr ng-repeat="(key, value) in options.displayMetadata" class=upload-modal-metadata-properties-textfield style=color:#fff> <td style=margin-top:5px> {{ key }}</td> <td style=margin-top:5px> {{ value }}</td> <td colspan=2> <span style=cursor:pointer;margin-left:10px ng-click=deleteMetadataHeader(key)> X </span> </td> </tr> <tr class=upload-modal-metadata-properties-textfield> <td class=uploadmodal-metadata-key> <awsui-control-group validation-message="{{ tmpMetadata.metadataKey.error }}"> <dropdown items=predefinedMetadata selected-item=tmpMetadata.metadataKey filter=true placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown> </awsui-control-group> </td> <td class=uploadmodal-metadata-value> <awsui-control-group validation-message="{{ tmpMetadata.metadataValue.error || tmpMetadata.metadataValue.inputError }}"> <dropdown ng-if="tmpMetadata.metadataKey.dropDownValue && tmpMetadata.metadataKey.dropDownValue.length > 2" items=tmpMetadata.metadataKey.dropDownValue selected-item=tmpMetadata.metadataValue enable-input=true filter=true input-field=tmpMetadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"> </dropdown> <dropdown ng-if="tmpMetadata.metadataKey.dropDownValue && tmpMetadata.metadataKey.dropDownValue.length <= 2" items=tmpMetadata.metadataKey.dropDownValue selected-item=tmpMetadata.metadataValue enable-input=true input-field=tmpMetadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"> </dropdown> <awsui-textfield ng-if="tmpMetadata.metadataKey && !tmpMetadata.metadataKey.dropDownValue" ng-model=tmpMetadata.metadataValue.text ng-change=clearMetadataErrorMsg(tmpMetadata.metadataValue) style=margin-top:0></awsui-textfield> <awsui-textfield ng-if=!tmpMetadata.metadataKey data-disabled=true style=margin-top:0></awsui-textfield> </awsui-control-group> </td> <td class=uploadmodal-metadata-savebutton> <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant=normal ng-click=addMetadataOptionsHeader(tmpMetadata) data-disabled=!tmpMetadata.metadataKey> </awsui-button> </td> <td class=uploadmodal-metadata-savebutton> <awsui-button text="{{ \'uploadmodal.metadata.clearbutton\' | translate }}" variant=normal ng-click=resetMetadataOptionsHeader() data-disabled=!tmpMetadata.metadataKey> </awsui-button> </td> </tr> <tr> <td colspan=4> <awsui-alert class=input-error type=error header="{{ \'error.header\' | translate }}" ng-if=metadataErrorMsg dismissable=true> <p translate=objectdetail.metadata.multisamekeywarning translate-values="{ errorMsg : \'{{metadataErrorMsg}}\' }"></p> </awsui-alert> <awsui-alert class=input-error header="{{ \'warning.header\' | translate }}" visible=metadataWarningMsg type=error> {{ metadataWarningMsg }}</awsui-alert> </td> </tr> </tbody> </table> </div> <div class="upload-modal-properties-group uploadmodal-tags" fac-id=s3-ot> <h2 class=upload-modal-properties-group-header translate=uploadmodal.label.tags></h2> <h2 class=upload-modal-properties-group-desc translate=uploadmodal.tags.description></h2> <table class=upload-modal-tag-properties> <thead> <th translate=uploadmodal.tags.label.header class=header-key></th> <th translate=uploadmodal.tags.label.value class=header-value></th> <th></th> <th></th> </thead> <tbody> <tr ng-repeat="(key, value) in options.tags" class=upload-modal-tags-textfield style=color:#fff> <td style=margin-top:5px> {{ key }}</td> <td style=margin-top:5px> {{ value }}</td> <td colspan=2> <span style=cursor:pointer;margin-left:10px ng-click=deleteTag(key)> X </span> </td> </tr> <tr class=upload-modal-tags-textfield> <td class=tagkey> <awsui-textfield ng-model=currentTagging.key placeholder="{{ \'uploadmodal.tags.placehoder.key\' | translate }}" ng-change=updateTaggingError(currentTagging.key)> </awsui-textfield> </td> <td class=tagvalue> <awsui-textfield ng-model=currentTagging.value placeholder="{{ \'uploadmodal.tags.placehoder.value\' | translate }}"> </awsui-textfield> </td> <td class=uploadmodal-metadata-savebutton> <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant=normal ng-click="addTag(currentTagging.key, currentTagging.value)" data-disabled=!currentTagging.key> </awsui-button> </td> <td class=uploadmodal-metadata-savebutton> <awsui-button text="{{ \'uploadmodal.metadata.clearbutton\' | translate }}" variant=normal ng-click=resetTagKeyValue() data-disabled=!currentTagging.key> </awsui-button> </td> </tr> <tr> <td colspan=4> <awsui-alert class=input-error header="{{ \'warning.header\' | translate }}" visible=taggingError type=error> {{ taggingError }}</awsui-alert> </td> </tr> </tbody> </table> </div> </div> <div ng-if="state === STEP.REVIEW"> <div class=review-section> <table id=review-table class=review-table> <tr> <td class=review-subheader translate=uploadmodal.label.files></td> <td class=edit-button> <awsui-button class=button-in-darkbg text="{{ \'uploadmodal.label.edit\' | translate }}" variant=link ng-click=setState(STEP.SELECT_FILES)> </awsui-button> </td> </tr> </table> <table class=review-table-details> <tr class=details> <td>{{ getSelectedFilesData().files }} <span translate=uploadmodal.label.files></span> </td> <td><span translate=uploadmodal.label.size></span> {{ getSelectedFilesData().size | humanReadableBytes }} </td> </tr> </table> </div> <div class=review-section> <table class=review-table> <tr> <td class=review-subheader translate=uploadmodal.label.permissions></td> <td class=edit-button> <awsui-button class=button-in-darkbg text="{{ \'uploadmodal.label.edit\' | translate }}" variant=link ng-click=setState(STEP.PERMISSIONS)> </awsui-button> </td> </tr> </table> <table class=review-table-details> <tr class=details> <td>{{ getGranteeCount() }} <span translate=uploadmodal.label.grantees></span></td> </tr> </table> </div> <div class=review-section> <table class=review-table> <tr> <td class=review-subheader translate=uploadmodal.label.properties></td> <td class=edit-button> <awsui-button class=button-in-darkbg text="{{ \'uploadmodal.label.edit\' | translate }}" variant=link ng-click=setState(STEP.PROPERTIES)> </awsui-button> </td> </tr> </table> <table class=review-table-details> <tr class=detail-name> <th translate=uploadmodal.label.encryption></th> <th translate=uploadmodal.label.storage-class></th> </tr> <tr class=details> <td>{{ getEncryptionTranslation() }}</td> <td>{{ getStorageClassTranslation() }}</td> </tr> <tr class=detail-name> <th class=awsui-util-pt-m translate=uploadmodal.label.metadata></th> <th></th> </tr> <tr class=details ng-repeat="(key, value) in options.displayMetadata"> <td>{{ key }}</td> <td>{{ value }}</td> </tr> <tr class=detail-name fac-id=s3-ot> <th class=awsui-util-pt-m translate=uploadmodal.label.tags></th> <th></th> </tr> <tr class=details ng-repeat="(key, value) in options.tags" fac-id=s3-ot> <td>{{ key }}</td> <td>{{ value }}</td> </tr> </table> </div> <div ng-show="completedFiles.length > 0"> <h3>Uploaded File(s):</h3> <table class="table table-striped"> <thead> <tr> <th>Name</th> <th>Etag</th> </tr> </thead> <tbody> <tr ng-repeat="uploadResult in completedFiles"> <td>{{ uploadResult.name }}</td> <td>{{ uploadResult.etag }}</td> </tr> </tbody> </table> </div> <div ng-show="errorFiles.length > 0"> <h3>File(s) That Had Errors:</h3> <table class="table table-striped"> <thead> <tr> <th>Name</th> <th>Error</th> </tr> </thead> <tbody> <tr ng-repeat="uploadResult in errorFiles"> <td>{{ uploadResult.name }}</td> <td>{{ uploadResult.errorMessage }}</td> </tr> </tbody> </table> </div> <awsui-alert type=error header=Error ng-show=errorMessage> {{ errorMessage }} </awsui-alert> </div> </div> </modal-content> <modal-footer> <div class=upload-modal-footer> <awsui-button text="{{ \'uploadmodal.footer.upload\' | translate }}" variant=primary ng-class="{\'awsui-util-f-l\': state !== STEP.REVIEW, \'awsui-util-f-r primary-button\': state === STEP.REVIEW}" click=uploadNow() data-disabled="uploadDisabled || hasOversizedObjects"> </awsui-button> <awsui-button id=next ng-if="state !== STEP.REVIEW" variant=primary text="{{ \'uploadmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click=goToNextState() data-disabled="!haveSelectedItems() || metadataErrorMsg || tmpMetadata.metadataKey && tmpMetadata.metadataKey.error || tmpMetadata.metadataValue && tmpMetadata.metadataValue.inputError"> </awsui-button> <awsui-button id=previous text="{{ \'uploadmodal.footer.previous\' | translate }}" ng-if="state !== STEP.SELECT_FILES" class=awsui-util-f-r click=previousState()> </awsui-button> </div> </modal-footer> </modal> '},function(e,t,n){"use strict";(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.module("s3").factory("SCLogService",["$filter","$location","AWSC","CachingService","ConsoleOperation","PathService","Region","S3Constants","UtilService",function(e,r,i,a,o,s,c,l,u){function d(e){var t;for(t=0;t<e.length;++t)if(void 0===e[t]||null===e[t])return!1;return!0}function p(e,t){if(null!==t&&"object"===(void 0===t?"undefined":n(t)))for(var r in t)t.hasOwnProperty(r)&&!v.hasOwnProperty(r)&&(e[r]=t[r])}function f(e,t){if(void 0!==t&&null!==t)for(var n in v)v.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(e[n]=t[n])}function g(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function m(t,n,r,i,o,c){var u={};u[l.OPERATION.NAME]=r.name,u[l.OPERATION.ID]=r.id,u[l.OPERATION.STEP]=r.step,u[l.OPERATION.INITIAL_BUCKET]=r.initialBucket,u[l.OPERATION.INITIAL_PATH]=r.initialPath,u[l.OPERATION.BUCKET_REGION]=r.bucketRegion;var d=Object.keys(r);for(var m in d)E[d[m]]||(u[d[m]]=r[d[m]]);i instanceof Date||(i=new Date),u[l.OPERATION.TIMESTAMP]=e("date")(i,"yyyy-MM-dd-HH-mm-ss.sss","UTC"),u[l.OPERATION.CURRENT_BUCKET]=s.getCurrentBucket()||"",u[l.OPERATION.CURRENT_PATH]=s.getCurrentAbsoluteFolderPath()||"",g(u,o),p(u,c),u[l.OPERATION.CURRENT_BUCKET]&&a.getBucketLocation(u[l.OPERATION.CURRENT_BUCKET]);var h={key:t,value:n,detail:JSON.stringify(u).replace(/\\\"/g," "),pageId:l.CLOG_PAGE_ID};return f(h,c),b(h),!0}function h(e,t,n,r,i){return n instanceof o&&!!d([e,t,n,n.name,n.id,n.initialBucket,n.initialPath])&&m(e,t,n,i,{},r)}function b(e){u.isDevelopmentMode()&&window.console.debug(e),i.Clog.log(e)}var v={unit:"",metricType:"",logLevel:""},E={explorers:!0};return{log:h,logCws:function(e,t,n,r,i,a){if(!(n instanceof o))return!1;if(!d([e,t,n.name,n.id,n.initialBucket,n.initialPath,r]))return!1;var s={};return s[l.OPERATION.CWS_OP_ID]=r,m(e,t,n,a,s,i)},logS3:function(e,t,n,r,i,a,s){if(!(n instanceof o))return!1;if(!d([e,t,n,n.name,n.id,n.initialBucket,n.initialPath,r,i]))return!1;var c={};return c[l.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=r,c[l.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=i,m(e,t,n,s,c,a)},logWithSimplifiedOperation:function(n,r,i,a){if(!(i instanceof o))return!1;var s=a?t.clone(a):{};s[l.OPERATION.ID]=i.id,s[l.OPERATION.NAME]=i.name,s[l.OPERATION.STEP]=i.step,s[l.OPERATION.TIMESTAMP]=e("date")(new Date,"yyyy-MM-dd-HH-mm-ss.sss","UTC"),b({key:n,value:r,detail:JSON.stringify(s).replace(/\\\"/g," "),pageId:l.CLOG_PAGE_ID})},logWithOneBox:function(e,t,n,r){this.logWithSimplifiedOperation(e,t,n,r),u.isOneBox()&&this.logWithSimplifiedOperation("ob-"+e,t,n,r)},logRequestReceived:function(e){var t=new o(e,"requestReceived");return h(e,1,t),t},logRequestComplete:function(e,t){t.step="requestComplete",h(e,1,t)},setEndpoint:function(){var e=u.getAWSCMezzRegion(),t=c.DOMAINS.PUBLIC;e&&u.getCloudSystem()===t.NAME&&0===r.host().indexOf(l.LBR_ENDPOINTS.PUBLIC)&&i.Clog.setEndpointOverride("https://"+e+"."+t.PROD)}}}])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function i(e,i,a,o,s){function c(){return Boolean(e.performance&&e.performance.mark&&e.performance.measure&&e.performance.getEntries&&e.performance.getEntriesByType&&e.performance.getEntriesByName)}function l(t){c()&&-1===E.indexOf(t)&&(E.push(t),e.performance.mark(t),y&&e.performance.measure(t,y,t),y=t,f(e.performance.getEntriesByName(t)))}function u(){if(c()){var n=function(){var n=/[\w\d\.-]+$/,r=/https:\/\/[a-z\d]+\.cloudfront\.net\/.+?\//;return{v:d(e.performance.getEntries().filter(function(e){return t.includes(["link","script"],e.initiatorType)}).filter(function(e){return/cloudfront\.net/.test(e.name)}).map(function(e){return{entryType:b,startTime:e.startTime,duration:e.duration,originalName:e.name,path:(e.name.match(r)||[""])[0],name:(e.name.match(n)||[""])[0]}}))}}();if("object"===(void 0===n?"undefined":r(n)))return n.v}}function d(e){var n=0,r=0;return e.map(function(e,i){var a=e.name.split(".").slice(-1)[0];return t.startsWith(e.name,"globalnav")||t.startsWith(e.name,"mezz")||t.startsWith(e.name,"custsat")?t.assign(e,{name:e.name.split("-")[0]+"_"+n+++"_"+a}):t.startsWith(e.name,"s3_console_Prod")?t.assign(e,{name:"s3_console_"+r+++"_"+a}):t.assign(e,{name:e.name.replace(".","_")})})}function p(){S||(f([].concat(n(e.performance.getEntriesByType(h)),n(e.performance.getEntriesByType(v)),n(u()))),S=!0)}function f(e){e.forEach(function(e){t.includes([v,b],e.entryType)&&a.logWithOneBox(o.PERFORMANCE_TRACKING.LOG_ENTRY_PREFIX+"_dur_"+e.name,Math.floor(e.duration),i,e),t.includes([h,b],e.entryType)&&a.logWithOneBox(o.PERFORMANCE_TRACKING.LOG_ENTRY_PREFIX+"_start_"+e.name,Math.floor(e.startTime),i,e)})}function g(){for(var t=e.performance.getEntriesByType(h),n=1;n<t.length;n++)e.performance.measure(t[n].name,t[n-1].name,t[n].name)}function m(e){s.Timer.customerReady(),A.mark(o.PERFORMANCE_TRACKING.CUSTOMER_READY),A.mark(""+o.PERFORMANCE_TRACKING.CUSTOMER_READY_PREFIX+e)}var h="mark",b="asset",v="measure",E=function(){if(c())return t.map(e.performance.getEntriesByType(h),function(e){return e.name})}(),S=!1,y=function(){if(c()){var t=e.performance.getEntriesByType(h);return t.length?t[t.length-1].name:""}}();!function(){c()&&(g(),p())}();var A={mark:l,customerReady:m};return A}e.module("s3").service("PerformanceUtilsService",["$window","PageLoadOperation","SCLogService","S3Constants","AWSC",i])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").factory("UUIDService",[function(){return{generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.floor(16*Math.random());return("x"===e?t:3&t|8).toString(16)})}}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("ObjectListingService",["$q","ConsoleOperation","ListVerificationService","S3Constants","PathService","APIProxyService","SCLogService","XMLParser",function(n,r,i,a,o,s,c,l){function u(e,t,n,i,a){var c={bucket:o.getCurrentBucket(),prefix:e,marker:t,maxKeys:n,delimiter:i,cacheAllowed:a};return s.listObjects(new r("listObjects"),c)}function d(e,t,n,i,a,c){var l={bucket:o.getCurrentBucket(),prefix:e,keyMarker:t,maxKeys:i,delimiter:a,cacheAllowed:c};return n&&(l.versionIdMarker=n),s.listVersions(new r("listObjects"),l)}function p(t,n,i){var a={TagQuery:{MaxKeys:n,IncludeTags:!0,ContinuationToken:i,And:{Filter:[]}}},c="";return e.forEach(t,function(e){var t=e.tagKey,n=e.tagVal,r=n.split(", ");a.TagQuery.And.Filter.push({Key:t,Or:{Value:r}})}),c=l.jsonToXml(a),s.tagQuery(new r("tagQuery"),o.getCurrentBucket(),c)}function f(e,r,a,o,l,u,d,p){function g(r,u,g,b){if(r){p.keys=p.keys.concat(r);var v=t.uniq(t.pluck(p.keys,"Key"));if(!1===i.verify(v,d))return i.verifyEmptyKeyInSelectedPrefixes(v,d)?(c.log("batchListVerification",1,e,h),c.log("emptyKeyBatchListVerification",1,e,h)):c.log("batchListVerification",0,e,h),p.error="List verification failed.",n.reject(p);c.log("batchListVerification",1,e,h)}else""!==h.prefix&&s.headObject(e,e.initialBucket,h.prefix).then(function(){c.log("prefixNotExistForListing",0,e)}).catch(function(){c.log("prefixNotExistForListing",1,e)});if("true"===u)return p.marker=g,b&&(p.versionIdMarker=b),p.truncated=!0,p;var E=void 0;for(E=0;E<d.length;E++)if(d[E].Prefix===h.prefix){d[E].folderListed=!0;break}return p.truncated=E<d.length-1,p.keys.length!==m&&p.truncated?f(e,null,a-r.length,o,l,null,d,p):p}if(!i.verifyPrefixesToBeListed(e,d))return c.log("BulkOpPrefixesMalformed",1,e),n.reject({error:"Bulk operation prefixes malformed"});var h={bucket:e.initialBucket,maxKeys:a,cacheAllowed:o};p||(m=a),p=p||{keys:[],truncated:!1};var b=void 0;if(r){for(b=0;b<d.length;b++)if(!d[b].folderListed){h.prefix=d[b].Prefix;break}l?(h.keyMarker=r,h.versionIdMarker=u):h.marker=r}else{for(b=0;b<d.length;b++)if(!d[b].folderListed){h.prefix=d[b].Prefix;break}if(!0===d[d.length-1].folderListed){p.truncated=!1;var v=n.defer();return v.resolve(p),v.promise}}return!0===l?(c.log("getBatchOfVersionsReceived",1,e,h),s.listVersions(e,h).then(function(t){var n=t.response.ListVersionsResult;c.log("getBatchOfVersionsComplete",1,e,h);var r=[];return n.Version&&(r=r.concat(n.Version)),n.DeleteMarker&&(r=r.concat(n.DeleteMarker)),g(r,n.IsTruncated,n.NextKeyMarker,n.NextVersionIdMarker)}).catch(function(t){return h.error=t,c.log("getBatchOfVersionsComplete",0,e,h),n.reject(t)})):(c.log("getBatchOfObjectsReceived",1,e,h),s.listObjects(e,h).then(function(t){var n=t.response.ListBucketResult;return c.log("getBatchOfObjectsComplete",1,e,h),g(n.Contents,n.IsTruncated,n.NextContinuationToken)}).catch(function(t){return h.error=t,c.log("getBatchOfObjectsComplete",0,e,h),n.reject(t)}))}var g={getBatchOfItems:f,listObjects:u,listObjectVersions:d,tagQuery:p},m=void 0;return g}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){function n(n,r,i,a,o,s){function c(i,a,l){var u=arguments.length<=3||void 0===arguments[3]?o.LIST_OBJECTS_MAX_KEYS_PER_LISTING:arguments[3],d=arguments.length<=4||void 0===arguments[4]?{}:arguments[4],p=arguments.length<=5||void 0===arguments[5]?o.LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:arguments[5],f=arguments.length<=6||void 0===arguments[6]?o.DELIMITER:arguments[6],g=n.defer();return l||(l={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[]}),d.bucket=i.initialBucket,d.delimiter=f,d.maxKeys=p,d.prefix=a,r.listVersions(i,d).then(function(n){var r=t.get(n,"response.ListVersionsResult");if(r){if(r.CommonPrefixes){var p=s.transformObjectToArray(r.CommonPrefixes);e.forEach(p,function(e){t.isEmpty(a)||-1===e.Prefix.lastIndexOf(a)||(e.Prefix=e.Prefix.substring(e.Prefix.lastIndexOf(a)+a.length)),l.deletedFiles.length+l.folders.length<u?l.folders.push(e):l.cachedFolders.push(e)})}if(r.DeleteMarker){var f=s.transformObjectToArray(r.DeleteMarker);e.forEach(f,function(e){s.convertStringToBoolean(e.IsLatest)&&(-1!==e.Key.lastIndexOf("/")&&(e.Key=e.Key.substring(e.Key.lastIndexOf(o.DELIMITER)+1)),e.Size="",e.StorageClass="",l.deletedFiles.length+l.folders.length<u?l.deletedFiles.push(e):l.cachedDeletedFiles.push(e))})}l.IsTruncated=r.IsTruncated,"true"===r.IsTruncated?l.deletedFiles.length+l.folders.length<u?(d.keyMarker=r.NextKeyMarker,d.versionIdMarker=r.NextVersionIdMarker,c(i,a,l,u,d).then(function(e){g.resolve(e)},function(e){g.reject(e)})):(l.NextKeyMarker=r.NextKeyMarker,l.NextVersionIdMarker=r.NextVersionIdMarker,g.resolve(l)):g.resolve(l)}else g.reject()},function(e){g.reject(e)}),g.promise}function l(e,t,r,s){var l=n.defer(),u=i.getPageOfDeletedObjects(t),d=o.LIST_OBJECTS_MAX_KEYS_PER_LISTING,p={keyMarker:r,versionIdMarker:s};if(u&&(d-=u.Contents.length+u.CommonPrefixes.length),d>=0)c(new a(o.LIST_DELETED_OBJECTS),e,null,d,p).then(function(e){u&&(e.deletedFiles=u.Contents.concat(e.deletedFiles),e.folders=u.CommonPrefixes.concat(e.folders)),l.resolve(e)},function(e){l.reject(e)});else{var f=u.CommonPrefixes,g=u.Contents,m={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[],IsTruncated:"true",NextKeyMarker:r,NextVersionIdMarker:s};if(f.length>o.LIST_OBJECTS_MAX_KEYS_PER_LISTING)m.folders=f.slice(0,o.LIST_OBJECTS_MAX_KEYS_PER_LISTING),m.cachedFolders=f.slice(o.LIST_OBJECTS_MAX_KEYS_PER_LISTING),m.cachedDeletedFiles=g;else{var h=o.LIST_OBJECTS_MAX_KEYS_PER_LISTING-f.length;m.folders=f,m.deletedFiles=g.slice(0,h),m.cachedDeletedFiles=g.slice(h)}l.resolve(m)}return l.promise}return{fetchDeletedPageOfObjects:l,listDeletedObjects:c}}e.module("s3").service("ListDeletedObjectsService",["$q","APIProxyService","CachingService","ConsoleOperation","S3Constants","UtilService",n])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("ListVerificationService",["S3Constants",function(n){function r(e,t){return 0===e.indexOf(t)}function i(e,t){return e.length>0&&e.lastIndexOf(t)===e.length-t.length}function a(e,t){var n=e.indexOf(t);return n>=0&&n===e.lastIndexOf(t)}function o(e){return e.name===n.OPERATION_NAME.DELETE_BUCKET||e.name===n.OPERATION_NAME.EMPTY_BUCKET}this.verifyPrefixesToBeListed=function(e,t){if(o(e))return 1===t.length&&""===t[0].Prefix;for(var s in t){var c=t[s],l=void 0;if(0===e.initialPath.length)l=c.Prefix;else{var u=c.Prefix.split(e.initialPath);l=u[1],3===u.length&&-1===l.lastIndexOf(n.DELIMITER)&&(l=""+u[1]+e.initialPath)}if(!(r(c.Prefix,e.initialPath)&&a(l,n.DELIMITER)&&i(l,n.DELIMITER)))return!1}return!0},this.verify=function(t,n){if(!t)throw"keys is undefined.";t&&!e.isArray(t)&&(t=new Array(t));for(var i=0;i<t.length;i++){for(var a=!1,o=0;o<n.length;o++)if(r(t[i],n[o].Prefix)){a=!0;break}if(!a)return!1}return!0},this.verifyEmptyKeyInSelectedPrefixes=function(e,n){if(void 0!==t.find(e,function(e){return""===e})&&void 0===t.find(n,function(e){return""===e.Prefix})){for(var r=[],i=0;i<e.length;i++){for(var a=!1,o=0;o<n.length;o++)if(t.startsWith(e[i],n[o].Prefix)){a=!0;break}if(a||r.push(e[i]),r.length>1)break}return 1===r.length&&""===r[0]}return!1}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").factory("ConsoleOperation",["$q","CachingService","KeySelectionService","PathService","S3Constants","UtilService","UUIDService",function(e,t,n,r,i,a,o){function s(n,s){function c(){return we}function l(){if(a.isNumeric(Te)){if(Te>=0&&Te<=100)return Number(Number(Te).toFixed(2));if(Te>100)return 100}return"--"}function u(e){Te=e}function d(e){Re=e}function p(){if(a.isNumeric(Re)){if(Re>=0&&Re<=100)return Number(Number(Re).toFixed(2));if(Re>100)return 100}return"--"}function f(){return a.isNumeric(Oe)?Math.min(Number(Number(Oe).toFixed(2)),100):"--"}function g(e){Oe=e}function m(){return ve}function h(e){ve=e}function b(e){ke=e}function v(){return ke}function E(e){Ie=e}function S(){return Ie}function y(e){Pe=e}function A(){return Pe}function C(){return Ne}function _(e){Ne=e}function w(){return Me}function T(e){Me=e}function R(){return Le}function O(e){Le=e}function k(){return xe}function I(e){xe=e}function P(){return De}function N(e){De=e}function M(){return je}function L(e){je=e}function x(){return Be}function D(e){Be=e}function j(e){Ve=e}function B(){return Ve}function F(e){Se=e}function U(){return Se}function K(){return n}function V(){return s}function G(e){s=e}function Y(){return he}function W(){return be}function z(){return Ee}function $(){return ge}function H(e){ge=e}function q(){return me}function J(e){me=e}function X(){return Ue}function Z(e){Ue=e}function Q(){return Ke}function ee(e){Ke=e}function te(){return Fe}function ne(){return""+be+i.DELIMITER+Ee}function re(){return""+ye+i.DELIMITER+Ae}function ie(){return r.getUrlForBucketAndPrefix(window.location.href,be,Ee)}function ae(){return r.getUrlForBucketAndPrefix(window.location.href,ye,Ae)}function oe(){return ye}function se(e){ye=e}function ce(){return Ae}function le(e){Ae=e}function ue(){return _e}function de(e){_e=e}function pe(){return Ce}function fe(e){Ce=e}var ge,me,he=o.generateUUID(),be=r.getCurrentBucket()||"",ve=t.getBucketLocation(be)||"",Ee=r.getCurrentAbsoluteFolderPath()||"",Se={},ye="",Ae="",Ce="",_e="",we=e.defer(),Te=0,Re=0,Oe=0,ke="",Ie=0,Pe=0,Ne=0,Me=[],Le={},xe=function(){},De=function(){},je=null,Be=null,Fe=function(e){be=e},Ue=0,Ke=0,Ve=i.OPERATION_STATE.WAITING;Object.defineProperties(this,{defer:{get:c},name:{get:K},step:{get:V,set:G},id:{get:Y},initialBucket:{get:W},initialPath:{get:z},bucketRegion:{get:m,set:h},dstBucket:{get:oe,set:se},dstPrefix:{get:ce,set:le},dstName:{get:pe,set:fe},dstBucketRegion:{get:ue,set:de},progressPercentage:{get:l,set:u},succeedKeyCount:{get:S,set:E},failedKeyCount:{get:A,set:y},totalOperatedObjectCount:{get:C,set:_},successPercentage:{get:p,set:d},errorPercentage:{get:f,set:g},progressText:{get:v,set:b},errorTypes:{get:w,set:T},errorDetails:{get:R,set:O},state:{get:B,set:j},start:{get:k,set:I},cancel:{get:P,set:N},errorCallBack:{get:M,set:L},finishCallBack:{get:x,set:D},parameters:{get:U,set:F},selectedObjects:{get:q,set:J},selectedFolders:{get:$,set:H},keyCount:{get:X,set:Z},totalSizeInBytes:{get:Q,set:ee},changeInitialBucketForOperation:{get:te},operationPath:{get:ne},operationDestinationPath:{get:re},operationInitialLocationUrl:{get:ie},operationDestinationUrl:{get:ae}})}return s}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("MD5CalculationService",["$filter","$http","$log","$window","$q","$translate","ConsoleOperation","Md5WorkerService","S3Constants","SCLogService",function(e,t,n,r,i,a,o,s,c,l){function u(e,t,n){var r=new o("uploadVerification","requestReceived"),a={fileName:e.name,fileSize:e.size,uploadOpId:n};l.log("MD5CalculationSize",e.size,r,a);var s=i.defer();return 0===e.size?s.resolve(c.UPLOAD.ZERO_BYTE_MD5):d(t,e,n,s,r),s.promise}function d(e,t,n,r,i){i.step="MD5CalculationStart";var a={fileName:t.name,uploadOpId:n};l.log("MD5CalculationStart",1,i,a);var o=e+"-",c=s.generateWorker(e,t,n,r,i);c.worker.addEventListener("message",f(o)),c.worker.addEventListener("error",p(o)),h[o]=c;var u={file_size:t.size,start:0,end:t.size};c.worker.postMessage({message:t,block:u})}function p(e){return function(){var t=h[e];t.uploadVerificationDeferredObject.reject(a.instant("upload.md5calculation.error")),g(t,"MD5CalculationSuccess",0),delete h[e]}}function f(e){return function(t){if(t.data.result){var i=h[e];m[i.fileId]=t.data.result;var a=r.Date.now()-i.startTime;g(i,"MD5CalculationSuccess",1),g(i,"MD5CalculationTime",a),n.log("Etag calculated for "+i.file.name+": "+t.data.result),i.uploadVerificationDeferredObject.resolve(m[i.fileId]),delete h[e]}}}function g(e,t,n){e.operation.step=t;var r={fileName:e.file.name,uploadOpId:e.uploadOpId};l.log(t,n,e.operation,r)}var m=[],h={};return{calculateMD5:u}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){e.module("s3").service("Md5WorkerService",["$window",function(e){function n(){if(t(e.Blob)===("undefined"==typeof Function?"undefined":t(Function))||"object"===t(e.Blob)){var n=new e.Blob(['/*                          * Crypto-JS v2.5.1                          * http://code.google.com/p/crypto-js/                          * (c) 2009-2011 by Jeff Mott. All rights reserved.                          * http://code.google.com/p/crypto-js/wiki/License                          */                         /*global Crypto, self*/                        (typeof Crypto=="undefined"||!Crypto.util)&&function(){var e=self.Crypto={},g=e.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return g.rotl(a,8)&16711935|g.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=g.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-                        d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(a){if(typeof btoa=="function")return btoa(f.bytesToString(a));for(var b=[],c=0;c<a.length;c+=3)for(var d=a[c]<<16|a[c+1]<<8|                        a[c+2],e=0;e<4;e++)c*8+e*6<=a.length*8?b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>>6*(3-e)&63)):b.push("=");return b.join("")},base64ToBytes:function(a){if(typeof atob=="function")return f.stringToBytes(atob(a));for(var a=a.replace(/[^A-Z0-9+/]/ig,""),b=[],c=0,d=0;c<a.length;d=++c%4)d!=0&&b.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c-1))&Math.pow(2,-2*d+8)-1)<<d*2|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c))>>>                        6-d*2);return b}},e=e.charenc={};e.UTF8={stringToBytes:function(a){return f.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(f.bytesToString(a)))}};var f=e.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}}();                        function FF(a, b, c, d, x, s, t) {                            var n = a + (b & c | ~b & d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function GG(a, b, c, d, x, s, t) {                            var n = a + (b & d | c & ~d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function HH(a, b, c, d, x, s, t) {                            var n = a + (b ^ c ^ d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function II(a, b, c, d, x, s, t) {                            var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function md5(m, hash) {                            var a = hash[0], b = hash[1], c = hash[2], d = hash[3];                            for (var i = 0; i < m.length; i += 16) {                                var aa = a, bb = b, cc = c, dd = d;                                a = FF(a, b, c, d, m[i + 0], 7, -680876936);                                d = FF(d, a, b, c, m[i + 1], 12, -389564586);                                c = FF(c, d, a, b, m[i + 2], 17, 606105819);                                b = FF(b, c, d, a, m[i + 3], 22, -1044525330);                                a = FF(a, b, c, d, m[i + 4], 7, -176418897);                                d = FF(d, a, b, c, m[i + 5], 12, 1200080426);                                c = FF(c, d, a, b, m[i + 6], 17, -1473231341);                                b = FF(b, c, d, a, m[i + 7], 22, -45705983);                                a = FF(a, b, c, d, m[i + 8], 7, 1770035416);                                d = FF(d, a, b, c, m[i + 9], 12, -1958414417);                                c = FF(c, d, a, b, m[i + 10], 17, -42063);                                b = FF(b, c, d, a, m[i + 11], 22, -1990404162);                                a = FF(a, b, c, d, m[i + 12], 7, 1804603682);                                d = FF(d, a, b, c, m[i + 13], 12, -40341101);                                c = FF(c, d, a, b, m[i + 14], 17, -1502002290);                                b = FF(b, c, d, a, m[i + 15], 22, 1236535329);                                a = GG(a, b, c, d, m[i + 1], 5, -165796510);                                d = GG(d, a, b, c, m[i + 6], 9, -1069501632);                                c = GG(c, d, a, b, m[i + 11], 14, 643717713);                                b = GG(b, c, d, a, m[i + 0], 20, -373897302);                                a = GG(a, b, c, d, m[i + 5], 5, -701558691);                                d = GG(d, a, b, c, m[i + 10], 9, 38016083);                                c = GG(c, d, a, b, m[i + 15], 14, -660478335);                                b = GG(b, c, d, a, m[i + 4], 20, -405537848);                                a = GG(a, b, c, d, m[i + 9], 5, 568446438);                                d = GG(d, a, b, c, m[i + 14], 9, -1019803690);                                c = GG(c, d, a, b, m[i + 3], 14, -187363961);                                b = GG(b, c, d, a, m[i + 8], 20, 1163531501);                                a = GG(a, b, c, d, m[i + 13], 5, -1444681467);                                d = GG(d, a, b, c, m[i + 2], 9, -51403784);                                c = GG(c, d, a, b, m[i + 7], 14, 1735328473);                                b = GG(b, c, d, a, m[i + 12], 20, -1926607734);                                a = HH(a, b, c, d, m[i + 5], 4, -378558);                                d = HH(d, a, b, c, m[i + 8], 11, -2022574463);                                c = HH(c, d, a, b, m[i + 11], 16, 1839030562);                                b = HH(b, c, d, a, m[i + 14], 23, -35309556);                                a = HH(a, b, c, d, m[i + 1], 4, -1530992060);                                d = HH(d, a, b, c, m[i + 4], 11, 1272893353);                                c = HH(c, d, a, b, m[i + 7], 16, -155497632);                                b = HH(b, c, d, a, m[i + 10], 23, -1094730640);                                a = HH(a, b, c, d, m[i + 13], 4, 681279174);                                d = HH(d, a, b, c, m[i + 0], 11, -358537222);                                c = HH(c, d, a, b, m[i + 3], 16, -722521979);                                b = HH(b, c, d, a, m[i + 6], 23, 76029189);                                a = HH(a, b, c, d, m[i + 9], 4, -640364487);                                d = HH(d, a, b, c, m[i + 12], 11, -421815835);                                c = HH(c, d, a, b, m[i + 15], 16, 530742520);                                b = HH(b, c, d, a, m[i + 2], 23, -995338651);                                a = II(a, b, c, d, m[i + 0], 6, -198630844);                                d = II(d, a, b, c, m[i + 7], 10, 1126891415);                                c = II(c, d, a, b, m[i + 14], 15, -1416354905);                                b = II(b, c, d, a, m[i + 5], 21, -57434055);                                a = II(a, b, c, d, m[i + 12], 6, 1700485571);                                d = II(d, a, b, c, m[i + 3], 10, -1894986606);                                c = II(c, d, a, b, m[i + 10], 15, -1051523);                                b = II(b, c, d, a, m[i + 1], 21, -2054922799);                                a = II(a, b, c, d, m[i + 8], 6, 1873313359);                                d = II(d, a, b, c, m[i + 15], 10, -30611744);                                c = II(c, d, a, b, m[i + 6], 15, -1560198380);                                b = II(b, c, d, a, m[i + 13], 21, 1309151649);                                a = II(a, b, c, d, m[i + 4], 6, -145523070);                                d = II(d, a, b, c, m[i + 11], 10, -1120210379);                                c = II(c, d, a, b, m[i + 2], 15, 718787259);                                b = II(b, c, d, a, m[i + 9], 21, -343485551);                                a = (a + aa) >>> 0;                                b = (b + bb) >>> 0;                                c = (c + cc) >>> 0;                                d = (d + dd) >>> 0;                            }                            return [a, b, c, d];                        }                        var hash = [1732584193, -271733879, -1732584194, 271733878];                        onmessage = function (event) {                            var uint8_array, message, block, output, nBitsTotal, nBitsLeft, nBitsTotalH, nBitsTotalL;                            var reader = new FileReaderSync();                            uint8_array = new Uint8Array(reader.readAsArrayBuffer(event.data.message));                            message = Crypto.util.endian(Crypto.util.bytesToWords(uint8_array));                            block = event.data.block;                            event = null;                            uint8_array = null;                            output = {};                            nBitsTotal =  block.file_size * 8;                            nBitsLeft = (block.end - block.start) * 8;                            message[nBitsLeft >>> 5] |= 0x80 << (nBitsLeft % 32);                            nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);                            nBitsTotalL = nBitsTotal & 0xFFFFFFFF;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotalH;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 14] = nBitsTotalL;                            self.hash = md5(message, self.hash);                            output.result = Crypto.util.bytesToHex(Crypto.util.wordsToBytes(Crypto.util.endian(self.hash)));                            message = null;                            self.postMessage(output);                            close();                        }'],{type:"application/javascript"});r=e.URL.createObjectURL(n)}}this.generateWorker=function(t,i,a,o,s){return r||n(),{fileId:t,worker:new e.Worker(r),file:i,startTime:e.Date.now(),uploadOpId:a,uploadVerificationDeferredObject:o,operation:s}};var r}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){function n(n,r,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v){function E(){var e=p.logRequestReceived("getBucketOwnerDisplayName");return a.getBucketOwner().then(function(t){return p.logRequestComplete("getBucketOwnerDisplayName",e),t.DisplayName})}function S(e){return Fe.getBucketLocation(e).then(function(e){return t.find(l.regionMapping,{value:e})})}function y(e){var t=p.logRequestReceived("getBucketLocation");return a.getBucketLocation(t,e,{}).then(function(e){return p.logRequestComplete("getBucketLocation",t),e.region})}function A(e){var t=p.logRequestReceived("getBucketGranteeCounts");return a.getBucketProperty(t,e,a.bucketPropertiesMap.acl.name).then(function(e){var n=e.response;p.logRequestComplete("getBucketGranteeCounts",t);var r={READ:0,WRITE:0,READ_ACP:0,WRITE_ACP:0};return n&&function(){var e=n.AccessControlPolicy.AccessControlList.Grant,t=function(e){if("FULL_CONTROL"===e.Permission)for(var t in r)r[t]++;else r[e.Permission]++};e&&(e.forEach?e.forEach(function(e){t(e)}):t(e))}(),r})}function C(e,n){var i=arguments.length<=2||void 0===arguments[2]||arguments[2];return p.log("getBucketGranteesReceived",1,n,{bucketName:e}),n.step="getBucketAclComplete",i&&o.evictBucketProperty(e,a.bucketPropertiesMap.acl.name),a.getBucketProperty(n,e,a.bucketPropertiesMap.acl.name).then(function(r){var i=r.response,a={};p.log("getBucketACL",1,n,{bucketName:e});var o=t.get(i,"AccessControlPolicy.AccessControlList.Grant");return o&&(o.forEach?o.forEach(function(e){m.updateGranteesHelperFunction(e,a)}):m.updateGranteesHelperFunction(o,a)),p.logRequestComplete("getBucketGrantees",n),a}).catch(function(t){return p.log("getBucketGrantees",0,n,{bucketName:e,error:t}),r.reject(h.handleErrors(t))})}function _(e,t){return p.log("getBucketACPReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.acl.name).then(function(e){var n=e.response;return p.logRequestComplete("getBucketACP",t),n.AccessControlPolicy}).catch(function(n){return p.log("getBucketACP",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function w(e,t){return p.log("getBucketACLReceived",1,t,{bucketName:e}),_(e,t).then(function(e){return p.logRequestComplete("getBucketACL",t),e.AccessControlList.Grant}).catch(function(n){return p.log("getBucketACL",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function T(e,t,n){p.log("putBucketACLReceived",1,n,{bucketName:e});var i="";return _(e,n).then(function(o){return i+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+o.Owner.ID+"</ID>",i+="<DisplayName>"+h.encodeXml(o.Owner.DisplayName)+"</DisplayName></Owner><AccessControlList>",t.forEach(function(e){e.Grantee.Type=e.Grantee.URI?"Group":e.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser",i+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+e.Grantee.Type+'">',i+=e.Grantee.ID?"<ID>"+e.Grantee.ID+"</ID>":"",i+=e.Grantee.DisplayName?"<DisplayName>"+h.encodeXml(e.Grantee.DisplayName)+"</DisplayName>":"",i+=e.Grantee.EmailAddress?"<EmailAddress>"+e.Grantee.EmailAddress+"</EmailAddress>":"",i+=e.Grantee.URI?"<URI>"+e.Grantee.URI+"</URI>":"",i+="</Grantee>",i+="<Permission>"+e.Permission+"</Permission></Grant>"}),i+="</AccessControlList></AccessControlPolicy>",a.putBucketProperty(n,e,a.bucketPropertiesMap.acl.name,i).then(function(e){var t=e.response;return p.logRequestComplete("putBucketACL",n),t}).catch(function(t){return p.log("putBucketACL",0,n,{bucketName:e,error:t}),r.reject(h.handleErrors(t))})}).catch(function(e){return r.reject(e)})}function R(e,t,n){p.log("putBucketNotificationReceived",1,t,{bucketName:e});var i=O(n);return a.putBucketProperty(t,e,a.bucketPropertiesMap.notification.name,i).then(function(n){var r=n.response;return p.log("putBucketNotification",1,t,{bucketName:e}),r}).catch(function(n){return p.log("putBucketNotification",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function O(e){var t={};return[{name:u.EVENTS.TOPIC,value:u.EVENTS.TOPICCONFIG},{name:u.EVENTS.QUEUE,value:u.EVENTS.QUEUECONFIG},{name:u.EVENTS.CLOUDFN,value:u.EVENTS.CLOUDCONFIG}].forEach(function(n){var r=[];e[n.name]&&(e[n.name].forEach(function(e){r.push(k(e))}),t[n.value]=r)}),t={NotificationConfiguration:t},f.jsonToXml(t)}function k(e){var t={};t.Id=e.id;var n=[];switch(e.prefix&&""!==e.prefix&&n.push({Name:"Prefix",Value:e.prefix}),e.suffix&&""!==e.suffix&&n.push({Name:"Suffix",Value:e.suffix}),0!==n.length&&(I(n),t.Filter={S3Key:{FilterRule:n}}),e.type){case u.EVENTS.SNS:t.Topic=e.arn;break;case u.EVENTS.SQS:t.Queue=e.arn;break;case u.EVENTS.LAMBDA:t.CloudFunction=e.arn}var r=I(e.events);return t.Event=r,t}function I(e){return 1===e.length?e[0]:e}function P(e){var t=p.logRequestReceived("isCORSEnabled");return a.getBucketProperty(t,e,a.bucketPropertiesMap.cors.name).then(function(e){return p.logRequestComplete("isCORSEnabled",t),void 0!==e.response})}function N(e,t,n){return p.log("putBucketCORSReceived",1,n,{bucketName:e}),a.putBucketProperty(n,e,a.bucketPropertiesMap.cors.name,t).then(function(e){return p.logRequestComplete("putBucketCORS",n),e.response}).catch(function(t){return p.log("putBucketCORS",0,n,{bucketName:e,error:t}),r.reject(h.handleErrors(t))})}function M(e,t){return p.log("getBucketCORSReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.cors.name).then(function(e){return p.logRequestComplete("getBucketCORS",t),e.response}).catch(function(n){var i=h.handleErrors(n);if("The CORS configuration does not exist"!==i)return p.log("getBucketCORS",0,t,{bucketName:e,error:n}),r.reject(i);p.logRequestComplete("getBucketCORS",t)})}function L(e,t){return p.log("deleteBucketCORSReceived",1,t,{bucketName:e}),a.deleteBucketProperty(t,e,a.bucketPropertiesMap.cors.name).then(function(e){return p.logRequestComplete("deleteBucketCORS",t),e.response}).catch(function(n){return p.log("deleteBucketCORS",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function x(e){var t=p.logRequestReceived("isBucketPolicyApplied");return a.getBucketProperty(t,e,a.bucketPropertiesMap.policy.name).then(function(e){return p.logRequestComplete("isBucketPolicyApplied",t),void 0!==e.response})}function D(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];return p.log("getBucketPolicyReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.policy.name,{},n).then(function(e){return p.logRequestComplete("getBucketPolicy",t),e.response}).catch(function(n){var i=h.handleErrors(n);if("The bucket policy does not exist"!==i)return p.log("getBucketPolicy",0,t,{bucketName:e,error:n}),r.reject(i);p.logRequestComplete("getBucketPolicy",t)})}function j(e,t,n){return p.log("putBucketPolicyReceived",1,n,{bucketName:e}),a.putBucketProperty(n,e,a.bucketPropertiesMap.policy.name,t).then(function(e){return p.logRequestComplete("putBucketPolicy",n),e.response}).catch(function(t){var i=h.handleErrors(t);return p.log("putBucketPolicy",0,n,{bucketName:e,error:t}),r.reject(i)})}function B(e,t){return p.log("deleteBucketPolicyReceived",1,t,{bucketName:e}),a.deleteBucketProperty(t,e,a.bucketPropertiesMap.policy.name).then(function(e){return p.logRequestComplete("deleteBucketPolicy",t),e.response}).catch(function(n){return p.log("deleteBucketPolicy",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function F(e){var t=p.logRequestReceived("getBucketLifecycleConfiguration");return a.getBucketProperty(t,e,a.bucketPropertiesMap.lifecycle.name).then(function(e){return p.logRequestComplete("getBucketLifecycleConfiguration",t),e.response?f.convertXmlStringToJson(e.response):e})}function U(e){var t=p.logRequestReceived("getVersioningStatus");return a.getBucketProperty(t,e,a.bucketPropertiesMap.versioning.name).then(function(e){p.logRequestComplete("getVersioningStatus",t);var n=f.convertXmlStringToJson(e.response);return n.VersioningConfiguration&&n.VersioningConfiguration.Status})}function K(e){var n=p.logRequestReceived("getVersioningAndMFAStatus");return a.getBucketProperty(n,e,a.bucketPropertiesMap.versioning.name).then(function(e){p.logRequestComplete("getVersioningAndMFAStatus",n);var r=f.convertXmlStringToJson(e.response);return t.get(r,"VersioningConfiguration")})}function V(e){var t=p.logRequestReceived("getEventCount");return a.getBucketProperty(t,e,a.bucketPropertiesMap.notification.name).then(function(e){p.logRequestComplete("getEventCount",t);var n=f.convertXmlStringToJson(e.response),r=0;for(var i in n.NotificationConfiguration)r+=n.NotificationConfiguration[i].length||1;return r})}function G(e,t){return p.log("getBucketNotificationReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.notification.name).then(function(e){return p.logRequestComplete("getBucketNotification",t),e}).catch(function(n){return p.log("getBucketNotification",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function Y(e){var t=p.logRequestReceived("isLoggingEnabled");return a.getBucketProperty(t,e,a.bucketPropertiesMap.logging.name).then(function(e){return p.logRequestComplete("isLoggingEnabled",t),e.response&&void 0!==e.response.BucketLoggingStatus.LoggingEnabled})}function W(e){var t=p.logRequestReceived("getLoggingTargetBucket");return a.getBucketProperty(t,e,a.bucketPropertiesMap.logging.name).then(function(e){p.logRequestComplete("getLoggingTargetBucket",t);var n=e.response.BucketLoggingStatus.LoggingEnabled;return n?n.TargetBucket:"Logging is not enabled"})}function z(e){var t=p.logRequestReceived("isRequesterPaysEnabled");return a.getBucketProperty(t,e,a.bucketPropertiesMap.requestPayment.name).then(function(e){return p.logRequestComplete("isRequesterPaysEnabled",t),"Requester"===f.convertXmlStringToJson(e.response).RequestPaymentConfiguration.Payer})}function $(e){var n=p.logRequestReceived("isReplicationEnabled");return a.getBucketProperty(n,e,a.bucketPropertiesMap.replication.name).then(function(e){var r=f.convertXmlStringToJson(e.response),i=!1;return r.ReplicationConfiguration&&(p.logRequestComplete("isReplicationEnabled",n),i=r.ReplicationConfiguration.Rule.length?t.filter(r.ReplicationConfiguration.Rule,function(e){return"Enabled"===e.Status}).length>0:"Enabled"===r.ReplicationConfiguration.Rule.Status),i})}function H(e,t){return v.getBucketObjectLockConfiguration(t,e).then(function(e){return e.bucketObjectRetentionEnabled})}function q(e){var t=u.OPERATION_NAME.IS_ANALYTICS_ENABLED,n=p.logRequestReceived(t);return a.getBucketProperty(n,e,"analytics",{},!1).then(function(e){var r=e.response;p.log(t,1,n);var i=f.convertXmlStringToJson(r),a=i.ListBucketAnalyticsConfigurationsResult;return!(!a||!a.AnalyticsConfiguration)}).catch(function(r){return p.log(t,0,n,{bucketName:e,error:r}),!1})}function J(e){var n=u.OPERATION_NAME.IS_LIFECYCLE_ENABLED,r=p.logRequestReceived(n);return a.getBucketProperty(r,e,a.bucketPropertiesMap.lifecycle.name).then(function(e){if(p.log(n,1,r),e.response){var i=f.convertXmlStringToJson(e.response);if(i&&i.LifecycleConfiguration&&i.LifecycleConfiguration.Rule){var a=h.transformObjectToArray(i.LifecycleConfiguration.Rule);return t.some(a,function(e){return"Enabled"===e.Status})}}return!1}).catch(function(t){return p.log(n,0,r,{bucketName:e,error:t}),!1})}function X(e){var t=u.OPERATION_NAME.IS_INVENTORY_ENABLED,n=p.logRequestReceived(t);return a.getObjectInventory(n,e,{path:e}).then(function(e){var r=e.response;if(p.log(t,1,n),r){var i=f.convertXmlStringToJson(r);if(i.ListInventoryConfigurationsResult&&i.ListInventoryConfigurationsResult.InventoryConfiguration)return!0}return!1}).catch(function(r){return p.log(t,0,n,{bucketName:e,error:r}),!1})}function Z(e){var t=u.OPERATION_NAME.IS_METRICS_ENABLED,n=p.logRequestReceived(t);return a.getBucketProperty(n,e,"metrics",{},!1).then(function(e){var r=e.response;if(p.log(t,1,n),r){var i=f.convertXmlStringToJson(r),a=i.ListMetricsConfigurationsResult;if(i&&a&&a.MetricsConfiguration)return!0}return!1}).catch(function(r){return p.log(t,0,n,{bucketName:e,error:r}),!1})}function Q(e){var t=p.logRequestReceived("getTagCount");return a.getBucketProperty(t,e,a.bucketPropertiesMap.tagging.name).then(function(e){p.logRequestComplete("getTagCount",t);var n=f.convertXmlStringToJson(e.response),r=0;return n.Tagging&&(r=n.Tagging.TagSet.Tag.length||1),r})}function ee(e){var t=p.logRequestReceived("isWebsiteEnabled");return a.getBucketProperty(t,e,a.bucketPropertiesMap.website.name).then(function(e){return p.logRequestComplete("isWebsiteEnabled",t),void 0!==e.response})}function te(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];return p.log("getBucketVersioningReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.versioning.name,{},n).then(function(e){p.logRequestComplete("getBucketVersioning",t);var n=f.convertXmlStringToJson(e.response);return n.VersioningConfiguration&&n.VersioningConfiguration.Status}).catch(function(n){return p.log("getBucketVersioning",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function ne(e,t){return g.create(e,{xmlns:t||"http://s3.amazonaws.com/doc/2006-03-01/"})}function re(e,t,n,i,o){return a.putBucketProperty(e,t,n,i).then(function(t){return p.logRequestComplete(o,e),t}).catch(function(n){var i={bucketName:t};return n&&(i.error=n),p.log(o,0,e,i),r.reject(h.handleErrors(n))})}function ie(e,t,n,i){return a.deleteBucketProperty(e,t,n).then(function(t){return p.logRequestComplete(i,e),t}).catch(function(n){var a={bucketName:t};return n&&(a.error=n),p.log(i,0,e,a),r.reject(h.handleErrors(n))})}function ae(e,t,n,i){return a.getBucketProperty(e,t,n).then(function(t){return p.logRequestComplete(i,e),t}).catch(function(n){var a={bucketName:t};return n&&(a.error=n),p.log(i,0,e,a),r.reject(h.handleErrors(n))})}function oe(e,t){return ce(e,t,!0)}function se(e,t){return ce(e,t,!1)}function ce(e,t,n){p.log("putBucketVersioningReceived",1,t,{bucketName:e});var r=n?"Enabled":"Suspended",i=ne("VersioningConfiguration").addNode("Status",r).build();return re(t,e,a.bucketPropertiesMap.versioning.name,i,"putBucketVersioning")}function le(e,t){return de(e,t,!0)}function ue(e,t){return de(e,t,!1)}function de(e,t,n){p.log("putBucketRequestPaymentReceived",1,t,{bucketName:e});var r=n?"Requester":"BucketOwner",i=ne("RequestPaymentConfiguration").addNode("Payer",r).build();return re(t,e,a.bucketPropertiesMap.requestPayment.name,i,"putBucketRequestPayment")}function pe(e,t,n,r,i){p.log("enableBucketLoggingReceived",1,i,{bucketName:e});var o=ne("BucketLoggingStatus","http://doc.s3.amazonaws.com/2006-03-01").addNode("LoggingEnabled");return o.addNode("TargetBucket",t),o.addNode("TargetPrefix",n),r&&r.length>0&&function(){var e=o.addNode("TargetGrants");r.forEach(function(t){t.Grantee.Type=t.Grantee.URI?"Group":t.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";var n=e.addNode("Grant"),r=n.addNode("Grantee",{"xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:type":t.Grantee.Type});t.Grantee.ID&&r.addNode("ID",t.Grantee.ID),t.Grantee.DisplayName&&r.addNode("DisplayName",t.Grantee.DisplayName),t.Grantee.EmailAddress&&r.addNode("EmailAddress",t.Grantee.EmailAddress),t.Grantee.URI&&r.addNode("URI",t.Grantee.URI),n.addNode("Permission",t.Permission)})}(),re(i,e,a.bucketPropertiesMap.logging.name,o.build(),"enableBucketLogging")}function fe(e,t){p.log("disableBucketLoggingReceived",1,t,{bucketName:e});var n=ne("BucketLoggingStatus","http://doc.s3.amazonaws.com/2006-03-01/").build();return re(t,e,a.bucketPropertiesMap.logging.name,n,"disableBucketLogging")}function ge(t,n,r){var i={Tagging:{TagSet:{Tag:[]}}};e.forEach(n,function(e){i.Tagging.TagSet.Tag.push({Key:e.Key,Value:e.Value})});var o=f.jsonToXml(i);return p.log("putBucketTaggingReceived",1,r,{bucketName:t}),re(r,t,a.bucketPropertiesMap.tagging.name,o,"putBucketTagging")}function me(e,t,n){return p.log("deleteBucketTaggingReceived",1,n,{bucketName:e}),ie(n,e,a.bucketPropertiesMap.tagging.name,"deleteBucketTagging")}function he(e,t,n,r,i){p.log("putBucketWebsiteReceived",1,i,{bucketName:e});var o=ne("WebsiteConfiguration");return o.addNode("IndexDocument").addNode("Suffix",t),n&&o.addNode("ErrorDocument").addNode("Key",n),o.insertXml(r),re(i,e,a.bucketPropertiesMap.website.name,o.build(),"putBucketWebsite")}function be(e,t,n,r){p.log("putBucketWebsiteReceived",1,r,{bucketName:e});var i=ne("WebsiteConfiguration").addNode("RedirectAllRequestsTo");return i.addNode("HostName",t),n&&i.addNode("Protocol",n),re(r,e,a.bucketPropertiesMap.website.name,i.build(),"putBucketWebsite")}function ve(e,t){return p.log("deleteBucketWebsiteReceived",1,t,{bucketName:e}),ie(t,e,a.bucketPropertiesMap.website.name,"deleteBucketWebsite")}function Ee(e,t){return p.log("getBucketReplicationReceived",1,t,{bucketName:e}),Se(e,t)}function Se(e,t){return ae(t,e,a.bucketPropertiesMap.replication.name,"getBucketReplication")}function ye(e,n){var r="CRR_checkBucketReplication",i=new c("getBucketReplication","getBucketReplication"),a=new c("checkBucketReplication","checkBucketReplication");Se(e,i).then(function(e){var i=e.response,o=f.convertXmlStringToJson(n),s=f.convertXmlStringToJson(i);t.isEqual(o,s)?p.log(r,1,a):(a.errorDetails={expected:o,received:s},p.log(r,0,a))}).catch(function(e){a.errorDetails=e,p.log(r,0,a)})}function Ae(e,t,n,r){var i=!(arguments.length<=4||void 0===arguments[4])&&arguments[4];p.log("putBucketReplicationReceived",1,t,{bucketName:e});var o=r?Ce(n):_e(n,i);return re(t,e,a.bucketPropertiesMap.replication.name,o,"putBucketReplication").then(function(){ye(e,o)})}function Ce(e){var t=[],n=e.destinationBucket.value||e.destinationBucket;e.rules.forEach(function(e){var r={ID:e.id,Status:e.status,Prefix:e.prefix,Destination:{Bucket:h.getBucketARN(n),StorageClass:e.storageClass}};t.push(r)}),t=I(t);var r={ReplicationConfiguration:{Role:e.role,Rule:t}};return f.jsonToXml(r)}function _e(e,n){var r=[],i=e.destinationBucket,a=e.destAccountId;e.rules.forEach(function(e){var o=n?{ID:e.ID,Status:t.isEmpty(e.Status)?"Disabled":e.Status,Filter:e.Filter,DeleteMarkerReplication:{Status:"Disabled"},Priority:e.newPriority||e.Priority,Destination:{Bucket:h.getBucketARN(i),StorageClass:t.get(e.Destination,"StorageClass.value",void 0)}}:{ID:e.ID,Status:t.isEmpty(e.Status)?"Disabled":e.Status,Prefix:t.isEmpty(e.Prefix)?"":e.Prefix,Destination:{Bucket:h.getBucketARN(i),StorageClass:t.get(e.Destination,"StorageClass.value",void 0)}};t.isEmpty(a)||(o.Destination.Account=a),!e.Destination||t.isEmpty(e.Destination.AccessControlTranslation)||t.isEmpty(a)||(o.Destination.AccessControlTranslation=e.Destination.AccessControlTranslation),t.has(e,"ExistingObjectReplication.Status")&&(o.ExistingObjectReplication={Status:e.ExistingObjectReplication.Status});var s=t.get(e,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");t.isEmpty(s)||"Enabled"!==t.get(e,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")||(o.Destination.EncryptionConfiguration={ReplicaKmsKeyID:s},o.SourceSelectionCriteria={SseKmsEncryptedObjects:{Status:"Enabled"}}),r.push(o)}),r=I(r);var o={ReplicationConfiguration:{Role:e.role,Rule:r}};return f.jsonToXml(o)}function we(e,t){return p.log("deleteBucketReplicationReceived",1,t,{bucketName:e}),ie(t,e,a.bucketPropertiesMap.replication.name,"deleteBucketReplication")}function Te(e,t,n,i,o,s){return p.log("deleteBucketLifecycleReceived",1,s),a.deleteBucketProperty(s,e,a.bucketPropertiesMap.lifecycle.name).then(function(e){return p.log("deleteBucketLifecycle",1,s,{initialXml:t,finalXml:n,ruleBeforeEdit:i,ruleAfterEdit:o,"x-amz-id-2":e.headers(u.HEADERS.X_AMZ_ID_2),"x-amz-request-id":e.headers(u.HEADERS.X_AMZ_REQUEST_ID)}),e}).catch(function(e){return p.log("deleteBucketLifecycle",0,s,{initialXml:t,finalXml:n,ruleBeforeEdit:i,ruleAfterEdit:o,error:e}),r.reject(h.handleErrors(e))})}function Re(e,t,n,i,o,s){return p.log("putBucketLifecycleReceived",1,s),a.putBucketProperty(s,e,a.bucketPropertiesMap.lifecycle.name,n).then(function(e){return p.log("putBucketLifecycle",1,s,{initialXml:t,finalXml:n,ruleBeforeEdit:i,ruleAfterEdit:o,"x-amz-id-2":e.headers(u.HEADERS.X_AMZ_ID_2),"x-amz-request-id":e.headers(u.HEADERS.X_AMZ_REQUEST_ID)}),e}).catch(function(e){return p.log("putBucketLifecycle",0,s,{initialXml:t,finalXml:n,ruleBeforeEdit:i,ruleAfterEdit:o,error:e}),r.reject(h.handleErrors(e))})}function Oe(e,t){return p.log("getBucketLifecycleReceived",1,t),a.getBucketProperty(t,e,a.bucketPropertiesMap.lifecycle.name).then(function(e){return e.response?(p.log("getBucketLifecycle",1,t,{content:e.response}),e.response):(p.log("getBucketLifecycle",1,t,{content:e}),e)}).catch(function(e){var n=h.handleErrors(e);return e!==u.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE?p.log("getBucketLifecycle",0,t,{error:e}):p.log("getBucketLifecycle",1,t,{content:u.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE}),r.reject(n)})}function ke(e,t){return p.log("getBucketInventoryReceived",1,t,{bucketName:e}),ae(t,e,a.bucketPropertiesMap.inventory.name,"getBucketInventory")}function Ie(e,t,n){return p.log("putBucketInventoryReceived",1,n),a.putBucketProperty(e,a.bucketPropertiesMap.inventory.name,t).then(function(e){return p.log("putBucketInventory",1,n,{content:t}),e}).catch(function(e){return p.log("putBucketInventory",0,n,{error:e}),r.reject(h.handleErrors(e))})}function Pe(e,t){return p.log("deleteBucketInventoryReceived",1,t),ie(t,e,a.bucketPropertiesMap.inventory.name,"deleteBucketInventory")}function Ne(e,t){return p.log("getBucketAccelerateReceived",1,t,{bucketName:e}),a.getBucketProperty(t,e,a.bucketPropertiesMap.accelerate.name).then(function(e){p.logRequestComplete("getBucketAccelerate",t);var n=f.convertXmlStringToJson(e.response);return n.AccelerateConfiguration&&n.AccelerateConfiguration.Status}).catch(function(n){return p.log("getBucketAccelerate",0,t,{bucketName:e,error:n}),r.reject(h.handleErrors(n))})}function Me(e,t,n){var i={},o=void 0;return i.AccelerateConfiguration={},i.AccelerateConfiguration.Status=n,o=f.jsonToXml(i),o=o.replace("<AccelerateConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AccelerateConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">'),p.log("putBucketAccelerateReceived",1,t),a.putBucketProperty(t,e,a.bucketPropertiesMap.accelerate.name,o).then(function(e){return p.log("putBucketAccelerate",1,t,{content:o}),e}).catch(function(e){return p.log("putBucketAccelerate",0,t,{content:o,error:e}),r.reject(h.handleErrors(e))})}function Le(e,t){return s.describeTrails({includeShadowTrails:!0,trailNameList:[],region:t}).then(function(t){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.DESCRIBE_TRAILS,1,e,{content:t.content}),r.resolve(t)}).catch(function(t){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.DESCRIBE_TRAILS,0,e,{error:t}),r.reject(h.handleErrors(t))})}function xe(e,t,n){return s.getEventSelectors({TrailName:e,region:n}).then(function(e){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.GET_EVENT_SELECTORS,1,t,{content:e.content}),r.resolve(e)}).catch(function(e){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.GET_EVENT_SELECTORS,0,t,{error:e}),r.reject(h.handleErrors(e))})}function De(e,t,n){return e.region=n,s.putEventSelectors(e).then(function(n){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.PUT_EVENT_SELECTORS,1,t,{content:e}),r.resolve(n)}).catch(function(n){return p.log(u.PROXY_API_NAMES.CLOUDTRAIL.PUT_EVENT_SELECTORS,0,t,{content:e,error:n}),r.reject(h.handleErrors(n))})}function je(e,t,n){var i=void 0,o=void 0,s=void 0;return t.encryption===u.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AES256?i=u.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AES256:t.encryption===u.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AWSKMS&&(i=u.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AWSKMS),o={ServerSideEncryptionConfiguration:{Rule:{ApplyServerSideEncryptionByDefault:{SSEAlgorithm:i}}}},t.encryption===u.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AWSKMS&&(t.kmsId.value===u.OBJECT_SSE.CUSTOM_ARN?o.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=t.customKMSARN:o.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=t.kmsId.value),s=f.jsonToXml(o),a.putBucketProperty(n,e,"defaultEncryption",s).then(function(e){return p.log("PutDefaultEncryption:createBucket",1,n),r.resolve(e)},function(e){var t=h.handleErrors(e);return p.log("PutDefaultEncryption:createBucket",0,n,{error:e,customerErrorMsg:t}),r.reject(t)})}function Be(s,c){var l=arguments.length<=2||void 0===arguments[2]||arguments[2],p={bucket:s};if(b.isFeatureEnabled(u.FAC.PUBLIC_ACCESS_BLOCK)&&(p.accountId=h.getUserAccountId()),l){var f=o.getAccessAnalysis(s);if(f)return r.when(f)}var g=r.defer(),m=function r(){if(l){var a=o.getAccessAnalysis(s);if(a)return g.resolve(a)}Ue>=i.MAX_CALLS?n(r,i.SLEEP_TIME):(Ue++,d.makeS3ConsoleOperationRequest(p,u.CWS_OPERATION_NAME.ANALYZE_ACCESS,{},c).then(function(n){var r=t.get(n,"data.statusPerKey[0].result.additionalInfoWhenSuccess"),i=t.get(n,"data.statusPerKey[0].result.status"),a=e.fromJson(r);i&&"ERROR"===i?g.reject(n):(o.putAccessAnalysis(s,a),g.resolve(a))}).catch(function(e){g.reject(e)}).finally(function(){Ue--}))};return a.getBucketLocation(c,s,p).then(function(){m()}).catch(function(e){g.reject(h.handleErrors(e,!0))}),g.promise}var Fe={deleteBucketCORS:L,deleteBucketPolicy:B,getBucketACL:w,getBucketACP:_,getBucketOwnerDisplayName:E,getBucketLocation:y,getBucketGranteeCounts:A,getBucketCORS:M,getBucketGrantees:C,getBucketNotification:G,getBucketPolicy:D,getBucketVersioning:te,getEventCount:V,getBucketLifecycleConfiguration:F,getLoggingTargetBucket:W,getTagCount:Q,getVersioningStatus:U,getVersioningAndMFAStatus:K,isAnalyticsEnabled:q,isBucketPolicyApplied:x,isCORSEnabled:P,isInventoryEnabled:X,isLifecycleEnabled:J,isLoggingEnabled:Y,isMetricsEnabled:Z,isReplicationEnabled:$,isObjectRetentionEnabled:H,isRequesterPaysEnabled:z,enableBucketRequestPayment:le,disableBucketRequestPayment:ue,isWebsiteEnabled:ee,putBucketACL:T,putBucketNotification:R,parseBucketNotificationObject:O,putBucketCORS:N,putBucketPolicy:j,enableBucketVersioning:oe,disableBucketVersioning:se,enableBucketLogging:pe,disableBucketLogging:fe,putBucketTagging:ge,deleteBucketTagging:me,configureBucketWebsite:he,redirectBucketWebsiteRequests:be,deleteBucketWebsite:ve,getBucketReplication:Ee,putBucketReplication:Ae,deleteBucketReplication:we,parseBucketReplicationObject:_e,parseBucketReplicationObject_v1:Ce,getBucketLifecycle:Oe,putBucketLifecycle:Re,deleteBucketLifecycle:Te,getBucketInventory:ke,putBucketInventory:Ie,deleteBucketInventory:Pe,getBucketAccelerate:Ne,putBucketAccelerate:Me,getBucketRegion:S,describeTrails:Le,getEventSelectors:xe,putEventSelectors:De,putBucketDefaultEncryption:je,analyzeAccess:Be},Ue=0;return Fe}e.module("s3").service("BucketPropertiesService",["$timeout","$q","AnalyzeAccessConstants","APIProxyService","CachingService","CloudTrailService","ConsoleOperation","Region","S3Constants","S3CWSAPIService","SCLogService","XMLParser","XmlBuilderService","PermissionsUtilService","UtilService","FAC","SharpieAPI",n])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("XmlBuilderService",["UtilService",function(e){function n(n,r,i){function a(e){return{addNode:function(t,n,r){return l(t,n,r,e)},insertXml:function(t){return s(t,e)},build:o}}function o(){return u(d)}function s(e,t){return t.innerXml=e,a(t)}function c(e,n,r){var i={name:e,attributes:{},children:[],innerText:"",innerXml:""};return t.isString(n)?r=n:i.attributes=n,r&&(i.innerText=r),i}function l(e,t,n,r){var i=c(e,t,n);return r.children.push(i),a(i)}function u(n){var r=n.name,i=n.children,a=n.attributes,o=t.map(a,function(e,t){return" "+t+'="'+e+'"'}).join(""),s=i.map(u).join(""),c=e.encodeXml(n.innerText||""),l=n.innerXml||"";return t.isEmpty(i)&&t.isEmpty(l)&&t.isEmpty(c)?"<"+r+o+"/>":"<"+r+o+">"+c+s+l+"</"+r+">"}var d=c(n,r,i);return a(d)}return{create:function(e,t,r){return new n(e,t,r)}}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("ObjectPropertiesService",["$q","$translate","S3CWSAPIService","APIProxyService","CachingService","PathService","S3Constants","SCLogService","UtilService","XMLParser",function(n,r,i,a,o,s,c,l,u,d){function p(e){var n=t.cloneDeep(e);for(var r in n){var i=n[r];u.isStorageClassRestorable(i.StorageClass)&&(i.downloadDisabled=!0,i.deleteDisabled=!0),i.StorageClass=u.getStorageClassTranslations()[i.StorageClass]}return n}function f(e,n){var r=t.cloneDeep(e),i=void 0;n.downloadDisabled=!0;for(var a=0;a<r.length;a++)if(i=r[a],i.LastModified<=n.LastModified){r.splice(a,0,n);break}return r}function g(e,r,i){var s=o.getCurrentVersions(e,r);if(s)return i.isCached=!0,l.log(i.name+"IsCached",0,i),n.resolve(s);var g=n.defer(),m={bucket:e,prefix:r};return i.isCached=!1,a.listVersions(i,m).then(function(n){var a=t.cloneDeep(n),s=void 0,m=void 0,h=void 0;if(!a.response)return l.log(i.name+"ListVersionsCall",0,i),void g.reject("There is no data in the listVersions response.");if("string"==typeof a.response)s=d.convertXmlStringToJson(a.response).ListVersionsResult;else{if(!a.response.ListVersionsResult)return l.log(i.name+"ListVersionsCall",0,i),void g.reject("There is no data in the listVersions response.");s=a.response.ListVersionsResult}m=s.Version,m=u.transformObjectToArray(m),m=t.filter(m,function(e){return e.Key===r}),l.log(i.name+"ListVersionsCall",1,i),i.listVersionsResponse=a;var b=u.getIconClassFromFilename(r);if(t.map(m,function(e){return e.fileIconClass=b,e}),(h=p(m))&&s.DeleteMarker){var v=u.transformObjectToArray(s.DeleteMarker);t.each(v,function(e){e.fileIconClass=c.FILE_EXTENSIONS_ICON_MAP.trash,e.Key===r&&(h=f(h,e))})}o.setCurrentVersions(e,r,h),g.resolve(h)}).catch(function(e){g.reject(u.handleErrors(e))}),g.promise}function m(e,t,n){return i.makeS3ConsoleOperationRequest(t,c.CWS_OPERATION_NAME.SELECT_WITHIN_OBJECT,{},n)}function h(t,r,i,o){var c=s.getCurrentBucket();r?l.log("putObjectVersionTaggingReceived",1,o,{bucketName:c,object:t,versionId:r}):l.log("putObjectTaggingReceived",1,o,{bucketName:c,object:t});var p={Tagging:{TagSet:{Tag:[]}}};e.forEach(i,function(e){e.Key&&p.Tagging.TagSet.Tag.push({Key:e.Key,Value:e.Value})});var f=d.jsonToXml(p);return a.putObjectTag(o,c,t,f,r).then(function(e){return r?l.logRequestComplete(T,o):l.logRequestComplete(w,o),e}).catch(function(e){return r?l.log(T,0,o,{objectName:t,versionId:r,error:e}):l.log(w,0,o,{objectName:t,error:e}),n.reject(u.handleErrors(e))})}function b(e){e.metadataKey&&e.metadataKey.error||(e.metadataKey.hasOwnProperty("inputValue")&&!t.startsWith(e.metadataKey.inputValue,c.USER_DEFINED_METADATA_PREFIX)?e.metadataKey.error=r.instant("metadatacard.startingwith"):e.metadataKey.error="")}function v(e){e.metadataKey&&e.metadataKey.error||(e.metadataKey&&!/^[\x20-\x7E]+$/.test(e.metadataKey.text)||e.metadataKey.hasOwnProperty("inputValue")&&!/^[\x20-\x7E]+$/.test(e.metadataKey.inputValue)?e.metadataKey.error=r.instant("metadatacard.nonasc"):e.metadataKey.error="")}function E(e){e.metadataValue&&e.metadataValue.inputError||(!e.metadataValue||t.isEmpty(e.metadataValue.text)||/^[\x20-\x7E]+$/.test(e.metadataValue.text)?e.metadataValue.inputError="":e.metadataValue.inputError=r.instant("metadatacard.nonasc"))}function S(e,n){e.forEach(function(e){e.metadataKey?e.metadataKey.hasOwnProperty("inputValue")&&t.isEmpty(e.metadataKey.inputValue)?e.metadataKey.error=r.instant("objectdetail.metadata.emptyvaluewarning"):t.isEmpty(e.metadataKey.text)?e.metadataKey.error=r.instant("objectdetail.metadata.emptyvaluewarning"):e.metadataKey.error="":e.metadataKey={error:r.instant("objectdetail.metadata.emptyvaluewarning")},!e.metadataValue||e.metadataValue&&t.isEmpty(e.metadataValue.text)?e.metadataValue?e.metadataValue.inputError=r.instant("objectdetail.metadata.emptyvaluewarning"):e.metadataValue={inputError:r.instant("objectdetail.metadata.emptyvaluewarning")}:e.metadataKey&&e.metadataKey.value===c.USER_DEFINED_METADATA[6]?t.startsWith(e.metadataValue.text,"/")||t.startsWith(e.metadataValue.text,"http://")||t.startsWith(e.metadataValue.text,"https://")?e.metadataValue.inputError="":e.metadataValue.inputError=r.instant("objectdetail.metadata.websitevaluewarning"):e.metadataValue.inputError="",b(e),v(e),E(e)});var i=y(e);return!t.isEmpty(i)&&n&&(n.text=i),t.isEmpty(i)&&-1===t.findIndex(e,function(e){return e.metadataValue.inputError&&e.metadataValue.inputError.length>0})&&-1===t.findIndex(e,function(e){return e.metadataKey.error&&e.metadataKey.error.length>0})}function y(e){var n={};e.forEach(function(e){if(e&&e.metadataKey){var t=e.metadataKey.hasOwnProperty("inputValue")?e.metadataKey.inputValue:e.metadataKey.text;t&&(n[t]=n.hasOwnProperty(t)?n[t]+1:1)}});var r="";return t.forEach(n,function(e,t){e>1&&(r+=t+", ")}),r.slice(0,r.lastIndexOf(","))}function A(e){var n={};return t.forEach(e,function(e){var t=e.metadataKey.inputValue||e.metadataKey.value,r=e.metadataValue.text;n[t]=r}),n}function C(e,n,r){var i={addAndChangeMetadata:{},deleteMetadata:[],numberOfKeysPerBulkOperation:r};return t.forEach(n,function(t,n){e.hasOwnProperty(n)&&e[n]===t||(i.addAndChangeMetadata[n]=t)}),t.forEach(e,function(e,t){n.hasOwnProperty(t)||i.deleteMetadata.push(t)}),i}function _(){return R}var w="putObjectTagging",T="putObjectVersionTagging",R=[{value:c.USER_DEFINED_METADATA[0],text:r.instant("objectdetail.metadata.cache-control")},{value:c.USER_DEFINED_METADATA[1],text:r.instant("objectdetail.metadata.content-disposition"),dropDownValue:c.CONTENT_DISPOSITION},{value:c.USER_DEFINED_METADATA[2],text:r.instant("objectdetail.metadata.content-encoding")},{value:c.USER_DEFINED_METADATA[3],text:r.instant("objectdetail.metadata.content-language")},{value:c.USER_DEFINED_METADATA[4],text:r.instant("objectdetail.metadata.content-type"),dropDownValue:c.CONTENT_TYPE_VALUES},{value:c.USER_DEFINED_METADATA[5],text:r.instant("objectdetail.metadata.expires")},{value:c.USER_DEFINED_METADATA[6],text:r.instant("objectdetail.metadata.website-redirect-location")},{value:c.USER_DEFINED_METADATA_PREFIX,text:r.instant("objectdetail.metadata.x-amz-meta-"),displayTextField:!0}];return{convertToReadableStorageClass:p,insertDeleteMarker:f,listVersions:g,putObjectTagging:h,isValid:S,selectWithinObject:m,getMetadataRequestParams:C,checkDuplicatedKey:y,getMetadataMap:A,getPredefinedMetadata:_}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("S3SelectService",["$q","S3CWSAPIService","APIProxyService","S3Constants","S3SelectConstants","SCLogService","UtilService","FAC","$translate",function(n,r,i,a,o,s,c,l,u){function d(n,r,i){var a=e.fromJson(t.get(i,"data.statusPerKey[0].result.additionalInfoWhenSuccess")),s=t.get(i,"data.statusPerKey[0].result.status");if(s&&"ERROR"===s)return void r.reject(i);var c=a.result,l=a.isSizeTruncated,u=a.isTimeTruncated,d=function(){if(n!==o.FILE_FORMATS.JSON)return c;try{return e.fromJson(c)}catch(t){return c.split("\r\n").reduce(function(t,n){return n&&n.length&&t.push(e.fromJson(n)),t},[])}}();r.resolve({data:d,isTimeTruncated:u,isSizeTruncated:l})}function p(e){var t=e.StorageClass,n=e.IsLatest,r=t?t.toUpperCase():"";return l.isFeatureEnabled(a.FAC.S3_SELECT)&&(r===a.STORAGE_CLASSES.STANDARD||r===a.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS||r===a.STORAGE_CLASSES.ONEZONE_IA)&&(void 0===n||n&&"true"===n)}function f(e){var t=e.match(/\.([a-zA-Z0-9]+)/);if(!t||t.length<2)return o.FILE_FORMATS.CSV;switch(t[1].toLowerCase()){case"json":return o.FILE_FORMATS.JSON;case"csv":return o.FILE_FORMATS.CSV;case"parquet":return o.FILE_FORMATS.PARQUET;case"gzip":case"gz":case"bz2":return/json/.test(e)?o.FILE_FORMATS.JSON:/parquet/.test(e)?o.FILE_FORMATS.PARQUET:o.FILE_FORMATS.CSV}return o.FILE_FORMATS.CSV}function g(e){return/\.gz$/.test(e)||/\.gzip$/.test(e)?o.COMPRESSIONS.GZIP:/\.bz2$/.test(e)?o.COMPRESSIONS.BZIP2:o.COMPRESSIONS.NONE}function m(e){return function(t){return t&&""!==t?e===o.FILE_FORMATS.JSON?JSON.stringify(t,null,"    "):t:u.instant("objects.select.result.noresult")}}function h(e,t){return e===o.DELIMITERS.COMMA?void 0:e===o.DELIMITERS.CUSTOM?t:"\t"}function b(e,t,c,l){var u=arguments.length<=4||void 0===arguments[4]?{}:arguments[4],p=u.fileType,f=u.jsonType,g=u.compressionType,m=u.outputFileType,b=u.useHeader,v=u.delimiterType,E=u.customDelimiter,S={},y=n.defer(),A=p===o.FILE_FORMATS.CSV,C=p===o.FILE_FORMATS.JSON,_={expression:l,key:e.initialPath+c.Key,expressionType:"SQL",bucket:t,inputFileType:p,outputFileType:m,jsonType:C?f:void 0,compressionType:g,fileHeaderInfo:b&&A?"USE":void 0,fieldDelimiter:A?h(v,E):void 0};return i.getBucketLocation(e,t,S).then(function(){_.region=S.region,r.makeS3ConsoleOperationRequest(_,a.CWS_OPERATION_NAME.SELECT_WITHIN_OBJECT,{},e).then(function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];s.log(a.CWS_OPERATION_NAME.SELECT_WITHIN_OBJECT,1,e),d.apply(void 0,[_.outputFileType,y].concat(n))}).catch(function(){s.log(a.CWS_OPERATION_NAME.SELECT_WITHIN_OBJECT,0,e),y.reject.apply(y,arguments)})}).catch(function(){return y.reject.apply(y,arguments)}),y.promise}function v(e,n){var r=void 0;if("InvalidCompressionFormat"===t.get(e,"data.statusPerKey[0].result.errorCode"))r=u.instant("objects.select.errors.invalidcompressionformat",{compressionType:n.compressionType});else{var i=c.handleErrors(e,!0,"objects.select.errors");r=i.errorMessageLocalized?i.errorMessageLocalized:i.errorMessage}return r}return{selectWithinObject:b,determineFileType:f,determineCompressionType:g,s3SelectEnabledForObject:p,getResultProcessFunc:m,getLocalizedErrorMessage:v}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){function t(e,t,n){function r(t,r){var a=t.Version,o=t.DeleteMarker,s={allVersions:[],nonVersionRowCount:0};if(!a&&!o)return s;a=a?e.absoluteToRelativeObjectPaths(n.transformObjectToArray(a),r):[],o=o?e.absoluteToRelativeObjectPaths(n.transformObjectToArray(o),r):[];for(var c=0,l=0,u=0,d=a.length+o.length;c<d;){var p=void 0,f=[],g=[],m=[];if(l<a.length&&u<o.length){var h=a[l].Key,b=o[u].Key;h===b?(p=h,a[l].isVersionRow=!0,f.push(a[l]),o[u].isVersionRow=!0,g.push(o[u]),l+=1,u+=1):h<b?(p=h,a[l].isVersionRow=!0,f.push(a[l]),l+=1):(p=b,o[u].isVersionRow=!0,g.push(o[u]),u+=1)}else u>=o.length&&l<a.length?(p=a[l].Key,a[l].isVersionRow=!0,f.push(a[l]),l+=1):l>=a.length&&u<o.length&&(p=o[u].Key,o[u].isVersionRow=!0,g.push(o[u]),u+=1);for(;l<a.length&&a[l].Key===p;)a[l].isVersionRow=!0,f.push(a[l]),l+=1;for(;u<o.length&&o[u].Key===p;)o[u].isVersionRow=!0,g.push(o[u]),u+=1;c+=f.length+g.length,m=i(p,f,g),s.allVersions=s.allVersions.concat(m),s.nonVersionRowCount+=1}return s}function i(e,t,n){var r=0,i=0,a=t.length,o=[{isVersionRow:!1,Key:e,LastModified:""}];for(t.forEach(function(e){e.isVersionRow=!0}),n.forEach(function(e){e.isVersionRow=!0}),0===t.length?(o=o.concat(n),i=a):0===n.length&&(o=o.concat(t),i=a);i<a;i++){var s=t[i],c=new Date(s.LastModified),l=void 0,u=void 0;if(!(r<n.length)){t.splice(0,i),o=o.concat(t);break}for(l=n[r],u=new Date(l.LastModified);r<n.length&&c<=u;)o.push(l),(r+=1)<n.length&&(l=n[r],u=new Date(l.LastModified));o.push(s)}return o[0].LastModified=o[1].LastModified,o}return{getAllVersionsForDisplay:r}}e.module("s3").service("VersioningUtilService",["PathService","S3Constants","UtilService",t])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function n(e,n,o,s,c){function l(l,u,d){return i(this,void 0,void 0,function(){var i,p,f,g,m,h,b;return a(this,function(a){switch(a.label){case 0:i=new s(o.OPERATION_NAME.GET_OBJECT_TAGGING),p={key:u,versionId:d},f=d?"getObjectVersionTags":"getObjectTags",n.log("getObjectTagsReceived",1,i,p),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.getObjectTag(i,l,u,d)];case 2:return g=a.sent().response,n.log(f,1,i,p),g&&(m=c.convertXmlStringToJson(g),t.has(m,"Tagging.TagSet.Tag"))?[2,[].concat(m.Tagging.TagSet.Tag).map(function(e){return{Key:e.Key,Value:e.Value||""}})]:[2,[]];case 3:return h=a.sent(),b=Number(t.get(h,"status")===o.HTTP_STATUS_CODES.NOT_FOUND&&t.get(h,"response.Error.Code")===o.TAGGING.ERROR_CODES.NO_SUCH_TAG_SET),n.log(f,b,i,r({},p,{error:h})),[2,[]];case 4:return[2]}})})}return{getObjectTags:l}}var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},i=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},a=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};e.module("s3").factory("ApiClientService",["APIProxyService","SCLogService","S3Constants","ConsoleOperation","XMLParser",n])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){e.module("s3").factory("S3ConsolePromiseQueue",["$log","$q",function(e,r){return function(){function r(e){t(this,r),this.concurrentPromises=e,this.queue=[],this.queueKeys=[],this.runningIxs=[],this.currentIx=-1,this.cancelled=!1}return n(r,[{key:"add",value:function(e,t){this.queue.push(e),this.queueKeys.push(t),this.next()}},{key:"clear",value:function(){var e=this;this.cancelled=!0;var t=this.queueKeys.filter(function(t,n){return e.runningIxs.indexOf(n)>-1});return this.queue=[],this.queueKeys=[],this.runningIxs=[],this.startIx=-1,this.endIx=-1,t}},{key:"next",value:function(){var t=this;if(this.runningIxs.length>=this.concurrentPromises||this.cancelled||this.currentIx===this.queue.length-1)return!1;try{!function(){t.currentIx++;var e=t.currentIx;t.runningIxs.push(e),t.queue[e]().catch(function(){}).finally(function(){t.runningIxs.splice(t.runningIxs.indexOf(e),1),t.next()})}()}catch(t){e.error(t),this.next()}}}]),r}()}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("modal",[function(){return{restrict:"E",template:n(554),scope:{isOpen:"=",closeCallback:"=?",headerTitle:"=",state:"=?",steps:"=?",nextState:"=?",previousState:"=?",setState:"=?"},transclude:{header:"?modalHeader",content:"modalContent",footer:"modalFooter"},controller:"ModalController"}}]),e.module("s3").controller("ModalController",["$scope","UtilService",function(e,t){e.closeModal=function(){e.isOpen.flag=!1,e.closeCallback(),t.bodyFreezeScroll(e.isOpen&&e.isOpen.flag)},e.getState=function(t){var n=Object.keys(e.steps)[t];if(n)return e.steps[n]},e.setState=function(t){e.state=t},e.nextState=function(){var t=Object.keys(e.steps).indexOf(e.state.name);e.setState(e.getState(t+1))},e.previousState=function(){var t=Object.keys(e.steps).indexOf(e.state.name);e.setState(e.getState(t-1))}}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=aws-modal> <div ng-show=isOpen.flag class=\"modal-frame fade in ng-hide\"> <div class=\"modal-header modal-header-image\"> <i class=\"panel-close-icon modal-close\" ng-click=closeModal()></i> <div class=modal-header-title>{{headerTitle}}</div> <table id=header-steps class=header-steps ng-if=steps> <tr> <td class=attained-step ng-if=getState(0)> <div class=modal-header-value ng-class=\"{ 'selected-step': state === getState(0) }\"><span class=modal-image ng-class=\"state === getState(0) ? 'modal-stepone-selected-image' : 'modal-checked-image'\"></span><span class=modal-stepname>{{getState(0).value}}</span></div> </td> <td ng-if=getState(1) ng-class=\"state !== getState(0) ? 'attained-step' : 'step'\"> <div class=modal-header-value ng-class=\"{ 'selected-step': state === getState(1) }\"><span class=modal-image ng-class=\"{'modal-steptwo-selected-image': state==getState(1),\n                            'modal-steptwo-unselected-image': state === getState(0),\n                            'modal-checked-image': state === getState(2) || state===getState(3)}\"></span><span class=modal-stepname>{{getState(1).value}}</span></div> </td> <td ng-if=getState(2) ng-class=\"state === getState(2) || state===getState(3)? 'attained-step' : 'step'\"> <div class=modal-header-value ng-class=\"{ 'selected-step': state === getState(2) }\"><span class=modal-image ng-class=\"{'modal-stepthree-selected-image': state==getState(2),\n                            'modal-stepthree-unselected-image': state === getState(0) || state===getState(1),\n                            'modal-checked-image': state === getState(3)}\"></span><span class=modal-stepname>{{getState(2).value}}</span></div> </td> <td ng-if=getState(3) ng-class=\"state === getState(3) ? 'attained-step' : 'step'\"> <div class=modal-header-value ng-class=\"{ 'selected-step': state === getState(3) }\"><span class=modal-image ng-class=\"state === getState(3) ? 'modal-stepfour-selected-image' : 'modal-stepfour-unselected-image'\"></span><span class=modal-stepname>{{getState(3).value}}</span></div> </td> </tr> </table> <div ng-transclude=header></div> </div> <div class=modal-body ng-transclude=content></div> <div class=modal-footer> <div class=footer-divider></div> <div ng-transclude=footer></div> </div> </div> <div ng-show=isOpen.flag class=\"modal-background ng-hide\"></div> </div>"},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("focusWhen",[function(){return{restrict:"A",link:function(e,t,n){e.$on("focusOn",function(e,r){r===n.focusWhen&&t[0].focus()})}}}]),e.module("s3").factory("focusOn",["$rootScope","$timeout",function(e,t){return function(n){t(function(){e.$broadcast("focusOn",n)})}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){e.module("s3").directive("clickoutside",["$document","UUIDService",function(e,n){return{restrict:"A",scope:{onClickOutside:"=",isEnabled:"=?"},link:function(r,i,a){a.id?r.mainElementId=a.id:(r.mainElementId=n.generateUUID(),t(i).attr("id",r.mainElementId));var o=function(e){if(!1!==r.isEnabled&&e&&e.target){for(var t=e.target;t;t=t.parentNode){var n=t.id;if(void 0!==n&&n===r.mainElementId)return}r.$apply(function(){r.onClickOutside()})}};e.on("click",o),r.$on("$destroy",function(){e.off("click",o)})}}}])}).call(t,n(0),n(6))},function(e,t,n){"use strict";(function(e,t,r){e.module("s3").directive("bucketSelector",[function(){return{restrict:"E",controller:"BucketSelectorController",scope:{bucketList:"=?",copySettingsSourceBucket:"=?",operation:"=?",getSourceBucketProperties:"=?",getSourceBucketPermissions:"=?",currBucketPermissions:"=?",defaultAcls:"=?",editable:"=?",selectedReport:"=?",showBucketNameOnly:"=?",chooseAccounts:"=?",isOpen:"=?",sameRegion:"=?",bucketReplication:"=?",enableDeselect:"=?",getSourceBucketPublicAccess:"=?",currentPublicAccessSettings:"=?",defaultPublicAccessSettings:"=?"},template:n(558)}}]),e.module("s3").controller("BucketSelectorController",["$filter","$scope","$translate","BucketPropertiesService","BucketPropertiesUtilService","APIProxyService","XMLParser","SCLogService","ConsoleOperation","Region","PathService","PermissionsUtilService","S3Constants","UtilService","FAC","PublicAccessService","RegionStatesService",function(e,n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v){function E(){a.getBucketLocation(n.copySettingsSourceBucket.Name).then(function(e){n.copySettingsSourceBucket.Location=d.twoWayMapping[e],n.selectedReport&&(n.selectedReport.Location=n.copySettingsSourceBucket.Location)}).catch(function(e){n.selectedReport&&(n.selectedReport.bucketUnknown=i.instant("bucketselector.invalid.bucket"),n.selectedReport.bucketError=!0)})}function S(e){n.editable&&n.selectedReport&&(n.selectedReport.bucket=e.Name,n.selectedReport.Location=e.Location,n.selectedReport.bucketError=!1,n.selectedReport.bucketUnknown=""),n.editable&&n.bucketReplication&&(n.bucketReplication.isLoading=!0,n.bucketReplication.destinationBucket.name=e.Name,n.bucketReplication.destinationBucket.region=e.Location,n.bucketReplication.isCrossAccount||(n.bucketReplication.destinationBucket.accountId=null),y(e))}function y(e){a.getBucketVersioning(e.Name,new u("GetBucketVersioning"),!1).then(function(e){A(),n.bucketReplication.destinationBucket.versioningEnabled=e===g.BUCKET_PROPERTIES.VERSIONING.ENABLED}).catch(function(e){A(),n.bucketReplication.destinationBucket.Errors.getVersioningError=e}).then(function(){if(h.isFeatureEnabled(g.FAC.CRR_WITH_OBJECT_LOCK))return a.isObjectRetentionEnabled(e.Name,new u("getBucketReplication")).then(function(e){n.bucketReplication.destinationBucket.bucketObjectLockEnabled=e}).catch(function(e){n.bucketReplication.destinationBucket.Errors.getBucketObjectLockEnabledError=e})}).finally(function(){n.bucketReplication.isLoading=!1,n.savingBucket=!1,n.closeDropDown()})}function A(){n.bucketReplication.destinationBucket.Errors={},n.bucketReplication.destinationBucket.versioningEnabled=null,n.bucketReplication.destinationBucket.createNewDestBucket=!1,n.bucketReplication.destinationBucket.bucketNameValidationErrors.length=0,n.bucketReplication.destinationBucket.bucketObjectLockEnabled=null}function C(){r.isEmpty(n.currBucketPermissions)||r.isEmpty(n.defaultAcls)||(n.currBucketPermissions.publicPermissions=r.cloneDeep(n.defaultAcls.publicPermissions),n.currBucketPermissions.userPermissions=r.cloneDeep(n.defaultAcls.userPermissions),n.currBucketPermissions.awsAccountPermissions=r.cloneDeep(n.defaultAcls.awsAccountPermissions),n.currBucketPermissions.systemPermissions=r.cloneDeep(n.defaultAcls.systemPermissions));var e=new u(g.BUCKET_PERMISSIONS.CREATE_BUCKET_PERMISSIONS);a.getBucketGrantees(n.copySettingsSourceBucket.Name,e).then(function(t){w("getBucketGrantees",!0,e,""),n.getSourceBucketPermissions.grantees=t,a.getBucketACP(n.copySettingsSourceBucket.Name,e).then(function(t){w("getBucketAcls",!0,e,"");var i=r.get(t,"Owner"),a=r.get(t,"AccessControlList.Grant",[]);n.getSourceBucketPermissions.aclGrants=Array.isArray(a)?a:[a],r.isEmpty(n.currBucketPermissions)||f.populateAclsFields(n.currBucketPermissions,n.getSourceBucketPermissions.grantees,i,n.getSourceBucketPermissions.aclGrants)}).catch(function(t){w("getBucketAcls",!1,e,t),n.getSourceBucketPermissions.aclGrants.isError=!0,n.getSourceBucketPermissions.aclGrants.errorMessage=t})}).catch(function(t){w("getBucketGrantees",!1,e,t),n.getSourceBucketPermissions.grantees.isError=!0,n.getSourceBucketPermissions.grantees.errorMessage=m.handleErrors(t)})}function _(){!r.isEmpty(n.currentPublicAccessSettings)&&h.isFeatureEnabled(g.FAC.PUBLIC_ACCESS_BLOCK)&&function(){var e=new u(g.CWS_OPERATION_NAME.GET_BUCKET_PUBLIC_ACCESS);b.getBucketSettings(n.copySettingsSourceBucket.Name).then(function(t){w("getBucketPublicAccess",!0,e,t),Object.assign(n.currentPublicAccessSettings,t)}).catch(function(t){w("getBucketPublicAccess",!1,e,t),n.getSourceBucketPublicAccess&&(n.getSourceBucketPublicAccess.isError=!0,n.getSourceBucketPublicAccess.errorDetails=m.handleErrors(t,!0)),Object.assign(n.currentPublicAccessSettings,n.defaultPublicAccessSettings)})}()}function w(e,t,r,i){!0===t?l.log(e,1,r,{bucketName:n.copySettingsSourceBucket.Name}):l.log(e,0,r,{bucketName:n.copySettingsSourceBucket.Name,error:i})}function T(){a.getBucketLocation(O).then(function(e){I=d.twoWayMapping[e]}).finally(function(){R(n.operation)})}function R(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];n.bucketsLoaded=!1,l.log("LoadBucketsReceived",1,e),n.isLoadingBuckets=!0,n.bucketReplication&&(n.bucketReplication.isLoading=n.isLoadingBuckets),s.listAllMyBuckets(e,t).then(function(t){l.log("listAllMyBuckets",1,e);var i=t.response.ListAllMyBucketsResult.Buckets.Bucket;i&&i.length>0?function(){var e=i.length;i.forEach(function(t){a.getBucketLocation(t.Name).then(function(e){t.Location=d.twoWayMapping[e],P.then(function(n){r.contains(n,e)&&(t.disabled=!0)})}).finally(function(){if(--e<=0){if(n.sameRegion&&I){var t=r.filter(i,function(e){return e.Location===I});if(n.bucketList=t,n.selectedReport&&n.selectedReport.bucket){var a=-1===r.findIndex(i,function(e){return e.Name===n.selectedReport.bucket});n.account.outside=a?"true":"false",a&&(n.tmpValues.bucket=n.selectedReport.bucket,n.tmpValues.regionError="")}}else n.bucketReplication&&n.bucketReplication.sourceBucket?(n.bucketReplication.bucketListCurrAccount.length=0,i.forEach(function(e){n.bucketReplication.bucketListCurrAccount.push(e)}),n.bucketList=r.filter(i,function(e){return e.Name!==n.bucketReplication.sourceBucket&&e.Location!==n.bucketReplication.sourceRegion}),!n.bucketReplication.destinationBucket||n.bucketReplication.destinationBucket.createNewDestBucket||r.isEmpty(n.bucketReplication.destinationBucket.name)||(n.bucketReplication.isCrossAccount=-1===r.findIndex(i,function(e){return e.Name===n.bucketReplication.destinationBucket.name}),n.account.outside=n.bucketReplication.isCrossAccount?"true":"false",n.bucketReplication.isCrossAccount&&(n.tmpValues.bucket=n.bucketReplication.destinationBucket.name,n.tmpValues.regionError=""))):n.bucketList=i;n.isLoadingBuckets=!1,n.bucketReplication&&(n.bucketReplication.isLoading=n.isLoadingBuckets)}})})}():n.bucketList=[]}).catch(function(t){l.log("listAllMyBuckets",0,e,{error:t}),n.bucketList=[],n.isLoadingBuckets=!1,n.bucketReplication&&(n.bucketReplication.isLoading=n.isLoadingBuckets),n.bucketsLoaded=!0})}n.emptyText=i.instant("lamb.nobuckets"),n.noSelectedBucketText=i.instant("bucketselector.selecteditem.placeholder"),n.filterColumn="Name";var O=p.getCurrentBucket(),k={getResponse:o.getNewBucketDefaultProperties()},I="";n.savingBucket=!1;var P=v.getDisabledRegions();n.account={outside:"false"},n.tmpValues={accountId:"",bucket:"",regionError:""},n.tableFiltering={filter:{}},n.tableFiltering.filter[n.filterColumn]=n.defaultFilterValue,n.filterBlur=function(){n.tableFiltering.filter[n.filterColumn]||(n.tableFiltering.showClear=!1)},n.clearFilter=function(){n.tableFiltering.filter[n.filterColumn]="",n.tableFiltering.showClear=!1},n.filterKeyDown=function(e){e&&e.keyCode===g.KEY_CODES.ESC&&(t(".input-field").blur(),n.clearFilter())},n.$watch(function(){return n.tableFiltering.filter[n.filterColumn]},function(t,r){r!==t&&(n.selectedItem=null,n.bucketList&&(n.totalItems=e("filter")(n.bucketList,n.tableFiltering.filter).length))}),n.toggleDropDown=function(){n.isOpen=!n.isOpen,n.bucketList&&n.bucketList.forEach(function(e){return e.isExpanded=!1})},n.closeDropDown=function(){n.isOpen=!1,n.bucketList&&n.bucketList.forEach(function(e){return e.isExpanded=!1})},n.getBucketPlaceHolder=function(){var e="bucketselector.selecteditem.placeholder";return n.editable&&(e="bucketselector.selecteditem.notoptional.placeholder"),i.instant(e)},n.getSearchPlaceHolder=function(){var e="bucketselector.inputfield.placeholder";return n.editable&&(e="bucketselector.inputfield.enter.placeholder"),i.instant(e)},n.getResultsMessage=function(){var e="bucketselector.nomatchesfound";return n.editable&&!n.chooseAccounts&&(e="bucketselector.cross.account"),i.instant(e)},n.savePressed=function(e){e.stopPropagation(),n.tmpValues.regionError="",n.tmpValues.accountIdError="",n.savingBucket=!0;var t=o.stripBucketARN(n.tmpValues.bucket);if(0!==t.length)return r.isEmpty(n.tmpValues.accountId)||(n.tmpValues.accountId=n.tmpValues.accountId.trim(),null!==n.tmpValues.accountId.match(/^[0-9]+$/))?void(n.bucketReplication?(n.bucketReplication.isCrossAccount=!0,n.bucketReplication.isLoading=!0,n.bucketReplication.destinationBucket.name=n.tmpValues.bucket,n.bucketReplication.destinationBucket.accountId=n.tmpValues.accountId,n.copySettingsSourceBucket={Name:t,Location:""},A(),n.clearFilter(),s.headBucket(new u("checkBucketAvailability"),n.bucketReplication.destinationBucket.name).then(function(){S(n.copySettingsSourceBucket)}).catch(function(e){e.status===g.HTTP_STATUS_CODES.NOT_FOUND?(n.bucketReplication.destinationBucket.Errors.bucketNotExistError=i.instant("crr.error.destinationbucketdoesnotexist"),n.savingBucket=!1,n.bucketReplication.isLoading=!1,n.closeDropDown()):a.getBucketRegion(n.bucketReplication.destinationBucket.name).then(function(e){e.text===n.bucketReplication.sourceRegion?(n.bucketReplication.destinationBucket.Errors.generalErrors={header:i.instant("crr.warningmsg.content.sameregion"),content:i.instant("crr.errormsg.bucketinsameregion")},n.savingBucket=!1,n.bucketReplication.isLoading=!1,n.closeDropDown()):(n.copySettingsSourceBucket.Location=e.text,S(n.copySettingsSourceBucket))}).catch(function(){S(n.copySettingsSourceBucket)})})):a.getBucketLocation(n.tmpValues.bucket).then(function(e){if(n.sameRegion){var t=d.twoWayMapping[e];I!==t&&(n.tmpValues.regionError=i.instant("management.analytics.bucket.region.error",{dest:t,src:I}))}}).catch(function(e){n.tmpValues.regionError=i.instant("management.connection.error")}).finally(function(){n.tmpValues.regionError||(n.selectedReport&&(n.selectedReport.bucket=n.tmpValues.bucket,n.selectedReport.accountId=n.tmpValues.accountId),n.copySettingsSourceBucket={Name:t,Location:""},n.closeDropDown(),n.clearFilter(),S(n.copySettingsSourceBucket),E(),e.stopPropagation()),n.savingBucket=!1})):(n.tmpValues.accountIdError=i.instant("bucketselector.invalidaccountid"),void(n.savingBucket=!1))},n.createNewBucket=function(){A(),n.bucketReplication.destinationBucket.name=null,n.bucketReplication.destinationBucket.region=null,n.bucketReplication.destinationBucket.createNewDestBucket=!0,n.copySettingsSourceBucket={Name:i.instant("bucketselector.createnew")},n.closeDropDown()},n.selectBucket=function(e){e.disabled||(n.copySettingsSourceBucket=e,n.bucketReplication?(n.bucketReplication.isCrossAccount=!1,n.bucketReplication.destinationBucket.createNewDestBucket=!1,A(),S(e)):function(){S(e),n.getSourceBucketProperties=r.cloneDeep(k.getResponse);var t=new u("CreateBucketLogging"),i=new u("CreateBucketTagging"),l=new u("CreateBucketVersioning");s.getBucketProperty(i,e.Name,"tagging").then(function(e){var t=e.response;w("getBucketTagging",!0,i,"");var r=c.convertXmlStringToJson(t);r.Tagging&&o.populateTagsFields(r,n.getSourceBucketProperties.tagging.tags)}).catch(function(e){var t=m.handleErrors(e);t!==g.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE?(w("getBucketTagging",!1,i,e),n.getSourceBucketProperties.tagging.isError=!0,n.getSourceBucketProperties.tagging.errorMessage=t):w("getBucketTagging",!0,i,"")}),a.getBucketVersioning(n.copySettingsSourceBucket.Name,l).then(function(e){e===g.BUCKET_PROPERTIES.VERSIONING.ENABLED?(n.getSourceBucketProperties.versioning.enabled=!0,n.bucketReplication&&n.bucketReplication.destinationBucket&&(A(),n.bucketReplication.destinationBucket.Errors.versioningEnabled=!0)):(n.getSourceBucketProperties.versioning.enabled=!1,n.bucketReplication&&n.bucketReplication.destinationBucket&&(A(),n.bucketReplication.destinationBucket.Errors.versioningEnabled=!1))}).catch(function(e){n.getSourceBucketProperties.versioning.isError=!0,n.getSourceBucketProperties.versioning.errorMessage=e,n.bucketReplication&&n.bucketReplication.destinationBucket&&(A(),n.bucketReplication.destinationBucket.Errors.getVersioningError=e,n.bucketReplication.destinationBucket.versioningEnabled=null)}),s.getBucketProperty(t,n.copySettingsSourceBucket.Name,"logging").then(function(e){var r=e.response;w("getBucketLogging",!0,t,""),r&&(n.getSourceBucketProperties.logging=o.getLoggingFields(r))}).catch(function(e){w("getBucketLogging",!1,t,e),n.getSourceBucketProperties.logging.isError=!0,n.getSourceBucketProperties.logging.errorMessage=m.handleErrors(e)}),C(),_()}(),n.isOpen=!1,n.account.outside||!n.selectedReport&&!n.bucketReplication||(n.tmpValues.accountId="",n.tmpValues.bucket="",n.tmpValues.regionError=""))},n.deselectBucket=function(){n.editable||(n.copySettingsSourceBucket=void 0,n.getSourceBucketProperties=r.cloneDeep(k.getResponse),n.getSourceBucketPermissions.aclGrants={},n.getSourceBucketPermissions.grantees={},n.currBucketPermissions.publicPermissions=r.cloneDeep(n.defaultAcls.publicPermissions),n.currBucketPermissions.userPermissions=r.cloneDeep(n.defaultAcls.userPermissions),n.currBucketPermissions.awsAccountPermissions=r.cloneDeep(n.defaultAcls.awsAccountPermissions),n.currentPublicAccessSettings=r.cloneDeep(n.defaultPublicAccessSettings))},n.toggleBucket=function(e,t){t.disabled||(t.isExpanded=!t.isExpanded,e.stopPropagation(),t.isExpanded&&(l.log("getPropertiesForBucketSelector",1,n.operation,{bucketName:t.Name}),t.propertyCount=0,a.getBucketGranteeCounts(t.Name).then(function(e){t.permissionCount=e,t.granteeCount=t.permissionCount.READ+t.permissionCount.WRITE+t.permissionCount.READ_ACP+t.permissionCount.WRITE_ACP}),a.isLoggingEnabled(t.Name).then(function(e){e?(t.loggingStatus=i.instant("bucketproperty.enabled"),t.propertyCount++):t.loggingStatus=i.instant("bucketproperty.disabled")}),a.getVersioningStatus(t.Name).then(function(e){"Enabled"===e?(t.versioningStatus=i.instant("bucketproperty.enabled"),t.propertyCount++):t.versioningStatus="Suspended"===e?i.instant("bucketproperty.suspended"):i.instant("bucketproperty.disabled")}),a.getTagCount(t.Name).then(function(e){t.tagCount=e})))},function(){if(n.bucketsLoaded=!1,n.outside=!1,n.chooseAccounts&&n.selectedReport&&(n.tmpValues.bucket=n.selectedReport.bucket,n.tmpValues.accountId=n.selectedReport.accountId,n.tmpValues.regionError=""),n.chooseAccounts&&n.bucketReplication&&(n.tmpValues.bucket=n.bucketReplication.destinationBucket.name,n.tmpValues.accountId=n.bucketReplication.destinationBucket.accountId,n.tmpValues.regionError="",n.account.outside=n.bucketReplication.isCrossAccount?"true":"false"),!n.bucketList&&n.editable){n.operation=new u("SelectBucket");var e={},t=g.BUCKET_PERMISSIONS;e.createBucketProperties=r.cloneDeep(k),e.sourceBucketPermissions={grantees:{},aclGrants:{}},e.currPermissions=r.cloneDeep(t.INITIALIZE_ACLS),e.createBucketValues={firstLoad:!0,copySettingsSourceBucket:null},e.operation=new u("CreateBucket","CreateBucketRequestReceived"),e.defaultAcls=r.cloneDeep(t.INITIALIZE_ACLS),n.copySettingsSourceBucket={},n.selectedReport&&n.selectedReport.bucket&&(n.copySettingsSourceBucket.Name=n.selectedReport.bucket),n.bucketReplication&&n.bucketReplication.destinationBucket&&(n.copySettingsSourceBucket.Name=n.bucketReplication.destinationBucket.createNewDestBucket?i.instant("bucketselector.createnew"):n.bucketReplication.destinationBucket.name),n.getSourceBucketProperties=e.createBucketProperties.getResponse,n.getSourceBucketPermissions=e.sourceBucketPermissions,n.currBucketPermissions=e.createBucketValues.copySettingsSourceBucket,n.defaultAcls=e.defaultAcls,T()}else n.bucketsLoaded=!0}()}])}).call(t,n(0),n(6),n(2))},function(e,t){e.exports='<div id=bucket-selector class=bucket-selector clickoutside on-click-outside=closeDropDown> <table id=current-displayed-table class="awsui-select-target current-displayed bucket-not-selected" ng-class="{\'with-bucket-name\' : !showBucketNameOnly, \'deselect\' : enableDeselect && copySettingsSourceBucket && copySettingsSourceBucket.Name, \'bucket-selected\' : !bucketReplication && !selectedReport && copySettingsSourceBucket || (bucketReplication || selectedReport ) && copySettingsSourceBucket && copySettingsSourceBucket.Name, \'bucket-not-selected-card\' : editable && !selectedReport.bucketError, \'bucket-not-selected-card-error\' : editable && selectedReport.bucketError}" ng-click=toggleDropDown()> <tr class=current-displayed-row> <td ng-if="!bucketReplication && copySettingsSourceBucket.Name && !showBucketNameOnly" class="awsui-icon bucket bucket-icon"></td> <td class=current-displayed-item> <div class="current-displayed-item truncate" ng-class="{\'bucket-name-display\' : !showBucketNameOnly }">{{ copySettingsSourceBucket.Name || (bucketList.length === 0 && emptyText) || getBucketPlaceHolder() }}</div> <table id=selected-bucket ng-if="copySettingsSourceBucket && !showBucketNameOnly" class=current-displayed-summary> <tr> <td class=current-displayed-summary-item><span translate=bucketselector.summary.label.region></span><span> {{copySettingsSourceBucket.Location}}</span></td> <td class=current-displayed-summary-item ng-if=copySettingsSourceBucket.granteeCount>{{copySettingsSourceBucket.granteeCount}} <span translate=bucketselector.summary.label.grantees></span></td> <td class=current-displayed-summary-item ng-if=copySettingsSourceBucket.propertyCount>{{copySettingsSourceBucket.propertyCount}} <span translate=bucketselector.summary.label.properties></span></td> </tr> </table> </td> <td ng-if=!copySettingsSourceBucket class=bucket-count> <div ng-if=!showBucketNameOnly> <span translate=bucketselector.label.buckets translate-values="{ bucketCount: bucketList.length || 0 }"></span> </div> </td> <td ng-if="enableDeselect && copySettingsSourceBucket && copySettingsSourceBucket.Name" ng-click=deselectBucket()> <div class="bucketdeselect bucketselector-cancel-icon"></div> </td> </tr> </table> <div class=list-items ng-if=isOpen ng-class="{\'list-items-normal\' : !chooseAccounts, \'list-items-choose\': chooseAccounts}"> <div ng-if=chooseAccounts> <awsui-radio-group ng-model=account.outside> <table class=choose-accounts-table> <tbody> <tr> <td class=choose-account-button> <awsui-radio-button value=false> <span class=choose-accounts-text> {{\'bucketselector.inputfield.currentAccount\' | translate}} </span> </awsui-radio-button> </td> <td class=choose-account-button> <awsui-radio-button value=true id=cross-account-radiobutton> <span class=choose-accounts-text> {{\'bucketselector.inputfield.anotherAccount\' | translate}} </span> </awsui-radio-button> </td> </tr> </tbody> </table> </awsui-radio-group> </div> <table ng-if="!chooseAccounts || account.outside === \'false\'" id=search-box class=search-box> <tr> <td> <input id=bucket-name-search-box type=text class=input-field ng-model=tableFiltering.filter[filterColumn] ng-keydown=filterKeyDown($event) placeholder="{{ getSearchPlaceHolder() }}"/></td> <td><i class="awsui-icon search"></i></td> </tr> </table> <div ng-if="chooseAccounts && account.outside === \'true\'"> <table class=choose-bucket-other-account-table> <tbody> <tr ng-if=!bucketReplication> <td><span class=enter-another-bucket>{{\'bucketselector.inputfield.label.account\' | translate}}</span></td> </tr> <tr ng-if=bucketReplication> <td><span class=enter-another-bucket>{{\'bucketselector.inputfield.label.crraccount\' | translate}}</span></td> </tr> <tr> <td> <div class="input-text-field bucket-account-field"> <awsui-control-group validation-message={{tmpValues.accountIdError}}> <awsui-textfield class=test-css ng-model=tmpValues.accountId placeholder="{{\'bucketselector.inputfield.enterId.placeholder\' | translate}}"></awsui-textfield> </awsui-control-group> </div> </td> </tr> <tr> <td><span class=enter-another-bucket>{{\'bucketselector.inputfield.label.bucket\' | translate}}</span></td> </tr> <tr> <td> <div class="input-text-field bucket-name-field"> <awsui-control-group validation-message={{tmpValues.regionError}}> <awsui-textfield class=test-css ng-model=tmpValues.bucket placeholder="{{\'bucketselector.inputfield.bucketName.placeholder\' | translate}}"> </awsui-textfield> </awsui-control-group> </div> </td> </tr> <tr> <td> <awsui-button class=another-account-save text="{{ \'events.button.save\' | translate }}" variant=normal ng-click="!tmpValues.bucket || savePressed($event)" disabled=!tmpValues.bucket loading=savingBucket></awsui-button> </td> </tr> </tbody> </table> </div> <div class=bucketselector-divider ng-if="bucketReplication &&  account.outside === \'false\' && chooseAccounts"></div> <div ng-if="(!chooseAccounts || account.outside === \'false\') && bucketReplication" class="item create-new-item" ng-click=createNewBucket() translate=bucketselector.createnew> </div> <div ng-if="isLoadingBuckets &&  account.outside === \'false\' && chooseAccounts" class="awsui-spinner awsui-spinner-bigger awsui-spinner-light bucketselector-spinner"></div> <span ng-if="isLoadingBuckets &&  account.outside === \'false\' && chooseAccounts" class=loading-bucket-text translate=bucketselector.loadingbucket></span> <div id=select-bucket ng-if="!chooseAccounts || account.outside === \'false\'" class=item ng-class="{\'item-disabled\' : bucket.disabled}" ng-repeat="bucket in bucketList | filter:tableFiltering.filter" ng-click=selectBucket(bucket)> <table> <tr> <td class=arrow ng-click="toggleBucket($event, bucket)"><div ng-class="bucket.disabled? \'arrow-disabled\' : bucket.isExpanded ? \'arrow-down\' : \'arrow-right\'"></div></td> <td><div class=bucket-item>{{bucket.Name}}</div></td> </tr> <tr> <td></td> <td> <table class=bucket-summary> <tr> <td class=bucket-summary-item><span ng-if=!bucket.disabled translate=bucketselector.summary.label.region></span><span ng-if=bucket.disabled>{{\'disabled.region\' | translate}}:</span><span> {{bucket.Location}}</span></td> <td ng-if=bucket.granteeCount class=bucket-summary-item>{{bucket.granteeCount}} <span translate=bucketselector.summary.label.grantees></span></td> <td ng-if=bucket.propertyCount class=bucket-summary-item>{{bucket.propertyCount}} <span translate=bucketselector.summary.label.properties></span></td> </tr> </table> </td> </tr> </table> <div class=bucket-content ng-if=bucket.isExpanded> <p class=bucket-content-title translate=createbucketmodal.label.permissions></p> <p class=bucket-content-column-header translate=createbucketmodal.label.object></p> <table class=bucket-summary> <tr> <td class=bucket-content-value translate=bucketselector.content.label.read></td> <td class=bucket-content-value>{{bucket.permissionCount.READ}} <span translate=bucketselector.summary.label.grantees></span></td> </tr> <tr> <td class=bucket-content-value translate=bucketselector.content.label.write></td> <td class=bucket-content-value>{{bucket.permissionCount.WRITE}} <span translate=bucketselector.summary.label.grantees></span></td> </tr> </table> <p class=bucket-content-column-header translate=bucketselector.content.label.permissionaccess></p> <table class=bucket-summary> <tr> <td class=bucket-content-value translate=bucketselector.content.label.read></td> <td class=bucket-content-value>{{bucket.permissionCount.READ_ACP}} <span translate=bucketselector.summary.label.grantees></span></td> </tr> <tr> <td class=bucket-content-value translate=bucketselector.content.label.write></td> <td class=bucket-content-value>{{bucket.permissionCount.WRITE_ACP}} <span translate=bucketselector.summary.label.grantees></span></td> </tr> </table> <div class=bucket-content-divider></div> <p class=bucket-content-title translate=bucketselector.summary.label.properties></p> <table class=bucket-summary> <tr> <td class=bucket-content-column-header translate=bucketselector.content.label.versioning></td> <td class=bucket-content-column-header translate=bucketselector.content.label.tags></td> <td class=bucket-content-column-header translate=bucketselector.content.label.logging></td> </tr> <tr> <td class=bucket-content-value>{{bucket.versioningStatus}}</td> <td class=bucket-content-value>{{bucket.tagCount}} <span translate=bucketselector.content.label.tags></span></td> <td class=bucket-content-value>{{bucket.loggingStatus}}</td> </tr> </table> </div> </div> <div class=no-matches-found ng-if="((bucketList | filter:tableFiltering.filter).length == 0)">{{getResultsMessage()}}</div> </div> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("operationManager",["$window",function(e){return{restrict:"AE",scope:{selectedTab:"="},template:n(560),controller:"ProgressbarController",link:function(e,n){var r=n.parent(),i=function(){var e=t.get(document.getElementById("f"),"offsetHeight",0);n.find(".progress-bar-footer").css("bottom",e+"px"),n.find(".progress-bar-footer").width(r.width())};r.resize(i),i(),e.$on("$destroy",function(){r.removeResize(i)})}}}]),e.module("s3").controller("ProgressbarController",["$filter","$scope","$translate","OperationDispatcherService","$window","SCLogService","S3Constants",function(e,t,n,r,i,a,o){t.isExpanded=!1,t.thresholdPercentage=o.OPERATION.THRESHOLD_PERCENTAGE,t.deleteBucketOperation=o.OPERATION_NAME.DELETE_BUCKET,t.isActiveUploadOperation=function(e){return e.name===o.OPERATION_NAME.UPLOAD&&e.state===o.OPERATION_STATE.ACTIVE},t.$watch(function(e){return e.isExpanded&&e.showingOperations===e.allOperations.ongoingOperations&&e.totalOngoingOperations.length>0},function(e){t.isExpanded=e}),t.modalOpen={flag:!1},t.detailOperation=null,t.allOperations={ongoingOperations:t.totalOngoingOperations,completedOperations:t.completedOperations,incompleteOperations:t.incompleteOperations},t.$watch(function(e){return e.allOperations.ongoingOperations=e.totalOngoingOperations,e.allOperations.completedOperations=e.completedOperations,e.allOperations.incompleteOperations=e.incompleteOperations,e.allOperations},function(e){t.allOperations=e}),t.showingOperations=t.allOperations.ongoingOperations,t.totalOperationCount=Object.keys(r.getAllOperations()).length,t.$watch(function(){return Object.keys(r.getAllOperations()).length},function(e){t.totalOperationCount=e}),t.incompleteOperations=[],t.$watch(function(e){e.incompleteOperations.length=0,r.getOperationsWithState(o.OPERATION_STATE.ERROR,e.incompleteOperations);var t=[];return r.getOperationsWithState(o.OPERATION_STATE.CANCEL,t),t.forEach(function(t){e.incompleteOperations.push(t)}),e.incompleteOperations},function(e){t.incompleteOperations=e}),t.completedOperations=[],t.$watch(function(e){return e.completedOperations.length=0,r.getOperationsWithState(o.OPERATION_STATE.COMPLETED,e.completedOperations),e.completedOperations},function(e){t.completedOperations=e}),t.waitingOperations=r.getWaitingOperations(),t.ongoingOperations=r.getOngoingOperations(),t.totalOngoingOperations=[];var s=0;t.$watch(function(e){s=e.totalOngoingOperations.length,e.totalOngoingOperations.length===Object.keys(e.ongoingOperations).length+e.waitingOperations.length?e.totalOngoingOperations.length=0:e.totalOngoingOperations=[];for(var t in e.ongoingOperations)e.totalOngoingOperations.push(e.ongoingOperations[t]);return e.waitingOperations.forEach(function(t){e.totalOngoingOperations.push(t)}),e.totalOngoingOperations},function(e){s<e.length?t.expandOrCollapseOperations(t.totalOngoingOperations,!0,"ongoingOperations"):0!==s&&0===e.length&&(t.operationState.ongoingOperations=!1),t.totalOngoingOperations=e}),t.expandOrCollapseOperations=function(e,n,r){var i=t.showingOperations!==e;if(t.operationState={ongoingOperations:!1,completedOperations:!1,incompleteOperations:!1},t.operationState[r]=!t.isExpanded&&n,t.showingOperations=e,0===t.showingOperations.length)return void(t.isExpanded=!1);t.isExpanded=i&&t.showingOperations.length>0||!t.isExpanded},t.openModal=function(e){t.modalOpen.flag=!0,t.detailOperation=e},t.cancelOperation=function(e){e.state===o.OPERATION_STATE.ACTIVE?i.confirm(n.instant("operation.warning.cancel"))&&(a.log(o.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR,1,e),r.cancelOperation(e)):r.cancelOperation(e),e===t.detailOperation&&(t.modalOpen.flag=!1,t.detailOperation=null)},t.cancelFromDetailView=function(e){e.state===o.OPERATION_STATE.ACTIVE?i.confirm(n.instant("operation.warning.cancel"))&&(a.log(o.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL,1,e),r.cancelOperation(e),t.modalOpen.flag=!1):t.modalOpen.flag=!1},t.closeDetailView=function(){t.modalOpen.flag=!1,t.detailOperation=null},t.getIconForOperation=function(e){switch(e){case o.OPERATION_NAME.MAKE_PUBLIC:case o.OPERATION_NAME.CHANGE_STORAGE_CLASS:case o.OPERATION_NAME.CHANGE_METADATA:case o.OPERATION_NAME.INITIATE_RESTORE:return"cog";case o.OPERATION_NAME.CHANGE_SSE:return"key";case o.OPERATION_NAME.DELETE_OBJECTS:case o.OPERATION_NAME.RESTORE_OBJECTS:case o.OPERATION_NAME.DELETE_BUCKET:case o.OPERATION_NAME.EMPTY_BUCKET:return"trash-o";case o.OPERATION_NAME.UPLOAD:return"upload";case o.OPERATION_NAME.COPY:case o.OPERATION_NAME.CUT:case o.OPERATION_NAME.ADD_OBJECT_TAG:case o.OPERATION_NAME.RENAME:return"files-o"}}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports="<div ng-show=\" totalOperationCount > 0 \" class=progress-bar-footer ng-class=\"{ open: isExpanded }\"> <div ng-show=isExpanded class=progress-bar-session> <table> <tr class=progress-bar-operation ng-repeat=\"operation in showingOperations\"> <th class=progress-bar-icon-and-name> <div class=operation-name> {{operation.displayName}} <div class=upload-speed-report ng-if=isActiveUploadOperation(operation)> ({{operation.currentUploadSpeed}}/s)</div></div> <div class=operation-view-details> <awsui-button class=button-in-darkbg text=\"{{ 'operation.detail.view' | translate }}\" variant=link ng-click=openModal(operation)></awsui-button> </div> </th> <th class=progress-bar-real-progress-bar> <div class=\"operation-progress-bar {{ operation.state }}-fill\"> <div ng-if=\"operation.displayName !== deleteBucketOperation && !operation.successPercentage && !operation.errorPercentage\" class=operation-percentage-text translate>operation.progress.started</div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.parameters.isCountingObjectsInProgress === true && operation.parameters.isDeleteBucketInProgress === true\" class=current-progress-fill ng-style=\"{width: operation.progressPercentage + '%'}\"> <span class=operation-percentage-text>{{ \"operation.detail.countingobjects\" | translate }}</span> </div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.successPercentage !== 0 && operation.parameters.isCountingObjectsInProgress === false && operation.parameters.isDeleteBucketInProgress === true\" class=current-progress-fill ng-style=\"{width: operation.successPercentage + '%'}\"> <span ng-if=\"(operation.errorPercentage !== 0 && operation.successPercentage >= thresholdPercentage) || operation.errorPercentage === 0\" class=operation-percentage-text>{{operation.successPercentage}}% {{'operation.detail.successful' | translate}}</span> </div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.errorPercentage !== 0 && operation.parameters.isCountingObjectsInProgress === false && operation.parameters.isDeleteBucketInProgress === true\" class=current-error-fill ng-style=\"{width: operation.errorPercentage + '%'}\"> <span class=operation-percentage-text>{{operation.errorPercentage}}% {{'operation.detail.failed' | translate}}</span> </div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.parameters.isDeleteBucketSuccessful === undefined && operation.parameters.isDeleteBucketInProgress === false\" class=current-error-fill style=width:100%> <span class=operation-percentage-text>{{'operation.detail.opertationfailed' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deleteobjects' | translate}} {{operation.successPercentage}}% {{'operation.detail.successful' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deletebucket' | translate}} {{'operation.detail.notattempted' | translate}} </span> </div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.parameters.isDeleteBucketSuccessful === false && operation.parameters.isDeleteBucketInProgress === false\" class=current-error-fill style=width:100%> <span class=operation-percentage-text>{{'operation.detail.opertationfailed' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deleteobjects' | translate}} {{operation.successPercentage}}% {{'operation.detail.successful' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deletebucket' | translate}} {{'operation.detail.failed' | translate}} </span> </div> <div ng-if=\"operation.displayName === deleteBucketOperation && operation.parameters.isDeleteBucketSuccessful && operation.parameters.isDeleteBucketInProgress === false\" class=current-progress-fill style=width:100%> <span class=operation-percentage-text>{{'operation.detail.operationsuccessful' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deleteobjects' | translate}} {{operation.successPercentage}}% {{'operation.detail.successful' | translate}}</span> <span class=operation-percentage-text>{{'operationname.deletebucket' | translate}} {{'operation.detail.successful' | translate}} </span> </div> <div ng-if=\"operation.displayName !== deleteBucketOperation && operation.successPercentage !== 0\" class=current-progress-fill ng-style=\"{width: operation.successPercentage + '%'}\"> <span ng-if=\"(operation.errorPercentage !== 0 && operation.successPercentage >= thresholdPercentage) || operation.errorPercentage === 0\" class=operation-percentage-text>{{operation.successPercentage}}% {{'operation.detail.successful' | translate}}</span> </div> <div ng-if=\"operation.displayName !== deleteBucketOperation && operation.errorPercentage !== 0\" class=current-error-fill ng-style=\"{width: operation.errorPercentage + '%'}\"> <span class=operation-percentage-text>{{operation.errorPercentage}}% {{'operation.detail.failed' | translate}}</span> </div> <translate class=file-in-progress ng-if=\"operation.fileInProgress && (operation.errorPercentage + operation.successPercentage) < 100\" translate-values=\"{fileName: operation.fileInProgress}\">operation.tab.uploadingfile</translate> </div> </th> <th class=progress-bar-cancel-icon> <span class=\"operation-cancel-button blue-cancel-icon\" ng-click=cancelOperation(operation)></span> </th> <div class=awsui-util-clearfix></div> </tr> </table> </div> <div class=operation-summary> <div class=total-operations> {{ 'operation.tab.totalOperations' | translate }} </div> <div class=in-progress-expander ng-class=\"{ 'cursorpointer' : hoverOnInprogress &&  totalOngoingOperations.length > 0 || operationState.ongoingOperations,\n        'cursornomal' : hoverOnInprogress &&  totalOngoingOperations.length === 0,\n        'deselectprogresstab': !operationState.ongoingOperations && totalOngoingOperations.length > 0}\" ng-mouseenter=\"hoverOnInprogress = true\" ng-mouseleave=\"hoverOnInprogress = false\" ng-click=\"expandOrCollapseOperations(allOperations.ongoingOperations, totalOngoingOperations.length !== 0, 'ongoingOperations')\"> {{ totalOngoingOperations.length }} {{ 'operation.tab.inProgress' | translate }} </div> <div class=completed-expander ng-class=\"{ 'cursorpointer' : hoverOnComplete &&  completedOperations.length > 0 || operationState.completedOperations,\n        'cursornomal' : hoverOnComplete &&  completedOperations.length === 0,\n        'deselectprogresstab': !operationState.completedOperations && completedOperations.length > 0 }\" ng-mouseenter=\"hoverOnComplete = true\" ng-mouseleave=\"hoverOnComplete = false\" ng-click=\"expandOrCollapseOperations(allOperations.completedOperations, completedOperations.length !== 0, 'completedOperations')\"> {{ completedOperations.length}} {{ 'operation.tab.success' | translate }} </div> <div class=error-expander ng-class=\"{ 'cursorpointer' : hoverOnError &&  incompleteOperations.length > 0 || operationState.incompleteOperations,\n        'cursornomal' : hoverOnError &&  incompleteOperations.length === 0,\n        'deselectprogresstab': !operationState.incompleteOperations && incompleteOperations.length > 0}\" ng-mouseenter=\"hoverOnError = true\" ng-mouseleave=\"hoverOnError = false\" ng-click=\"expandOrCollapseOperations(allOperations.incompleteOperations, incompleteOperations.length !== 0, 'incompleteOperations')\"> {{ incompleteOperations.length }} {{ 'operation.tab.error' | translate }} </div> </div> </div> <detail-progress is-open=modalOpen target-operation=detailOperation cancel-operation-function=cancelFromDetailView close-callback=closeDetailView></detail-progress> "},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").directive("detailProgress",[function(){return{restrict:"AE",template:n(562),scope:{isOpen:"=",targetOperation:"=",closeCallback:"=?",cancelOperationFunction:"=?"},controller:"detailProgressController"}}]),e.module("s3").controller("detailProgressController",["$scope","UtilService","S3Constants","$translate",function(e,n,i,a){var o,s=(o={},r(o,i.OPERATION_STATE.ACTIVE,a.instant("operation.tab.inProgress")),r(o,i.OPERATION_STATE.WAITING,a.instant("operation.progress.waiting")),r(o,i.OPERATION_STATE.CANCEL,a.instant("operation.progress.canceled")),r(o,i.OPERATION_STATE.COMPLETED,a.instant("operation.progress.complete")),o);e.deleteBucketOperationName=i.OPERATION_NAME.DELETE_BUCKET,e.isUploadOperation=function(){return t.get(e.targetOperation,"name")===i.OPERATION_NAME.UPLOAD},e.isActiveOperation=function(){return t.get(e.targetOperation,"state")===i.OPERATION_STATE.ACTIVE},e.getFileIconClass=function(e){return n.getIconClassFromFilename(e)},e.getOperationStatus=function(){var n=t.get(e.targetOperation,"state");return void 0===s[n]?s[i.OPERATION_STATE.COMPLETED]:s[n]},e.isCountingObjectsInProgress=function(){return t.get(e.targetOperation,"parameters.isCountingObjectsInProgress",!1)}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<modal class=detail-progress is-open=isOpen header-title=targetOperation.displayName close-callback=closeCallback> <modal-header> <div class=detail-progress-header> <span class="operation-water-mark operation-water-mark-image"></span> <div class=operation-modal-title>{{ targetOperation.displayName }} <span ng-if="isActiveOperation() && isUploadOperation()">({{ targetOperation.currentUploadSpeed }}/s)</span></div> <div class=operation-modal-percentage>{{ getOperationStatus() }}</div> <div class=detail-progress-overall-progress> <div class=detail-progress-bar></div> <div class=detail-progress-bar-fill></div> </div> </div> </modal-header> <modal-content> <div class=operation-info> <div class="source-info truncate"> <span class=info-text translate=operation.detail.sourcepath></span> <a href={{targetOperation.operationInitialLocationUrl}}>{{ targetOperation.operationPath }}</a> </div> <div class="target-info truncate" ng-if=targetOperation.dstBucket> <span class=info-text translate=operation.detail.targetpath></span> <a href={{targetOperation.operationDestinationUrl}}>{{ targetOperation.operationDestinationPath }}</a> </div> </div> <div class=detail-progress-content> <table class=detail-progress-overall-table> <tr> <td class=total-count-line> <span ng-if="targetOperation.parameters.operationSuccessful || targetOperation.parameters.operationUnsuccessful || targetOperation.parameters.operationPartiallySuccessful" class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.operationSuccessful, \'alert-exclamation-circle\': targetOperation.parameters.operationUnsuccessful, \'alert-exclamation-triangle\': targetOperation.parameters.operationPartiallySuccessful}"></span> <div class="detail-progress-text total-count" translate>{{ isUploadOperation() ? "operation.detail.totalfiles" : (isCountingObjectsInProgress() ? "operation.detail.countingobjects" : "operation.detail.totalObjects") }}</div> </td> <td> <div class="detail-progress-text total-objects-count">{{ isCountingObjectsInProgress() ? targetOperation.keyCount : targetOperation.totalObjectCount }}</div> </td> </tr> <tr> <td class=success-count-line> <div class="detail-progress-text total-successful" translate>operation.detail.successful</div> </td> <td class=total-success-count-percentage> <div class="detail-progress-text total-successful-count">{{ targetOperation.succeedKeyCount }} ({{ targetOperation.successPercentage }}%)</div> </td> </tr> <tr ng-repeat="errorType in targetOperation.errorTypes"> <td class=error-files-list-expander> <i class="awsui-icon alert-exclamation-circle hidden"></i> <awsui-expandable-section class="expander dark" header={{errorType.errorMessage}} expanded=false> <table class=files-list-table> <tr class=file-role ng-repeat="errorKey in targetOperation.errorDetails[errorType.errorMessage]"> <td class=file-icon> <span class="awsui-icon awsui-icon-light" ng-class=getFileIconClass(errorKey)></span> </td> <td class=object-detail> <div class=object-name>{{ errorKey }}</div> <div class=object-info>/{{ targetOperation.initialBucket }}/{{ targetOperation.initialPath }}</div> </td> <td class=error-icon><i class="awsui-icon alert-exclamation-circle"></i></td> </tr> </table> </awsui-expandable-section> </td> <td class=error-count-percentage> <div class="detail-progress-text total-successful-count">{{ errorType.errorCount }} ({{ targetOperation.errorPercentage }}%)</div> </td> </tr> <tr ng-if="targetOperation.name === deleteBucketOperationName"> <td ng-if="targetOperation.parameters.isDeleteBucketInProgress === false"> <span class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.isDeleteBucketSuccessful, \'alert-exclamation-circle\': !targetOperation.parameters.isDeleteBucketSuccessful }"></span> <div class="detail-progress-text total-count" translate>operation.detail.bucketDeletion</div> </td> <td ng-if=targetOperation.parameters.isDeleteBucketSuccessful><div class="detail-progress-text deletion-status" translate>operation.detail.successful</div></td> <td ng-if="!targetOperation.parameters.isDeleteBucketSuccessful && targetOperation.parameters.isDeleteBucketInProgress === false"><div class="detail-progress-text deletion-status" translate>operation.detail.failed</div></td> </tr> <tr ng-if="targetOperation.name === deleteBucketOperationName"> <td> <span class="detail-progress-text delete-bucket-error-message"> {{ targetOperation.errorMessage }} </span> </td> </tr> </table> </div> </modal-content> <modal-footer> <div class=detail-progress-footer> <div class=cancel-operation-button ng-click=cancelOperationFunction(targetOperation)> <div class=cancel-operation-button-text translate>{{ isActiveOperation() ? "operation.detail.cancel" : "operation.detail.close" }}</div> </div> </div> </modal-footer> </modal> '},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d){function p(){document.getElementById(l.BUCKET_PROPERTIES.VERSIONING.CREATE_BUCKET_CARD).scrollIntoView()}function f(){n.cardSummaryObj.isActive=n.versioning.selectedValue===n.versioningStates.enable}function g(e){n.versioning.selectedValue===h&&n.cachedVersioning.selectedValue===b?n.versioningWarningMsg=e?i.instant("bucketversioning.enablewarning"):null:n.versioning.selectedValue===b&&n.cachedVersioning.selectedValue===h?n.versioningWarningMsg=e?i.instant("bucketversioning.disablewarning"):null:n.versioningWarningMsg=null}function m(){var e=new s(l.LIFECYCLE.BUCKET_LIFECYCLE);e.step=l.LIFECYCLE.GET_BUCKET_LIFECYCLE,o.getBucketLifecycle(c.getCurrentBucket(),e).then(function(){g(!0)}).catch(function(){g(!1)})}n.docLink=a.getDocUrl(l.LEARN_MORE_LINKS.VERSIONING),n.versioningError=!1,n.versioningStates={enable:"enable",disable:"disable"};var h="enable",b="disable",v=new s("BucketVersioning","getVersioning");n.cardSummaryObj=t.cloneDeep(l.CARD_SUMMARY_INIT),n.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperty.disabled"),n.cardSummaryObj.activeSummary.text=i.instant("bucketproperty.enabled"),n.getBucketVersioning=function(){n.cardSummaryObj.isLoading=!0;var t=c.getCurrentBucket();o.getBucketVersioning(t,v).then(function(t){n.versioningError=!1,n.versioning.selectedValue="Enabled"===t?e.copy(n.versioningStates.enable):e.copy(n.versioningStates.disable),n.cachedVersioning=e.copy(n.versioning),f()}).catch(function(t){n.versioningError=!0,n.versioningErrorMessage=t,n.cachedVersioning=e.copy(n.versioning)}).finally(function(){n.cardSummaryObj.isLoading=!1})},n.updateWarningMsg=function(){m()},n.forCreateBucketModal?(n.$watch("cardOpen",function(e,t){e&&r(p,1)}),!t.isEmpty(n.versioning)&&n.versioning.errorMessage&&(n.versioningError=!0,n.versioningErrorMessage=n.versioning.errorMessage),n.cachedVersioning=e.copy(n.versioning),f()):(n.scrollCardId="#"+n.id,n.getBucketVersioning()),n.cancelBucketVersioning=function(t){d.analyticsTrackClick(l.ANALYTICS.CANCEL_VERSIONING,l.ANALYTICS.DETAILS),t.stopPropagation(),n.versioning=e.copy(n.cachedVersioning),n.versioningError=!1,n.versioningErrorMessage="",n.cardOpen=!1,n.versioningWarningMsg=null},n.saveBucketVersioning=function(t){d.analyticsTrackClick(l.ANALYTICS.SAVE_VERSIONING,l.ANALYTICS.DETAILS),t.stopPropagation(),n.versioningError=!1,n.versioningErrorMessage="";var r,i=null;if(n.forCreateBucketModal)n.cachedVersioning=e.copy(n.versioning),n.cardOpen=!1,f();else{var a=c.getCurrentBucket();n.versioning.selectedValue===n.versioningStates.enable?(r=o.enableBucketVersioning,i=new s("enableBucketVersioning")):(r=o.disableBucketVersioning,i=new s("disableBucketVersioning")),r(a,i).then(function(){n.cachedVersioning.selectedValue=e.copy(n.versioning.selectedValue),n.cardOpen=!1,n.versioningWarningMsg=null,f()}).catch(function(e){n.versioningError=!0,n.versioningErrorMessage=e})}}}e.module("s3").directive("bucketVersioning",[function(){return{restrict:"E",scope:{cardOpen:"=",versioning:"=",forCreateBucketModal:"=?",id:"@?"},template:n(564),controller:"BucketVersioningController"}}]),e.module("s3").controller("BucketVersioningController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-version-water-mark\': !cardOpen, \'card-enable-version-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.versioning.label.versioning></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelBucketVersioning($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.versioning.summary></p> <div class=awsui-container ng-if=cardOpen> <awsui-radio-group ng-model=versioning.selectedValue change=updateWarningMsg()> <div class="awsui-row card-content-row"> <awsui-radio-button class=enableVersioning value=enable ng-model=versioning.selectedValue label="{{ \'bucketproperties.versioning.label.enableversioning\' | translate }}"></awsui-radio-button> </div> <awsui-alert class=bucketversion-warning visible="versioning.selectedValue === \'enable\' && versioningWarningMsg " type=warning>{{versioningWarningMsg}}</awsui-alert> <div class="awsui-row card-content-row"> <awsui-radio-button class=disableVersioning value=disable ng-model=versioning.selectedValue label="{{ \'bucketproperties.versioning.label.disableversioning\' | translate }}"> </awsui-radio-button> <p class=disable-versioning-description translate=bucketproperties.versioning.description.disableversioning></p> <awsui-alert class=bucketversion-warning visible="versioning.selectedValue === \'disable\' && versioningWarningMsg " type=warning>{{versioningWarningMsg}}</awsui-alert> </div> </awsui-radio-group> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert type=error class=error-alert ng-if="versioningError && cardOpen"> {{ versioningErrorMessage }}</awsui-alert> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button id=cancel-bucket-versioning ng-click=cancelBucketVersioning($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-versioning ng-click=saveBucketVersioning($event) text="{{ \'button.save\' | translate }}" variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p,f,g){function m(){n.cardSummaryObj.isActive=n.tagCount>0,n.tagCount>0?n.cardSummaryObj.activeSummary.text=i.instant("bucketproperties.tagging.summarylabel",{count:n.tagCount}):n.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperties.tagging.summarylabel",{count:0})}function h(){document.getElementById(d.BUCKET_PROPERTIES.TAGGING.CREATE_BUCKET_CARD).scrollIntoView()}n.docLink=o.getDocUrl(d.LEARN_MORE_LINKS.TAGGING),n.tagError=!1,n.tagErrorMessage="",n.cachedBucketTags={tags:[]},n.tagCount=0,n.cardSummaryObj=t.cloneDeep(d.CARD_SUMMARY_INIT),n.cancelBucketTagging=function(t){f.analyticsTrackClick(d.ANALYTICS.CANCEL_TAGGING,d.ANALYTICS.DETAILS),t.stopPropagation(),n.bucketTags.tags=e.copy(n.cachedBucketTags.tags),n.tagError=!1,n.tagErrorMessage="",n.cardOpen=!1},n.removeTag=function(e){n.bucketTags.tags.splice(e,1)},n.addTag=function(){n.bucketTags.tags.push({Key:"",Value:""})};var b=new l("BucketTagging","getTagging");n.getBucketTags=function(){n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),n.cardSummaryObj.isLoading=!0,p.log("getBucketTaggingReceived",1,b,{bucketName:u.getCurrentBucket()}),a.getBucketProperty(b,u.getCurrentBucket(),"tagging").then(function(t){var r=t.response;if(p.logRequestComplete("getBucketTagging",b),n.tagError=!1,r){var i=g.convertXmlStringToJson(r);i.Tagging&&(c.populateTagsFields(i,n.bucketTags.tags),n.tagCount=i.Tagging.TagSet.Tag.length||1)}n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),m()}).catch(function(t){var r=f.handleErrors(t);t!==d.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE?(p.log("getBucketTagging",0,b,{bucketName:u.getCurrentBucket(),error:t}),n.tagError=!0,n.tagErrorMessage=r):p.logRequestComplete("getBucketTagging",b),n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),m()}).finally(function(){n.cardSummaryObj.isLoading=!1})},n.forCreateBucketModal?(n.$watch("cardOpen",function(e,t){e&&r(h,1)}),!t.isEmpty(n.bucketTags.tags)&&n.bucketTags.errorMessage&&(n.tagError=!0,n.tagErrorMessage=n.bucketTags.errorMessage),n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),n.tagCount=n.bucketTags&&n.bucketTags.tags.length?n.bucketTags.tags.length:0,m()):(n.scrollCardId="#"+n.id,n.getBucketTags()),n.saveBucketTagging=function(t){if(f.analyticsTrackClick(d.ANALYTICS.SAVE_TAGGING,d.ANALYTICS.DETAILS),t.stopPropagation(),n.tagError=!1,n.tagErrorMessage="",n.forCreateBucketModal)n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),n.tagCount=n.bucketTags.tags.length,n.cardOpen=!1,m();else{var r=u.getCurrentBucket(),i=n.bucketTags.tags,a=void 0,o=null;i.length>0?(a=s.putBucketTagging,o=new l("putBucketTagging")):(a=s.deleteBucketTagging,o=new l("deleteBucketTagging")),a(r,i,o).then(function(){n.tagCount=n.bucketTags.tags.length,n.cardOpen=!1,n.cachedBucketTags.tags=e.copy(n.bucketTags.tags),m()}).catch(function(e){n.tagError=!0,n.tagErrorMessage=e})}}}e.module("s3").directive("bucketTagging",[function(){return{restrict:"E",scope:{cardOpen:"=",bucketTags:"=",forCreateBucketModal:"=?",id:"@?"},template:n(566),controller:"BucketTaggingController"}}]),e.module("s3").controller("BucketTaggingController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.tagging.label.tags></span> <div class=card-close-icon ng-show=cardOpen ng-click=cancelBucketTagging($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-show=!cardOpen translate=bucketproperties.tagging.summary></p> <table class=tagging-table ng-if=cardOpen> <tr> <th> <translate>bucketproperties.tagging.label.key</translate> <awsui-tooltip text="{{\'bucketproperties.tagging.key.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th> <translate>bucketproperties.tagging.label.value</translate> <awsui-tooltip text="{{\'bucketproperties.tagging.value.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th></th> </tr> <tr ng-repeat="tag in bucketTags.tags"> <td><input type=text ng-model=tag.Key class=tag-input></td> <td><input type=text ng-model=tag.Value class=tag-input></td> <td> <awsui-button class=remove-tag icon=times-circle variant=standalone-icon ng-click=removeTag($index)></awsui-button> </td> </tr> <tr> <td><awsui-button id=add-bucket-tag ng-click=addTag() class=bucket-properties-buttons text="{{\'bucketproperties.tagging.label.addtag\' | translate}}" icon=plus></awsui-button></td> <td></td> <td></td> </tr> </table> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert type=error class=error-alert readonly=readonly ng-show="tagError && cardOpen">{{ tagErrorMessage }}</awsui-alert> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button id=cancel-bucket-tagging class=bucket-properties-buttons ng-click=cancelBucketTagging($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-tagging class=bucket-properties-buttons ng-click=saveBucketTagging($event) text="{{ \'button.save\' | translate }}" variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l,u,d,p,f){function g(){var n=e.objectRetentionInitial,r=e.objectRetention;return!t.isEqual(r.defaultRetention,n.defaultRetention)}function m(){var t=e.objectRetention.defaultRetention.days;e.daysInputValidationErrors=[],(!/^ *\d+ *$/.test(t)||parseInt(t)<=0)&&e.daysInputValidationErrors.push("bucketproperties.objectretention.validation.days")}function h(){var n=d.getCurrentBucket();e.cardSummaryObj.isLoading=!0;var r=e.objectRetention.defaultRetention,a=r.mode,o=r.days;p.putBucketObjectLockConfiguration(b,n,a===e.MODE_NONE?void 0:{mode:a,days:o}).then(function(){e.cardSummaryObj.isLoading=!0,e.objectRetentionInitial=t.cloneDeep(e.objectRetention),e.cardOpen=!1,e.displayAlert({header:i.instant("bucketproperties.objectretention.alert.configurationupdated.text"),type:"success"})}).catch(function(t){e.displayAlert({header:i.instant(t.text),type:"error"})}).finally(function(){e.cardSummaryObj.isLoading=!1})}e.docLink=a.getDocUrl(c.LEARN_MORE_LINKS.OBJECT_RETENTION),e.customerSupportLink=a.getMarketingUrl(c.CUSTOMER_SUPPORT),e.MODE_NONE=c.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.NONE,e.cardError={visible:!1,text:"",code:""},e.disableSaveButton=!1,e.confirmComplianceModal={title:i.instant("bucketproperties.objectretention.confirmcompliance.modaltitle"),label:"bucketproperties.objectretention.confirmcompliance.input.label"},e.confirmGovernanceModal={title:i.instant("bucketproperties.objectretention.confirmgovernance.modaltitle"),label:"bucketproperties.objectretention.confirmgovernance.input.label"},e.confirmComplianceAlert={title:"",text:i.instant("bucketproperties.objectretention.confirmcompliance.alert.text")},e.confirmGovernanceAlert={title:"",text:i.instant("bucketproperties.objectretention.confirmgovernance.alert.text")},e.objectRetention={},e.objectRetentionInitial={retentionEnabled:!1,defaultRetention:{mode:e.MODE_NONE,days:0}},e.retentionModeList=[{value:c.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.GOVERNANCE,title:"bucketproperties.objectretention.card.modes.gov.title",text:"bucketproperties.objectretention.card.modes.gov.text"},{value:c.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.COMPLIANCE,title:"bucketproperties.objectretention.card.modes.comp.title",text:"bucketproperties.objectretention.card.modes.comp.text"},{value:e.MODE_NONE,title:"bucketproperties.objectretention.card.modes.none.title"}],e.daysInputValidationErrors=[];var b=new s("BucketObjectRetention","getObjectRetention");e.cardSummaryObj=t.cloneDeep(c.CARD_SUMMARY_INIT),e.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperty.disabled"),e.cardSummaryObj.activeSummary.text=i.instant("bucketproperty.pemanentlyenabled"),e.confirmationComplianceModalOpen={flag:!1},e.confirmationGovernanceModalOpen={flag:!1},e.cancel=function(n){u.analyticsTrackClick(c.ANALYTICS.CANCEL_BUCKET_OBJECT_RETENTION,c.ANALYTICS.DETAILS),n.stopPropagation(),e.objectRetention=t.cloneDeep(e.objectRetentionInitial),e.error=!1,e.errorMessage="",e.cardOpen=!1},e.save=function(){if(u.analyticsTrackClick(c.ANALYTICS.SAVE_BUCKET_OBJECT_RETENTION,c.ANALYTICS.DETAILS),e.objectRetention.defaultRetention.mode===c.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.COMPLIANCE){var t=u.getDaysString(e.objectRetention.defaultRetention.days);e.confirmComplianceAlert.title=i.instant("bucketproperties.objectretention.confirmcompliance.alert.title",{daysString:t,days:r("number")(e.objectRetention.defaultRetention.days)}),e.toggleComplianceConfirmationModal(!0)}else if(e.objectRetention.defaultRetention.mode===c.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.GOVERNANCE){var t=u.getDaysString(e.objectRetention.defaultRetention.days);e.confirmGovernanceAlert.title=i.instant("bucketproperties.objectretention.confirmgovernance.alert.title",{daysString:t,days:r("number")(e.objectRetention.defaultRetention.days)}),e.toggleGovernanceConfirmationModal(!0)}else h()},e.complianceOnConfirm=function(){e.toggleComplianceConfirmationModal(!1),h()},e.complianceOnCancel=function(){e.toggleComplianceConfirmationModal(!1)},e.toggleComplianceConfirmationModal=function(t){e.confirmationComplianceModalOpen={flag:t}},e.governanceOnConfirm=function(){e.toggleGovernanceConfirmationModal(!1),h()},e.governanceOnCancel=function(){e.toggleGovernanceConfirmationModal(!1)},e.toggleGovernanceConfirmationModal=function(t){e.confirmationGovernanceModalOpen={flag:t}},e.formatDaysValue=function(){e.daysInputValidationErrors.length||(e.objectRetention.defaultRetention.days=String(parseInt(e.objectRetention.defaultRetention.days,10)))},e.updateForm=function(){e.objectRetention.defaultRetention.mode===e.MODE_NONE?e.daysInputValidationErrors=[]:m(),e.disableSaveButton=!g()||e.daysInputValidationErrors.length>0},e.scrollDays=function(t){var n=parseInt(e.objectRetention.defaultRetention.days,10)+t;isNaN(n)||(e.objectRetention.defaultRetention.days=String(n),e.updateForm())},f.isFeatureEnabled(c.FAC.OBJECT_RETENTION)&&function(){var n=d.getCurrentBucket();e.cardSummaryObj.isLoading=!0,e.cardError.visible=!1,p.getBucketObjectLockConfiguration(b,n).then(function(n){var r=t.get(n.defaultRetentionRule,"mode"),i=t.get(n.defaultRetentionRule,"days");e.objectRetentionInitial=Object.assign({},e.objectRetentionInitial,{retentionEnabled:n.bucketObjectRetentionEnabled,defaultRetention:{mode:r||e.MODE_NONE,days:i||"1"}}),e.objectRetention=t.cloneDeep(e.objectRetentionInitial),e.cardSummaryObj.isActive=e.objectRetention.retentionEnabled}).catch(function(t){e.cardError.visible=!0,e.cardError.text=i.instant(t.text),e.cardError.code=t.code,t.code===c.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.ACCESS_DENIED&&(e.cardSummaryObj.isActive=!0)}).finally(function(){e.cardSummaryObj.isLoading=!1})}()}e.module("s3").directive("bucketObjectRetentionCard",[function(){return{restrict:"E",scope:{cardOpen:"=",displayAlert:"&",id:"@?"},template:n(568),controller:"BucketObjectRetentionController"}}]),e.module("s3").controller("BucketObjectRetentionController",["$scope","$timeout","$filter","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","S3Constants","SCLogService","UtilService","PathService","SharpieAPI","FAC",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card class=bucket-object-retention-card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="[ cardOpen ? \'card-enable-shield-water-mark\' : \'card-disable-shield-water-mark\' ]"> <card-header> <span translate=bucketproperties.objectretention.label></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancel($event)></div> </card-header> <card-content> <div ng-if=!cardOpen> <p class=bucketproperties-summary translate=bucketproperties.objectretention.summary></p> <a class=learn-more-card-closed-link target=_blank href={{docLink}} translate>learn.more</a> </div> <div ng-if=cardOpen> <awsui-alert type=info class=info-alert ng-if="!objectRetention.retentionEnabled && !cardError.visible" header="{{ \'bucketproperties.objectretention.alert.onlyfornewbuckets.title\' | translate }}"> <span translate>bucketproperties.objectretention.alert.onlyfornewbuckets.text</span> <span> </span> <external-link href={{customerSupportLink}} text="{{ \'customer.support\' | translate | lowercase }}"></external-link> </awsui-alert> <awsui-alert type=warning visible=cardError.visible>{{ cardError.text }}</awsui-alert> <div ng-if=cardSummaryObj.isActive class="awsui-container text-dark"> <p> <span translate=bucketproperties.objectretention.card.activesummary></span> <span> </span> <learn-more-link href={{docLink}}></learn-more-link> </p> <div class=mb-4> <h5 translate=bucketproperties.objectretention.card.modes.title class=mb-4></h5> <awsui-radio-group ng-model=objectRetention.defaultRetention.mode ng-change=updateForm()> <awsui-radio-button ng-repeat="mode in retentionModeList" value={{mode.value}} data-e2e-id=retentionMode{{mode.value}}> <label class="awsui-radio-button-label pa-0 ma-0" translate>{{mode.title}}</label> <p class=mb-0 translate>{{mode.text}}</p> </awsui-radio-button> </awsui-radio-group> <h5 translate=bucketproperties.objectretention.card.period.title ng-hide="objectRetention.defaultRetention.mode === MODE_NONE"></h5> <div class="h-container align-items-center" ng-hide="objectRetention.defaultRetention.mode === MODE_NONE"> <awsui-control-group> <div dom-region=control> <awsui-textfield autocomplete=off data-disabled="objectRetention.defaultRetention.mode === MODE_NONE" class=input-width-shrink data-e2e-id=objectRetentionDaysInput ng-change=updateForm() blur=formatDaysValue() ng-model=objectRetention.defaultRetention.days on-keyboard-scroll=scrollDays(step)></awsui-textfield> <span class=ml-3 translate>bucketproperties.objectretention.card.period.label</span> </div> <span dom-region=validationMessage ng-if="daysInputValidationErrors.length > 0"> <label ng-repeat="message in daysInputValidationErrors">{{message | translate}}</label><br> </span> </awsui-control-group> </div> </div> </div> </div> </card-content> <card-footer> <div ng-if=cardOpen> <div class="bucket-properties-buttons h-container" ng-if=cardSummaryObj.isActive> <div class="bucket-status-display single-line pa-0 flex-expand"> <div class="icon card-enabled-icon"></div> <p class=card-status-text translate=bucketproperty.pemanentlyenabled></p> </div> <awsui-button id=cancel-object-retention ng-click=cancel($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-object-retention ng-click=save($event) text="{{ \'button.save\' | translate }}" variant=primary loading=cardSummaryObj.isLoading data-disabled=disableSaveButton></awsui-button> </div> <div class=object-properties-buttons ng-if=!cardSummaryObj.isActive> <awsui-button id=cancel-object-retention ng-click=cancel($event) text="{{ \'button.close\' | translate }}"></awsui-button> </div> </div> </card-footer> </card> <retention-confirmation-modal modal-title=confirmComplianceModal.title confirm-label=confirmComplianceModal.label is-open=confirmationComplianceModalOpen on-cancel=complianceOnCancel() on-confirm=complianceOnConfirm() alert=confirmComplianceAlert> </retention-confirmation-modal> <retention-confirmation-modal modal-title=confirmGovernanceModal.title confirm-label=confirmGovernanceModal.label is-open=confirmationGovernanceModalOpen on-cancel=governanceOnCancel() on-confirm=governanceOnConfirm() alert=confirmGovernanceAlert> </retention-confirmation-modal>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p,f){function g(){n.cardSummaryObj.isActive=n.logging.selectedValue===n.loggingState.enable}function m(e){n.loggingError=!0,n.loggingErrorMessage=e}function h(e,t){e.push({Grantee:{Type:d.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:d.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:t})}function b(){document.getElementById(d.BUCKET_PROPERTIES.LOGGING.CREATE_BUCKET_CARD).scrollIntoView()}function v(e,r,i){var a=arguments.length<=3||void 0===arguments[3]?null:arguments[3];t.isEmpty(a)?s.getBucketLocation(i).then(function(i){e.forEach(function(e){s.getBucketLocation(e.Name).then(function(a){i===a&&(r.push({value:e.Name,text:e.Name}),n.cachedLogging.targetBucketOptions=t.cloneDeep(r))})})}):(r.push({value:n.createBucketValues.name,text:n.createBucketValues.name}),n.cachedLogging.targetBucketOptions=t.cloneDeep(r),e.forEach(function(e){s.getBucketLocation(e.Name).then(function(i){a&&a.value===i&&(r.push({value:e.Name,text:e.Name}),e.Name===n.logging.targetBucket&&n.resetLoggingValue&&(n.resetLoggingValue=!1),n.cachedLogging.targetBucketOptions=t.cloneDeep(r))})}),n.createBucketValues.name===n.logging.targetBucket&&n.resetLoggingValue&&(n.resetLoggingValue=!1))}function E(e,r,i,a,o){o.step=d.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING,s.enableBucketLogging(e,r,i,a,o).then(function(){n.cachedLogging=t.cloneDeep(n.logging),g(),n.cardOpen=!1,n.saving=!1}).catch(function(e){m(e),n.saving=!1})}n.saving=!1,n.docLink=o.getDocUrl(d.LEARN_MORE_LINKS.LOGGING),n.cachedLogging={},n.logging.targetBucketOptions=[],n.loggingError=!1,n.resetLoggingValue=!0,n.loggingErrorMessage="",n.loggingState={enable:"enable",disable:"disable"},n.cancelBucketLogging=function(t){f.analyticsTrackClick(d.ANALYTICS.CANCEL_LOGGING,d.ANALYTICS.DETAILS),t.stopPropagation(),n.logging=e.copy(n.cachedLogging),n.cardOpen=!1,n.loggingError=!1,n.loggingErrorMessage="",g()},n.cardSummaryObj=t.cloneDeep(d.CARD_SUMMARY_INIT),n.cardSummaryObj.activeSummary.text=i.instant("bucketproperty.enabled"),n.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperty.disabled"),g(),n.getBucketLogging=function(){var t=new l("BucketLogging","getLogging"),r=u.getCurrentBucket();n.currentBucket=r,n.cardSummaryObj.isLoading=!0,p.log("getBucketLoggingReceived",1,t,{bucketName:r}),t.step="listAllMyBuckets",a.listAllMyBuckets(t).then(function(e){var i=e.response;p.log("ListAllMyBuckets",1,t,{bucketName:r}),v(i.ListAllMyBucketsResult.Buckets.Bucket,n.logging.targetBucketOptions,r)}).catch(function(e){p.log("ListAllMyBuckets",0,t,{bucketName:r,error:e}),n.loggingError=!0,n.loggingErrorMessage=f.handleErrors(e)}),t.step="getBucketLogging",a.getBucketProperty(t,r,"logging").then(function(r){var i=r.response;n.loggingError=!1,p.logRequestComplete("getBucketLogging",t),i&&(c.populateLoggingFields(i,n.logging),n.cachedLogging=e.copy(n.logging),g())}).catch(function(i){p.log("getBucketLogging",0,t,{bucketName:r,error:i}),n.loggingError=!0,n.loggingErrorMessage=f.handleErrors(i),n.cachedLogging=e.copy(n.logging)}).finally(function(){n.cardSummaryObj.isLoading=!1})},n.forCreateBucketModal?(n.$watch("cardOpen",function(e,t){e&&r(b,1)}),v(n.bucketList,n.logging.targetBucketOptions,n.createBucketValues.name,n.createBucketValues.region),n.$watch("resetLoggingValue",function(t){t&&(n.logging.selectedValue=d.BUCKET_PROPERTIES.DISABLE,n.cachedLogging.selectedValue=e.copy(n.logging.selectedValue),g())}),!t.isEmpty(n.logging)&&n.logging.errorMessage&&(n.loggingError=!0,n.loggingErrorMessage=n.logging.errorMessage),n.cachedLogging=e.copy(n.logging)):(n.scrollCardId="#"+n.id,n.getBucketLogging()),n.saveBucketLogging=function(r){if(f.analyticsTrackClick(d.ANALYTICS.SAVE_LOGGING,d.ANALYTICS.DETAILS),r.stopPropagation(),n.loggingError=!1,n.loggingErrorMessage="",n.forCreateBucketModal)n.logging.targetGrants||(n.logging.targetGrants=[]),n.cachedLogging=e.copy(n.logging),n.cardOpen=!1,g();else{var i,a,o;!function(){n.saving=!0;var e=u.getCurrentBucket();i=n.logging.targetBucket,a=n.logging.targetPrefix,o=n.logging.targetGrants,Array.isArray(o)||(o=[o]),n.logging.selectedValue===n.loggingState.enable?function(){var r=new l(d.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING),c=!1;r.step=d.BUCKET_PROPERTIES.GET_BUCKET_ACL,s.getBucketACL(i,r).then(function(l){var u=f.transformObjectToArray(l);-1===t.findIndex(l,{Grantee:{URI:d.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:d.ACL_PERMISSIONS.WRITE})&&(h(u,d.ACL_PERMISSIONS.WRITE),c=!0),-1===t.findIndex(l,{Grantee:{URI:d.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:d.ACL_PERMISSIONS.READ_ACP})&&(h(u,d.ACL_PERMISSIONS.READ_ACP),c=!0),c?(r.step=d.BUCKET_PROPERTIES.PUT_BUCKET_ACL,s.putBucketACL(i,u,r).then(function(){E(e,i,a,o,r)}).catch(function(e){m(e),n.saving=!1})):E(e,i,a,o,r)}).catch(function(e){m(e),n.saving=!1})}():s.disableBucketLogging(e,new l("disableBucketLogging")).then(function(e){n.cachedLogging=t.cloneDeep(n.logging),g(),n.cardOpen=!1}).catch(function(e){m(e)}).finally(function(){n.saving=!1})}()}}}e.module("s3").directive("bucketLogging",[function(){return{restrict:"E",scope:{cardOpen:"=",logging:"=",forCreateBucketModal:"=?",bucketList:"=?",createBucketValues:"=?",id:"@?"},template:n(570),controller:"BucketLoggingController"}}]),e.module("s3").controller("BucketLoggingController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-logging-water-mark\': !cardOpen, \'card-enable-logging-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.logging.label.logging></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelBucketLogging($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.logging.summary></p> <div class=awsui-container ng-if=cardOpen> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=logging.selectedValue> <awsui-radio-button value=enable ng-model=logging.selectedValue label="{{ \'bucketproperties.logging.label.enablelogging\' | translate }}"></awsui-radio-button> </awsui-radio-group> </div> <div ng-if="logging.selectedValue === \'enable\'"> <div class="awsui-row card-content-row"> <awsui-alert type=info class=info-alert ng-if="logging.targetBucket === currentBucket"> <span translate>bucketproperties.logging.label.alert</span> </awsui-alert> </div> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.logging.label.targetbucket></label> </div> <div class="awsui-row card-content-row"> <awsui-select class="logging-select target-value" items=logging.targetBucketOptions placeholder="{{ \'bucketproperties.logging.placeholder.selectbucket\' | translate }}" ng-model=logging.targetBucket></awsui-select> </div> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.logging.label.targetprefix></label> </div> <div class="awsui-row card-content-row"> <input type=text class=properties-placeholder ng-model=logging.targetPrefix placeholder="{{ \'bucketproperties.logging.placeholder.entertargetprefix\' | translate }}"> <awsui-tooltip text="{{\'bucketproperties.logging.targetprefix.tooltip\' | translate}}" position=top size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </div> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=logging.selectedValue> <awsui-radio-button value=disable ng-model=logging.selectedValue label="{{ \'bucketproperties.logging.label.disablelogging\' | translate }}"> </awsui-radio-button> </awsui-radio-group> </div> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert type=error class=error-alert readonly=readonly ng-if="loggingError && cardOpen">{{loggingErrorMessage}}</awsui-alert> </card-content> <card-footer> <div id=logging-properties-buttons ng-if=cardOpen class=bucket-properties-buttons> <awsui-button id=cancel-bucket-logging ng-click=cancelBucketLogging($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-logging ng-click=saveBucketLogging($event) text="{{ \'button.save\' | translate }}" variant=primary loading=saving></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p,f,g,m,h){function b(){document.getElementById(f.BUCKET_PROPERTIES.WEBSITE.CREATE_BUCKET_CARD).scrollIntoView()}function v(){r.cardSummaryObj.isActive=r.website.selectedValue!==r.websiteStates.disable,r.cardSummaryObj.activeSummary.text=r.website.selectedValue!==r.websiteStates.disable?r.website.websiteEnabledOption:""}if(r.docLinks={configure:c.getDocUrl(f.LEARN_MORE_LINKS.WEBSITE.configure),redirect:c.getDocUrl(f.LEARN_MORE_LINKS.WEBSITE.redirect),hosting:c.getDocUrl(f.LEARN_MORE_LINKS.WEBSITE.hosting)},r.websiteErrorMessage="",r.websiteError=!1,r.bucketEndpoint="",r.websitePlaceholder=f.BUCKET_PROPERTIES.WEBSITE.INDEX_FILE,r.websiteStates={disable:"disable",useBucket:"useBucket",redirectRequest:"redirectRequest"},r.cardSummaryObj=t.cloneDeep(f.CARD_SUMMARY_INIT),r.cardSummaryObj.inactiveSummary.text=a.instant("bucketproperty.disabled"),r.cancelBucketWebsite=function(t){m.analyticsTrackClick(f.ANALYTICS.CANCEL_WEBSITE,f.ANALYTICS.DETAILS),t.stopPropagation(),r.website=e.copy(r.cachedWebsite),r.cardOpen=!1,r.websiteError=!1,r.websiteErrorMessage=""},r.shouldDisableSaveButton=function(){return r.website.selectedValue===r.websiteStates.useBucket?t.isEmpty(r.website.indexDocument):r.website.selectedValue===r.websiteStates.redirectRequest&&t.isEmpty(r.website.targetDomain)},r.getBucketWebsite=function(){var t=p.getCurrentBucket(),n=new d("BucketWebsite","getWebsite");r.cardSummaryObj.isLoading=!0,g.log("getBucketWebsiteReceived",1,n,{bucketName:t}),s.getBucketProperty(n,t,"website").then(function(t){var i=t.response;g.logRequestComplete("getBucketWebsite",n),r.websiteError=!1,u.populateWebsiteFields(i,r.website),r.cachedWebsite=e.copy(r.website),v()}).catch(function(i){var a=m.handleErrors(i);i!==f.BUCKET_PROPERTIES.WEBSITE.NO_WEBSITE_CONFIGURATION_MESSAGE?(g.log("getBucketWebsite",0,n,{bucketName:t,error:i}),r.websiteError=!0,r.websiteErrorMessage=a):g.logRequestComplete("getBucketWebsite",n),r.cachedWebsite=e.copy(r.website)}).finally(function(){r.cardSummaryObj.isLoading=!1})},r.forCreateBucketModal){r.$watch("cardOpen",function(e,t){i(b,1)}),!t.isEmpty(r.website)&&r.website.errorMessage&&(r.websiteError=!0,r.websiteErrorMessage=r.website.errorMessage);var E=r.createBucketName,S=f.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[r.region];r.bucketEndpoint="http://"+E+"."+S,r.cachedWebsite=e.copy(r.website)}else!function(){r.scrollCardId="#"+r.id;var e=p.getCurrentBucket();l.getBucketLocation(e).then(function(t){var n=f.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[t];r.bucketEndpoint="http://"+e+"."+n}).catch(function(e){r.websiteError=!0,r.websiteErrorMessage=e}),r.getBucketWebsite()}();r.openBucketEndpoint=function(){o.open(r.bucketEndpoint,"_blank").opener=null},r.saveBucketWebsite=function(n){if(m.analyticsTrackClick(f.ANALYTICS.SAVE_WEBSITE,f.ANALYTICS.DETAILS),n.stopPropagation(),r.websiteError=!1,r.websiteErrorMessage="",r.forCreateBucketModal)r.cachedWebsite=e.copy(r.website),r.cardOpen=!1,v();else{var i=p.getCurrentBucket();if(r.website.selectedValue===r.websiteStates.useBucket){var o=t.isEmpty(r.website.indexDocument)?"":r.website.indexDocument,s=t.isEmpty(r.website.errorDocument)?"":r.website.errorDocument,c=t.isEmpty(r.website.routingXML)?"":r.website.routingXML,g=new d(f.BUCKET_PROPERTIES.WEBSITE.CONFIGURE_BUCKET_WEBSITE);l.configureBucketWebsite(i,o,s,c,g).then(function(){r.website.websiteEnabledOption=a.instant("bucketproperties.website.footer.buckethosting"),r.website.websiteEnabledContent=e.copy(r.website.indexDocument),r.cardOpen=!1,r.website.targetDomain="",r.website.redirectRequestProtocol="",r.cachedWebsite=e.copy(r.website),v()}).catch(function(e){r.websiteError=!0,r.websiteErrorMessage=e})}else if(r.website.selectedValue===r.websiteStates.redirectRequest){var h=t.isEmpty(r.website.targetDomain)?"":r.website.targetDomain,b=t.isEmpty(r.website.redirectRequestProtocol)?"":r.website.redirectRequestProtocol,g=new d(f.BUCKET_PROPERTIES.WEBSITE.REDIRECT_BUCKET_WEBSITE_REQUESTS);l.redirectBucketWebsiteRequests(i,h,b,g).then(function(){r.website.websiteEnabledOption=a.instant("bucketproperties.website.footer.redirectallrequests"),r.website.websiteEnabledContent=e.copy(r.website.targetDomain),r.cardOpen=!1,r.website.indexDocument="",r.website.errorDocument="",r.website.routingXML="",r.cachedWebsite=e.copy(r.website),v()}).catch(function(e){r.websiteError=!0,r.websiteErrorMessage=e})}else{var g=new d("deleteBucketWebsite");l.deleteBucketWebsite(i,g).then(function(){r.cardOpen=!1,u.clearAllWebsiteFields(r.website),r.cachedWebsite=e.copy(r.website),v()}).catch(function(e){r.websiteError=!0,r.websiteErrorMessage=e})}}}}e.module("s3").directive("bucketWebsite",[function(){return{restrict:"E",scope:{cardOpen:"=",website:"=",forCreateBucketModal:"=?",region:"=?",createBucketName:"=?",id:"@?"},template:n(572),controller:"BucketWebsiteController"}}]),e.module("s3").controller("BucketWebsiteController",["$filter","$scope","$timeout","$translate","$window","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-webhost-water-mark\': !cardOpen, \'card-enable-webhost-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.website.label.cardopen></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelBucketWebsite($event)></div> </card-header> <card-content> <div id=bucket-website-card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.website.summary></p> <div class=awsui-container ng-if=cardOpen> <div class="awsui-row card-content-row"> <span class=endpoint-label translate=bucketproperties.website.label.endpoint></span> <span class=region-endpoint> <a ng-click=openBucketEndpoint()> {{ bucketEndpoint }}</a></span> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=website.selectedValue> <awsui-radio-button name=staticWebsite style=display:inline value=useBucket class=website-radio-button ng-model=website.selectedValue label="{{ \'bucketproperties.website.label.usethisbuckettohost\' | translate }}"></awsui-radio-button> <awsui-tooltip text="{{\'bucketproperties.website.usethisbuckettohost.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <a class=learn-more-card-open-link target=_blank href="{{docLinks[\'configure\']}}" translate>learn.more</a> </awsui-radio-group> </div> <div ng-if="website.selectedValue === \'useBucket\'"> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.website.label.indexdocument></label> <awsui-tooltip text="{{\'bucketproperties.website.indexdocument.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </div> <div class="awsui-row card-content-row"> <awsui-textfield class=website-text-field ng-model=website.indexDocument placeholder="{{ websitePlaceholder }}"></awsui-textfield> </div> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.website.label.errordocument></label> <awsui-tooltip text="{{\'bucketproperties.website.errordocument.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </div> <div class="awsui-row card-content-row"> <awsui-textfield class=website-text-field ng-model=website.errorDocument placeholder="{{ \'bucketproperties.website.placeholder.errordocument\' | translate }}"></awsui-textfield> </div> <div class="awsui-row card-content-row"> <label class="target-value edit-redirection-rules" translate=bucketproperties.website.label.editredirectionrules></label> <awsui-tooltip text="{{\'bucketproperties.website.editredirectionrules.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </div> <div class="awsui-row card-content-row" ng-if=cardOpen> <div class=bucket-website-content> <awsui-textarea class=routing-xml ng-if=cardOpen ng-model=website.routingXML></awsui-textarea> </div> </div> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=website.selectedValue> <awsui-radio-button name=staticWebsite style=display:inline value=redirectRequest ng-model=website.selectedValue label="{{ \'bucketproperties.website.label.redirectrequests\' | translate }}"> </awsui-radio-button> <awsui-tooltip text="{{\'bucketproperties.website.redirectrequests.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <a class=learn-more-card-open-link target=_blank href="{{docLinks[\'redirect\']}}" translate>learn.more</a> </awsui-radio-group> </div> <div ng-if="website.selectedValue === \'redirectRequest\'"> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.website.label.targetdomain></label> </div> <div class="awsui-row card-content-row"> <awsui-textfield class=website-text-field ng-model=website.targetDomain placeholder="{{ \'bucketproperties.website.placeholder.targetdomain\' | translate }}"></awsui-textfield> </div> <div class="awsui-row card-content-row"> <label class=target-value translate=bucketproperties.website.label.redirectrequestprotocol></label> </div> <div class="awsui-row card-content-row"> <awsui-textfield class=website-text-field ng-model=website.redirectRequestProtocol placeholder="{{ \'bucketproperties.website.placeholder.redirectrequestprotocol\' | translate }}"></awsui-textfield> </div> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=website.selectedValue> <awsui-radio-button name=staticWebsite value=disable ng-model=website.selectedValue ng-if=cardOpen label="{{ \'bucketproperties.website.label.disablewebsitehosting\' | translate }}"> </awsui-radio-button> </awsui-radio-group> </div> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href="{{docLinks[\'hosting\']}}" translate>learn.more</a> <awsui-alert type=error class=error-alert readonly=readonly ng-if="websiteError && cardOpen">{{ websiteErrorMessage }}</awsui-alert> </div> </card-content> <card-footer> <div ng-if=cardOpen class=bucket-properties-buttons> <awsui-button ng-click=cancelBucketWebsite($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-website-hosting data-disabled=shouldDisableSaveButton() ng-click=saveBucketWebsite($event) text="{{ \'button.save\' | translate }}" variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function a(n,a,o,s,c,l,u,d,p,f,g,m,h,b,v){function E(){o.defaultEncryption.encryption!==o.encryptionConstants.AWSKMS&&(o.defaultEncryption.kmsId=null,o.defaultEncryption.customKMSARN=""),S(),_=e.copy(o.defaultEncryption),o.cardOpen=!1}function S(){o.cardSummaryObj.isActive=o.defaultEncryption.encryption!==g.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE,o.cardSummaryObj.activeSummary.text=o.defaultEncryption.encryption!==g.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE?o.defaultEncryption.encryption:"",o.sseError=""}function y(e){switch(e){case o.encryptionConstants.API_PARAMS.AES256:return o.encryptionConstants.AES256;case o.encryptionConstants.API_PARAMS.AWSKMS:return o.encryptionConstants.AWSKMS}}function A(){o.forCreateBucketModal?(S(),o.cardSummaryObj.isLoading=!1):function(){var n=new d(g.OPERATION_NAME.GET_DEFAULT_ENCRYPTION),r=o.forCreateBucketModal?o.bucketName:f.getCurrentBucket();l.getBucketProperty(n,r,"defaultEncryption").then(function(r){var i=b.convertXmlStringToJson(r.response);if(m.log("GetDefaultEncryption",1,n),o.defaultEncryption.encryption=y(t.get(i,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.SSEAlgorithm")),p.isFeatureEnabled(g.FAC.KMS)&&o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS){var a=t.get(i,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID");o.defaultEncryption.kmsId=h.getKMSKeyObjFromArn(a,o.kmsKeys),o.defaultEncryption.kmsId||(o.defaultEncryption.customKMSARN=a,o.defaultEncryption.kmsId=w)}S(),_=e.copy(o.defaultEncryption),o.cardSummaryObj.isLoading=!1},function(e){if(e!==o.encryptionConstants.NOT_FOUND_ERROR){var t=h.handleErrors(e);m.log("GetDefaultEncryption",0,n,{error:e,customerErrorMsg:t}),o.sseError=t}else m.log("GetDefaultEncryption",1,n),S();o.cardSummaryObj.isLoading=!1})}()}var C;o.defaultEncryption||(o.defaultEncryption={customKMSARN:"",encryption:g.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE,kmsId:null});var _=e.copy(o.defaultEncryption),w={value:g.OBJECT_SSE.CUSTOM_ARN,text:s.instant("objectproperties.kms.customarn")};o.cardSummaryObj=t.cloneDeep(g.CARD_SUMMARY_INIT),o.cardSummaryObj.inactiveSummary.text=s.instant("bucketproperty.disabled"),o.shouldDisableSave=!0,o.encryptionConstants=g.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION,o.docLink=u.getDocUrl(g.LEARN_MORE_LINKS.DEFAULT_ENCRYPTION),o.encryptionOptions=(C={},i(C,o.encryptionConstants.NONE,{apiValue:o.encryptionConstants.API_PARAMS.NONE,value:o.encryptionConstants.NONE,text:s.instant("sse.none")}),i(C,o.encryptionConstants.AES256,{apiValue:o.encryptionConstants.API_PARAMS.AES256,value:o.encryptionConstants.AES256,description:s.instant("bucketproperties.defaultencryption.aes256description"),text:o.encryptionConstants.AES256}),i(C,o.encryptionConstants.AWSKMS,{apiValue:o.encryptionConstants.API_PARAMS.AWSKMS,value:o.encryptionConstants.AWSKMS,description:s.instant("bucketproperties.defaultencryption.kmsdescription"),text:o.encryptionConstants.AWSKMS}),C),p.isFeatureEnabled(g.FAC.KMS)||delete o.encryptionOptions[o.encryptionConstants.AWSKMS],p.isFeatureEnabled(g.FAC.BUCKET_ALWAYS_ENCRYPT)&&(o.encryptionOptions[o.encryptionConstants.NONE].description=s.instant("bucketproperties.defaultencryption.noneEncryptionFallbackDescription")),o.goToBucketPermissionsTab=function(){c.scrollTo(0,0),n.path("/"+g.PATH_SEGMENTS.BUCKETS+"/"+f.getCurrentBucket()).search("tab","permissions")},o.cancelDefaultEncryption=function(t){t.stopPropagation(),o.defaultEncryption=e.copy(_),S(),o.cardOpen=!1},o.saveDefaultEncryption=function(e){e.stopPropagation();var t=void 0,n=o.forCreateBucketModal?o.bucketName:f.getCurrentBucket(),r=void 0,i=void 0;o.shouldDisableSave()||(o.forCreateBucketModal?E():o.defaultEncryption.encryption===o.encryptionConstants.NONE?(t=new d(g.OPERATION_NAME.DELETE_DEFAULT_ENCRYPTION),l.deleteBucketProperty(t,n,"defaultEncryption").then(function(e){m.log("DeleteDefaultEncryption",1,t),E()},function(e){var n=h.handleErrors(e);m.log("DeleteDefaultEncryption",0,t,{error:e,customerErrorMsg:n}),o.sseError=n})):(t=new d(g.OPERATION_NAME.PUT_DEFAULT_ENCRYPTION),r={ServerSideEncryptionConfiguration:{Rule:{ApplyServerSideEncryptionByDefault:{SSEAlgorithm:o.encryptionOptions[o.defaultEncryption.encryption].apiValue}}}},o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS&&(o.defaultEncryption.kmsId.value===g.OBJECT_SSE.CUSTOM_ARN?r.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=o.defaultEncryption.customKMSARN:r.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=o.defaultEncryption.kmsId.value),i=b.jsonToXml(r),l.putBucketProperty(t,n,"defaultEncryption",i).then(function(e){m.log("PutDefaultEncryption",1,t),E()},function(e){var n=h.handleErrors(e);m.log("PutDefaultEncryption",0,t,{error:e,customerErrorMsg:n}),o.sseError=n})))},o.shouldShowBucketPolicyWarning=function(){return!o.forCreateBucketModal&&o.defaultEncryption.encryption!==o.encryptionConstants.NONE},o.shouldDisableSave=function(){return o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS?!o.defaultEncryption.kmsId||(o.defaultEncryption.kmsId.value===g.OBJECT_SSE.CUSTOM_ARN?o.defaultEncryption.customKMSARN===_.customKMSARN:!!_.kmsId&&o.defaultEncryption.kmsId.value===_.kmsId.value):o.defaultEncryption.encryption===_.encryption},o.forCreateBucketModal?o.$watch("cardOpen",function(e,t){e&&h.scrollTo(g.BUCKET_PROPERTIES.TAGGING.CREATE_BUCKET_CARD)}):o.scrollCardId="#"+o.id,o.cardSummaryObj.isLoading=!0,p.isFeatureEnabled(g.FAC.KMS)?function(){o.kmsKeys=[];var e=new d(g.OPERATION_NAME.GET_KMS_DEFAULT_ENCRYPTION),t={region:o.region},n=o.forCreateBucketModal?o.bucketName:f.getCurrentBucket();return v.getKMSKeysByArn(e,n,null,t).then(function(e){o.kmsKeys=[].concat(r(e),[w])})}().then(A).catch(function(e){o.sseError=e,o.cardSummaryObj.isLoading=!1}):A()}e.module("s3").directive("defaultEncryption",[function(){return{restrict:"E",scope:{cardOpen:"=",defaultEncryption:"=?",forCreateBucketModal:"=?",bucketName:"=?",region:"=?",id:"@?",existingBucket:"<"},template:n(574),controller:"DefaultEncryptionController"}}]),e.module("s3").controller("DefaultEncryptionController",["$location","$q","$scope","$translate","$window","APIProxyService","AwsUrlsService","ConsoleOperation","FAC","PathService","S3Constants","SCLogService","UtilService","XMLParser","KMSPropertiesService",a])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-webhost-water-mark\': !cardOpen, \'card-enable-webhost-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.defaultencryption.title></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelDefaultEncryption($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.defaultencryption.blurb></p> <div class=awsui-container ng-if=cardOpen> <p ng-if=existingBucket translate=bucketproperties.defaultencryption.disclaimer></p> <p translate=bucketproperties.defaultencryption.mandatoryEncryptionDisclaimer fac-id=s3-region-level-enc></p> <awsui-radio-group value={{defaultEncryption.encryption}} ng-model=defaultEncryption.encryption> <div ng-repeat="encryption in encryptionOptions"> <awsui-radio-button class=encryption-radio-btn value={{encryption.value}} label={{encryption.text}} ng-class="{ \'no-description\': !encryption.description }"></awsui-radio-button> <p class=default-encryption-description ng-if=encryption.description>{{encryption.description}}</p> <div ng-if="encryption.value === encryptionConstants.AWSKMS && defaultEncryption.encryption === encryptionConstants.AWSKMS" class=kms-arn-selector fac-id=s3-kms> <awsui-control-group validation-message="{{ KMSServiceError }}"> <dropdown id=default-encryption-kms-dropdown items=kmsKeys placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled=KMSServiceError selected-item=defaultEncryption.kmsId filter=true dropdown-disabled=true> </dropdown> </awsui-control-group> <awsui-textfield class=custom-kms-arn ng-if="defaultEncryption.encryption===encryptionConstants.AWSKMS && defaultEncryption.kmsId.value===encryptionConstants.CUSTOM_ARN" ng-model=defaultEncryption.customKMSARN></awsui-textfield> </div> </div> </awsui-radio-group> <awsui-alert type=warning ng-if=shouldShowBucketPolicyWarning()> <span class=property-card-warning translate=bucketproperties.defaultencryption.checkbucketpolicy></span> <awsui-button class=bucket-policy-btn text="{{ \'bucketproperties.defaultencryption.viewbucketpolicy\' | translate }}" ng-click=goToBucketPermissionsTab()></awsui-button> </awsui-alert> <awsui-alert class=custom-kms-arn-error type=error ng-if="sseError && cardOpen"> {{ sseError }} </awsui-alert> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> </card-content> <card-footer> <div ng-if=cardOpen> <awsui-button ng-click=cancelDefaultEncryption($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-default-encryption-btn ng-click=saveDefaultEncryption($event) text="{{ \'button.save\' | translate }}" data-disabled=shouldDisableSave() variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e){!function(){function t(e,t,n,r,i){function a(){return e.cardSummaryObj.isActive?e.cardSummaryObj.activeSummary.text===n.instant("resource.access.denied"):e.cardSummaryObj.inactiveSummary.text===n.instant("resource.access.denied")}e.openCard=function(){e.disableExpand||e.cardSummaryObj.isLoading||a()||(e.isOpen=!0),i.analyticsTrackClick(r.ANALYTICS.CARD_OPEN,r.ANALYTICS.DETAILS)},e.cardloadingMsg=n.instant("loading"),e.cardId&&e.$watch("isOpen",function(n,r){r!==n&&t(function(){i.scrollCardToViewSmoothly(e.cardId)},1)})}e.module("s3").directive("card",function(){return{restrict:"E",scope:{isOpen:"=",cardId:"=?",disableExpand:"=?",cardSummaryObj:"=?"},transclude:{header:"cardHeader",content:"cardContent",footer:"cardFooter"},template:n(576),controller:"CardController"}}),e.module("s3").controller("CardController",["$scope","$timeout","$translate","S3Constants","UtilService",t])}()}).call(t,n(0))},function(e,t){e.exports='<div class=card ng-click=openCard() ng-class="{ \'cardexpand\' : isOpen }"> <div class=card-header> <div class=card-header-wrapper ng-transclude=header></div> </div> <div class=card-content> <div class=card-content-wrapper ng-transclude=content></div> </div> <div class="card-footer awsui-util-t-r" ng-transclude=footer></div> <div class="bucket-status-display single-line" ng-if="!isOpen && cardSummaryObj && !cardSummaryObj.isMultiValue"> <div class=divide-line></div> <div ng-class="{\'icon card-disabled-icon\': !cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'icon card-enabled-icon\': cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'awsui-spinner awsui-spinner-disabled card-spinner\' : cardSummaryObj.isLoading }"></div> <div ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'card-status-text\': cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'card-summary-loading\': cardSummaryObj.isLoading }" translate="{{ cardSummaryObj.isLoading ? cardloadingMsg : cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}" data-e2e-id=card-status-text></div> </div> <div class=bucket-status-display ng-if="!isOpen && cardSummaryObj && cardSummaryObj.isMultiValue && !cardSummaryObj.isLoading"> <div class=divide-line></div> <table class=cardfooter-summary-table ng-class="{\'multi-lines\' : cardSummaryObj.isActive}"> <tr> <td class=icon-column rowspan=2> <div class=icon ng-class="{\'card-disabled-icon\': !cardSummaryObj.isActive, \'card-enabled-icon\': cardSummaryObj.isActive }"></div> </td> <td class=card-summary-valuetitle ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive, \'card-status-text\': cardSummaryObj.isActive }" translate="{{ cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}"> </td> </tr> <tr> <td><p class="truncate card-summary-value">{{ cardSummaryObj.activeSummary.value }}</p></td> <td></td> </tr> </table> </div> </div> '},function(e,t,n){"use strict";(function(e){e.module("s3").service("RegionStatesService",["ConsoleOperation","S3Constants","FAC","SCLogService","S3CWSAPIService","UtilService","$q",function(e,t,n,r,i,a,o){function s(){if(!n.isFeatureEnabled(t.FAC.OPT_IN_REGIONS))return o.resolve([]);var r=new e(t.CWS_OPERATION_NAME.LIST_ACCOUNT_REGION_STATES),s={accountId:a.getUserAccountId()};return u?o.resolve(u):i.makeS3ConsoleCommandRequest(s,t.CWS_OPERATION_NAME.LIST_ACCOUNT_REGION_STATES,{},r,a.getDefaultRegion()).then(function(e){return"500"===e.data.errorCode?c(e.data,r):u=l(e.data,r)}).catch(function(e){return c(e,r)})}function c(e,n){return r.log(t.CWS_OPERATION_NAME.LIST_ACCOUNT_REGION_STATES,0,n,{error:e}),[]}function l(e,n){var i=e.filter(function(e){return e.regionState===t.REGION_STATES.DISABLED}),a=i.map(function(e){return e.regionName});return r.log(t.CWS_OPERATION_NAME.LIST_ACCOUNT_REGION_STATES,1,n),a}var u=void 0;return{getDisabledRegions:s}}])}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("Md5GenerationService",function(){this.getContentMd5=function(e){return n(193).createHash("md5").update(e).digest("base64")}})}()}).call(t,n(0))},function(e,t,n){"use strict";function r(e){var t,n,r,i,a,o,s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a="="===e[s-2]?2:"="===e[s-1]?1:0,o=new l(3*s/4-a),r=a>0?s-4:s;var u=0;for(t=0,n=0;t<r;t+=4,n+=3)i=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],o[u++]=i>>16&255,o[u++]=i>>8&255,o[u++]=255&i;return 2===a?(i=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,o[u++]=255&i):1===a&&(i=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,o[u++]=i>>8&255,o[u++]=255&i),o}function i(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function a(e,t,n){for(var r,a=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],a.push(i(r));return a.join("")}function o(e){for(var t,n=e.length,r=n%3,i="",o=[],c=0,l=n-r;c<l;c+=16383)o.push(a(e,c,c+16383>l?l:c+16383));return 1===r?(t=e[n-1],i+=s[t>>2],i+=s[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=s[t>>10],i+=s[t>>4&63],i+=s[t<<2&63],i+="="),o.push(i),o.join("")}t.toByteArray=r,t.fromByteArray=o;var s=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array;!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)s[t]=e[t],c[e.charCodeAt(t)]=t;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63}()},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,c=(1<<s)-1,l=c>>1,u=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,a=f&(1<<-u)-1,f>>=-u,u+=s;u>0;a=256*a+e[t+d],d+=p,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=r;u>0;o=256*o+e[t+d],d+=p,u-=8);if(0===a)a=1-l;else{if(a===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=l}return(f?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,c,l=8*a-i-1,u=(1<<l)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,g=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),t+=o+d>=1?p/c:p*Math.pow(2,1-d),t*c>=2&&(o++,c/=2),o+d>=u?(s=0,o=u):o+d>=1?(s=(t*c-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&s,f+=g,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+f]=255&o,f+=g,o/=256,l-=8);e[n+f-g]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(e){function n(t,n){if(t.length%a!=0){var r=t.length+(a-t.length%a);t=e.concat([t,o],r)}for(var i=[],s=n?t.readInt32BE:t.readInt32LE,c=0;c<t.length;c+=a)i.push(s.call(t,c));return i}function r(t,n,r){for(var i=new e(n),a=r?i.writeInt32BE:i.writeInt32LE,o=0;o<t.length;o++)a.call(i,t[o],4*o,!0);return i}function i(t,i,a,o){return e.isBuffer(t)||(t=new e(t)),r(i(n(t,o),t.length*s),a,o)}var a=4,o=new e(a);o.fill(0);var s=8;t.hash=i}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function n(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t}function r(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t}function i(e,t,n){for(var r=0;r<16;r++){var i=n+r,d=t[i];t[i]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}var v,E,S,y,A,C,_,w,T,R;C=v=e[0],_=E=e[1],w=S=e[2],T=y=e[3],R=A=e[4];var O;for(r=0;r<80;r+=1)O=v+t[n+p[r]]|0,O+=r<16?a(E,S,y)+h[0]:r<32?o(E,S,y)+h[1]:r<48?s(E,S,y)+h[2]:r<64?c(E,S,y)+h[3]:l(E,S,y)+h[4],O|=0,O=u(O,g[r]),O=O+A|0,v=A,A=y,y=u(S,10),S=E,E=O,O=C+t[n+f[r]]|0,O+=r<16?l(_,w,T)+b[0]:r<32?c(_,w,T)+b[1]:r<48?s(_,w,T)+b[2]:r<64?o(_,w,T)+b[3]:a(_,w,T)+b[4],O|=0,O=u(O,m[r]),O=O+R|0,C=R,R=T,T=u(w,10),w=_,_=O;O=e[1]+S+T|0,e[1]=e[2]+y+R|0,e[2]=e[3]+A+C|0,e[3]=e[4]+v+_|0,e[4]=e[0]+E+w|0,e[0]=O}function a(e,t,n){return e^t^n}function o(e,t,n){return e&t|~e&n}function s(e,t,n){return(e|~t)^n}function c(e,t,n){return e&n|t&~n}function l(e,t,n){return e^(t|~n)}function u(e,t){return e<<t|e>>>32-t}function d(e){var a=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof e&&(e=new t(e,"utf8"));var o=n(e),s=8*e.length,c=8*e.length;o[s>>>5]|=128<<24-s%32,o[14+(s+64>>>9<<4)]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8);for(var l=0;l<o.length;l+=16)i(a,o,l);for(l=0;l<5;l++){var u=a[l];a[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var d=r(a);return new t(d)}/** @preserve
(c) 2012 by Cédric Mesnil. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],f=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],b=[1352829926,1548603684,1836072691,2053994217,0];e.exports=d}).call(t,n(3).Buffer)},function(e,t,n){var t=e.exports=function(e){e=e.toLowerCase();var n=t[e];if(!n)throw new Error(e+" is not supported (we accept pull requests)");return new n};t.sha=n(585),t.sha1=n(586),t.sha224=n(587),t.sha256=n(195),t.sha384=n(588),t.sha512=n(196)},function(e,t,n){(function(t){function r(){this.init(),this._w=u,c.call(this,64,56)}function i(e){return e<<5|e>>>27}function a(e){return e<<30|e>>>2}function o(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var s=n(9),c=n(62),l=[1518500249,1859775393,-1894007588,-899497514],u=new Array(80);s(r,c),r.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,s=0|this._c,c=0|this._d,u=0|this._e,d=0;d<16;++d)t[d]=e.readInt32BE(4*d);for(;d<80;++d)t[d]=t[d-3]^t[d-8]^t[d-14]^t[d-16];for(var p=0;p<80;++p){var f=~~(p/20),g=i(n)+o(f,r,s,c)+u+t[p]+l[f]|0;u=c,c=s,s=a(r),r=n,n=g}this._a=n+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=c+this._d|0,this._e=u+this._e|0},r.prototype._hash=function(){var e=new t(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(){this.init(),this._w=d,l.call(this,64,56)}function i(e){return e<<1|e>>>31}function a(e){return e<<5|e>>>27}function o(e){return e<<30|e>>>2}function s(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var c=n(9),l=n(62),u=[1518500249,1859775393,-1894007588,-899497514],d=new Array(80);c(r,l),r.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,c=0|this._c,l=0|this._d,d=0|this._e,p=0;p<16;++p)t[p]=e.readInt32BE(4*p);for(;p<80;++p)t[p]=i(t[p-3]^t[p-8]^t[p-14]^t[p-16]);for(var f=0;f<80;++f){var g=~~(f/20),m=a(n)+s(g,r,c,l)+d+t[f]+u[g]|0;d=l,l=c,c=o(r),r=n,n=m}this._a=n+this._a|0,this._b=r+this._b|0,this._c=c+this._c|0,this._d=l+this._d|0,this._e=d+this._e|0},r.prototype._hash=function(){var e=new t(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(){this.init(),this._w=s,o.call(this,64,56)}var i=n(9),a=n(195),o=n(62),s=new Array(64);i(r,a),r.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},r.prototype._hash=function(){var e=new t(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(){this.init(),this._w=s,o.call(this,128,112)}var i=n(9),a=n(196),o=n(62),s=new Array(160);i(r,a),r.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},r.prototype._hash=function(){function e(e,t,r){n.writeInt32BE(e,r),n.writeInt32BE(t,r+4)}var n=new t(48);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),n},e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(r){var i=function(){try{return n(64)}catch(e){}}();t=e.exports=n(197),t.Stream=i||t,t.Readable=t,t.Writable=n(140),t.Duplex=n(52),t.Transform=n(142),t.PassThrough=n(199),!r.browser&&"disable"===r.env.READABLE_STREAM&&i&&(e.exports=i)}).call(t,n(60))},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){},function(e,t,n){"use strict";function r(){this.head=null,this.tail=null,this.length=0}var i=(n(3).Buffer,n(139));e.exports=r,r.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},r.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t=i.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t}},,function(e,t,n){(function(t){function n(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=n}).call(t,n(36))},function(e,t,n){e.exports=n(140)},function(e,t,n){e.exports=n(52)},function(e,t,n){e.exports=n(142)},function(e,t,n){e.exports=n(199)},function(e,t,n){function r(e,t){var n,r;if(e=e.toLowerCase(),p[e])n=p[e].key,r=p[e].iv;else{if(!d[e])throw new TypeError("invalid suite type");n=8*d[e].key,r=d[e].iv}var i=c(t,!1,n,r);return a(e,i.key,i.iv)}function i(e,t){var n,r;if(e=e.toLowerCase(),p[e])n=p[e].key,r=p[e].iv;else{if(!d[e])throw new TypeError("invalid suite type");n=8*d[e].key,r=d[e].iv}var i=c(t,!1,n,r);return o(e,i.key,i.iv)}function a(e,t,n){if(e=e.toLowerCase(),p[e])return l.createCipheriv(e,t,n);if(d[e])return new u({key:t,iv:n,mode:e});throw new TypeError("invalid suite type")}function o(e,t,n){if(e=e.toLowerCase(),p[e])return l.createDecipheriv(e,t,n);if(d[e])return new u({key:t,iv:n,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}function s(){return Object.keys(d).concat(l.getCiphers())}var c=n(94),l=n(144),u=n(603),d=n(609),p=n(96);t.createCipher=t.Cipher=r,t.createCipheriv=t.Cipheriv=a,t.createDecipher=t.Decipher=i,t.createDecipheriv=t.Decipheriv=o,t.listCiphers=t.getCiphers=s},function(e,t,n){(function(e){function r(t,n,a){if(!(this instanceof r))return new r(t,n,a);c.call(this),this._cache=new i,this._cipher=new s.AES(n),this._prev=new e(a.length),a.copy(this._prev),this._mode=t,this._autopadding=!0}function i(){if(!(this instanceof i))return new i;this.cache=new e("")}function a(t,n,i){var a=u[t.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof i&&(i=new e(i)),"string"==typeof n&&(n=new e(n)),n.length!==a.key/8)throw new TypeError("invalid key length "+n.length);if(i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);return"stream"===a.type?new p(g[a.mode],n,i):"auth"===a.type?new f(g[a.mode],n,i):new r(g[a.mode],n,i)}function o(e,t){var n=u[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=d(t,!1,n.key,n.iv);return a(e,r.key,r.iv)}var s=n(95),c=n(63),l=n(9),u=n(96),d=n(94),p=n(202),f=n(203);l(r,c),r.prototype._update=function(t){this._cache.add(t);for(var n,r,i=[];n=this._cache.get();)r=this._mode.encrypt(this,n),i.push(r);return e.concat(i)},r.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if("10101010101010101010101010101010"!==e.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},r.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},i.prototype.add=function(t){this.cache=e.concat([this.cache,t])},i.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},i.prototype.flush=function(){for(var t=16-this.cache.length,n=new e(t),r=-1;++r<t;)n.writeUInt8(t,r);return e.concat([this.cache,n])};var g={ECB:n(204),CBC:n(205),CFB:n(206),CFB8:n(207),CFB1:n(208),OFB:n(209),CTR:n(97),GCM:n(97)};t.createCipheriv=a,t.createCipher=o}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function n(e){this.h=e,this.state=new t(16),this.state.fill(0),this.cache=new t("")}function r(e){return[e.readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)]}function i(e){e=e.map(a);var n=new t(16);return n.writeUInt32BE(e[0],0),n.writeUInt32BE(e[1],4),n.writeUInt32BE(e[2],8),n.writeUInt32BE(e[3],12),n}function a(e){var t;return e>c||e<0?(t=Math.abs(e)%c,e<0?c-t:t):e}function o(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}var s=new t(16);s.fill(0),e.exports=n,n.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},n.prototype._multiply=function(){for(var e,t,n,a=r(this.h),s=[0,0,0,0],c=-1;++c<128;){for(t=0!=(this.state[~~(c/8)]&1<<7-c%8),t&&(s=o(s,a)),n=0!=(1&a[3]),e=3;e>0;e--)a[e]=a[e]>>>1|(1&a[e-1])<<31;a[0]=a[0]>>>1,n&&(a[0]=a[0]^225<<24)}this.state=i(s)},n.prototype.update=function(e){this.cache=t.concat([this.cache,e]);for(var n;this.cache.length>=16;)n=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(n)},n.prototype.final=function(e,n){return this.cache.length&&this.ghash(t.concat([this.cache,s],16)),this.ghash(i([0,e,0,n])),this.state};var c=Math.pow(2,32)}).call(t,n(3).Buffer)},function(e,t,n){(function(e){function r(t,n,a){if(!(this instanceof r))return new r(t,n,a);l.call(this),this._cache=new i,this._last=void 0,this._cipher=new c.AES(n),this._prev=new e(a.length),a.copy(this._prev),this._mode=t,this._autopadding=!0}function i(){if(!(this instanceof i))return new i;this.cache=new e("")}function a(e){for(var t=e[15],n=-1;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}function o(t,n,i){var a=d[t.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"==typeof i&&(i=new e(i)),"string"==typeof n&&(n=new e(n)),n.length!==a.key/8)throw new TypeError("invalid key length "+n.length);if(i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);return"stream"===a.type?new p(m[a.mode],n,i,!0):"auth"===a.type?new f(m[a.mode],n,i,!0):new r(m[a.mode],n,i)}function s(e,t){var n=d[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=g(t,!1,n.key,n.iv);return o(e,r.key,r.iv)}var c=n(95),l=n(63),u=n(9),d=n(96),p=n(202),f=n(203),g=n(94);u(r,l),r.prototype._update=function(t){this._cache.add(t);for(var n,r,i=[];n=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,n),i.push(r);return e.concat(i)},r.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return a(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},r.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},i.prototype.add=function(t){this.cache=e.concat([this.cache,t])},i.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},i.prototype.flush=function(){if(this.cache.length)return this.cache};var m={ECB:n(204),CBC:n(205),CFB:n(206),CFB8:n(207),CFB1:n(208),OFB:n(209),CTR:n(97),GCM:n(97)};t.createDecipher=s,t.createDecipheriv=o}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e){i.call(this);var n,r=e.mode.toLowerCase(),a=s[r];n=e.decrypt?"decrypt":"encrypt";var o=e.key;"des-ede"!==r&&"des-ede-cbc"!==r||(o=t.concat([o,o.slice(0,8)]));var c=e.iv;this._des=a.create({key:o,iv:c,type:n})}var i=n(63),a=n(145),o=n(9),s={"des-ede3-cbc":a.CBC.instantiate(a.EDE),"des-ede3":a.EDE,"des-ede-cbc":a.CBC.instantiate(a.EDE),"des-ede":a.EDE,"des-cbc":a.CBC.instantiate(a.DES),"des-ecb":a.DES};s.des=s["des-cbc"],s.des3=s["des-ede3-cbc"],e.exports=r,o(r,i),r.prototype._update=function(e){return new t(this._des.update(e))},r.prototype._final=function(){return new t(this._des.final())}}).call(t,n(3).Buffer)},function(e,t,n){"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,n){e[0+n]=t>>>24,e[1+n]=t>>>16&255,e[2+n]=t>>>8&255,e[3+n]=255&t},t.ip=function(e,t,n,r){for(var i=0,a=0,o=6;o>=0;o-=2){for(var s=0;s<=24;s+=8)i<<=1,i|=t>>>s+o&1;for(var s=0;s<=24;s+=8)i<<=1,i|=e>>>s+o&1}for(var o=6;o>=0;o-=2){for(var s=1;s<=25;s+=8)a<<=1,a|=t>>>s+o&1;for(var s=1;s<=25;s+=8)a<<=1,a|=e>>>s+o&1}n[r+0]=i>>>0,n[r+1]=a>>>0},t.rip=function(e,t,n,r){for(var i=0,a=0,o=0;o<4;o++)for(var s=24;s>=0;s-=8)i<<=1,i|=t>>>s+o&1,i<<=1,i|=e>>>s+o&1;for(var o=4;o<8;o++)for(var s=24;s>=0;s-=8)a<<=1,a|=t>>>s+o&1,a<<=1,a|=e>>>s+o&1;n[r+0]=i>>>0,n[r+1]=a>>>0},t.pc1=function(e,t,n,r){for(var i=0,a=0,o=7;o>=5;o--){for(var s=0;s<=24;s+=8)i<<=1,i|=t>>s+o&1;for(var s=0;s<=24;s+=8)i<<=1,i|=e>>s+o&1}for(var s=0;s<=24;s+=8)i<<=1,i|=t>>s+o&1;for(var o=1;o<=3;o++){for(var s=0;s<=24;s+=8)a<<=1,a|=t>>s+o&1;for(var s=0;s<=24;s+=8)a<<=1,a|=e>>s+o&1}for(var s=0;s<=24;s+=8)a<<=1,a|=e>>s+o&1;n[r+0]=i>>>0,n[r+1]=a>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,n,i){for(var a=0,o=0,s=r.length>>>1,c=0;c<s;c++)a<<=1,a|=e>>>r[c]&1;for(var c=s;c<r.length;c++)o<<=1,o|=t>>>r[c]&1;n[i+0]=a>>>0,n[i+1]=o>>>0},t.expand=function(e,t,n){var r=0,i=0;r=(1&e)<<5|e>>>27;for(var a=23;a>=15;a-=4)r<<=6,r|=e>>>a&63;for(var a=11;a>=3;a-=4)i|=e>>>a&63,i<<=6;i|=(31&e)<<1|e>>>31,t[n+0]=r>>>0,t[n+1]=i>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var n=0,r=0;r<4;r++){var a=e>>>18-6*r&63,o=i[64*r+a];n<<=4,n|=o}for(var r=0;r<4;r++){var a=t>>>18-6*r&63,o=i[256+64*r+a];n<<=4,n|=o}return n>>>0};var a=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,n=0;n<a.length;n++)t<<=1,t|=e>>>a[n]&1;return t>>>0},t.padSplit=function(e,t,n){for(var r=e.toString(2);r.length<t;)r="0"+r;for(var i=[],a=0;a<t;a+=n)i.push(r.slice(a,a+n));return i.join(" ")}},function(e,t,n){"use strict";function r(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var i=n(75);e.exports=r,r.prototype._init=function(){},r.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},r.prototype._buffer=function(e,t){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-t),r=0;r<n;r++)this.buffer[this.bufferOff+r]=e[t+r];return this.bufferOff+=n,n},r.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},r.prototype._updateEncrypt=function(e){var t=0,n=0,r=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(r*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(i,n)));for(var a=e.length-(e.length-t)%this.blockSize;t<a;t+=this.blockSize)this._update(e,t,i,n),n+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},r.prototype._updateDecrypt=function(e){for(var t=0,n=0,r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(r*this.blockSize);r>0;r--)t+=this._buffer(e,t),n+=this._flushBuffer(i,n);return t+=this._buffer(e,t),i},r.prototype.final=function(e){var t;e&&(t=this.update(e));var n;return n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(n):n},r.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},r.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},r.prototype._unpad=function(e){return e},r.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},function(e,t,n){"use strict";function r(){this.tmp=new Array(2),this.keys=null}function i(e){l.call(this,e);var t=new r;this._desState=t,this.deriveKeys(t,e.key)}var a=n(75),o=n(9),s=n(145),c=s.utils,l=s.Cipher;o(i,l),e.exports=i,i.create=function(e){return new i(e)};var u=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];i.prototype.deriveKeys=function(e,t){e.keys=new Array(32),a.equal(t.length,this.blockSize,"Invalid key length");var n=c.readUInt32BE(t,0),r=c.readUInt32BE(t,4);c.pc1(n,r,e.tmp,0),n=e.tmp[0],r=e.tmp[1];for(var i=0;i<e.keys.length;i+=2){var o=u[i>>>1];n=c.r28shl(n,o),r=c.r28shl(r,o),c.pc2(n,r,e.keys,i)}},i.prototype._update=function(e,t,n,r){var i=this._desState,a=c.readUInt32BE(e,t),o=c.readUInt32BE(e,t+4);c.ip(a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],"encrypt"===this.type?this._encrypt(i,a,o,i.tmp,0):this._decrypt(i,a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],c.writeUInt32BE(n,a,r),c.writeUInt32BE(n,o,r+4)},i.prototype._pad=function(e,t){for(var n=e.length-t,r=t;r<e.length;r++)e[r]=n;return!0},i.prototype._unpad=function(e){for(var t=e[e.length-1],n=e.length-t;n<e.length;n++)a.equal(e[n],t);return e.slice(0,e.length-t)},i.prototype._encrypt=function(e,t,n,r,i){for(var a=t,o=n,s=0;s<e.keys.length;s+=2){var l=e.keys[s],u=e.keys[s+1];c.expand(o,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var d=c.substitute(l,u),p=c.permute(d),f=o;o=(a^p)>>>0,a=f}c.rip(o,a,r,i)},i.prototype._decrypt=function(e,t,n,r,i){for(var a=n,o=t,s=e.keys.length-2;s>=0;s-=2){var l=e.keys[s],u=e.keys[s+1];c.expand(a,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var d=c.substitute(l,u),p=c.permute(d),f=a;a=(o^p)>>>0,o=f}c.rip(a,o,r,i)}},function(e,t,n){"use strict";function r(e){a.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}function i(e){function t(t){e.call(this,t),this._cbcInit()}o(t,e);for(var n=Object.keys(s),r=0;r<n.length;r++){var i=n[r];t.prototype[i]=s[i]}return t.create=function(e){return new t(e)},t}var a=n(75),o=n(9),s={};t.instantiate=i,s._cbcInit=function(){var e=new r(this.options.iv);this._cbcState=e},s._update=function(e,t,n,r){var i=this._cbcState,a=this.constructor.super_.prototype,o=i.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)o[s]^=e[t+s];a._update.call(this,o,0,n,r);for(var s=0;s<this.blockSize;s++)o[s]=n[r+s]}else{a._update.call(this,e,t,n,r);for(var s=0;s<this.blockSize;s++)n[r+s]^=o[s];for(var s=0;s<this.blockSize;s++)o[s]=e[t+s]}}},function(e,t,n){"use strict";function r(e,t){a.equal(t.length,24,"Invalid key length");var n=t.slice(0,8),r=t.slice(8,16),i=t.slice(16,24);this.ciphers="encrypt"===e?[l.create({type:"encrypt",key:n}),l.create({type:"decrypt",key:r}),l.create({type:"encrypt",key:i})]:[l.create({type:"decrypt",key:i}),l.create({type:"encrypt",key:r}),l.create({type:"decrypt",key:n})]}function i(e){c.call(this,e);var t=new r(this.type,this.options.key);this._edeState=t}var a=n(75),o=n(9),s=n(145),c=s.Cipher,l=s.DES;o(i,c),e.exports=i,i.create=function(e){return new i(e)},i.prototype._update=function(e,t,n,r){var i=this._edeState;i.ciphers[0]._update(e,t,n,r),i.ciphers[1]._update(n,r,n,r),i.ciphers[2]._update(n,r,n,r)},i.prototype._pad=l.prototype._pad,i.prototype._unpad=l.prototype._unpad},function(e,t){t["des-ecb"]={key:8,iv:0},t["des-cbc"]=t.des={key:8,iv:8},t["des-ede3-cbc"]=t.des3={key:24,iv:8},t["des-ede3"]={key:24,iv:0},t["des-ede-cbc"]={key:16,iv:8},t["des-ede"]={key:16,iv:0}},function(e,t,n){(function(e){function r(t){var n=new e(o[t].prime,"hex"),r=new e(o[t].gen,"hex");return new s(n,r)}function i(t,n,r,o){return e.isBuffer(n)||void 0===c[n]?i(t,"binary",n,r):(n=n||"binary",o=o||"binary",r=r||new e([2]),e.isBuffer(r)||(r=new e(r,o)),"number"==typeof t?new s(a(t,r),r,!0):(e.isBuffer(t)||(t=new e(t,n)),new s(t,r,!0)))}var a=n(210),o=n(612),s=n(613),c={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=r,t.createDiffieHellman=t.DiffieHellman=i}).call(t,n(3).Buffer)},function(e,t){},function(e,t){e.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},function(e,t,n){(function(t){function r(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this._pub=new c(e),this}function i(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this._priv=new c(e),this}function a(e,t){var n=t.toString("hex"),r=[n,e.toString(16)].join("_");if(r in v)return v[r];var i=0;if(e.isEven()||!h.simpleSieve||!h.fermatTest(e)||!u.test(e))return i+=1,i+="02"===n||"05"===n?8:4,v[r]=i,i;u.test(e.shrn(1))||(i+=2);var a;switch(n){case"02":e.mod(d).cmp(p)&&(i+=8);break;case"05":a=e.mod(f),a.cmp(g)&&a.cmp(m)&&(i+=8);break;default:i+=4}return v[r]=i,i}function o(e,t,n){this.setGenerator(t),this.__prime=new c(e),this._prime=c.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,n?(this.setPublicKey=r,this.setPrivateKey=i):this._primeCode=8}function s(e,n){var r=new t(e.toArray());return n?r.toString(n):r}var c=n(14),l=n(211),u=new l,d=new c(24),p=new c(11),f=new c(10),g=new c(3),m=new c(7),h=n(210),b=n(72);e.exports=o;var v={};Object.defineProperty(o.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=a(this.__prime,this.__gen)),this._primeCode}}),o.prototype.generateKeys=function(){return this._priv||(this._priv=new c(b(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},o.prototype.computeSecret=function(e){e=new c(e),e=e.toRed(this._prime);var n=e.redPow(this._priv).fromRed(),r=new t(n.toArray()),i=this.getPrime();if(r.length<i.length){var a=new t(i.length-r.length);a.fill(0),r=t.concat([a,r])}return r},o.prototype.getPublicKey=function(e){return s(this._pub,e)},o.prototype.getPrivateKey=function(e){return s(this._priv,e)},o.prototype.getPrime=function(e){return s(this.__prime,e)},o.prototype.getGenerator=function(e){return s(this._gen,e)},o.prototype.setGenerator=function(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this.__gen=e,this._gen=new c(e),this}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e){d.Writable.call(this);var t=f[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=c(t.hash),this._tag=t.id,this._signType=t.sign}function i(e){d.Writable.call(this);var t=f[e];if(!t)throw new Error("Unknown message digest");this._hash=c(t.hash),this._tag=t.id,this._signType=t.sign}function a(e){return new r(e)}function o(e){return new i(e)}var s=n(200),c=n(61),l=n(9),u=n(615),d=n(64),p=n(649),f={};Object.keys(s).forEach(function(e){f[e]=f[e.toLowerCase()]=s[e]}),l(r,d.Writable),r.prototype._write=function(e,t,n){this._hash.update(e),n()},r.prototype.update=function(e,n){return"string"==typeof e&&(e=new t(e,n)),this._hash.update(e),this},r.prototype.sign=function(e,n){this.end();var r=this._hash.digest(),i=u(t.concat([this._tag,r]),e,this._hashType,this._signType);return n?i.toString(n):i},l(i,d.Writable),i.prototype._write=function(e,t,n){this._hash.update(e),n()},i.prototype.update=function(e,n){return"string"==typeof e&&(e=new t(e,n)),this._hash.update(e),this},i.prototype.verify=function(e,n,r){"string"==typeof n&&(n=new t(n,r)),this.end();var i=this._hash.digest();return p(n,t.concat([this._tag,i]),e,this._signType)},e.exports={Sign:a,Verify:o,createSign:a,createVerify:o}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e,t,n,r){var o=h(t);if(o.curve){if("ecdsa"!==r)throw new Error("wrong private key type");return i(e,o)}if("dsa"===o.type){if("dsa"!==r)throw new Error("wrong private key type");return a(e,o,n)}if("rsa"!==r)throw new Error("wrong private key type");for(var s=o.modulus.byteLength(),c=[0,1];e.length+c.length+1<s;)c.push(255);c.push(0);for(var l=-1;++l<e.length;)c.push(e[l]);return f(c,o)}function i(e,n){var r=g[n.curve.join(".")];if(!r)throw new Error("unknown curve "+n.curve.join("."));var i=new v(r),a=i.genKeyPair();a._importPrivate(n.privateKey);var o=a.sign(e);return new t(o.toDER())}function a(e,t,n){for(var r,i=t.params.priv_key,a=t.params.p,l=t.params.q,p=t.params.g,f=new b(0),g=c(e,l).mod(l),m=!1,h=s(i,l,e,n);!1===m;)r=u(l,h,n),f=d(p,r,a,l),m=r.invm(l).imul(g.add(i.mul(f))).mod(l),m.cmpn(0)||(m=!1,f=new b(0));return o(f,m)}function o(e,n){e=e.toArray(),n=n.toArray(),128&e[0]&&(e=[0].concat(e)),128&n[0]&&(n=[0].concat(n));var r=e.length+n.length+4,i=[48,r,2,e.length];return i=i.concat(e,[2,n.length],n),new t(i)}function s(e,n,r,i){if(e=new t(e.toArray()),e.length<n.byteLength()){var a=new t(n.byteLength()-e.length);a.fill(0),e=t.concat([a,e])}var o=r.length,s=l(r,n),c=new t(o);c.fill(1);var u=new t(o);return u.fill(0),u=p(i,u).update(c).update(new t([0])).update(e).update(s).digest(),c=p(i,u).update(c).digest(),u=p(i,u).update(c).update(new t([1])).update(e).update(s).digest(),c=p(i,u).update(c).digest(),{k:u,v:c}}function c(e,t){var n=new b(e),r=(e.length<<3)-t.bitLength();return r>0&&n.ishrn(r),n}function l(e,n){e=c(e,n),e=e.mod(n);var r=new t(e.toArray());if(r.length<n.byteLength()){var i=new t(n.byteLength()-r.length);i.fill(0),r=t.concat([i,r])}return r}function u(e,n,r){var i,a;do{for(i=new t("");8*i.length<e.bitLength();)n.v=p(r,n.k).update(n.v).digest(),i=t.concat([i,n.v]);a=c(i,e),n.k=p(r,n.k).update(n.v).update(new t([0])).digest(),n.v=p(r,n.k).update(n.v).digest()}while(-1!==a.cmp(e));return a}function d(e,t,n,r){return e.toRed(b.mont(n)).redPow(t).fromRed().mod(r)}var p=n(143),f=n(146),g=n(213),m=n(19),h=n(99),b=n(14),v=m.ec;e.exports=r,e.exports.getKey=s,e.exports.makeKey=u}).call(t,n(3).Buffer)},function(e,t){e.exports={name:"elliptic",version:"6.2.3",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{coverage:"npm run unit --coverage",coveralls:"npm run coverage && cat ./coverage/lcov.info | coveralls",jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/*.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/*.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/*-test.js"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{coveralls:"^2.11.3",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},dependencies:{"bn.js":"^4.0.0",brorand:"^1.0.1","hash.js":"^1.0.0",inherits:"^2.0.1"}}},function(e,t,n){"use strict";function r(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}if(t){if("hex"===t){e=e.replace(/[^a-z0-9]+/gi,""),e.length%2!=0&&(e="0"+e);for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}}else for(var r=0;r<e.length;r++){var i=e.charCodeAt(r),a=i>>8,o=255&i;a?n.push(a,o):n.push(o)}return n}function i(e){return 1===e.length?"0"+e:e}function a(e){for(var t="",n=0;n<e.length;n++)t+=i(e[n].toString(16));return t}function o(e,t){for(var n=[],r=1<<t+1,i=e.clone();i.cmpn(1)>=0;){var a;if(i.isOdd()){var o=i.andln(r-1);a=o>(r>>1)-1?(r>>1)-o:o,i.isubn(a)}else a=0;n.push(a);for(var s=0!==i.cmpn(0)&&0===i.andln(r-1)?t+1:1,c=1;c<s;c++)n.push(0);i.iushrn(s)}return n}function s(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var r=0,i=0;e.cmpn(-r)>0||t.cmpn(-i)>0;){var a=e.andln(3)+r&3,o=t.andln(3)+i&3;3===a&&(a=-1),3===o&&(o=-1);var s;if(0==(1&a))s=0;else{var c=e.andln(7)+r&7;s=3!==c&&5!==c||2!==o?a:-a}n[0].push(s);var l;if(0==(1&o))l=0;else{var c=t.andln(7)+i&7;l=3!==c&&5!==c||2!==a?o:-o}n[1].push(l),2*r===s+1&&(r=1-r),2*i===l+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return n}function c(e,t){var n=t.name,r="_"+n;e.prototype[n]=function(){return void 0!==this[r]?this[r]:this[r]=t.call(this)}}function l(e){return"string"==typeof e?d.toArray(e,"hex"):e}function u(e){return new p(e,"hex","le")}var d=t,p=n(14);d.assert=function(e,t){if(!e)throw new Error(t||"Assertion failed")},d.toArray=r,d.zero2=i,d.toHex=a,d.encode=function(e,t){return"hex"===t?a(e):e},d.getNAF=o,d.getJSF=s,d.cachedProperty=c,d.parseBytes=l,d.intFromLE=u},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=o.toArray(e.entropy,e.entropyEnc),n=o.toArray(e.nonce,e.nonceEnc),i=o.toArray(e.pers,e.persEnc);s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,i)}var i=n(53),a=n(19),o=a.utils,s=o.assert;e.exports=r,r.prototype._init=function(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this.reseed=1,this.reseedInterval=281474976710656},r.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},r.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},r.prototype.reseed=function(e,t,n,r){"string"!=typeof t&&(r=n,n=t,t=null),e=o.toBuffer(e,t),n=o.toBuffer(n,r),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this.reseed=1},r.prototype.generate=function(e,t,n,r){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(r=n,n=t,t=null),n&&(n=o.toArray(n,r),this._update(n));for(var i=[];i.length<e;)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var a=i.slice(0,e);return this._update(n),this.reseed++,o.encode(a,t)}},function(e,t,n){function r(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t){e=e.replace(/[^a-z0-9]+/gi,""),e.length%2!=0&&(e="0"+e);for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}}else for(var r=0;r<e.length;r++){var i=e.charCodeAt(r),a=i>>8,o=255&i;a?n.push(a,o):n.push(o)}else for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}function i(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n].toString(16));return t}function a(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=a(i)),n+=c(i.toString(16))}return n}function s(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}function l(e,t,n,r){var i=n-t;b(i%4==0);for(var a=new Array(i/4),o=0,s=t;o<a.length;o++,s+=4){var c;c="big"===r?e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3]:e[s+3]<<24|e[s+2]<<16|e[s+1]<<8|e[s],a[o]=c>>>0}return a}function u(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var a=e[r];"big"===t?(n[i]=a>>>24,n[i+1]=a>>>16&255,n[i+2]=a>>>8&255,n[i+3]=255&a):(n[i+3]=a>>>24,n[i+2]=a>>>16&255,n[i+1]=a>>>8&255,n[i]=255&a)}return n}function d(e,t){return e>>>t|e<<32-t}function p(e,t){return e<<t|e>>>32-t}function f(e,t){return e+t>>>0}function g(e,t,n){return e+t+n>>>0}function m(e,t,n,r){return e+t+n+r>>>0}function h(e,t,n,r,i){return e+t+n+r+i>>>0}function b(e,t){if(!e)throw new Error(t||"Assertion failed")}function v(e,t,n,r){var i=e[t],a=e[t+1],o=r+a>>>0,s=(o<r?1:0)+n+i;e[t]=s>>>0,e[t+1]=o}function E(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0}function S(e,t,n,r){return t+r>>>0}function y(e,t,n,r,i,a,o,s){var c=0,l=t;return l=l+r>>>0,c+=l<t?1:0,l=l+a>>>0,c+=l<a?1:0,l=l+s>>>0,c+=l<s?1:0,e+n+i+o+c>>>0}function A(e,t,n,r,i,a,o,s){return t+r+a+s>>>0}function C(e,t,n,r,i,a,o,s,c,l){var u=0,d=t;return d=d+r>>>0,u+=d<t?1:0,d=d+a>>>0,u+=d<a?1:0,d=d+s>>>0,u+=d<s?1:0,d=d+l>>>0,u+=d<l?1:0,e+n+i+o+c+u>>>0}function _(e,t,n,r,i,a,o,s,c,l){return t+r+a+s+l>>>0}function w(e,t,n){return(t<<32-n|e>>>n)>>>0}function T(e,t,n){return(e<<32-n|t>>>n)>>>0}function R(e,t,n){return e>>>n}function O(e,t,n){return(e<<32-n|t>>>n)>>>0}var k=t,I=n(9);k.toArray=r,k.toHex=i,k.htonl=a,k.toHex32=o,k.zero2=s,k.zero8=c,k.join32=l,k.split32=u,k.rotr32=d,k.rotl32=p,k.sum32=f,k.sum32_3=g,k.sum32_4=m,k.sum32_5=h,k.assert=b,k.inherits=I,t.sum64=v,t.sum64_hi=E,t.sum64_lo=S,t.sum64_4_hi=y,t.sum64_4_lo=A,t.sum64_5_hi=C,t.sum64_5_lo=_,t.rotr64_hi=w,t.rotr64_lo=T,t.shr64_hi=R,t.shr64_lo=O},function(e,t,n){function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var i=n(53),a=i.utils,o=a.assert;t.BlockHash=r,r.prototype.update=function(e,t){if(e=a.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=a.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},r.prototype.digest=function(e){return this.update(this._pad()),o(null===this.pending),this._digest(e)},r.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var a=8;a<this.padLength;a++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else{r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0;for(var a=8;a<this.padLength;a++)r[i++]=0}return r}},function(e,t,n){function r(){if(!(this instanceof r))return new r;$.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=H,this.W=new Array(64)}function i(){if(!(this instanceof i))return new i;r.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}function a(){if(!(this instanceof a))return new a;$.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=q,this.W=new Array(160)}function o(){if(!(this instanceof o))return new o;a.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}function s(){if(!(this instanceof s))return new s;$.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}function c(e,t,n){return e&t^~e&n}function l(e,t,n){return e&t^e&n^t&n}function u(e,t,n){return e^t^n}function d(e){return P(e,2)^P(e,13)^P(e,22)}function p(e){return P(e,6)^P(e,11)^P(e,25)}function f(e){return P(e,7)^P(e,18)^e>>>3}function g(e){return P(e,17)^P(e,19)^e>>>10}function m(e,t,n,r){return 0===e?c(t,n,r):1===e||3===e?u(t,n,r):2===e?l(t,n,r):void 0}function h(e,t,n,r,i,a){var o=e&n^~e&i;return o<0&&(o+=4294967296),o}function b(e,t,n,r,i,a){var o=t&r^~t&a;return o<0&&(o+=4294967296),o}function v(e,t,n,r,i,a){var o=e&n^e&i^n&i;return o<0&&(o+=4294967296),o}function E(e,t,n,r,i,a){var o=t&r^t&a^r&a;return o<0&&(o+=4294967296),o}function S(e,t){var n=D(e,t,28),r=D(t,e,2),i=D(t,e,7),a=n^r^i;return a<0&&(a+=4294967296),a}function y(e,t){var n=j(e,t,28),r=j(t,e,2),i=j(t,e,7),a=n^r^i;return a<0&&(a+=4294967296),a}function A(e,t){var n=D(e,t,14),r=D(e,t,18),i=D(t,e,9),a=n^r^i;return a<0&&(a+=4294967296),a}function C(e,t){var n=j(e,t,14),r=j(e,t,18),i=j(t,e,9),a=n^r^i;return a<0&&(a+=4294967296),a}function _(e,t){var n=D(e,t,1),r=D(e,t,8),i=B(e,t,7),a=n^r^i;return a<0&&(a+=4294967296),a}function w(e,t){var n=j(e,t,1),r=j(e,t,8),i=F(e,t,7),a=n^r^i;return a<0&&(a+=4294967296),a}function T(e,t){var n=D(e,t,19),r=D(t,e,29),i=B(e,t,6),a=n^r^i;return a<0&&(a+=4294967296),a}function R(e,t){var n=j(e,t,19),r=j(t,e,29),i=F(e,t,6),a=n^r^i;return a<0&&(a+=4294967296),a}var O=n(53),k=O.utils,I=k.assert,P=k.rotr32,N=k.rotl32,M=k.sum32,L=k.sum32_4,x=k.sum32_5,D=k.rotr64_hi,j=k.rotr64_lo,B=k.shr64_hi,F=k.shr64_lo,U=k.sum64,K=k.sum64_hi,V=k.sum64_lo,G=k.sum64_4_hi,Y=k.sum64_4_lo,W=k.sum64_5_hi,z=k.sum64_5_lo,$=O.common.BlockHash,H=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],q=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],J=[1518500249,1859775393,2400959708,3395469782];k.inherits(r,$),t.sha256=r,r.blockSize=512,r.outSize=256,r.hmacStrength=192,r.padLength=64,r.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=L(g(n[r-2]),n[r-7],f(n[r-15]),n[r-16]);var i=this.h[0],a=this.h[1],o=this.h[2],s=this.h[3],u=this.h[4],m=this.h[5],h=this.h[6],b=this.h[7];I(this.k.length===n.length);for(var r=0;r<n.length;r++){var v=x(b,p(u),c(u,m,h),this.k[r],n[r]),E=M(d(i),l(i,a,o));b=h,h=m,m=u,u=M(s,v),s=o,o=a,a=i,i=M(v,E)}this.h[0]=M(this.h[0],i),this.h[1]=M(this.h[1],a),this.h[2]=M(this.h[2],o),this.h[3]=M(this.h[3],s),this.h[4]=M(this.h[4],u),this.h[5]=M(this.h[5],m),this.h[6]=M(this.h[6],h),this.h[7]=M(this.h[7],b)},r.prototype._digest=function(e){return"hex"===e?k.toHex32(this.h,"big"):k.split32(this.h,"big")},k.inherits(i,r),t.sha224=i,i.blockSize=512,i.outSize=224,i.hmacStrength=192,i.padLength=64,i.prototype._digest=function(e){return"hex"===e?k.toHex32(this.h.slice(0,7),"big"):k.split32(this.h.slice(0,7),"big")},k.inherits(a,$),t.sha512=a,a.blockSize=1024,a.outSize=512,a.hmacStrength=192,a.padLength=128,a.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=T(n[r-4],n[r-3]),a=R(n[r-4],n[r-3]),o=n[r-14],s=n[r-13],c=_(n[r-30],n[r-29]),l=w(n[r-30],n[r-29]),u=n[r-32],d=n[r-31];n[r]=G(i,a,o,s,c,l,u,d),n[r+1]=Y(i,a,o,s,c,l,u,d)}},a.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,r=this.h[0],i=this.h[1],a=this.h[2],o=this.h[3],s=this.h[4],c=this.h[5],l=this.h[6],u=this.h[7],d=this.h[8],p=this.h[9],f=this.h[10],g=this.h[11],m=this.h[12],_=this.h[13],w=this.h[14],T=this.h[15];I(this.k.length===n.length);for(var R=0;R<n.length;R+=2){var O=w,k=T,P=A(d,p),N=C(d,p),M=h(d,p,f,g,m,_),L=b(d,p,f,g,m,_),x=this.k[R],D=this.k[R+1],j=n[R],B=n[R+1],F=W(O,k,P,N,M,L,x,D,j,B),G=z(O,k,P,N,M,L,x,D,j,B),O=S(r,i),k=y(r,i),P=v(r,i,a,o,s,c),N=E(r,i,a,o,s,c),Y=K(O,k,P,N),$=V(O,k,P,N);w=m,T=_,m=f,_=g,f=d,g=p,d=K(l,u,F,G),p=V(u,u,F,G),l=s,u=c,s=a,c=o,a=r,o=i,r=K(F,G,Y,$),i=V(F,G,Y,$)}U(this.h,0,r,i),U(this.h,2,a,o),U(this.h,4,s,c),U(this.h,6,l,u),U(this.h,8,d,p),U(this.h,10,f,g),U(this.h,12,m,_),U(this.h,14,w,T)},a.prototype._digest=function(e){return"hex"===e?k.toHex32(this.h,"big"):k.split32(this.h,"big")},k.inherits(o,a),t.sha384=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(e){return"hex"===e?k.toHex32(this.h.slice(0,12),"big"):k.split32(this.h.slice(0,12),"big")},k.inherits(s,$),t.sha1=s,s.blockSize=512,s.outSize=160,s.hmacStrength=80,s.padLength=64,s.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=N(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);for(var i=this.h[0],a=this.h[1],o=this.h[2],s=this.h[3],c=this.h[4],r=0;r<n.length;r++){var l=~~(r/20),u=x(N(i,5),m(l,a,o,s),c,n[r],J[l]);c=s,s=o,o=N(a,30),a=i,i=u}this.h[0]=M(this.h[0],i),this.h[1]=M(this.h[1],a),this.h[2]=M(this.h[2],o),this.h[3]=M(this.h[3],s),this.h[4]=M(this.h[4],c)},s.prototype._digest=function(e){return"hex"===e?k.toHex32(this.h,"big"):k.split32(this.h,"big")}},function(e,t,n){function r(){if(!(this instanceof r))return new r;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function i(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function a(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function o(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}var s=n(53),c=s.utils,l=c.rotl32,u=c.sum32,d=c.sum32_3,p=c.sum32_4,f=s.common.BlockHash;c.inherits(r,f),t.ripemd160=r,r.blockSize=512,r.outSize=160,r.hmacStrength=192,r.padLength=64,r.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],s=this.h[2],c=this.h[3],f=this.h[4],v=n,E=r,S=s,y=c,A=f,C=0;C<80;C++){var _=u(l(p(n,i(C,r,s,c),e[g[C]+t],a(C)),h[C]),f);n=f,f=c,c=l(s,10),s=r,r=_,_=u(l(p(v,i(79-C,E,S,y),e[m[C]+t],o(C)),b[C]),A),v=A,A=y,y=l(S,10),S=E,E=_}_=d(this.h[1],s,y),this.h[1]=d(this.h[2],c,A),this.h[2]=d(this.h[3],f,v),this.h[3]=d(this.h[4],n,E),this.h[4]=d(this.h[0],r,S),this.h[0]=_},r.prototype._digest=function(e){return"hex"===e?c.toHex32(this.h,"little"):c.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(a.toArray(t,n))}var i=n(53),a=i.utils,o=a.assert;e.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),o(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(var t=0;t<e.length;t++)e[t]^=54;this.inner=(new this.Hash).update(e);for(var t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,t){return this.inner.update(e,t),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},function(e,t,n){"use strict";function r(e,t){this.type=e,this.p=new a(t.p,16),this.red=t.prime?a.red(t.prime):a.mont(this.p),this.zero=new a(0).toRed(this.red),this.one=new a(1).toRed(this.red),this.two=new a(2).toRed(this.red),this.n=t.n&&new a(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4)}function i(e,t){this.curve=e,this.type=t,this.precomputed=null}var a=n(14),o=n(19),s=o.utils,c=s.getNAF,l=s.getJSF,u=s.assert;e.exports=r,r.prototype.point=function(){throw new Error("Not implemented")},r.prototype.validate=function(){throw new Error("Not implemented")},r.prototype._fixedNafMul=function(e,t){u(e.precomputed);var n=e._getDoubles(),r=c(t,1),i=(1<<n.step+1)-(n.step%2==0?2:1);i/=3;for(var a=[],o=0;o<r.length;o+=n.step){for(var s=0,t=o+n.step-1;t>=o;t--)s=(s<<1)+r[t];a.push(s)}for(var l=this.jpoint(null,null,null),d=this.jpoint(null,null,null),p=i;p>0;p--){for(var o=0;o<a.length;o++){var s=a[o];s===p?d=d.mixedAdd(n.points[o]):s===-p&&(d=d.mixedAdd(n.points[o].neg()))}l=l.add(d)}return l.toP()},r.prototype._wnafMul=function(e,t){var n=4,r=e._getNAFPoints(n);n=r.wnd;for(var i=r.points,a=c(t,n),o=this.jpoint(null,null,null),s=a.length-1;s>=0;s--){for(var t=0;s>=0&&0===a[s];s--)t++;if(s>=0&&t++,o=o.dblp(t),s<0)break;var l=a[s];u(0!==l),o="affine"===e.type?l>0?o.mixedAdd(i[l-1>>1]):o.mixedAdd(i[-l-1>>1].neg()):l>0?o.add(i[l-1>>1]):o.add(i[-l-1>>1].neg())}return"affine"===e.type?o.toP():o},r.prototype._wnafMulAdd=function(e,t,n,r){for(var i=this._wnafT1,a=this._wnafT2,o=this._wnafT3,s=0,u=0;u<r;u++){var d=t[u],p=d._getNAFPoints(e);i[u]=p.wnd,a[u]=p.points}for(var u=r-1;u>=1;u-=2){var f=u-1,g=u;if(1===i[f]&&1===i[g]){var m=[t[f],null,null,t[g]];0===t[f].y.cmp(t[g].y)?(m[1]=t[f].add(t[g]),m[2]=t[f].toJ().mixedAdd(t[g].neg())):0===t[f].y.cmp(t[g].y.redNeg())?(m[1]=t[f].toJ().mixedAdd(t[g]),m[2]=t[f].add(t[g].neg())):(m[1]=t[f].toJ().mixedAdd(t[g]),m[2]=t[f].toJ().mixedAdd(t[g].neg()));var h=[-3,-1,-5,-7,0,7,5,1,3],b=l(n[f],n[g]);s=Math.max(b[0].length,s),o[f]=new Array(s),o[g]=new Array(s);for(var v=0;v<s;v++){var E=0|b[0][v],S=0|b[1][v];o[f][v]=h[3*(E+1)+(S+1)],o[g][v]=0,a[f]=m}}else o[f]=c(n[f],i[f]),o[g]=c(n[g],i[g]),s=Math.max(o[f].length,s),s=Math.max(o[g].length,s)}for(var y=this.jpoint(null,null,null),A=this._wnafT4,u=s;u>=0;u--){for(var C=0;u>=0;){for(var _=!0,v=0;v<r;v++)A[v]=0|o[v][u],0!==A[v]&&(_=!1);if(!_)break;C++,u--}if(u>=0&&C++,y=y.dblp(C),u<0)break;for(var v=0;v<r;v++){var d,w=A[v];0!==w&&(w>0?d=a[v][w-1>>1]:w<0&&(d=a[v][-w-1>>1].neg()),y="affine"===d.type?y.mixedAdd(d):y.add(d))}}for(var u=0;u<r;u++)a[u]=null;return y.toP()},r.BasePoint=i,i.prototype.eq=function(){throw new Error("Not implemented")},i.prototype.validate=function(){return this.curve.validate(this)},r.prototype.decodePoint=function(e,t){e=s.toArray(e,t);var n=this.p.byteLength();if(4===e[0]&&e.length-1==2*n)return this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},i.prototype.encodeCompressed=function(e){return this.encode(e,!0)},i.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},i.prototype.encode=function(e,t){return s.encode(this._encode(t),e)},i.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},i.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},i.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<t;i+=e){for(var a=0;a<e;a++)r=r.dbl();n.push(r)}return{step:e,points:n}},i.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}},i.prototype._getBeta=function(){return null},i.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}},function(e,t,n){"use strict";function r(e){u.call(this,"short",e),this.a=new c(e.a,16).toRed(this.red),this.b=new c(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function i(e,t,n,r){u.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new c(t,16),this.y=new c(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function a(e,t,n,r){u.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new c(0)):(this.x=new c(t,16),this.y=new c(n,16),this.z=new c(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var o=n(98),s=n(19),c=n(14),l=n(9),u=o.base,d=s.utils.assert;l(r,u),e.exports=r,r.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new c(e.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);t=r[0].cmp(r[1])<0?r[0]:r[1],t=t.toRed(this.red)}if(e.lambda)n=new c(e.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))?n=i[0]:(n=i[1],d(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}var a;return a=e.basis?e.basis.map(function(e){return{a:new c(e.a,16),b:new c(e.b,16)}}):this._getEndoBasis(n),{beta:t,lambda:n,basis:a}}},r.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:c.mont(e),n=new c(2).toRed(t).redInvm(),r=n.redNeg(),i=new c(3).toRed(t).redNeg().redSqrt().redMul(n);return[r.redAdd(i).fromRed(),r.redSub(i).fromRed()]},r.prototype._getEndoBasis=function(e){for(var t,n,r,i,a,o,s,l,u,d=this.n.ushrn(Math.floor(this.n.bitLength()/2)),p=e,f=this.n.clone(),g=new c(1),m=new c(0),h=new c(0),b=new c(1),v=0;0!==p.cmpn(0);){var E=f.div(p);l=f.sub(E.mul(p)),u=h.sub(E.mul(g));var S=b.sub(E.mul(m));if(!r&&l.cmp(d)<0)t=s.neg(),n=g,r=l.neg(),i=u;else if(r&&2==++v)break;s=l,f=p,p=l,h=g,g=u,b=m,m=S}a=l.neg(),o=u;var y=r.sqr().add(i.sqr());return a.sqr().add(o.sqr()).cmp(y)>=0&&(a=t,o=n),r.negative&&(r=r.neg(),i=i.neg()),a.negative&&(a=a.neg(),o=o.neg()),[{a:r,b:i},{a:a,b:o}]},r.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),a=n.b.neg().mul(e).divRound(this.n),o=i.mul(n.a),s=a.mul(r.a),c=i.mul(n.b),l=a.mul(r.b);return{k1:e.sub(o).sub(s),k2:c.add(l).neg()}},r.prototype.pointFromX=function(e,t){e=new c(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var i=r.fromRed().isOdd();return(t&&!i||!t&&i)&&(r=r.redNeg()),this.point(e,r)},r.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,r=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},r.prototype._endoWnafMulAdd=function(e,t){for(var n=this._endoWnafT1,r=this._endoWnafT2,i=0;i<e.length;i++){var a=this._endoSplit(t[i]),o=e[i],s=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),s=s.neg(!0)),n[2*i]=o,n[2*i+1]=s,r[2*i]=a.k1,r[2*i+1]=a.k2}for(var c=this._wnafMulAdd(1,n,r,2*i),l=0;l<2*i;l++)n[l]=null,r[l]=null;return c},l(i,u.BasePoint),r.prototype.point=function(e,t,n){return new i(this,e,t,n)},r.prototype.pointFromJSON=function(e,t){return i.fromJSON(this,e,t)},i.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},i.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},i.fromJSON=function(e,t,n){function r(t){return e.point(t[0],t[1],n)}"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],n);if(!t[2])return i;var a=t[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(r))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(r))}},i},i.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},i.prototype.isInfinity=function(){return this.inf},i.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},i.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),r=e.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r),a=i.redSqr().redISub(this.x.redAdd(this.x)),o=i.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)},i.prototype.getX=function(){return this.x.fromRed()},i.prototype.getY=function(){return this.y.fromRed()},i.prototype.mul=function(e){return e=new c(e,16),this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},i.prototype.mulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},i.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},i.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t},i.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(a,u.BasePoint),r.prototype.jpoint=function(e,t,n){return new a(this,e,t,n)},a.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)},a.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},a.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(t),i=e.x.redMul(n),a=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(n.redMul(this.z)),s=r.redSub(i),c=a.redSub(o);if(0===s.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=s.redSqr(),u=l.redMul(s),d=r.redMul(l),p=c.redSqr().redIAdd(u).redISub(d).redISub(d),f=c.redMul(d.redISub(p)).redISub(a.redMul(u)),g=this.z.redMul(e.z).redMul(s);return this.curve.jpoint(p,f,g)},a.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,r=e.x.redMul(t),i=this.y,a=e.y.redMul(t).redMul(this.z),o=n.redSub(r),s=i.redSub(a);if(0===o.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),l=c.redMul(o),u=n.redMul(c),d=s.redSqr().redIAdd(l).redISub(u).redISub(u),p=s.redMul(u.redISub(d)).redISub(i.redMul(l)),f=this.z.redMul(o);return this.curve.jpoint(d,p,f)},a.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}for(var r=this.curve.a,i=this.curve.tinv,a=this.x,o=this.y,s=this.z,c=s.redSqr().redSqr(),l=o.redAdd(o),n=0;n<e;n++){var u=a.redSqr(),d=l.redSqr(),p=d.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(c)),g=a.redMul(d),m=f.redSqr().redISub(g.redAdd(g)),h=g.redISub(m),b=f.redMul(h);b=b.redIAdd(b).redISub(p);var v=l.redMul(s);n+1<e&&(c=c.redMul(p)),a=m,s=v,l=b}return this.curve.jpoint(a,l.redMul(i),s)},a.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},a.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),a=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(r).redISub(a);o=o.redIAdd(o);var s=r.redAdd(r).redIAdd(r),c=s.redSqr().redISub(o).redISub(o),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),e=c,t=s.redMul(o.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),d=this.y.redSqr(),p=d.redSqr(),f=this.x.redAdd(d).redSqr().redISub(u).redISub(p);f=f.redIAdd(f);var g=u.redAdd(u).redIAdd(u),m=g.redSqr(),h=p.redIAdd(p);h=h.redIAdd(h),h=h.redIAdd(h),e=m.redISub(f).redISub(f),t=g.redMul(f.redISub(e)).redISub(h),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)},a.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),a=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(r).redISub(a);o=o.redIAdd(o);var s=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),c=s.redSqr().redISub(o).redISub(o);e=c;var l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),t=s.redMul(o.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),d=this.y.redSqr(),p=this.x.redMul(d),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var g=p.redIAdd(p);g=g.redIAdd(g);var m=g.redAdd(g);e=f.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(d).redISub(u);var h=d.redSqr();h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h),t=f.redMul(g.redISub(e)).redISub(h)}return this.curve.jpoint(e,t,n)},a.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),a=t.redSqr(),o=n.redSqr(),s=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(i)),c=t.redAdd(t);c=c.redIAdd(c);var l=c.redMul(o),u=s.redSqr().redISub(l.redAdd(l)),d=l.redISub(u),p=o.redSqr();p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var f=s.redMul(d).redISub(p),g=n.redAdd(n).redMul(r);return this.curve.jpoint(u,f,g)},a.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),r=t.redSqr(),i=e.redAdd(e).redIAdd(e),a=i.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(r);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(a);var s=o.redSqr(),c=r.redIAdd(r);c=c.redIAdd(c),c=c.redIAdd(c),c=c.redIAdd(c);var l=i.redIAdd(o).redSqr().redISub(a).redISub(s).redISub(c),u=t.redMul(l);u=u.redIAdd(u),u=u.redIAdd(u);var d=this.x.redMul(s).redISub(u);d=d.redIAdd(d),d=d.redIAdd(d);var p=this.y.redMul(l.redMul(c.redISub(l)).redISub(o.redMul(s)));p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var f=this.z.redAdd(o).redSqr().redISub(n).redISub(s);return this.curve.jpoint(d,p,f)},a.prototype.mul=function(e,t){return e=new c(e,t),this.curve._wnafMul(this,e)},a.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),i=n.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)},a.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},a.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(e,t,n){"use strict";function r(e){c.call(this,"mont",e),this.a=new o(e.a,16).toRed(this.red),this.b=new o(e.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function i(e,t,n){c.BasePoint.call(this,e,"projective"),null===t&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(t,16),this.z=new o(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var a=n(98),o=n(14),s=n(9),c=a.base,l=n(19),u=l.utils;s(r,c),e.exports=r,r.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},s(i,c.BasePoint),r.prototype.decodePoint=function(e,t){return this.point(u.toArray(e,t),1)},r.prototype.point=function(e,t){return new i(this,e,t)},r.prototype.pointFromJSON=function(e){return i.fromJSON(this,e)},i.prototype.precompute=function(){},i.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},i.fromJSON=function(e,t){return new i(e,t[0],t[1]||e.one)},i.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},i.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},i.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),n=this.x.redSub(this.z),r=n.redSqr(),i=t.redSub(r),a=t.redMul(r),o=i.redMul(r.redAdd(this.curve.a24.redMul(i)));return this.curve.point(a,o)},i.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},i.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=e.x.redAdd(e.z),a=e.x.redSub(e.z),o=a.redMul(n),s=i.redMul(r),c=t.z.redMul(o.redAdd(s).redSqr()),l=t.x.redMul(o.redISub(s).redSqr());return this.curve.point(c,l)},i.prototype.mul=function(e){for(var t=e.clone(),n=this,r=this.curve.point(null,null),i=this,a=[];0!==t.cmpn(0);t.iushrn(1))a.push(t.andln(1));for(var o=a.length-1;o>=0;o--)0===a[o]?(n=n.diffAdd(r,i),r=r.dbl()):(r=n.diffAdd(r,i),n=n.dbl());return r},i.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},i.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},i.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},i.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(e,t,n){"use strict";function r(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,l.call(this,"edwards",e),this.a=new s(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),u(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function i(e,t,n,r,i){l.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(t,16),this.y=new s(n,16),this.z=r?new s(r,16):this.curve.one,this.t=i&&new s(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var a=n(98),o=n(19),s=n(14),c=n(9),l=a.base,u=o.utils.assert;c(r,l),e.exports=r,r.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},r.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},r.prototype.jpoint=function(e,t,n,r){return this.point(e,t,n,r)},r.prototype.pointFromX=function(e,t){e=new s(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),r=this.c2.redSub(this.a.redMul(n)),i=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=r.redMul(i.redInvm()),o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)},r.prototype.pointFromY=function(e,t){e=new s(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),r=n.redSub(this.one),i=n.redMul(this.d).redAdd(this.one),a=r.redMul(i.redInvm());if(0===a.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return o.isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},r.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),r=t.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===r.cmp(i)},c(i,l.BasePoint),r.prototype.pointFromJSON=function(e){return i.fromJSON(this,e)},r.prototype.point=function(e,t,n,r){return new i(this,e,t,n,r)},i.fromJSON=function(e,t){return new i(e,t[0],t[1],t[2])},i.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},i.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},i.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),a=r.redAdd(t),o=a.redSub(n),s=r.redSub(t),c=i.redMul(o),l=a.redMul(s),u=i.redMul(s),d=o.redMul(a);return this.curve.point(c,l,d,u)},i.prototype._projDbl=function(){var e,t,n,r=this.x.redAdd(this.y).redSqr(),i=this.x.redSqr(),a=this.y.redSqr();if(this.curve.twisted){var o=this.curve._mulA(i),s=o.redAdd(a);if(this.zOne)e=r.redSub(i).redSub(a).redMul(s.redSub(this.curve.two)),t=s.redMul(o.redSub(a)),n=s.redSqr().redSub(s).redSub(s);else{var c=this.z.redSqr(),l=s.redSub(c).redISub(c);e=r.redSub(i).redISub(a).redMul(l),t=s.redMul(o.redSub(a)),n=s.redMul(l)}}else{var o=i.redAdd(a),c=this.curve._mulC(this.c.redMul(this.z)).redSqr(),l=o.redSub(c).redSub(c);e=this.curve._mulC(r.redISub(o)).redMul(l),t=this.curve._mulC(o).redMul(i.redISub(a)),n=o.redMul(l)}return this.curve.point(e,t,n)},i.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},i.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),a=n.redSub(t),o=i.redSub(r),s=i.redAdd(r),c=n.redAdd(t),l=a.redMul(o),u=s.redMul(c),d=a.redMul(c),p=o.redMul(s);return this.curve.point(l,u,p,d)},i.prototype._projAdd=function(e){var t,n,r=this.z.redMul(e.z),i=r.redSqr(),a=this.x.redMul(e.x),o=this.y.redMul(e.y),s=this.curve.d.redMul(a).redMul(o),c=i.redSub(s),l=i.redAdd(s),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(o),d=r.redMul(c).redMul(u);return this.curve.twisted?(t=r.redMul(l).redMul(o.redSub(this.curve._mulA(a))),n=c.redMul(l)):(t=r.redMul(l).redMul(o.redSub(a)),n=this.curve._mulC(c).redMul(l)),this.curve.point(d,t,n)},i.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},i.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},i.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2)},i.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},i.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},i.prototype.getX=function(){return this.normalize(),this.x.fromRed()},i.prototype.getY=function(){return this.normalize(),this.y.fromRed()},i.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},i.prototype.toP=i.prototype.normalize,i.prototype.mixedAdd=i.prototype.add},function(e,t,n){"use strict";function r(e){"short"===e.type?this.curve=new s.curve.short(e):"edwards"===e.type?this.curve=new s.curve.edwards(e):this.curve=new s.curve.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,c(this.g.validate(),"Invalid curve"),c(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function i(e,t){Object.defineProperty(a,e,{configurable:!0,enumerable:!0,get:function(){var n=new r(t);return Object.defineProperty(a,e,{configurable:!0,enumerable:!0,value:n}),n}})}var a=t,o=n(53),s=n(19),c=s.utils.assert;a.PresetCurve=r,i("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),i("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),i("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),i("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),i("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),i("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"0",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),i("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var l;try{l=n(629)}catch(e){l=void 0}i("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",l]})},function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);"string"==typeof e&&(s(a.curves.hasOwnProperty(e),"Unknown curve "+e),e=a.curves[e]),e instanceof a.curves.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var i=n(14),a=n(19),o=a.utils,s=o.assert,c=n(631),l=n(632);e.exports=r,r.prototype.keyPair=function(e){return new c(this,e)},r.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},r.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},r.prototype.genKeyPair=function(e){e||(e={});for(var t=new a.hmacDRBG({hash:this.hash,pers:e.pers,entropy:e.entropy||a.rand(this.hash.hmacStrength),nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new i(2));;){var o=new i(t.generate(n));if(!(o.cmp(r)>0))return o.iaddn(1),this.keyFromPrivate(o)}},r.prototype._truncateToN=function(e,t){var n=8*e.byteLength()-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},r.prototype.sign=function(e,t,n,r){"object"==typeof n&&(r=n,n=null),r||(r={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new i(e,16));for(var o=this.n.byteLength(),s=t.getPrivate().toArray("be",o),c=e.toArray("be",o),u=new a.hmacDRBG({hash:this.hash,entropy:s,nonce:c,pers:r.pers,persEnc:r.persEnc}),d=this.n.sub(new i(1)),p=0;!0;p++){var f=r.k?r.k(p):new i(u.generate(this.n.byteLength()));if(f=this._truncateToN(f,!0),!(f.cmpn(1)<=0||f.cmp(d)>=0)){var g=this.g.mul(f);if(!g.isInfinity()){var m=g.getX(),h=m.umod(this.n);if(0!==h.cmpn(0)){var b=f.invm(this.n).mul(h.mul(t.getPrivate()).iadd(e));if(b=b.umod(this.n),0!==b.cmpn(0)){var v=(g.getY().isOdd()?1:0)|(0!==m.cmp(h)?2:0);return r.canonical&&b.cmp(this.nh)>0&&(b=this.n.sub(b),v^=1),new l({r:h,s:b,recoveryParam:v})}}}}}},r.prototype.verify=function(e,t,n,r){e=this._truncateToN(new i(e,16)),n=this.keyFromPublic(n,r),t=new l(t,"hex");var a=t.r,o=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var s=o.invm(this.n),c=s.mul(e).umod(this.n),u=s.mul(a).umod(this.n),d=this.g.mulAdd(c,n.getPublic(),u);return!d.isInfinity()&&0===d.getX().umod(this.n).cmp(a)},r.prototype.recoverPubKey=function(e,t,n,r){s((3&n)===n,"The recovery param is more than two bits"),t=new l(t,r);var a=this.n,o=new i(e),c=t.r,u=t.s,d=1&n,p=n>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&p)throw new Error("Unable to find sencond key candinate");c=p?this.curve.pointFromX(c.add(this.curve.n),d):this.curve.pointFromX(c,d);var f=a.sub(o),g=t.r.invm(a);return this.g.mulAdd(f,c,u).mul(g)},r.prototype.getKeyRecoveryParam=function(e,t,n,r){if(t=new l(t,r),null!==t.recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var a;try{a=this.recoverPubKey(e,t,i)}catch(e){continue}if(a.eq(n))return i}throw new Error("Unable to find valid recovery factor")}},function(e,t,n){"use strict";function r(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var i=n(14);e.exports=r,r.fromPublic=function(e,t,n){return t instanceof r?t:new r(e,{pub:t,pubEnc:n})},r.fromPrivate=function(e,t,n){return t instanceof r?t:new r(e,{priv:t,privEnc:n})},r.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},r.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},r.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},r.prototype._importPrivate=function(e,t){this.priv=new i(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},r.prototype._importPublic=function(e,t){if(e.x||e.y)return void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},r.prototype.derive=function(e){return e.mul(this.priv).getX()},r.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},r.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},r.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(e,t,n){"use strict";function r(e,t){if(e instanceof r)return e;this._importDER(e,t)||(d(e.r&&e.s,"Signature without r or s"),this.r=new c(e.r,16),this.s=new c(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function i(){this.place=0}function a(e,t){var n=e[t.place++];if(!(128&n))return n;for(var r=15&n,i=0,a=0,o=t.place;a<r;a++,o++)i<<=8,i|=e[o];return t.place=o,i}function o(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function s(e,t){if(t<128)return void e.push(t);var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}var c=n(14),l=n(19),u=l.utils,d=u.assert;e.exports=r,r.prototype._importDER=function(e,t){e=u.toArray(e,t);var n=new i;if(48!==e[n.place++])return!1;if(a(e,n)+n.place!==e.length)return!1;if(2!==e[n.place++])return!1;var r=a(e,n),o=e.slice(n.place,r+n.place);if(n.place+=r,2!==e[n.place++])return!1;var s=a(e,n);if(e.length!==s+n.place)return!1;var l=e.slice(n.place,s+n.place);return 0===o[0]&&128&o[1]&&(o=o.slice(1)),0===l[0]&&128&l[1]&&(l=l.slice(1)),this.r=new c(o),this.s=new c(l),this.recoveryParam=null,!0},r.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=o(t),n=o(n);!(n[0]||128&n[1]);)n=n.slice(1);var r=[2];s(r,t.length),r=r.concat(t),r.push(2),s(r,n.length);var i=r.concat(n),a=[48];return s(a,i.length),a=a.concat(i),u.encode(a,e)}},function(e,t,n){"use strict";function r(e){if(s("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof r))return new r(e);var e=a.curves[e].curve;this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=i.sha512}var i=n(53),a=n(19),o=a.utils,s=o.assert,c=o.parseBytes,l=n(634),u=n(635);e.exports=r,r.prototype.sign=function(e,t){e=c(e);var n=this.keyFromSecret(t),r=this.hashInt(n.messagePrefix(),e),i=this.g.mul(r),a=this.encodePoint(i),o=this.hashInt(a,n.pubBytes(),e).mul(n.priv()),s=r.add(o).umod(this.curve.n);return this.makeSignature({R:i,S:s,Rencoded:a})},r.prototype.verify=function(e,t,n){e=c(e),t=this.makeSignature(t);var r=this.keyFromPublic(n),i=this.hashInt(t.Rencoded(),r.pubBytes(),e),a=this.g.mul(t.S());return t.R().add(r.pub().mul(i)).eq(a)},r.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return o.intFromLE(e.digest()).umod(this.curve.n)},r.prototype.keyFromPublic=function(e){return l.fromPublic(this,e)},r.prototype.keyFromSecret=function(e){return l.fromSecret(this,e)},r.prototype.makeSignature=function(e){return e instanceof u?e:new u(this,e)},r.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},r.prototype.decodePoint=function(e){e=o.parseBytes(e);var t=e.length-1,n=e.slice(0,t).concat(-129&e[t]),r=0!=(128&e[t]),i=o.intFromLE(n);return this.curve.pointFromY(i,r)},r.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},r.prototype.decodeInt=function(e){return o.intFromLE(e)},r.prototype.isPoint=function(e){return e instanceof this.pointClass}},function(e,t,n){"use strict";function r(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}var i=n(19),a=i.utils,o=a.assert,s=a.parseBytes,c=a.cachedProperty;r.fromPublic=function(e,t){return t instanceof r?t:new r(e,{pub:t})},r.fromSecret=function(e,t){return t instanceof r?t:new r(e,{secret:t})},r.prototype.secret=function(){return this._secret},c(r,function(){return this.eddsa.encodePoint(this.pub())}),c(r,function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),c(r,function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r}),c(r,function(){return this.eddsa.decodeInt(this.privBytes())}),c(r,function(){return this.eddsa.hash().update(this.secret()).digest()}),c(r,function(){return this.hash().slice(this.eddsa.encodingLength)}),r.prototype.sign=function(e){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},r.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},r.prototype.getSecret=function(e){return o(this._secret,"KeyPair is public only"),a.encode(this.secret(),e)},r.prototype.getPublic=function(e){return a.encode(this.pubBytes(),e)},e.exports=r},function(e,t,n){"use strict";function r(e,t){this.eddsa=e,"object"!=typeof t&&(t=l(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof i&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}var i=n(14),a=n(19),o=a.utils,s=o.assert,c=o.cachedProperty,l=o.parseBytes;c(r,function(){return this.eddsa.decodeInt(this.Sencoded())}),c(r,function(){return this.eddsa.decodePoint(this.Rencoded())}),c(r,function(){return this.eddsa.encodePoint(this.R())}),c(r,function(){return this.eddsa.encodeInt(this.S())}),r.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},r.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},e.exports=r},function(e,t,n){var r=n(66),i=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});t.RSAPrivateKey=i;var a=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});t.RSAPublicKey=a;var o=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())});t.PublicKey=o;var s=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),c=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(s),this.key("subjectPrivateKey").octstr())});t.PrivateKey=c;var l=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});t.EncryptedPrivateKey=l;var u=r.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});t.DSAPrivateKey=u,t.DSAparam=r.define("DSAparam",function(){this.int()});var d=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(p),this.key("publicKey").optional().explicit(1).bitstr())});t.ECPrivateKey=d;var p=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});t.signature=r.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},function(e,t,n){function r(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}var i=n(66),a=n(9);t.define=function(e,t){return new r(e,t)},r.prototype._createNamed=function(e){var t;try{t=n(638).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return a(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},r.prototype._getDecoder=function(e){return this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i.decoders[e])),this.decoders[e]},r.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},r.prototype._getEncoder=function(e){return this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(i.encoders[e])),this.encoders[e]},r.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)}},function(module,exports,__webpack_require__){function Context(){}var indexOf=__webpack_require__(639),Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,n){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(e){return function(e,t,n){e[t]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var n=t.contentWindow,r=n.eval,i=n.execScript;!r&&i&&(i.call(n,"null"),r=n.eval),forEach(Object_keys(e),function(t){n[t]=e[t]}),forEach(globals,function(t){e[t]&&(n[t]=e[t])});var a=Object_keys(n),o=r.call(n,this.code);return forEach(Object_keys(n),function(t){(t in e||-1===indexOf(a,t))&&(e[t]=n[t])}),forEach(globals,function(t){t in e||defineProp(e,t,n[t])}),document.body.removeChild(t),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),n=this.runInContext(t);return forEach(Object_keys(t),function(n){e[n]=t[n]}),n},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var n=Script(t);return n[e].apply(n,[].slice.call(arguments,1))}}),exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(n){t[n]=e[n]}),t}},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){function r(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function i(e,t){this.path=e,this.rethrow(t)}var a=n(9);t.Reporter=r,r.prototype.isError=function(e){return e instanceof i},r.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},r.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},r.prototype.enterKey=function(e){return this._reporterState.path.push(e)},r.prototype.leaveKey=function(e,t,n){var r=this._reporterState;r.path=r.path.slice(0,e-1),null!==r.obj&&(r.obj[t]=n)},r.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},r.prototype.leaveObject=function(e){var t=this._reporterState,n=t.obj;return t.obj=e,n},r.prototype.error=function(e){var t,n=this._reporterState,r=e instanceof i;if(t=r?e:new i(n.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!n.options.partial)throw t;return r||n.errors.push(t),t},r.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},a(i,Error),i.prototype.rethrow=function(e){return this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace(this,i),this}},function(e,t,n){function r(e,t){var n={};this._baseState=n,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}var i=n(76).Reporter,a=n(76).EncoderBuffer,o=n(76).DecoderBuffer,s=n(75),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],l=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c),u=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];e.exports=r;var d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit"];r.prototype.clone=function(){var e=this._baseState,t={};d.forEach(function(n){t[n]=e[n]});var n=new this.constructor(t.parent);return n._baseState=t,n},r.prototype._wrap=function(){var e=this._baseState;l.forEach(function(t){this[t]=function(){var n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}},this)},r.prototype._init=function(e){var t=this._baseState;s(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),s.equal(t.children.length,1,"Root node can have only one child")},r.prototype._useArgs=function(e){var t=this._baseState,n=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==n.length&&(s(null===t.children),t.children=n,n.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(s(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(n){n==(0|n)&&(n|=0);var r=e[n];t[r]=n}),t}))},u.forEach(function(e){r.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),c.forEach(function(e){r.prototype[e]=function(){var t=this._baseState,n=Array.prototype.slice.call(arguments);return s(null===t.tag),t.tag=e,this._useArgs(n),this}}),r.prototype.use=function(e){var t=this._baseState;return s(null===t.use),t.use=e,this},r.prototype.optional=function(){return this._baseState.optional=!0,this},r.prototype.def=function(e){var t=this._baseState;return s(null===t.default),t.default=e,t.optional=!0,this},r.prototype.explicit=function(e){var t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.explicit=e,this},r.prototype.implicit=function(e){var t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.implicit=e,this},r.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},r.prototype.key=function(e){var t=this._baseState;return s(null===t.key),t.key=e,this},r.prototype.any=function(){return this._baseState.any=!0,this},r.prototype.choice=function(e){var t=this._baseState;return s(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},r.prototype.contains=function(e){var t=this._baseState;return s(null===t.use),t.contains=e,this},r.prototype._decode=function(e){var t=this._baseState;if(null===t.parent)return e.wrapResult(t.children[0]._decode(e));var n,r=t.default,i=!0;if(null!==t.key&&(n=e.enterKey(t.key)),t.optional){var a=null;if(null!==t.explicit?a=t.explicit:null!==t.implicit?a=t.implicit:null!==t.tag&&(a=t.tag),null!==a||t.any){if(i=this._peekTag(e,a,t.any),e.isError(i))return i}else{var s=e.save();try{null===t.choice?this._decodeGeneric(t.tag,e):this._decodeChoice(e),i=!0}catch(e){i=!1}e.restore(s)}}var c;if(t.obj&&i&&(c=e.enterObject()),i){if(null!==t.explicit){var l=this._decodeTag(e,t.explicit);if(e.isError(l))return l;e=l}if(null===t.use&&null===t.choice){if(t.any)var s=e.save();var u=this._decodeTag(e,null!==t.implicit?t.implicit:t.tag,t.any);if(e.isError(u))return u;t.any?r=e.raw(s):e=u}if(r=t.any?r:null===t.choice?this._decodeGeneric(t.tag,e):this._decodeChoice(e),e.isError(r))return r;if(t.any||null!==t.choice||null===t.children||t.children.forEach(function(t){t._decode(e)}),t.contains&&("octstr"===t.tag||"bitstr"===t.tag)){var d=new o(r);r=this._getUse(t.contains,e._reporterState.obj)._decode(d)}}return t.obj&&i&&(r=e.leaveObject(c)),null===t.key||null===r&&!0!==i||e.leaveKey(n,t.key,r),r},r.prototype._decodeGeneric=function(e,t){var n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0]):/str$/.test(e)?this._decodeStr(t,e):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1]):"objid"===e?this._decodeObjid(t,null,null):"gentime"===e||"utctime"===e?this._decodeTime(t,e):"null_"===e?this._decodeNull(t):"bool"===e?this._decodeBool(t):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0]):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t):t.error("unknown tag: "+e)},r.prototype._getUse=function(e,t){var n=this._baseState;return n.useDecoder=this._use(e,t),s(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},r.prototype._decodeChoice=function(e){var t=this._baseState,n=null,r=!1;return Object.keys(t.choice).some(function(i){var a=e.save(),o=t.choice[i];try{var s=o._decode(e);if(e.isError(s))return!1;n={type:i,value:s},r=!0}catch(t){return e.restore(a),!1}return!0},this),r?n:e.error("Choice not matched")},r.prototype._createEncoderBuffer=function(e){return new a(e,this.reporter)},r.prototype._encode=function(e,t,n){var r=this._baseState;if(null===r.default||r.default!==e){var i=this._encodeValue(e,t,n);if(void 0!==i&&!this._skipDefault(i,t,n))return i}},r.prototype._encodeValue=function(e,t,n){var r=this._baseState;if(null===r.parent)return r.children[0]._encode(e,t||new i);var a=null;if(this.reporter=t,r.optional&&void 0===e){if(null===r.default)return;e=r.default}var o=null,s=!1;if(r.any)a=this._createEncoderBuffer(e);else if(r.choice)a=this._encodeChoice(e,t);else if(r.contains)o=this._getUse(r.contains,n)._encode(e,t),s=!0;else if(r.children)o=r.children.map(function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");var r=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var i=n._encode(e[n._baseState.key],t,e);return t.leaveKey(r),i},this).filter(function(e){return e}),o=this._createEncoderBuffer(o);else if("seqof"===r.tag||"setof"===r.tag){if(!r.args||1!==r.args.length)return t.error("Too many args for : "+r.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var c=this.clone();c._baseState.implicit=null,o=this._createEncoderBuffer(e.map(function(n){var r=this._baseState;return this._getUse(r.args[0],e)._encode(n,t)},c))}else null!==r.use?a=this._getUse(r.use,n)._encode(e,t):(o=this._encodePrimitive(r.tag,e),s=!0);var a;if(!r.any&&null===r.choice){var l=null!==r.implicit?r.implicit:r.tag,u=null===r.implicit?"universal":"context";null===l?null===r.use&&t.error("Tag could be ommited only for .use()"):null===r.use&&(a=this._encodeComposite(l,s,u,o))}return null!==r.explicit&&(a=this._encodeComposite(r.explicit,!1,"context",a)),a},r.prototype._encodeChoice=function(e,t){var n=this._baseState,r=n.choice[e.type];return r||s(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),r._encode(e.value,t)},r.prototype._encodePrimitive=function(e,t){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);throw new Error("Unsupported tag: "+e)},r.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},r.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},function(e,t,n){var r=n(215);t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=r._reverse(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=r._reverse(t.tag)},function(e,t,n){var r=t;r.der=n(216),r.pem=n(644)},function(e,t,n){function r(e){o.call(this,e),this.enc="pem"}var i=n(9),a=n(3).Buffer,o=(n(66),n(216));i(r,o),e.exports=r,r.prototype.decode=function(e,t){for(var n=e.toString().split(/[\r\n]+/g),r=t.label.toUpperCase(),i=/^-----(BEGIN|END) ([^-]+)-----$/,s=-1,c=-1,l=0;l<n.length;l++){var u=n[l].match(i);if(null!==u&&u[2]===r){if(-1!==s){if("END"!==u[1])break;c=l;break}if("BEGIN"!==u[1])break;s=l}}if(-1===s||-1===c)throw new Error("PEM section not found for: "+r);var d=n.slice(s+1,c).join("");d.replace(/[^a-z0-9\+\/=]+/gi,"");var p=new a(d,"base64");return o.prototype.decode.call(this,p,t)}},function(e,t,n){var r=t;r.der=n(217),r.pem=n(646)},function(e,t,n){function r(e){a.call(this,e),this.enc="pem"}var i=n(9),a=(n(3).Buffer,n(66),n(217));i(r,a),e.exports=r,r.prototype.encode=function(e,t){for(var n=a.prototype.encode.call(this,e),r=n.toString("base64"),i=["-----BEGIN "+t.label+"-----"],o=0;o<r.length;o+=64)i.push(r.slice(o,o+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}},function(e,t){e.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},function(e,t,n){(function(t){var r=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m,i=/^-----BEGIN (.*) KEY-----\r?\n/m,a=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m,o=n(94),s=n(144);e.exports=function(e,n){var c,l=e.toString(),u=l.match(r);if(u){var d="aes"+u[1],p=new t(u[2],"hex"),f=new t(u[3].replace(/\r?\n/g,""),"base64"),g=o(n,p.slice(0,8),parseInt(u[1],10)).key,m=[],h=s.createDecipheriv(d,g,p);m.push(h.update(f)),m.push(h.final()),c=t.concat(m)}else{var b=l.match(a);c=new t(b[2].replace(/\r?\n/g,""),"base64")}return{tag:l.match(i)[1]+" KEY",data:c}}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e,n,r,o){var s=l(r);if("ec"===s.type){if("ecdsa"!==o)throw new Error("wrong public key type");return i(e,n,s)}if("dsa"===s.type){if("dsa"!==o)throw new Error("wrong public key type");return a(e,n,s)}if("rsa"!==o)throw new Error("wrong public key type");for(var c=s.modulus.byteLength(),d=[1],p=0;n.length+d.length+2<c;)d.push(255),p++;d.push(0);for(var f=-1;++f<n.length;)d.push(n[f]);d=new t(d);var g=u.mont(s.modulus);e=new u(e).toRed(g),e=e.redPow(new u(s.publicExponent)),e=new t(e.fromRed().toArray());var m=0;for(p<8&&(m=1),c=Math.min(e.length,d.length),e.length!==d.length&&(m=1),f=-1;++f<c;)m|=e[f]^d[f];return 0===m}function i(e,t,n){var r=s[n.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var i=new d(r),a=n.data.subjectPrivateKey.data;return i.verify(t,e,a)}function a(e,t,n){var r=n.data.p,i=n.data.q,a=n.data.g,s=n.data.pub_key,c=l.signature.decode(e,"der"),d=c.s,p=c.r;o(d,i),o(p,i);var f=u.mont(r),g=d.invm(i);return!a.toRed(f).redPow(new u(t).mul(g).mod(i)).fromRed().mul(s.toRed(f).redPow(p.mul(g).mod(i)).fromRed()).mod(r).mod(i).cmp(p)}function o(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}var s=n(213),c=n(19),l=n(99),u=n(14),d=c.ec;e.exports=r}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e){this.curveType=s[e],this.curveType||(this.curveType={name:e}),this.curve=new a.ec(this.curveType.name),this.keys=void 0}function i(e,n,r){Array.isArray(e)||(e=e.toArray());var i=new t(e);if(r&&i.length<r){var a=new t(r-i.length);a.fill(0),i=t.concat([a,i])}return n?i.toString(n):i}var a=n(19),o=n(14);e.exports=function(e){return new r(e)};var s={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};s.p224=s.secp224r1,s.p256=s.secp256r1=s.prime256v1,s.p192=s.secp192r1=s.prime192v1,s.p384=s.secp384r1,s.p521=s.secp521r1,r.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},r.prototype.computeSecret=function(e,n,r){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),i(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},r.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(n[n.length-1]%2?n[0]=7:n[0]=6),i(n,e)},r.prototype.getPrivateKey=function(e){return i(this.keys.getPrivate(),e)},r.prototype.setPublicKey=function(e,n){return n=n||"utf8",t.isBuffer(e)||(e=new t(e,n)),this.keys._importPublic(e),this},r.prototype.setPrivateKey=function(e,n){n=n||"utf8",t.isBuffer(e)||(e=new t(e,n));var r=new o(e);return r=r.toString(16),this.keys._importPrivate(r),this}}).call(t,n(3).Buffer)},function(e,t,n){t.publicEncrypt=n(652),t.privateDecrypt=n(653),t.privateEncrypt=function(e,n){return t.publicEncrypt(e,n,!0)},t.publicDecrypt=function(e,n){return t.privateDecrypt(e,n,!0)}},function(e,t,n){(function(t){function r(e,n){var r=e.modulus.byteLength(),i=n.length,a=c("sha1").update(new t("")).digest(),o=a.length,p=2*o;if(i>r-p-2)throw new Error("message too long");var f=new t(r-i-p-2);f.fill(0);var g=r-o-1,m=s(o),h=u(t.concat([a,f,new t([1]),n],g),l(m,g)),b=u(m,l(h,o));return new d(t.concat([new t([0]),b,h],r))}function i(e,n,r){var i=n.length,o=e.modulus.byteLength();if(i>o-11)throw new Error("message too long");var s;return r?(s=new t(o-i-3),s.fill(255)):s=a(o-i-3),new d(t.concat([new t([0,r?1:2]),s,new t([0]),n],o))}function a(e,n){for(var r,i=new t(e),a=0,o=s(2*e),c=0;a<e;)c===o.length&&(o=s(2*e),c=0),(r=o[c++])&&(i[a++]=r);return i}var o=n(99),s=n(72),c=n(61),l=n(218),u=n(219),d=n(14),p=n(220),f=n(146);e.exports=function(e,t,n){var a;a=e.padding?e.padding:n?1:4;var s,c=o(e);if(4===a)s=r(c,t);else if(1===a)s=i(c,t,n);else{if(3!==a)throw new Error("unknown padding");if(s=new d(t),s.cmp(c.modulus)>=0)throw new Error("data too long for modulus")}return n?f(s,c):p(s,c)}}).call(t,n(3).Buffer)},function(e,t,n){(function(t){function r(e,n){var r=(e.modulus,e.modulus.byteLength()),i=(n.length,d("sha1").update(new t("")).digest()),o=i.length;if(0!==n[0])throw new Error("decryption error");var l=n.slice(1,o+1),u=n.slice(o+1),p=c(l,s(u,o)),f=c(u,s(p,r-o-1));if(a(i,f.slice(0,o)))throw new Error("decryption error");for(var g=o;0===f[g];)g++;if(1!==f[g++])throw new Error("decryption error");return f.slice(g)}function i(e,t,n){for(var r=t.slice(0,2),i=2,a=0;0!==t[i++];)if(i>=t.length){a++;break}var o=t.slice(2,i-1);if(t.slice(i-1,i),("0002"!==r.toString("hex")&&!n||"0001"!==r.toString("hex")&&n)&&a++,o.length<8&&a++,a)throw new Error("decryption error");return t.slice(i)}function a(e,n){e=new t(e),n=new t(n);var r=0,i=e.length;e.length!==n.length&&(r++,i=Math.min(e.length,n.length));for(var a=-1;++a<i;)r+=e[a]^n[a];return r}var o=n(99),s=n(218),c=n(219),l=n(14),u=n(146),d=n(61),p=n(220);e.exports=function(e,n,a){var s;s=e.padding?e.padding:a?1:4;var c=o(e),d=c.modulus.byteLength();if(n.length>d||new l(n).cmp(c.modulus)>=0)throw new Error("decryption error");var f;f=a?p(new l(n),c):u(n,c);var g=new t(d-f.length);if(g.fill(0),f=t.concat([g,f],d),4===s)return r(c,f);if(1===s)return i(c,f,a);if(3===s)return f;throw new Error("unknown padding")}}).call(t,n(3).Buffer)},function(e,t,n){"use strict";(function(e,t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){e.module("s3").directive("bucketpermissions",[function(){return{restrict:"E",scope:{access:"=",analyzeAccess:"&",blockPublicAccessSettings:"<?"},template:n(655),controller:"BucketPermissionsController"}}]),e.module("s3").controller("BucketPermissionsController",["$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","PermissionsUtilService","FAC",function(e,n,i,a,o,s,c,l,u,d,p){function f(e){return JSON.stringify(e,null,"    ")}if(e.permissionTypes=[{text:n.instant("permissions.types.acl"),value:c.BUCKET_PERMISSION_TYPE.ACL},{text:n.instant("permissions.types.policy"),value:c.BUCKET_PERMISSION_TYPE.POLICY},{text:n.instant("permissions.types.cors"),value:c.BUCKET_PERMISSION_TYPE.CORS}],e.S3Constants=c,e.policyGenLink=c.BUCKET_PERMISSIONS.POLICY_GEN[u.getCloudSystem()],e.policyDocLink=i.getDocUrl(c.LEARN_MORE_LINKS.PERMISSIONS.POLICY),e.corsDocLink=i.getDocUrl(c.LEARN_MORE_LINKS.PERMISSIONS.CORS),e.isPublicAccessBlockAvailable=p.isFeatureEnabled(c.FAC.PUBLIC_ACCESS_BLOCK),e.isPublicAccessBlockAvailable){var g={text:n.instant("permissions.types.lockdown"),value:c.BUCKET_PERMISSION_TYPE.PUBLIC_ACCESS};e.permissionTypes.unshift(g)}e.permissions={},e.permissions.selectedItem=e.permissionTypes[0],e.bucket=s.getCurrentBucket(),e.bucketARN=u.getBucketARN(e.bucket),e.gettingPolicy=!0,e.isPermissionConfirmationModalOpen={flag:!1},e.permissionConfirmationDetails={},e.gettingCors=!0,e.corsChanged=!1,e.policyChanged=!1,e.accessStatus="",e.corsPlaceholder=c.BUCKET_PERMISSIONS.SAMPLE_CORS_POLICY,e.$watch("blockPublicAccessSettings",function(){if(e.blockPublicAccessSettings&&p.isFeatureEnabled(c.FAC.PUBLIC_ACCESS_BLOCK)){var t=e.blockPublicAccessSettings.accountSettings.blockPublicPolicy||e.blockPublicAccessSettings.accountSettings.restrictPublicBuckets,r=e.blockPublicAccessSettings.bucketSettings.blockPublicPolicy||e.blockPublicAccessSettings.bucketSettings.restrictPublicBuckets;if(t||r){var i=t&&r?"both":t?"account":"bucket";e.blockPublicPolicyMessage=n.instant("lockdown.warning.blocked.policy."+i)}}});var m=function(){var r=arguments.length<=0||void 0===arguments[0]||arguments[0],i=new o("BucketPermissions","getPermissions");l.log("GetBucketPermissions",1,i,{bucketName:e.bucket}),e.errors.acl={},a.getBucketGrantees(e.bucket,i,r).then(function(n){e.permissionObj={},a.getBucketACP(e.bucket,i).then(function(r){var i=t.get(r,"AccessControlList.Grant");e.permissionObj.aclGrants=i?u.transformObjectToArray(i):[];var a=t.get(r,"Owner");e.permissionObj.owner=a,e.permissionObj.grantees=d.updateGrantees(n,a)})}).catch(function(t){var r=t===n.instant("resource.access.denied"),i=n.instant(r?"resource.access.insufficientpermissions":"permissions.error.header"),a=r?n.instant("permissions.acl.bucket.insufficientpermissions",{permission:"s3:GetBucketAcl"}):t;e.errors.acl={header:i,message:a}})};!function(){e.errors={acl:void 0,policy:void 0,cors:void 0}}(),m(),function(){var t=new o("BucketPermissions","getBucketPolicy");e.gettingPolicy=!0,a.getBucketPolicy(e.bucket,t,!1).then(function(t){e.policy=f(t)}).catch(function(t){e.errors.policy=t}).finally(function(){e.gettingPolicy=!1})}(),function(){var t=new o("BucketCors","getBucketCORS");e.gettingCors=!0,a.getBucketCORS(e.bucket,t).then(function(t){e.cors=t?u.formatXml(t):null}).catch(function(t){e.errors.cors=t}).finally(function(){e.gettingCors=!1})}(),e.showView=function(n){var r=t.indexBy(e.permissionTypes,"value");t.has(r,n)&&(e.permissions.selectedItem!==r[n]&&(e.clearErrors(),e.permissions.selectedItem=r[n]),n===c.BUCKET_PERMISSION_TYPE.ACL&&(e.policyAfterAnalysis=void 0))},e.putAcl=function(t){return a.putBucketACL(e.bucket,t,new o("putBucketACL"))},e.save=function(){e.isDeleting||(e.errors.acl={},e.isSaving=!0,"cors"===e.permissions.selectedItem.value?function(){e.errors.cors=void 0;var t=u.formatXml(e.corsEditorSession.getDocument().getValue());e.corsEditorSession.getDocument().setValue(t),a.putBucketCORS(e.bucket,t.trim(),new o("putBucketCORS")).then(function(){e.corsChanged=!1,e.cors=t}).catch(function(t){e.errors.cors=t}).finally(function(){e.isSaving=!1})}():"policy"===e.permissions.selectedItem.value&&function(){e.errors.policy=void 0;var t=e.policyEditorSession.getDocument().getValue();a.putBucketPolicy(e.bucket,t.trim(),new o("putBucketPolicy")).then(function(){e.policyChanged=!1,e.policy=f(JSON.parse(t)),e.policyEditorSession.getDocument().setValue(e.policy),e.analyzeAccess({cacheAllowed:!1}).then(function(){e.policyAfterAnalysis=!0}).finally(function(t){e.isSaving=!1})}).catch(function(t){e.errors.policy=t,e.isSaving=!1})}())},e.onSettingsChange=function(){return m({cacheAllowed:!1}),e.analyzeAccess({cacheAllowed:!1})},e.closePermissionConfirmationModal=function(){e.isPermissionConfirmationModalOpen.flag=!1,e.permissionConfirmationDetails={}},e.displayDeletePermissionConfirmation=function(){var t=e.permissions.selectedItem.value;if("policy"===t)e.permissionConfirmationDetails.warningText=n.instant("confirmationmodal.deletebucketpolicy.bucketpolicywarning"),e.permissionConfirmationDetails.headerTitle=n.instant("confirmationmodal.deletebucketpolicy.bucketpolicytitle");else{if("cors"!==t)return;e.permissionConfirmationDetails.warningText=n.instant("confirmationmodal.deletebucketpolicy.corsconfigwarning"),e.permissionConfirmationDetails.headerTitle=n.instant("confirmationmodal.deletebucketpolicy.corsconfigtitle")}e.isPermissionConfirmationModalOpen.flag=!0},e.deletePermission=function(){e.closePermissionConfirmationModal(),e.isSaving||(e.errors.acl={},e.isDeleting=!0,"cors"===e.permissions.selectedItem.value?(e.errors.cors=void 0,a.deleteBucketCORS(e.bucket,new o("deleteBucketCORS")).then(function(){e.corsEditorSession.getDocument().setValue(""),e.cors=void 0,e.corsChanged=!1}).catch(function(t){e.errors.cors=t}).finally(function(){e.isDeleting=!1})):"policy"===e.permissions.selectedItem.value&&(e.errors.policy=void 0,a.deleteBucketPolicy(e.bucket,new o("deleteBucketPolicy")).then(function(){e.policyEditorSession.getDocument().setValue(""),e.policy=void 0,e.policyChanged=!1,e.analyzeAccess({cacheAllowed:!1}).then(function(){e.policyAfterAnalysis=!0}).finally(function(t){e.isDeleting=!1})}).catch(function(t){e.errors.policy=t,e.isDeleting=!1})))},e.cancel=function(){e.isSaving||e.isDeleting||(e.errors.acl={},"cors"===e.permissions.selectedItem.value?(e.errors.cors=void 0,e.cors?e.corsEditorSession.getDocument().setValue(u.formatXml(e.cors)):e.corsEditorSession.getDocument().setValue(""),e.corsChanged=!1):"policy"===e.permissions.selectedItem.value&&(e.errors.policy=void 0,e.policy?e.policyEditorSession.getDocument().setValue(e.policy):e.policyEditorSession.getDocument().setValue(""),e.policyChanged=!1))},e.clearErrors=function(){e.errors=Object.assign(e.errors,{policy:void 0,cors:void 0})},e.policyEditorLoaded=function(t){e.policyEditorSession=t.getSession(),e.policy&&("object"===r(e.policy)&&(e.policy=f(e.policy)),e.policyEditorSession.getDocument().setValue(e.policy)),e.policyChanged=!1},e.policyEditorChanged=function(t){e.policyChanged=!0},e.corsEditorLoaded=function(t){e.corsEditorSession=t.getSession(),e.cors&&e.corsEditorSession.getDocument().setValue(u.formatXml(e.cors)),e.corsChanged=!1},e.corsEditorChanged=function(){e.corsChanged=!0},e.disableSave=function(){return!!e.isDeleting||("policy"===e.permissions.selectedItem.value?e.policyEditorSession&&""===e.policyEditorSession.getDocument().getValue()||!e.policyChanged:e.corsEditorSession&&""===e.corsEditorSession.getDocument().getValue()||!e.corsChanged)}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div> <div class=permissions-header> <awsui-button-group class=permissions-category-buttons> <awsui-tooltip ng-if=isPublicAccessBlockAvailable id=public-access-button-tooltip text="{{\'permissions.types.tooltip.lockdown\'|translate}}" position=top size=medium> <div class=permissions-access-container> <awsui-button id=permission-public-access-button class=permission-action-button text="{{ \'permissions.types.lockdown\' | translate }} " ng-click=showView(S3Constants.BUCKET_PERMISSION_TYPE.PUBLIC_ACCESS) variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.PUBLIC_ACCESS ? \'primary\' : \'\' }}"></awsui-button> </div> </awsui-tooltip> <awsui-tooltip id=acl-button-tooltip text="{{\'permissions.types.tooltip.acl\'|translate}}" position=top size=medium> <div class=permissions-access-container> <awsui-button id=permission-acl-button class=permission-action-button text="{{ \'permissions.types.acl\' | translate }} " ng-click=showView(S3Constants.BUCKET_PERMISSION_TYPE.ACL) ng-class="{ \'show-public\' : access.aclPublic }" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.ACL ? \'primary\' : \'\' }}"></awsui-button> <div class="access-public-label permission-access-label" ng-if=access.aclPublic translate>world.access.public.label</div> </div> </awsui-tooltip> <awsui-tooltip id=buttonpolicy-button-tooltip text="{{\'permissions.types.tooltip.policy\'|translate}}" position=top size=medium> <div class=permissions-access-container> <awsui-button id=permission-policy-button class=permission-action-button text="{{ (\'permissions.types.policy\' | translate) }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.POLICY ? \'primary\' : \'\' }}" ng-click=showView(S3Constants.BUCKET_PERMISSION_TYPE.POLICY) ng-class="{ \'show-public\' : access.policyPublic }"></awsui-button> <div class="access-public-label permission-access-label" ng-if=access.policyPublic translate>world.access.public.label</div> </div> </awsui-tooltip> <awsui-tooltip text="{{\'permissions.types.tooltip.cors\'|translate}}" position=top size=medium> <awsui-button id=permission-cors-button class=permission-action-button text="{{ \'permissions.types.cors\' | translate }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.CORS ? \'primary\' : \'\' }}" ng-click=showView(S3Constants.BUCKET_PERMISSION_TYPE.CORS)></awsui-button> </awsui-tooltip> </awsui-button-group> </div> <awsui-alert visible="access.policyPublic && policyAfterAnalysis" class="block small-top-margin" type=warning dismissible=false header="{{ \'bucket.warningheader.granted.AllUsers\' | translate }}"> {{ \'world.access.detected.warning\' | translate }} </awsui-alert> <div class=permissions-container ng-switch=permissions.selectedItem.value> <awsui-alert ng-if="permissions.selectedItem.value===\'acl\'" id=aclErrorAlert visible=errors.acl.message class="block permissions-error small-top-margin" type=error dismissible=false header="{{ errors.acl.header }}"> {{ errors.acl.message }} </awsui-alert> <awsui-alert ng-if="permissions.selectedItem.value===\'policy\'" id=policyErrorAlert visible=errors.policy class="block permissions-error small-top-margin" type=error dismissible=false header="{{ \'permissions.error.header\' | translate }}"> {{ errors.policy }} </awsui-alert> <awsui-alert ng-if="permissions.selectedItem.value===\'cors\'" id=corsErrorAlert visible=errors.cors class="block permissions-error small-top-margin" type=error dismissible=false header="{{ \'permissions.error.header\' | translate }}"> {{ errors.cors }} </awsui-alert> <table class=editor-header> <tr> <td ng-switch-when=policy> <div class=description-container> <span class=ace-editor-title>{{ \'permissions.policy.header\' | translate}} </span> <span translate=permissions.label.bucketarn></span> <span>{{bucketARN}}</span> <div class=ace-editor-description translate=permissions.policy.description></div> </div> </td> <td ng-switch-when=cors class=permissions-editor> <div class=description-container> <span class=ace-editor-title>{{ \'permissions.cors.header\' | translate}} </span> <span translate=permissions.label.bucketarn></span> <span> {{ bucketARN }}</span> <div class=ace-editor-description translate=permissions.cors.description></div> </div> </td> <td class=editor-buttons ng-if="permissions.selectedItem.value===\'policy\' || permissions.selectedItem.value===\'cors\'"> <awsui-button id=delete variant=normal text="{{ \'permissions.button.delete\' | translate }}" class="awsui-util normal-button" click=displayDeletePermissionConfirmation() loading=isDeleting data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policy|| permissions.selectedItem.value===\'cors\' && !cors)"> </awsui-button> <awsui-button id=cancel variant=normal text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button" click=cancel() data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policyChanged || permissions.selectedItem.value===\'cors\' && !corsChanged)"> </awsui-button> <awsui-button id=save-code variant=primary text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button" click=save() loading=isSaving data-disabled=disableSave()> </awsui-button> </td> </tr> </table> <div ng-if="permissions.selectedItem.value===\'policy\'" class=permissions-editor> <div ng-if=gettingPolicy class=editor-spinner-container> <span class="awsui-spinner awsui-spinner-large"></span> </div> <awsui-alert ng-if=blockPublicPolicyMessage type=warning id=blockPublicPolicyAlert>{{blockPublicPolicyMessage}}</awsui-alert> <div id=policy-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded, onChange: policyEditorChanged }" class=code ng-if=!gettingPolicy> </div> <table class=editor-docs-button> <tr> <td> <awsui-button id=documentation variant=link text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target=_blank href={{policyDocLink}}> </awsui-button> </td> <td> <awsui-button id=policy-generator variant=link text="{{ \'permissions.button.policygenerator\' | translate }}" class="awsui-util link-button" target=_blank href={{policyGenLink}}> </awsui-button> </td> </tr> </table> </div> <div ng-if="permissions.selectedItem.value===\'cors\'" class=permissions-editor> <div ng-if=gettingCors class=editor-spinner-container> <span class="awsui-spinner awsui-spinner-large"></span> </div> <code-editor id=cors-editor class=code ng-if=!gettingCors on-load=corsEditorLoaded(editor) on-change=corsEditorChanged() placeholder="{{ corsPlaceholder }}" mode=xml></code-editor> <div class=editor-docs-button> <awsui-button id=cors-documentation variant=link text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target=_blank href={{corsDocLink}}> </awsui-button> </div> </div> <div ng-switch-when=public-access ng-if=isPublicAccessBlockAvailable class=permissions-editor> <public-access-settings-panel bucket=bucket on-settings-change=onSettingsChange()></public-access-settings-panel> </div> <div ng-switch-when=acl> <acl permission-obj=permissionObj put-acl=putAcl error=errors.acl.message bucket=bucket is-bucket-permission=true access=access analyze-access="analyzeAccess({cacheAllowed : cacheAllowed})" block-public-access-settings=blockPublicAccessSettings></acl> </div> <div class=confirmation-modal ng-if=isPermissionConfirmationModalOpen.flag> <dialog-modal class="bucket-confirmation-modal small" is-open=isPermissionConfirmationModalOpen close-callback=closeConfirmationModal() header-title=permissionConfirmationDetails.headerTitle> <dialog-modal-content> <awsui-alert class=confirmation-warning type=warning dismissable=false> <span ng-bind-html="permissionConfirmationDetails.warningText | trusted"></span> </awsui-alert> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=cancel text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant=normal click=closePermissionConfirmationModal()></awsui-button> <awsui-button id=confirm-bucket-permission-delete variant=primary text="{{\'events.button.delete\' | translate}}" class="awsui-util-f-r primary-button" click=deletePermission()></awsui-button> </dialog-modal-footer> </dialog-modal> </div> </div> </div> '},function(e,t,n){"use strict";(function(e,t,r){!function(){e.module("s3").directive("dropdown",function(){return{restrict:"E",controller:"DropdownController",scope:{items:"=",selectedItem:"=",filter:"=",placeholder:"@",disabled:"=?",enableInput:"=?",inputField:"=?",dropdownDisabled:"=?",customInput:"=?",change:"&?"},template:n(657)}}),e.module("s3").controller("DropdownController",["$filter","$scope","S3Constants","$translate","$window","UtilService",function(n,i,a,o,s,c){i.filterColumn="text",i.tableFiltering={filter:{}},i.getDisplayWidth=function(){return 10*parseInt(t("#current-displayed-table").width()/10)*.9},e.element(s).on("resize",function(){t(".truncate-dropdown").css({width:i.getDisplayWidth()})}),i.placeholder||(i.selectedItem=i.items[0]),i.$watch("selectedItem",function(e,t){e===t||e||(i.tableFiltering.filter={})}),i.tableFiltering.filter[i.filterColumn]=i.defaultFilterValue,i.updateInput=function(e){i.selectedItem=e,e.error=null,i.change&&i.change()},i.filterBlur=function(){i.tableFiltering.filter[i.filterColumn]||(i.tableFiltering.showClear=!1)},i.addCustomInput=function(e){e.stopPropagation(),r.isEmpty(i.tableFiltering.filter[i.filterColumn])||(i.selectedItem={value:i.tableFiltering.filter[i.filterColumn],text:i.tableFiltering.filter[i.filterColumn]},i.change&&i.change()),i.closeDropDown()},i.clearFilter=function(){i.tableFiltering.filter[i.filterColumn]="",i.tableFiltering.showClear=!1},i.filterKeyDown=function(e){e&&e.keyCode===a.KEY_CODES.ESC&&(t(".input-field").blur(),i.clearFilter())},i.$watch(function(){return i.tableFiltering.filter[i.filterColumn]},function(e,t){t!==e&&(i.totalItems=n("filter")(i.items,i.tableFiltering.filter).length)}),i.toggleDropDown=function(e){e||(i.isOpen=!i.isOpen,i.isOpen&&!i.dropdownDisabled&&c.scrollTo("current-displayed-table"))},i.closeDropDown=function(){i.isOpen=!1},i.selectItem=function(e){e.disabled||(i.selectedItem=r.cloneDeep(e),i.enableInput&&i.inputField&&(i.inputField.text=e.text||e,i.inputField.error=null),i.selectedItem.displayTextField&&(i.selectedItem.inputValue=i.selectedItem.value),i.closeDropDown(),i.change&&i.change())},i.toggleBucket=function(e,t){t.isExpanded=!t.isExpanded,e.stopPropagation()}}])}()}).call(t,n(0),n(6),n(2))},function(e,t){e.exports='<div id=dropdown class=dropdown clickoutside on-click-outside=closeDropDown> <table id=current-displayed-table class="awsui-select-target current-displayed" ng-class="{\'dropdown-disabled\' : disabled}" ng-click=toggleDropDown(disabled)> <tr ng-if="!selectedItem.displayTextField && !enableInput" class=current-displayed-row ng-class="{\'dropdown-disabled\' : disabled, \'item-selected\' : selectedItem && !disabled, \'item-not-selected\': (!selectedItem || selectedItem.error || selectedItem.inputError) && !disabled}"> <td class=current-displayed-item ng-class="{ \'disabled-text\': disabled }"><div class=truncate-dropdown ng-style="{\'width\':getDisplayWidth()}">{{ selectedItem.error || selectedItem.inputError ? placeholder : selectedItem.text || selectedItem || placeholder }}</div></td> </tr> <tr class=current-displayed-row ng-class="{\'dropdown-disabled\' : disabled, \'item-selected\' : selectedItem, \'item-not-selected\': !selectedItem}" ng-if=enableInput> <td> <awsui-textfield class=dropdown-inputfield name=inputValidation ng-model=inputField.text ng-change=updateInput(inputField) ng-click=$event.stopPropagation();></awsui-textfield> </td> </tr> <tr class=current-displayed-row ng-class="{\'dropdown-disabled\' : disabled}" ng-if=selectedItem.displayTextField> <td class=dropdown-input-td> <awsui-textfield class=dropdown-inputfield data-disabled=disabled ng-model=selectedItem.inputValue ng-change=updateInput(selectedItem) placeholder="{{ selectedItem.value }}" ng-click=$event.stopPropagation();></awsui-textfield> </td> </tr> </table> <div class=list-items ng-class="{\'dropdown-no-filter\' : !filter}" ng-if=isOpen> <table ng-if=filter id=search-box class=search-box> <tr> <td class=dropdown-search-inputtext><input type=text class=input-field ng-model=tableFiltering.filter[filterColumn] ng-keydown=filterKeyDown($event) placeholder="{{ customInput.customPlaceHolderText || \'dropdown.inputfield.placeholder\' | translate }}"></td> <td><i class="awsui-icon search"></i></td> </tr> </table> <div class=item ng-class="{\'item-disabled\' : item.disabled}" ng-repeat="item in items | filter:tableFiltering.filter | orderBy:[\'pinnedTop\', \'text || toString()\'] " ng-click=selectItem(item)> <div class=list-item>{{item.text || item}} <div class=list-item-comment ng-if=item.comment>{{ item.comment }}</div> </div> <div class=list-item-count ng-if=item.count>{{ item.count }}</div> </div> <span class=no-matches-found ng-if="((items | filter:tableFiltering.filter).length == 0)" translate=dropdown.nomatchesfound></span> <div class="no-matches-found custominput" ng-if="((items | filter:tableFiltering.filter).length == 0) && customInput.isEnabled" ng-click=addCustomInput($event)>{{customInput.text}}</div> </div> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("versionsDropdown",function(){return{restrict:"E",controller:"VersionsDropdownController",scope:{selectedTab:"=?",bucket:"=",error:"=",getMetadata:"&?",setUpMetadata:"&?",key:"=",obj:"=",showVersionsDropdown:"=",objectsPage:"=?",updateObjMetadata:"&?",updateObjAcl:"&?",refresh:"&?",objectPropertiesPanel:"=?",tabs:"=?",versions:"=?",versionsDropdownSelectedObject:"=?",onSwitchVersion:"&?"},template:n(659)}}),e.module("s3").controller("VersionsDropdownController",["$filter","$scope","$window","$location","$translate","CachingService","ConsoleOperation","DeleteService","ObjectPropertiesService","S3Constants","S3CWSAPIService","SCLogService","UtilService",function(n,r,i,a,o,s,c,l,u,d,p,f,g){r.dateFormat=d.DATE_FORMAT,r.closeDropdown=function(){r.showVersionsDropdown.show=!1},r.deleteVersion=function(e,n){if(e.stopPropagation(),n&&n.Key&&!n.deleteDisabled){var i=new c("DeleteVersion");l.deleteKeysAndVersions(i,[{Key:n.Key,VersionId:n.VersionId}],{}).then(function(e){var a="true"===n.IsLatest,o=r.versions.length,c=Object.keys(e.result).length;r.versions=t.filter(r.versions,function(t){var n=e.result[t.Key+":"+t.VersionId];return(n?n.status:"")!==d.OPERATION_PER_KEY_STATUS.DONE}),1!==c?f.log(i.name+"MoreThanOne",1,i,e.result):r.versions.length!==o-c&&f.log(i.name+"AlreadyDeleted",1,i,e.result),s.setCurrentVersions(r.bucket,n.Key,r.versions),r.objectsPage&&(t.isEmpty(r.versions)||a)&&(r.refresh(),r.objectPropertiesPanel.show=!1)}).catch(function(e){r.error=e})}},r.downloadVersion=function(e,t){if(e.stopPropagation(),!t.downloadDisabled){var n={"Content-Disposition":"attachment"},a=new c("objectDownload","objDLPresignFetchStart");p.fetchPresignedUrl(r.bucket,t.Key,"GET",n,{versionId:t.VersionId},null,null,a).then(function(e){i.location.href=e.data.presignedUrl,f.log("fetchPresignedUrl",1,a,{bucket:r.bucket,key:t.Key})}).catch(function(e){f.log("fetchPresignedUrl",0,a,e),r.error=e})}},r.switchVersion=function(i,l){var u=new c(d.OPERATION_NAME.SWITCH_VERSION);if(i.stopPropagation(),f.log(d.OPERATION_NAME.SWITCH_VERSION,1,u,{version:l}),l.ETag&&!r.objectsPage&&r.getMetadata({operation:u,versionId:l.VersionId}),r.objectsPage||a.search(d.VERSION_ID_PARAM,l.VersionId),r.obj.VersionId=l.VersionId,r.obj.ETag=g.extractFromQuotes(l.ETag),r.obj.IsLatest=l.IsLatest,r.obj.Key=l.Key,-1!==r.obj.Key.lastIndexOf("/")&&(r.obj.Key=r.obj.Key.substring(r.obj.Key.lastIndexOf("/")+1)),r.obj.LastModified=l.LastModified,r.obj.Owner=l.Owner,r.obj.Size=l.Size,r.obj.StorageClass=d.STORAGE_CLASSES[l.StorageClass],r.obj.versionLabel="true"===l.IsLatest?o.instant("versionsdropdown.label.latestVersion"):n("date")(l.LastModified,r.dateFormat),r.showVersionsDropdown.show=!1,r.selectedTab&&(r.selectedTab=d.TABS.OBJECT_LIST.OVERVIEW),t.isEmpty(r.obj.ETag)||s.setCurrentObject(r.obj),r.versionsDropdownSelectedObject=t.cloneDeep(l),r.objectsPage){var p=e.copy(r.obj);r.setUpMetadata({obj:p}),r.updateObjAcl({obj:p}),r.updateObjMetadata({obj:p})}"function"==typeof r.onSwitchVersion&&r.onSwitchVersion({obj:r.obj})},t.isEmpty(r.versions)&&function(){var e=new c(d.OPERATION_NAME.LIST_VERSIONS);u.listVersions(r.bucket,r.key,e).then(function(t){r.versions=t,r.obj.versionId=t&&t[0]&&t[0].VersionId,f.log("ListVersionsCompleted",1,e,{objectKey:r.key,versions:t})}).catch(function(t){r.error=t,e.error=t,e.errorMessage=o.instant("versionsdropdown.errorMessage"),f.log("ListVersionsCompleted",0,e,t)})}()}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=versions-dropdown ng-class="{\'objects-side-panel-versions\': objectsPage}" ng-if="showVersionsDropdown.show == true" clickoutside on-click-outside=closeDropdown> <table> <tr class=version-row ng-repeat="version in versions track by version.VersionId" ng-click="switchVersion($event, version)"> <td class=version-file-icon><span class="awsui-icon awsui-icon-big" ng-class=version.fileIconClass></span></td> <td class=version-date> {{version.LastModified | date: dateFormat}} <span class=date-subtext ng-if="version.IsLatest === \'true\' && version.ETag"> (<span translate=versionsdropdown.label.latestVersion></span>) </span> <span class=date-subtext ng-if=!version.ETag> (<span translate=versionsdropdown.label.deleteMarker></span>) </span> </td> <td class=version-storage-class>{{version.StorageClass}}</td> <td class=version-download-icon> <span class="awsui-icon awsui-icon-big download" ng-class="{\'awsui-icon-link\':!version.downloadDisabled, \'awsui-icon-disabled\':version.downloadDisabled}" ng-click="downloadVersion($event, version)"></span> </td> <td class=version-delete-icon><span class="awsui-icon awsui-icon-big trash-o" ng-class="{\'awsui-icon-link\':!version.deleteDisabled, \'awsui-icon-disabled\':version.deleteDisabled}" ng-click="deleteVersion($event, version)"></span></td> </tr> </table> </div>'},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("editor",[function(e,t){return{restrict:"AE",scope:{code:"=",mode:"=",readonly:"=",onLoad:"&"},template:n(661),link:{pre:function(n,r,i){e.fullscreen=!1,n.theme="dawn";var a=function(e,t){n.editor.setTheme("ace/theme/"+e)};n.toggleFullscreen=function(r){e.fullscreen=!e.fullscreen,r&&n.$apply(),t(function(){n.editor.resize()})},n.themes=["cobalt","dawn","eclipse","monokai","solarized_dark"].map(function(e){return{value:e,text:window.messages.ide.theme[e]}}),n.modals={settings:{open:!1}},n.saveSettings=function(){n.theme=n.modals.settings.theme,a(n.theme),n.modals.settings.open=!1},n.aceLoaded=function(e){n.editor=e,e.$blockScrolling=1/0,e.resize(!0),t(function(){a(n.theme)}),n.onLoad({editor:n.editor})}},post:function(e){e.$watch("mode",function(){e.mode&&e.editor.session.setMode("ace/mode/"+e.mode)}),e.$watch("readonly",function(){e.editor.setReadOnly(e.readonly)})}}}}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=ide-container> <div id=editor class=ide ng-class=\"{ 'editor-large': large, 'readonly': readonly }\" ng-model=code ui-ace=\"{theme: 'dawn', mode: 'javascript', fontSize: 14, onLoad: aceLoaded}\"> </div> </div> "},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("OperationDispatcherService",["PathService","$interval","ConsoleOperation","S3Constants","SCLogService","APIProxyService",function(e,t,n,r,i,a){var o=20,s=5,c={},l={},u=[];this.addOperation=function(e){for(var t in l)i.log("HaveConflictingOperation",this.isConflict(l[t],e)?1:0,e,{},Date());c[e.id]=e,e.finishCallBack||(e.finishCallBack=this.operationDoneCallBack),e.errorCallBack=this.operationErrorCallBack,d(e)?(l[e.id]=e,e.state=r.OPERATION_STATE.ACTIVE,i.log(r.OPERATION_MANAGER_LOGGING.STARTED,1,e),e.start()):(e.state=r.OPERATION_STATE.WAITING,i.log(r.OPERATION_MANAGER_LOGGING.ENQUEUED,1,e),u.push(e)),i.log(r.OPERATION_MANAGER_LOGGING.ADDED,1,e)},this.getOngoingOperations=function(){return l},this.getWaitingOperations=function(){return u},this.getOperationById=function(e){return c[e]},this.getAllOperations=function(){return c},this.getOperationsWithState=function(e,t){for(var n in c)c[n].state===e&&t.push(c[n])};var d=function(e){if(Object.keys(l).length<o){if(e.initialBucket){var t={};a.getBucketLocation(e,e.initialBucket,t);var n=t.region,r=0;for(var i in l){var c={};a.getBucketLocation(e,l[i].initialBucket,c),c.region===n&&(r+=1)}return r<s}return!0}return!1};this.operationDoneCallBack=function(e){c[e].state!==r.OPERATION_STATE.COMPLETED&&(c[e].state=r.OPERATION_STATE.COMPLETED,c[e].defer.resolve(c[e].errorDetails),i.log(r.OPERATION_MANAGER_LOGGING.COMPLETED,1,c[e]),delete l[e],p())},this.operationErrorCallBack=function(e){c[e].state=r.OPERATION_STATE.ERROR,c[e].defer.reject(c[e].errorDetails),i.log(r.OPERATION_MANAGER_LOGGING.ERROR,1,c[e]),delete l[e],p()},this.cancelOperation=function(e){if(e.id in l)delete l[e.id],p(),e.cancel(),e.state=r.OPERATION_STATE.CANCEL;else{if(e.state===r.OPERATION_STATE.WAITING){e.cancel();for(var t=0;t<u.length;t++)if(u[t]===e){u.splice(t,1);break}}delete c[e.id]}i.log(r.OPERATION_MANAGER_LOGGING.CANCELED,1,e)};var p=function(){for(var e=0;e<u.length;e++)if(d(u[e])){var t=u[e];t.state=r.OPERATION_STATE.ACTIVE,i.log(r.OPERATION_MANAGER_LOGGING.DEQUEUED,1,t),l[t.id]=t,u.splice(e,1),t.start(),i.log(r.OPERATION_MANAGER_LOGGING.STARTED,1,t);break}};this.isConflict=function(e,t){return void 0!==e.initialBucket&&void 0!==t.initialBucket&&e.initialBucket===t.initialBucket&&(e.initialPath.length>t.initialPath.length?e.initialPath.lastIndexOf(t.initialPath)>=0:t.initialPath.lastIndexOf(e.initialPath)>=0)},this.setMaximumOngoingOperation=function(e){o=e},this.setMaximumOngoingOperationsPerRegion=function(e){s=e}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").service("BulkOperationService",["$translate","ConsoleOperation","SCLogService","BucketPropertiesService","S3Constants","ObjectListingService","OperationDispatcherService","APIProxyService","$q","DeleteService","CopyService","OperationUtilService","$routeParams","UtilService","CountService","PublicAccessService",function(r,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v){function E(t,n,r,c,l){if(0===n.length&&0===r.length)throw"No keys or folders were passed in for "+t+" operation";var u=new i(t);return u.displayName=B[u.name],u.selectedKeys=e.copy(n),N(u)?(u.totalObjectCount=u.selectedKeys.length,u.selectedFolders=[]):(u.totalObjectCount=c,u.selectedKeys.forEach(function(e){e.Key=e.Path?e.Path+e.Key:u.initialPath+e.Key}),u.selectedFolders=e.copy(r),P(u)||(u.selectedFolders.forEach(function(e){e.Prefix=u.initialPath+e.Prefix+s.DELIMITER}),u.selectedFolders.length>0&&(u.originFolders=e.copy(r)))),u.totalOperatedObjectCount=0,u.start=function(){var e=u.additionalInfo?u.additionalInfo:l,r=d.resolve();(P(u)||[s.OPERATION_NAME.DELETE_OBJECTS,s.OPERATION_NAME.RESTORE_OBJECTS].includes(u.name))&&(r=r.then(function(){return o.isObjectRetentionEnabled(u.initialBucket,u)}).catch(function(){return!1}).then(function(t){return e.bucketObjectLockEnabled=t}));var i=function(e){return U.updateUIWithSuccessResponse(e)},c=function(e){return U.updateUIWithError(e)},p=function(e){return U.updateProgress(e)},f=function(){if(u.selectedKeys.length>0)for(var r=0;r<n.length/e.numberOfKeysPerBulkOperation;r++)j[t](u,u.selectedKeys.slice(r*e.numberOfKeysPerBulkOperation,(r+1)*e.numberOfKeysPerBulkOperation),e).then(i,c,p);u.selectedFolders.length>0&&U.listAndOperateObjectsRecursively(u,null,e)};r.then(function(){P(u)?(u.parameters.isCountingObjectsInProgress=!0,u.parameters.isDeleteBucketInProgress=!0,b.generateCountForOperation(u,I(u,e)).then(function(){u.parameters.isCountingObjectsInProgress=!1,u.totalObjectCount=u.keyCount,a.log(u.name.replace(/\s/g,"")+"CountingObjects",1,u),f()}).catch(function(e){a.log(u.name.replace(/\s/g,"")+"CountingObjects",0,u,e),U.updateUIWithError({operation:u,result:e})})):N(u)?S(u,e):f()})},u.cancel=function(){P(u)&&(u.parameters.isDeleteBucketInProgress=!1,u.parameters.isCountingObjectsInProgress=!1),u.state=s.OPERATION_STATE.CANCEL},u.finishCallBack=U.getOperationCompleteCallBack(u),a.log(t.replace(/\s/g,"")+"OperationCreated",1,u),u}function S(e,t){if(e.totalOperatedObjectCount>=e.totalObjectCount)return void U.completeOperation(e);var n=e.selectedKeys.slice(e.totalOperatedObjectCount,e.totalOperatedObjectCount+s.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API);j[e.name](e,n,t).then(function(n){U.updateUIWithSuccessResponse({operation:e,result:n}),S(e,t)}).catch(function(t){return U.updateUIWithError({operation:e,error:t})})}function y(e,t,n){if(!t&&e.state===s.OPERATION_STATE.ACTIVE||t.truncated&&e.state===s.OPERATION_STATE.ACTIVE)c.getBatchOfItems(e,t?t.marker:null,n.numberOfKeysPerBulkOperation,!1,I(e,n),t?t.versionIdMarker:null,e.selectedFolders,null).then(function(t){a.log(e.name.replace(/\s/g,"")+"FolderListing",1,e,t),t.keys.length>0?j[e.name](e,t.keys,n).then(function(r){U.updateUIWithSuccessResponse(r),U.listAndOperateObjectsRecursively(e,t,n)},function(e){U.updateUIWithError(e)},function(e){U.updateProgress(e)}):U.completeOperation(e)}).catch(function(t){a.log(e.name.replace(/\s/g,"")+"FolderListing",0,e,t),U.updateUIWithError({operation:e,result:t})});else{if(e.state===s.OPERATION_STATE.CANCEL)return;U.completeOperation(e)}}function A(e){var t=e.operation,n=e.result;if(e.updateType===s.OPERATION_PROGRESS_UPDATE_TYPE.SINGLE_PART_RESULTS)t.totalOperatedObjectCount+=Object.keys(n).length,F[t.name](e),U.populateErrorDetails(t,n);else if(e.updateType===s.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_RESULT||e.updateType===s.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE)t.successPercentage+=n/t.totalSizeInBytes*100,t.progressPercentage=t.successPercentage+t.errorPercentage,e.updateType===s.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE&&(t.succeedKeyCount+=1,t.totalOperatedObjectCount+=1);else if(e.updateType===s.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR){t.errorPercentage+=n/t.totalSizeInBytes*100,t.progressPercentage=t.successPercentage+t.errorPercentage,t.failedKeyCount+=1,t.totalOperatedObjectCount+=1;var r={};r[e.keys[0]]={status:s.OPERATION_PER_KEY_STATUS.ERROR,errorMessage:e.error},U.populateErrorDetails(t,r)}e.isLastOne&&e.notifyDefer.resolve(e),t.totalOperatedObjectCount===t.totalObjectCount&&0===t.selectedFolders.length&&U.completeOperation(t)}function C(e){if(e.updateType!==s.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ALL_COMPLETE){var t=e.operation,n=e.result;t.totalOperatedObjectCount+=Object.keys(n).length,F[t.name](e),U.populateErrorDetails(t,n),t.totalOperatedObjectCount===t.totalObjectCount&&0===t.selectedFolders.length&&U.completeOperation(t)}}function _(e){var t=e.operation,n=e.keys,r=e.result,i=0,a=0;if(0===t.totalSizeInBytes)return void U.updateOperationProgressBasedOnFileCount(e);Object.keys(r).forEach(function(e){r[e].status===s.OPERATION_PER_KEY_STATUS.DONE?(t.succeedKeyCount+=1,n.forEach(function(t){t.Key===e&&(i+=t.Size)})):(t.failedKeyCount+=1,n.forEach(function(t){t.Key===e&&(a+=t.Size)}))}),t.defer.notify(),t.successPercentage+=i/t.totalSizeInBytes*100,t.errorPercentage+=a/t.totalSizeInBytes*100,t.progressPercentage=t.successPercentage+t.errorPercentage}function w(e){var t=e.operation,n=e.result;Object.keys(n).forEach(function(e){n[e].status===s.OPERATION_PER_KEY_STATUS.DONE?t.succeedKeyCount+=1:t.failedKeyCount+=1}),t.defer.notify(),t.progressPercentage=t.totalOperatedObjectCount/t.totalObjectCount*100,t.successPercentage=t.succeedKeyCount/t.totalObjectCount*100,t.errorPercentage=t.failedKeyCount/t.totalObjectCount*100}function T(e){e.state!==s.OPERATION_STATE.COMPLETED&&(P(e)&&(e.totalObjectCount=e.totalOperatedObjectCount,0===e.totalObjectCount?e.errorPercentage=0:e.errorPercentage=e.failedKeyCount/e.totalObjectCount*100,e.errorTypes.forEach(function(t){t.errorPercentage=Number(t.errorCount/e.totalObjectCount*100).toFixed(2)})),e.successPercentage=Number(100-e.errorPercentage).toFixed(2),e.progressPercentage=100,a.log(e.name.replace(/\s/g,"")+"Success",1,e),0===e.errorPercentage?e.parameters.operationSuccessful=!0:0===e.successPercentage?e.parameters.operationUnsuccessful=!0:e.parameters.operationPartiallySuccessful=!0,0!==e.errorPercentage?(e.parameters.isDeleteBucketInProgress=!1,e.parameters.isCountingObjectsInProgress=!1,e.errorCallBack(e.id)):e.finishCallBack(e.id))}function R(e){var t=e.operation;t.defer.notify(),a.log(t.name.replace(/\s/g,"")+"Success",0,t,e),t.errorPercentage=100-t.progressPercentage,P(t)&&(t.parameters.isDeleteBucketInProgress=!1,t.parameters.isCountingObjectsInProgress=!1),t.errorCallBack(t.id)}function O(e){return e.name===s.OPERATION_NAME.DELETE_BUCKET?function(){u.deleteBucket(e).then(function(){e.parameters.isDeleteBucketSuccessful=!0,e.parameters.isDeleteBucketInProgress=!1,e.parameters.isCountingObjectsInProgress=!1,a.log("DeleteBucketRequest",1,e),l.operationDoneCallBack(e.id)}).catch(function(t){e.parameters.isDeleteBucketSuccessful=!1,e.parameters.isDeleteBucketInProgress=!1,e.parameters.isCountingObjectsInProgress=!1,a.log("DeleteBucketRequest",0,e,t),e.errorMessage=h.handleErrors(t),l.operationErrorCallBack(e.id)})}:e.finishCallBack}function k(e,n){Object.keys(n).forEach(function(r){n[r].status!==s.OPERATION_PER_KEY_STATUS.DONE&&function(){var i=n[r].errorMessage,a=t.filter(e.errorTypes,function(e){return e.errorMessage===i});0===a.length?e.errorTypes.push({errorMessage:i,errorCount:1,errorPercentage:Number(1/e.totalObjectCount*100).toFixed(2)}):(a[0].errorCount+=1,a[0].errorPercentage=Number(a[0].errorCount/e.totalObjectCount*100).toFixed(2)),e.errorDetails[i]?e.errorDetails[i].length<s.BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE&&e.errorDetails[i].push(r):e.errorDetails[i]=[r]}()})}function I(e,t){return!!h.convertStringToBoolean(m[s.SHOW_VERSION_PARAM])||(e.name===s.OPERATION_NAME.EMPTY_BUCKET||e.name===s.OPERATION_NAME.DELETE_BUCKET)&&("Enabled"===t.versioning||"Suspended"===t.versioning)}function P(e){return e.name===s.OPERATION_NAME.EMPTY_BUCKET||e.name===s.OPERATION_NAME.DELETE_BUCKET}function N(e){return e.name===s.OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS_BATCH}function M(){return j}var L,x,D,j=(L={},n(L,s.OPERATION_NAME.DELETE_OBJECTS,p.deleteKeysAndVersions),n(L,s.OPERATION_NAME.RESTORE_OBJECTS,p.deleteKeysAndVersions),n(L,s.OPERATION_NAME.EMPTY_BUCKET,p.deleteKeysAndVersions),n(L,s.OPERATION_NAME.DELETE_BUCKET,p.deleteKeysAndVersions),n(L,s.OPERATION_NAME.MAKE_PUBLIC,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.COPY,f.copyObjects),n(L,s.OPERATION_NAME.CUT,f.copyObjects),n(L,s.OPERATION_NAME.RENAME,f.copyObjects),n(L,s.OPERATION_NAME.CHANGE_SSE,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.CHANGE_STORAGE_CLASS,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.CHANGE_METADATA,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.INITIATE_RESTORE,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.ADD_OBJECT_TAG,g.defaultCWSBulkOperationCaller),n(L,s.OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS_BATCH,v.putBucketSettings),L),B=(x={},n(x,s.OPERATION_NAME.DELETE_OBJECTS,r.instant("operationname.deleteobjects")),n(x,s.OPERATION_NAME.RESTORE_OBJECTS,r.instant("operationname.undodelete")),n(x,s.OPERATION_NAME.EMPTY_BUCKET,r.instant("operationname.emptybucket")),n(x,s.OPERATION_NAME.DELETE_BUCKET,r.instant("operationname.deletebucket")),n(x,s.OPERATION_NAME.MAKE_PUBLIC,r.instant("operationname.makepublic")),n(x,s.OPERATION_NAME.COPY,r.instant("operationname.copy")),n(x,s.OPERATION_NAME.CUT,r.instant("operationname.cut")),n(x,s.OPERATION_NAME.RENAME,r.instant("operationname.rename")),n(x,s.OPERATION_NAME.CHANGE_SSE,r.instant("operationname.changesse")),n(x,s.OPERATION_NAME.CHANGE_STORAGE_CLASS,r.instant("operationname.changestorageclass")),n(x,s.OPERATION_NAME.CHANGE_METADATA,r.instant("operationname.changemetadata")),n(x,s.OPERATION_NAME.INITIATE_RESTORE,r.instant("operationname.initiaterestore")),n(x,s.OPERATION_NAME.ADD_OBJECT_TAG,r.instant("operationname.addtags")),n(x,s.OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS_BATCH,r.instant("bucketactionstrip.editlockdown")),x),F=(D={},n(D,s.OPERATION_NAME.DELETE_OBJECTS,w),n(D,s.OPERATION_NAME.RESTORE_OBJECTS,w),n(D,s.OPERATION_NAME.EMPTY_BUCKET,w),n(D,s.OPERATION_NAME.DELETE_BUCKET,w),n(D,s.OPERATION_NAME.MAKE_PUBLIC,w),n(D,s.OPERATION_NAME.COPY,_),n(D,s.OPERATION_NAME.CUT,_),n(D,s.OPERATION_NAME.RENAME,_),n(D,s.OPERATION_NAME.CHANGE_SSE,_),n(D,s.OPERATION_NAME.CHANGE_STORAGE_CLASS,_),n(D,s.OPERATION_NAME.CHANGE_METADATA,_),n(D,s.OPERATION_NAME.INITIATE_RESTORE,w),n(D,s.OPERATION_NAME.ADD_OBJECT_TAG,w),n(D,s.OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS_BATCH,w),D),U={createBulkOperation:E,listAndOperateObjectsRecursively:y,updateUIWithSuccessResponse:C,populateErrorDetails:k,completeOperation:T,updateUIWithError:R,getOperationAPIMap:M,getOperationCompleteCallBack:O,shouldListVersion:I,updateProgress:A,updateOperationProgressBasedOnFileCount:w,updateOperationProgressBasedOnSize:_};return U}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").service("OperationUtilService",["$q","ConsoleOperation","FAC","MultipartCopyService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","UtilService",function(e,r,i,a,o,s,c,l,u,d){function p(e,t){return{operation:e,keys:t,result:{},error:null,updateType:""}}function f(e,n,r,a){var o={};return o.bucket=e.initialBucket,o.region=a,[c.OPERATION_NAME.ADD_OBJECT_TAG,c.OPERATION_NAME.MAKE_PUBLIC,c.OPERATION_NAME.INITIATE_RESTORE].indexOf(e.name)>-1?o.keyVersionIds=d.getKeyVersionIds(n):o.keys=t.pluck(n,"Key"),e.name===c.OPERATION_NAME.CHANGE_STORAGE_CLASS?o.storageClass=r.targetStorageClass:e.name===c.OPERATION_NAME.CHANGE_SSE?(o.sseAlgo=r.sseAlgo,r.sseKmsKeyId&&(o.sseKmsKeyId=r.sseKmsKeyId)):e.name===c.OPERATION_NAME.CHANGE_METADATA?(o.metadataMap=r.addAndChangeMetadata,o.deleteMetadata=r.deleteMetadata):e.name===c.OPERATION_NAME.INITIATE_RESTORE?(o.expirationDays=r.expirationDays,r.tier&&(o.tier=r.tier)):e.name===c.OPERATION_NAME.ADD_OBJECT_TAG&&(o.tags=r.tags,o.disableFetchTag=r.disableFetchTag),R.indexOf(e.name)>=0&&i.isFeatureEnabled(c.FAC.NEW_MULTIPART_COPY+"-"+a)&&(o.isNewMultipartCopy=!0),o}function g(n,r,i){var o={},s=e.defer(),c=k.initializeBulkOperationResult(n,r);if(!k.verifyInput(n,r))throw"The call has invalid input.";return u.getBucketLocation(n,n.initialBucket,o).then(function(){var e=k.generateParameterForSpecificOperation(n,r,i,o.region),u=O[n.name];if(!u)throw n.name+" is not supported";l.makeS3ConsoleOperationRequest(e,u,{},n).then(function(i){if(a.isMultipartCopyNeeded(n,i)){var o=k.getAllSinglePartCopyResult(n,i,r);if(o.error)return void s.reject(o);s.notify(o),a.startMultipartCopyForFiles(n,n.initialBucket,e.region,e.region,r,t.pluck(r,"Key"),i,!1,s)}else k.handleCWSSuccessResponse(n,r,i,c,s)}).catch(function(e){k.handleCWSErrorResponse(n,e,c,s)})}).catch(function(e){k.handleGetBucketLocationError(n,e,c,s)}),s.promise}function m(e,n,r){var i=k.initializeBulkOperationResult(e);i.updateType=c.OPERATION_PROGRESS_UPDATE_TYPE.SINGLE_PART_RESULTS,i.keys=r;var s=t.pluck(r,"Key");return n.data.statusPerKey.forEach(function(t){a.isMultipartCopyObject(t)||(s.lastIndexOf(t.key)>=0?i.result[t.key]=t.result:(o.log(A,0,{operation:e,originalKeys:r,response:n}),i.error=C))}),i}function h(e,t,n,r){o.log(T,1,e,t),n.error=t,r.reject(n)}function b(e,t,n,r){o.log((e.name+w).replace(/ /g,""),1,e,t),n.error=t,r.reject(n)}function v(e,t,n,r,i){var a=!1;l.wasOperationSuccessful(n)&&(n.data.statusPerKey.forEach(function(e){e.versionId?(a=!0,r.result[e.key+e.versionId]=e.result):r.result[e.key]=e.result}),k.verifyKeysMatching(t,r.result,a)?(o.log(A,1,e),o.log((e.name+_).replace(/ /g,""),Object.keys(t).length,e,r.result),i.resolve(r)):(o.log(A,0,{operation:e,keys:t,response:n}),r.error=C,i.reject(r)))}function E(e,t){if(isNaN(e.totalSizeInBytes)||e.totalSizeInBytes<0)return!1;for(var n in t)if(isNaN(t[n].Size)||t[n].Size<0)return!1;return!0}function S(e,n){var r=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],i={},a=r?t.map(e,function(e){return e.Key+e.VersionId}):t.pluck(e,"Key");a.forEach(function(e){i[e]=!1});var o=Object.keys(n);return e.length===o.length&&(o.forEach(function(e){if(!1!==i[e])return!1;i[e]=!0}),a.forEach(function(e){if(!i[e])return!1}),!0)}var y,A="BulkOpKeyCountMatch",C="BulkOpKeyCountMismatch",_="ObjectCount",w="RequestFailed",T="GetBucketLocationError",R=[c.OPERATION_NAME.CHANGE_METADATA,c.OPERATION_NAME.CHANGE_SSE,c.OPERATION_NAME.CHANGE_STORAGE_CLASS],O=(y={},n(y,c.OPERATION_NAME.MAKE_PUBLIC,c.CWS_OPERATION_NAME.MAKE_PUBLIC),n(y,c.OPERATION_NAME.CHANGE_SSE,c.CWS_OPERATION_NAME.CHANGE_SSE),n(y,c.OPERATION_NAME.CHANGE_STORAGE_CLASS,c.CWS_OPERATION_NAME.CHANGE_STORAGE_CLASS),n(y,c.OPERATION_NAME.CHANGE_METADATA,c.CWS_OPERATION_NAME.CHANGE_METADATA),n(y,c.OPERATION_NAME.INITIATE_RESTORE,c.CWS_OPERATION_NAME.INITIATE_RESTORE),n(y,c.OPERATION_NAME.ADD_OBJECT_TAG,c.CWS_OPERATION_NAME.ADD_OBJECT_TAG),y),k={handleCWSSuccessResponse:v,handleCWSErrorResponse:b,handleGetBucketLocationError:h,initializeBulkOperationResult:p,defaultCWSBulkOperationCaller:g,generateParameterForSpecificOperation:f,verifyKeysMatching:S,getAllSinglePartCopyResult:m,verifyInput:E};return k}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("DeleteService",["$q","$timeout","ConsoleOperation","ListVerificationService","Md5GenerationService","ObjectListingService","PathService","S3Constants","SCLogService","APIProxyService","S3Service","UtilService","XMLParser",function(e,n,r,i,a,o,s,c,l,u,d,p,f){function g(e){var t="<Delete>";for(var n in e)t+="<Object>",t+="<Key>"+p.encodeXml(e[n].Key)+"</Key>",e[n].VersionId&&(t+="<VersionId>"+p.encodeXml(e[n].VersionId)+"</VersionId>"),t+="</Object>";return t+="</Delete>"}function m(e,t,n){var r=R.createDeleteMultipleObjectsXml(t),i=R.generateDeleteRequest(e,r,n.mfaString,n.bucketObjectLockEnabled);return R.deleteKeysAndVersionsWithRetries(e,t,i,0,0)}function h(r,i,a,o,s){function p(t){return l.log(S,1,r,t),h(o,c.MAX_RETRIES.OPERATION_REQUEST_FAILURE)?R.deleteKeysAndVersionsWithRetries(r,i,a,o+1,s):(b.error=t,e.reject(b))}function g(t){if("string"==typeof t.response){l.log(w,1,r,{});var n=f.convertXmlStringToJson(t.response);(n.DeleteResult||n.Error)&&(t.response=n)}if(t.response.DeleteResult){var u=R.getKeyAndVersionIdSetFromResponse(t.response.DeleteResult,r),d=i.map(function(e){return e.VersionId?e.Key+":"+e.VersionId:e.Key});R.compareRequestAndResponse(d,Object.keys(u))?(l.log(y,1,r,{original:i,result:u}),b.result=u):(l.log(A,0,r,{original:i,result:u}),b.error=A)}else t.response.Error?b.error=t.response.Error:(l.log(T,1,r,{response:t.response}),b.error="Unable to parse response as XML");return b.error?h(o,c.MAX_RETRIES.OPERATION_REQUEST_FAILURE)?R.deleteKeysAndVersionsWithRetries(r,i,a,o+1,s):e.reject(b):b}function m(l){if(t.has(l,"response.Error.Code")&&t.includes(["SlowDown","ServiceUnavailable","InternalError"],l.response.Error.Code)&&h(s,c.MAX_RETRIES.OPERATION_SERVER_FAILURE)){var u=c.RETRY_WAIT_TIME*(s+1);return n(function(){return R.deleteKeysAndVersionsWithRetries(r,i,a,o,s+1)},u)}return void 0===l.error?(b.error=l,e.reject(b)):e.reject(l)}function h(e,t){return e+1<=t}if(r.state!==c.OPERATION_STATE.CANCEL){var b={operation:r,error:null,result:null};return u.getBucketLocation(r,r.initialBucket,a).catch(p).then(function(e){return u.makeProxyRequest(d.deleteObjects,e,c.PROXY_API_NAMES.S3.DELETE,r).then(g).catch(m)})}}function b(e,t,n,r){var i={content:t,path:e.initialBucket};return i.headers={},i.headers[c.HEADERS.CONTENT_TYPE]=c.HEADERS.CONTENT_TYPE_JSON,i.headers[c.HEADERS.X_AMZ_DATE]=(new Date).toUTCString(),i.headers[c.HEADERS.CONTENT_MD5]=a.getContentMd5(t),n&&(i.headers[c.HEADERS.X_AMZ_MFA]=n),r&&(i.headers[c.HEADERS.X_AMZ_BYPASS_GOV_RETENTION]="true"),l.log(C,1,e,i),i}function v(e,t){var n={};if(e.Deleted){var r=Array.isArray(e.Deleted)?e.Deleted:[e.Deleted];l.log(_,r.length,t),r.forEach(function(e){var t=e.VersionId?e.Key+":"+e.VersionId:e.Key;n[t]={status:c.OPERATION_PER_KEY_STATUS.DONE}})}if(e.Error){var r=Array.isArray(e.Error)?e.Error:[e.Error];r.forEach(function(e){var t=e.VersionId?e.Key+":"+e.VersionId:e.Key;n[t]={status:c.OPERATION_PER_KEY_STATUS.ERROR,errorCode:e.Code,errorMessage:e.Message}})}return n}function E(e,n){return t.isEqual(e.sort(),n.sort())}var S="GetBucketLocationError",y="DeleteCountMatch",A="DeleteCountMismatch",C="DeleteRequestGenerated",_="DeleteObjectCount",w="DeleteResponseNoContentType",T="DeleteResponseNotXML",R={createDeleteMultipleObjectsXml:g,deleteKeysAndVersions:m,deleteKeysAndVersionsWithRetries:h,generateDeleteRequest:b,getKeyAndVersionIdSetFromResponse:v,compareRequestAndResponse:E};return R}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("CopyService",["ConsoleOperation","FAC","MultipartCopyService","OperationDispatcherService","OperationUtilService","PathService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","$q",function(e,n,r,i,a,o,s,c,l,u,d,p){function f(e){null!==y&&(y.state=l.OPERATION_STATE.CANCEL),y=e}function g(){return null===y}function m(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null===y)throw"There is no operation in the clipboard.";y.dstBucket=o.getCurrentBucket(),y.dstPrefix=o.getCurrentAbsoluteFolderPath(),void 0===y.dstPrefix&&(y.dstPrefix=""),e?(y.dstName=t&&t.name,s.log(S,1,y,{dstName:y.dstName})):s.log(E,1,y,{dstBucket:y.dstBucket,dstPrefix:y.dstPrefix}),i.addOperation(y),y=null}function h(e,r,i,a,o){var s={bucket:e.initialBucket,prefix:e.initialPath,dstBucket:e.dstBucket,keys:t.pluck(r,"Key"),dstKeys:[],region:o},c=void 0;return a?function(){var t=r[0].Key;r.forEach(function(n){var r=n.Key;c=r.replace(t,e.dstName),s.dstKeys.push(s.prefix?s.prefix+c:c)})}():r.forEach(function(t){var n=t.Key;s.dstKeys.push(n.replace(t.Path||e.initialPath,e.dstPrefix))}),s.cutOperation=!0===(i||a),n.isFeatureEnabled(l.FAC.NEW_MULTIPART_COPY+"-"+o)&&(s.isNewMultipartCopy=!0),s}function b(e,t,n){var i=n.isCut,o=n.isRename,s=p.defer(),c=a.initializeBulkOperationResult(e,t),f={},g=void 0;return d.getBucketLocation(e,e.initialBucket,f).then(function(){g=A.generateCopyRequestPayload(e,t,i,o,f.region),f={},d.getBucketLocation(e,e.dstBucket,f).then(function(n){g.dstBucketRegion=n.region,u.makeS3ConsoleOperationRequest(g,l.CWS_OPERATION_NAME.COPY,{},e).then(function(n){if(r.isMultipartCopyNeeded(e,n)){var l=a.getAllSinglePartCopyResult(e,n,t);if(l.error)return void s.reject(l);s.notify(l),r.startMultipartCopyForFiles(e,e.dstBucket,g.dstBucketRegion,g.region,t,g.dstKeys,n,!(!i&&!o),s)}else a.handleCWSSuccessResponse(e,t,n,c,s)}).catch(function(t){a.handleCWSErrorResponse(e,t,c,s)})}).catch(function(t){a.handleGetBucketLocationError(e,t,c,s)})}).catch(function(t){a.handleGetBucketLocationError(e,t,c,s)}),s.promise}function v(){return y}var E="PasteObjects",S="RenameObject",y=null,A={copyObjects:b,setClipboardOperation:f,isOperationInClipboard:g,startClipboardOperation:m,generateCopyRequestPayload:h,getClipboardOperation:v};return A}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("UploadOperationService",["$q","$window","$translate","ConsoleOperation","humanReadableBytesFilter","SCLogService","APIProxyService","S3ConsolePromiseQueue","S3Constants","UploadService",function(e,n,r,i,a,o,s,c,l,u){function d(){var e=new i(l.OPERATION_NAME.UPLOAD);return e.uploadFilePromiseQueue=new c(l.UPLOAD.MAX_NUMBER_CONCURRENT_UPLOADS),e.displayName=r.instant("operationname.upload"),e.processedFiles=[],e.explorers=[],o.log(e.name+w,1,e),e.start=function(){if(!(e.selectedObjects&&0!==e.selectedObjects.length||e.selectedFolders&&0!==e.selectedFolders.length))throw o.log(e.name+P,1,e),"Setup up the upload operation before start";o.log(e.name+I,1,e);for(var t in e.selectedFolders)if("break"===function(t){if(e.state===l.OPERATION_STATE.CANCEL)return"break";0===e.selectedFolders[t].objsCount&&e.uploadFilePromiseQueue.add(function(){return g({folder:e.selectedFolders[t],operation:e})})}(t))break;for(var n in e.selectedObjects)if("break"===function(t){if(e.state===l.OPERATION_STATE.CANCEL)return"break";e.uploadFilePromiseQueue.add(function(){return m({file:e.selectedObjects[t],operation:e,isDragAndDrop:!1})},e.selectedObjects[t].id)}(n))break;e.explorers&&e.explorers.length>0&&p(0,e)},e.cancel=function(){var t=e.uploadFilePromiseQueue.clear();e.state=l.OPERATION_STATE.CANCEL,o.log(R,1,e),t.forEach(function(t){return u.cancelUpload(t,e)})},e}function p(e,t){var n=t.explorers[e];e++,o.log(t.name+T,1,t,{explorerId:n.explorerId,selectedItems:n.getSelectedItems()}),f(n,t).then(function(){var n=t.succeedKeyCount+t.failedKeyCount;e<t.explorers.length?p(e,t):o.log(t.name+_,1,t,{expectedTotalObjsCount:t.totalObjectCount,numberOfFileUploadsAttempted:n,numberOfExplorersUploaded:t.explorers.length})},function(e){o.log(t.name+_,0,t,e),t.cancel()})}function f(t,n,r){var i=r||e.defer();return n.state===l.OPERATION_STATE.CANCEL?(E(n),void i.reject("Operation was cancelled")):(t.getNext().then(function(e){if(!e)return void i.resolve();var r=e.fileList,a=e.emptyFolderToBeUploaded;a&&n.uploadFilePromiseQueue.add(function(){return g({folder:a,operation:n,isDragAndDrop:!0})});for(var o in r)!function(e){n.uploadFilePromiseQueue.add(function(){return m({file:r[e],operation:n,isDragAndDrop:!0})},r[e].id)}(o);f(t,n,i)},function(e){i.reject(e)}),i.promise)}function g(t){var n=t.folder,i=t.operation,a=t.isDragAndDrop,c=s.putObject(i,i.initialBucket,i.initialPath+n.fullPath,n.Prefix);return i.state===l.OPERATION_STATE.CANCEL?(y({operation:i,name:n.Prefix,errorMessage:r.instant("upload.cancelled")}),e.reject()):(c.then(function(e){o.log(i.name+O,1,i,{fullPath:i.initialPath+n.fullPath,isDragAndDrop:a,name:n.Prefix}),e.operation=i,S(e)},function(e){o.log(i.name+O,0,i,e),e.operation=i,y(e)}),c)}function m(t){var n=t.file,i=t.operation,a=t.isDragAndDrop,s=n.file,c=n.fullPath?i.initialPath+n.fullPath:i.initialPath,d=i.initialBucket,p=n.id,f=i.options;s.initialLastModified=s.lastModified||"";var g=u.upload(s,c,d,p,i,f);return o.log(k+i.name,1,i,{fullPath:i.initialPath+s.fullPath,isDragAndDrop:a,fileName:s.Key}),i.files[t.file.Key]=t.file.Size,i.state===l.OPERATION_STATE.CANCEL?(y({operation:i,name:t.file.Key,errorMessage:r.instant("upload.cancelled")}),e.reject()):(g.then(S,y,A),g)}function h(e,t,n,r,i,a){var o=arguments.length<=6||void 0===arguments[6]||arguments[6];e.selectedFolders=t,e.selectedObjects=n,e.totalObjectCount=r.files,e.totalBytes=r.size,e.totalUploadedBytes=0,e.options=i,e.uploadUiCallBack=a,e.currentUploadSpeed=0,e.lastNotifyTime=null,e.lastMarkBytes=0,e.files={},e.shouldPerformETagVerification=o}function b(e,t){return u.fileSelected(e,t)}function v(e){0===e.errorPercentage?e.parameters.operationSuccessful=!0:0===e.successPercentage?e.parameters.operationUnsuccessful=!0:e.parameters.operationPartiallySuccessful=!0}function E(e){e.successPercentage+e.errorPercentage!==100&&(e.errorPercentage=100-e.successPercentage)}function S(e){var t=e.operation;delete e.operation,o.log(t.name+N,1,t,e),t.succeedKeyCount+=1,t.totalOperatedObjectCount+=1,t.processedFiles.push(e.name);var n=t.succeedKeyCount/t.totalObjectCount*100;t.successPercentage=t.successPercentage>n?t.successPercentage:n,t.uploadUiCallBack(),v(t),t.succeedKeyCount+t.failedKeyCount===t.totalObjectCount&&(t.progressPercentage=100,delete t.fileInProgress,t.succeedKeyCount===t.totalObjectCount&&(t.successPercentage=100),E(t),0!==t.errorPercentage?t.errorCallBack(t.id):t.finishCallBack(t.id))}function y(e){var n=e.operation;delete e.operation,n.processedFiles.push(e.name);var i=t.isEmpty(e.errorMessage)?r.instant("upload.unexpected.error"):e.errorMessage,a=t.filter(n.errorTypes,function(e){return e.errorMessage===i});0===a.length?n.errorTypes.push({errorMessage:i,errorCount:1,errorPercentage:Number(n.files[e.name]/n.totalBytes*100).toFixed(2)}):(a[0].errorCount+=1,a[0].errorPercentage=Number(n.files[e.name]/n.totalBytes*100).toFixed(2));var s=0;C(e)&&(s=1,o.log(n.name+M,1,n,e.errorMessage)),e.errorMessage===l.SESSION_TIMEOUT_MESSAGE&&(s=1,o.log(n.name+x,1)),o.log(n.name+N,s,n,e),n.errorDetails[i]?n.errorDetails[i].push(e.name):n.errorDetails[i]=[e.name],n.failedKeyCount+=1,n.totalOperatedObjectCount+=1,n.successPercentage=n.succeedKeyCount/n.totalObjectCount*100,n.errorPercentage=n.failedKeyCount/n.totalObjectCount*100,n.progressPercentage=n.totalOperatedObjectCount/n.totalObjectCount*100,n.uploadUiCallBack(),v(n),n.succeedKeyCount+n.failedKeyCount===n.totalObjectCount&&(n.failedKeyCount===n.totalObjectCount&&(n.errorPercentage=100),delete n.fileInProgress,E(n),0!==n.errorPercentage?n.errorCallBack(n.id):n.finishCallBack(n.id))}function A(e){var r=e.operation;if(e.totalBytes&&e.uploadedByte){r.filesInProgress=r.filesInProgress||{},r.totalUploadedBytes+=e.uploadedByte-(r.filesInProgress[e.fileName]||0),r.filesInProgress[e.fileName]=e.uploadedByte,r.processedFiles.length&&t.keys(r.filesInProgress).forEach(function(e){r.processedFiles.indexOf(e)>-1&&delete r.filesInProgress[e]});var i=t.keys(r.filesInProgress).reduce(function(e,t){return parseFloat(e)+parseFloat(r.filesInProgress[t]/r.files[t])},0);r.progressPercentage=(i+r.succeedKeyCount)/parseFloat(r.totalObjectCount)*100,r.successPercentage=r.progressPercentage,r.fileInProgress=e.fileName;var s=n.Date.now();if(r.lastNotifyTime||(r.lastNotifyTime=s),s-r.lastNotifyTime>500){var c=(r.totalUploadedBytes-r.lastMarkBytes)/((s-r.lastNotifyTime)/1e3);c<0&&o.log(r.name+L,1,r,e),r.currentUploadSpeed=a(Math.max(c,0)),r.lastMarkBytes=r.totalUploadedBytes,r.lastNotifyTime=s}}delete e.operation,o.log("UploadProgress",1,r,e)}function C(e){return-1!==l.UPLOAD.USER_ERROR_MESSAGES.indexOf(e.errorMessage)||!0===e.isCancelled}var _="DragAndDropComplete",w="OperationCreated",T="StartExplorerTraversal",R="CancelUploadOperation",O="EmptyFolder",k="Start",I="Started",P="StartedBeforeSetup",N="Complete",M="UserError",L="SpeedNegative",x="SessionTimeout";return{createUploadOperation:d,setupUploadOperation:h,uploadFile:m,uploadSuccess:S,uploadError:y,uploadNotify:A,selectFile:b,setFlagValues:v,updateErrorPercentage:E}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("MultipartCopyService",["$q","$translate","ConsoleOperation","PathService","SCLogService","S3Constants","S3CWSAPIService","UtilService",function(e,t,n,r,i,a,o,s){function c(e,t){if(y.lastIndexOf(e.name)<0)return!1;for(var n in t.data.statusPerKey)if(t.data.statusPerKey[n].result.additionalInfoWhenSuccess&&-1!==t.data.statusPerKey[n].result.additionalInfoWhenSuccess.lastIndexOf(E))return!0;return!1}function l(e){return e.result.additionalInfoWhenSuccess&&-1!==e.result.additionalInfoWhenSuccess.lastIndexOf(E)}function u(e,n,r,o,s,c,l,u,d){var p={},f=!1;if(l.data.statusPerKey.forEach(function(l){if(l.result.additionalInfoWhenSuccess&&-1!==l.result.additionalInfoWhenSuccess.lastIndexOf(E))for(var g in s)if(s[g].Key===l.key){var m=l.result.additionalInfoWhenSuccess.split(E)[1];p[m]={key:s[g]},p[m].dstKey=c[g],p[m].dstBucket=n,p[m].dstBucketRegion=r,p[m].srcBucketRegion=o,p[m].isCut=u,p[m].objectSizeInByte=s[g].Size,p[m].partCount=Math.ceil(s[g].Size/a.MULTIPART_COPY.PART_SIZE);var h=Object.keys(p[m]);for(var b in h)if(void 0===p[m][h[b]]){i.log(v,0,e,p[m]);var S=A.initializeNotifyResult(e,[p[m].key]);S.updateType=a.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR,S.error=t.instant("operation.errormessage.multipartcopyfailed"),d.notify(S),f=!0}break}}),!f){var g=Object.keys(p);A.recursivelyMultipartCopy(e,g,p,0,0,l,d)}}function d(e,t,n,r){var i={bucket:e.initialBucket,multipartCopyId:t,key:n.key.Key,dstBucket:n.dstBucket,dstKey:n.dstKey,objectSizeInByte:n.objectSizeInByte,dstBucketRegion:n.dstBucketRegion,region:n.dstBucketRegion,startPartNumber:r*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1,endPartNumber:Math.min((r+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,n.partCount)};return o.makeS3ConsoleOperationRequest(i,a.CWS_OPERATION_NAME.MULTIPART_COPY,{},e)}function p(e){var t=[],n="",r=null;return e.data.statusPerKey.forEach(function(e){e.result.status===a.OPERATION_PER_KEY_STATUS.DONE?t.push({partNumber:Number(e.key),eTag:e.result.additionalInfoWhenSuccess}):e.result.status===a.OPERATION_PER_KEY_STATUS.ERROR&&(n=e.result.errorMessage,r=e.result.errorCode)}),n?{errorMessage:n,errorCode:r}:t}function f(e,t,n){var r={bucket:e.initialBucket,etags:n.partEtags,copyId:t,dstKey:n.dstKey,srcKey:n.key.Key,objectSize:n.objectSizeInByte,dstBucket:n.dstBucket,srcRegion:n.srcBucketRegion,region:n.dstBucketRegion,isCut:n.isCut};return o.makeS3ConsoleOperationRequest(r,a.CWS_OPERATION_NAME.COMPLETE_MULTIPART_COPY,{},e)}function g(e,t,n){return{operation:e,keys:t,result:{},error:null,updateType:"",notifyDefer:n,isLastOne:!1}}function m(e,t,n,r,i,o){var s=A.initializeNotifyResult(e,[t.key.Key],o?r:null);s.error=i,s.updateType=a.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR,s.isLastOne=o;var c=n*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1,l=t.partCount;s.result=(l-c)*a.MULTIPART_COPY.PART_SIZE+Math.min(a.MULTIPART_COPY.PART_SIZE,t.objectSizeInByte-(l-1)*a.MULTIPART_COPY.PART_SIZE),r.notify(s)}function h(e,t,n,r,i,o){var s=A.initializeNotifyResult(e,[t.key.Key],o?r:null);s.updateType=i?a.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE:a.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_RESULT,s.isLastOne=o;var c=n*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1,l=Math.min((n+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,t.partCount);s.result=(l-c)*a.MULTIPART_COPY.PART_SIZE+Math.min(a.MULTIPART_COPY.PART_SIZE,t.objectSizeInByte-(l-1)*a.MULTIPART_COPY.PART_SIZE),r.notify(s)}function b(e,t,n,r,o,s,c){if(r!==t.length&&e.state!==a.OPERATION_STATE.CANCEL){var l=n[t[r]],u=r+1===t.length;A.doMultipartCopy(e,t[r],l,o).then(function(a){var d=p(a);d.errorMessage?(i.log(S,0,e,{params:l,error:d.errorMessage}),i.log(v,0,e),A.notifyError(e,l,o,c,d.errorMessage,u),A.recursivelyMultipartCopy(e,t,n,r+1,0,s,c)):(i.log(S,1,e,l),l.partEtags?l.partEtags=l.partEtags.concat(d):l.partEtags=d,l.partEtags.length===l.partCount?(A.completeMultipartCopy(e,t[r],l).then(function(){i.log(v,1,e),A.notifyProgress(e,l,o,c,!0,u)}).catch(function(t){i.log(v,0,e),A.notifyError(e,l,o,c,t,u)}),A.recursivelyMultipartCopy(e,t,n,r+1,0,s,c)):(A.notifyProgress(e,l,o,c,!1,!1),A.recursivelyMultipartCopy(e,t,n,r,o+1,s,c)))}).catch(function(a){i.log(S,0,e,{params:l,error:a}),i.log(v,0,e),A.notifyError(e,l,o,c,a,u),A.recursivelyMultipartCopy(e,t,n,r+1,0,s,c)})}}var v="MultipartCopyCompleted",E="multipartCopyId:",S="MultipartCopyPartCompleted",y=[a.OPERATION_NAME.COPY,a.OPERATION_NAME.CUT,a.OPERATION_NAME.RENAME,a.OPERATION_NAME.CHANGE_METADATA,a.OPERATION_NAME.CHANGE_STORAGE_CLASS,a.OPERATION_NAME.CHANGE_SSE],A={completeMultipartCopy:f,doMultipartCopy:d,getEtagsFromResponse:p,recursivelyMultipartCopy:b,startMultipartCopyForFiles:u,isMultipartCopyNeeded:c,isMultipartCopyObject:l,initializeNotifyResult:g,notifyProgress:h,notifyError:m};return A}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){function n(n,r,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C,_){function w(e){if(e){var n=t.find(o.tabs,function(e){return e.id===v.TABS.OBJECT_LIST.SELECT});y.s3SelectEnabledForObject(e)?n||o.tabs.push(M):(o.tabsInfo.selectedTab===v.TABS.OBJECT_LIST.SELECT&&(o.tabsInfo.selectedTab=v.TABS.OBJECT_LIST.OVERVIEW),n&&o.tabs.splice(o.tabs.indexOf(n),1))}}function T(e){l.getObjectAcl(e,o.bucket,m.getCurrentObject(),o.obj.VersionId).then(function(n){var r=n.response.AccessControlPolicy;E.log("getObjectACL",1,e,{bucketName:o.bucket,key:m.getCurrentObject()});var i=t.get(r,"AccessControlList.Grant"),a=t.get(r,"Owner");o.permissionObj.owner=a;var s={};i&&(Array.isArray(i)?i.forEach(function(e){h.updateGranteesHelperFunction(e,s)}):h.updateGranteesHelperFunction(i,s),o.permissionObj.grantees=h.updateGrantees(s,a),o.permissionObj.aclGrants=i?Array.isArray(i)?i:[i]:[])}).catch(function(t){E.log("getObjectACL",0,e,{bucketName:o.bucket,key:m.getCurrentObject()}),o.objectDetailError=S.handleErrors(t);var n=t.status===v.HTTP_STATUS_CODES.ACCESS_DENIED,r=c.instant(n?"resource.access.insufficientpermissions":"permissions.error.header"),i=n?c.instant("permissions.acl.object.insufficientpermissions",{permission:"s3:GetObjectAcl"}):o.objectDetailError;o.errors.acl={header:r,message:i}})}function R(e){o.restoreWarning=null,o.warning=null,o.withinRestoreExpiry?(o.obj.StorageClass===v.STORAGE_CLASSES.GLACIER?o.restoreWarning=c.instant("objectdetail.restoreglacierwarning"):o.obj.StorageClass===v.STORAGE_CLASSES.DEEP_ARCHIVE&&(o.warning=c.instant("objectdetail.restoredeeparchivewarning")),T(e)):o.obj.StorageClass===v.STORAGE_CLASSES.GLACIER?o.warning=c.instant("objectdetail.glacierwarning"):o.obj.StorageClass===v.STORAGE_CLASSES.DEEP_ARCHIVE?o.warning=c.instant("objectdetail.glacierdeeparchivewarning"):T(e)}function O(e){o.obj.VersionId&&(o.versionsDropdownSelectedObject.obj=t.cloneDeep(o.obj)),o.obj.IsLatest&&"true"!==o.obj.IsLatest||(o.obj.versionLabel=c.instant("versionsdropdown.label.latestVersion")),o.showVersionId=o.obj.VersionId&&"null"!==o.obj.VersionId,o.obj.ETag=o.obj.ETag?o.obj.ETag.replace(/[\\"]+/g,""):"",-1!==o.obj.Key.lastIndexOf("/")&&(o.obj.Key=o.obj.Key.substring(o.obj.Key.lastIndexOf("/")+1)),o.getMetadata(e,o.obj.VersionId)}function k(e){var n={bucket:o.bucket,prefix:o.key,maxKeys:1,cacheAllowed:!0};l.listObjects(e,n).then(function(r){o.obj=t.get(r,"response.ListBucketResult.Contents[0]"),o.obj.versionLabel=c.instant("versionsdropdown.label.latestVersion"),o.versionsDropdownSelectedObject.obj=t.cloneDeep(o.obj),_.customerReady("ObjectDetails"),E.log(v.OPERATION_NAME.GET_OBJECT_DETAILS,1,e,n),o.obj&&(o.obj.ETag=o.obj&&o.obj.ETag.replace(/[\\"]+/g,""),-1!==o.obj.Key.lastIndexOf("/")&&(o.obj.Key=o.obj.Key.substring(o.obj.Key.lastIndexOf("/")+1)),o.obj.versionLabel=c.instant("versionsdropdown.label.latestVersion"),o.getMetadata(e))}).catch(function(t){_.customerReady("ObjectDetails"),o.objectDetailError=S.handleErrors(t),E.log(v.OPERATION_NAME.GET_OBJECT_DETAILS,0,e,t)})}function I(t){var n={bucket:o.bucket,prefix:o.key,cacheAllowed:!0};l.listVersions(t,n).then(function(r){var i=r.response.ListVersionsResult;i.Version&&(i.Version=S.transformObjectToArray(i.Version)),i.DeleteMarker&&(i.DeleteMarker=S.transformObjectToArray(i.DeleteMarker));var a=i.Version,s=i.DeleteMarker;a&&a.length>0&&e.forEach(a,function(e){e.VersionId===o.versionId&&(o.obj=e)}),!o.obj&&s&&s.length>0&&e.forEach(s,function(e){e.VersionId===o.versionId&&(o.obj=e)}),o.obj&&(_.customerReady("ObjectDetails"),E.log(v.OPERATION_NAME.GET_OBJECT_DETAILS,1,t,n),O(t))}).catch(function(e){_.customerReady("ObjectDetails"),o.objectDetailError=S.handleErrors(e),E.log(v.OPERATION_NAME.GET_OBJECT_DETAILS,0,t,e)})}function P(){A.isFeatureEnabled(v.FAC.PUBLIC_ACCESS_BLOCK)&&C.getAllSettings(o.bucket).then(function(e){var t=e.accountSettings,n=e.bucketSettings;o.blockPublicAclsEnabled=t.blockPublicAcls||n.blockPublicAcls,o.blockPublicAccessSettings={accountSettings:t,bucketSettings:n}})}function N(){o.errors={acl:void 0,actions:void 0}}var M={label:c.instant("objects.select.title"),id:v.TABS.OBJECT_LIST.SELECT};o.dateFormat=v.DATE_FORMAT,o.objectDetailError="",o.bucket=m.getCurrentBucket(),o.key=m.getCurrentObject(),o.key.lastIndexOf(v.DELIMITER)===o.key.length-1&&r.path(""+v.DELIMITER+v.PATH_SEGMENTS.HOME),o.obj=p.getCurrentObject(),o.versionsDropdownSelectedObject={obj:t.cloneDeep(p.getCurrentObject())},o.versionsDropdownSelectedObject.obj&&(o.versionsDropdownSelectedObject.obj.Key=m.relativeToAbsoluteObjectPath(o.versionsDropdownSelectedObject.obj.Key)),o.tabs=[{label:c.instant("details.tab.overview"),id:v.TABS.OBJECT_LIST.OVERVIEW},{label:c.instant("details.tab.properties"),id:v.TABS.OBJECT_LIST.PROPERTIES},{label:c.instant("details.tab.permissions"),id:v.TABS.OBJECT_LIST.PERMISSIONS}],o.obj&&y.s3SelectEnabledForObject(o.obj)&&o.tabs.push(M),o.options={},o.versionLabel=c.instant("versionsdropdown.label.latestVersion"),o.tabsInfo={selectedTab:r.search().tab||v.TABS.OBJECT_LIST.OVERVIEW},o.showReplication=!1,o.showRestoration=!1,o.showExpiry=!1,o.showVersionsDropdown={show:!1},o.showSuccessMessage=!1,o.showVersionId=!1,o.permissionObj={},o.versionId=a[v.VERSION_ID_PARAM],o.showVersions=S.convertStringToBoolean(a[v.SHOW_VERSION_PARAM]),u.Clog.setPageId(v.CLOG_OBJECT_DETAILS_PAGE_ID),o.copyFinished={flag:!1},o.$watch("obj",w,!0),o.getFullKey=function(e){if(e)return m.relativeToAbsoluteObjectPath(e.Key)},o.onSwitchedObjectVersion=function(e){w(e)},o.listVersions=function(e){e.stopPropagation(),o.showVersionsDropdown.show?o.showVersionsDropdown.show=!1:(o.showVersionsDropdown.show=!0,S.analyticsTrackClick(v.ANALYTICS.LATEST_VERSION,v.ANALYTICS.DETAILS))},o.closeDownloadAsPanel=function(){o.downloadAsPanel=!1},o.openDownloadAsPanel=function(){o.downloadAsPanel=!0,S.analyticsTrackClick(v.ANALYTICS.DOWNLOAD_AS,v.ANALYTICS.DETAILS),o.downloadAsPanelGenerating=!0,o.downloadPanelError=!1,o.downloadPanel={},g.generatePresignedUrlForCurrentObject(o.versionsDropdownSelectedObject.obj,!1).then(function(e){o.downloadAsPanelGenerating=!1,o.downloadPanel.url=e.data.presignedUrl},function(e){o.downloadAsPanelGenerating=!1,o.downloadPanelError=!0})},o.downloadSelectedObject=function(){var e=m.getCurrentAbsoluteFolderPath();-1===o.versionsDropdownSelectedObject.obj.Key.lastIndexOf(e)&&(o.versionsDropdownSelectedObject.obj.Key=e+o.versionsDropdownSelectedObject.obj.Key),g.downloadCurrentSelection(o.versionsDropdownSelectedObject.obj,!1)},o.openSelectedObject=function(){var e=o.versionsDropdownSelectedObject.obj.VersionId?o.versionsDropdownSelectedObject.obj.VersionId:null,t=m.getCurrentAbsoluteFolderPath(),n=void 0;n=-1===o.versionsDropdownSelectedObject.obj.Key.lastIndexOf(t)?t+o.versionsDropdownSelectedObject.obj.Key:o.versionsDropdownSelectedObject.obj.Key,g.openInBrowser(n,o.versionsDropdownSelectedObject.obj.Size,e,!1)},o.makePublic=function(){o.isMakingPublic=!0,o.errors.actions=void 0;var n=d.createBulkOperation(v.OPERATION_NAME.MAKE_PUBLIC,[o.obj],[],1,{numberOfKeysPerBulkOperation:1});n.totalSizeInBytes=o.obj.Size,b.addOperation(n),E.log("MakePublicRequestReceived",1,n),n.defer.promise.then(function(t){var r=Object.keys(t);r.length>0?(o.errors.actions=S.handleErrors(r[0]),E.log("MakePublicRequestComplete",0,n)):(o.cachedValue=e.copy(o.obj),o.cardOpen=!1,o.showSuccessMessage=!0,o.successMessageString=c.instant("objectdetails.successmessage"),s(function(){return o.showSuccessMessage=!1},v.SUCCESS_MESSAGE_TIMEOUT),E.log("MakePublicRequestComplete",1,n),T(n))}).catch(function(e){n.error=e,E.log("MakePublicRequestComplete",0,n);var r=t.isObject(e)?Object.keys(e):[];if(r.length>0)o.errors.actions=S.handleErrors(r[0]);else{var i=S.handleErrors(e,!0);o.errors.actions=i.errorMessageLocalized?i.errorMessageLocalized:i}}).finally(function(){o.isMakingPublic=!1})},o.permissionObj.grantees={},o.putAcl=function(e){var t=new f("putObjectAcl"),n=o.key;E.log("putObjectACLReceived",1,t,{bucketName:o.bucket,key:n});var r="";return l.getObjectAcl(t,o.bucket,n,o.obj.VersionId).then(function(a){var s=a.response.AccessControlPolicy;return r+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+s.Owner.ID+"</ID>",r+="<DisplayName>"+S.encodeXml(s.Owner.DisplayName)+"</DisplayName></Owner><AccessControlList>",e.forEach(function(e){e.Grantee.Type=e.Grantee.URI?"Group":e.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser",r+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+e.Grantee.Type+'">',r+=e.Grantee.ID?"<ID>"+e.Grantee.ID+"</ID>":"",r+=e.Grantee.DisplayName?"<DisplayName>"+S.encodeXml(e.Grantee.DisplayName)+"</DisplayName>":"",r+=e.Grantee.EmailAddress?"<EmailAddress>"+e.Grantee.EmailAddress+"</EmailAddress>":"",r+=e.Grantee.URI?"<URI>"+e.Grantee.URI+"</URI>":"",r+="</Grantee>",r+="<Permission>"+e.Permission+"</Permission></Grant>"}),r+="</AccessControlList></AccessControlPolicy>",l.putObjectAcl(t,o.bucket,n,r,o.obj.VersionId).then(function(e){var n=e.response;return E.logRequestComplete("putObjectAcl",t),n.Error&&(n.Error.Code||n.Error.Message)?(o.objectDetailError=S.handleErrors(n),i.reject(S.handleErrors(n))):n}).catch(function(e){return E.log("putObjectAcl",0,t,{bucketName:o.bucket,key:n,error:e}),o.objectDetailError=S.handleErrors(e),i.reject(S.handleErrors(e))})}).catch(function(e){return o.objectDetailError=S.handleErrors(e),i.reject(S.handleErrors(e))})},o.getStorageClassTranslation=function(){return o.obj&&o.obj.StorageClass?S.getStorageClassTranslations()[o.obj.StorageClass.toUpperCase()]:""},o.getEncryptionTranslation=function(){if(o.obj){if(o.obj.statusCodes){var e=o.obj.statusCodes[v.OPERATION_NAME.GET_OBJECT_METADATA];if(e)return e}return S.getEncryptionTranslations()[o.obj.Encryption]}return""},o.getMetadata=function(e,r){o.obj.statusCodes={};var i=m.getCurrentObject(),a=new f(v.OPERATION_NAME.GET_METADATA);E.log("GetObjectMetadataReceived",1,a),l.getObjectMetadata(e,o.bucket,i,r).then(function(r){E.log(v.OPERATION_NAME.GET_OBJECT_METADATA,e,1,{bucketName:o.bucket,key:i});var a=r.headers();if(o.obj.Encryption=v.OBJECT_SSE.NONE,a){if(a[v.HEADERS.X_AMZ_REPLICATION_STATUS]&&(o.showReplication=!0,o.obj.ReplicationStatus=r.headers()[v.HEADERS.X_AMZ_REPLICATION_STATUS]),a[v.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]&&(o.obj.Encryption=a[v.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]),a[v.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]&&(o.obj.KmsID=a[v.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID],o.options.kmsId=a[v.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]),a[v.HEADERS.X_AMZ_RESTORE]){o.restorationExpiry=void 0;var s=a[v.HEADERS.X_AMZ_RESTORE];if(s){var c=S.extractFromQuotes(s);"true"===c?(o.withinRestoreExpiry=!1,o.showRestoration=!0):"false"===c&&(o.showRestoration=!1,o.restorationExpiry=n("date")(new Date(S.extractFromQuotes(s,1)),o.dateFormat),o.withinRestoreExpiry=!t.isEmpty(o.restorationExpiry))}}if(a[v.HEADERS.X_AMZ_EXPIRATION]){o.showExpiry=!0;var l=a[v.HEADERS.X_AMZ_EXPIRATION];o.obj.ExpirationDate=n("date")(new Date(S.extractFromQuotes(l,0)),o.dateFormat),o.obj.ExpirationRule=S.extractFromQuotes(l,1)}}R(e)}).catch(function(t){o.obj.Encryption=S.isObjectWithSSECEncryption(t)?v.OBJECT_SSE.SSEC:S.getErrorMessage(t),E.log(v.OPERATION_NAME.GET_OBJECT_METADATA,e,0,{bucketName:o.bucket,key:i}),o.objectDetailError=S.handleErrors(t),o.obj.statusCodes[v.OPERATION_NAME.GET_OBJECT_METADATA]=S.getErrorMessage(t)}),l.getBucketLocation(e,o.bucket,{}).then(function(e){o.obj.Link=o.obj.ETag?m.getObjectLink(i,e.region,r):""}),o.showVersionId=r&&"null"!==r},o.actionButtonsDisabled=function(){return!o.obj||S.isStorageClassRestorable(o.obj.StorageClass)&&!o.withinRestoreExpiry||t.isEmpty(o.obj.ETag)},o.makePublicButtonsDisabled=function(){return!(o.obj&&!o.blockPublicAclsEnabled)},o.copyPathToClipboard=function(){var e=new f(v.OPERATION_NAME.COPY_OBJECT_PATH);E.log(v.OPERATION_NAME.COPY_OBJECT_PATH,1,e,{path:o.obj.Key}),S.copyPathToClipboard(o.obj.Key,o.copyFinished)},o.setTabParam=function(e){r.search("tab",e)},o.clearErrors=function(){o.errors=Object.assign(o.errors,{actions:void 0})},function(){var e=new f(v.OPERATION_NAME.GET_OBJECT_DETAILS);E.setEndpoint(),N(),P(),!o.obj||o.showVersions&&!o.obj.hasOwnProperty("VersionId")?o.versionId?I(e):k(e):(E.log("GetObjectDetailsCacheHit",1,e,{bucket:o.bucket,key:o.obj.Key}),O(e))}()}e.module("s3").controller("ObjectDetailsController",["$filter","$location","$q","$routeParams","$scope","$timeout","$translate","APIProxyService","AWSC","BulkOperationService","CachingService","ConsoleOperation","DownloadService","PathService","PermissionsUtilService","OperationDispatcherService","S3Constants","SCLogService","UtilService","S3SelectService","FAC","PublicAccessService","PerformanceUtilsService",n])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("KeySelectionService",["PathService","UtilService","$location","$rootScope",function(t,n,r,i){function a(e){for(var t=0;t<e.length;t++)e[t].selected=!1}function o(e,t){e&&a(e),t&&a(t)}function s(e,n){if(1!==n.length)return!1;var r=n[0];return decodeURIComponent(e)===t.getAbsolutePathToObjectWithBucket(r.Key)}function c(t){var n={sizeDataMissing:!1,totalObjs:t.objects.length,totalSize:0,totalFolders:t.folders.length};return e.forEach(t.objects,function(e){e.Size?n.totalSize+=Number(e.Size):n.sizeDataMissing=!0}),n}return{isCurrentlySelectedObject:s,setSelectedFlagAsFalse:o,countCurrLevelFiles:c}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m){function h(e){c.getBucketGrantees(n.bucket,e).then(function(r){f.log("GetBucketPermissions",1,e,{bucketName:n.bucket}),c.getBucketACP(n.bucket,e).then(function(i){f.log("getBucketACPs",1,e,{bucketName:n.bucket});var a=t.get(i,"AccessControlList.Grant");n.permissionObj.aclGrants=[],a&&(n.permissionObj.aclGrants=m.transformObjectToArray(a));var o=t.get(i,"Owner");n.permissionObj.owner=o,n.permissionObj.grantees=d.updateGrantees(r,o)}).catch(function(t){f.log("getBucketACPs",0,e,{bucketName:n.bucket}),n.error=t})}).catch(function(t){f.log("GetBucketPermissions",0,e,{bucketName:n.bucket}),n.error=t}).finally(function(){y()})}function b(e){s.getObjectAcl(e,n.bucket,u.getCurrentObject(),u.getObjectVersion()).then(function(r){var i=r.response.AccessControlPolicy;f.log("getObjectACL",1,e,{bucketName:n.bucket,key:u.getCurrentObject()});var a=t.get(i,"AccessControlList.Grant"),o=t.get(i,"Owner");n.permissionObj.owner=o;var s={};n.permissionObj.aclGrants=a?m.transformObjectToArray(a):[],a&&(a.forEach?a.forEach(function(e){d.updateGranteesHelperFunction(e,s)}):d.updateGranteesHelperFunction(a,s)),n.permissionObj.grantees=d.updateGrantees(s,o)}).catch(function(t){f.log("getObjectACL",0,e,{bucketName:n.bucket,key:u.getCurrentObject()}),n.error=m.handleErrors(t)}).finally(function(){y()})}function v(e){if(e){var t=new l("BucketPermissions","getPermissions");h(t)}else{var t=new l("ObjectPermissions","getPermissions");b(t)}}function E(){n.updatingGrantee=!1,n.panelCancel()}function S(e){for(var r in n.permissionObj.aclGrants){var i=n.permissionObj.aclGrants[r];if(i.Grantee.DisplayName===e||i.Grantee.ID===e||i.Grantee.URI&&i.Grantee.URI.split("/")[5]===e)return i.Grantee}if(t.indexOf(p.SYSTEM_PERMISSIONS_LIST,e)>-1)return t.find(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.systemPermissions,{detail:{value:e}}).detail;var a=t.find(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:e}});return t.isEmpty(a)?n.permissionObj.owner.ID===e||n.permissionObj.owner.DisplayName===e?n.permissionObj.owner:void 0:a.detail}function y(){n.isAddGranteeRowDisplayed=!1,n.granteeList.inputItem=null,n.granteeList.inputError=null,n.addingGrantee=!1,n.granteeList.grantPermissions=null}var A;n.granteeList={},n.radioSelect={displayName:null},n.granteeList.inputItem="",n.granteeList.inputError="",n.predefinedGroups=[{value:"AllUsers",text:a.instant("permissions.acl.everyone"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},{value:"AuthenticatedUsers",text:a.instant("permissions.acl.any"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},{value:"LogDelivery",text:a.instant("permissions.acl.log"),Type:"Group",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"}],n.granteeListPlaceholder=a.instant("permissions.granteelist.placeholder"),n.isAddGranteeRowDisplayed=!1,n.resource={type:!0===n.isBucketPermission?"bucket":"object"},n.readHeader=a.instant(n.resource.type+".acl.read"),n.readTooltip=a.instant(n.resource.type+".acl.readtooltip"),n.writeHeader=a.instant(n.resource.type+".acl.write"),n.writeTooltip=a.instant(n.resource.type+".acl.writetooltip"),n.readACPHeader=a.instant(n.resource.type+".acl.readacp"),n.readACPTooltip=a.instant(n.resource.type+".acl.readacptooltip"),n.writeACPHeader=a.instant(n.resource.type+".acl.writeacp"),n.writeACPTooltip=a.instant(n.resource.type+".acl.writeacptooltip"),n.$watch("blockPublicAccessSettings",function(){if(n.blockPublicAccessSettings&&g.isFeatureEnabled(p.FAC.PUBLIC_ACCESS_BLOCK)){var e=n.blockPublicAccessSettings.accountSettings.blockPublicAcls||n.blockPublicAccessSettings.accountSettings.ignorePublicAcls,t=n.blockPublicAccessSettings.bucketSettings.blockPublicAcls||n.blockPublicAccessSettings.bucketSettings.ignorePublicAcls;if(e||t){var r=e&&t?"both":e?"account":"bucket";n.blockPublicACLsMessage=a.instant("lockdown.warning.blocked.acls."+r)}}}),n.showAddGranteeRow=function(){n.isAddGranteeRowDisplayed=!0,n.error=void 0,m.analyticsTrackClick(p.ANALYTICS.ADD_GRANTEE,p.ANALYTICS.DETAILS),n.selectedGrantee=void 0,n.onPanelClose(),i(function(){e.element(".grantee-list input").focus()})},n.currentUserAccount={id:null},n.accountRelationLabel={yours:n.isBucketPermission?"bucket.myaccount.defaultname":"object.myaccount.defaultname",others:n.isBucketPermission?"bucket.othersaccount.defaultname":"object.othersaccount.defaultname"},n.getAccountId=function(){var e=new l("Permissions","getAccountId");return n.currentUserAccount.id?o.when(n.currentUserAccount.id):s.listAllMyBuckets(e,!0).catch(function(){return""}).then(function(e){return t.get(e,"response.ListAllMyBucketsResult.Owner.ID")}).then(function(e){return n.currentUserAccount.id=e,e})},n.getAccountId();var C=[n.predefinedGroups[0].text,n.predefinedGroups[1].text,n.predefinedGroups[2].text];n.addNewGranteeToACL=function(e){n.addingGrantee=!0;var r=t.cloneDeep(n.permissionObj.aclGrants);e.inputItem=e.inputItem.trim(),-1===C.indexOf(e)&&(e=m.validateEmail(e.inputItem)?{EmailAddress:e.inputItem,grantPermissions:e.grantPermissions}:{ID:e.inputItem,grantPermissions:e.grantPermissions}),d.addNewPermissions(e.grantPermissions,e,r),n.putAcl(r).then(function(){n.granteeList.inputItem=null,n.granteeList.inputError=null,v(!0===n.isBucketPermission)}).catch(function(e){n.granteeList.inputError=e,n.addingGrantee=!1})},n.getPublicPermissionDisplayName=function(e){return p.PUBLIC_PERMISSIONS_LIST.indexOf(e)>-1?_[e]:e};var _=(A={},r(A,p.PUBLIC_PERMISSIONS_LIST[0],t.find(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:p.PUBLIC_PERMISSIONS_LIST[0]}}).detail.text),r(A,p.PUBLIC_PERMISSIONS_LIST[1],t.find(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:p.PUBLIC_PERMISSIONS_LIST[1]}}).detail.text),A),w=r({},p.SYSTEM_PERMISSIONS_LIST[0],a.instant("permissions.acl.log"));n.getSystemPermissionDisplayName=function(e){return p.SYSTEM_PERMISSIONS_LIST.indexOf(e)>-1?w[e]:e},n.updateGrantee=function(e){if(!n.confirmModalVisible&&n.shouldWarnLosingPermissionsOwnAccount())return n.confirmModal.word="",void(n.confirmModalVisible=!0);n.updatingGrantee=!0,n.granteeList.inputError=null;var r=t.cloneDeep(n.permissionObj.aclGrants),i=void 0,a=void 0;e.granteeDetails.DisplayName||e.granteeDetails.ID?(a=n.permissionObj.owner.ID===e.granteeDetails.ID?p.GRANTEE_GROUP.OWNER:p.GRANTEE_GROUP.ACCOUNTS,i=e.granteeDetails.ID):e.granteeDetails.URI&&(i=e.granteeDetails.URI.split("/")[5],a=t.indexOf(p.SYSTEM_PERMISSIONS_LIST,i)>-1?p.GRANTEE_GROUP.SYSTEM:p.GRANTEE_GROUP.GROUP);var o={allPermissionsRevoked:!0,fullControlAdded:!1};d.aclsUpdate(r,n.permissionObj.grantees[a],e.permissions,e.granteeDetails,i,o),n.putAcl(r).then(function(){t.isEmpty(n.permissionObj)||(n.permissionObj.aclGrants=r),!0===o.allPermissionsRevoked&&a===p.GRANTEE_GROUP.ACCOUNTS?delete n.permissionObj.grantees.accounts[i]:n.permissionObj.grantees[a][i]=t.clone(e.permissions),n.savedBucketAcl=!0,n.analyzeAccess?n.analyzeAccess({cacheAllowed:!1}).then(function(){n.aclAfterAnalysis=!0}).finally(function(){E()}):E()}).catch(function(e){n.error=e,E()})},n.onPanelClose=function(){n.panelHide=!0,n.radioSelect.displayName=null},n.panelCancel=function(){n.onPanelClose(),n.selectedGrantee=void 0},n.getPublicPermissionsWarning=function(){var e=p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions[1].detail.value,r=p.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions[0].detail.value,i=t.get(n,"selectedGrantee.displayedValue");return i!==e&&i!==r?{isVisible:!1}:void 0!==t.find(n.permissionObj.grantees.group[i],function(e){return!0===e})?{body:a.instant(n.resource.type+".warningbody.granted."+i),header:a.instant(n.resource.type+".warningheader.granted."+i),isVisible:!0}:void 0!==t.find(n.selectedGrantee.permissions,function(e){return!0===e})?{body:a.instant(n.resource.type+".warningbody.granting."+i),header:a.instant(n.resource.type+".warningheader.granting."+i),isVisible:!0}:void 0},n.hasGrant=function(e){return e.READ||e.READ_ACP||e.WRITE||e.WRITE_ACP},n.selectGrantee=function(e,r){n.isAddGranteeRowDisplayed=!1,n.radioSelect.displayName=e,n.selectedGrantee={displayedValue:e,granteeDetails:S(e)},n.selectedGrantee.permissions=t.clone(r),n.panelOpen=!0,n.panelHide=!1,n.error=void 0},n.resetInputError=function(){t.isEmpty(n.granteeList.inputError)||(n.granteeList.inputError=null)},n.deleteAccountGrantee=function(){n.disableDeleteButton()||(n.selectedGrantee.permissions={READ:!1,WRITE:!1,READ_ACP:!1,WRITE_ACP:!1},n.updateGrantee(n.selectedGrantee))},n.disableDeleteButton=function(){var e=t.get(n,"permissionObj.owner.ID"),r=t.get(n,"radioSelect.displayName"),i=t.get(n,"selectedGrantee.displayedValue");return n.shouldDisable||!(!t.isEmpty(r)&&-1===p.PUBLIC_PERMISSIONS_LIST.indexOf(r)&&r!==p.LOG_DELIVERY_VALUE&&i===r)||!t.isEmpty(r)&&r===e},n.confirmModal={word:"",alertContent:a.instant("bucket.warningbody.revokeAccess.myaccount"),confirmInstruction:a.instant("bucket.confirminstruction.revokeAccess.myaccount"),permissionsRemoved:[]};var T=a.instant("bucket.confirmword.revokeAccess.myaccount");n.disableConfirmButton=function(){return t.trim(n.confirmModal.word)!==T},n.closeConfirmModal=function(){n.confirmModalVisible=!1},n.shouldWarnLosingPermissionsOwnAccount=function(){var e=t.get(n,"selectedGrantee")||{},r=t.get(n,"permissionObj.owner.ID"),i=(t.get(n,"permissionObj.grantees.owner")||{})[r],a=t.reduce(e.permissions,function(e,t,n){return i[n]&&!t&&e.push(n),e},[]),o=!!a.length;return n.confirmModal.permissionsRemoved=a.map(function(e){switch(e){case"READ":return n.readHeader;case"WRITE":return n.writeHeader;case"READ_ACP":return n.readACPHeader;case"WRITE_ACP":return n.writeACPHeader}}),e.displayedValue===r&&o},n.save=function(){n.granteeList.inputError=null,n.addNewGranteeToACL(n.granteeList)},n.cancel=function(){n.granteeList.inputError=null,y()}}e.module("s3").directive("acl",[function(){return{restrict:"E",scope:{permissionObj:"=",putAcl:"=",error:"=",bucket:"=?",isBucketPermission:"=",shouldDisable:"=?",access:"=",analyzeAccess:"&?",blockPublicAccessSettings:"<?"},template:n(672),controller:"AclController"}}]),e.module("s3").controller("AclController",["$scope","$timeout","$translate","$q","APIProxyService","BucketPropertiesService","ConsoleOperation","PathService","PermissionsUtilService","S3Constants","SCLogService","FAC","UtilService",i])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<awsui-alert visible="access.aclPublic && aclAfterAnalysis" class="block small-top-margin" type=warning dismissible=false header="{{ \'bucket.warningheader.granted.AllUsers\' | translate }}"> {{ \'world.access.detected.warning\' | translate }} </awsui-alert> <awsui-radio-group class=permission-radio-group ng-model=radioSelect.displayName> <div class=manage-grantee-title translate="{{isBucketPermission ? \'permissions.owner\' : \'permissions.object_owner\'}}"></div> <table class=table> <thead class=table-header> <tr> <th class=grantee-radio></th> <th class=grantee-header> {{\'permissions.acl.grantee\' | translate}} <awsui-tooltip text="{{ \'permissions.acl.granteeTooltip\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readHeader}} <awsui-tooltip text={{readTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header ng-if=isBucketPermission>{{writeHeader}} <awsui-tooltip text={{writeTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readACPHeader}} <awsui-tooltip text={{readACPTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{writeACPHeader}} <awsui-tooltip text={{writeACPTooltip}} position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> </tr> </thead> <tbody class=table-body> <tr ng-repeat="(name, permissions) in permissionObj.grantees.owner" ng-if="permissionObj.owner.DisplayName || permissionObj.owner.ID" class=grantee-row ng-click="selectGrantee(name, permissions)" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\' : hoverUser }" ng-mouseenter="hoverUser = true" ng-mouseleave="hoverUser = false"> <td ng-click="selectGrantee(name, permissions)"> <awsui-radio-button value={{name}}></awsui-radio-button> </td> <td class=grantee-id> <span>{{name}} </span> <span data-e2e-id=accountRelation ng-if=currentUserAccount.id> <span data-e2e-id=yourAccount ng-if="currentUserAccount.id === name">({{ accountRelationLabel.yours | translate }})</span> <span data-e2e-id=othersAccount ng-if="currentUserAccount.id !== name">({{ accountRelationLabel.others | translate }})</span> </span> </td> <td> <span ng-if=permissions.READ translate=bucketproperty.yes></span> <span ng-if=!permissions.READ>-</span> </td> <td ng-if=isBucketPermission> <span ng-if=permissions.WRITE translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE>-</span> </td> <td> <span ng-if=permissions.READ_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.READ_ACP>-</span> </td> <td> <span ng-if=permissions.WRITE_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE_ACP>-</span> </td>   </tr> <tr> <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open=panelOpen> <header> <div class="truncate side-panel-header bucket-config-panel-header-image">{{ selectedGrantee.displayedValue }}</div> <span class=panel-close-icon ng-click=panelCancel()></span>  </header> <content> <div class=permissions-side-panel-content> <p class=subheader translate={{resource.type}}.acl.objectaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ>{{ readHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if=isBucketPermission ng-model=selectedGrantee.permissions.WRITE>{{ writeHeader }}</awsui-checkbox> <p class="subheader padding-top-30" translate={{resource.type}}.acl.permissionsaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ_ACP>{{ readACPHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.WRITE_ACP>{{ writeACPHeader }}</awsui-checkbox> </div> </content> <footer> <awsui-button variant=primary text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click=updateGrantee(selectedGrantee) loading=updatingGrantee></awsui-button> <awsui-button variant=normal text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click=panelCancel()></awsui-button> </footer> </storage-console-config-panel> </tr> </tbody> </table> <div class=manage-grantee-title translate=permissions.manageusers></div> <div class=acl-add-new> <awsui-button variant=primary data-disabled=shouldDisable text="{{\'permissions.button.addgrantee\'  | translate}}" icon=plus click=showAddGranteeRow()></awsui-button> <awsui-button data-disabled="disableDeleteButton() " text="{{\'permissions.button.deletegrantee\'  | translate}}" click=deleteAccountGrantee()></awsui-button> </div> <table class=table> <thead class=table-header> <tr> <th class=grantee-radio></th> <th class=grantee-header> {{\'permissions.acl.grantee\' | translate}} <awsui-tooltip text="{{ \'permissions.acl.granteeTooltip\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readHeader}} <awsui-tooltip text={{readTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header ng-if=isBucketPermission>{{writeHeader}} <awsui-tooltip text={{writeTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readACPHeader}} <awsui-tooltip text={{readACPTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{writeACPHeader}} <awsui-tooltip text={{writeACPTooltip}} position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> </tr> </thead> <tbody class=table-body> <tr ng-if=isAddGranteeRowDisplayed> <td></td> <td class=add-grantee-options> <awsui-control-group validation-message="{{ granteeList.inputError }}"> <awsui-textfield class=grantee-list placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}" ng-change=resetInputError() ng-model=granteeList.inputItem></awsui-textfield> </awsui-control-group> <awsui-button id=save-grantee variant=primary text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button add-grantee-buttons" data-disabled="!granteeList.inputItem  || (!granteeList.grantPermissions.READ && !granteeList.grantPermissions.WRITE && !granteeList.grantPermissions.READ_ACP && !granteeList.grantPermissions.WRITE_ACP) || granteeList.inputError" click=save() loading=addingGrantee> </awsui-button> <awsui-button id=cancel-grantee variant=normal text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button add-grantee-buttons" click=cancel()> </awsui-button> </td> <td class=grantee-checkboxes> <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model=granteeList.grantPermissions.READ>{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox> </td> <td class=grantee-checkboxes ng-if=isBucketPermission> <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model=granteeList.grantPermissions.WRITE>{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox> </td> <td class=grantee-checkboxes> <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model=granteeList.grantPermissions.READ_ACP>{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox> </td> <td class=grantee-checkboxes> <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model=granteeList.grantPermissions.WRITE_ACP>{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox> </td> </tr> <tr ng-repeat="(name, permissions) in permissionObj.grantees.accounts" class=grantee-row ng-click="selectGrantee(name, permissions)" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\' : hoverUser }" ng-mouseenter="hoverUser = true" ng-mouseleave="hoverUser = false"> <td ng-click="selectGrantee(name, permissions)"> <awsui-radio-button value={{name}}> <td class=grantee-id>{{name}}</td> <td> <span ng-if=permissions.READ translate=bucketproperty.yes></span> <span ng-if=!permissions.READ>-</span> </td> <td ng-if=isBucketPermission> <span ng-if=permissions.WRITE translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE>-</span> </td> <td> <span ng-if=permissions.READ_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.READ_ACP>-</span> </td> <td> <span ng-if=permissions.WRITE_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE_ACP>-</span> </td> </awsui-radio-button> </td> </tr> <tr> <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open=panelOpen> <header> <div class="truncate side-panel-header bucket-config-panel-header-image">{{ selectedGrantee.displayedValue }}</div> <span class=panel-close-icon ng-click=panelCancel()></span>  </header> <content> <div class=permissions-side-panel-content> <p class=subheader translate={{resource.type}}.acl.objectaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ>{{ readHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if=isBucketPermission ng-model=selectedGrantee.permissions.WRITE>{{ writeHeader }}</awsui-checkbox> <p class="subheader padding-top-30" translate={{resource.type}}.acl.permissionsaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ_ACP>{{ readACPHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.WRITE_ACP>{{ writeACPHeader }}</awsui-checkbox> </div> </content> <footer> <awsui-button variant=primary text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click=updateGrantee(selectedGrantee) loading=updatingGrantee></awsui-button> <awsui-button variant=normal text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click=panelCancel()></awsui-button> </footer> </storage-console-config-panel> </tr> </tbody> </table> <div class=manage-public-permission-title translate=permissions.managepublicpermissions></div> <awsui-alert ng-if=blockPublicACLsMessage type=warning id=blockPublicACLsAlert>{{blockPublicACLsMessage}}</awsui-alert> <table class=table> <thead class=table-header> <tr> <th class=grantee-radio></th> <th class=grantee-header> {{\'permissions.acl.group\' | translate}} <awsui-tooltip text="{{ \'permissions.acl.groupTooltip\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readHeader}} <awsui-tooltip text={{readTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header ng-if=isBucketPermission>{{writeHeader}} <awsui-tooltip text={{writeTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readACPHeader}} <awsui-tooltip text={{readACPTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{writeACPHeader}} <awsui-tooltip text={{writeACPTooltip}} position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> </tr> </thead> <tbody class=table-body> <tr ng-repeat="(name, permissions) in permissionObj.grantees.group" ng-click="selectGrantee(name, permissions)" class=grantee-row ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\': hoverGroup}" ng-mouseenter="hoverGroup = true" ng-mouseleave="hoverGroup = false" ng-if="name === \'AllUsers\' || hasGrant(permissions)"> <td ng-click="selectGrantee(name, permissions)"> <awsui-radio-button value={{name}}> <td>{{ getPublicPermissionDisplayName(name)}}</td> <td> <span ng-if=permissions.READ translate=bucketproperty.yes></span> <span ng-if=!permissions.READ>-</span> </td> <td ng-if=isBucketPermission> <span ng-if=permissions.WRITE translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE>-</span> </td> <td> <span ng-if=permissions.READ_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.READ_ACP>-</span> </td> <td> <span ng-if=permissions.WRITE_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE_ACP>-</span> </td> </awsui-radio-button> </td> </tr> <tr> <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open=panelOpen> <header> <div class="truncate side-panel-header bucket-config-panel-header-image">{{ getPublicPermissionDisplayName(selectedGrantee.displayedValue) }}</div> <span class=panel-close-icon ng-click=panelCancel()></span>  </header> <content> <div class=permissions-side-panel-content> <p class=subheader translate=permissions.acl.objectaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ>{{ readHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.WRITE>{{ writeHeader }}</awsui-checkbox> <p class="subheader padding-top-30" translate=permissions.acl.permissionsaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ_ACP>{{ readACPHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.WRITE_ACP>{{ writeACPHeader }}</awsui-checkbox> </div> </content> <footer> <awsui-button variant=primary text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click=updateGrantee(selectedGrantee) loading=updatingGrantee></awsui-button> <awsui-button variant=normal text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click=panelCancel()></awsui-button> </footer> </storage-console-config-panel> </tr> </tbody> </table> <div class=manage-public-permission-title translate=permissions.managesystempermissions ng-if=isBucketPermission> </div> <table id=system-permissions-table class=table ng-if=isBucketPermission> <thead class=table-header> <tr> <th class=grantee-radio></th> <th class=grantee-header> {{\'permissions.acl.group\' | translate}} <awsui-tooltip text="{{ \'permissions.acl.groupTooltip\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readHeader}} <awsui-tooltip text={{readTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header ng-if=isBucketPermission>{{writeHeader}} <awsui-tooltip text={{writeTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{readACPHeader}} <awsui-tooltip text={{readACPTooltip}} position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th class=grantee-header> {{writeACPHeader}} <awsui-tooltip text={{writeACPTooltip}} position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> </tr> </thead> <tbody class=table-body> <tr ng-repeat="(name, permissions) in permissionObj.grantees.system" ng-click="selectGrantee(name, permissions)" class=grantee-row ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\': hoverGroup}" ng-mouseenter="hoverGroup = true" ng-mouseleave="hoverGroup = false"> <td ng-click="selectGrantee(name, permissions)"> <awsui-radio-button value={{name}}> <td> {{ getSystemPermissionDisplayName(name)}} </td> <td> <span ng-if=permissions.READ translate=bucketproperty.yes></span> <span ng-if=!permissions.READ>-</span> </td> <td ng-if=isBucketPermission> <span ng-if=permissions.WRITE translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE>-</span> </td> <td> <span ng-if=permissions.READ_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.READ_ACP>-</span> </td> <td> <span ng-if=permissions.WRITE_ACP translate=bucketproperty.yes></span> <span ng-if=!permissions.WRITE_ACP>-</span> </td> </awsui-radio-button> </td> </tr> <tr> <storage-console-config-panel id=system-permissions-side-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open=panelOpen> <header> <div class="truncate side-panel-header bucket-config-panel-header-image">{{ getPublicPermissionDisplayName(selectedGrantee.displayedValue) }}</div> <span class=panel-close-icon ng-click=panelCancel()></span>  </header> <content> <div class=permissions-side-panel-content> <awsui-alert visible=getPublicPermissionsWarning().isVisible class="block small-top-margin" type=warning dismissible=false header="{{ getPublicPermissionsWarning().header }}"> {{ getPublicPermissionsWarning().body }} </awsui-alert> <p class=subheader translate={{resource.type}}.acl.objectaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ>{{ readHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if=isBucketPermission ng-model=selectedGrantee.permissions.WRITE>{{ writeHeader }}</awsui-checkbox> <p class="subheader padding-top-30" translate={{resource.type}}.acl.permissionsaccess></p> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.READ_ACP>{{ readACPHeader }}</awsui-checkbox> <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model=selectedGrantee.permissions.WRITE_ACP>{{ writeACPHeader }}</awsui-checkbox> </div> </content> <footer> <awsui-button id=save-system-permissions variant=primary text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click=updateGrantee(selectedGrantee) loading=updatingGrantee></awsui-button> <awsui-button id=cancel-system-permissions variant=normal text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click=panelCancel()></awsui-button> </footer> </storage-console-config-panel> <awsui-modal class=acl-modal header="{{ \'bucket.warningmodalheader.revokeAccess.myaccount\' | translate }}" visible=confirmModalVisible> <span dom-region=content> <awsui-alert visible=true type=warning dismissible=false header="{{ \'bucket.warningheader.revokeAccess.myaccount\' | translate }}"> {{ \'bucket.warningbody.revokeAccess.myaccount\' | translate }} <ul> <li ng-repeat="permission in confirmModal.permissionsRemoved">{{permission}}</li> </ul> </awsui-alert> <p class=label ng-bind-html="confirmModal.confirmInstruction | trusted"></p> <awsui-textfield id=deletebucket-input class=bucket-name placeholder="{{ \'bucket.confirmword.revokeAccess.myaccount\' | translate }}" ng-model=confirmModal.word> </awsui-textfield> </span> <span dom-region=footer> <awsui-button text="{{ \'permissions.button.cancel\' | translate}}" variant=link click=closeConfirmModal()></awsui-button> <awsui-button text="{{ \'confirmationmodal.footer.confirm\' | translate}}" variant=primary data-disabled=disableConfirmButton() click="updateGrantee(selectedGrantee); closeConfirmModal()"></awsui-button> </span> </awsui-modal> </tr> </tbody> </table> </awsui-radio-group> '},function(e,t,n){"use strict";(function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function i(i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A){function C(e,t){var r=void 0,i=void 0;if(n.isArray(t)&&e&&"string"==typeof e){if(e.indexOf(v.OBJECT_SSE.KMS.ALIAS)>-1){var a=v.OBJECT_SSE.KMS.ALIAS;return e.substring(e.indexOf(a)+a.length)}var o=e.split(v.OBJECT_SSE.KMS.KEY);if(2===o.length&&(r=o[1]),i=n.filter(t,function(e){return e.value.indexOf(r)>-1&&e.text}),1===i.length)return i[0].text}return e}function _(){var e=b.DOMAINS.PUBLIC.NAME,t=c.host();return n.each(b.DOMAINS,function(r,i){(n.contains(t,r.SUFFIX)||n.contains(t,r.GAMMA))&&(e=r.NAME)}),e}function w(e,t){return t.some(function(t){return t.Name===e})}var T=t("body"),R=this;this.createQueue=function(e){function t(){if(o!==a.length){var e=a[o];return o++,o>=(a.length-1)/2&&(a=a.slice(o),o=0),e}}function n(e){a.push(e)}function r(){return a.length-o}function i(){return a[o]}var a=[],o=0;return Array.isArray(e)&&(a=e),{dequeue:t,enqueue:n,getLength:r,peek:i}},this.escapePath=function(e){for(var t=e.split(v.DELIMITER),n=[],r=0;r<t.length;r++){var i=encodeURIComponent(t[r]),a=i.replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/!/g,"%21").replace(/'/g,"%27");n.push(a)}return n.join("/")},this.extractTopicName=function(e){return e.substring(e.lastIndexOf(":")+1)},this.extractQueueName=function(e){return e.substring(e.lastIndexOf("/")+1)},this.getIconClassFromFilename=function(e){if(e){var t=e.substr(e.lastIndexOf(".")+1);if(v.FILE_EXTENSIONS_ICON_MAP.hasOwnProperty(t))return v.FILE_EXTENSIONS_ICON_MAP[t]}return v.FILE_EXTENSIONS_ICON_MAP.default},this.getStorageClassTranslations=function(){return{STANDARD:d.instant("uploadmodal.label.standard"),"STANDARD-IA":d.instant("versionsdropdown.label.standard_ia"),STANDARD_IA:d.instant("versionsdropdown.label.standard_ia"),ONEZONE_IA:d.instant("storageclass.zia"),"ONEZONE-IA":d.instant("storageclass.zia"),INTELLIGENT_TIERING:d.instant("storageclass.selector.isidore.name"),REDUCED_REDUNDANCY:d.instant("uploadmodal.label.reduced_redundancy"),GLACIER:d.instant("versionsdropdown.label.glacier"),DEEP_ARCHIVE:d.instant("storageclass.selector.deeparchive.name")}},this.getStorageClassOrder=function(e){switch(e){case"STANDARD":return 1;case"INTELLIGENT_TIERING":return 2;case"STANDARD_IA":return 3;case"ONEZONE_IA":return 4;case"GLACIER":return 5;case"DEEP_ARCHIVE":return 6;case"REDUCED_REDUNDANCY":return 7}},this.getEncryptionTranslations=function(){var e;return e={},r(e,v.OBJECT_SSE.NONE,d.instant("sse.none")),r(e,v.OBJECT_SSE.AES256,d.instant("sse.aes256")),r(e,v.OBJECT_SSE.KMS_ENCRYPTION,d.instant("sse.aws.kms")),r(e,v.OBJECT_SSE.SSEC,d.instant("sse.customkey")),e},this.transformListOfOptionsToDropdown=function(e){return n.map(e,function(e){return{text:e,value:e,disabled:!1}})},this.getKmsKeyAlias=function(e){if(n.isArray(e.AliasList)&&e.AliasList.length>0){var t=e.AliasList[0].Alias,r=t.split(v.OBJECT_SSE.KMS.ALIAS);if(2===r.length)return r[1]}return e.KeyArn},this.getKMSAliasForArn=C,this.getKMSKeyObjFromArn=function(t,n){var r=void 0,i=C(t,n);return e.forEach(n,function(e){e.value===i&&(r=e)}),r},this.getStorageClassOptions=function(t){var n=this,r=[];return e.forEach(t,function(e){var t=n.getStorageClassTranslations()[e];t||(t=e),r.push({value:e,text:t})}),r.length>0?r:null},this.transformObjectToArray=function(e){return[].concat(e)},this.parseFunctionArn=function(e){var t={},n=this.getLambdaARNPrefix(),r=e.substring(e.indexOf(n)+n.length+1),i=r.split(":");return t.region=i[0],t.accountNum=i[1],t.functionName=i[3],t},this.getFACRegions=function(e,t){var r=arguments.length<=2||void 0===arguments[2]?v.FAC.PROD_STACK:arguments[2];n.isEmpty(t)&&n.forEach(e,function(e){if(v.FALLBACK_REGION_LIST[_()].indexOf(e.value)>-1){var n=r+"-"+e.value;h.isFeatureEnabled(n)&&t.push(e)}})},this.getCloudSystem=_,this.getIamRoleNameFromArn=function(e){if(e){var t=e.split("/");if(t.length>0)return t.pop()}},this.getIamAccountSettingsLink=function(){return A.getConsoleServiceUrl("iam",b.getCurrentRegion(),"#/account_settings")},this.getIamRoleLink=function(e){return A.getConsoleServiceUrl("iam",b.getCurrentRegion(),"#/roles/"+e)},this.getLambdaFunctionLink=function(e,t){return A.getConsoleServiceUrl("lambda",e,"#/functions/"+t)},this.getAccountIdFromARN=function(e){try{return e.match(/[0-9]{12}/)[0]}catch(e){return null}},this.getUserAccountId=function(){try{return this.getAccountIdFromARN(this.getUserNameARN())}catch(e){return null}},this.getUserNameARN=function(){try{return JSON.parse(a.get("aws-userInfo")).arn}catch(e){return null}},this.getCookie=function(e){var t="; "+document.cookie,n=t.split("; "+e+"=");if(2===n.length)return n.pop().split(";").shift()},this.analyticsTrackClick=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];n.s_fid=this.getCookie("s_fid"),n["session-id"]=this.getCookie("session-id"),g.Analytics.trackClick({id:e,context:t,metaData:n})},this.analyticsTrackView=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];n.s_fid=this.getCookie("s_fid"),n["session-id"]=this.getCookie("session-id"),g.Analytics.trackView({id:e,context:t,metaData:n})},this.createOrUpdateRoleForReplication=function(e,t,r,i,a){var o=this.getUserAccountId(),s=u.defer();if(null===o)return s.reject(),s.promise;var c=this.getIamARNPrefix(),l=""+c+o+":";return i?m.createPolicyForServiceRole(e,t,"s3.amazonaws.com",a.name,a.versionNum,l+"policy/service-role/"+t,r,this.getDefaultRegion()).then(function(){return s.resolve(),s.promise}).catch(function(e){var t=n.get(e,"response.Error.Code");return t===E.ERROR_CODE.ENTITY_EXIST||t===E.ERROR_CODE.LIMIT_EXCEED?s.resolve():s.reject(e),s.promise}):m.zeroClickRoleCreation(e,t,"s3.amazonaws.com",a.name,a.versionNum,l+"policy/service-role/"+t,r,this.getDefaultRegion()).then(function(e){return s.resolve(l+"role/service-role/"+e.request.params.RoleName),s.promise}).catch(function(e){return s.reject(e),s.promise})},this.createOrUpdateRoleForReplication_v1=function(e,t,r,i,a){var o=this.getUserAccountId(),s=u.defer();if(null===o)return s.reject(),s.promise;var c={accountId:o,srcbucket:r,dstbucket:i},l=this.getIamARNPrefix(),d=""+l+o+":";return a?m.createPolicyForServiceRole(e,t,"s3.amazonaws.com","s3console_crr_iam_template",2,d+"policy/service-role/"+t,c,this.getDefaultRegion()).then(function(){return s.resolve(),s.promise}).catch(function(e){var t=n.get(e,"response.Error.Code");return t===v.REPLICATION.ERROR_CODE.ENTITY_EXIST||t===v.REPLICATION.ERROR_CODE.ACCESS_DENIED||t===v.REPLICATION.ERROR_CODE.LIMIT_EXCEED?s.resolve():s.reject(e),s.promise}):m.zeroClickRoleCreation(e,t,"s3.amazonaws.com","s3console_crr_iam_template",2,d+"policy/service-role/"+t,c,this.getDefaultRegion()).then(function(e){return s.resolve(d+"role/service-role/"+e.request.params.RoleName),s.promise}).catch(function(e){return s.reject(e),s.promise})},this.convertToArray=function(e){if(!Array.isArray(e)){var t=e;e=[],e.push(t)}return e},this.convertStringToBoolean=function(e){return"true"===e||"false"!==e&&void 0},this.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},this.isStorageClassRestorable=function(e){return!!n.isString(e)&&(e.toUpperCase()===v.STORAGE_CLASSES.GLACIER||e.toUpperCase()===v.STORAGE_CLASSES.DEEP_ARCHIVE)},this.encodeXml=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e},this.scrollCardToView=function(e){document.getElementById(e).scrollIntoView()},this.scrollCardToViewSmoothly=function(e){t("html, body").animate({scrollTop:n.isEmpty(e)?0:t(e).offset().top},300)},this.scrollTo=function(e){p(i,10,!1,e)};var O=function(e,t){return n.isEmpty(e)?t.status&&Object.keys(v.STATUS_CODE_MAP).indexOf(t.status.toString())>-1?v.STATUS_CODE_MAP[t.status.toString()]:d.instant("utilities.unknown.error"):"null"===e||"undefined"===e?d.instant("utilities.unknown.error"):e};this.isObjectWithSSECEncryption=function(e){return n.get(e,"status")===v.HTTP_STATUS_CODES.BAD_REQUEST&&"GetObjectMetadata"===n.get(e,"request.operation")},this.getErrorMessage=function(e){if(e){if(n.isString(e))return"Access Denied"===e||"AccessDenied"===e?d.instant("resource.access.denied"):e;if(e.data&&e.data.requestStatus&&"error"===e.data.requestStatus)return e.data.errorCode.indexOf(v.HTTP_STATUS_CODES.ACCESS_DENIED.toString())>-1?d.instant("resource.access.denied"):e.data.errorCode.toString();if(e.status&&e.status===v.HTTP_STATUS_CODES.ACCESS_DENIED)return d.instant("resource.access.denied")}},this.handleErrors=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=arguments.length<=2||void 0===arguments[2]?"":arguments[2];if(t&&n.isObject(e)){var i=n.get(e,"data.statusPerKey[0].result.errorCode"),a=n.get(e,"data.statusPerKey[0].result");if(i&&i.length&&a){if("AccessDenied"===i)a.errorMessageLocalized=d.instant("resource.access.denied");else{var o=r+"."+i.toLowerCase(),s=d.instant(o);s!==o&&(a.errorMessageLocalized=s)}return a}return{errorMessageLocalized:d.instant("utilities.unknown.error")}}if("CSRFException"===n.get(e,"response.code","")){var l=c.absUrl().split("/s3/"),u=void 0;return l&&l.length>0&&(u=l[0]+"/s3/home?region="+this.getDefaultRegion()),{link:u,text:d.instant("crsferror"),isSecurityError:!0}}if(!n.isEmpty(e)){if(n.isString(e))return"access denied"===e.toLowerCase()||"accessdenied"===e.toLowerCase()?d.instant("resource.access.denied"):e;if(R.isObjectWithSSECEncryption(e))return"";if(n.isString(e.response))return O(e.response,e);if(e.response&&e.response.Error&&n.isString(e.response.Error.Message))return O(e.response.Error.Message,e);if(e.response&&n.isString(e.response.Message))return O(e.response.Message,e);if(e.Error&&e.Error.Message&&n.isString(e.Error.Message))return O(e.Error.Message,e);if(e.response&&e.response.message&&n.isString(e.response.message))return O(e.response.message,e);if(e.data&&"error"===e.data.requestStatus&&e.data.errorCode&&e.data.errorCode.indexOf(v.HTTP_STATUS_CODES.ACCESS_DENIED.toString())>-1)return d.instant("resource.access.denied");if(n.isObject(e)&&n.keys(e).length>0){if(n.keys(e)[0].indexOf("Forbidden")>-1)return d.instant("resource.access.denied");if(n.keys(e)[0].indexOf("Key")>-1)return n.keys(e)[0]}}return Array.isArray(e)&&e[0]===v.SESSION_TIMEOUT_MESSAGE?(this.handleSessionTimeout(),v.SESSION_TIMEOUT_MESSAGE):d.instant("utilities.unknown.error")},this.isValidBucketName=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];if(!e)return t.push(d.instant("createbucketmodal.validation.invalid.error")),!1;for(var n="\0",r="",i=0;i<e.length;i++){var a=e.charAt(i),o="";if(/[A-Z]/.test(a)){var s=d.instant("createbucketmodal.validation.uppercase.error");-1===t.indexOf(s)&&t.push(s)}"."===a?("\0"===n&&(o=d.instant("createbucketmodal.validation.start.error")),"."===n&&(o=d.instant("createbucketmodal.validation.periods.error")),"-"===n&&(o=d.instant("createbucketmodal.validation.dashperiod.error"))):"-"===a?("\0"===n&&(o=d.instant("createbucketmodal.validation.start.error")),"."===n&&(o=d.instant("createbucketmodal.validation.dashperiod.error"))):/[a-z0-9]/.test(a)||-1!==r.indexOf(a)||(/[A-Z]/.test(a)||(r+=a),"\0"===n&&(o=d.instant("createbucketmodal.validation.start.error"))),o&&-1===t.indexOf(o)&&t.push(o),n=a}return"."!==n&&"-"!==n||t.push(d.instant("createbucketmodal.validation.end.error")),r.length>0&&t.push(d.instant("createbucketmodal.validation.badchars.error")+" '"+r+"'"),(e.length<3||e.length>63)&&t.push(d.instant("createbucketmodal.validation.length.error")),/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(e)&&t.push(d.instant("createbucketmodal.validation.ipaddress.error")),0===t.length},this.bodyFreezeScroll=function(e,n){var r=void 0;if(e){r=T.width(),T.addClass("noscroll");var i=T.innerWidth()-r;T.css("paddingRight",i),n&&t(".storage-console-config-panel").css("marginRight",i)}else{r=T.innerWidth();var a=r-T.innerWidth();T.css("paddingRight",a),n&&t(".storage-console-config-panel").css("marginRight",a),T.removeClass("noscroll")}},this.isIE=function(){var e=f.navigator.userAgent;return-1!==e.indexOf("Trident/")||-1!==e.indexOf("MSIE ")||-1!==e.indexOf("Edge/")},this.getRegionOrder=function(){var e=this.getDefaultRegion();try{e=b.getCurrentRegion()}catch(e){}var t=this.getCloudSystem(),r=n.cloneDeep(v.FALLBACK_REGION_LIST_FOR_LAMB_AND_HEADBUCKET[t]);if(t===b.DOMAINS.PUBLIC.NAME){var i=n.indexOf(r,e);i<0?function(){var t=e.substr(0,2),i=n.findIndex(r,function(e){return n.startsWith(e,t)});i<0?r.pop():r.splice(i,1),n.contains(v.OPT_IN_REGION_LIST,e)?r.push(e):r.unshift(e)}():(r.splice(i,1),r.unshift(e))}return r},this.validateEmail=function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},this.reduceObjectArrayToObject=function(e){var t={};return e.forEach(function(e){var n=Object.keys(e);t[e[n[0]]]=e[n[1]]}),t},this.extractFromQuotes=function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=e;return/"/.test(e)&&(n=e.match(/"(.*?)"/gi),n=n[t].substring(1,n[t].length-1)),n},this.formatWithUnits=function(e){return e<1024?Math.round(100*e)/100+" B":e<1048576?Math.round(e/1024)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":e<1099511627776?(e/1024/1024/1024).toFixed(2)+" GB":e<0x4000000000000?(e/1024/1024/1024/1024).toFixed(2)+" TB":(e/1024/1024/1024/1024/1024).toFixed(2)+" PB"},this.copyToClipboard=function(e){if(f.clipboardData&&f.clipboardData.setData)return f.clipboardData.setData("Text",e);if(o[0].queryCommandSupported&&o[0].queryCommandSupported("copy")){var t=o[0].createElement("textarea");t.textContent=e,o[0].body.appendChild(t),t.select();try{return o[0].execCommand("copy")}catch(e){return!1}finally{o[0].body.removeChild(t)}}},this.getBucketARN=function(e){return""+this.getARNPrefix(v.AWS_SERVICE.S3)+e},this.getBucketARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.S3)},this.getLambdaARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.LAMBDA)},this.getIamARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.IAM)},this.getSqsARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.SQS)},this.getSnsARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.SNS)},this.getKmsARNPrefix=function(){return this.getARNPrefix(v.AWS_SERVICE.KMS)},this.getARNPrefix=function(e){var t=this.getCloudSystem();return t===v.REGION_DOMAIN["ISO-B"]&&(t=v.REGION_DOMAIN.ISOB),""+b.DOMAINS[t].ARN+v.ARN_SERVICE[e]},this.getPartition=function(){var e=this.getCloudSystem();return e?b.DOMAINS[e].ARN.split("arn:")[1]:""},this.formatXml=function(e){var t="",n=/(>)(<)(\/*)/g;e=e.replace(n,"$1\r\n$2$3");var r=0;return e.split("\r\n").forEach(function(e){var n=0;e.match(/.+<\/\w[^>]*>$/)?n=0:e.match(/^<\/\w/)?0!==r&&(r-=1):n=e.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var i="",a=0;a<r;a++)i+="  ";t+=i+e+"\r\n",r+=n}),t},this.checkValue=function(e,t){var n=this,r=!1;return e&&function(){var i=n.transformObjectToArray(t),a=n.transformObjectToArray(e);r=a.some(function(e){return i.some(function(t){return t===e})})}(),r},this.copyDataToClipboard=function(e,t){this.copyToClipboard(e),t.flag=!0,p(function(){t.flag=!1},1e3)},this.copyPathToClipboard=function(e,t){var n=S.relativeToAbsoluteObjectPath(e),r=S.getCurrentBucket();this.copyToClipboard("s3://"+r+"/"+n),t.flag=!0,p(function(){t.flag=!1},1e3)},this.validateBucketName=function(e,t,n){var r=[];this.isValidBucketName(e,r)?w(e,n)?(t.length=0,t.push(d.instant("createbucketmodal.bucketname.exists.error"))):t.length=0:(t.length=0,r.forEach(function(e){t.push(e)}))},this.handleSessionTimeout=function(){if(this.isDevelopmentMode())return void f.console.warn("Received session timeout as a response");var e=!1;(!this.isIE()||this.isIE()&&this.getCookie("aws-creds"))&&(e=f.confirm(d.instant("sessionauth.expired"))),e&&f.location.reload()},this.getPricingUrl=function(e){return A.getMarketingUrl(e+"/pricing")},this.getDataRetrievalUrl=function(){return A.getMarketingUrl("glacier/faqs/#dataretrievals")},this.getDefaultRegion=function(){return v.DEFAULT_REGION[this.getCloudSystem()]},this.getAWSCMezzRegion=function(){if(o[0]&&o[0].head&&o[0].head.querySelector('[id="awsc-mezz-region"]'))return o[0].head.querySelector('[id="awsc-mezz-region"]').content},this.CRRFACHandle=function(){var e=h.isFeatureEnabled(v.FAC.CRR),t=h.isFeatureEnabled(v.FAC.CRR_V2);return{v1:e&&!t,v2:t}},this.getKeyVersionIds=function(e){return n.map(e,function(e){return{key:e.Key,version:e.VersionId||null}})},this.getContentType=function(e){var t=e.type,n=e.name.split(".").pop().toLowerCase(),r=v.CONTENT_TYPE_VAL_FROM_EXT[n];return r&&(t=r),t},this.getTrailName=function(e){var t=e.split(":trail/");return 2===t.length?t[1]:e},this.getTrailRegionFromARN=function(e){var t=void 0,r=e.split(":cloudtrail:");return r.length>0&&(t=r[1].split(":")[0]),n.isEmpty(t)&&(t=this.getDefaultRegion()),t},this.extractRegionFromKmsArn=function(e){var t=e.split(this.getKmsARNPrefix())[1];return t?t.split(":")[0]:""},this.extractKeyIDFromKmsArn=function(e){return e?e.split("/")[1]:""},this.getKmsKeysFromIamPolicy=function(e){var t=[];return e.length>0&&n.forEach(e,function(e){t=t.concat(e.Resource)}),n.unique(t)},this.replaceNotAllowedChars=function(e,t,n){return t?e.replace(new RegExp(t,"g"),n):e},this.isDevelopmentMode=function(){return!1},this.formatDate=function(e,t){return t instanceof Array?t.map(function(t){return l("date")(e,t)}).join(" "):l("date")(e,t)},this.getShortDateWithoutYearPattern=function(){return s.DATETIME_FORMATS.shortDate.replace(/yy\/|y\/|\/yy|\/y/gi,"")},this.formatShortDateWithoutYear=function(e){var t=this.getShortDateWithoutYearPattern();return l("date")(e,t)},this.getShortDateTimeWithoutYearPattern=function(){return this.getShortDateWithoutYearPattern()+" HH:mm"},this.formatShortDateTimeWithoutYear=function(e){var t=this.getShortDateTimeWithoutYearPattern();return l("date")(e,t)},this.getDaysString=function(e){return 1===parseInt(e,10)?d.instant("units.time.days.one"):d.instant("units.time.days.many")},this.hexToBase64=function(e){return btoa(e.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""))},this.isOneBox=function(){return null!==document.getElementById("is-onebox")}}e.module("s3").service("UtilService",["$anchorScroll","$cookies","$document","$locale","$location","$filter","$q","$translate","$timeout","$window","AWSC","EZCRCService","FAC","Region","S3Constants","ReplicationConstants","PathService","CLOUD_SYSTEMS","AwsUrlsService",i])}()}).call(t,n(0),n(6),n(2))},function(e,t,n){"use strict";(function(e){!function(){function t(e,t){function n(n,r,i){var a=t.getUserAccountId();if(!a)return null;var o=e.S3_SHARED_DATA.OBJECT_TEMPLATE.replace("<account-id>",a).replace("<bucket-name>",n).replace("<config-id>",r),s=e.S3_SHARED_DATA.STATUS_TEMPLATE.replace("<account-id>",a).replace("<bucket-name>",n).replace("<config-id>",r),c=e.S3_SHARED_DATA.ANALYTICS_BUCKET_TEMPLATE.replace("<region>",i);return{data:o,status:s,bucket:c,fullDataPath:c+"/"+o}}function r(n,r,i){var a=t.getUserAccountId();if(!a)return null;var o=e.S3_SHARED_DATA.STATUS_TEMPLATE.replace("<account-id>",a).replace("<bucket-name>",n).replace("<config-id>",r);return{bucket:e.S3_SHARED_DATA.INVENTORY_BUCKET_TEMPLATE.replace("<region>",i),status:o}}return{getAnalyticsSharedDataFilePath:n,getInventorySharedDataFilePath:r}}e.module("s3").service("ManagementUtilService",["S3Constants","UtilService",t])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){function n(n,r,i,a,o,s,c,l){function u(e,t,l){var u=n.defer();return i.getBucketLocation(e).then(function(n){var i=new a(s.OPERATION_NAME.ANALYTICS_GET_DATA),d=o.getAnalyticsSharedDataFilePath(e,t,n);if(!d)return void u.reject(s.ANALYTICS.ERROR.USER_INFO_MISSING);var p=d.bucket,f=l===s.S3_SHARED_DATA.DATA?d.data:d.status;r.getObject(i,p,f).then(function(e){switch(l){case s.S3_SHARED_DATA.DATA:c.log("getAnalyticsData",1,i);break;case s.S3_SHARED_DATA.STATUS:c.log("getAnalyticsStatus",1,i)}u.resolve(m(e,l))}).catch(function(e){switch(l){case s.S3_SHARED_DATA.DATA:c.log("getAnalyticsData",0,i);break;case s.S3_SHARED_DATA.STATUS:c.log("getAnalyticsStatus",0,i)}u.reject(e)})}),u.promise}function d(e,l){var u=new a(s.OPERATION_NAME.INVENTORY_GET_STATUS),d=n.defer(),p=[],f=void 0,g=0;return l.length<1?d.reject():i.getBucketLocation(e).then(function(n){f=o.getInventorySharedDataFilePath(e,l[0].name,n),f?t.each(l,function(t){f=o.getInventorySharedDataFilePath(e,t.name,n),r.getObject(u,f.bucket,f.status).then(function(e){c.log("getInventoryStatus",1,u);var n=m(e,s.S3_SHARED_DATA.STATUS);p.push({name:t.name,lastExportDate:n[0],status:n[4],errorCode:n[5],manifestPath:n[6]}),p.length===l.length-g&&d.resolve(p)}).catch(function(e){c.log("getInventoryStatus",0,u),g++})}):d.reject(s.INVENTORY.GET_STATUS_ERROR)}),d.promise}function p(e){var t={objectCount:isNaN(parseFloat(e[E]))?0:parseFloat(e[E]),dataUploaded:isNaN(parseFloat(e[S]))?0:1048576*parseFloat(e[S]),storage:isNaN(parseFloat(e[y]))?0:1048576*parseFloat(e[y]),dataRetrieved:isNaN(parseFloat(e[A]))?0:1048576*parseFloat(e[A]),getRequestCount:isNaN(parseFloat(e[C]))?0:parseFloat(e[C]),CRR:isNaN(parseFloat(e[_]))?0:parseFloat(e[_]),objectAge:e[v],storageClass:e[b]};if(e[v]===O){if(t.recommendedAgeTransition=e[T],t.recommendedAgeTransition&&"-1"!==t.recommendedAgeTransition){var n=parseInt(t.recommendedAgeTransition);n>=0&&n<=29?(t.recommendation="30",t.recommendedAgeTransition="30"):t.recommendation=n.toString()}t.ageTransition=e[w],0===t.storage?t.percentage=0:t.percentage=t.dataRetrieved/t.storage*100}return t.timestamp=new Date(e[h]).getTime(),t}function f(t){var n={},r=[],i=[],a=[],o=0;return e.forEach(t,function(e,t){var s=e.split(R);e&&function(){var e=s[h].trim(),t=n[e];e in n||(n[e]=o,a.push({date:e,stats:[],timestamp:new Date(e).getTime()}),t=o,o+=1);var c=p(s),l=s[b].toUpperCase();r.includes(l)||r.push(l),a[t].stats.push(c),s[v]===O&&(0===i.filter(function(e){return e.storageClassName===l}).length&&i.push({storageClassName:l,dataArray:[]}),i.filter(function(e){return e.storageClassName===l})[0].dataArray.push({date:e,row:c,timestamp:c.timestamp,percentage:c.percentage}))}()}),a.sort(function(e,t){return e.timestamp-t.timestamp}),e.forEach(i,function(e,t){e.dataArray.sort(function(e,t){return e.timestamp-t.timestamp})}),i.sort(function(e,t){return l.getStorageClassOrder(e.storageClassName)-l.getStorageClassOrder(t.storageClassName)}),{all:i,rows:a,classes:g(r)}}function g(t){t.sort(function(e,t){return l.getStorageClassOrder(e)-l.getStorageClassOrder(t)});var n={};return e.forEach(t,function(e){n[e]=e}),n}function m(e,n){var r=e.split("\n");if(0===r.length||1===r.length&&t.isEmpty(r[0]))return null;switch(r.shift(),n){case s.S3_SHARED_DATA.DATA:return f(r);case s.S3_SHARED_DATA.STATUS:return r[0].split(R)}}var h=0,b=3,v=4,E=5,S=6,y=7,A=8,C=9,_=10,w=11,T=12,R=",",O="ALL";return{retrieveAnalyticsData:u,retrieveInventoryStatus:d}}e.module("s3").service("ManagementDataProcessor",["$q","APIProxyService","BucketPropertiesService","ConsoleOperation","ManagementUtilService","S3Constants","SCLogService","UtilService",n])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t,n){!function(){e.module("s3").directive("stickyNav",["$window","$document",function(e,r){return{restrict:"A",link:function(i,a,o){var s=o.stickyNav,c=o.scrollContainer,l=t.isEmpty(c)?n(e):a.closest(c),u=t.isEmpty(l),d=function(){return r[0].documentElement.clientWidth-a.parent().outerWidth()},p=function(){return u?0:l.offset().top},f=function(e,n){for(var i=a.parent(),o=0;i&&!i.is(r[0].documentElement)&&!i.is(l);)o+=t.get(i,"[0].offsetTop",0),i=i.offsetParent();var c=n||!a.hasClass(s),u=n||a.hasClass(s);l.scrollTop()>=o&&c?(a.css("width","calc(100% - "+d()+"px)"),a.parent().css("min-height",a[0].offsetHeight+"px"),a.addClass(s),a.css("top",p()+"px")):l.scrollTop()<o&&u&&(a.css("width",""),a.removeClass(s),a.parent().css("min-height",""),a.css("top",""))},g=t.throttle(function(e){f(0,!0)},100);l.resize(g),l.on("scroll",f),i.$on("$destroy",function(){l.removeResize(g),l.off("scroll",f)})}}}])}()}).call(t,n(0),n(2),n(6))},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(e,n,i,a,o){function s(){n.currentRegion=a.getCurrentRegion(),n.objects=i.getFolderList();var s=i.getCurrentObject();if(s&&!s.endsWith("/")){var c=s.split("/").slice(-1)[0];n.objects.push({displayName:c,name:c,path:"/"+i.getAbsolutePathToObjectWithBucket(c),versionId:i.getObjectVersion(),isObject:!0})}n.objects.forEach(function(r){if(r.path){var i=r.isObject?"object":"buckets",a=t.chain({region:n.currentRegion,tab:"overview",versionId:r.versionId}).map(function(e,n){return t.isEmpty(e)?"":n+"="+e}).filter(function(e){return!t.isEmpty(e)}).join("&").value();r.path=i+r.path+"?"+a,e[o.SHOW_DELETED_PARAM]&&(r.path=r.path+"&"+o.SHOW_DELETED_PARAM+"="+e[o.SHOW_DELETED_PARAM]),e[o.SHOW_VERSION_PARAM]&&(r.path=r.path+"&"+o.SHOW_VERSION_PARAM+"="+e[o.SHOW_VERSION_PARAM])}}),n.condenseBreadcrumbs=!1,n.objects.map(function(e){return e.name}).join("").length>r("body").width()/10&&(n.condenseBreadcrumbs=!0)}s();var c=n.$on("$routeUpdate",function(){return s()});n.$on("$destroy",function(){c()})}e.module("s3").directive("breadcrumbs",[function(){return{restrict:"E",template:n(678),scope:{},controller:"BreadcrumbsController"}}]),e.module("s3").controller("BreadcrumbsController",["$routeParams","$scope","PathService","Region","S3Constants",i])}()}).call(t,n(0),n(2),n(6))},function(e,t){e.exports='<div class=breadcrumbs-container> <awsui-breadcrumb-group class=breadcrumbs ng-if=!condenseBreadcrumbs> <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/home?region={{currentRegion}}"></awsui-breadcrumb-item> <span ng-repeat-start="object in objects" class=breadcrumb-path-separator>/</span><awsui-breadcrumb-item ng-repeat-end ng-class="{\'breadcrumb-last\': $last}" text={{object.displayName}} href={{object.path}}></awsui-breadcrumb-item> </awsui-breadcrumb-group> <awsui-breadcrumb-group class=breadcrumbs ng-if=condenseBreadcrumbs> <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/buckets?region={{currentRegion}}"></awsui-breadcrumb-item> <awsui-breadcrumb-item text=... href=""></awsui-breadcrumb-item> <awsui-breadcrumb-item text={{objects[objects.length-2].displayName}} href={{objects[objects.length-2].path}}></awsui-breadcrumb-item> <span class=breadcrumb-path-separator>/</span><awsui-breadcrumb-item class=breadcrumb-last text={{objects[objects.length-1].displayName}} href={{objects[objects.length-1].path}}></awsui-breadcrumb-item> </awsui-breadcrumb-group> </div>'},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("search",function(){return{restrict:"E",template:n(680),transclude:{filters:"?searchFilters"},scope:{fetchOnePagePrefix:"&?",fetchOnePageTag:"&?",filters:"=?",markers:"=?",versionsKeyMarkers:"=?",versionsIdMarkers:"=?",showVersions:"=?",noBackendCalls:"=?",enforceSelection:"&?",searchError:"=?",showTag:"=?",tagContinuationTokens:"=?",tagSearchSelected:"=?",tagQueryDeferred:"=?",empty:"=?",isLambPage:"&?"},controller:"SearchController"}}),e.module("s3").controller("SearchController",["$filter","$location","$routeParams","$scope","$translate","FAC","focusOn","PathService","S3Constants",function(n,r,i,a,o,s,c,l,u){function d(){a.dropdownOpen=!1,a.tagSearchSelected=!1}function p(t){var n=!0;return e.forEach(t,function(e){e.length>u.ENTITY_MAX_LENGTH.TAG_VALUE&&(n=!1)}),n}function f(t,n){var r=!1;return e.forEach(a.filters.tagFilters,function(i){i.tagKey===t&&e.forEach(n,function(e){i.tagVal.indexOf(e)>-1&&(r=!0)})}),r}function g(){a.searchError="",a.tagSearchSelected=!1,a.showTag=!1,a.tagContinuationTokens=[],a.dropdownOpen=!1,a.filters?(a.filters.input="",a.filters.tagFilters=[],a.filters.accessFilters=[]):a.filters={input:"",prefixFilters:[],tagFilters:[],accessFilters:[]}}var m=new RegExp(/[^+ \- = . _ : \/A-Za-z0-9 ]/g),h=new RegExp(/[^+ \- = . _ : , \/A-Za-z0-9 ]/g),b=new RegExp(/,[^ ](?!\1)|,$/g);a.objectTaggingEnabled=(a.noBackendCalls||t.isUndefined(l.getCurrentAbsoluteFolderPath()))&&s.isFeatureEnabled(u.FAC.OBJECT_TAGGING),a.noBackendCalls||s.isFeatureEnabled(u.FAC.TAG_QUERY)||(a.objectTaggingEnabled=!1),a.publicAccessBlockEnabled=s.isFeatureEnabled(u.FAC.PUBLIC_ACCESS_BLOCK),a.inputDropdownText=a.objectTaggingEnabled?o.instant("tagsearch.dropdowntext"):o.instant("prefixsearch.dropdowntext"),a.getInputPlaceholder=function(){return a.isLambPage?o.instant("bucketselector.inputfield.placeholder"):a.empty?o.instant("prefixtagsearch.optional.placeholder"):a.noBackendCalls?o.instant("prefixtagsearch.placeholder"):a.objectTaggingEnabled?a.filters&&a.filters.tagFilters.length>0?o.instant("tagsearch.addfilter"):o.instant("tagsearch.placeholder"):o.instant("prefixsearch.placeholder")},a.clearFilterInput=function(){a.filters.input=""},a.highlightRow=function(e){a.tagSearchSelected=e},a.filterKeyUp=function(e){a.isLambPage&&(""!==a.filters.input?d():e&&e.keyCode!==u.KEY_CODES.ESC&&a.openDropdown())},a.filterKeyDown=function(e){if(""===a.filters.input&&(a.dropdownOpen=!0),a.enforceSelection&&e&&e.keyCode===u.KEY_CODES.BACKSPACE&&1===a.filters.input.length&&a.enforceSelection(),e&&e.keyCode===u.KEY_CODES.ESC&&(a.clearFilterInput(),g(),a.prefixSearch()),e&&e.keyCode===u.KEY_CODES.ENTER)if(a.isLambPage)d();else{if(t.isEmpty(a.filters.input)&&a.noBackendCalls)return;a.showTag?(a.tagSearch(!0),d()):a.tagSearchSelected?a.selectTag():(a.prefixSearch(),d(),a.noBackendCalls&&(a.filters.input=""))}a.objectTaggingEnabled&&e&&e.keyCode===u.KEY_CODES.DOWN&&(e.preventDefault(),a.tagSearchSelected=!0),a.objectTaggingEnabled&&e&&e.keyCode===u.KEY_CODES.UP&&(e.preventDefault(),a.tagSearchSelected=!1)},a.shouldShowTag=function(){return!!(a.filters&&a.filters.input&&a.objectTaggingEnabled)&&(a.filters.input.search(/.+ \| /g)>-1?(a.showTag=!0,!0):(a.showTag=!1,!1))},a.selectTag=function(){a.searchError="",a.showTag=!0,a.filters.input=a.filters.input+" | ",c("prefixSearchInput")},a.openDropdown=function(){""===a.filters.input&&(a.dropdownOpen=!0)},a.clickedOutside=function(){a.enforceSelection&&a.filters&&!t.isEmpty(a.filters.input)?(a.enforceSelection(),c("prefixSearchInput")):d()},a.isSearchEmpty=function(){return!(!a.filters||!t.isEmpty(a.filters.input)||(a.searchError="",a.tagSearchSelected=!1,a.showTag=!1,0))},a.removePrefixFilter=function(e){a.filters.input="";for(var t=0;t<a.filters.prefixFilters.length;t++)e===a.filters.prefixFilters[t]&&a.filters.prefixFilters.splice(t,1);a.prefixSearch()},a.removeTagFilter=function(e){a.tagQueryDeferred&&a.tagQueryDeferred.reject();for(var t=0;t<a.filters.tagFilters.length;t++)e===a.filters.tagFilters[t]&&a.filters.tagFilters.splice(t,1);a.filters.tagFilters.length>0?a.tagSearch(!1):a.noBackendCalls||a.fetchOnePagePrefix({prefix:""})},a.removeAccessFilter=function(e){1===a.filters.accessFilters.length?a.filters.accessFilters=[]:t.remove(a.filters.accessFilters,function(t){return t===e})},a.accessSearch=function(e){var t=o.instant("accesssearch.publicread"),n=o.instant("accesssearch.publicwrite");a.searchError="",e?a.filters.accessFilters="read"===e?[t]:[n]:(-1===a.filters.accessFilters.indexOf(t)&&a.filters.accessFilters.push(t),-1===a.filters.accessFilters.indexOf(n)&&a.filters.accessFilters.push(n)),a.dropdownOpen=!1},a.prefixSearch=function(){a.searchError="";var e=a.filters.input.indexOf("/");if(a.noBackendCalls&&0===e?(a.bucketName=i[u.PATH_SEGMENTS.BUCKET_NAME],a.prefixInfo=a.filters.input):(a.bucketName="",a.prefixInfo=""),a.noBackendCalls||-1===e){var n=a.filters.input;a.noBackendCalls||(a.filters.tagFilters.length=0),""!==n?(a.filters.prefixFilters.length=0,a.filters.prefixFilters.push(n),a.noBackendCalls&&(a.filters.input=""),d()):a.filters.prefixFilters=[],a.noBackendCalls||(a.tagQueryDeferred&&a.tagQueryDeferred.reject(),a.markers=[],t.isEmpty(n)?r.search("prefixSearch",null):r.search("prefixSearch",n),r.search(u.CURRENT_MARKER,null),r.search(u.CURRENT_VERSIONS_KEY_MARKER,null),r.search(u.CURRENT_VERSIONS_ID_MARKER,null)),a.enforceSelection&&a.enforceSelection()}else a.searchError=o.instant("prefixsearch.validation.error")},a.tagSearch=function(t){a.tagContinuationTokens=[],a.searchError="",t&&function(){var t=a.filters.input,n=t.split(" | "),r=n[0],i=n[1],s=i.split(",");if(r.length>u.ENTITY_MAX_LENGTH.TAG_KEY)a.searchError=o.instant("tagKey.length.error");else if(p(s))if(r.search(m)>-1)a.searchError=o.instant("tagKey.validation.error");else if(i.search(h)>-1||i.search(b)>-1)a.searchError=o.instant("tagVal.validation.error");else if(f(r,s))a.searchError=o.instant("tagsearch.duplicate.error");else{var c=!0;a.filters.input="",a.noBackendCalls||e.forEach(a.filters.tagFilters,function(e){e.tagKey===r&&(e.tagVal+=", "+i,c=!1)}),c&&(a.filters.tagFilters=a.filters.tagFilters.concat({tagKey:r,tagVal:i}))}else a.searchError=o.instant("tagVal.length.error")}(),a.tagSearchSelected=!1,a.showTag=!1,a.noBackendCalls||(a.tagQueryDeferred&&a.tagQueryDeferred.reject(),a.filters.prefixFilters.length=0,a.fetchOnePageTag()),a.enforceSelection&&a.enforceSelection()},a.noBackendCalls||g()}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=object-search> <div> <div ng-repeat="prefixFilter in filters.prefixFilters track by $index" class=search-filter> <span class=filter-identifier translate=prefixsearch.identifier></span> <span class=filter-value>{{prefixFilter}}</span> <span class="search-filter-cancel-button blue-cancel-icon" ng-click=removePrefixFilter(prefixFilter)></span> </div> <div ng-repeat="tagFilter in filters.tagFilters track by $index" class=search-filter ng-if=objectTaggingEnabled> <span class=filter-identifier translate=tagsearch.identifier></span> <span class=filter-value>{{tagFilter.tagKey}} | {{tagFilter.tagVal}}</span> <span class="search-filter-cancel-button blue-cancel-icon" ng-click=removeTagFilter(tagFilter)></span> </div> <div ng-repeat="accessFilter in filters.accessFilters track by $index" class=search-filter> <span class=filter-identifier translate=accesssearch.identifier></span> <span class=filter-value>{{accessFilter}}</span> <span class="search-filter-cancel-button blue-cancel-icon" ng-click=removeAccessFilter(accessFilter)></span> </div> </div> <div class=search-strip> <div class=searchbox-dropdown clickoutside on-click-outside=clickedOutside> <div id=search-box class=search-box> <span class=search-icon ng-if=!noBackendCalls><i class="awsui-icon search"></i></span> <span> <span ng-show=shouldShowTag() class=show-tag translate=tagsearch.tag></span> <input type=text class=input-field id=get-filter-value ng-trim=false ng-model=filters.input ng-keydown=filterKeyDown($event) ng-keyup=filterKeyUp($event) ng-focus=openDropdown() placeholder={{getInputPlaceholder()}} focus-when=prefixSearchInput>  </span> </div> <div ng-show=dropdownOpen id=search-dropdown ng-if="!isLambPage || !publicAccessBlockEnabled"> <div ng-show="isSearchEmpty() && !isLambPage" class=search-instruction ng-class="{\'filter-instruction\':noBackendCalls}"> {{inputDropdownText}} </div> <div ng-if=isLambPage fac-id=s3-access> <div class="search-instruction access-heading"><translate>accesssearch.text</translate></div> <div class="search-instruction option" ng-click=accessSearch()><translate>accesssearch.publicreadwriteaccess</translate></div> <div class="search-instruction suboption" ng-click="accessSearch(\'read\')"><translate>accesssearch.publicreadaccess</translate></div> <div class="search-instruction suboption" ng-click="accessSearch(\'write\')"><translate>accesssearch.publicwriteaccess</translate></div> </div> <div ng-show="!isSearchEmpty() && shouldShowTag() && !isLambPage" ng-click=tagSearch(true) class=search-instruction translate=tagsearch.entervalue ng-if=objectTaggingEnabled> </div> <div ng-show="!isSearchEmpty() && !shouldShowTag() && !isLambPage"> <div class=search-option id=prefixsearch-enter ng-class="{\'search-option-selected\' : !tagSearchSelected}" ng-click=prefixSearch() ng-mouseenter=highlightRow(false) translate="{{tagSearchSelected ? \'prefixsearch.not.enter\' : \'prefixsearch.enter\'}}" translate-values="{ filterInput : filters.input }"> </div> <div class=search-option id=tagsearch-enter ng-class="{\'search-option-selected\' : tagSearchSelected}" ng-click=selectTag() ng-mouseenter=highlightRow(true) translate="{{tagSearchSelected ? \'tagsearch.enter\' : \'tagsearch.not.enter\'}}" translate-values="{ filterInput : filters.input }" ng-if=objectTaggingEnabled> </div> </div> </div> </div> <div ng-transclude=filters></div> </div> <div class=search-prefix-info ng-if=prefixInfo translate translate-values="{ bucket1 : bucketName + \'/\' + prefixInfo, bucket2: bucketName + prefixInfo }">prefixsearch.validation.slash.start.warning </div> <awsui-control-group validation-message={{searchError}} id=search-validation></awsui-control-group> </div> '},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("filedrop",["S3Constants","SCLogService",function(e,t){return{restrict:"A",link:function(e,t,n){function r(e){for(var t in e)if("file"===e[t].kind)return!0;return!1}function i(){t.off("drop"),t.off("dragdrop"),t.off("dragover")}t.on("drop",function(t){t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer&&r(t.originalEvent.dataTransfer.items)&&e.$apply(function(){e.$emit("fileDropEvent",t.originalEvent.dataTransfer.items)})}),t.on("dragdrop",function(e){e.stopPropagation(),e.preventDefault()}),t.on("dragover",function(e){e.stopPropagation(),e.preventDefault()}),e.$on("$destroy",i)}}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("BucketPropertiesUtilService",["BucketPropertiesService","S3Constants","$filter","$q","$translate","UtilService","FAC","XMLParser",function(n,r,i,a,o,s,c,l){function u(){return{tagging:{tags:[]},logging:{enabled:!1,targetBucket:"",targetPrefix:"",targetGrants:[]},versioning:{enabled:!1},cloudwatch:{enabled:!1},eventSelectors:{trailNames:[],access:{read:!1,write:!1},targetTrail:"",enabled:!1,trailRegionMapping:{}},defaultEncryption:{customKMSARN:"",encryption:r.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AES256,kmsId:null},objectRetention:{enabled:!1}}}function d(e){var n=t.get(e,"BucketLoggingStatus.LoggingEnabled");return n?{enabled:!0,targetPrefix:t.isEmpty(n.TargetPrefix)?"":n.TargetPrefix,targetBucket:n.TargetBucket,targetGrants:n.TargetGrants?n.TargetGrants.Grant:[]}:u().logging}function p(e,n){if(e.BucketLoggingStatus&&e.BucketLoggingStatus.LoggingEnabled){var i=e.BucketLoggingStatus.LoggingEnabled;n.selectedValue=r.BUCKET_PROPERTIES.ENABLE,n.targetPrefix=t.isEmpty(i.TargetPrefix)?"":i.TargetPrefix,n.targetBucket=i.TargetBucket,i.TargetGrants?n.targetGrants=i.TargetGrants.Grant:n.targetGrants=[]}else n.selectedValue=r.BUCKET_PROPERTIES.DISABLE,n.targetPrefix="",n.targetBucket="",n.targetGrants=[]}function f(e){var n="<RoutingRule>";if(e.Condition){if(n+="<Condition>",e.Condition.KeyPrefixEquals)if(t.isEmpty(e.Condition.KeyPrefixEquals))n+="<KeyPrefixEquals/>";else{var r=s.encodeXml(e.Condition.KeyPrefixEquals);n+="<KeyPrefixEquals>"+r+"</KeyPrefixEquals>"}if(e.Condition.HttpErrorCodeReturnedEquals)if(t.isEmpty(e.Condition.HttpErrorCodeReturnedEquals))n+="<HttpErrorCodeReturnedEquals/>";else{var i=s.encodeXml(e.Condition.HttpErrorCodeReturnedEquals);n+="<HttpErrorCodeReturnedEquals>"+i+"</HttpErrorCodeReturnedEquals>"}n+="</Condition>"}if(e.Redirect){if(n+="<Redirect>",e.Redirect.Protocol&&(n+="<Protocol>"+s.encodeXml(e.Redirect.Protocol)+"</Protocol>"),e.Redirect.HostName&&(n+="<HostName>"+s.encodeXml(e.Redirect.HostName)+"</HostName>"),e.Redirect.ReplaceKeyPrefixWith)if(t.isEmpty(e.Redirect.ReplaceKeyPrefixWith))n+="<ReplaceKeyPrefixWith/>";else{var a=s.encodeXml(e.Redirect.ReplaceKeyPrefixWith);n+="<ReplaceKeyPrefixWith>"+a+"</ReplaceKeyPrefixWith>"}if(e.Redirect.ReplaceKeyWith)if(t.isEmpty(e.Redirect.ReplaceKeyWith))n+="<ReplaceKeyWith/>";else{var o=s.encodeXml(e.Redirect.ReplaceKeyWith);n+="<ReplaceKeyWith>"+o+"</ReplaceKeyWith>"}e.Redirect.HttpRedirectCode&&(n+="<HttpRedirectCode>"+s.encodeXml(e.Redirect.HttpRedirectCode)+"</HttpRedirectCode>"),n+="</Redirect>"}return n+="</RoutingRule>",n=n}function g(n,i){if(n&&n.WebsiteConfiguration){var a=n.WebsiteConfiguration;if(a.RedirectAllRequestsTo)i.selectedValue=r.BUCKET_PROPERTIES.WEBSITE.REDIRECT_REQUEST,i.targetDomain=e.copy(a.RedirectAllRequestsTo.HostName),i.redirectRequestProtocol=t.isEmpty(a.RedirectAllRequestsTo.Protocol)?"":a.RedirectAllRequestsTo.Protocol,i.websiteEnabledOption=o.instant("bucketproperties.website.footer.redirectallrequests"),i.websiteEnabledContent=e.copy(i.targetDomain),i.indexDocument="",i.errorDocument="",i.routingXML="";else if(a.IndexDocument){if(i.selectedValue=r.BUCKET_PROPERTIES.WEBSITE.USE_BUCKET,i.indexDocument=e.copy(a.IndexDocument.Suffix),i.websiteEnabledOption=o.instant("bucketproperties.website.footer.buckethosting"),i.websiteEnabledContent=e.copy(i.indexDocument),a.ErrorDocument&&(i.errorDocument=e.copy(a.ErrorDocument.Key)),a.RoutingRules){var c="<RoutingRules>",l=s.transformObjectToArray(a.RoutingRules.RoutingRule);if(l.length)for(var u=0,d=l.length;u<d;u++){var p=l[u];c+=f(p)}c+="</RoutingRules>",i.routingXML=s.formatXml(e.copy(c)),i.routingXMLToggle=!0}else i.routingXML="";i.targetDomain="",i.redirectRequestProtocol=""}}else i.selectedValue=r.BUCKET_PROPERTIES.DISABLE,h(i)}function m(e,n){if(e.Tagging.TagSet.Tag.length)for(var r=0;r<e.Tagging.TagSet.Tag.length;r++)n.push({Key:e.Tagging.TagSet.Tag[r].Key,Value:t.isEmpty(e.Tagging.TagSet.Tag[r].Value)?"":e.Tagging.TagSet.Tag[r].Value});else n.push({Key:e.Tagging.TagSet.Tag.Key,Value:t.isEmpty(e.Tagging.TagSet.Tag.Value)?"":e.Tagging.TagSet.Tag.Value})}function h(e){e.websiteEnabledOption="",e.websiteEnabledContent="",e.indexDocument="",e.errorDocument="",e.routingXML="",e.targetDomain="",e.redirectRequestProtocol=""}function b(e){var t=[{name:r.EVENTS.TOPIC,value:r.EVENTS.TOPICCONFIG,display:r.EVENTS.SNS,dropdown:"SNS topics"},{name:r.EVENTS.QUEUE,value:r.EVENTS.QUEUECONFIG,display:r.EVENTS.SQS,dropdown:"SQS queues"},{name:r.EVENTS.CLOUDFN,value:r.EVENTS.CLOUDCONFIG,display:r.EVENTS.LAMBDA,dropdown:"Lambda functions"}],n={},i=e.NotificationConfiguration;return t.forEach(function(e){var t=[],r=i[e.value];r&&(r=s.convertToArray(r),r.forEach(function(n){t.push(v(n,e))})),n[e.name]=t}),n}function v(e,n){var i={};return i.id=e.Id,e.Filter&&e.Filter.S3Key&&e.Filter.S3Key.FilterRule&&s.convertToArray(e.Filter.S3Key.FilterRule).forEach(function(e){e.Name===r.EVENTS.PREFIX&&e.Value&&!t.isEmpty(e.Value)&&""!==e.Value&&(i.prefix=e.Value),e.Name===r.EVENTS.SUFFIX&&e.Value&&!t.isEmpty(e.Value)&&""!==e.Value&&(i.suffix=e.Value)}),i.arn=e[n.name],i.events=[],s.convertToArray(e.Event).forEach(function(e){i.events.push(e)}),i.type=n.display,i}function E(e,t,n){e.forEach(function(n,r){var i=-1,a=t[0].length;e[r-1]&&(i=S(t[0],e[r-1].action)),e[r+1]&&(a=S(t[0],e[r+1].action)),-1===a&&(a=t[0].length),t[r].forEach(function(e,t){e.disabled=!(t>i&&t<a)})})}function S(e,t){return e.findIndex(function(e){return e.value===t})}function y(e,n){if(n.length===C())return!0;for(var r=0;r<n.length;r++)if(t.isEmpty(n[r].action)||n[r].action===e)return!0;return!1}function A(){return c.isFeatureEnabled(r.FAC.DEEP_ARCHIVE)?r.LIFECYCLE.DEEP_ARCHIVE:r.LIFECYCLE.GLACIER}function C(){return c.isFeatureEnabled(r.FAC.DEEP_ARCHIVE)?r.LIFECYCLE.TOTAL_OPTIONS:r.LIFECYCLE.TOTAL_OPTIONS-1}function _(e){if(e){var t=e.lastIndexOf(":");return e.substring(t+1)}return e}function w(e,i,o,s,c){o.rulesArray=[];var u=l.convertXmlStringToJson(e);if(u.ReplicationConfiguration&&u.ReplicationConfiguration.Rule){var d=u.ReplicationConfiguration.Rule;return Array.isArray(d)?(o.isEnabled=r.REPLICATION.DISABLED,o.destinationBucket=R(d[0].Destination.Bucket),o.replicationType="prefix",d.forEach(function(e){o.isEnabled=o.isEnabled===r.REPLICATION.ENABLED||e.Status===r.REPLICATION.ENABLED?r.REPLICATION.ENABLED:r.REPLICATION.DISABLED,O(e,o.rulesArray)})):(o.isEnabled=d.Status,o.destinationBucket=R(d.Destination.Bucket),i===d.ID?(o.replicationType="bucket",o.storageClass=d.Destination.StorageClass&&!t.isEmpty(d.Destination.StorageClass)?d.Destination.StorageClass:r.STORAGE_CLASSES.DEFAULT):(o.replicationType="prefix",O(d,o.rulesArray))),o.role=u.ReplicationConfiguration.Role,n.getBucketLocation(o.destinationBucket).then(function(e){c||(o.resetDestinationBucket=!0),o.destinationRegion=t.isEmpty(s)?e:t.find(s,{value:e})})}return o.role="",o.destinationBucket="",o.destinationRegion="",o.storageClass="",o.rulesArray=[],o.replicationType="",o.isEnabled=r.REPLICATION.DISABLED,o.response="",a.defer().promise}function T(e,n){"bucket"===n.replicationType?(n.rules=[{id:e,prefix:"",status:n.isEnabled}],"default"!==n.storageClass&&(n.rules[0].storageClass=n.storageClass)):(n.rules=[],n.rulesArray.forEach(function(e){if(!e.markedForDelete){var i=t.clone(e);"default"===i.storageClass&&delete i.storageClass,n.isEnabled===r.REPLICATION.DISABLED&&(i.status=r.REPLICATION.DISABLED),n.rules.push(i)}}))}function R(e){return e.substring(e.lastIndexOf(":")+1)}function O(e,n){n.push({id:e.ID,prefix:e.Prefix,status:e.Status,storageClass:e.Destination.StorageClass&&!t.isEmpty(e.Destination.StorageClass)?e.Destination.StorageClass:r.STORAGE_CLASSES.DEFAULT,markedForDelete:!1})}function k(e,n,r){var i=t.get(e,"response.trailList");t.isEmpty(i)||t.each(i,function(e){var t=s.getTrailName(e.TrailARN);n.push({value:e.TrailARN,text:t});var i=s.getTrailRegionFromARN(e.TrailARN);r[t]=i})}function I(e,n,i,a){var o="";i.read&&i.write?o=r.BUCKET_PROPERTIES.OBJECT_LOGGING.ALL:i.read?o=r.BUCKET_PROPERTIES.OBJECT_LOGGING.READ_ONLY:i.write&&(o=r.BUCKET_PROPERTIES.OBJECT_LOGGING.WRITE_ONLY);var c=t.cloneDeep(e),l=t.findIndex(c,{ReadWriteType:o}),u=void 0,d=s.getBucketARN(a)+"/";return l>-1?(u=c[l].DataResources,t.isEmpty(u)?u.push({Values:[d],Type:"AWS::S3::Object"}):u[0].Values.push(d)):(u={IncludeManagementEvents:!1,DataResources:[{Values:[d],Type:"AWS::S3::Object"}],ReadWriteType:o},c.push(u)),{EventSelectors:c,TrailName:n}}return{clearAllWebsiteFields:h,populateLoggingFields:p,getLoggingFields:d,populateWebsiteFields:g,populateTagsFields:m,generateRoutingRuleXML:f,generateEventSelectorsConfig:I,parseBucketNotificationConfig:b,updateLifecycleDropdown:E,isTransitionDisabled:y,stripBucketARN:_,populateReplicationObj:w,handleRules:T,populateTrailNames:k,getNewBucketDefaultProperties:u,getCurrentDisableOption:A,getCurrentLifeCycleTotalOption:C}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t,n){!function(){function r(e,r,i,a,o,s){function c(r){var a=function(e,n){t.forEach(e,function(e){var t=r[e];t&&(t.disabled=n)})},c=e.getSelectedObjects(),A=e.getSelectedFolders(),C=t.filter(c,function(e){return s.isStorageClassRestorable(e.StorageClass)}),_=0===A.length&&C.length===c.length,w=e.showVersions?t.filter(c,function(e){return void 0===e.ETag}):[],T=A.length>0,R=t.isEmpty(c)&&t.isEmpty(A),O=null!==i.getClipboardOperation(),k=e.isSingleObjectOnlySelected(),I=A.length>=1,P=1===A.length&&0===c.length,N=e.showVersions&&t.some(c,function(e){return void 0===e.ETag}),M=t.any(c,{StorageClass:o.STORAGE_CLASSES.GLACIER}),L=t.any(c,{StorageClass:o.STORAGE_CLASSES.DEEP_ARCHIVE}),x=e.showVersions&&t.every(c,function(e){return"true"===e.IsLatest}),D=k&&!0===c[0].withinRestoreExpiry,j=k&&c[0].StorageClass===o.STORAGE_CLASSES.REDUCED_REDUNDANCY,B=0===A.length&&C.length+w.length===c.length;r.paste.disabled=!O,R?a(l,!0):e.showDeleted?(a(l,!0),a(h,I)):e.showVersions&&k&&!N?_?(a(n(l).not(p),!0),a(p,!1)):x?(a(l,!1),a(n(l).not(v),!0)):(a(l,!0),a(b,!1)):e.showVersions&&T?(a(l,!0),a(y,!1)):e.showVersions&&N?(a(l,!0),a(f,!1),B&&a(["open"],!0)):!e.showVersions||k||N?_?D?(a(n(l).not(S),!0),a(S,!1)):(a(n(l).not(p),!0),a(p,!1)):k||P?I?(a(u,!0),a(n(l).not(u),!1)):e.tagFilterLength>0?(a(n(l).not(["initiaterestore","rename"]),!1),a(["initiaterestore","rename"],!0)):(a(n(l).not(["initiaterestore"]),!1),a(["initiaterestore"],!0),j&&a(d,!0)):!T||M||L?_?(a(l,!0),a(p,!1)):!M&&!L||_?a(m,!0):(a(l,!0),a(f,!1)):(a(g,!0),a(n(l).not(g),!1)):(a(l,!0),a(f,!1),a(E,!1),_?(a(l,!0),a(p,!1)):(a(l,!0),a(f,!1),a(E,!1))),e.disableMakePublic&&(r.makeobjectpublic.disabled=!0)}var l=["getinfo","download","rename","select","initiaterestore","dropdowndelete","cut","copy","changestorageclass","changeencryption","changemetadata","makeobjectpublic","open"],u=["download","select","rename","initiaterestore"],d=["select"],p=["getinfo","initiaterestore","dropdowndelete"],f=["getinfo","dropdowndelete","open"],g=["download","select","rename","initiaterestore"],m=["download","select","rename"],h=["undodelete"],b=["getinfo","download","dropdowndelete","makeobjectpublic","open"],v=["getinfo","download","dropdowndelete","select","makeobjectpublic","changestorageclass","changeencryption","changemetadata","open"],E=["makeobjectpublic","open"],S=["open","getinfo","download","initiaterestore","dropdowndelete"],y=["getinfo","open","dropdowndelete"];a.isFeatureEnabled(o.FAC.OBJECT_TAGGING)&&(l.push("addobjecttags"),u.push("addobjecttags"),E.push("addobjecttags"),v.push("addobjecttags"),b.push("addobjecttags"),g.push("addobjecttags"));var A=function(e,t){return e.find(function(e){return e.id===t})};e.takeAction=function(){if(e.items&&e.items[0].items&&!e.disableTakeAction){var n=t.flatten(e.items.map(function(e){return e.items})),r={open:A(n,"open"),getinfo:A(n,"getinfo"),download:A(n,"download"),rename:A(n,"rename"),dropdowndelete:A(n,"delete"),undodelete:A(n,"undodelete"),cut:A(n,"cut"),copy:A(n,"copy"),paste:A(n,"paste"),changestorageclass:A(n,"changestorageclass"),initiaterestore:A(n,"initialrestore"),changeencryption:A(n,"changeencryption"),changemetadata:A(n,"changemetadata"),makeobjectpublic:A(n,"makeobjectpublic")};a.isFeatureEnabled(o.FAC.OBJECT_TAGGING)&&(r.addobjecttags=A(n,"addobjecttags")),a.isFeatureEnabled(o.FAC.S3_SELECT)&&(r.select=A(n,"select")),c(r)}},e.triggerItem=function(t){function n(e){return e.id===r?e:e.items?e.items.filter(n)[0]:void 0}var r=t.originalEvent.detail.id;e.items.map(n).filter(function(e){return e})[0].action()}}e.module("s3").directive("actionDropdown",[function(){return{restrict:"E",scope:{text:"@",items:"=",bucketname:"=",isSingleObjectOnlySelected:"=",getSelectedFolders:"=",getSelectedObjects:"=",showDeleted:"=?",tagFilterLength:"=",disableTakeAction:"=?",showVersions:"=",disableMakePublic:"=?"},template:'<awsui-button-dropdown ng-click="takeAction()" item-click="triggerItem(event)" items="items" text="{{text}}"></awsui-button-dropdown>',controller:"ActionDropdownController"}}]),e.module("s3").controller("ActionDropdownController",["$scope","$translate","CopyService","FAC","S3Constants","UtilService",r])}()}).call(t,n(0),n(2),n(6))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("CountService",["ConsoleOperation","KeySelectionService","PathService","S3Constants","SCLogService","S3CWSAPIService","UtilService","$q","$routeParams",function(n,r,i,a,o,s,c,l,u){function d(e,t){function n(c){t?S.generateCountForFullPathFoldersWithVersionTokens(e,c,[],[]).then(function(e){if((s+=1)===i)o.log(E,1,e),r.resolve(e);else{for(var t=[],c=e.selectedFolders.length<=(s+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?e.selectedFolders.length:(s+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,l=s*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;l<c;l++)t.push(e.selectedFolders[l].Prefix);n(t)}}).catch(function(t){r.reject(t),o.log(E,0,e)}):S.generateCountForFullPathFoldersWithContinuationTokens(e,c,[]).then(function(e){if((s+=1)===i)o.log(v,1,e),r.resolve(e);else{for(var t=[],c=e.selectedFolders.length<=(s+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?e.selectedFolders.length:(s+1)*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,l=s*a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;l<c;l++)t.push(e.selectedFolders[l].Prefix);n(t)}}).catch(function(t){r.reject(t),o.log(v,0,e)})}var r=l.defer();e.countResultEachFolder={};var i=Math.ceil(e.selectedFolders.length/a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API),s=0;void 0===t&&(t=c.convertStringToBoolean(u[a.SHOW_VERSION_PARAM]));for(var d=[],p=e.selectedFolders.length<=a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?e.selectedFolders.length:a.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,f=0;f<p;f++)d.push(e.selectedFolders[f].Prefix);return n(d),r.promise}function p(e,n,r){var i=e.initialBucket,c=e.initialPath,u={};return u.bucket=i,u.path=c,u.selectedFolders=n,o.log(m,1,e,u),0===n.length&&(o.log(h,1,e,u),n=[""]),s.generateCount(i,n,r,e).then(function(n){if(n&&n.data&&n.data.statusPerKey&&e.state!==a.OPERATION_STATE.CANCEL){o.logRequestComplete(b,e);var r=[],i=[];return t.each(n.data.statusPerKey,function(t){if(t.result&&t.result.additionalInfoWhenSuccess){var n=t.result.additionalInfoWhenSuccess;e.countResultEachFolder[t.key]?(e.countResultEachFolder[t.key].count+=n.count,e.countResultEachFolder[t.key].totalSize+=n.totalSize):e.countResultEachFolder[t.key]=n,e.keyCount+=n.count,e.totalSizeInBytes+=n.totalSize,n.continuationToken&&(r.push(n.continuationToken),i.push(t.key))}}),r.length>0?l.resolve(p(e,i,r)):l.resolve(e)}return l.reject(n)}).catch(function(t){return o.log(b,0,e,{bucketName:i,path:c,error:t}),e.keyCount=-1,l.reject(t)})}function f(e,n,r,i){var c=e.initialBucket,u=e.initialPath,d={};return d.bucket=c,d.path=u,d.selectedFolders=n,o.log(m,1,e,d),0===n.length&&(o.log(h,1,e,d),n=[""]),s.generateVersionsCount(c,n,r,i,e).then(function(n){if(n&&n.data&&n.data.statusPerKey&&e.state!==a.OPERATION_STATE.CANCEL){o.logRequestComplete(b,e);var r=[],i=[],s=[];return t.each(n.data.statusPerKey,function(t){if(t.result&&t.result.additionalInfoWhenSuccess){var n=t.result.additionalInfoWhenSuccess;e.countResultEachFolder[t.key]?(e.countResultEachFolder[t.key].count+=n.count,e.countResultEachFolder[t.key].totalSize+=n.totalSize):e.countResultEachFolder[t.key]=n,e.keyCount+=n.count,e.totalSizeInBytes+=n.totalSize,n.keyMarker&&n.versionIdMarker&&(r.push(n.keyMarker),i.push(n.versionIdMarker),s.push(t.key))}}),r.length>0&&i.length>0?l.resolve(f(e,s,r,i)):l.resolve(e)}return l.reject(n)}).catch(function(t){return o.log(b,0,e,{bucketName:c,path:u,error:t}),e.keyCount=-1,l.reject(t)})}function g(n,i,a,s){s.flag=!0;var c=r.countCurrLevelFiles(n);i.sizeDataMissing=c.sizeDataMissing,i.folders=c.totalFolders,i.currLevelObjs=c.totalObjs,i.objects=c.totalObjs,i.size=c.totalSize,a.totalSizeInBytes=c.totalSize,i.flag=!0,n.folders&&!t.isEmpty(n.folders)?S.generateCountForOperation(a).then(function(){o.log("generateCountForOperation",1,a),i.objects+=a.keyCount,i.size=a.totalSizeInBytes,e.forEach(a.countResultEachFolder,function(e,t){i.countResultEachFolder[t]=e})}).catch(function(e){i.error=e,o.log("generateCountForOperation",0,a,{errorMessage:e})}).finally(function(){s.flag=!1}):s.flag=!1}var m="generateCountInvoked",h="generateCountBucket",b="generateCountRequest",v="CountCompleted",E="VersionsCountCompleted",S={generateCountForOperation:d,generateCountForFullPathFoldersWithContinuationTokens:p,generateCountForFullPathFoldersWithVersionTokens:f,countAllFiles:g};return S}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("DownloadService",["ConsoleOperation","KeySelectionService","PathService","S3CWSAPIService","SCLogService","$q","$window",function(e,n,r,i,a,o,s){function c(e,t,n,r,s,c){var l={};l[b]=c?E:v;var u=null===s?{}:{versionId:s};return i.fetchPresignedUrl(t,e,S,l,u,null,null,r).then(function(i){return a.log(h,n,r),a.log(m,1,r,{key:e,bucket:t}),o.resolve(i)},function(n){var i={};return i.error=n,i.key=e,i.bucket=t,a.log(m,0,r,i),o.reject(i)})}function l(t,n,i){return c(t,r.getCurrentBucket(),n,new e(f,g),i).then(function(e){return s.location.href=e.data.presignedUrl,o.resolve(e)})}function u(e){var n=arguments.length<=1||void 0===arguments[1]||arguments[1];if(e&&e.Key){var i=e.VersionId?e.VersionId:null,a=t.cloneDeep(e.Key);return n&&(a=r.relativeToAbsoluteObjectPath(a)),l(a,e.Size,i)}var s=o.defer();return s.reject(e),s.promise}function d(n){var i=arguments.length<=1||void 0===arguments[1]||arguments[1],a=r.getCurrentBucket(),s=new e(f,g);if(n&&n.Key){var l=n.VersionId?n.VersionId:null,u=t.cloneDeep(n.Key);return i&&(u=r.relativeToAbsoluteObjectPath(u)),c(u,a,n.Size,s,l)}var d=o.defer();return d.reject(n),d.promise}function p(n,i){var a=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=arguments.length<=3||void 0===arguments[3]||arguments[3],l=r.getCurrentBucket(),u=new e(f,g),d=t.cloneDeep(n);o&&(d=r.relativeToAbsoluteObjectPath(d)),c(d,l,i,u,a,!0).then(function(e){s.open(e.data.presignedUrl,"_blank").opener=null})}var f="objectDownload",g="objDLPresignFetchStart",m="fetchPresignedUrl",h="DownloadSize",b="Content-Disposition",v="attachment",E="inline",S="GET";return{downloadCurrentSelection:u,generatePresignedUrlForCurrentObject:d,openInBrowser:p}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){function n(e,n,r,i,a,o){function s(s,l,u){var d={ObjectLockConfiguration:{ObjectLockEnabled:o.BUCKET_PROPERTIES.OBJECT_RETENTION.ENABLED}};u&&(d.ObjectLockConfiguration.Rule={DefaultRetention:{Mode:u.mode,Days:u.days}});var p=r.jsonToXml(d);return n.putBucketProperty(s,l,"retention",p,{},!0).then(function(){c(new a("ObjectLockConfigDurabilityCheck","getBucketObjectLockConfiguration"),l).then(function(e){var n=h(o.BUCKET_PROPERTIES.OBJECT_RETENTION.ENABLED,t.get(u,"mode"),t.get(u,"days")),r=t.isEqual(e,n)?0:1;i.log("putObjectLockConfigMismatch",r,s,{expectedObjectLockConfiguration:n,updatedObjectLockConfiguration:e})})}).catch(function(t){return e.reject(f(t))})}function c(i,a){return n.getBucketProperty(i,a,"retention",{},!0,!0).then(function(e){var n=r.convertXmlStringToJson(e.response);return h(t.get(n,"ObjectLockConfiguration.ObjectLockEnabled"),t.get(n,"ObjectLockConfiguration.Rule.DefaultRetention.Mode"),t.get(n,"ObjectLockConfiguration.Rule.DefaultRetention.Days"))}).catch(function(t){return g(t)?e.resolve({bucketObjectRetentionEnabled:!1}):e.reject(f(t))})}function l(s,c,l,u,p){var g=l.objectKey,h=l.versionId,b={Retention:{}},v=Boolean(u&&p),E=p?p.toISOString():null;v&&(b.Retention={Mode:u,RetainUntilDate:E});var S=r.jsonToXml(b);return d(s,c,{objectKey:g,versionId:h}).catch(function(){return{objectRetentionEnabled:!1}}).then(function(e){var t=e.objectRetentionEnabled,r=e.mode;return n.putObjectRetention(s,c,{objectKey:g,versionId:h},S,t&&r===o.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.GOVERNANCE)}).then(function(){d(new a("ObjectRetentionDurabilityCheck","getObjectRetention"),c,{objectKey:g,versionId:h}).then(function(e){var n=m(E,u),r=t.isEqual(e,n)?0:1;i.log("putObjectRetentionMismatch",r,s,{expectedRetention:n,updatedRetention:e})})}).catch(function(t){return e.reject(f(t))})}function u(t,i,a,s){var c=a.objectKey,l=a.versionId,u=o.BUCKET_PROPERTIES.OBJECT_RETENTION.LEGAL_HOLD,d=u.ON,p=u.OFF,g={LegalHold:{Status:s?d:p}},m=r.jsonToXml(g);return n.putObjectLegalHold(t,i,{objectKey:c,versionId:l},m).catch(function(t){return e.reject(f(t))})}function d(i,a,o){var s=o.objectKey,c=o.versionId;return n.getObjectRetention(i,a,{objectKey:s,versionId:c}).then(function(e){var n=r.convertXmlStringToJson(e),i=t.get(n,"Retention.Mode");return m(t.get(n,"Retention.RetainUntilDate"),i)}).catch(function(t){return g(t)?e.resolve({objectRetentionEnabled:!1}):e.reject(f(t))})}function p(i,a,s){var c=s.objectKey,l=s.versionId;return n.getObjectLegalHold(i,a,{objectKey:c,versionId:l}).then(function(e){var n=r.convertXmlStringToJson(e);return t.get(n,"LegalHold.Status")===o.BUCKET_PROPERTIES.OBJECT_RETENTION.LEGAL_HOLD.ON}).catch(function(t){return g(t)?e.resolve(!1):e.reject(f(t))})}function f(e){var n={code:o.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.UNKNOWN_ERROR,text:"utilities.unknown.error"};switch(e.status){case 401:case 403:return{code:o.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.ACCESS_DENIED,text:"bucketproperties.objectretention.alert.nopermissionstoview.text"};case 400:var r=t.get(e,"response.Error.Code"),i=t.get(e,"response.Error.Message");return t.isEmpty(r)||t.isEmpty(i)?n:{code:r,text:i};default:return n}}function g(e){return 404===e.status}function m(e,t){return{objectRetentionEnabled:Boolean(e&&t),retainUntilDate:e?new Date(e):null,mode:t}}function h(e,t,n){var r={bucketObjectRetentionEnabled:e===o.BUCKET_PROPERTIES.OBJECT_RETENTION.ENABLED};return(t||n)&&(r.defaultRetentionRule={mode:t,days:n}),r}return{putBucketObjectLockConfiguration:s,getBucketObjectLockConfiguration:c,putObjectRetention:l,getObjectRetention:d,putObjectLegalHold:u,getObjectLegalHold:p}}e.module("s3").factory("SharpieAPI",["$q","APIProxyService","XMLParser","SCLogService","ConsoleOperation","S3Constants",n])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").directive("addEventsForm",function(){return{restrict:"E",scope:{isOpen:"=",selectedEvent:"=",updateEvents:"=",eventTypes:"=",currentConfig:"=",resourceTypes:"=",forCreateBucketModal:"=?",modalInfo:"=?",cardState:"=",currentEvents:"="},template:n(688),controller:"AddEventController"}}),e.module("s3").controller("AddEventController",["$filter","$scope","$translate","BucketPropertiesService","ConsoleOperation","LambdaService","PathService","APIProxyService","S3Constants","SCLogService","SNSService","SQSService","UtilService","XMLParser",function(e,n,i,a,o,s,c,l,u,d,p,f,g,m){function h(){if(n.cachedSelectedEvents&&n.cachedSelectedEvents.type&&n.selectedEvent.type!==n.cachedSelectedEvents.type){var e=t.findIndex(n.currentEvents[y[n.cachedSelectedEvents.type]],function(e){return e.id===n.cachedSelectedEvents.id});n.currentEvents[y[n.cachedSelectedEvents.type]].splice(e,1),n.currentEvents[y[n.selectedEvent.type]].push(n.selectedEvent),n.cachedSelectedEvents=t.cloneDeep(n.selectedEvent)}}function b(e){return n.selectedEvent.arn&&-1===n.selectedEvent.arn.indexOf(e)}function v(e){var t=new o("updateResource");return n.updateCurrentEventType(n.selectedEvent.type),n.isLoadingResources=!0,n.selectedEvent.type===u.EVENTS.SNS?l.makeProxyRequest(p.listTopics,{region:e},u.PROXY_API_NAMES.SNS.LIST_TOPICS,t).then(function(e){var t=e.response.ListTopicsResponse.ListTopicsResult.Topics;t&&t.forEach(function(e){n.eventResources.push({value:e.TopicArn,text:g.extractTopicName(e.TopicArn)})}),n.eventResources.push({value:u.EVENTS.CUSTOM,text:i.instant("events.option.customsnsarn")}),n.isLoadingResources=!1,b(A.SNS)&&(n.selectedEvent.arn=null),C(n.selectedEvent)}).catch(function(e){n.cardState.listTopicError=g.handleErrors(e)}).finally(function(){h()}):n.selectedEvent.type===u.EVENTS.SQS?l.makeProxyRequest(f.listQueues,{region:e},u.PROXY_API_NAMES.SQS.LIST_QUEUES,t).then(function(e){var t=e.response.ListQueuesResponse.ListQueuesResult.queueUrls;t&&t.forEach(function(e){n.eventResources.push({value:E(e),text:g.extractQueueName(e)})}),n.eventResources.push({value:u.EVENTS.CUSTOM,text:i.instant("events.option.customsqsarn")}),n.isLoadingResources=!1,b(A.SQS)&&(n.selectedEvent.arn=null),C(n.selectedEvent)}).catch(function(e){n.cardState.listTopicError=g.handleErrors(e)}).finally(function(){h()}):n.selectedEvent.type===u.EVENTS.LAMBDA?l.makeProxyRequest(s.listFunctions,{region:e,params:{MaxItems:u.API_MAX_ITEMS.LAMBDA_LIST_FUNCTIONS}},u.PROXY_API_NAMES.LAMBDA.LIST_FUNCTIONS,t).then(function(e){var t=e.response.Functions;t&&t.forEach(function(e){n.eventResources.push({value:e.FunctionArn,text:e.FunctionName})}),n.eventResources.push({value:u.EVENTS.CUSTOM,text:i.instant("events.option.customlambdaarn")}),n.isLoadingResources=!1,b(A.LAMBDA)&&(n.selectedEvent.arn=null),C(n.selectedEvent)}).catch(function(e){n.cardState.listTopicError=g.handleErrors(e)}).finally(function(){h()}):void 0}function E(e){var t=g.getARNPrefix(u.AWS_SERVICE.SQS),n=e.substring(e.indexOf(".")+1);return t+n.substring(0,n.indexOf("."))+n.substring(n.indexOf("/")).replaceAll("/",":")}var S,y=(S={},r(S,u.EVENTS.SNS,u.EVENTS.TOPIC),r(S,u.EVENTS.SQS,u.EVENTS.QUEUE),r(S,u.EVENTS.LAMBDA,u.EVENTS.CLOUDFN),S),A={SNS:"sns",SQS:"sqs",LAMBDA:"lambda"},C=function(e){if(t.isEmpty(e.arn)&&n.selectValue&&!t.isEmpty(n.selectValue.value)&&n.selectValue.value.indexOf(n.selectedEvent.type.toLowerCase())>-1&&(e.arn=n.selectValue.value),!t.isEmpty(e.arn)){var r=t.find(n.eventResources,function(t){return t.text===e.arn.substring(e.arn.lastIndexOf(":")+1)});void 0===r?(n.selectValue.value=u.EVENTS.CUSTOM,n.showCustomArn=!0):n.selectValue.value=r.value}};n.updateEventResources=function(){return n.eventResources=[],n.forCreateBucketModal?v(n.modalInfo.region):a.getBucketLocation(n.bucket).then(function(e){return v(e)}).catch(function(e){n.cardState.errorMessage=e.response,n.cardState.showError=!0})},n.getCustomArnLabel=function(){var e=void 0;switch(n.selectedEvent.type){case u.EVENTS.SNS:e=i.instant("events.label.customsnsarn"),n.customarn_placeholder=g.getARNPrefix(u.AWS_SERVICE.SNS)+u.EVENTS.CUSTOM_PLACEHOLDER.SNS;break;case u.EVENTS.SQS:e=i.instant("events.label.customsqsarn"),n.customarn_placeholder=g.getARNPrefix(u.AWS_SERVICE.SQS)+u.EVENTS.CUSTOM_PLACEHOLDER.SQS;break;case u.EVENTS.LAMBDA:e=i.instant("events.label.customlambdaarn"),n.customarn_placeholder=g.getARNPrefix(u.AWS_SERVICE.LAMBDA)+u.EVENTS.CUSTOM_PLACEHOLDER.LAMBDA}return e},n.updateCurrentEventType=function(e){switch(e){case u.EVENTS.SNS:n.currentEventType=n.eventTypes[0];break;case u.EVENTS.SQS:n.currentEventType=n.eventTypes[1];break;case u.EVENTS.LAMBDA:n.currentEventType=n.eventTypes[2]}},n.selectChanged=function(){n.selectValue.value!==u.EVENTS.CUSTOM&&(n.selectedEvent.arn=n.selectValue.value)},n.handleCheckboxes=function(){n.selectedEvent.events=t.filter(t.keys(n.eventsChecked),function(e){return n.eventsChecked[e]})},function(){n.showCustomArn=!1,n.eventResources=[],n.eventsChecked={},n.eventTypes.forEach(function(e){n.eventsChecked[e.complexName]=!1}),n.resourceTypesDropdown=[],n.resourceTypes.forEach(function(e){n.resourceTypesDropdown.push({text:e.dropdown,value:e.display})}),n.selectValue={value:""},n.bucket=c.getCurrentBucket(),n.currentEventType=n.eventTypes[0],n.S3Constants=u,n.selectedEvent.events.forEach(function(e){n.eventsChecked[e]=!0}),n.cachedSelectedEvents=t.cloneDeep(n.selectedEvent),n.updateEventResources()}()}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=add-events-body> <translate class=events-label-header>events.label.name</translate> <awsui-tooltip text="{{ \'events.tooltip.name\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group class=label-text> <awsui-textfield class=input-text placeholder="{{\'events.placeholder.name\' | translate}}" ng-model=selectedEvent.id change="cachedSelectedEvents.id=selectedEvent.id"></awsui-textfield> </awsui-control-group> <translate class=events-label-header>events.label.events</translate> <awsui-tooltip text="{{ \'events.tooltip.events\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group class=checkboxes> <awsui-checkbox ng-repeat="eventType in eventTypes" ng-model=eventsChecked[eventType.complexName] change=handleCheckboxes()>{{ eventType.simpleName }} </awsui-checkbox> </awsui-control-group> <translate class=events-label-header>events.label.prefix</translate> <awsui-tooltip text="{{ \'events.tooltip.prefix\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group class=label-text> <awsui-textfield class=input-text placeholder="{{\'events.placeholder.prefix\' | translate}}" ng-model=selectedEvent.prefix></awsui-textfield> </awsui-control-group> <translate class=events-label-header>events.label.suffix</translate> <awsui-tooltip text="{{ \'events.tooltip.suffix\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group class=label-text> <awsui-textfield class=input-text placeholder="{{\'events.placeholder.suffix\' | translate}}" ng-model=selectedEvent.suffix></awsui-textfield> </awsui-control-group> <translate class=events-label-header>events.label.sendto</translate> <awsui-tooltip text="{{ \'events.tooltip.sendto\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group class=label-text validation-message={{cardState.listTopicError}}> <awsui-select placeholder="{{ \'addeventmodal.sendtoplaceholder\' | translate }}" items=resourceTypesDropdown ng-model=selectedEvent.type change=updateEventResources()></awsui-select> </awsui-control-group> <awsui-control-group class=label-text label="{{ selectedEvent.type }}"> <awsui-select id=event-resources items=eventResources disabled="isLoadingResources || !selectedEvent.type" ng-model=selectValue.value change=selectChanged()></awsui-select> </awsui-control-group> <awsui-control-group class=label-text label={{getCustomArnLabel()}} ng-if="selectValue.value === S3Constants.EVENTS.CUSTOM"> <awsui-textfield class=input-text placeholder={{customarn_placeholder}} ng-model=selectedEvent.arn></awsui-textfield> </awsui-control-group> </div> '},function(e,t,n){"use strict";(function(e){function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").directive("stackedAreaChart",[function(){return{scope:{cloudwatchData:"=",chartId:"<",xid:"<",yid:"<",xmin:"<",xmax:"<",period:"=?",heading:"=?",totalheight:"=?",totalwidth:"=?"},template:'<div class="line-chart-container"><div class="metrics-line-chart-heading">{{ vm.heading }}</div><div id="{{ vm.chartId }}" class="storage-metrics-d3-chart"></div></div>',bindToController:!0,controllerAs:"vm",controller:"StackedAreaChartController",link:function(e,t,n,r){e.$watch("vm.cloudwatchData",function(e){e&&r.render()})}}}]),e.module("s3").controller("StackedAreaChartController",["$scope","$window","S3Constants","UtilService",function(e,n,r,i){function a(){f.select("#"+p.chartId).selectAll("svg").remove()}function o(e){var t={storageTypes:[],colors:{},timeToValueHash:{}};if(t=e.reduce(function(e,t){var n=t.Dimensions.find(function(e){return"StorageType"===e.Name}).Value;return e.storageTypes.indexOf(n)<0&&e.storageTypes.push(n),e.colors[n]=t.color,t.statistics.Datapoints.forEach(function(t){var r=1e3*t.Timestamp;e.timeToValueHash[r]||(e.timeToValueHash[r]={}),e.timeToValueHash[r][n]=t[p.yid]}),e},t),p.period)for(var n=1e3*p.period,r=Object.keys(t.timeToValueHash).sort(),i=1;i<r.length;i++){var a=r[i]-r[i-1];a>n&&(t.timeToValueHash[r[i]-n]={})}return t}function s(e,n){var r={},i=[];for(var a in e){for(var o=e[a],s=0,c=0;c<n.length;c++){var l,u=n[c],d=o[u]||0;r[u]||(r[u]=[]),r[u].push((l={},t(l,p.xid,+a),t(l,p.yid,d),t(l,"y0",s),l)),s+=d}i.push(s)}return{typeToValueHash:r,stackedValues:i}}function c(e){var t=f.format(".1f"),n=r.BYTES.BASE;return e<n?t(e):e<n*n?t(e/n)+"k":e<n*n*n?t(e/n/n)+"M":e<n*n*n*n?t(e/n/n/n)+"G":t(e/n/n/n/n)+"T"}function l(e,t){var n={};for(var r in t)n[r]=e.append("g").attr("class","focus").append("circle").style("display","none").attr("r",4.5);return n}function u(e,t,n,r,a,o,s){var u=e.append("line").attr("class","aim"),d=e.append("line").attr("class","aim"),g=l(e,t),m=e.append("rect").attr("style","cursor:crosshair"),h=e.append("g").style("opacity",0),b=e.append("g").style("opacity",0);h.append("rect").attr("class","chart-rect").attr("width","80px").attr("height","16px"),b.append("rect").attr("class","chart-rect").attr("width","16px").attr("height","80px");var v=h.append("text").attr("class","tooltip-text").attr("transform","translate(10, 12)"),E=e.append("g");E.append("text").attr("class","tooltip-text").style("text-anchor","middle").attr("transform","rotate(-90)");var S=i.formatShortDateTimeWithoutYear.bind(i),y=c,A=function(e){var t=e.name,n=e.value;if(!t||!n)return"";var r=y(n[p.yid]);return'<div><div class="square" style="background: '+s[t]+'"></div> '+t+": "+r+"</div>"},C=f.select("#"+p.chartId).append("div").style("display","none").attr("class","aggre-tooltip");m.attr("class","overlay").attr("width",a).attr("height",o).on("mouseover",function(){for(var e in g)g[e].style("display",null);C.style("display","block")}).on("mouseout",function(){for(var e in g)g[e].style("display","none");d.style("opacity",0),u.style("opacity",0),h.style("opacity",0),b.style("opacity",0),E.style("opacity",0),C.style("display","none")}).on("mousemove",function(){m.style("cursor","crosshair");var e=f.mouse(this),i=e[0],s=e[1];e[0]<44?i=44:e[0]>a-40&&(i=a-40),e[1]<40?s=40:e[1]>o-46&&(s=o-46),d.attr("x1",e[0]).attr("y1",0).attr("x2",e[0]).attr("y2",o),u.attr("x1",0).attr("y1",e[1]).attr("x2",a).attr("y2",e[1]),d.style("opacity",.9),u.style("opacity",.9);var c=n.invert(e[0]),l=r.invert(e[1]),_=f.bisector(function(e){return e[p.xid]}).left,w=[],T=0,R=0,O=0;for(var k in t){var I=t[k],P=_(t[k],c,1)-1,N=I[P],M=I[P+1],L=N;if(M&&c.getTime()-N[p.xid]>M[p.xid]-c.getTime()&&(P+=1,L=M),w.push({name:k,value:I[P]}),L){T=n(L[p.xid]),R=r(L[p.yid]+L.y0),O=0;var x=S(new Date(L[p.xid])),D='<div class="aggre-tooltip-title">'+x+"</div>"+w.map(A).join("");C.html(D),g[k].attr("transform","translate("+T+", "+R+")")}}var j=C.property("clientWidth");T+j>p.totalwidth&&(O=p.totalwidth-j-T-1),C.style("left",T+O+"px"),E.select("text").text(y(l)),E.attr("transform","translate(4, "+s+")"),v.text(S(c)),h.attr("transform","translate("+(i-40)+", "+(o-13)+")"),b.attr("transform","translate(-8, "+(s-40)+")"),h.style("opacity",.9),b.style("opacity",.9),E.style("opacity",.9)})}function d(e,t,n,r){a();var o=p.xid,s=p.yid,l=p.totalwidth||m,d=p.totalheight||h,b={top:40,right:20,bottom:40,left:80},v=l-b.left-b.right,E=d-b.top-b.bottom,S=f.select("#"+p.chartId).append("svg").attr("width",l).attr("height",d).append("g").attr("transform","translate("+b.left+", "+b.top+")"),y=f.time.scale().range([0,v]),A=f.scale.linear().range([E,0]);y.domain([p.xmin,p.xmax]).nice(),A.domain([0,1.1*f.max(n)]);var C=f.svg.area().defined(function(e){return 0!==e[s]}).x(function(e){return y(e[o])}).y0(function(e){return A(e.y0?e.y0:0)}).y1(function(e){return A(e[s]+e.y0)}),_=function(e,t){return f.ascending(e.Timestamp,t.Timestamp)},w=function(e){var t=[];for(var n in e)t.push({name:n,values:e[n].sort(_)});return t}(t);S.selectAll(".layer").data(w).enter().append("g").attr("class","layer").append("path").attr("class","area").attr("d",function(e){return C(e.values)}).attr("id",function(e){return"chart-"+e.name}).style("fill",function(e){return r[e.name]});var T=i.formatShortDateWithoutYear.bind(i);p.xmin&&p.xmax&&p.xmax-p.xmin<=12*g&&(T=f.time.format("%H:%M")),S.append("g").attr("class","x axis").attr("transform","translate(0,"+(E+4)+")").call(f.svg.axis().scale(y).orient("bottom").tickFormat(T)),S.append("g").attr("class","y axis").attr("transform","translate(-10,0)").call(f.svg.axis().scale(A).orient("left").tickFormat(c)),u(S,t,y,A,v,E,r)}var p=this,f=n.d3,g=36e5,m=380,h=Math.floor(.7*m);p.render=function(){var e=p.cloudwatchData.every(function(e){return!!e.statistics});if(p.cloudwatchData.length&&e){var t=o(p.cloudwatchData),n=t.timeToValueHash,r=t.storageTypes,i=t.colors,a=s(n,r);d(n,a.typeToValueHash,a.stackedValues,i)}}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l,u,d,p,f,g,m,h){function b(){n.cardSummaryObj.isActive=n.eventsTable.length>0,n.cardSummaryObj.isActive?n.cardSummaryObj.activeSummary.text=i.instant("bucketproperties.events.activenotifications",{count:n.eventsTable.length}):n.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperties.events.activenotifications",{count:0})}function v(){n.cardState={errorMessage:"",headerTitle:i.instant("event.table.newevent"),isAdding:!0,isSaving:!1,radioValue:"",selectedEventObj:null,selectedEventTable:null,showError:!1},n.cachedEventsSettings=null,n.eventTypes=[{simpleName:i.instant("events.eventTypes.put"),complexName:f.BUCKET_EVENTS.PUT},{simpleName:i.instant("events.eventTypes.post"),complexName:f.BUCKET_EVENTS.POST},{simpleName:i.instant("events.eventTypes.copy"),complexName:f.BUCKET_EVENTS.COPY},{simpleName:i.instant("events.eventTypes.completeMultipartUpload"),complexName:f.BUCKET_EVENTS.COMPLETE_MULTIPART_UPLOAD},{simpleName:i.instant("events.eventTypes.objectCreate"),complexName:f.BUCKET_EVENTS.CREATE_OBJECT_ALL},{simpleName:i.instant("events.eventTypes.objectlost"),complexName:f.BUCKET_EVENTS.RRS_OBJECT_LOST},{simpleName:i.instant("events.eventTypes.delete"),complexName:f.BUCKET_EVENTS.DELETE},{simpleName:i.instant("events.eventTypes.deleteMarker"),complexName:f.BUCKET_EVENTS.DELETE_MARKER_CREATED},{simpleName:i.instant("events.eventTypes.objectDelete"),complexName:f.BUCKET_EVENTS.DELETE_OBJECT_ALL},{simpleName:i.instant("events.eventTypes.restoreStarted"),complexName:f.BUCKET_EVENTS.RESTORE_STARTED},{simpleName:i.instant("events.eventTypes.restoreCompleted"),complexName:f.BUCKET_EVENTS.RESTORE_COMPLETED}],l.isFeatureEnabled(f.FAC.GLACIER_RESTORE_EVENTS)||(n.eventTypes=t.reject(n.eventTypes,function(e){return t.includes([f.BUCKET_EVENTS.RESTORE_STARTED,f.BUCKET_EVENTS.RESTORE_COMPLETED],e.complexName)})),l.isFeatureEnabled(f.FAC.S3_RRS)||(n.eventTypes=t.reject(n.eventTypes,function(e){return e.complexName===f.BUCKET_EVENTS.RRS_OBJECT_LOST})),n.eventsMap={},n.eventTypes.forEach(function(e){n.eventsMap[e.simpleName]=e.complexName,n.eventsMap[e.complexName]=e.simpleName}),n.scrollCardId="#"+n.id,n.cardSummaryObj=t.cloneDeep(f.CARD_SUMMARY_INIT),C=new c("BucketNotification","getBucketNotification"),_=new c("BucketNotification","putBucketNotification"),w=d.getCurrentBucket(),n.eventsTable=[],T=p.getCurrentRegion();var e={name:f.EVENTS.CLOUDFN,value:f.EVENTS.CLOUDCONFIG,display:f.EVENTS.LAMBDA,dropdown:i.instant("events.label.lambdafunction")};if(n.resourceTypes=[{name:f.EVENTS.TOPIC,value:f.EVENTS.TOPICCONFIG,display:f.EVENTS.SNS,dropdown:i.instant("events.label.snstopic")},{name:f.EVENTS.QUEUE,value:f.EVENTS.QUEUECONFIG,display:f.EVENTS.SQS,dropdown:i.instant("events.label.sqsqueue")},e],n.forCreateBucketModal?(T=n.modalInfo.region,n.isFeatureEnabled("s3-la-"+T)||n.resourceTypes.pop()):o.getBucketLocation(w).then(function(e){T=e,n.isFeatureEnabled("s3-la-"+T)||n.resourceTypes.pop()}),n.forCreateBucketModal&&n.$watch("cardOpen",function(e,t){r(function(){m.scrollCardToView(f.BUCKET_PROPERTIES.EVENTS.CREATE_BUCKET_CARD)},1)}),n.forCreateBucketModal){if(n.modalInfo.copySettingsSourceBucket){var a=h.convertXmlStringToJson(n.createBucketObj.response);n.currentEvents=s.parseBucketNotificationConfig(a),n.createBucketObj.currentEvents=n.currentEvents}else n.createBucketObj.currentEvents?n.currentEvents=n.createBucketObj.currentEvents:n.currentEvents={Topic:[],Queue:[],CloudFunction:[]};n.updateTable()}else n.cardSummaryObj.isLoading=!0,n.updateEvents().then(function(){n.updateTable(),b(),n.cardSummaryObj.isLoading=!1})}function E(e,t){return e&&t?e+", "+t:e||t||""}function S(e){return t.find(n.resourceTypes,function(t){return t.display===e.type})}function y(e){o.putBucketNotification(w,_,n.currentEvents).then(function(){n.closeCard(e),n.cardState.selectedEventObj&&(n.cardState.selectedEventTable.isEditing=!1),n.cardState.selectedEventTable=null,n.cardState.selectedEventObj=null,n.cardState.radioValue="",n.cardState.isSaving=!1,n.cardState.showError=!1,n.cardState.isAdding=!1,n.updateEvents().then(function(){n.updateTable(),b()})}).catch(function(e){A(e)})}function A(e){var t=m.handleErrors(e);t.indexOf(R)>-1||(n.cardState.showError=!0,n.cardState.errorMessage=t,n.cardState.isSaving=!1)}var C,_,w,T,R="provided already exists. Please provide a new statement id, or remove the existing statement";n.updateEvents=function(){return o.getBucketNotification(w,C).then(function(e){var r=e.response,i=h.convertXmlStringToJson(r);n.currentEvents=s.parseBucketNotificationConfig(i),n.cachedEventsSettings=t.cloneDeep(n.currentEvents)}).catch(function(e){A(e)})},n.updateTable=function(){n.eventsTable=[],n.currentEvents&&(n.resourceTypes.forEach(function(e){n.currentEvents[e.name].forEach(function(e){var r={id:e.id,type:e.type};r.events=t.map(e.events,function(e){return n.eventsMap[e]}).toString(),r.filter=E(e.prefix,e.suffix),r.isEditing=!1,n.eventsTable.push(r)})}),n.cardState.isAdding=!1)},n.selectEvent=function(e){n.closeAddEvents();var r=e;n.cardState.selectedEventTable=t.find(n.eventsTable,function(e){return e.id===r.id});var i=S(r);n.cardState.selectedEventObj=t.find(n.currentEvents[i.name],function(e){return e.id===r.id}),n.cardState.radioValue=n.cardState.selectedEventTable.id},n.addEvent=function(){n.cardState.selectedEventObj={id:"",type:null,prefix:"",suffix:"",arn:"",events:[]},n.cardState.selectedEventTable={id:"",type:f.EVENTS.SNS,filter:"",events:[],isEditing:!0},n.cardState.isAdding=!0,n.cardState.radioValue="",n.cardState.headerTitle=i.instant("events.table.newevent"),n.eventsTable.unshift(n.cardState.selectedEventTable)},n.closeCard=function(e){e.stopPropagation(),n.cardOpen=!1},n.closeAddEvents=function(){if(n.cardState.isAdding){var e=t.findIndex(n.eventsTable,function(e){return e===n.cardState.selectedEventTable});n.eventsTable.splice(e,1),n.cardState.isAdding=!1}else n.cardState.selectedEventTable&&n.cardState.selectedEventTable.isEditing&&(n.cardState.selectedEventTable.isEditing=!1,n.updateTable());n.cardState.selectedEventTable=null,n.cardState.selectedEventObj=null,n.cardState.radioValue=""},n.deletePressed=function(){var e=S(n.cardState.selectedEventObj),r=t.findIndex(n.currentEvents[e.name],function(e){return e.id===n.cardState.selectedEventObj.id});n.currentEvents[e.name].splice(r,1),n.cardState.selectedEventTable=null,n.cardState.selectedEventObj=null,n.cardState.radioValue="",n.updateTable()},n.editPressed=function(){n.cardState.headerTitle=n.cardState.selectedEventTable.id,n.cardState.selectedEventTable.isEditing=!0,n.cardState.isAdding=!1},n.cancelPressed=function(e){m.analyticsTrackClick(f.ANALYTICS.CANCEL_EVENTS,f.ANALYTICS.DETAILS),v(),n.closeCard(e)},n.savePressed=function(r){if(m.analyticsTrackClick(f.ANALYTICS.SAVE_EVENTS,f.ANALYTICS.DETAILS),n.cardState.isSaving=!0,n.cardState.selectedEventObj){var a=S(n.cardState.selectedEventObj),s=t.findIndex(n.currentEvents[a.name],function(e){return e.id===n.cardState.selectedEventObj.id});-1===s?n.currentEvents[a.name].push(n.cardState.selectedEventObj):n.currentEvents[a.name][s]=n.cardState.selectedEventObj}n.forCreateBucketModal?(n.createBucketObj.response=o.parseBucketNotificationObject(n.currentEvents),n.createBucketObj.currentEvents=n.currentEvents,n.cardState.selectedEventObj&&(n.cardState.selectedEventTable.isEditing=!1,n.cardState.selectedEventTable=null,n.cardState.selectedEventObj=null,n.cardState.radioValue=""),n.closeCard(r),n.cardState.isSaving=!1):function(){var a=[];n.currentEvents.CloudFunction.forEach(function(e){if(t.isEmpty(n.cachedEventsSettings)||-1===t.findIndex(n.cachedEventsSettings.CloudFunction,{id:e.id})){var r=m.parseFunctionArn(e.arn),o=m.getUserAccountId();if(null===o)return g.log("LambdaAddPermission",0,_,{bucket:w,lambda:e.arn}),void A(i.instant("events.addpermissions.error"));var s={Action:"lambda:InvokeFunction",Principal:"s3.amazonaws.com",SourceAccount:o,SourceArn:m.getBucketARN(w),StatementId:(o+"_event_permissions_for_"+e.id+"_from_"+m.replaceNotAllowedChars(w,"[^a-zA-Z0-9-_]+","_")+"_for_"+r.functionName).substring(0,100)};a.push(u.addPermission({region:T,path:"/2015-03-31/functions/"+r.functionName+"/policy",content:JSON.stringify(s)}).then(function(){g.log("LambdaAddPermission",1,_,{bucket:w,lambda:e.arn})}).catch(function(t){g.log("LambdaAddPermission",0,_,{bucket:w,lambda:e.arn}),A(t)}))}}),e.all(a).then(function(){y(r)})}()},n.isFeatureEnabled=function(e){return l.isFeatureEnabled(e)},n.docLink=a.getDocUrl(f.LEARN_MORE_LINKS.EVENTS),v()}e.module("s3").directive("events",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",createBucketObj:"=?",modalInfo:"=?",id:"@?"},template:n(691),controller:"EventsController"}}]),e.module("s3").controller("EventsController",["$q","$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","LambdaService","PathService","Region","S3Constants","SCLogService","UtilService","XMLParser",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-events-water-mark\': !cardOpen, \'card-enable-events-water-mark\': cardOpen }"> <card-header> <span translate=events.header></span> <div class=card-close-icon ng-if=cardOpen ng-click=closeCard($event)></div> </card-header> <card-content> <awsui-button ng-if=cardOpen data-disabled=cardState.isAdding text="{{\'events.button.addnotification\' | translate}}" icon=plus variant=link click=addEvent()></awsui-button> <awsui-button ng-if=cardOpen data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.delete\' | translate }}" variant=link click=deletePressed() loading=isDeleting> </awsui-button> <awsui-button ng-if=cardOpen data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.edit\' | translate }}" variant=link click=editPressed()> </awsui-button> <div class=events-table ng-if=cardOpen> <awsui-radio-group ng-model=cardState.radioValue> <table class="table table-condense"> <thead> <tr> <td></td> <td translate>events.table.name</td> <td translate>events.table.events</td> <td translate>events.table.filter</td> <td translate>events.table.type</td> </tr> </thead> <tbody> <tr ng-repeat-start="event in eventsTable" class=add-events-row ng-if=event.isEditing> <td colspan=4>{{ cardState.headerTitle }}</td> <td colspan=1> <span class="panel-close-icon close-button" ng-click=closeAddEvents()></span> </td> </tr> <tr ng-repeat-end> <td colspan=5 ng-if=event.isEditing> <add-events-form id=add-events-form event-types=eventTypes selected-event=cardState.selectedEventObj resource-types=resourceTypes modal-info=modalInfo for-create-bucket-modal=forCreateBucketModal card-state=cardState current-events=currentEvents></add-events-form> </td> <td ng-if=!event.isEditing> <awsui-radio-button ng-click=selectEvent(event) value={{event.id}}> <td ng-if=!event.isEditing class=event-id>{{event.id}}</td> <td ng-if=!event.isEditing>{{event.events}}</td> <td ng-if=!event.isEditing>{{event.filter}}</td> <td ng-if=!event.isEditing>{{event.type}}</td> </awsui-radio-button> </td> </tr> </tbody> <tr ng-if="currEvents.length === 0 && !isAddingEvent"> <td colspan=5> <div class=empty-message> {{ \'events.table.emptymessage\' | translate }} <awsui-button text="{{\'events.button.addnotification\' | translate}}" ng-click=openAddEventModal()></awsui-button> </div> </td> </tr> </table> </awsui-radio-group> </div> <p ng-if=!cardOpen class=bucketproperties-summary translate=bucketproperties.events.summary></p> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert ng-if=cardOpen type=error visible=cardState.showError>{{ cardState.errorMessage }}</awsui-alert> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button text="{{ \'events.button.cancel\' | translate }}" variant=normal ng-click=cancelPressed($event)> </awsui-button> <awsui-button text="{{ \'events.button.save\' | translate }}" variant=primary data-disabled="cardState.selectedEventObj.name === \'\' || cardState.selectedEventObj.arn === \'\'" ng-click=savePressed($event) loading=cardState.isSaving> </awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("modalPermissions",[function(){return{restrict:"E",scope:{publicPermissions:"=",userPermissions:"=",isAddingAccount:"=",awsAccountPermissions:"=",systemPermissions:"=?",showSystemPermissions:"@?",blockPublicAclsMessage:"<?",owner:"=",modalType:"="},template:n(693),controller:"ModalPermissionsController"}}]),e.module("s3").controller("ModalPermissionsController",["$filter","$scope","$translate","S3Constants",function(e,n,r,i){n.manageUserTitles=[{txt:r.instant("modal.manageusertitles.userid"),info:r.instant("modal.userid.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objects"),info:r.instant("modal.objects.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objectspermissions"),info:r.instant("modal.objectspermissions.tooltip"),pos:"left"}],n.manageAWSAccountTitles=[{txt:r.instant("modal.manageusertitles.accounts"),info:r.instant("modal.awsaccounts.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objects"),info:r.instant("modal.objects.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objectspermissions"),info:r.instant("modal.objectspermissions.tooltip"),pos:"left"}],n.publicpermissionsecTitles=[{txt:r.instant("modal.publicpermissionsectitles.group"),info:r.instant("modal.group.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objects"),info:r.instant("modal.objects.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objectspermissions"),info:r.instant("modal.objectspermissions.tooltip"),pos:"left"}],n.systempermissionsecTitles=[{txt:r.instant("modal.publicpermissionsectitles.group"),info:r.instant("modal.group.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objects"),info:r.instant("modal.objects.tooltip"),pos:"right"},{txt:r.instant("modal.manageusertitles.objectspermissions"),info:r.instant("modal.objectspermissions.tooltip"),pos:"left"}],n.addOwnerPermissions=function(){n.userPermissions[0].revokeAll&&(n.userPermissions[0].revokeAll=!1)},n.makePublicOptions=[{text:r.instant(n.modalType+".permission.disablepublic"),value:!1},{text:r.instant(n.modalType+".permission.enablepublic"),value:!0}],n.selectedItems={makePublic:n.makePublicOptions[0]},n.makePublicWarningHeader=r.instant(n.modalType+".acl.makepublic.warning.header"),n.makePublicWarningBody=r.instant(n.modalType+".acl.makepublic.warning.body"),n.$watchCollection("selectedItems",function(e){n.publicPermissions[1].permissions.READ=t.get(e.makePublic,"value")}),n.MODAL_TYPES=i.MODAL_TYPE}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=modal-permissions> <div id=user-permissions-section class=modal-permissions-section> <h3 class="subheader dark" translate="{{\'modal.acl.header.manageusers\'}}"></h3> <permissions-sub-modal is-public=false acl-modal-titles=manageUserTitles permissions=userPermissions modal-type=modalType> </permissions-sub-modal> </div> <div id=awsaccount-permissions-section class=modal-permissions-section> <h3 class="subheader manageawsaccounts-title dark" translate="{{\'modal.acl.header.manageawsaccount\'}}"></h3> <permissions-sub-modal is-public=false is-aws-account=true is-adding-account=isAddingAccount acl-modal-titles=manageAWSAccountTitles permissions=awsAccountPermissions modal-type=modalType> </permissions-sub-modal> </div> <div id=public-permissions-section class=modal-permissions-section> <h3 class="subheader dark" translate="{{\'modal.acl.header.managepublicpermissions\'}}"></h3> <awsui-alert ng-if=blockPublicAclsMessage type=warning id=blockPublicAclsAlert>{{blockPublicAclsMessage}}</awsui-alert> <dropdown id=make-public-dropdown items=makePublicOptions selected-item=selectedItems.makePublic disabled=blockPublicAclsMessage></dropdown> <awsui-alert class=padding-top-20 ng-class="{\'padding-bottom-20\': modalType === MODAL_TYPES.UPLOAD}" ng-if=publicPermissions[1].permissions.READ type=warning header={{makePublicWarningHeader}}> {{makePublicWarningBody}} </awsui-alert> </div> <modal-system-permissions system-permissions=systemPermissions ng-if=showSystemPermissions></modal-system-permissions> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("permissionsSubModal",function(){return{restrict:"E",scope:{isPublic:"=",isAwsAccount:"=?",aclModalTitles:"=",isAddingAccount:"=",permissions:"=",modalType:"="},template:n(695),controller:"PermissionSubModalController"}}),e.module("s3").controller("PermissionSubModalController",["$scope","$timeout","UtilService","S3Constants",function(n,r,i,a){function o(){return{detail:null,permissions:{READ:!1,READ_ACP:!1,WRITE:!1,WRITE_ACP:!1},revokeAll:!1}}function s(){n.newAwsAccount.detail=null,n.newAwsAccount.permissions.READ=!1,n.newAwsAccount.permissions.READ_ACP=!1,n.newAwsAccount.permissions.WRITE=!1,n.newAwsAccount.permissions.WRITE_ACP=!1,n.newAwsAccount.revokeAll=!1}n.deleteUserAcl=function(t){n.permissions[t].revokeAll=!0,e.forEach(n.permissions[t].permissions,function(e,r){n.permissions[t].permissions[r]=!1})},n.addAwsAccountPermission=function(){n.isAddingAccount.flag=!0,n.newAwsAccount=o(),r(function(){e.element(".newawsaccount-permission-textbox input").focus()})},n.deleteAwsAccountAcl=function(e){var r=t.findIndex(n.permissions,{detail:e});n.permissions.splice(r,1)},n.saveAwsAccountPermission=function(){t.isEmpty(n.permissions)&&(n.permissions=[]),i.validateEmail(n.newAwsAccount.detail.ID)&&(n.newAwsAccount.detail.EmailAddress=n.newAwsAccount.detail.ID,n.newAwsAccount.detail.ID=null),n.permissions.push(t.cloneDeep(n.newAwsAccount)),s(),n.isAddingAccount.flag=!1,n.isAddingAccount.warningMsg=null},n.clearAwsAccountPermission=function(){s(),n.isAddingAccount.flag=!1,n.isAddingAccount.warningMsg=null},n.isUploadObject=n.modalType===a.MODAL_TYPE.UPLOAD}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<awsui-button icon=plus ng-if=isAwsAccount text="{{ \'permissonsubmodal.addnewaccount\' | translate }}" variant=primary class=addawsaccount-button click=addAwsAccountPermission()> </awsui-button> <awsui-alert class=input-error header="{{ \'warning.header\' | translate }}" visible="isAwsAccount && isAddingAccount.warningMsg" type=warning> {{ isAddingAccount.warningMsg }}</awsui-alert> <table class=expandsectable> <tr class=subsectitle-row> <td ng-repeat="aclTitle in aclModalTitles"> {{aclTitle.txt}} <awsui-tooltip text={{aclTitle.info}} position={{aclTitle.pos}} size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </td> <td></td> <td ng-if=isAwsAccount></td> <td ng-if=isAwsAccount></td> </tr> <tr ng-repeat="permission in permissions" ng-if="!permissions[$index].revokeAll && permissions[$index].detail.value !== \'AuthenticatedUsers\'"> <td ng-if=isPublic>{{permission.detail.text}}</td> <td ng-if="!isPublic && !isAwsAccount">{{permission.detail.DisplayName}}<span ng-if="$index===0" translate=userpermission.owner></span></td> <td ng-if=isAwsAccount class=truncate><p class="awsaccount-text truncate">{{permission.detail.DisplayName || permission.detail.EmailAddress || permission.detail.ID}}</p></td> <td> <awsui-checkbox class=createbucketcheckbox ng-model=permission.permissions.READ>{{ \'permissions.value.read\' | translate }}</awsui-checkbox> <awsui-checkbox ng-if=!isUploadObject class=createbucketcheckbox ng-model=permission.permissions.WRITE>{{ \'permissions.value.write\' | translate }}</awsui-checkbox> </td> <td> <awsui-checkbox class=createbucketcheckbox ng-model=permission.permissions.READ_ACP>{{ \'permissions.value.read\' | translate }}</awsui-checkbox> <awsui-checkbox class=createbucketcheckbox ng-model=permission.permissions.WRITE_ACP>{{ \'permissions.value.write\' | translate }}</awsui-checkbox> <span class="permissions-sub-modal-close close-icon" ng-if="!isPublic && !isAwsAccount" ng-click=deleteUserAcl($index)></span> </td> <td ng-if=isAwsAccount></td> <td ng-if=isAwsAccount><span class="permissions-sub-modal-close close-icon" ng-click=deleteAwsAccountAcl(permission.detail)></span></td> </tr> <tr ng-if="isAwsAccount && isAddingAccount.flag"> <td><awsui-textfield class=newawsaccount-permission-textbox placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}" ng-model=newAwsAccount.detail.ID></awsui-textfield></td> <td> <awsui-checkbox class=createbucketcheckbox ng-model=newAwsAccount.permissions.READ>{{ \'permissions.value.read\' | translate }}</awsui-checkbox> <awsui-checkbox ng-if=!isUploadObject class=createbucketcheckbox ng-model=newAwsAccount.permissions.WRITE>{{ \'permissions.value.write\' | translate }}</awsui-checkbox> </td> <td> <awsui-checkbox class=createbucketcheckbox ng-model=newAwsAccount.permissions.READ_ACP>{{ \'permissions.value.read\' | translate }}</awsui-checkbox> <awsui-checkbox class=createbucketcheckbox ng-model=newAwsAccount.permissions.WRITE_ACP>{{ \'permissions.value.write\' | translate }}</awsui-checkbox> </td> <td ng-if=isAwsAccount> <awsui-button text="{{ \'permissonsubmodal.saveawsaccounts\' | translate }}" variant=primary class=saveawsaccount-button click=saveAwsAccountPermission() data-disabled="!newAwsAccount.detail.ID && !newAwsAccount.detail.EmailAddress || !newAwsAccount.permissions.READ && !newAwsAccount.permissions.READ_ACP && !newAwsAccount.permissions.WRITE && !newAwsAccount.permissions.WRITE_ACP"> </awsui-button> </td> <td ng-if=isAwsAccount> <awsui-button text="{{ \'permissonsubmodal.clearawsaccounts\' | translate }}" class="clearawsaccount-button awsui-util-f-r" click=clearAwsAccountPermission()> </awsui-button> </td> </tr> </table>'},function(e,t,n){"use strict";(function(e,t){function r(e,n,r){var i=this;i.isPublicAccessBlockAvailable="hasPublicAccessBlock"in n,i.logDeliveryOptions=[{text:r.instant("createbucket.permission.disablelogdelivery"),value:!1},{text:r.instant("createbucket.permission.enablelogdelivery"),value:!0}],i.selectedItem=i.logDeliveryOptions[0],e.$watch("vm.selectedItem",function(e){i.systemPermissions&&(i.systemPermissions[0].permissions.READ=t.get(e,"value"))})}e.module("s3").directive("modalSystemPermissions",[function(){return{restrict:"E",scope:{},bindToController:{systemPermissions:"="},template:n(697),controller:"ModalSystemPermissionsController",controllerAs:"vm"}}]),e.module("s3").controller("ModalSystemPermissionsController",["$scope","$attrs","$translate",r])}).call(t,n(0),n(2))},function(e,t){e.exports="<div id=systemPermissionsSection class=last-section ng-class=\"vm.isPublicAccessBlockAvailable ? 'public-access-permissions-section' : 'modal-permissions-section'\"> <div ng-if=vm.isPublicAccessBlockAvailable> <span class=public-access-permissions-section__header translate=modal.acl.header.managesystempermissions></span> <div class=public-access-permissions-section__divider></div> </div> <h3 ng-if=!vm.isPublicAccessBlockAvailable class=\"subheader dark\">{{'modal.acl.header.managesystempermissions' | translate}}</h3> <dropdown id=log-delivery-dropdown items=vm.logDeliveryOptions selected-item=vm.selectedItem></dropdown> </div>"},function(e,t,n){"use strict";(function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").service("PermissionsUtilService",["S3Constants",function(r){function i(e,n,i,a){t.forEach(n,function(n,o){if(r.PUBLIC_PERMISSIONS_LIST.indexOf(o)>-1){var s=t.findIndex(e.publicPermissions,{detail:{value:o}});s>-1&&(e.publicPermissions[s].permissions=t.clone(n))}else if(r.SYSTEM_PERMISSIONS_LIST.indexOf(o)>-1)e.systemPermissions[0].permissions=t.clone(n);else if(i.ID===o||i.DisplayName===o)e.userPermissions[0].permissions=t.clone(n);else{var c=t.find(a,function(e){return e.Grantee.ID===o||e.Grantee.DisplayName===o});t.isEmpty(c)||e.awsAccountPermissions.push({detail:t.cloneDeep(c.Grantee),permissions:t.clone(n)})}})}function a(e,n){var r=t.cloneDeep(e.aclGrants);return r=t.isEmpty(r)||Array.isArray(r)?t.isEmpty(r)?[]:r:[r],r=t.isEmpty(r)?o(n):u(r,e,n)}function o(t){var n=[],r=[];return r=r.concat(t.userPermissions,t.publicPermissions),r=r.concat(t.systemPermissions),r=r.concat(t.awsAccountPermissions),e.forEach(r,function(e){l(e.permissions,e.detail,n)}),n}function s(e,t,n){return n.forEach(function(r,i){(r.Grantee.URI&&-1!==r.Grantee.URI.indexOf(e)||r.Grantee.DisplayName&&r.Grantee.DisplayName===e||r.Grantee.ID&&r.Grantee.ID===e)&&r.Permission===t&&n.splice(i,1)}),n}function c(n,i,a,o,c,l){t.values(a).indexOf(!1)>-1&&-1===t.values(i[c]).indexOf(!1)&&t.findIndex(n,{Permission:r.ACL_PERMISSIONS.FULL_CONTROL})>-1?(s(c,r.ACL_PERMISSIONS.FULL_CONTROL,n),e.forEach(a,function(e,t){!0===e&&d(o,t,n)})):-1===t.values(a).indexOf(!1)&&t.values(i[c]).indexOf(!1)>-1&&(d(o,r.ACL_PERMISSIONS.FULL_CONTROL,n),e.forEach(r.ACL_PERMISSIONS,function(e,t){t!==r.ACL_PERMISSIONS.FULL_CONTROL&&s(c,e,n)}),l.fullControlAdded=!0,l.allPermissionsRevoked=!1),l.fullControlAdded||t.keys(a).forEach(function(e){a[e]!==i[c][e]?!1===a[e]||void 0===a[e]&&!0===i[c][e]?s(c,e,n):!0===a[e]&&(d(o,e,n),l.allPermissionsRevoked=!1):!0===i[c][e]&&(l.allPermissionsRevoked=!1)})}function l(e,n,i){e&&4===Object.keys(e).length&&-1===t.values(e).indexOf(!1)?d(n,r.ACL_PERMISSIONS.FULL_CONTROL,i):e&&d(n,e,i)}function u(n,r,i){var a={AllUsers:t.find(i.publicPermissions,{detail:{value:"AllUsers"}}),AuthenticatedUsers:t.find(i.publicPermissions,{detail:{value:"AuthenticatedUsers"}}),LogDelivery:t.find(i.systemPermissions,{detail:{value:"LogDelivery"}})};return e.forEach(i.userPermissions.concat(i.awsAccountPermissions),function(e){var t=e.detail.DisplayName||e.detail.EmailAddress||e.detail.ID;t&&(a[t]=e)}),e.forEach(a,function(e,i){if(r.grantees[i]){if(!t.isEqual(e.permissions,r.grantees[i])){var a={allPermissionsRevoked:!0,fullControlAdded:!1};c(n,r.grantees,e.permissions,e.detail,i,a)}}else l(e.permissions,e.detail,n)}),n}function d(e,n,r){if(!Array.isArray(r)){var i=r;r=t.isEmpty(i)?[]:[i]}var a={Type:e.Type,DisplayName:e.DisplayName,EmailAddress:e.EmailAddress,ID:e.ID,URI:e.URI};return t.isString(n)?r.push({Grantee:a,Permission:n}):n&&t.forEach(n,function(e,t){e&&r.push({Grantee:a,Permission:t})}),r}function p(e){return e.Grantee.URI?e.Grantee.URI.split("/").pop():e.Grantee.ID}function f(e,t){var n=p(e);n&&(t[n]||(t[n]={READ:!1,WRITE:!1,READ_ACP:!1,WRITE_ACP:!1}),"FULL_CONTROL"===e.Permission?t[n]={READ:!0,WRITE:!0,READ_ACP:!0,WRITE_ACP:!0}:t[n][e.Permission]=!0)}function g(e,n){t.forEach(e,function(e){t.isEmpty(n[e])&&(n[e]={READ:!1,WRITE:!1,WRITE_ACP:!1,READ_ACP:!1})})}function m(e,i){var a,o=i.ID,s=(a={},n(a,r.GRANTEE_GROUP.GROUP,{}),n(a,r.GRANTEE_GROUP.ACCOUNTS,{}),n(a,r.GRANTEE_GROUP.SYSTEM,{}),n(a,r.GRANTEE_GROUP.OWNER,{}),a);return t.forEach(e,function(e,t){r.PUBLIC_PERMISSIONS_LIST.indexOf(t)>-1?s.group[t]=e:r.SYSTEM_PERMISSIONS_LIST.indexOf(t)>-1?s.system[t]=e:t===i.DisplayName||t===i.ID?(s.owner[t]=e,o=t):s.accounts[t]=e}),g(r.PUBLIC_PERMISSIONS_LIST,s.group),g(r.SYSTEM_PERMISSIONS_LIST,s.system),0===Object.keys(s.owner).length&&(s.owner[o]={READ:!1,WRITE:!1,WRITE_ACP:!1,READ_ACP:!1}),s}return{populateAclsFields:i,updateAcl:a,aclsUpdate:c,addNewPermissions:l,updateGranteesHelperFunction:f,updateGrantees:m,extractGranteeKey:p}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){function t(e){e.objectPropertiesAlerts=[],e.displayAlert=function(t,n,r){e.objectPropertiesAlerts.push({visible:!0,header:n,text:t,type:r,dismissible:!0})}}e.module("s3").directive("objectProperties",[function(){return{restrict:"E",scope:{obj:"=",options:"="},template:n(700),controller:"ObjectPropertiesController"}}]),e.module("s3").controller("ObjectPropertiesController",["$scope",t])}()}).call(t,n(0))},function(e,t){e.exports='<awsui-alert ng-repeat="alert in objectPropertiesAlerts" visible=alert.visible type="{{ alert.type }}" header="{{ alert.header }}" dismissible=alert.dismissible>{{ alert.text }}</awsui-alert> <div class=awsui-grid> <div class="awsui-container properties-cards"> <div class="wrapper awsui-row object-properties"> <object-storage-class ng-if=obj id=object-storage-card obj=obj></object-storage-class> <object-encryption ng-if="obj && obj.Encryption" id=object-sse-card obj=obj options=options></object-encryption> <object-metadata ng-if=obj id=object-metadata-card obj=obj></object-metadata> <object-tag-card ng-if=obj id=object-tags-card obj=obj fac-id=s3-ot></object-tag-card> <object-retention-card ng-if=obj id=object-retention-card obj=obj fac-id=s3-sharpie display-alert="displayAlert(text, header, type)"></object-retention-card> </div> </div> </div>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c){function l(){var e=n.getStorageClassTranslation();n.cardSummaryObj.isActive=!c.isStorageClassRestorable(n.obj.StorageClass),n.cardSummaryObj.isActive?n.cardSummaryObj.activeSummary.text=e:n.cardSummaryObj.inactiveSummary.text=e}n.docLink=r.getDocUrl(o.LEARN_MORE_LINKS.STORAGE_CLASS),n.cachedObj=e.copy(n.obj),n.selectedStorageClass=void 0,n.cancel=function(e){c.analyticsTrackClick(o.ANALYTICS.CANCEL_OBJECT_STORAGE_CLASS,o.ANALYTICS.DETAILS),e.stopPropagation(),n.storageClassError="",n.cardOpen=!1,n.cachedObj.StorageClass=n.obj.StorageClass},n.getStorageClassTranslation=function(){return c.getStorageClassTranslations()[n.obj.StorageClass]},n.scrollCardId="#"+n.id,n.cardSummaryObj=t.cloneDeep(o.CARD_SUMMARY_INIT),l(),n.onSelectStorageClass=function(e){n.cachedObj.StorageClass=e},n.save=function(e){c.analyticsTrackClick(o.ANALYTICS.SAVE_OBJECT_STORAGE_CLASS,o.ANALYTICS.DETAILS),e.stopPropagation(),n.storageClassError="",n.isSaving=!0;var t=[n.obj],r={targetStorageClass:n.cachedObj.StorageClass,numberOfKeysPerBulkOperation:1},u=i.createBulkOperation(o.OPERATION_NAME.CHANGE_STORAGE_CLASS,t,[],1,r);u.totalSizeInBytes=t[0].Size,a.addOperation(u),s.log("ChangeStorageClassReceived",1,u),u.defer.promise.then(function(e){var t=Object.keys(e);t.length>0?(n.storageClassError=t[0],s.log("ChangeStorageClassComplete",0,u)):(n.obj.StorageClass=n.cachedObj.StorageClass,n.cardOpen=!1,s.log("ChangeStorageClassComplete",1,u),l())}).catch(function(e){s.log("ChangeStorageClassComplete",0,u),n.storageClassError=c.handleErrors(e)}).finally(function(){n.isSaving=!1})}}e.module("s3").directive("objectStorageClass",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},template:n(702),controller:"ObjectStorageClassController"}}]),e.module("s3").controller("ObjectStorageClassController",["$scope","AwsUrlsService","BulkOperationService","OperationDispatcherService","S3Constants","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports="<card card-id=scrollCardId card-summary-obj=cardSummaryObj is-open=cardOpen disable-expand=\"obj && (obj.StorageClass === 'GLACIER' || obj.StorageClass === 'DEEP_ARCHIVE' || obj.IsLatest && obj.IsLatest !== 'true')\" ng-class=\"{ 'card-disable-storage-class-water-mark': !cardOpen, 'card-enable-storage-class-water-mark': cardOpen }\"> <card-header> <span translate=objectproperties.label.storageclass></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancel($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=objectproperties.storageclass.blurb></p> <div class=awsui-container ng-if=cardOpen> <storage-class-table storageclassvalue=cachedObj.StorageClass on-select-storage-class=onSelectStorageClass></storage-class-table> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert type=error ng-if=\"storageClassError && cardOpen\">{{ storageClassError }}</awsui-alert> </card-content> <card-footer> <div class=object-properties-buttons ng-if=cardOpen> <awsui-button id=objectstorage-cancel ng-click=cancel($event) text=\"{{ 'button.cancel' | translate }}\"></awsui-button> <awsui-button id=objectstorage-save ng-click=save($event) data-disabled=\"obj.StorageClass == cachedValue.StorageClass\" text=\"{{ 'button.save' | translate }}\" loading=isSaving variant=primary></awsui-button> </div> </card-footer> </card>"},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p,f,g){function m(){r.obj.Encryption=r.cachedValue.Encryption,r.model.selectedOption=r.obj.Encryption,r.model.selectedOption===d.OBJECT_SSE.KMS_ENCRYPTION?r.options.kmsId=r.cachedValue.KmsID:r.options.kmsId=void 0,h()}function h(){var e=r.model.selectedOption===i.instant("resource.access.denied");r.cardSummaryObj.isActive=!e&&r.model.selectedOption!==d.OBJECT_SSE.NONE&&t.get(r,"obj.Encryption")!==d.OBJECT_SSE.SSEC,r.cardSummaryObj.inactiveSummary.text=e?i.instant("resource.access.denied"):f.getEncryptionTranslations()[r.model.selectedOption],r.cardSummaryObj.activeSummary.text=e?i.instant("resource.access.denied"):f.getEncryptionTranslations()[r.model.selectedOption]}r.S3Constants=d,r.docLink=a.getDocUrl(d.LEARN_MORE_LINKS.ENCRYPTION),r.scrollCardId="#"+r.id,r.aws_kms=d.OBJECT_SSE.KMS_ENCRYPTION,r.custom_arn=d.OBJECT_SSE.CUSTOM_ARN,r.cachedValue=e.copy(r.obj),r.model={},r.model.selectedOption=t.isEmpty(r.obj.Encryption)?void 0:r.obj.Encryption,r.cancel=function(e){f.analyticsTrackClick(d.ANALYTICS.CANCEL_OBJECT_SSE,d.ANALYTICS.DETAILS),e.stopPropagation(),r.sseError="",r.cardOpen=!1,m()},r.disableExpand=function(){var e=r.obj;return e&&(f.isStorageClassRestorable(e.StorageClass)||e.IsLatest&&"true"!==e.IsLatest||e.Encryption===d.OBJECT_SSE.SSEC)};var b=function(){var e=new c("GetKMSKeysForObjectSSE"),i=u.getCurrentBucket();return r.cardSummaryObj||(r.cardSummaryObj=t.cloneDeep(d.CARD_SUMMARY_INIT)),r.kmsKeys=[],r.cardSummaryObj.isLoading=!0,g.getKMSKeysById(e,i,d.OBJECT_SSE.CUSTOM_ARN).then(function(e){r.kmsKeys=e}).catch(function(e){return r.KMSServiceError=e,r.sseError=e,n.reject(e)}).finally(function(){r.cardSummaryObj.isLoading=!1})};r.updateKMSKey=function(e){e===d.OBJECT_SSE.KMS_ENCRYPTION?b():(t.isEmpty(r.sseError)||r.sseError!==r.KMSServiceError||(r.sseError=null),r.KMSServiceError=null)},r.save=function(e){if(f.analyticsTrackClick(d.ANALYTICS.SAVE_OBJECT_SSE,d.ANALYTICS.DETAILS),e.stopPropagation(),!r.isSaving&&!r.disableSave()){r.sseError="",r.isSaving=!0;var t=[r.obj],n=void 0;r.model.selectedOption===d.OBJECT_SSE.KMS_ENCRYPTION&&(n=r.options.kmsId.value===d.OBJECT_SSE.CUSTOM_ARN?r.options.kmsARN:r.options.kmsId.value);var i={sseAlgo:r.model.selectedOption,numberOfKeysPerBulkOperation:1,sseKmsKeyId:n},a=s.createBulkOperation(d.OPERATION_NAME.CHANGE_SSE,t,[],1,i);a.totalSizeInBytes=t[0].Size,l.addOperation(a),p.log("ChangeSSERequestReceived",1,a),a.defer.promise.then(function(e){var t=Object.keys(e);t.length>0?(r.sseError=t[0],p.log("ChangeSSERequestComplete",0,a)):(r.cachedValue.Encryption=r.model.selectedOption,r.obj.Encryption=r.model.selectedOption,r.cardOpen=!1,r.model.selectedOption===d.OBJECT_SSE.KMS_ENCRYPTION&&(r.options.kmsId.value===d.OBJECT_SSE.CUSTOM_ARN?(r.options.kmsId.value=n,r.obj.KmsID=r.options.kmsARN):r.obj.KmsID=r.options.kmsId.text,r.cachedValue.KmsID=n),p.log("ChangeSSERequestComplete",1,a),r.model.selectedOption!==d.OBJECT_SSE.KMS_ENCRYPTION&&(r.obj.KmsID=void 0),h())}).catch(function(e){p.log("ChangeSSERequestComplete",0,a),r.sseError=f.handleErrors(e)}).finally(function(){r.isSaving=!1})}},r.disableSave=function(){return r.model.selectedOption===r.cachedValue.Encryption&&r.model.selectedOption!==d.OBJECT_SSE.KMS_ENCRYPTION||r.model.selectedOption===d.OBJECT_SSE.KMS_ENCRYPTION&&(!r.options.kmsId||r.options.kmsId.value===r.custom_arn&&!r.options.kmsARN)||!(r.model.selectedOption!==d.OBJECT_SSE.KMS_ENCRYPTION||!r.cachedValue.KmsID||!(r.cachedValue.KmsID.indexOf(r.options.kmsId.value)>-1||r.options.kmsId===r.cachedValue.KmsID||r.options.kmsId.value===r.custom_arn&&r.options.kmsARN===r.cachedValue.KmsID))},r.model.selectedOption===d.OBJECT_SSE.KMS_ENCRYPTION&&b().then(function(){r.options.kmsId=f.getKMSAliasForArn(r.options.kmsId,r.kmsKeys)}),r.cardSummaryObj=t.cloneDeep(d.CARD_SUMMARY_INIT),h()}e.module("s3").directive("objectEncryption",[function(){return{restrict:"E",scope:{obj:"=",options:"=",id:"@?"},template:n(704),controller:"ObjectSSEController"}}]),e.module("s3").controller("ObjectSSEController",["$q","$scope","$translate","AwsUrlsService","APIProxyService","BulkOperationService","ConsoleOperation","OperationDispatcherService","PathService","S3Constants","SCLogService","UtilService","KMSPropertiesService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-id=scrollCardId card-summary-obj=cardSummaryObj is-open=cardOpen disable-expand=disableExpand() ng-class="{ \'card-disable-sse-water-mark\': !cardOpen, \'card-enable-sse-water-mark\': cardOpen }"> <card-header> <span translate=objectproperties.label.sse></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancel($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=objectproperties.sse.blurb></p> <div class=awsui-container ng-if=cardOpen> <div class="awsui-row card-content-row" fac-id=s3-no-enc> <awsui-radio-group ng-model=model.selectedOption ng-change=updateKMSKey(model.selectedOption)> <awsui-radio-button id=objectsse-none value=NONE ng-model=model.selectedOption label="{{ \'sse.none\' | translate }}"></awsui-radio-button> </awsui-radio-group> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-model=model.selectedOption ng-change=updateKMSKey(model.selectedOption)> <awsui-radio-button id=objectsse-aes256 value=AES256 ng-model=model.selectedOption label="{{ \'sse.aes256\' | translate }}"></awsui-radio-button> </awsui-radio-group> <p class=object-radio-description translate=objectproperties.sse.aes256description></p> </div> <div class="awsui-row card-content-row" fac-id=s3-kms> <awsui-radio-group ng-model=model.selectedOption ng-change=updateKMSKey(model.selectedOption)> <awsui-radio-button id=objectsse-kms value=aws:kms ng-model=model.selectedOption label="{{ \'sse.aws.kms\' | translate }}"></awsui-radio-button> </awsui-radio-group> </div> <awsui-control-group validation-message="{{ KMSServiceError }}"> <dropdown ng-if="model.selectedOption===aws_kms" items=kmsKeys placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled=KMSServiceError selected-item=options.kmsId filter=true> </dropdown> </awsui-control-group> <awsui-textfield class=custom-kms-arn ng-if="model.selectedOption===aws_kms && options.kmsId.value===custom_arn" ng-model=options.kmsARN></awsui-textfield> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert class=custom-kms-arn-error type=error ng-if="sseError && cardOpen"> {{ sseError }} </awsui-alert> </card-content> <card-footer> <div ng-if=cardOpen> <awsui-button id=objectsse-cancel ng-click=cancel($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=objectsse-save ng-click=save($event) data-disabled=disableSave() text="{{ \'button.save\' | translate }}" loading=isSaving variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l,u,d,p,f){function g(){var e=n.getObjectMetadataCount();if(n.cardSummaryObj.isActive=e>0&&!n.accessRestricted(),e>0?n.cardSummaryObj.activeSummary.text=r.instant("objectdetail.metadata.keyvalue",{count:e}):n.cardSummaryObj.inactiveSummary.text=r.instant("objectdetail.metadata.keyvalue",{count:0}),n.accessRestricted()&&(n.cardSummaryObj.inactiveSummary.text=r.instant("objectproperties.error.metadataresticted")),n.obj.statusCodes){var t=n.obj.statusCodes[u.OPERATION_NAME.GET_OBJECT_METADATA];t&&(n.cardSummaryObj.inactiveSummary.text=t,n.cardSummaryObj.activeSummary.text=t)}}function m(){var e=[];return t.forEach(n.obj.UserDefinedMetadata,function(r,i){var a=t.find(n.predefinedMetadata,{value:i})||{value:i,text:i};e.push({metadataKey:a,metadataValue:{text:r}})}),e}function h(e,r,i){if(!t.isEqual(e,r)&&n.selectedRow.scopeIndex){var a=n.selectedRow.scopeIndex.split(":"),o=a[0],s=a[1];o===i&&r[s]&&e[s]&&r[s].metadataKey&&e[s].metadataKey&&r[s].metadataKey.value!==e[s].metadataKey.value||o===i&&void 0===e[s].metadataKey?n[i][s].metadataValue=null:o===i&&e[s]&&r[s]&&e[s].metadataValue&&r[s].metadataValue&&!t.isEqual(e[s].metadataValue,r[s].metadataValue)&&e[s].metadataValue.text!==r[s].metadataValue.text?n[i][s].metadataValue.inputError=null:o===i&&e[s]&&r[s]&&e[s].metadataKey&&r[s].metadataKey&&!e[s].metadataKey.hasOwnProperty("inputValue")&&e[s].metadataKey.text&&r[s].metadataKey.text&&!t.isEqual(e[s].metadataKey,r[s].metadataKey)&&e[s].metadataKey.text!==r[s].metadataKey.text?n[i][s].metadataKey.error=null:o===i&&e[s]&&r[s]&&e[s].metadataKey&&r[s].metadataKey&&e[s].metadataKey.hasOwnProperty("inputValue")&&!t.isEqual(e[s].metadataKey,r[s].metadataKey)&&e[s].metadataKey.inputValue!==r[s].metadataKey.inputValue&&(n[i][s].metadataKey.error=null)}}function b(e,r){var i=e.split(":"),a=i[0],o=parseInt(i[1]);"newMetadataList"===a?(t.forEach(n.newMetadataList,function(e,t){e.isEditing=t===o}),t.forEach(n.userDefinedMetadata,function(e){e.isEditing=!1})):"userDefinedMetadata"===a&&(t.forEach(n.userDefinedMetadata,function(e,t){e.isEditing=t===o&&r}),t.forEach(n.newMetadataList,function(e){e.isEditing=!1}))}function v(){t.forEach(n.newMetadataList,function(e){e.isEditing=!1}),t.forEach(n.userDefinedMetadata,function(e){e.isEditing=!1})}function E(e,r){n.obj.UserDefinedMetadata=e,n.userDefinedMetadata=r,n.newMetadataList=[],n.cachedConvertedValue=t.cloneDeep(n.userDefinedMetadata),n.cachedValue.UserDefinedMetadata=t.cloneDeep(n.obj.UserDefinedMetadata),n.cachedValue.Metadata=t.cloneDeep(n.obj.Metadata),n.selectedRow={scopeIndex:null},v(),n.cardOpen=!1}function S(){n.metadataError="",n.validationError.text="",n.newMetadataList=[],n.userDefinedMetadata=t.cloneDeep(n.cachedConvertedValue),n.obj.UserDefinedMetadata=t.cloneDeep(n.cachedValue.UserDefinedMetadata),n.obj.Metadata=t.cloneDeep(n.cachedValue.Metadata),n.selectedRow={scopeIndex:null},v(),n.cardOpen=!1}n.scrollCardId="#"+n.id,n.docLink=i.getDocUrl(u.LEARN_MORE_LINKS.METADATA),n.newMetadataList=[],n.revokeAll=!1,n.validationError={text:null},n.selectedRow={scopeIndex:null},n.cardSummaryObj=t.cloneDeep(u.CARD_SUMMARY_INIT),n.obj.UserDefinedMetadata={},n.addMetadata=function(e){n.newMetadataList.splice(0,0,{metadataKey:null,metadataValue:null}),b("newMetadataList:0"),e.scopeIndex="newMetadataList:0"},n.accessRestricted=function(){return t.get(n,"obj.Encryption")===u.OBJECT_SSE.SSEC},n.getMetadata=function(){var r=l.getCurrentBucket(),i=l.getCurrentObject(),a=e[u.VERSION_ID_PARAM];n.cardSummaryObj.isLoading=!0;var s=new o(u.OPERATION_NAME.GET_METADATA);d.getMetadata(r,i,a,s).then(function(e){p.log("getObjectMetadataCWS",s,1,{bucket:r,key:i});var a=t.get(e,"data.metadata");if(a){n.obj.Metadata=a;var o=t.pick(n.obj.Metadata,function(e,t){return u.USER_DEFINED_METADATA.indexOf(t)>-1||0===t.indexOf(u.USER_DEFINED_METADATA_PREFIX)});n.obj.UserDefinedMetadata=t.merge(o,n.obj.UserDefinedMetadata),n.cachedValue=t.cloneDeep(n.obj)}}).catch(function(e){p.log("getObjectMetadataCWS",s,0,{bucket:r,key:i}),n.objectPropertiesError=f.handleErrors(e)}).finally(function(){n.cardSummaryObj.isLoading=!1,g()})},n.getMetadata(),n.predefinedMetadata=s.getPredefinedMetadata(),n.getObjectMetadataCount=function(){return n.obj&&n.obj.UserDefinedMetadata?(n.userDefinedMetadata=m(),n.cachedConvertedValue=t.cloneDeep(n.userDefinedMetadata),Object.keys(n.obj.UserDefinedMetadata).length):0},n.$watch("userDefinedMetadata",function(e,r){if(h(e,r,"userDefinedMetadata"),n.validationError.text="",n.userDefinedMetadata){var i=s.checkDuplicatedKey(n.userDefinedMetadata.concat(n.newMetadataList));t.isEmpty(i)||(n.validationError.text=i)}},!0),n.$watch("newMetadataList",function(e,r){if(h(e,r,"newMetadataList"),n.validationError.text="",n.newMetadataList){var i=s.checkDuplicatedKey(n.newMetadataList.concat(n.userDefinedMetadata));t.isEmpty(i)||(n.validationError.text=i)}},!0),n.getIndex=function(e){return t.findIndex(n.userDefinedMetadata,function(n){return t.isEqual(n,e)})},n.isDeleteAndEditDisabled=function(e){return void 0===e||n.revokeAll||null===e.scopeIndex||n.obj&&f.isStorageClassRestorable(n.obj.StorageClass)||e.scopeIndex&&e.scopeIndex.indexOf("newMetadataList")>-1},n.removeNewMetadata=function(e,t,r){if(t.stopPropagation(),r&&r.scopeIndex){var i=r.scopeIndex.split(":"),a=i[0],o=parseInt(i[1]);"newMetadataList"===a&&o===e&&(r.scopeIndex=null),"newMetadataList"===a&&e<o&&(o-=1,r.scopeIndex=a+":"+o)}n.newMetadataList.splice(e,1)},n.switchSelectedRow=function(e){b(e.scopeIndex,!1)},n.editMetadata=function(e){b(e.scopeIndex,!0)},n.deleteMetadata=function(e){var r=e.scopeIndex.split(":");"userDefinedMetadata"===r[0]&&n.userDefinedMetadata.splice(r[1],1),e.scopeIndex=null,t.isEmpty(n.userDefinedMetadata)&&(n.revokeAll=!0)},n.cachedConvertedValue=t.cloneDeep(n.userDefinedMetadata),n.cachedValue=t.cloneDeep(n.obj),n.cancel=function(e){f.analyticsTrackClick(u.ANALYTICS.CANCEL_OBJECT_METADATA,u.ANALYTICS.DETAILS),e.stopPropagation(),S(),g()},n.save=function(e){if(e.stopPropagation(),!(n.obj&&(f.isStorageClassRestorable(n.obj.StorageClass)||n.obj.IsLatest&&"true"!==n.obj.IsLatest)||n.validationError.text)){f.analyticsTrackClick(u.ANALYTICS.SAVE_OBJECT_METADATA,u.ANALYTICS.DETAILS),n.isSaving=!0,n.metadataError="",n.validationError.text="";var r=n.userDefinedMetadata?n.userDefinedMetadata.concat(n.newMetadataList):n.newMetadataList;if(!t.isEmpty(r)){if(!s.isValid(r,n.validationError))return void(n.isSaving=!1);var i=s.getMetadataMap(r);if(t.isEqual(i,n.obj.UserDefinedMetadata))return n.isSaving=!1,void S();var o=[n.obj],l=s.getMetadataRequestParams(n.obj.UserDefinedMetadata,i,1),d=a.createBulkOperation(u.OPERATION_NAME.CHANGE_METADATA,o,[],1,l);d.totalSizeInBytes=o[0].Size,c.addOperation(d),p.log("ChangeMetadataRequestReceived",1,d),d.defer.promise.then(function(e){var t=Object.keys(e);t.length>0?(n.metadataError=t[0],p.log("ChangeMetadataRequestComplete",0,d)):(E(i,r),p.log("ChangeMetadataRequestComplete",1,d)),g()}).catch(function(e){p.log("ChangeMetadataRequestComplete",0,d),n.metadataError=e}).finally(function(){n.isSaving=!1})}}}}e.module("s3").directive("objectMetadata",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},template:n(706),controller:"ObjectMetadataController"}}]),e.module("s3").controller("ObjectMetadataController",["$routeParams","$scope","$translate","AwsUrlsService","BulkOperationService","ConsoleOperation","ObjectPropertiesService","OperationDispatcherService","PathService","S3Constants","S3CWSAPIService","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-id=scrollCardId card-summary-obj=cardSummaryObj disable-expand=accessRestricted() is-open=cardOpen ng-class="{ \'card-disable-metadata-water-mark\': !cardOpen, \'card-enable-metadata-water-mark\': cardOpen }"> <card-header> <span translate=objectproperties.label.metadata></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancel($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=objectdetail.metadata.blurb></p> <div ng-if=cardOpen> <awsui-button id=objectmetadata-addnew data-disabled="obj && (obj.StorageClass === \'GLACIER\' || obj.StorageClass === \'DEEP_ARCHIVE\' || obj.IsLatest && obj.IsLatest !== \'true\')" text="{{\'objectdetail.metadata.addnew\' | translate}}" icon=plus variant=link click=addMetadata(selectedRow)></awsui-button> <awsui-button id=objectmetadata-delete data-disabled=isDeleteAndEditDisabled(selectedRow) text="{{\'events.button.delete\' | translate}}" variant=link click=deleteMetadata(selectedRow) loading=isDeleting> </awsui-button> <awsui-button id=objectmetadata-edit data-disabled=isDeleteAndEditDisabled(selectedRow) text="{{ \'events.button.edit\' | translate }}" variant=link click=editMetadata(selectedRow)> </awsui-button> <awsui-tooltip text="{{\'objectproperties.metadata.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-radio-group ng-model=selectedRow.scopeIndex ng-change=switchSelectedRow(selectedRow)> <table class="table-condense metadata-table"> <thead> <tr> <td class=metadata-table-tds></td> <td class=metadata-table-tds translate>objectdetail.metadata.key</td> <td class=metadata-table-tds translate>objectdetail.metadata.value</td> </tr> </thead> <tbody> <tr class=newmetadatarow ng-repeat-start="newMetadata in newMetadataList"> <td class=metadata-table-tds> <awsui-radio-button value=newMetadataList:{{$index}}> <td class=metadata-table-tds translate>objectdetail.metadata.newmetadata</td> <td class=metadata-table-tds> <span class="newmetadata-delete close-icon" ng-click="removeNewMetadata($index, $event, selectedRow)"></span> </td> </awsui-radio-button> </td> </tr> <tr ng-repeat-end> <td class=metadata-table-tds></td> <td class="newMetadata-dropdown metadata-table-tds"> <awsui-control-group validation-message="{{ newMetadata.metadataKey.error }}"> <dropdown disabled=!newMetadata.isEditing items=predefinedMetadata selected-item=newMetadata.metadataKey filter=true placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown> </awsui-control-group> </td> <td class=metadata-value-input> <dropdown disabled=!newMetadata.isEditing ng-if="newMetadata.metadataKey.dropDownValue && newMetadata.metadataKey.dropDownValue.length > 2" items=newMetadata.metadataKey.dropDownValue enable-input=true selected-item=newMetadata.metadataValue filter=true input-field=newMetadata.metadataValue placeholder="{{\'objectdetail.metadata.value-placeholder\' | translate}}"> </dropdown> <dropdown disabled=!newMetadata.isEditing ng-if="newMetadata.metadataKey.dropDownValue && newMetadata.metadataKey.dropDownValue.length <= 2" items=newMetadata.metadataKey.dropDownValue enable-input=true selected-item=newMetadata.metadataValue input-field=newMetadata.metadataValue placeholder="{{\'objectdetail.metadata.value-placeholder\' | translate}}"> </dropdown> <awsui-control-group id=metadata-input-error validation-message="{{  newMetadata.metadataValue.inputError }}"> <awsui-textfield data-disabled=!newMetadata.isEditing ng-model=newMetadata.metadataValue.text ng-if="newMetadata.metadataKey && !newMetadata.metadataKey.dropDownValue"></awsui-textfield> </awsui-control-group> </td> </tr> <tr class=metadatarow ng-repeat="metadata in userDefinedMetadata | orderBy: \'metadataKey.text\' "> <td class=metadata-table-tds> <awsui-radio-button value=userDefinedMetadata:{{getIndex(metadata)}}> <td class=metadata-table-tds> <div class=metatext ng-if=!metadata.isEditing>{{ metadata.metadataKey.inputValue || metadata.metadataKey.text }}</div> <awsui-control-group validation-message="{{ metadata.metadataKey.error }}"> <dropdown ng-if=metadata.isEditing items=predefinedMetadata selected-item=metadata.metadataKey filter=true placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown> </awsui-control-group> </td> <td class=metadata-value-input> <div class=metatext ng-if=!metadata.isEditing>{{ metadata.metadataValue.text }}</div> <dropdown ng-if="metadata.isEditing && metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length > 2" items=metadata.metadataKey.dropDownValue selected-item=metadata.metadataValue enable-input=true filter=true input-field=metadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"></dropdown> <dropdown ng-if="metadata.isEditing && metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length <= 2" items=metadata.metadataKey.dropDownValue selected-item=metadata.metadataValue enable-input=true input-field=metadata.metadataValue placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"></dropdown> <awsui-control-group validation-message="{{ metadata.metadataValue.inputError }}"> <awsui-textfield ng-model=metadata.metadataValue.text ng-if="metadata.isEditing && metadata.metadataKey && !metadata.metadataKey.dropDownValue"></awsui-textfield> </awsui-control-group> </td> </awsui-radio-button></td></tr> </tbody> </table> </awsui-radio-group> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert class=input-error type=error header="{{ \'error.header\' | translate }}" ng-if="validationError && validationError.text && cardOpen"> <p translate=objectdetail.metadata.multisamekeywarning translate-values="{ errorMsg : \'{{validationError.text}}\' }"></p> </awsui-alert> <awsui-alert class=input-error type=error header="{{ \'error.header\' | translate }}" ng-if="metadataError && cardOpen">{{ metadataError }}</awsui-alert> </card-content> <card-footer> <div ng-if=cardOpen> <awsui-button id=objectmetadata-cancel ng-click=cancel($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=objectmetadata-save ng-click=save($event) data-disabled="obj && (obj.StorageClass === \'GLACIER\' || obj.StorageClass === \'DEEP_ARCHIVE\' || obj.IsLatest && obj.IsLatest !== \'true\') || validationError.text" text="{{ \'button.save\' | translate }}" loading=isSaving variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u,d,p){function f(){n.cardSummaryObj.isActive=n.tagCount>0,n.cardSummaryObj.activeSummary.text=r.instant("objectproperties.tags.keyvalue",{count:n.tagCount})}n.docLink=a.getDocUrl(l.LEARN_MORE_LINKS.OBJECT_TAGGING),n.scrollCardId="#"+n.id,n.tagError=!1,n.tagErrorMessage="",n.cachedObjectTags={tags:[]},n.tagCount=0,n.maxAllowedTags=l.TAGGING.MAX_ALLOWED_TAGS,n.cardSummaryObj=t.cloneDeep(l.CARD_SUMMARY_INIT),n.cardSummaryObj.inactiveSummary.text=r.instant("objectproperties.tags.keyvalue",{count:0}),f(),n.cancelObjectTagging=function(t){d.analyticsTrackClick(l.ANALYTICS.CANCEL_OBJECT_TAGS,l.ANALYTICS.DETAILS),t.stopPropagation(),n.obj.Tagging=e.copy(n.cachedObjectTags.tags),n.tagError=!1,n.tagErrorMessage="",n.cardOpen=!1},n.removeTag=function(e){n.obj.Tagging.splice(e,1)},n.addTag=function(){n.obj.Tagging||(n.obj.Tagging=[]),n.obj.Tagging.length<l.TAGGING.MAX_ALLOWED_TAGS&&n.obj.Tagging.push({Key:"",Value:""})},n.$watch("obj.VersionId",function(e,t){e!==t&&n.getObjectTags()}),n.isAnyKeyEmpty=function(){return!t.isEmpty(n.obj.Tagging)&&t.some(n.obj.Tagging,function(e){return t.isEmpty(e.Key)})},n.getObjectTags=function(){var r=new o(l.OPERATION_NAME.GET_OBJECT_TAGGING),a=c.getCurrentObject(),s=c.getCurrentBucket();u.log("getObjectTagsReceived",1,r,{objectName:a}),n.obj.Tagging=[];var d=n.obj.VersionId;n.cardSummaryObj.isLoading=!0,i.getObjectTag(r,s,a,d).then(function(i){var o=i.response;if(d?u.log("getObjectVersionTags",1,r,{objectName:a,versionId:d}):u.log("getObjectTags",1,r,{objectName:a}),n.tagError=!1,o){var s=p.convertXmlStringToJson(o);if(s.Tagging.TagSet.Tag){var c=[].concat(s.Tagging.TagSet.Tag);e.forEach(c,function(e){t.isEmpty(e.Value)&&(e.Value=""),e.errorMessage=""}),n.obj.Tagging=c,n.tagCount=c.length||0}else n.tagCount=0}n.cachedObjectTags.tags=e.copy(n.obj.Tagging),f()}).catch(function(t){t&&t.status===l.HTTP_STATUS_CODES.NOT_FOUND&&t.response.Error.Code===l.TAGGING.ERROR_CODES.NO_SUCH_TAG_SET&&(d?u.log("getObjectVersionTags",0,r,{objectName:a,versionId:d,error:t}):u.log("getObjectTags",0,r,{objectName:a,error:t}),n.tagCount=0,n.obj.Tagging=[]),n.cachedObjectTags.tags=e.copy(n.obj.Tagging)}).finally(function(){n.cardSummaryObj.isLoading=!1})},n.getObjectTags(),n.saveObjectTagging=function(i){d.analyticsTrackClick(l.ANALYTICS.SAVE_OBJECT_TAGS,l.ANALYTICS.DETAILS),i.stopPropagation(),n.tagError=!1,n.tagErrorMessage="";var a=n.obj.Tagging,g=new o(l.OPERATION_NAME.PUT_OBJECT_TAGGING),m=c.getCurrentObject(),h=n.obj.VersionId;u.log("putObjectTagsReceived",1,g,{objectName:m}),a&&e.forEach(a,function(e){t.isEmpty(e.Key)?(e.errorMessage=r.instant("objectproperties.tags.emptykeyname"),n.tagError=!0):e.errorMessage=""}),n.tagError||s.putObjectTagging(m,h,a,g).then(function(r){h?u.log("putObjectVersionTags",1,g,{objectName:m,versionId:h}):u.log("putObjectTags",1,g,{objectName:m});var i,a=p.convertXmlStringToJson(r.request.contentString);t.isEmpty(a.Tagging.TagSet.Tag)||(i=[].concat(a.Tagging.TagSet.Tag),e.forEach(i,function(e){t.isEmpty(e.Value)&&(e.Value="")})),n.obj.Tagging=t.isEmpty(i)?[]:[].concat(i),n.tagCount=n.obj.Tagging.length,n.cachedObjectTags.tags=e.copy(n.obj.Tagging),n.cardOpen=!1,f()}).catch(function(e){h?u.log("putObjectTags",0,g,{objectName:m,error:e,versionId:h}):u.log("putObjectTags",0,g,{objectName:m,error:e}),n.tagError=!0,n.tagErrorMessage=e?d.handleErrors(e):r.instant("objectproperties.tags.genericerror")})}}e.module("s3").directive("objectTagCard",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},template:n(708),controller:"ObjectTagCardController"}}]),e.module("s3").controller("ObjectTagCardController",["$scope","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","ObjectPropertiesService","PathService","S3Constants","SCLogService","UtilService","XMLParser",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-id=scrollCardId card-summary-obj=cardSummaryObj is-open=cardOpen ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }"> <card-header> <span translate=objectproperties.tags.label></span> <div class=card-close-icon ng-show=cardOpen ng-click=cancelObjectTagging($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=objectproperties.tags.summary></p> <table class=tagging-table ng-if=cardOpen> <thead> <tr> <td class=tagging-table-tds></td> <td class=tagging-table-tds translate=objectproperties.tags.key></td> <td class=tagging-table-tds translate=objectproperties.tags.value></td> </tr> </thead> <tbody> <tr ng-repeat="tag in obj.Tagging"> <td class=tagging-table-tds> <awsui-control-group validation-message={{tag.errorMessage}}> <awsui-textfield class=tag-input ng-model=tag.Key></awsui-textfield> </awsui-control-group> </td> <td class=tagging-table-tds> <awsui-control-group> <awsui-textfield class=tag-input ng-model=tag.Value></awsui-textfield> </awsui-control-group> </td> <td class=tagging-table-tds><a href class=remove-tag ng-click=removeTag($index)>X</a></td> </tr> </tbody> </table> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-button id=add-object-tag ng-click=addTag() ng-show=cardOpen data-disabled="obj.Tagging.length >= maxAllowedTags || isAnyKeyEmpty()" icon=plus class=object-properties-button text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button> <awsui-alert class=tag-error type=error ng-show="tagError && tagErrorMessage !== \'\' && cardOpen">{{tagErrorMessage}}</awsui-alert> <awsui-alert class=objecttag-replication-warning ng-if=cardOpen dismissible=false type=warning fac-id=s3-crr><p translate=replicationcard.warningmsg></p></awsui-alert> </card-content> <card-footer> <div class=object-properties-buttons ng-if=cardOpen> <awsui-button id=objecttag-cancel ng-click=cancelObjectTagging($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=objecttag-save ng-click=saveObjectTagging($event) text="{{ \'button.save\' | translate }}" variant=primary></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l,u,d,p,f,g){function m(){var t=c.getCurrentBucket(),r=c.getCurrentObject(),i=N.obj.VersionId,a=[];return S()&&function(){T();var o=N.retention.legalHold===N.STATE.ENABLED;a.push(f.putObjectLegalHold(L,t,{objectKey:r,versionId:i},o).then(function(){var t=o?"objectproperties.retention.alert.legalholdenabled.text":"objectproperties.retention.alert.legalholddisabled.text";N.displayAlert({header:e.instant(t),type:"success"}),N.retentionInitial.legalHold=N.retention.legalHold}).catch(function(t){return t.code===l.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.ACCESS_DENIED?N.displayAlert({header:e.instant("bucketproperties.objectretention.alert.nopermissionstoedit.text"),type:"error"}):N.displayAlert({header:e.instant(t.text),type:"error"}),n.reject()}).finally(function(){R()}))}(),E()&&function(){T();var o=N.retention.mode===N.MODE_NONE,s=o?void 0:N.retention.mode,c=o?void 0:new Date(O(N.retention.retainUntilDate));a.push(f.putObjectRetention(L,t,{objectKey:r,versionId:i},s,c).then(function(){var t=o?"objectproperties.retention.alert.retentiondisabled.text":"objectproperties.retention.alert.retentionenabled.text";N.displayAlert({header:e.instant(t),type:"success"}),N.retentionInitial.mode=N.retention.mode,N.retentionInitial.retainUntilDate=N.retention.retainUntilDate,N.complianceModeIsActive=k()}).catch(function(t){return t.code===l.BUCKET_PROPERTIES.OBJECT_RETENTION.ERROR_CODE.ACCESS_DENIED?N.displayAlert({header:e.instant("bucketproperties.objectretention.alert.nopermissionstoedit.text"),type:"error"}):N.displayAlert({header:e.instant(t.text),type:"error"}),n.reject()}).finally(function(){R()}))}(),n.all(a).then(function(){N.cardOpen=!1}).catch(function(){}).finally(function(){v(),N.cardSummaryObj.isActive=C()})}function h(){var t=N.retention.retainUntilDate,n=null;N.dateValidationError.flag=!1,N.retention.mode!==N.MODE_NONE&&E()&&(!t||/^ *$/.test(t)?n="objectproperties.retention.card.dateinput.error.empty":!/\d\d\d\d-\d\d-\d\d/.test(t)||isNaN(O(t))?n=e.instant("objectproperties.retention.card.dateinput.error.format",{dateExample:"2018-12-31"}):N.retentionInitial.mode===N.MODE_COMP&&N.retentionInitial.retainUntilDate&&O(N.retentionInitial.retainUntilDate)>O(t)?n="objectproperties.retention.card.dateinput.datemustbelaterthan":Date.now()>=O(t)&&(n="objectproperties.retention.card.dateinput.error.future"),n&&(N.dateValidationError.flag=!0,N.dateValidationError.text=n))}function b(){var e=new Date;return e.setDate(e.getDate()+1),e}function v(){N.saveButtonDisabled=N.dateValidationError.flag||!(E()||S())}function E(){var e=N.retention,t=N.retentionInitial;return e.mode!==t.mode||e.retainUntilDate!==t.retainUntilDate}function S(){var e=N.retention,t=N.retentionInitial;return e.legalHold!==t.legalHold}function y(e){var t=new Date(O(N.retention.retainUntilDate));t.setDate(t.getDate()+e),N.retention.retainUntilDate=P(t),N.formUpdate()}function A(){N.retention=t.cloneDeep(N.retentionInitial),N.cardSummaryObj.isActive=C()}function C(){var e=N.retentionInitial.mode!==N.MODE_NONE&&O(N.retentionInitial.retainUntilDate)>Date.now(),t=N.retentionInitial.legalHold===N.STATE.ENABLED;return N.retentionInitial.enabledOnBucketLevel&&(e||t)}function _(){var e=c.getCurrentBucket(),t=c.getCurrentObject(),n=N.obj.VersionId;return T(),f.getObjectRetention(L,e,{objectKey:t,versionId:n}).then(function(e){var t=e.mode,n=e.retainUntilDate;N.retentionInitial.mode=t||N.MODE_NONE,N.retentionInitial.retainUntilDate=P(n)||P(b()),N.complianceModeIsActive=k(),A()}).finally(function(){R()})}function w(){var e=c.getCurrentBucket(),t=c.getCurrentObject(),n=N.obj.VersionId;return T(),f.getObjectLegalHold(L,e,{objectKey:t,versionId:n}).then(function(e){N.retentionInitial.legalHold=e?N.STATE.ENABLED:N.STATE.DISABLED,A()}).finally(function(){R()})}function T(){M+=1,N.cardSummaryObj.isLoading=M>0}function R(){M=Math.max(0,M-1),N.cardSummaryObj.isLoading=M>0}function O(e){var t=(e||"").match(/^(\d\d\d\d)-(\d\d)-(\d\d)$/);if(!t)return NaN;var n=Number(t[1]),r=Number(t[2]),i=Number(t[3]),a=new Date(n,r-1,i);return a.getFullYear()!==n||a.getMonth()!==r-1||a.getDate()!==i?NaN:a.getTime()}function k(){var e=N.retentionInitial,t=e.retainUntilDate,n=e.mode,r=O(t);return n===N.MODE_COMP&&Date.now()<r}function I(){return O(P(new Date))}function P(e){if(!e)return"";try{var t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0");return e.getFullYear()+"-"+n+"-"+t}catch(e){return""}}var N=this,M=0,L=new o("ObjectRetention","getObjectRetention");N.STATE={ENABLED:"Enabled",DISABLED:"Disabled"},N.dateValidationError={flag:!1,text:""},N.cardError={visible:!1,text:""},N.saveButtonDisabled=!0,N.MODE_NONE=l.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.NONE,N.MODE_COMP=l.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.COMPLIANCE,N.retentionModeList=[{value:l.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.GOVERNANCE,title:"objectproperties.retention.card.radio.mode.gov.label",text:"objectproperties.retention.card.radio.mode.gov.text"},{value:l.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.COMPLIANCE,title:"objectproperties.retention.card.radio.mode.comp.label",text:"objectproperties.retention.card.radio.mode.comp.text"},{value:l.BUCKET_PROPERTIES.OBJECT_RETENTION.MODE.NONE,title:"objectproperties.retention.card.radio.mode.none.label"}],N.docLink=a.getDocUrl(l.LEARN_MORE_LINKS.OBJECT_RETENTION),N.customerSupportLink=a.getMarketingUrl(l.CUSTOMER_SUPPORT),N.scrollCardId="#"+N.id,N.retention={},N.confirmComplianceModal={title:e.instant("bucketproperties.objectretention.confirmcompliance.modaltitle"),label:"bucketproperties.objectretention.confirmcompliance.input.label"},N.confirmComplianceAlert={title:"",text:e.instant("objectproperties.retention.confirmcompliance.alert.text")},N.retentionInitial={enabledOnBucketLevel:!1,mode:N.retentionModeList[0].value,retainUntilDate:"",legalHold:N.STATE.DISABLED},N.confirmationModalOpen={flag:!1},N.complianceModeIsActive=!1,N.cardOpen=!1,N.cardSummaryObj=t.cloneDeep(l.CARD_SUMMARY_INIT),N.cardSummaryObj.inactiveSummary.text=e.instant("objectproperties.retention.card.inactive.summary"),N.cardSummaryObj.activeSummary.text=e.instant("objectproperties.retention.card.active.summary"),A(),g.isFeatureEnabled(l.FAC.OBJECT_RETENTION)&&function(){var e=c.getCurrentBucket();return T(),f.getBucketObjectLockConfiguration(L,e).then(function(e){return e.bucketObjectRetentionEnabled}).catch(function(){return!0}).then(function(e){return N.retentionInitial.enabledOnBucketLevel=e,R(),e})}().then(function(t){if(t)return n.all(w(),_()).catch(function(t){N.cardError.text=e.instant(t.text),N.cardError.visible=!0})}).then(function(){A()}),N.cancel=function(e){e.stopPropagation(),N.cardOpen=!1,A()},N.save=function(t){if(t.stopPropagation(),E()&&N.retention.mode===N.MODE_COMP){var n=O(N.retention.retainUntilDate),i=Math.trunc((n-I())/1e3/60/60/24),a=new Date(n),o=1===i?e.instant("units.time.days.one"):e.instant("units.time.days.many");N.confirmComplianceAlert.title=e.instant("objectproperties.retention.confirmcompliance.alert.title",{days:r("number")(i),untilDate:r("date")(a,"MMMM d, y"),daysString:o}),N.toggleComplianceConfirmationModal(!0)}else m()},N.complianceOnConfirm=function(){N.toggleComplianceConfirmationModal(!1),m()},N.complianceOnCancel=function(){N.toggleComplianceConfirmationModal(!1)},N.toggleComplianceConfirmationModal=function(e){N.confirmationModalOpen={flag:e}},N.formUpdate=function(){h(),v()},N.addDays=function(e){y(e)}}e.module("s3").directive("objectRetentionCard",[function(){return{restrict:"E",scope:{obj:"=",displayAlert:"&",id:"@?"},template:n(710),controllerAs:"vm",bindToController:!0,controller:"ObjectRetentionCardController"}}]),e.module("s3").controller("ObjectRetentionCardController",["$translate","$q","$filter","APIProxyService","AwsUrlsService","ConsoleOperation","ObjectPropertiesService","PathService","S3Constants","SCLogService","UtilService","XMLParser","SharpieAPI","FAC",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-id=vm.scrollCardId card-summary-obj=vm.cardSummaryObj is-open=vm.cardOpen ng-class="{ \'card-disable-shield-water-mark\': !vm.cardOpen, \'card-enable-shield-water-mark\': vm.cardOpen }"> <card-header> <span translate=objectproperties.retention.card.title></span> <div class=card-close-icon ng-show=vm.cardOpen ng-click=vm.cancel($event)></div> </card-header> <card-content> <div ng-if=!vm.cardOpen> <p class=bucketproperties-summary translate=objectproperties.retention.card.summary></p> <a class=learn-more-card-closed-link target=_blank href={{vm.docLink}} translate>learn.more</a> </div> <div ng-if=vm.cardOpen> <awsui-alert ng-if=!vm.retention.enabledOnBucketLevel type=info header="{{ \'objectproperties.retention.card.alert.disabled.title\' | translate }}"> <span translate=objectproperties.retention.card.alert.disabled.text></span> <span> </span> <external-link href={{vm.customerSupportLink}} text="{{ \'customer.support\' | translate | lowercase }}"></external-link> </awsui-alert> <div ng-if=vm.retention.enabledOnBucketLevel> <awsui-alert visible=vm.cardError.visible type=error>{{ vm.cardError.text }}</awsui-alert> <div> <p> <span translate>objectproperties.retention.card.radio.enable.comment</span> <span> </span> <learn-more-link href={{vm.docLink}}></learn-more-link> </p> </div> <h5 translate>objectproperties.retention.card.section.modes.title</h5> <awsui-radio-group ng-model=vm.retention.mode ng-change=vm.formUpdate()> <div class="radio-button-control radio-button-control--small" ng-repeat="mode in vm.retentionModeList"> <awsui-radio-button value="{{ mode.value }}" label="{{ mode.title | translate }}" data-disabled="vm.complianceModeIsActive && mode.value !== vm.MODE_COMP"></awsui-radio-button> <p ng-if="!vm.complianceModeIsActive || mode.value === vm.MODE_COMP" class=radio-button-description translate>{{ mode.text }}</p> <p ng-if="vm.complianceModeIsActive && mode.value !== vm.MODE_COMP" class=radio-button-description translate>objectproperties.retention.card.radio.mode.disabledcomment</p> </div> </awsui-radio-group> <h5 class=mt-4 ng-hide="vm.retention.mode === vm.MODE_NONE" translate>objectproperties.retention.card.section.retainuntildate.title</h5> <awsui-control-group ng-hide="vm.retention.mode === vm.MODE_NONE"> <div dom-region=control> <awsui-textfield autocomplete=off placeholder=YYYY-MM-DD data-disabled="vm.retention.mode === vm.MODE_NONE" data-e2e-id=objectRetentionDateInput ng-model=vm.retention.retainUntilDate ng-change=vm.formUpdate() blur=vm.formUpdate() on-keyboard-scroll=vm.addDays(step)></awsui-textfield> </div> <span dom-region=validationMessage ng-if="vm.dateValidationError.flag && vm.retention.mode !== vm.MODE_NONE"> <label>{{ vm.dateValidationError.text | translate : { date: vm.retentionInitial.retainUntilDate } }}</label><br> </span> </awsui-control-group> <label ng-if=vm.complianceModeIsActive ng-hide="vm.retention.mode === vm.MODE_NONE">{{ \'objectproperties.retention.card.dateinput.datemustbelaterthan\' | translate : { date: vm.retentionInitial.retainUntilDate } }}</label> <h5 class="mt-4 mb-1" translate>objectproperties.retention.card.section.legalhold.title</h5> <p translate>objectproperties.retention.card.section.legalhold.description</p> <awsui-radio-group class="radio-button-control radio-button-control--small" ng-model=vm.retention.legalHold ng-change=vm.formUpdate()> <awsui-radio-button value="{{ vm.STATE.ENABLED }}" label="{{ \'objectproperties.retention.card.radio.legalhold.enable.label\' | translate }}"></awsui-radio-button> <awsui-radio-button value="{{ vm.STATE.DISABLED }}" label="{{ \'objectproperties.retention.card.radio.legalhold.disable.label\' | translate }}"></awsui-radio-button> </awsui-radio-group> </div> </div> </card-content> <card-footer> <div ng-if=vm.cardOpen> <div class=object-properties-buttons ng-if=vm.retention.enabledOnBucketLevel> <awsui-button id=retention-cancel ng-click=vm.cancel($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=retention-save ng-click=vm.save($event) text="{{ \'button.save\' | translate }}" variant=primary data-disabled=vm.saveButtonDisabled loading=vm.cardSummaryObj.isLoading></awsui-button> </div> <div class=object-properties-buttons ng-if=!vm.retention.enabledOnBucketLevel> <awsui-button id=retention-cancel ng-click=vm.cancel($event) text="{{ \'button.close\' | translate }}"></awsui-button> </div> </div> </card-footer> </card> <retention-confirmation-modal modal-title=vm.confirmComplianceModal.title confirm-label=vm.confirmComplianceModal.label is-open=vm.confirmationModalOpen on-cancel=vm.complianceOnCancel() on-confirm=vm.complianceOnConfirm() alert=vm.confirmComplianceAlert> </retention-confirmation-modal>'},function(e,t,n){"use strict";(function(e){function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").directive("dialogModal",function(){return{restrict:"E",template:n(712),scope:{isOpen:"=",closeCallback:"&?",headerTitle:"=",hasWarningMsg:"=?",countInfo:"=?",isCounting:"=?",pasteInfo:"=?",sourceDstInfo:"=?"},transclude:{header:"?dialogModalHeader",content:"dialogModalContent",footer:"dialogModalFooter"},controller:"DialogModalController"}}),e.module("s3").controller("DialogModalController",["$scope","PathService","$filter","$translate","UtilService","humanReadableBytesFilter",function(e,n,r,i,a,o){var s,c=(s={},t(s,i.instant("confirmationmodal.delete.title"),"dialog-delete-image"),t(s,i.instant("confirmationmodal.deletebucketpolicy.corsconfigtitle"),"dialog-delete-image"),t(s,i.instant("confirmationmodal.deletebucketpolicy.bucketpolicytitle"),"dialog-delete-image"),t(s,i.instant("confirmationmodal.storageclass.title"),"dialog-storage-image"),t(s,i.instant("confirmationmodal.public.title"),"dialog-public-image"),t(s,i.instant("confirmationmodal.deletebucket.title"),"dialog-delete-image"),t(s,i.instant("confirmationmodal.emptybucket.title"),"dialog-delete-image"),t(s,i.instant("initiaterestoremodal.header.title.glacier"),"dialog-public-image"),t(s,i.instant("crr.warningmsg.title.notenabled"),"crr-watermark-image"),t(s,i.instant("crr.warningmsg.title.accessdenied"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.enablerule"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.disablerule"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.enableallrules"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.disableallrules"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.deleteallrules"),"crr-watermark-image"),t(s,i.instant("crr.confirmationmodal.deleteruletitle"),"crr-watermark-image"),t(s,i.instant("crr.receiveobjectmodal.title"),"crr-watermark-image"),s);e.getClass=function(){return c[e.headerTitle]},e.closeModal=function(){e.isOpen.flag=!1,e.closeCallback&&e.closeCallback(),a.bodyFreezeScroll(e.isOpen&&e.isOpen.flag)},e.dstFolderPath=n.getCurrentAbsoluteFolderPath()||n.getCurrentBucket(),e.getSizeCount=function(){return e.isCounting?i.instant("confirmationmodal.filelist.calculating"):o(e.countInfo.size)},e.getObjectsCount=function(){return e.isCounting?i.instant("confirmationmodal.filelist.calculating"):e.countInfo.objects}}])}()}).call(t,n(0))},function(e,t){e.exports='<div class=aws-modal id=confirmation-modal> <div ng-show=isOpen.flag class="modal-frame fade in ng-hide"> <div class=modal-header ng-class=getClass()> <i class="panel-close-icon modal-close" ng-click=closeModal()></i> <div class=modal-header-title>{{headerTitle}}</div> <div class=modal-header-divider></div> <div class=modal-header-content ng-transclude=header></div> </div> <div ng-if=countInfo.flag class=confirmation-info-subheader> <div class=dialog-info-div> <span class=countinfo-selection translate=confirmationmodal.countinfo.selection></span> <span data-e2e-id=confirmation-modal-object-count translate=confirmationmodal.countinfo.objects translate-values="{ objectCount : {{countInfo.currLevelObjs}} }"></span>, <span data-e2e-id=confirmation-modal-folder-count translate=confirmationmodal.countinfo.folders translate-values="{ folderCount : {{countInfo.folders}} }"></span> <span class=countinfo-totalsize translate=confirmationmodal.countinfo.totalsize></span> <awsui-tooltip ng-if=countInfo.sizeDataMissing text="{{\'confirmationmodal.info.sizedatamissing\' | translate}}" position=bottom size=small> <span> {{ getSizeCount() }} <span>*</span> </span> </awsui-tooltip> <span ng-if=!countInfo.sizeDataMissing> {{ getSizeCount() }} </span> <span class=countinfo-totalobjects translate=confirmationmodal.countinfo.totalobjects></span> <span data-e2e-id=confirmation-modal-total-object-count>{{ getObjectsCount() }}</span> </div> </div> <div ng-if=sourceDstInfo.flag class=paste-subheader-info> <table> <tr> <td> <translate class=confirmation-label>confirmationmodal.source</translate> <span>{{sourceDstInfo.source}}</span> </td> <td> <translate class=confirmation-label>confirmationmodal.dst</translate> <span>{{dstFolderPath}}</span> </td> </tr> </table> </div> <div class=modal-body ng-transclude=content ng-class="{\n                           \'modal-body-height-with-warning\': hasWarningMsg.flag && !sourceDstInfo.flag,\n                           \'modal-body-height-without-warning\': !hasWarningMsg.flag,\n                           \'modal-body-height-with-warning-and-source-dst-info\': hasWarningMsg.flag && sourceDstInfo.flag\n                       }"> </div> <div class=modal-footer> <div class=confirmation-banner> <div class=footer-divider></div> <awsui-alert ng-if=hasWarningMsg.flag type=warning dismissible=false> <p translate={{hasWarningMsg.text}} translate-values="{val: \'{{hasWarningMsg.val}}\' }"></p> </awsui-alert> </div> <div ng-transclude=footer></div> </div> </div> <div ng-show=isOpen.flag class="modal-background ng-hide"></div> </div> '},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){e.module("s3").directive("confirmationDialogModal",function(){return{restrict:"E",scope:{isOpen:"=",operation:"=?",countInfo:"=?",objectMetadata:"=?"},template:n(714),controller:"ConfirmationDialogModalController"}}),e.module("s3").controller("ConfirmationDialogModalController",["$scope","$filter","$translate","$routeParams","BulkOperationService","OperationDispatcherService","S3Constants","CopyService","KeySelectionService","CountService","ObjectPropertiesService","UtilService","SCLogService",function(n,i,a,o,s,c,l,u,d,p,f,g,m){var h;n.showVersions=g.convertStringToBoolean(o[l.SHOW_VERSION_PARAM]);var b={STANDARD:a.instant("replication.storageclasses.standard"),STANDARD_IA:a.instant("replication.storageclasses.standardia")},v=(h={},r(h,l.OPERATION_NAME.DELETE_OBJECTS,{headTitle:a.instant("confirmationmodal.delete.title"),buttonName:a.instant("confirmationmodal.delete.buttonname"),warningInfo:{flag:!0,text:n.showVersions?"confirmationmodal.permanentdelete.warningtext":"confirmationmodal.delete.warningtext"}}),r(h,l.OPERATION_NAME.RESTORE_OBJECTS,{headTitle:a.instant("confirmationmodal.undodelete.text"),buttonName:a.instant("confirmationmodal.undodelete.text"),warningInfo:{flag:!0,text:"confirmationmodal.undodelete.warningtext"}}),r(h,l.OPERATION_NAME.MAKE_PUBLIC,{headTitle:a.instant("confirmationmodal.public.title"),buttonName:a.instant("confirmationmodal.public.buttonname"),warningInfo:{flag:!0,text:"object.warningbody.granting.AllUsers"}}),r(h,l.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:a.instant("confirmationmodal.storageclass.title"),buttonName:a.instant("confirmationmodal.storageclass.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.changestorageclass.warningtext",val:n.operation.panelSettingValues?b[n.operation.panelSettingValues.setting]:""}}),r(h,l.OPERATION_NAME.CHANGE_SSE,{headTitle:a.instant("confirmationmodal.sse.title"),buttonName:a.instant("confirmationmodal.sse.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.sse.warningtext"}}),r(h,l.OPERATION_NAME.CHANGE_METADATA,{headTitle:a.instant("confirmationmodal.metadata.title"),buttonName:a.instant("confirmationmodal.metadata.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.metadata.warningtext"}}),r(h,l.OPERATION_NAME.CUT,{headTitle:a.instant("confirmationmodal.cutpaste.title"),buttonName:a.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.paste.warningtext"}}),r(h,l.OPERATION_NAME.COPY,{headTitle:a.instant("confirmationmodal.copypaste.title"),buttonName:a.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.paste.warningtext"}}),r(h,l.OPERATION_NAME.INITIATE_RESTORE,{headTitle:a.instant("initiaterestoremodal.header.title.glacier"),buttonName:a.instant("confirmationmodal.initiaterestore.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.initialrestore.warningtext"}}),r(h,l.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:a.instant("confirmationmodal.addtags.title"),buttonName:a.instant("confirmationmodal.addtags.buttonname"),warningInfo:{flag:!0,text:"confirmationmodal.addtags.warningtext",val:n.operation.panelSettingValues&&n.operation.panelSettingValues.values?n.operation.panelSettingValues.values.length:0}}),r(h,l.OPERATION_NAME.GET_INFO,{headTitle:a.instant("confirmationmodal.getinfo.title"),buttonName:a.instant("confirmationmodal.getinfo.buttonname"),warningInfo:{flag:!1}}),h),E={flag:!0,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};n.closeIconShow=!1,n.selected={selectedItems:{currFolderPathPrefix:n.operation.initialPath,folders:n.operation.selectedFolders,objects:n.operation.selectedKeys}},n.countInfo&&n.countInfo.countFinish?e.forEach(n.selected.selectedItems.folders,function(e){n.countInfo.countResultEachFolder&&n.countInfo.countResultEachFolder[e.Prefix]&&(e.objsCount=n.countInfo.countResultEachFolder[e.Prefix].count,e.folderSize=n.countInfo.countResultEachFolder[e.Prefix].totalSize)}):(n.countInfo=t.cloneDeep(E),n.isCounting={flag:!1},n.$watch(function(){return n.countInfo},function(t,r){t!==r&&e.forEach(n.selected.selectedItems.folders,function(e){n.countInfo.countResultEachFolder&&n.countInfo.countResultEachFolder[e.Prefix]&&(e.objsCount=n.countInfo.countResultEachFolder[e.Prefix].count,e.folderSize=n.countInfo.countResultEachFolder[e.Prefix].totalSize)})},!0),p.countAllFiles(n.selected.selectedItems,n.countInfo,n.operation,n.isCounting)),n.modalInfo=v[n.operation.name];var S=n.operation.name===l.OPERATION_NAME.CUT||n.operation.name===l.OPERATION_NAME.COPY;n.sourceDstInfo={flag:S,source:n.operation.initialPath||n.operation.initialBucket},n.closeConfirmationModal=function(){n.isOpen.flag=!1,n.isOpen.dialogOpen.flag=!1,n.isOpen.sidePanelOpen=!1,n.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}},n.countInfo=t.cloneDeep(E),n.countInfo.flag=!1,n.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:!1,text:""}},n.operation=null,n.panelSettingValues=null},n.operationFunc=function(){if(n.operation.name===l.OPERATION_NAME.CHANGE_STORAGE_CLASS)n.operation.additionalInfo={targetStorageClass:n.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:l.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API};else if(n.operation.name===l.OPERATION_NAME.CHANGE_METADATA){var e=f.getMetadataMap(n.operation.panelSettingValues.values);if(t.isEqual(e,n.objectMetadata))return void n.closeConfirmationModal();n.operation.additionalInfo=f.getMetadataRequestParams(n.objectMetadata,e,l.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API)}else if(n.operation.name===l.OPERATION_NAME.CHANGE_SSE)n.operation.additionalInfo={sseAlgo:n.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:l.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API},n.operation.additionalInfo.sseAlgo===l.OBJECT_SSE.KMS_ENCRYPTION&&(n.operation.panelSettingValues.kmsOption.kmsId.value===l.OBJECT_SSE.CUSTOM_ARN?n.operation.additionalInfo.sseKmsKeyId=n.operation.panelSettingValues.kmsOption.kmsARN:n.operation.additionalInfo.sseKmsKeyId=n.operation.panelSettingValues.kmsOption.kmsId.value);else if(n.operation.name===l.OPERATION_NAME.INITIATE_RESTORE)n.operation.additionalInfo={expirationDays:n.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:l.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API};else if(n.operation.name===l.OPERATION_NAME.ADD_OBJECT_TAG)n.operation.additionalInfo={tags:g.reduceObjectArrayToObject(n.operation.panelSettingValues.values),disableFetchTag:n.operation.panelSettingValues.disableFetchTag||!1,numberOfKeysPerBulkOperation:l.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API};else if(n.operation.name===l.OPERATION_NAME.GET_INFO)return void n.closeConfirmationModal();n.operation.totalObjectCount=n.countInfo.objects,m.log(n.operation.name.replace(/\s/g,"")+"ttlObj",n.operation.totalObjectCount,n.operation),m.log(n.operation.name.replace(/\s/g,"")+"ttlSize",n.countInfo.size,n.operation),S?u.startClipboardOperation():c.addOperation(n.operation),n.closeConfirmationModal()},n.save=function(e){e.stopPropagation(),n.isOpen.dialogOpen.flag=!0,n.isOpen.sidePanelOpen=!1},n.cancel=function(e){n.operation.cancel&&(m.log(n.operation.name.replace(/\s/g,"")+"cancelled",1,n.operation),n.operation.cancel()),n.closeConfirmationModal()}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=confirmation-modal ng-show=isOpen.flag> <dialog-modal is-open=isOpen.dialogOpen close-callback=cancel() header-title=modalInfo.headTitle has-warning-msg=modalInfo.warningInfo count-info=countInfo is-counting=isCounting.flag source-dst-info=sourceDstInfo> <dialog-modal-content> <file-list-in-modal selected=selected close-icon-show=closeIconShow></file-list-in-modal> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=cancel text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant=normal ng-click=cancel()></awsui-button> <awsui-button id=create-primary variant=primary text={{modalInfo.buttonName}} class="awsui-util-f-r primary-button" loading=isCounting.flag click=operationFunc()></awsui-button> </dialog-modal-footer> </dialog-modal> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("fileListInModal",function(){return{restrict:"E",scope:{removeItemFromUpload:"&?",closeIconShow:"=?",forUploads:"=",selected:"="},template:n(716),controller:"FileListInModalController"}}),e.module("s3").controller("FileListInModalController",["$scope","$filter","UtilService","S3Constants",function(e,n,r,i){e.$watchCollection("selected",function(){e.selectedItems=e.selected.selectedItems}),e.closeIconFunc=function(t){e.forUploads&&e.removeItemFromUpload&&e.removeItemFromUpload({item:t})},e.getFileIconClass=function(e){return r.getIconClassFromFilename(e.Key)},e.haveSelectedItems=function(){return e.selectedItems&&e.selectedItems.folders&&!t.isEmpty(e.selectedItems.folders)||e.selectedItems&&e.selectedItems.objects&&!t.isEmpty(e.selectedItems.objects)},e.isOversizedObjectForUpload=function(t){return e.forUploads&&t.Size>i.UPLOAD.MAX_OBJECT_SIZE}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div ng-show=haveSelectedItems() class=truncate> <table class=modal-selected-files> <tbody ng-show=forUploads> <tr> <td colspan=4> <span class="awsui-icon plus awsui-icon-link" for=uploadInput></span> <label class=modal-add-files-label id=modal-selected-files-upload-add for=uploadInput>{{\'uploadmodal.label.add.more.files\' | translate }}</label> </td> </tr> </tbody> <tbody ng-repeat="folder in selectedItems.folders"> <tr> <td class=modal-file-icon><span class="folder awsui-icon awsui-icon-light"></span></td> <td> <p class=modal-selected-files-file-name>{{ folder.Prefix }}</p> <p class=modal-selected-files-file-size> <span ng-if="folder.objsCount === null || folder.objsCount === undefined" translate=confirmationmodal.filelist.calculating></span> <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined" translate=confirmationmodal.folders translate-values="{totalFolders: {{folder.objsCount}} }"></span> <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined">- {{folder.folderSize | humanReadableBytes }} </span> </p> </td> <td> <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show=closeIconShow ng-click=closeIconFunc(folder)></span> </td> </tr> <tr ng-if=folder.hasOversizedObjects> <td class=oversized-alert colspan=3> <awsui-alert type=error>{{\'uploadmodal.largefiles.folders\'|translate}}</awsui-alert> </td> </tr> </tbody> <tbody ng-repeat="file in selectedItems.objects"> <tr> <td><span class="awsui-icon awsui-icon-light" ng-class=getFileIconClass(file)></span></td> <td> <p class=modal-selected-files-file-name>{{ file.Key }}</p> <p ng-if="file.VersionId && file.VersionId != \'null\'" class=modal-selected-files-file-size> {{ \'objects.column.versionid\' | translate }}: {{file.VersionId}} </p> <p class=modal-selected-files-file-size> <span ng-if=file.Size>- {{ file.Size | humanReadableBytes }}</span> <span ng-if=!file.Size> -- </span> </p> </td> <td> <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show=closeIconShow ng-click=closeIconFunc(file)></span> </td> </tr> <tr ng-if=isOversizedObjectForUpload(file)> <td class=oversized-alert colspan=3> <awsui-alert type=error>{{\'uploadmodal.largefiles.files\'|translate}}</awsui-alert> </td> </tr> </tbody> </table> </div> '},function(e,t,n){"use strict";(function(e,t,r){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function a(n,a,o,s,c,l,u,d,p,f){function g(){f.analyticsTrackClick(p.ANALYTICS.LIFECYCLE_RULES_MODAL,p.ANALYTICS.DETAILS)}function m(){if(n.lifecycleConfiguration&&n.lifecycleConfiguration.Rules)for(var e=0;e<n.lifecycleConfiguration.Rules.length;e++)n.lifecycle.listViewRules[e].selected=!1}function h(e,t){n.moreOptions[0].disabled=e,n.moreOptions[1].disabled=t}function b(){var e=[];if(e.push({text:a.instant("lifecyclemodal.sia"),value:p.LIFECYCLE.SIA,disabled:!1}),u.isFeatureEnabled(p.FAC.ISIDORE)){var t={text:a.instant("lifecyclemodal.isidore"),value:p.LIFECYCLE.INTELLIGENT_TIERING,disabled:!1};e.push(t)}if(u.isFeatureEnabled(p.FAC.ONEZONE_IA)){var r={text:a.instant("storageclass.ziatransition"),value:p.LIFECYCLE.ONEZONEIA,disabled:!1};e.push(r)}var i={text:a.instant("lifecyclemodal.glacier"),value:p.LIFECYCLE.GLACIER,disabled:!1};if(n.glacierEnabled&&e.push(i),u.isFeatureEnabled(p.FAC.DEEP_ARCHIVE)){var o={text:a.instant("lifecyclemodal.glacierdeeparchive"),value:p.LIFECYCLE.DEEP_ARCHIVE,disabled:!1};e.push(o)}return e}function v(e){for(var t=[],n=s.getCurrentLifeCycleTotalOption(),r=0;r<n;r++)t.push(e());return t}function E(e,t){if(e.NoncurrentVersionTransition)for(var n=f.transformObjectToArray(e.NoncurrentVersionTransition),r=0;r<n.length;r++)n[r].NoncurrentDays&&t.noncurrentRuleActions.push({action:p.LIFECYCLE.RULE_ACTIONS_MAP[n[r].StorageClass],value:n[r].NoncurrentDays})}function S(e,t){e.NoncurrentVersionExpiration&&e.NoncurrentVersionExpiration.NoncurrentDays&&(t.permanentlyDelete={enabled:!0,days:e.NoncurrentVersionExpiration.NoncurrentDays},t.showStep3PreviousVersion=!0)}function y(e,t){if(e.Transition)for(var n=f.transformObjectToArray(e.Transition),r=0;r<n.length;r++)n[r].Days&&t.currentRuleActions.push({action:p.LIFECYCLE.RULE_ACTIONS_MAP[n[r].StorageClass],value:n[r].Days})}function A(e,t){e.Expiration&&(e.Expiration.Days?(t.expiration={enabled:!0,days:e.Expiration.Days},t.removeExpire=!1,t.showRldm=!1,t.showStep3CurrentVersion=!0):e.Expiration.ExpiredObjectDeleteMarker&&(e.Expiration.ExpiredObjectDeleteMarker===p.LIFECYCLE.TRUE?t.removeExpire=!0:t.containsRldmAsFalse=!0))}function C(e,t){t.amu={enabled:!1,days:""},e.AbortIncompleteMultipartUpload&&(t.amu.enabled=!0,t.amu.days=e.AbortIncompleteMultipartUpload.DaysAfterInitiation)}function _(e){var n=t.cloneDeep(e),r={};if(r.ID=n.ID,r.Status=n.Status,r.tagSet=[],r.Prefix="",r.prefixUsed=!0,r.filters={input:"",prefixFilters:[],tagFilters:[]},n.Prefix?(r.filterUsed=!1,r.Prefix=n.Prefix,r.filters.prefixFilters.push(r.Prefix)):n.Filter&&(r.filterUsed=!0,n.Filter.Prefix?(r.Prefix=n.Filter.Prefix,r.filters.prefixFilters.push(r.Prefix)):n.Filter.And&&n.Filter.And.Prefix?(r.Prefix=n.Filter.And.Prefix,r.filters.prefixFilters.push(r.Prefix)):r.prefixUsed=!1),n.Filter){var i=[];t.isEmpty(n.Filter.Tag)?n.Filter.And&&!t.isEmpty(n.Filter.And.Tag)&&(i=f.transformObjectToArray(n.Filter.And.Tag)):i=f.transformObjectToArray(n.Filter.Tag);for(var a=0;a<i.length;a++)r.filters.tagFilters.push({tagKey:i[a].Key,tagVal:i[a].Value})}return r.applied=t.isEmpty(r.Prefix)?p.LIFECYCLE.WHOLE_BUCKET:p.LIFECYCLE.PREFIX,r.currentRuleActions=[],r.noncurrentRuleActions=[],r.expiration={enabled:!1,days:""},r.permanentlyDelete={enabled:!1,days:""},r.removeExpire=!1,r.showCurrent=!1,r.showPrevious=!1,r.showRldm=!0,y(n,r),A(n,r),E(n,r),S(n,r),C(n,r),r.currentRuleOptions=v(b),r.noncurrentRuleOptions=v(b),r.isAddCurrentTransitionDisabled=s.isTransitionDisabled(s.getCurrentDisableOption(),r.currentRuleActions),s.updateLifecycleDropdown(r.currentRuleActions,r.currentRuleOptions,p.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP),r.isAddPrevTransitionDisabled=s.isTransitionDisabled(s.getCurrentDisableOption(),r.noncurrentRuleActions),s.updateLifecycleDropdown(r.noncurrentRuleActions,r.noncurrentRuleOptions,p.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP),r.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:!1,amu:"",ID:"",prefix:""},r.isNextButtonDisabled=!1,r}function w(){n.lifecycle.listViewRules=[],n.filterUsed=!1;for(var r=0;r<n.lifecycleConfiguration.Rules.length;r++)!function(r){var i={},o=e.copy(n.lifecycleConfiguration.Rules[r]);if(i.ID=o.ID,void 0!==o.Prefix)i.Prefix=""!==o.Prefix?R[p.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+o.Prefix:R[p.LIFECYCLE.LIST_VIEW.WHOLE];else if(o.Filter){n.filterUsed=!0,o.Filter.Prefix?i.Prefix=R[p.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+o.Filter.Prefix:o.Filter.And&&o.Filter.And.Prefix?i.Prefix=R[p.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+o.Filter.And.Prefix:i.Prefix=a.instant("lifecycle.listview.whole"),i.Prefix.length>p.LIFECYCLE.LIST_VIEW_MAX_LENGTH&&(i.Prefix=i.Prefix.substring(0,22),i.Prefix=i.Prefix+"... ");var s=[];o.Filter.Tag?s=f.transformObjectToArray(o.Filter.Tag):o.Filter.And&&!t.isEmpty(o.Filter.And.Tag)&&(s=f.transformObjectToArray(o.Filter.And.Tag)),t.isEmpty(s)||function(){var t=p.LIFECYCLE.TAGS,n=p.LIFECYCLE.KEY_STRING,r=p.LIFECYCLE.VALUE_STRING,a=", "+t+" : ";e.forEach(s,function(e){a=a+" [ "+n+": "+e.Key+" , "+r+" : "+e.Value+" ]"}),a.length>p.LIFECYCLE.LIST_VIEW_MAX_LENGTH&&(a=a.substring(0,22),a+="..."),i.Prefix=i.Prefix+" "+a}()}i.Status=o.Status;var c=[];if(o.Transition)for(var l=f.transformObjectToArray(o.Transition),u=0;u<l.length;u++)l[u].Days?c.push(R[p.LIFECYCLE.LIST_VIEW[l[u].StorageClass]]):l[u].Date&&(c.push(R[p.LIFECYCLE.LIST_VIEW[l[u].StorageClass]]+" ("+a.instant("bucketlifecycle.date")+" "+l[u].Date+")"),i.containsDate=!0);o.Expiration&&(o.Expiration.Days?c.push(R[p.LIFECYCLE.EXPIRE]):o.Expiration.Date&&(c.push(R[p.LIFECYCLE.EXPIRE]+" ("+a.instant("bucketlifecycle.date")+" "+o.Expiration.Date+")"),i.containsDate=!0)),i.transitionsList="";for(var d=0;d<c.length;d++)i.transitionsList=i.transitionsList+" / "+c[d];if(t.isEmpty(i.transitionsList)?i.transitionsList="-":i.transitionsList=i.transitionsList.substring(3),c=[],i.prevActions="",o.NoncurrentVersionTransition){var g=f.transformObjectToArray(o.NoncurrentVersionTransition);e.forEach(g,function(e){e.NoncurrentDays&&c.push(R[p.LIFECYCLE.LIST_VIEW[e.StorageClass]])})}o.NoncurrentVersionExpiration&&c.push(p.LIFECYCLE.LIST_VIEW[p.LIFECYCLE.PERMANENTLY_DELETE]),e.forEach(c,function(e){i.prevActions=i.prevActions+" / "+e}),t.isEmpty(i.prevActions)?i.prevActions="-":i.prevActions=i.prevActions.substring(3),"-"===i.transitionsList&&"-"===i.prevActions&&o.AbortIncompleteMultipartUpload&&(i.transitionsList=a.instant("lifecyclemodal.step3.imucleanup")),n.lifecycle.listViewRules.push(i)}(r)}var T;n.moreOptions=[{id:p.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY,text:a.instant("bucketlifecycle.more.enablelifecycle"),action:function(){n.showConfirmationModal(p.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY)},disabled:!0},{id:p.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY,text:a.instant("bucketlifecycle.more.disablelifecycle"),action:function(){n.showConfirmationModal(p.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY)},disabled:!0}],n.showConfirmationModal=function(e){n.lifecycle.ruleToBeEdited&&(n.lifecycle.selectedRule=n.lifecycle.ruleToBeEdited,n.lifecycle.selectedRuleIndex=n.lifecycle.editRuleIndex,n.warningMessage=n.warningList[e],n.actionType=e,n.headerTitle=n.confirmationModalHeadersList[e],g(),n.isConfirmationModalOpen.flag=!0)},n.warningList={enablePolicy:a.instant("lifecycleconfirmationmodal.warning.enablemessage"),disablePolicy:a.instant("lifecycleconfirmationmodal.warning.disablemessage"),deletePolicy:a.instant("lifecycleconfirmationmodal.warning.deletemessage")},n.confirmationModalHeadersList={enablePolicy:a.instant("bucketlifecycle.more.enablelifecycle"),disablePolicy:a.instant("bucketlifecycle.more.disablelifecycle"),deletePolicy:a.instant("bucketlifecycle.more.deletelifecycle")},n.isConfirmationModalOpen={flag:!1},n.isLifecycleModalOpen={flag:!1},n.isRefreshing=!0,n.lifecycleError="",n.showLifecycleModalForEdit=function(){n.lifecycle.ruleToBeEdited&&(n.lifecycle.selectedRule=_(n.lifecycle.ruleToBeEdited),n.lifecycle.selectedRule.showCurrent=!t.isEmpty(n.lifecycle.selectedRule.currentRuleActions),n.lifecycle.selectedRule.showPrevious=!t.isEmpty(n.lifecycle.selectedRule.noncurrentRuleActions),n.lifecycle.selectedRule.indexVal=n.lifecycle.editRuleIndex,n.isLifecycleModalOpen.flag=!0,g(),n.forEdit=!0)},n.showLifecycleModalForCreate=function(){f.analyticsTrackClick(p.ANALYTICS.START_LIFECYCLE,p.ANALYTICS.LIFECYCLE_S3),f.analyticsTrackView(p.ANALYTICS.NAME_SCOPE_LIFECYCLE,p.ANALYTICS.LIFECYCLE_S3),m(),n.forEdit=!1,n.lifecycle.selectedRule={},n.lifecycle.selectedRule.ID="",n.lifecycle.selectedRule.Status=p.LIFECYCLE.ENABLED,n.lifecycle.selectedRule.Prefix="",n.lifecycle.selectedRule.applied=p.LIFECYCLE.WHOLE_BUCKET,n.lifecycle.selectedRule.tags=[],n.lifecycle.selectedRule.currentRuleActions=[],n.lifecycle.selectedRule.noncurrentRuleActions=[],n.lifecycle.selectedRule.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:!1,amu:"",ID:"",prefix:""},n.lifecycle.selectedRule.amu={enabled:!1,days:""},n.lifecycle.selectedRule.expiration={enabled:!1,days:""},n.lifecycle.selectedRule.permanentlyDelete={enabled:!1,days:""},n.lifecycle.selectedRule.showRldm=!0,n.lifecycle.selectedRule.rldmValue=!1,n.lifecycle.selectedRule.containsRldmAsFalse=!1,n.lifecycle.selectedRule.removeExpire=!1,n.lifecycle.selectedRule.expiration={enabled:!1,days:""},n.lifecycle.selectedRule.showCurrent=!1,n.lifecycle.selectedRule.showPrevious=!1,n.lifecycle.selectedRule.currentRuleOptions=v(b),n.lifecycle.selectedRule.noncurrentRuleOptions=v(b),n.lifecycle.selectedRule.isAddCurrentTransitionDisabled=!1,n.lifecycle.selectedRule.isAddPrevTransitionDisabled=!1,n.lifecycle.selectedRule.isNextButtonDisabled=!0,n.lifecycle.selectedRule.showStep3CurrentVersion=!1,n.lifecycle.selectedRule.showStep3PreviousVersion=!1,n.lifecycle.selectedRule.filterUsed=n.filterUsed,n.lifecycle.selectedRule.filters={input:"",prefixFilters:[],tagFilters:[]},n.lifecycle.selectedRule.prefixUsed=!1,g(),n.isLifecycleModalOpen.flag=!0},n.isEdit=!0,n.isDelete=!0,n.selectRule=function(t,r){n.lifecycle.selectedRule={},n.lifecycle.ruleToBeEdited=e.copy(n.lifecycleConfiguration.Rules[r]),n.lifecycle.editRuleIndex=r,m(),t.selected=!0,t.containsDate||(n.isEdit=!1),n.isDelete=!1,t.Status===p.LIFECYCLE.ENABLED?h(!0,!1):h(!1,!0)},n.lifecycle={listViewRules:[],ruleToBeEdited:{}},n.lifecycleConfiguration={Rules:[]},n.bucketName=d.getCurrentBucket();var R=(T={},i(T,p.LIFECYCLE.LIST_VIEW.INTELEGENT_TIER,a.instant("storageclass.selector.isidore.name")),i(T,p.LIFECYCLE.LIST_VIEW.STANDARD_IA,a.instant("lifecycle.listview.standia")),i(T,p.LIFECYCLE.LIST_VIEW.ONEZONE_IA,a.instant("storageclass.zia")),i(T,p.LIFECYCLE.LIST_VIEW.GLACIER,a.instant("lifecycle.listview.glacier")),i(T,p.LIFECYCLE.LIST_VIEW.DEEP_ARCHIVE,a.instant("storageclass.glacierdeeparchive")),i(T,p.LIFECYCLE.LIST_VIEW.PREFIX,a.instant("lifecycle.listview.prefix")),i(T,p.LIFECYCLE.LIST_VIEW.WHOLE,a.instant("lifecycle.listview.whole")),i(T,p.LIFECYCLE.EXPIRE,a.instant("lifecycle.expire")),T);n.operation=new l(p.LIFECYCLE.BUCKET_LIFECYCLE),n.glacierEnabled=!0,n.initialize=function(){var e=new r({stripWhitespaces:!1});n.lifecycle.initialXML="",n.lifecycleConfiguration.Rules=[],n.isRefreshing=!0,n.operation.step=p.LIFECYCLE.GET_BUCKET_LIFECYCLE,o.getBucketLifecycle(n.bucketName,n.operation).then(function(t){c.evictBucketProperty(n.bucketName,p.LIFECYCLE.NAME);var r=e.xml_str2json(t);r&&r.LifecycleConfiguration&&r.LifecycleConfiguration.Rule&&(n.lifecycleConfiguration.Rules=f.transformObjectToArray(r.LifecycleConfiguration.Rule),n.showEmptyScreen=0===n.lifecycleConfiguration.Rules.length,n.lifecycle.initialXML=t,w())}).catch(function(e){e!==p.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE?n.lifecycleError=e:n.showEmptyScreen=!0}).finally(function(){n.isRefreshing=!1})},n.initialize(),function(){o.getBucketLocation(n.bucketName).then(function(e){u.isFeatureEnabled("s3-gl-"+e)||(n.glacierEnabled=!1)})}()}e.module("s3").directive("bucketLifecycle",[function(){return{restrict:"E",scope:{},template:n(718),controller:"BucketLifecycleController"}}]),e.module("s3").controller("BucketLifecycleController",["$scope","$translate","BucketPropertiesService","BucketPropertiesUtilService","CachingService","ConsoleOperation","FAC","PathService","S3Constants","UtilService",a])}()}).call(t,n(0),n(2),n(100))},function(e,t){e.exports='<div> <awsui-alert header="{{\'error.header\'|translate}}" type=error ng-if=lifecycleError> {{ lifecycleError }}</awsui-alert> <div class=action-strip> <awsui-button id=add-rule class=action-button-spacing text="{{\'bucketlifecycle.label.addlifecyclepolicy\' | translate}}" icon=plus click=showLifecycleModalForCreate() variant=primary></awsui-button> <awsui-button id=edit-rule class=action-button-spacing text="{{ \'bucketlifecycle.label.edit\' | translate }}" data-disabled=isEdit click=showLifecycleModalForEdit()></awsui-button> <awsui-button id=delete-rule class=action-button-spacing text="{{ \'bucketlifecycle.label.delete\' | translate }}" data-disabled=isDelete click="showConfirmationModal(\'deletePolicy\')"></awsui-button> <action-dropdown class=bucket-more-dropdown text="{{ \'bucketlifecycle.label.more\' | translate }}" items=moreOptions></action-dropdown> <awsui-button class=lifecycle-refresh-icon id=refresh-button icon=refresh variant=standalone-icon loading=isRefreshing click=initialize()></awsui-button> </div> <empty-state ng-if=showEmptyScreen open-modal=showLifecycleModalForCreate type="\'lifecycle\'"></empty-state> <div ng-if=!showEmptyScreen class=columbia-table> <table class="table table-condensed"> <thead> <tr class=black-header> <th></th> <th><a translate=bucketlifecycle.policy></a></th> <th><a translate=bucketlifecycle.applied></a></th> <th><a translate=bucketlifecycle.currentversiontransition></a></th> <th><a translate=bucketlifecycle.previousversionaction></a></th> </tr> </thead> <tbody> <tr ng-class="{\'row-selected\' : rule.selected, \'row-hover\': hoverRule && !rule.selected}" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false" ng-repeat="rule in lifecycle.listViewRules" ng-click="selectRule(rule, $index); $event.stopPropagation();"> <td><span class="lifecycle-rule-status enabled-icon" ng-if="rule.Status === \'Enabled\'"></span> <span class="lifecycle-rule-status disabled-icon" ng-if="rule.Status === \'Disabled\'"></span> </td> <td> {{ rule.ID }} </td> <td> {{ rule.Prefix }} </td> <td> {{ rule.transitionsList }} </td> <td> {{ rule.prevActions }} </td> </tr> </tbody> </table> </div> <lifecycle-modal ng-if=isLifecycleModalOpen.flag is-open=isLifecycleModalOpen selected-rule=lifecycle.selectedRule rule-to-be-edited=lifecycle.ruleToBeEdited disable-edit=isEdit disable-delete=isDelete is-editing=forEdit initial-response=lifecycleConfiguration.Rules initialize=initialize initial-xml=lifecycle.initialXML more-options=moreOptions operation=operation></lifecycle-modal> <lifecycle-confirmation-modal selected-rule=lifecycle.selectedRule rule-to-be-edited=lifecycle.ruleToBeEdited disable-edit=isEdit disable-delete=isDelete list-rules=lifecycle.listViewRules header-title=headerTitle is-open=isConfirmationModalOpen action-type=actionType warning-message=warningMessage initial-xml=lifecycle.initialXML selected-rule-index=lifecycle.selectedRuleIndex initial-response=lifecycleConfiguration.Rules operation=operation initialize=initialize more-options=moreOptions></lifecycle-confirmation-modal> </div>'},function(e,t,n){"use strict";(function(e,t,r,i){!function(){function a(n,a,o,s,c,l,u,d,p,f,g){function m(){n.selectedRule.isAddCurrentTransitionDisabled=c.isTransitionDisabled(c.getCurrentDisableOption(),n.selectedRule.currentRuleActions),c.updateLifecycleDropdown(n.selectedRule.currentRuleActions,n.selectedRule.currentRuleOptions,d.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP)}function h(){n.selectedRule.isAddPrevTransitionDisabled=c.isTransitionDisabled(c.getCurrentDisableOption(),n.selectedRule.noncurrentRuleActions),c.updateLifecycleDropdown(n.selectedRule.noncurrentRuleActions,n.selectedRule.noncurrentRuleOptions,d.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP)}function b(e,t){var n=t[e],r=n.action,i=e>0?t[e-1].action:"",a=e>0?parseInt(t[e-1].value,10):0,o=v(r),s=E(i);return(a+Math.max(o,s)).toString()}function v(e){var n=t.isString(e)?e.toUpperCase():"";return parseInt(t.get(d.LIFECYCLE.RECOMMENDED_DAYS,n,"0"),10)}function E(e){return e===d.LIFECYCLE.SIA?d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA:e===d.LIFECYCLE.INTELLIGENT_TIERING?d.LIFECYCLE.INTELLIGENT_TIERING_OUT_TRANSITION_MIN_DAYS:e===d.LIFECYCLE.ONEZONEIA?d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.ONEZONEIA:e===d.LIFECYCLE.GLACIER?d.LIFECYCLE.GLACIER_OUT_TRANSITION_MIN_DAYS:l.isFeatureEnabled(d.FAC.DEEP_ARCHIVE)&&e===d.LIFECYCLE.DEEP_ARCHIVE?d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.DEEP_ARCHIVE:0}function S(e,t){e.days=d.LIFECYCLE.RECOMMENDED_DAYS.EXPIRATION,t.length>0&&(e.days=(parseInt(t[t.length-1].value)+parseInt(e.days)).toString())}function y(e,t,r){var i={};i.LifecycleConfiguration={},i.LifecycleConfiguration.Rule=e,delete e._xmlns;var a=n.initialXml,o=t.json2xml_str(i),c=n.isEditing?t.json2xml_str(n.initialResponse[n.selectedRule.indexVal]):"";s.putBucketLifecycle(u.getCurrentBucket(),a,o,c,r,n.operation).then(function(){n.lifecycleError=void 0,n.disableEdit=!0,n.disableDelete=!0,n.ruleToBeEdited=void 0,n.moreOptions[0].disabled=!0,n.moreOptions[1].disabled=!0,n.initialize(),n.closeLifecycleModal()}).catch(function(e){n.lifecycleError=e})}function A(e,n){return Object.keys(e).some(function(r){return r!==d.LIFECYCLE.PREFIX_PROPERTY&&!t.isEqual(e[r],n[r])})}function C(e,t,n){for(var r=[],i=0;i<e.length;i++){var a="",o=e[i].value;if(e[i].action===d.LIFECYCLE.SIA){var s=_(d.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,o,t);r.push(s),a=t?"LifecycleCurrentSIARule":"LifecycleNoncurrentSIARule"}else if(e[i].action===d.LIFECYCLE.GLACIER){var c=_(d.STORAGE_CLASSES.GLACIER,o,t);r.push(c),a=t?"LifecycleCurrentGlacierRule":"LifecycleNoncurrentGlacierRule"}else if(e[i].action===d.LIFECYCLE.ONEZONEIA){var l=_(d.STORAGE_CLASSES.ONEZONE_IA,o,t);r.push(l),a=t?"LifecycleCurrentOneZoneIARule":"LifecycleNoncurrentOneZoneIARule"}else if(e[i].action===d.LIFECYCLE.INTELLIGENT_TIERING){var u=_(d.STORAGE_CLASSES.INTELLIGENT_TIERING,o,t);r.push(u),a=t?"LifecycleCurrentIsidoreRule":"LifecycleNoncurrentIsidoreRule"}else if(e[i].action===d.LIFECYCLE.DEEP_ARCHIVE){var f=_(d.STORAGE_CLASSES.DEEP_ARCHIVE,o,t);r.push(f),a=t?"LifecycleCurrentGlacierDeepArchiveRule":"LifecycleNoncurrentGlacierDeepArchiveRule"}""!==a&&p.log(a,1,n)}return r}function _(e,t,n){var r={StorageClass:e};return n?r.Days=t:r.NoncurrentDays=t,r}function w(){n.glacierMinDaysWarningCurrent=!1,n.notANumberErrorCurrent={},n.notANumberErrorCurrent.SIA=!1,n.notANumberErrorCurrent.Glacier=!1,n.notANumberErrorCurrent.DEEP_ARCHIVE=!1,n.notANumberErrorCurrent.Expire=!1,n.minimumDaysCurrent={},n.minimumDaysCurrent.SIA=!1,n.minimumDaysCurrent.Glacier=!1,n.minimumDaysCurrent.DEEP_ARCHIVE=!1,n.minimumDaysCurrent.Expire=!1,n.greaterThanCurrentError={},n.greaterThanCurrentError.GlacierGreaterThanSIA=!1,n.greaterThanCurrentError.DeleteGreaterThanSIA=!1,n.greaterThanCurrentError.DeleteGreaterThanGlacier=!1,n.highlightTextBoxErrorCurrent=[!1,!1,!1,!1,!1],n.glacierMinDaysWarningNonCurrent=!1,n.notANumberErrorNoncurrent={},n.notANumberErrorNoncurrent.SIA=!1,n.notANumberErrorNoncurrent.Glacier=!1,n.notANumberErrorNoncurrent.DEEP_ARCHIVE=!1,n.notANumberErrorNoncurrent.PermanentlyDelete=!1,n.minimumDaysNoncurrent={},n.minimumDaysNoncurrent.SIA=!1,n.minimumDaysNoncurrent.Glacier=!1,n.minimumDaysNoncurrent.DEEP_ARCHIVE=!1,n.minimumDaysNoncurrent.PermanentlyDelete=!1,n.greaterThanNonCurrentError={},n.greaterThanNonCurrentError.GlacierGreaterThanSIA=!1,n.greaterThanNonCurrentError.DeleteGreaterThanSIA=!1,n.greaterThanNonCurrentError.DeleteGreaterThanGlacier=!1,n.highlightTextBoxErrorNonCurrent=[!1,!1,!1,!1,!1],n.currentGlacierGreaterThanSIAValue="",n.expireGreaterThanSIAValue="",n.expireGreaterThanGlacierValue="",n.glacierMinDaysWarningCurrentValue="",n.glacierMinDaysWarningNonCurrentValue="",n.noncurrentGlacierGreaterThanSIAValue="",n.permanentlyDeleteGreaterThanSIAValue="",n.permanentlyDeleteGreaterThanGlacierValue="",n.tag={error:""},n.tagSearchSelected=!1,n.showTag=!1,n.markers=[],n.tagContinuationTokens=[],n.higherNumberErrorCurrent={},n.higherNumberErrorCurrent.SIA=!1,n.higherNumberErrorCurrent.Glacier=!1,n.higherNumberErrorCurrent.DEEP_ARCHIVE=!1,n.higherNumberErrorCurrent.Expire=!1,n.higherNumberErrorNoncurrent={},n.higherNumberErrorNoncurrent.SIA=!1,n.higherNumberErrorNoncurrent.Glacier=!1,n.higherNumberErrorNoncurrent.DEEP_ARCHIVE=!1,n.higherNumberErrorNoncurrent.PermanentlyDelete=!1}function T(){n.notANumberAmuError=!1,n.minimumDaysAmuError=!1,n.higherNumberErrorAmu=!1,n.hasCurrentError=!1,n.hasPrevError=!1}function R(){w(),T()}function O(e,t,r,i,a,o){var s=e.length;if(s>=1){if(e[0].action===d.LIFECYCLE.SIA&&2===s&&e[1].action===d.LIFECYCLE.GLACIER){if(e[1].value-e[0].value<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA){r[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=!0,i[s-1]=!0;var c=parseInt(e[0].value)+30;return void(o===d.LIFECYCLE.CURRENT?n.currentGlacierGreaterThanSIAValue=c:n.noncurrentGlacierGreaterThanSIAValue=c)}if(e[0].value<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA)return a[d.LIFECYCLE.SIA]=!0,void(i[s-2]=!0);r[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=!1,i[s-1]=!1}if(s>=2&&e[s-2].action===d.LIFECYCLE.GLACIER&&e[s-1].value<parseInt(e[s-2].value,10)+d.LIFECYCLE.GLACIER_OUT_TRANSITION_MIN_DAYS&&(o===d.LIFECYCLE.CURRENT?(n.glacierMinDaysWarningCurrent=!0,n.glacierMinDaysWarningCurrentValue=b(s-1,n.selectedRule.currentRuleActions)):(n.glacierMinDaysWarningNonCurrent=!0,n.glacierMinDaysWarningNonCurrentValue=b(s-1,n.selectedRule.noncurrentRuleActions)),i[s-1]=!0),""!==t&&t-e[s-1].value<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.Delete){var c=parseInt(e[s-1].value)+1;if(e[s-1].action===d.LIFECYCLE.SIA)return r[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!0,i[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0,void(o===d.LIFECYCLE.CURRENT?n.expireGreaterThanSIAValue=c:n.permanentlyDeleteGreaterThanSIAValue=c);if(e[s-1].action===d.LIFECYCLE.GLACIER)return r[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!0,i[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0,void(o===d.LIFECYCLE.CURRENT?n.expireGreaterThanGlacierValue=c:n.permanentlyDeleteGreaterThanGlacierValue=c)}else r[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,i[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1}}function k(e){return e===d.LIFECYCLE.CURRENT?n.minimumDaysCurrent.SIA||n.minimumDaysCurrent.Glacier||n.minimumDaysCurrent.DEEP_ARCHIVE||n.minimumDaysCurrent.Expire||n.higherNumberErrorCurrent.Expire||n.greaterThanCurrentError.GlacierGreaterThanSIA||n.greaterThanCurrentError.DeleteGreaterThanSIA||n.greaterThanCurrentError.DeleteGreaterThanGlacier||n.glacierMinDaysWarningCurrent||-1!==t.indexOf(n.highlightTextBoxErrorCurrent,!0):n.minimumDaysNoncurrent.SIA||n.minimumDaysNoncurrent.Glacier||n.minimumDaysNoncurrent.DEEP_ARCHIVE||n.minimumDaysNoncurrent.PermanentlyDelete||n.higherNumberErrorNoncurrent.PermanentlyDelete||n.greaterThanNonCurrentError.GlacierGreaterThanSIA||n.greaterThanNonCurrentError.DeleteGreaterThanSIA||n.greaterThanNonCurrentError.DeleteGreaterThanGlacier||n.glacierMinDaysWarningNonCurrent||-1!==t.indexOf(n.highlightTextBoxErrorNonCurrent,!0)}function I(){return t.some(n.selectedRule.currentRuleActions,function(e){return""===e.action||""===e.value})}function P(){return t.some(n.selectedRule.noncurrentRuleActions,function(e){return""===e.action||""===e.value})}function N(){return n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]||n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]||n.glacierMinDaysWarningNonCurrent||n.glacierMinDaysWarningCurrent}function M(){return n.selectedRule.expiration.enabled&&""===n.selectedRule.expiration.days||n.selectedRule.permanentlyDelete.enabled&&""===n.selectedRule.permanentlyDelete.days||n.selectedRule.amu.enabled&&""===n.selectedRule.amu.days||n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||n.amuError}function L(){if(n.state.name===n.STEP.NAME_AND_SCOPE.name){var e=!t.isEmpty(n.selectedRule.filters.input);n.showFinishSelectionWarning=e,n.selectedRule.isNextButtonDisabled=e}else n.state.name===n.STEP.TRANSITION.name?n.selectedRule.isNextButtonDisabled=I()||P()||N():n.state.name===n.STEP.EXPIRATION.name&&(n.selectedRule.isNextButtonDisabled=M()||t.isEmpty(n.selectedRule.currentRuleActions)&&t.isEmpty(n.selectedRule.noncurrentRuleActions)&&!n.selectedRule.expiration.enabled&&!n.selectedRule.amu.enabled&&!n.selectedRule.permanentlyDelete.enabled&&!n.selectedRule.removeExpire)}function x(e,t){for(var r=0;r<e.length&&!n.validateDays(r,t);r++);}n.STEP={NAME_AND_SCOPE:{name:"NAME_AND_SCOPE",value:o.instant("lifecyclemodal.label.nameandscope")},TRANSITION:{name:"TRANSITION",value:o.instant("lifecyclemodal.transitions")},EXPIRATION:{name:"EXPIRATION",value:o.instant("lifecyclemodal.expiration")},REVIEW:{name:"REVIEW",value:o.instant("lifecyclemodal.label.review")}},n.s3PricingLink=f.getPricingUrl("s3"),n.transitionsLearnMoreLink=g.getDocUrl(d.LEARN_MORE_LINKS.LIFECYCLE_TRANSITIONS),n.transitionNumber=[o.instant("bucketlifecycle.firsttransition"),o.instant("bucketlifecycle.secondtransition"),o.instant("bucketlifecycle.thirdtransition")],n.$watch("selectedRule",function(e,r){n.selectedRule&&(n.state.name===n.STEP.NAME_AND_SCOPE.name&&1===n.selectedRule.ID.length&&n.updateNextButtonDisabled(),n.selectedRule.filters&&n.selectedRule.filters.tagFilters.length>0?((n.selectedRule.amu.enabled&&n.selectedRule.amu.days||n.selectedRule.removeExpire)&&(n.clearLDMAMUWarning=!0,n.selectedRule.amu.enabled=!1,n.selectedRule.amu.days="",n.selectedRule.removeExpire=!1),n.showV2FormatWarning=!n.selectedRule.filterUsed&&!t.isEmpty(n.initialResponse)):(n.showV2FormatWarning=!1,n.clearLDMAMUWarning=!1))},!0),n.selectedRule&&!t.isEmpty(n.selectedRule.ID)||a(function(){e.element("#rule-name input").focus()}),n.isAddPrevTransitionDisabled=!1,n.isAddCurrentTransitionDisabled=!1,n.showOverlappingPrefixWarning=!1,n.selectNoncurrentRuleAction=function(e,t){t===n.selectedRule.noncurrentRuleActions.length-1&&(n.hasPrevError=!1),n.notANumberErrorNoncurrent.SIA=!1,n.notANumberErrorNoncurrent.Glacier=!1,n.notANumberErrorNoncurrent.DEEP_ARCHIVE=!1,n.glacierMinDaysWarningNonCurrent=!1,n.minimumDaysNoncurrent.SIA=!1,n.minimumDaysNoncurrent.Glacier=!1,n.minimumDaysNoncurrent.DEEP_ARCHIVE=!1,h(),""===n.selectedRule.noncurrentRuleActions[t].value&&(n.selectedRule.noncurrentRuleActions[t].value=b(t,n.selectedRule.noncurrentRuleActions)),n.validateDays(t,d.LIFECYCLE.NONCURRENT),n.updateNextButtonDisabled()},n.selectCurrentRuleAction=function(e,t){t===n.selectedRule.currentRuleActions.length-1&&(n.hasCurrentError=!1),n.notANumberErrorCurrent.SIA=!1,n.notANumberErrorCurrent.INTELLIGENT_TIERING=!1,n.notANumberErrorCurrent.ONEZONEIA=!1,n.notANumberErrorCurrent.Glacier=!1,n.notANumberErrorCurrent.DEEP_ARCHIVE=!1,n.glacierMinDaysWarningCurrent=!1,n.minimumDaysCurrent.SIA=!1,n.minimumDaysCurrent.INTELLIGENT_TIERING=!1,n.minimumDaysCurrent.ONEZONEIA=!1,n.minimumDaysCurrent.Glacier=!1,n.minimumDaysCurrent.DEEP_ARCHIVE=!1,m(),""===n.selectedRule.currentRuleActions[t].value&&(n.selectedRule.currentRuleActions[t].value=b(t,n.selectedRule.currentRuleActions)),n.validateDays(t,d.LIFECYCLE.CURRENT),n.updateNextButtonDisabled()},n.addCurrentRuleAction=function(){n.selectedRule.isAddCurrentTransitionDisabled||(n.selectedRule.currentRuleActions.push({action:"",value:""}),m(),n.selectedRule.isAddCurrentTransitionDisabled=!0,n.updateNextButtonDisabled())},n.removeCurrentRuleAction=function(e){n.selectedRule.currentRuleActions.length-1===e&&(n.hasCurrentError=!1);var t=n.selectedRule.currentRuleActions[e].action;n.notANumberErrorCurrent[t]=!1,n.minimumDaysCurrent[t]=!1,n.highlightTextBoxErrorCurrent[e]=!1,n.selectedRule.currentRuleActions.splice(e,1),m(),x(n.selectedRule.currentRuleActions,d.LIFECYCLE.CURRENT),n.updateNextButtonDisabled(),n.selectedRule.expiration.enabled&&n.validateCurrentExpiration()},n.addNoncurrentRuleAction=function(){n.selectedRule.isAddPrevTransitionDisabled||(n.selectedRule.noncurrentRuleActions.push({action:"",value:""}),h(),n.selectedRule.isAddPrevTransitionDisabled=!0,n.updateNextButtonDisabled())},n.removeNoncurrentRuleAction=function(e){n.selectedRule.noncurrentRuleActions.length-1===e&&(n.hasPrevError=!1);var t=n.selectedRule.noncurrentRuleActions[e].action;n.notANumberErrorNoncurrent[t]=!1,n.minimumDaysNoncurrent[t]=!1,n.highlightTextBoxErrorNonCurrent[e]=!1,n.selectedRule.noncurrentRuleActions.splice(e,1),h(),x(n.selectedRule.noncurrentRuleActions,d.LIFECYCLE.NONCURRENT),n.updateNextButtonDisabled(),n.selectedRule.permanentlyDelete.enabled&&n.validateNoncurrentExpiration()},n.state=n.STEP.NAME_AND_SCOPE,n.headerTitle=o.instant("lifecyclemodal.header.title"),n.generateSummary=function(){if(n.state===n.STEP.NAME_AND_SCOPE){if(!t.isEmpty(n.selectedRule.filters.input))return void n.updateNextButtonDisabled();if(f.analyticsTrackClick(d.ANALYTICS.NAME_SCOPE_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3),f.analyticsTrackView(d.ANALYTICS.TRANSITION_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3),n.selectedRule.summary.ruleName=e.copy(n.selectedRule.ID),n.showOldUI)n.selectedRule.summary.prefix=t.isEmpty(n.selectedRule.Prefix)?o.instant("lifecyclemodal.step1.wholebucket"):e.copy(n.selectedRule.Prefix);else{var r=n.selectedRule.filters&&!t.isEmpty(n.selectedRule.filters.prefixFilters)?e.copy(n.selectedRule.filters.prefixFilters[0]):o.instant("lifecyclemodal.step1.wholebucket"),i=d.LIFECYCLE.TAGSET;i+=" : ";for(var a=0;a<n.selectedRule.filters.tagFilters.length;a++){var s=d.LIFECYCLE.KEY,c=d.LIFECYCLE.VALUE;i=i+" [ "+s+" "+n.selectedRule.filters.tagFilters[a].tagKey+" , "+c+" : "+n.selectedRule.filters.tagFilters[a].tagVal+" ]"}n.selectedRule.summary.prefix=""+r,t.isEmpty(n.selectedRule.filters.tagFilters)||(n.selectedRule.summary.prefix=r+" , "+i)}}else if(n.state===n.STEP.TRANSITION){n.selectedRule.summary.currentTransitionsList=[],n.selectedRule.summary.noncurrentTransitionsList=[];for(var l=o.instant("lifecyclemodal.step3.afterdays"),u=o.instant("lifecyclemodal.days"),a=0;a<n.selectedRule.currentRuleActions.length;a++){var p=e.copy(n.selectedRule.currentRuleActions[a].value),g=d.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[n.selectedRule.currentRuleActions[a].action],m=g+" "+l+" "+p+" "+u;n.selectedRule.summary.currentTransitionsList.push(m)}for(var a=0;a<n.selectedRule.noncurrentRuleActions.length;a++){var h=e.copy(n.selectedRule.noncurrentRuleActions[a].value),g=d.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[n.selectedRule.noncurrentRuleActions[a].action],b=g+" "+l+" "+h+" "+u;n.selectedRule.summary.noncurrentTransitionsList.push(b)}n.selectedRule.summary.currentVersionHeader=t.some(n.selectedRule.summary.currentTransitionsList,function(e){return""!==e}),n.selectedRule.summary.noncurrentVersionHeader=t.some(n.selectedRule.summary.noncurrentTransitionsList,function(e){return""!==e}),f.analyticsTrackClick(d.ANALYTICS.TRANSITION_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3),f.analyticsTrackView(d.ANALYTICS.EXPIRATIONS_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3)}else n.state===n.STEP.EXPIRATION&&(n.searchOverlappingPrefixes(),n.selectedRule.amu&&n.selectedRule.amu.enabled&&""!==n.selectedRule.amu.days?n.selectedRule.summary.amu=e.copy(n.selectedRule.amu.days):n.selectedRule.summary.amu="",n.selectedRule.removeExpire&&n.selectedRule.expiration&&!n.selectedRule.expiration.enabled?n.selectedRule.summary.rldm=!0:n.selectedRule.summary.rldm=!1,f.analyticsTrackClick(d.ANALYTICS.EXPIRATIONS_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3),f.analyticsTrackView(d.ANALYTICS.REVIEW_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3));n.nextState(),n.selectedRule.isNextButtonDisabled=!0,n.updateNextButtonDisabled()},n.searchOverlappingPrefixes=function(){n.showOverlappingPrefixWarning=!1,n.overlappingRule="";for(var e=0;e<n.initialResponse.length;e++)if(!n.isEditing||e!==n.selectedRule.indexVal){var r="",i="";i=n.showOldUI?n.selectedRule.Prefix:t.isEmpty(n.selectedRule.filters.prefixFilters)?"":n.selectedRule.filters.prefixFilters[0];var a=n.initialResponse[e];if(a.Prefix?r=a.Prefix:a.Filter&&(a.Filter.Prefix?r=a.Filter.Prefix:a.Filter.And&&a.Filter.And.Prefix&&(r=a.Filter.And.Prefix)),t.startsWith(i,r)||t.startsWith(r,i)){n.showOverlappingPrefixWarning=!0,n.selectedRule.filterUsed||(n.showOverlappingNewFormatWarning=!0),n.overlappingRule=a.ID;break}}},n.detectStateChange=function(){n.operation.step=d.LIFECYCLE.GET_BUCKET_LIFECYCLE,s.getBucketLifecycle(u.getCurrentBucket(),n.operation).then(function(e){e!==n.initialXml?(n.showContinue=!0,n.stateChangeWarning=o.instant("lifecyclemodal.step3.statechange")):(n.showContinue=!1,n.stateChangeWarning=void 0,n.saveLifecycle())}).catch(function(e){e===d.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE?""!==n.initialXml?(n.showContinue=!0,n.stateChangeWarning=o.instant("lifecyclemodal.step3.statechange")):(n.showContinue=!1,n.stateChangeWarning=void 0,n.saveLifecycle()):n.lifecycleError=e})},n.saveLifecycle=function(){var i={},a=!1;f.analyticsTrackClick(d.ANALYTICS.END_LIFECYCLE,d.ANALYTICS.LIFECYCLE_S3,{s_fid:f.getCookie("s_fid"),"session-id":f.getCookie("session-id")}),n.operation.step=d.LIFECYCLE.ENABLED_LIFECYCLE_RULE_ACTIONS;var o=e.copy(n.selectedRule);if(i.ID=o.ID,n.selectedRule.filterUsed||!t.isEmpty(n.selectedRule.filters.tagFilters)||n.showOverlappingPrefixWarning){if(t.isEmpty(o.filters.tagFilters))i.Filter={},n.showOldUI?i.Filter.Prefix=o.applied===d.LIFECYCLE.PREFIX?o.Prefix:"":i.Filter.Prefix=t.isEmpty(o.filters.prefixFilters)?"":o.filters.prefixFilters[0];else if(1===o.filters.tagFilters.length&&!o.prefixUsed&&(n.showOldUI&&t.isEmpty(o.Prefix)||!n.showOldUI&&t.isEmpty(o.filters.prefixFilters)))i.Filter={},i.Filter.Tag=[],i.Filter.Tag.push({Key:o.filters.tagFilters[0].tagKey,Value:o.filters.tagFilters[0].tagVal});else{i.Filter={},i.Filter.And={},n.showOldUI?i.Filter.And.Prefix=o.applied===d.LIFECYCLE.PREFIX?o.Prefix:"":i.Filter.And.Prefix=t.isEmpty(o.filters.prefixFilters)?"":o.filters.prefixFilters[0],i.Filter.And.Tag=[];for(var s=0;s<o.filters.tagFilters.length;s++)i.Filter.And.Tag.push({Key:o.filters.tagFilters[s].tagKey,Value:o.filters.tagFilters[s].tagVal})}n.selectedRule.filterUsed||(a=!0)}else n.showOldUI?i.Prefix=o.applied===d.LIFECYCLE.PREFIX?o.Prefix:"":t.isEmpty(n.initialResponse)?(i.Filter={},i.Filter.Prefix=t.isEmpty(o.filters.prefixFilters)?"":o.filters.prefixFilters[0],a=!0):i.Prefix=t.isEmpty(o.filters.prefixFilters)?"":o.filters.prefixFilters[0];i.Status=o.Status,i.Transition=C(o.currentRuleActions,!0,n.operation),0===i.Transition.length&&delete i.Transition,i.NoncurrentVersionTransition=C(o.noncurrentRuleActions,!1,n.operation),0===i.NoncurrentVersionTransition.length&&delete i.NoncurrentVersionTransition,o.expiration&&o.expiration.enabled&&""!==o.expiration.days&&(i.Expiration={},i.Expiration.Days=o.expiration.days,p.log("LifecycleExpirationRule",1,n.operation)),o.permanentlyDelete&&o.permanentlyDelete.enabled&&""!==o.permanentlyDelete.days&&(i.NoncurrentVersionExpiration={},i.NoncurrentVersionExpiration.NoncurrentDays=o.permanentlyDelete.days,p.log("LifecycleNoncurrentExpirationRule",1,n.operation)),o.removeExpire&&(i.Expiration&&i.Expiration.Days||(i.Expiration={},i.Expiration.ExpiredObjectDeleteMarker=d.LIFECYCLE.TRUE,p.log("LifecycleExpiredLDMTrueRule",1,n.operation))),o.amu&&o.amu.enabled&&""!==o.amu.days&&(i.AbortIncompleteMultipartUpload={},i.AbortIncompleteMultipartUpload.DaysAfterInitiation=o.amu.days,p.log("LifecycleAbortIncompleteUploadRule",1,n.operation)),o.containsRldmAsFalse&&(i.Expiration||(i.Expiration={},i.Expiration.ExpiredObjectDeleteMarker=d.LIFECYCLE.FALSE,p.log("LifecycleExpiredLDMFalseRule",1,n.operation)));var c=e.copy(n.initialResponse);if(a)for(var s=0;s<c.length;s++)void 0!==c[s].Prefix&&(c[s].Filter={},c[s].Filter.Prefix=e.copy(c[s].Prefix),delete c[s].Prefix);var l=new r({stripWhitespaces:!1}),u=!1;if(n.isEditing){if(c[o.indexVal]=i,n.selectedRule.filterUsed){for(var s=0;s<n.initialResponse.length;s++)if(s!==o.indexVal&&!t.isEqual(n.initialResponse[s],c[s])){p.log(d.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,n.operation,{initialRule:n.initialResponse[s],finalRule:c[s]}),u=!0;break}}else for(var s=0;s<n.initialResponse.length;s++)if(s!==o.indexVal&&A(n.initialResponse[s],c[s])){p.log(d.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,n.operation,{initialRule:n.initialResponse[s],finalRule:c[s]}),u=!0;break}u?p.log("LifecycleRuleVerification",0,n.operation,{initialResponse:n.initialResponse,finalResponse:c}):(p.log("LifecycleRuleVerification",1,n.operation,{initialResponse:n.initialResponse,finalResponse:c}),n.operation.step=d.LIFECYCLE.EDIT_BUCKET_LIFECYCLE,y(c,l,i))}else{for(var s=0;s<n.initialResponse.length;s++)if(A(n.initialResponse[s],c[s])){p.log(d.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,n.operation,{initialRule:n.initialResponse[s],finalRule:c[s]}),u=!0;break}n.operation.step=d.LIFECYCLE.CREATE_BUCKET_LIFECYCLE,c.push(i),u?p.log("LifecycleRuleVerification",0,n.operation,{initialResponse:n.initialResponse,finalResponse:c}):(p.log("LifecycleRuleVerification",1,n.operation,{initialResponse:n.initialResponse,finalResponse:c}),y(c,l,i))}},n.showStep2CurrentVersionChange=function(){if(!n.selectedRule.showCurrent)for(var e=n.selectedRule.currentRuleActions.length,t=0;t<e;t++)n.removeCurrentRuleAction(0);n.selectedRule.expiration.enabled&&n.validateCurrentExpiration()},n.showStep2PreviousVersionChange=function(){if(!n.selectedRule.showPrevious)for(var e=n.selectedRule.noncurrentRuleActions.length,t=0;t<e;t++)n.removeNoncurrentRuleAction(0);n.selectedRule.permanentlyDelete.enabled&&n.validateNoncurrentExpiration()},n.showStep3CurrentVersionChange=function(){n.selectedRule.showStep3CurrentVersion?n.selectedRule.expiration.enabled||(n.selectedRule.expiration.enabled=!0,n.selectedRule.showRldm=!1,n.selectedRule.removeExpire=!1,a(function(){return i("#expiration-days input").focus()}),""===n.selectedRule.expiration.days&&S(n.selectedRule.expiration,n.selectedRule.currentRuleActions),n.updateNextButtonDisabled()):(n.selectedRule.expiration.enabled=!1,n.selectedRule.expiration.days="",n.selectedRule.showRldm=!0,n.notANumberErrorCurrent[d.LIFECYCLE.EXPIRE]=!1,n.minimumDaysCurrent[d.LIFECYCLE.EXPIRE]=!1,n.higherNumberErrorCurrent.Expire=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,n.updateNextButtonDisabled())},n.showStep3PreviousVersionChange=function(){n.selectedRule.showStep3PreviousVersion?n.selectedRule.permanentlyDelete.enabled||(n.selectedRule.permanentlyDelete.enabled=!0,a(function(){return i("#permanently-delete-days input").focus()}),""===n.selectedRule.permanentlyDelete.days&&S(n.selectedRule.permanentlyDelete,n.selectedRule.noncurrentRuleActions),n.updateNextButtonDisabled()):(n.selectedRule.permanentlyDelete.enabled=!1,n.selectedRule.permanentlyDelete.days="",n.notANumberErrorNoncurrent[d.LIFECYCLE.PERMANENTLY_DELETE]=!1,n.minimumDaysNoncurrent[d.LIFECYCLE.PERMANENTLY_DELETE]=!1,n.higherNumberErrorNoncurrent.PermanentlyDelete=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,n.updateNextButtonDisabled())},n.validateDays=function(e,t){if(t===d.LIFECYCLE.CURRENT){var r=n.selectedRule.currentRuleActions[e].action;return n.notANumberErrorCurrent.SIA=!1,n.notANumberErrorCurrent.INTELLIGENT_TIERING=!1,n.notANumberErrorCurrent.ONEZONEIA=!1,n.notANumberErrorCurrent.Glacier=!1,n.notANumberErrorCurrent.DEEP_ARCHIVE=!1,n.glacierMinDaysWarningCurrent=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.INTELLIGENT_TIERING]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.ONEZONEIA]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DEEP_ARCHIVE]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,n.minimumDaysCurrent.SIA=!1,n.minimumDaysCurrent.INTELLIGENT_TIERING=!1,n.minimumDaysCurrent.ONEZONEIA=!1,n.minimumDaysCurrent[r]=!1,n.minimumDaysCurrent.Glacier=!1,n.minimumDaysCurrent.DEEP_ARCHIVE=!1,n.higherNumberErrorCurrent.SIA=!1,n.higherNumberErrorCurrent.INTELLIGENT_TIERING=!1,n.higherNumberErrorCurrent.ONEZONEIA=!1,n.higherNumberErrorCurrent.Glacier=!1,n.higherNumberErrorCurrent.DEEP_ARCHIVE=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.selectedRule.currentRuleActions.length>0&&""!==n.selectedRule.currentRuleActions[e].action&&(isNaN(parseInt(n.selectedRule.currentRuleActions[e].value),10)||n.selectedRule.currentRuleActions[e].value%1!=0||-1!==n.selectedRule.currentRuleActions[e].value.indexOf(d.LIFECYCLE.EXPONENTIAL)?(n.notANumberErrorCurrent[r]=!0,n.highlightTextBoxErrorCurrent[e]=!0):n.selectedRule.currentRuleActions[e].value>d.LIFECYCLE.MAX_DAYS_ALLOWED?(n.higherNumberErrorCurrent[r]=!0,n.highlightTextBoxErrorCurrent[e]=!0):n.selectedRule.currentRuleActions[e].value<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[n.selectedRule.currentRuleActions[e].action]?(n.minimumDaysCurrent[r]=!0,n.highlightTextBoxErrorCurrent[e]=!0):O(n.selectedRule.currentRuleActions,n.selectedRule.expiration.days,n.greaterThanCurrentError,n.highlightTextBoxErrorCurrent,n.minimumDaysCurrent,d.LIFECYCLE.CURRENT)),n.updateNextButtonDisabled(),k(d.LIFECYCLE.CURRENT)}var i=n.selectedRule.noncurrentRuleActions[e].action;return n.notANumberErrorNoncurrent.SIA=!1,n.notANumberErrorNoncurrent.INTELLIGENT_TIERING=!1,n.notANumberErrorNoncurrent.ONEZONEIA=!1,n.notANumberErrorNoncurrent.Glacier=!1,n.notANumberErrorNoncurrent.DEEP_ARCHIVE=!1,n.glacierMinDaysWarningNonCurrent=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.INTELLIGENT_TIERING]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.ONEZONEIA]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DEEP_ARCHIVE]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,n.minimumDaysNoncurrent.SIA=!1,n.minimumDaysNoncurrent.INTELLIGENT_TIERING=!1,n.minimumDaysNoncurrent.ONEZONEIA=!1,n.minimumDaysNoncurrent.Glacier=!1,n.minimumDaysNoncurrent.DEEP_ARCHIVE=!1,n.higherNumberErrorNoncurrent.SIA=!1,n.higherNumberErrorNoncurrent.INTELLIGENT_TIERING=!1,n.higherNumberErrorNoncurrent.ONEZONEIA=!1,n.higherNumberErrorNoncurrent.Glacier=!1,n.higherNumberErrorNoncurrent.DEEP_ARCHIVE=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.selectedRule.noncurrentRuleActions.length>0&&""!==n.selectedRule.noncurrentRuleActions[e].action&&(isNaN(parseInt(n.selectedRule.noncurrentRuleActions[e].value),10)||n.selectedRule.noncurrentRuleActions[e].value%1!=0||-1!==n.selectedRule.noncurrentRuleActions[e].value.indexOf(d.LIFECYCLE.EXPONENTIAL)?(n.notANumberErrorNoncurrent[i]=!0,n.highlightTextBoxErrorNonCurrent[e]=!0):n.selectedRule.noncurrentRuleActions[e].value>d.LIFECYCLE.MAX_DAYS_ALLOWED?(n.higherNumberErrorNoncurrent[i]=!0,n.highlightTextBoxErrorNonCurrent[e]=!0):n.selectedRule.noncurrentRuleActions[e].value<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[n.selectedRule.noncurrentRuleActions[e].action]?(n.minimumDaysNoncurrent[i]=!0,n.highlightTextBoxErrorNonCurrent[e]=!0):O(n.selectedRule.noncurrentRuleActions,n.selectedRule.permanentlyDelete.days,n.greaterThanNonCurrentError,n.highlightTextBoxErrorNonCurrent,n.minimumDaysNoncurrent,d.LIFECYCLE.NONCURRENT)),n.updateNextButtonDisabled(),k(d.LIFECYCLE.NONCURRENT)},n.validateCurrentExpiration=function(){n.notANumberErrorCurrent.Expire=!1,n.minimumDaysCurrent.Expire=!1,n.greaterThanCurrentError.DeleteGreaterThanSIA=!1,n.greaterThanCurrentError.DeleteGreaterThanGlacier=!1,n.higherNumberErrorCurrent.Expire=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,isNaN(n.selectedRule.expiration.days)||n.selectedRule.expiration.days%1!=0||-1!==n.selectedRule.expiration.days.indexOf(d.LIFECYCLE.EXPONENTIAL)?(n.notANumberErrorCurrent.Expire=!0,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):n.selectedRule.expiration.days>d.LIFECYCLE.MAX_DAYS_ALLOWED?(n.higherNumberErrorCurrent.Expire=!0,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):n.selectedRule.expiration.days<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[d.LIFECYCLE.EXPIRE]?(n.minimumDaysCurrent.Expire=!0,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):O(n.selectedRule.currentRuleActions,n.selectedRule.expiration.days,n.greaterThanCurrentError,n.highlightTextBoxErrorCurrent,n.minimumDaysCurrent,d.LIFECYCLE.CURRENT),n.updateNextButtonDisabled()},n.validateNoncurrentExpiration=function(){n.notANumberErrorNoncurrent.PermanentlyDelete=!1,n.minimumDaysNoncurrent.PermanentlyDelete=!1,n.greaterThanNonCurrentError.DeleteGreaterThanSIA=!1,n.greaterThanNonCurrentError.DeleteGreaterThanGlacier=!1,n.higherNumberErrorNoncurrent.PermanentlyDelete=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1,isNaN(n.selectedRule.permanentlyDelete.days)||n.selectedRule.permanentlyDelete.days%1!=0||-1!==n.selectedRule.permanentlyDelete.days.indexOf(d.LIFECYCLE.EXPONENTIAL)?(n.notANumberErrorNoncurrent.PermanentlyDelete=!0,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):n.selectedRule.permanentlyDelete.days>d.LIFECYCLE.MAX_DAYS_ALLOWED?(n.higherNumberErrorNoncurrent.PermanentlyDelete=!0,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):n.selectedRule.permanentlyDelete.days<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[d.LIFECYCLE.PERMANENTLY_DELETE]?(n.minimumDaysNoncurrent.PermanentlyDelete=!0,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!0):O(n.selectedRule.noncurrentRuleActions,n.selectedRule.permanentlyDelete.days,n.greaterThanNonCurrentError,n.highlightTextBoxErrorNonCurrent,n.minimumDaysNoncurrent,d.LIFECYCLE.NONCURRENT),n.updateNextButtonDisabled()},n.updateNextButtonDisabled=function(){n.selectedRule.isNextButtonDisabled=!1,a(L)},n.validateAmuDays=function(){isNaN(n.selectedRule.amu.days)?(n.amuError=!0,n.notANumberAmuError=!0):n.selectedRule.amu.days<d.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.AMU?(n.amuError=!0,n.minimumDaysAmuError=!0):n.selectedRule.amu.days>d.LIFECYCLE.MAX_DAYS_ALLOWED?(n.amuError=!0,n.higherNumberErrorAmu=!0):(n.notANumberAmuError=!1,n.minimumDaysAmuError=!1,n.higherNumberErrorAmu=!1,n.amuError=!1),n.updateNextButtonDisabled()},n.selectCurrentExpiration=function(){n.selectedRule.expiration.enabled?(n.selectedRule.removeExpire=!1,n.selectedRule.showRldm=!1,""===n.selectedRule.expiration.days&&S(n.selectedRule.expiration,n.selectedRule.currentRuleActions)):(n.selectedRule.expiration.days="",n.selectedRule.showRldm=!0,n.notANumberErrorCurrent[d.LIFECYCLE.EXPIRE]=!1,n.minimumDaysCurrent[d.LIFECYCLE.EXPIRE]=!1,n.higherNumberErrorCurrent.Expire=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanCurrentError[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.highlightTextBoxErrorCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1),n.updateNextButtonDisabled()},n.selectNoncurrentExpiration=function(){n.selectedRule.permanentlyDelete.enabled?""===n.selectedRule.permanentlyDelete.days&&S(n.selectedRule.permanentlyDelete,n.selectedRule.noncurrentRuleActions):(n.selectedRule.permanentlyDelete.days="",n.notANumberErrorNoncurrent[d.LIFECYCLE.PERMANENTLY_DELETE]=!1,n.minimumDaysNoncurrent[d.LIFECYCLE.PERMANENTLY_DELETE]=!1,n.higherNumberErrorNoncurrent.PermanentlyDelete=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=!1,n.greaterThanNonCurrentError[d.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=!1,n.highlightTextBoxErrorNonCurrent[d.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=!1),n.updateNextButtonDisabled()},n.selectAmuAction=function(){n.selectedRule.amu.enabled?t.isEmpty(n.selectedRule.amu.days)&&(n.selectedRule.amu.days=d.LIFECYCLE.AMU_DEFAULT_DAYS):(n.selectedRule.amu.days="",n.notANumberAmuError=!1,n.minimumDaysAmuError=!1,n.higherNumberErrorAmu=!1),n.updateNextButtonDisabled()},R(),function(){n.showOldUI=!l.isFeatureEnabled(d.FAC.OBJECT_TAGGING)}(),n.goToPreviousStep=function(){n.lifecycleError=void 0,n.previousState(),n.updateNextButtonDisabled()},n.closeLifecycleModal=function(){R(),n.isOpen.flag=!1,n.state=n.STEP.NAME_AND_SCOPE,n.selectedRule=void 0,n.lifecycleError=void 0,n.showContinue=!1,n.showOverlappingPrefixWarning=!1,n.showOverlappingNewFormatWarning=!1,n.showFinishSelectionWarning=!1,n.showV2FormatWarning=!1,n.overlappingRule="",n.stateChangeWarning=void 0,n.currentGlacierGreaterThanSIAValue="",n.expireGreaterThanSIAValue="",n.expireGreaterThanGlacierValue="",n.glacierMinDaysWarningCurrentValue="",n.glacierMinDaysWarningNonCurrentValue="",n.noncurrentGlacierGreaterThanSIAValue="",n.permanentlyDeleteGreaterThanSIAValue="",n.permanentlyDeleteGreaterThanGlacierValue="",n.clearLDMAMUWarning=!1},n.getOverLappingPrefixDocUrl=function(){return g.getDocUrl(d.LEARN_MORE_LINKS.LIFECYCLE_OVERLAPPING_RULE)}}e.module("s3").directive("lifecycleModal",[function(){return{restrict:"E",scope:{isOpen:"=",selectedRule:"=",initialResponse:"=",initialize:"=",isEditing:"=",initialXml:"=",operation:"=",disableEdit:"=",disableDelete:"=",ruleToBeEdited:"=",moreOptions:"="},template:n(720),controller:"LifecycleModalController"}}]),e.module("s3").controller("LifecycleModalController",["$scope","$timeout","$translate","BucketPropertiesService","BucketPropertiesUtilService","FAC","PathService","S3Constants","SCLogService","UtilService","AwsUrlsService",a])}()}).call(t,n(0),n(2),n(100),n(6))},function(e,t){e.exports="<modal id=lifecycle-modal class=lifecycle-modal ng-class=\"{'overflow-y-visible': state===STEP.NAME_AND_SCOPE}\" is-open=isOpen steps=STEP state=state close-callback=closeLifecycleModal header-title=headerTitle next-state=nextState previous-state=previousState set-state=setState> <modal-content> <div class=lifecycle-modal-content> <div class=body-content ng-if=\"state === STEP.NAME_AND_SCOPE\"> <p class=label translate=lifecyclemodal.label.policyname></p> <awsui-textfield id=rule-name class=policy-name change=updateNextButtonDisabled() ng-model=selectedRule.ID placeholder=\"{{'lifecyclemodal.placeholder.policyname' | translate}}\"> </awsui-textfield> <table> <tr> <td> <p class=label translate=lifecyclemodal.label.applypolicy></p> </td> <td class=tool-tip-text-subheader> <awsui-tooltip text=\"{{ 'lifecyclemodal.prefixtag.tooltip' | translate }}\" position=right size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </td> </tr> </table> <div ng-if=showOldUI fac=s3-ot fac-toggle> <awsui-radio-group class=step1-radio-buttons ng-model=selectedRule.applied change=updateNextButtonDisabled()> <awsui-radio-button class=step1-radio-buttons value=whole ng-model=selectedRule.applied label=\"{{ 'lifecyclemodal.step1.wholebucket' | translate }}\"></awsui-radio-button> <awsui-radio-button class=step1-radio-buttons value=prefix ng-model=selectedRule.applied label=\"{{ 'lifecyclemodal.step1.prefix' | translate }}\"></awsui-radio-button> </awsui-radio-group> <awsui-textfield ng-if=\"selectedRule.applied === 'prefix'\" change=updateNextButtonDisabled() class=policy-name autocomplete=true ng-model=selectedRule.Prefix placeholder=\"{{'lifecyclemodal.placeholder.prefix' | translate}}\"> </awsui-textfield> </div> <div ng-if=!showOldUI class=tag-search> <search fac-id=s3-ot fetch-one-page-prefix=fetchOnePagePrefix(prefix) fetch-one-page-tag=fetchOnePageTag() filters=selectedRule.filters markers=markers tag-continuation-tokens=tagContinuationTokens no-backend-calls=true enforce-selection=updateNextButtonDisabled() search-error=tag.error tag-search-selected=tagSearchSelected show-tag=showTag> </search> </div> <awsui-alert visible=showFinishSelectionWarning type=warning id=finish-filter-selection-warning> {{ 'lifecyclemodal.warning.finishselectionwarning' | translate }} </awsui-alert> <awsui-alert visible=showV2FormatWarning type=warning> {{ 'lifecyclemodal.warning.newformatwarning' | translate }} </awsui-alert> <awsui-alert visible=clearLDMAMUWarning type=warning> {{ 'lifecyclemodal.warning.removeldmamu' | translate }} </awsui-alert> </div> <div class=body-content ng-if=\"state === STEP.TRANSITION\"> <div class=lifecycle-step2-header> <h1 class=configure-label translate=lifecyclemodal.step2.storageclasstransition></h1> <span translate=lifecyclemodal.step2.transiton.desc></span> <span translate=lifecyclemodal.step2.transiton.desc_2 translate-compile translate-values=\"{ learnMoreLink: transitionsLearnMoreLink, pricingLink: s3PricingLink }\"></span> </div> <table class=upload-modal-radio-button-properties> <tr> <td> <awsui-checkbox id=current-version-transition class=step2-radio-label ng-model=selectedRule.showCurrent change=showStep2CurrentVersionChange()> <span class=show-version translate=lifecyclemodal.step2.current></span> </awsui-checkbox> </td> <td class=show-previous> <awsui-checkbox id=previous-version-transition class=step2-radio-label ng-model=selectedRule.showPrevious change=showStep2PreviousVersionChange()> <span class=show-version translate=lifecyclemodal.step2.noncurrent></span> </awsui-checkbox> </td> </tr> </table> <div class=review-section-header></div> <div ng-if=selectedRule.showCurrent> <div> <span class=current-version-label>{{'lifecyclemodal.step2.currentversion' | translate}} </span> <span class=add-transition> <a id=add-current-transition ng-class=\"{ 'add-disabled' : selectedRule.isAddCurrentTransitionDisabled }\" ng-click=addCurrentRuleAction()> {{'lifecyclemodal.step2.addtransition' | translate}}</a> </span> </div> <div class=modal-content-divider></div> <awsui-alert type=error visible=notANumberErrorCurrent.SIA header=\"{{ 'lifecyclemodal.step2.numbersiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorCurrent.INTELLIGENT_TIERING header=\"{{ 'lifecyclemodal.step2.number_isidore_errorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorCurrent.ONEZONEIA header=\"{{ 'lifecyclemodal.step2.numberonezoneiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorCurrent.Glacier header=\"{{ 'lifecyclemodal.step2.numberglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorCurrent.DEEP_ARCHIVE header=\"{{ 'lifecyclemodal.step2.numberglacierdeeparchiveerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.SIA header=\"{{ 'lifecyclemodal.step2.minimumdayssiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.INTELLIGENT_TIERING header=\"{{ 'lifecyclemodal.step2.minimumdays_isidore_errorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.ONEZONEIA header=\"{{ 'lifecyclemodal.step2.minimumdaysonezoneiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.Glacier header=\"{{ 'lifecyclemodal.step2.minimumdaysglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysglaciererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.DEEP_ARCHIVE header=\"{{ 'lifecyclemodal.step2.minimumdaysglacierdeeparchiveerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysglaciererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=\"higherNumberErrorCurrent.SIA || higherNumberErrorCurrent.ISIDORE || higherNumberErrorCurrent.ONEZONEIA || higherNumberErrorCurrent.Glacier || higherNumberErrorCurrent.DEEP_ARCHIVE\" header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=greaterThanCurrentError.GlacierGreaterThanSIA header=\"{{ 'lifecyclemodal.step2.glaciergreaterthansiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.glaciergreaterthansiaerrormessage' | translate }} {{ currentGlacierGreaterThanSIAValue }} </awsui-alert> <awsui-alert type=error visible=glacierMinDaysWarningCurrent header=\"{{ 'lifecyclemodal.step2.gdagreaterthanglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.gdagreaterthanglaciererrormessage' | translate }} {{ glacierMinDaysWarningCurrentValue }}</awsui-alert> <awsui-alert type=error visible=currentError header=\"{{ 'lifecyclemodal.step2.noruleactionerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.selectruleactionerror'| translate }} </awsui-alert> <p ng-if=\"selectedRule.currentRuleActions.length === 0\" class=empty-transitions translate=lifecyclemodal.step2.emptycurrenttransitions></p> <table class=lifecycle-table> <tr ng-if=\"selectedRule.currentRuleActions.length !== 0\"> <td id=object-creation class=options translate=lifecyclemodal.objectcreated></td> <td class=object-created-days translate=lifecyclemodal.step2.daysafterobjectcreation></td> </tr> </table> <table class=lifecycle-table style=\"border-collapse:separate;border-spacing:0 10px\"> <tr ng-repeat=\"action in selectedRule.currentRuleActions\"> <td class=transition-options> <awsui-select class=lifecycle-modal-select change=selectCurrentRuleAction(selectedRule.currentRuleActions[$index].action,$index) items=selectedRule.currentRuleOptions[$index] ng-model=selectedRule.currentRuleActions[$index].action placeholder=\"{{'lifecyclemodal.selectrule' | translate}}\"></awsui-select> </td> <td class=object-transition-days> <awsui-textfield ng-class=\"{ 'highlight-error' : highlightTextBoxErrorCurrent[$index] }\" placeholder=\"{{'lifecyclemodal.days' | translate}}\" class=lifecycle-modal-input ng-model=selectedRule.currentRuleActions[$index].value disabled=\"selectedRule.currentRuleActions[$index].action === ''\" ng-keyup=\"validateDays($index, 'current')\"> </awsui-textfield> <span class=close-transition ng-click=removeCurrentRuleAction($index)> X </span> </td> </tr> </table> <div ng-if=\"selectedRule.currentRuleActions.length === 0\" class=modal-section></div> </div> <div ng-if=selectedRule.showPrevious style=padding-top:15px> <div> <span class=current-version-label>{{'lifecyclemodal.step2.previousversion' | translate}} </span> <span class=add-transition> <a ng-class=\"{ 'add-disabled' : selectedRule.isAddPrevTransitionDisabled }\" ng-click=addNoncurrentRuleAction()> {{'lifecyclemodal.step2.addtransition' | translate}} </a> </span> </div> <div class=modal-content-divider></div> <p ng-if=\"selectedRule.noncurrentRuleActions.length === 0\" class=empty-transitions translate=lifecyclemodal.step2.emptynoncurrenttransitions></p> <table class=lifecycle-table> <tr ng-if=\"selectedRule.noncurrentRuleActions.length !== 0\"> <td class=options translate=lifecyclemodal.objectbecomespreviousversion></td> <td class=object-created-days translate=lifecyclemodal.step2.daysafterobjectnoncurrent></td> </tr> </table> <table class=lifecycle-table style=\"border-collapse:separate;border-spacing:0 10px\"> <tr ng-repeat=\"action in selectedRule.noncurrentRuleActions\"> <td class=transition-options><awsui-select class=lifecycle-modal-select change=\"selectNoncurrentRuleAction(selectedRule.noncurrentRuleActions[$index].action, $index)\" items=selectedRule.noncurrentRuleOptions[$index] ng-model=selectedRule.noncurrentRuleActions[$index].action placeholder=\"{{'lifecyclemodal.selectrule' | translate}}\"></awsui-select> <div ng-if=selectedRule.noncurrentRuleActions[$index].showRldm><awsui-checkbox ng-model=selectedRule.noncurrentRuleActions[$index].removeExpire>{{ 'lifecyclemodal.removeexpire' | translate }}</awsui-checkbox></div> </td> <td ng-class=\"{ 'object-transition-days' : !selectedRule.noncurrentRuleActions[$index].showRldm , 'remove-expire' : selectedRule.noncurrentRuleActions[$index].showRldm }\"> <awsui-textfield ng-class=\"{ 'highlight-error' : highlightTextBoxErrorNonCurrent[$index] }\" placeholder=\"{{'lifecyclemodal.days' | translate}}\" class=\"text-input lifecycle-modal-input\" ng-model=selectedRule.noncurrentRuleActions[$index].value disabled=\"selectedRule.noncurrentRuleActions[$index].action === ''\" ng-keyup=\"validateDays($index,'nonCurrent')\"> </awsui-textfield> <span class=close-transition ng-click=removeNoncurrentRuleAction($index)> X </span> </td> </tr> </table> <awsui-alert type=error visible=notANumberErrorNoncurrent.SIA header=\"{{ 'lifecyclemodal.step2.numbersiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorNoncurrent.INTELLIGENT_TIERING header=\"{{ 'lifecyclemodal.step2.number_isidore_errorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorNoncurrent.ONEZONEIA header=\"{{ 'lifecyclemodal.step2.numberonezoneiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorNoncurrent.Glacier header=\"{{ 'lifecyclemodal.step2.numberglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=notANumberErrorNoncurrent.DEEP_ARCHIVE header=\"{{ 'lifecyclemodal.step2.numberglacierdeeparchiveerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysNoncurrent.SIA header=\"{{ 'lifecyclemodal.step2.minimumdayssiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysNoncurrent.INTELLIGENT_TIERING header=\"{{ 'lifecyclemodal.step2.minimumdays_isidore_errorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysNoncurrent.ONEZONEIA header=\"{{ 'lifecyclemodal.step2.minimumdaysonezoneiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayssiaerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysNoncurrent.Glacier header=\"{{ 'lifecyclemodal.step2.minimumdaysglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysglaciererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysNoncurrent.DEEP_ARCHIVE header=\"{{ 'lifecyclemodal.step2.minimumdaysglacierdeeparchiveerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysglaciererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.SIA header=\"{{ 'lifecyclemodal.step2.numbersiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.INTELLIGENT_TIERING header=\"{{ 'lifecyclemodal.step2.number_isidore_errorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.ONEZONEIA header=\"{{ 'lifecyclemodal.step2.numberonezoneiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.Glacier header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.DEEP_ARCHIVE header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=glacierMinDaysWarningNonCurrent header=\"{{ 'lifecyclemodal.step2.gdagreaterthanglaciererrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.gdagreaterthanglaciererrormessage' | translate }} {{ glacierMinDaysWarningNonCurrentValue }}</awsui-alert> <awsui-alert type=error visible=greaterThanNonCurrentError.GlacierGreaterThanSIA header=\"{{ 'lifecyclemodal.step2.glaciergreaterthansiaerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.glaciergreaterthansiaerrormessage' | translate }} {{ noncurrentGlacierGreaterThanSIAValue }}</awsui-alert> <awsui-alert type=error visible=hasPrevError header=\"{{ 'lifecyclemodal.step2.noruleactionerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.selectruleactionerror'| translate }}</awsui-alert> <div ng-if=\"selectedRule.noncurrentRuleActions.length === 0\" class=modal-section></div> </div> </div> <div class=body-content ng-if=\"state === STEP.EXPIRATION\"> <p class=configure-expiration-label translate=lifecyclemodal.step3.configureexpiration></p> <table class=upload-modal-radio-button-properties> <tr> <td> <awsui-checkbox id=current-version-transition class=step2-radio-label ng-model=selectedRule.showStep3CurrentVersion change=showStep3CurrentVersionChange()> <span class=show-version translate=lifecyclemodal.step2.current></span> </awsui-checkbox> </td> <td class=show-previous> <awsui-checkbox id=previous-version-transition class=step2-radio-label ng-model=selectedRule.showStep3PreviousVersion change=showStep3PreviousVersionChange()> <span class=show-version translate=lifecyclemodal.step2.noncurrent></span> </awsui-checkbox> </td> </tr> </table> <div ng-show=selectedRule.showStep3CurrentVersion> <awsui-checkbox change=selectCurrentExpiration() class=step2-radio-label ng-model=selectedRule.expiration.enabled> <span class=expiration-label translate=lifecyclemodal.expirecurrentversion></span> <span class=tool-tip-cursor> <awsui-tooltip text=\"{{ 'lifecyclemodal.expirecurrobjs.tooltip' | translate }}\" position=bottom size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </span> </awsui-checkbox> <div ng-show=selectedRule.expiration.enabled> <span class=expiration-after translate=lifecyclemodal.step3.after></span> <span> <awsui-textfield id=expiration-days class=\"expiration-days lifecycle-modal-input\" ng-class=\"{ 'highlight-error' : highlightTextBoxErrorCurrent[99] }\" ng-keyup=validateCurrentExpiration() ng-model=selectedRule.expiration.days> </awsui-textfield> </span> <span class=from-object-creation translate=lifecyclemodal.fromobjectcreation></span> </div> <awsui-alert type=error visible=notANumberErrorCurrent.Expire header=\"{{ 'lifecyclemodal.step2.numberexpireerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysCurrent.Expire header=\"{{ 'lifecyclemodal.step2.minimumdaysexpireerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysexpireerrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorCurrent.Expire header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=greaterThanCurrentError.DeleteGreaterThanGlacier> {{ 'lifecyclemodal.step2.expiregreaterthanglaciererrormessage' | translate }} {{ expireGreaterThanGlacierValue }} </awsui-alert> <awsui-alert type=error visible=greaterThanCurrentError.DeleteGreaterThanSIA> {{ 'lifecyclemodal.step2.expiregreaterthansiaerrormessage' | translate }} {{ expireGreaterThanSIAValue }} </awsui-alert> </div> <div ng-show=selectedRule.showStep3PreviousVersion> <awsui-checkbox class=step2-radio-label change=selectNoncurrentExpiration() class=step2-radio-label ng-model=selectedRule.permanentlyDelete.enabled> <span class=expiration-label> {{ 'lifecyclemodal.step3.permanentlydelete' | translate }} </span> <span class=tool-tip-cursor> <awsui-tooltip text=\"{{ 'lifecyclemodal.delprevversions.tooltip' | translate }}\" position=bottom size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </span> </awsui-checkbox> <div ng-show=selectedRule.permanentlyDelete.enabled> <span class=expiration-after translate=lifecyclemodal.step3.after></span> <span> <awsui-textfield id=permanently-delete-days class=\"expiration-days lifecycle-modal-input\" ng-class=\"{ 'highlight-error' : highlightTextBoxErrorNonCurrent[99] }\" ng-keyup=validateNoncurrentExpiration() ng-model=selectedRule.permanentlyDelete.days> </awsui-textfield> </span> <span class=from-object-creation translate=lifecyclemodal.step3.afterbecomingpreviousversion></span> </div> <awsui-alert type=error visible=minimumDaysNoncurrent.PermanentlyDelete header=\"{{ 'lifecyclemodal.step2.minimumdayspermanentlydeleteerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdayspermanentlydeleteerrormessage' | translate }}</awsui-alert> <awsui-alert type=error visible=notANumberErrorNoncurrent.PermanentlyDelete header=\"{{ 'lifecyclemodal.step2.numberpermanentlydeleteerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorNoncurrent.PermanentlyDelete header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=greaterThanNonCurrentError.DeleteGreaterThanSIA> {{ 'lifecyclemodal.step2.permanentlydeletegreaterthansiaerrormessage' | translate }} {{ permanentlyDeleteGreaterThanSIAValue }} </awsui-alert> <awsui-alert type=error visible=greaterThanNonCurrentError.DeleteGreaterThanGlacier> {{ 'lifecyclemodal.step2.permanentlydeletegreaterthanglaciererrormessage' | translate }} {{ permanentlyDeleteGreaterThanGlacierValue }} </awsui-alert> </div> <p class=for-amu translate=lifecyclemodal.step3.ldmamucleanup></p> <awsui-checkbox id=cleanup-expired data-disabled=\"(!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0))\" class=expiration-after-section change=updateNextButtonDisabled() ng-model=selectedRule.removeExpire> <span ng-class=\"{ 'disable-text' : (!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0)) }\" class=expiration-label translate=lifecyclemodal.step3.ldmcleanup></span> <span class=tool-tip-cursor> <awsui-tooltip text=\"{{ 'lifecyclemodal.cleanupldm.tooltip' | translate }}\" position=bottom size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </span> </awsui-checkbox> <awsui-alert class=modal-warning visible=\"(!selectedRule.showRldm && !(selectedRule.filters.tagFilters.length > 0))\" type=warning> {{ 'lifecyclemodal.warning.disableldmexpire' | translate }} </awsui-alert> <awsui-checkbox id=cleanup-multipart data-disabled=\"(selectedRule.filters.tagFilters.length > 0)\" class=expiration-after-section change=selectAmuAction() ng-model=selectedRule.amu.enabled> <span ng-class=\"{ 'disable-text' : (selectedRule.filters.tagFilters.length > 0) }\" class=expiration-label translate=lifecyclemodal.step3.imucleanup></span> <span class=tool-tip-cursor> <awsui-tooltip text=\"{{ 'lifecyclemodal.cleanupuploads.tooltip' | translate }}\" position=bottom size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </span> </awsui-checkbox> <div id=cleanup-multipart-days ng-if=selectedRule.amu.enabled> <span class=expiration-after translate=lifecyclemodal.step3.after></span> <span class=add-days-in-textfield> <awsui-textfield ng-keyup=validateAmuDays() id=incomplete-multipart-days class=\"expiration-days date-styling-override lifecycle-modal-input\" ng-model=selectedRule.amu.days> </awsui-textfield> <span class=span-days translate=initiaterestoremodal.placeholder.numOfDays></span> </span> <span class=from-object-creation translate=lifecyclemodal.step3.fromstartofupload></span> </div> <awsui-alert type=error visible=notANumberAmuError header=\"{{ 'lifecyclemodal.step2.numberamuerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.numbererrormessage' | translate }} </awsui-alert> <awsui-alert type=error visible=minimumDaysAmuError header=\"{{ 'lifecyclemodal.step2.minimumdaysamuerrorheader' | translate }}\"> {{ 'lifecyclemodal.step2.minimumdaysamuerrormessage' | translate }} </awsui-alert> <awsui-alert class=modal-warning visible=\"(selectedRule.filters.tagFilters.length > 0)\" type=warning> {{ 'lifecyclemodal.warning.disableldmandamu' | translate }} </awsui-alert> <awsui-alert type=error visible=higherNumberErrorAmu header=\"{{ 'lifecyclemodal.highernumbererrorheader' | translate }}\"> {{ 'lifecyclemodal.highernumbererrormessage' | translate }} </awsui-alert> </div> <div class=body-content ng-if=\"state === STEP.REVIEW\"> <awsui-alert visible=lifecycleError class=\"block small-top-margin\" type=error dismissible=false header=\"{{ 'lifecyclemodal.step3.error.header' | translate }}\"> {{ lifecycleError }} </awsui-alert> <awsui-alert visible=stateChangeWarning type=warning> {{ stateChangeWarning }}</awsui-alert> <awsui-alert visible=showOverlappingPrefixWarning type=warning> <div translate=lifecyclemodal.warning.overlappingprefix translate-values=\"{ overlappingRule : overlappingRule }\"> </div> <div ng-if=showOverlappingNewFormatWarning translate=lifecyclemodal.warning.overlappingprefixnewformatwarning> </div> <awsui-button target=_blank href=\"{{ getOverLappingPrefixDocUrl() }}\" variant=link icon=external-link> <span translate>learn.more</span> </awsui-button> </awsui-alert> <table id=review-table class=review-table> <tr> <td class=review-subheader translate=lifecyclemodal.label.nameandscope></td> <td class=edit-button> <awsui-button class=button-in-darkbg text=\"{{ 'lifecyclemodal.button.edit' | translate }}\" variant=link ng-click=setState(STEP.NAME_AND_SCOPE)> </awsui-button> </td> </tr> </table> <table class=details-table> <tr> <td><span class=detail-name translate=lifecyclemodal.step3.label.name></span><span class=details> {{ selectedRule.summary.ruleName }} </span></td> </tr> <tr> <td class=scope-name><span class=detail-name translate=lifecyclemodal.step3.label.scope></span><span class=details> {{ selectedRule.summary.prefix }} </span></td> </tr> </table> <table class=review-table> <tr> <td class=review-rule translate=lifecyclemodal.label.rule></td> <td class=edit-button> <awsui-button class=button-in-darkbg text=\"{{ 'lifecyclemodal.button.edit' | translate }}\" variant=link click=setState(STEP.TRANSITION)> </awsui-button> </td> </tr> </table> <div class=review-content></div> <p ng-if=selectedRule.summary.currentVersionHeader class=\"review-subheader version-header\" translate=lifecyclemodal.currentversion></p> <div class=review-content ng-repeat=\"currentTransition in selectedRule.summary.currentTransitionsList\"> <div class=\"review-subheader review-content-description\" ng-if=\"currentTransition !== ''\"> <span class=review-content-header translate=lifecyclemodal.review.transition></span> <span class=transition-details> {{ currentTransition }} </span> </div> </div> <p ng-if=selectedRule.summary.noncurrentVersionHeader class=\"review-subheader version-header review-section-header\" translate=lifecyclemodal.noncurrentversion></p> <div class=review-content ng-repeat=\"nonCurrentTransition in  selectedRule.summary.noncurrentTransitionsList\"> <div class=\"review-subheader review-content-description\" ng-if=\"nonCurrentTransition !== ''\"> <span class=review-content-header translate=lifecyclemodal.review.transition></span> <span class=transition-details> {{ nonCurrentTransition }} </span> </div> </div> <table class=review-table style=margin-top:20px> <tr> <td class=review-rule translate=lifecyclemodal.expiration></td> <td class=edit-button> <awsui-button class=button-in-darkbg text=\"{{ 'lifecyclemodal.button.edit' | translate }}\" variant=link click=setState(STEP.EXPIRATION)> </awsui-button> </td> </tr> </table> <div class=review-content-description ng-if=\"(!selectedRule.expiration.enabled && !selectedRule.permanentlyDelete.enabled && !selectedRule.summary.rldm && (selectedRule.summary.amu === '')) \" translate=lifecyclemodal.noexpiration.configuration> </div> <div class=review-content ng-if=\"(selectedRule.expiration.enabled && selectedRule.expiration.days !=='')\"> <div class=\"review-subheader review-content-description\"> <span class=review-content-header translate=lifecyclemodal.expire></span> <span class=transition-details> {{ selectedRule.expiration.days }} </span> <span translate=lifecyclemodal.days></span> </div> </div> <div class=review-content ng-if=\"(selectedRule.permanentlyDelete.enabled && selectedRule.permanentlyDelete.days !=='')\"> <div class=review-content-description> <span class=review-content-header translate=lifecyclemodal.permanentlydelete></span> <span class=transition-details> {{ selectedRule.permanentlyDelete.days }} </span> <span translate=lifecyclemodal.days></span> </div> </div> <div ng-if=selectedRule.summary.rldm class=review-content-description translate=lifecyclemodal.step3.ldmcleanup></div> <div ng-if=\"selectedRule.summary.amu !== ''\"> <div class=review-content-description> <span class=review-content-header translate=lifecyclemodal.step3.imucleanup></span> <span translate=lifecyclemodal.step3.afterdays></span> <span class=transition-details> {{ selectedRule.summary.amu }} </span> <span translate=lifecyclemodal.days></span> </div> </div> </div> </div> </modal-content> <modal-footer> <div class=lifecycle-modal-footer transclude-name=footer> <awsui-button id=next-step ng-if=\"state !== STEP.REVIEW\" data-disabled=\"((state === STEP.NAME_AND_SCOPE && (!selectedRule.ID || (selectedRule.applied === 'prefix' && !selectedRule.Prefix)\n                      || tag.error !== ''))\n                      || selectedRule.isNextButtonDisabled)\" variant=primary text=\"{{ 'lifecyclemodal.footer.next' | translate }}\" class=\"awsui-util-f-r primary-button\" click=generateSummary()> </awsui-button> <awsui-button id=save-rule ng-if=\"state === STEP.REVIEW && !showContinue\" click=detectStateChange() variant=primary text=\"{{ 'lifecyclemodal.footer.save' | translate }}\" class=\"awsui-util-f-r primary-button\"> </awsui-button> <awsui-button id=continue-rule ng-if=\"state === STEP.REVIEW && showContinue\" click=saveLifecycle() variant=primary text=\"{{ 'lifecyclemodal.footer.continue' | translate }}\" class=\"awsui-util-f-r primary-button\"> </awsui-button> <awsui-button id=cancel-rule text=\"{{ 'lifecyclemodal.footer.cancel' | translate }}\" variant=normal ng-if=\"state === STEP.NAME_AND_SCOPE\" class=awsui-util-f-r click=closeLifecycleModal()> </awsui-button> <awsui-button id=previous-step text=\"{{ 'lifecyclemodal.footer.previous' | translate }}\" variant=normal ng-if=\"state !== STEP.NAME_AND_SCOPE\" class=awsui-util-f-r click=goToPreviousStep()> </awsui-button> </div> </modal-footer> </modal>"},function(e,t,n){"use strict";(function(e,t,r){!function(){e.module("s3").directive("lifecycleConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",initialResponse:"=",initialize:"=",initialXml:"=",selectedRule:"=",selectedRuleIndex:"=",actionType:"=",headerTitle:"=",listRules:"=",ruleToBeEdited:"=",disableEdit:"=",disableDelete:"=",moreOptions:"=",operation:"="},template:n(722),controller:"LifecycleConfirmationModalController"}}),e.module("s3").controller("LifecycleConfirmationModalController",["$scope","$filter","$translate","BucketPropertiesService","PathService","ConsoleOperation","S3Constants","SCLogService",function(n,i,a,o,s,c,l,u){function d(){n.lifecycleError=void 0,n.showContinue=!1,n.stateChangeWarning=void 0,n.saveLifecycle()}function p(){n.showContinue=!0,n.stateChangeWarning=a.instant("lifecyclemodal.step3.statechange")}function f(){n.lifecycleError=void 0,n.ruleToBeEdited=void 0,n.disableEdit=!0,n.disableDelete=!0,n.moreOptions[0].disabled=!0,n.moreOptions[1].disabled=!0,n.initialize(),n.closeConfirmationModal()}function g(e){return 1===n.initialResponse.length&&t.isEmpty(e)}function m(e){for(var r=0;r<n.initialResponse.length;r++)if(r!==n.selectedRuleIndex&&!t.isEqual(n.initialResponse[r],e[r]))return u.log(l.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,n.operation,{initialRule:n.initialResponse[r],finalRule:e[r]}),!0;return!1}function h(r){var i=e.copy(n.initialResponse);return i.splice(n.selectedRuleIndex,1),!t.isEqual(i,r)&&!g(r)&&(u.log(l.METRIC_NAME.LIFECYCLE_DELETE_MISMATCH,1,n.operation,{selectedRuleIndex:n.selectedRuleIndex,initialConfig:i,finalConfig:r}),!0)}n.closeConfirmationModal=function(){n.isOpen.flag=!1,n.showContinue=!1,n.stateChangeWarning=void 0,n.selectedRuleIndex=void 0,n.selectedRule=void 0,n.lifecycleError=void 0},n.detectStateChange=function(){n.operation.step=l.LIFECYCLE.GET_BUCKET_LIFECYCLE,o.getBucketLifecycle(s.getCurrentBucket(),n.operation).then(function(e){e===n.initialXml?d():p()}).catch(function(e){e===l.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE?""===n.initialXml?d():p():n.lifecycleError=e})},n.saveLifecycle=function(){var t=e.copy(n.initialResponse),i=e.copy(n.selectedRule),a=!1;if(n.actionType===l.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY?(n.operation.step=l.LIFECYCLE.ENABLE_LIFECYCLE_POLICY,i.Status=l.LIFECYCLE.ENABLED,t[n.selectedRuleIndex]=i,a=m(t)):n.actionType===l.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY?(n.operation.step=l.LIFECYCLE.DISABLE_LIFECYCLE_POLICY,i.Status=l.LIFECYCLE.DISABLED,t[n.selectedRuleIndex]=i,a=m(t)):n.actionType===l.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY&&(n.operation.step=l.LIFECYCLE.DELETE_LIFECYCLE_POLICY,t.splice(n.selectedRuleIndex,1),a=h(t)),a)u.log("LifecycleRuleVerification",0,n.operation,{initialResponse:n.initialResponse,finalResponse:t});else{u.log("LifecycleRuleVerification",1,n.operation,{initialResponse:n.initialResponse,finalResponse:t});var c=new r({stripWhitespaces:!1}),d="",p=c.json2xml_str(n.initialResponse[n.selectedRule.indexVal]),g=n.actionType===l.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY?"":c.json2xml_str(i),b=n.initialXml;if(t.length>0){var v={};v.LifecycleConfiguration={},v.LifecycleConfiguration.Rule=t,delete t._xmlns,d=c.json2xml_str(v),o.putBucketLifecycle(s.getCurrentBucket(),b,d,p,g,n.operation).then(function(){f()}).catch(function(e){n.lifecycleError=e})}else o.deleteBucketLifecycle(s.getCurrentBucket(),b,d,p,g,n.operation).then(function(){n.listRules=[],n.initialResponse=[],n.ruleToBeEdited=void 0,n.lifecycleError=void 0,n.disableEdit=!0,n.disableDelete=!0,n.moreOptions[0].disabled=!0,n.moreOptions[1].disabled=!0,n.initialize(),n.closeConfirmationModal()}).catch(function(e){n.lifecycleError=e})}}}])}()}).call(t,n(0),n(2),n(100))},function(e,t){e.exports='<dialog-modal class=lifecycle-confirmation-modal is-open=isOpen close-callback=closeConfirmationModal header-title=headerTitle> <dialog-modal-content> <awsui-alert class=confirmation-warning visible=!showContinue type=warning> {{ warningMessage }} </awsui-alert> <awsui-alert class=confirmation-warning visible=showContinue type=warning> {{ stateChangeWarning }}</awsui-alert> <awsui-alert visible=lifecycleError class="block small-top-margin" type=error dismissible=false header="{{ \'lifecyclemodal.step3.error.header\' | translate }}"> {{ lifecycleError }} </awsui-alert> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=cancel text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant=normal click=closeConfirmationModal()></awsui-button> <awsui-button id=continue variant=primary ng-if=!showContinue text="{{ \'lifecycleconfirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click=detectStateChange()> </awsui-button> <awsui-button id=save ng-if=showContinue click=saveLifecycle() variant=primary text="{{ \'lifecyclemodal.footer.continue\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal>'},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("scroll",["$timeout",function(e){function n(e){Math.ceil(t(window).scrollTop()+t(window).height())+r>=t(document).height()?t(e[0]).addClass("progressbarbottom"):t(e[0]).removeClass("progressbarbottom")}var r=30;return{restrict:"A",link:function(r,i,a){r.$watch(function(){return a.totalOperation},function(t,r){t!==r&&e(n(i),1)},!0),t(window).resize(function(){n(i)}),t(window).scroll(function(){n(i)})}}}])}()}).call(t,n(0),n(6))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("bucketConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",headerTitle:"=",operation:"=",isDelete:"=?",validationMessages:"=?",reviewConsiderations:"=?"},template:n(725),controller:"BucketConfirmationModalController"}}),e.module("s3").controller("BucketConfirmationModalController",["$scope","$timeout","$filter","BucketPropertiesService","OperationDispatcherService","S3Constants","AwsUrlsService",function(n,r,i,a,o,s,c){function l(){n.isDelete=!1,n.showIncorrectBucketError=!1,n.confirmationModal={bucketName:void 0},n.isOpen.flag=!1,n.validationMessages=[],n.reviewConsiderations=!1}n.confirmationModal={bucketName:void 0},n.docLink=c.getDocUrl(s.LEARN_MORE_LINKS.DELETE_BUCKET),r(function(){e.element("#deletebucket-input input").focus()}),n.closeConfirmationModal=function(){l()},n.compareBucketNames=function(e){e&&e.keyCode===s.KEY_CODES.ENTER&&(n.showIncorrectBucketError=t.trim(n.confirmationModal.bucketName)!==n.operation.initialBucket)},n.saveOperation=function(){a.getBucketVersioning(n.operation.initialBucket,n.operation).then(function(e){n.operation.additionalInfo={numberOfKeysPerBulkOperation:s.BULK_OPERATION_KEYS_PER_REQUEST.S3_API,versioning:e},t.trim(n.confirmationModal.bucketName)===n.operation.initialBucket?(o.addOperation(n.operation),l()):n.showIncorrectBucketError=!0}).catch(function(e){n.errorMessage=e})}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports="<div class=confirmation-modal> <dialog-modal class=bucket-confirmation-modal is-open=isOpen close-callback=closeConfirmationModal() header-title=headerTitle> <dialog-modal-content> <awsui-alert class=confirmation-warning type=warning> {{ warningMessage }} <ul class=list-warning-messages ng-if=isDelete> <li>{{ 'confirmationmodal.deletebucket.uniquebucketname' | translate }}</li> <li ng-repeat=\"message in validationMessages\">{{ message }}</li> </ul> <div ng-if=\"isDelete && reviewConsiderations\">{{ 'confirmationmodal.deletebucket.reviewconsiderations' | translate }}</div> <awsui-button ng-if=isDelete target=_blank href={{docLink}} variant=link icon=external-link> <span translate>learn.more</span> </awsui-button> </awsui-alert> <p class=label ng-if=isDelete>{{ 'confirmationmodal.deletebucket.typebucketname' | translate }}</p> <p class=label ng-if=!isDelete> {{ 'confirmationmodal.emptybucket.typebucketname' | translate }} </p> <awsui-textfield id=deletebucket-input ng-keydown=compareBucketNames($event) class=bucket-name ng-model=confirmationModal.bucketName></awsui-textfield> <awsui-alert class=confirmation-warning type=error dismissible=false visible=showIncorrectBucketError> {{ 'confirmationmodal.incorrectbucketerror' | translate }} </awsui-alert> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=cancel text=\"{{ 'createbucketmodal.footer.cancel' | translate }}\" variant=normal click=closeConfirmationModal()></awsui-button> <awsui-button id=save click=saveOperation() variant=primary text=\"{{ 'confirmationmodal.footer.confirm' | translate }}\" class=\"awsui-util-f-r primary-button\"> </awsui-button> </dialog-modal-footer> </dialog-modal> </div>"},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("emptyState",[function(){return{restrict:"E",scope:{type:"=",openModal:"=",oneIntroImage:"=?",regionPostfix:"=?"},template:n(727),controller:"EmptyStateController"}}]),e.module("s3").controller("EmptyStateController",["$scope","AwsUrlsService","S3Constants",function(e,t,n){e.getLearnMoreLink=function(r){return t.getDocUrl(n.LEARN_MORE_LINKS[e.type][r])}}])}()}).call(t,n(0))},function(e,t){e.exports="<div id=initial-start-page> <div id=initial-start-top-content class=awsui-util-t-c> <div class=initial-start-paragraph translate=emptystate.{{type}}.title></div> </div> <table id=initial-start-selling-points> <tbody> <tr class=awsui-util-t-c ng-if=!oneIntroImage> <td> <div class=\"intro-image no-{{type}}-1\"></div> <div class=intro-feature translate=emptystate.{{type}}.firstheader></div> </td> <td> <div class=\"intro-image no-{{type}}-2\"></div> <div class=intro-feature translate=emptystate.{{type}}.secondheader></div> </td> <td> <div class=\"intro-image no-{{type}}-3\"></div> <div class=intro-feature translate=emptystate.{{type}}.thirdheader></div> </td> </tr> <tr class=awsui-util-t-c ng-if=oneIntroImage> <td> <div class=\"intro-image no-{{type}}-1\"></div> <div class=intro-feature translate=emptystate.{{type}}.firstheader></div> </td> </tr> <tr ng-if=!oneIntroImage> <td class=intro-feature-details translate=emptystate.{{type}}{{regionPostfix}}.firstdetails></td> <td class=intro-feature-details translate=emptystate.{{type}}.seconddetails></td> <td class=intro-feature-details translate=emptystate.{{type}}.thirddetails></td> </tr> <tr ng-if=oneIntroImage> <td class=replication-intro-feature-details><div class=replication-detail-msg>{{ 'emptystate.' + type + regionPostfix + '.firstdetails' | translate }}</div></td> </tr> <tr id=initial-start-feature-learn-more class=awsui-util-t-c ng-if=!oneIntroImage> <td><a href={{getLearnMoreLink(0)}} target=_blank>{{'learn.more'|translate}}</a></td> <td><a href={{getLearnMoreLink(1)}} target=_blank>{{'learn.more'|translate}}</a></td> <td><a href={{getLearnMoreLink(2)}} target=_blank>{{'learn.more'|translate}}</a></td> </tr> <tr class=awsui-util-t-c ng-if=oneIntroImage> <td><a href={{getLearnMoreLink(0)}} target=_blank>{{'learn.more'|translate}}</a></td> </tr> </tbody> </table> <div id=initial-start-support> <awsui-button class=awsui-util-mb-s text=\"{{'get.started' | translate}}\" variant=primary click=openModal()></awsui-button> </div> </div>"},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E){function S(){var e=o.operation,n=e.initialBucket,r=e.initialPath,i=t.get(o.updateObject,"name");-1!==i.indexOf(m.DELIMITER)?o.updateObject.errorMessage=c.instant("createfolder.input.errormessage.includesSlash"):""===i?y():(h.log("checkFolderExists",1,e),l.getObjectMetadata(e,n,""+r+i+"/").then(function(){o.updateObject.errorMessage=c.instant("createfolder.input.errormessage.exists",{name:i})}).catch(function(t){if(t.status===m.HTTP_STATUS_CODES.NOT_FOUND){var a={};o.showEncryptionModal?o.defaultEncryption.encryption!==o.encryptionConstants.NONE&&(a[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=o.encryptionOptions[o.defaultEncryption.encryption].apiValue,o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS&&(a[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]=o.defaultEncryption.kmsId.value===o.encryptionConstants.CUSTOM_ARN?o.defaultEncryption.customKMSARN:o.defaultEncryption.kmsId.value)):a[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=m.OBJECT_SSE.AES256,a[m.HEADERS.CONTENT_MD5]=m.UPLOAD.ZERO_BYTE_MD5_BASE64,a[m.HEADERS.CONTENT_TYPE]=m.DIRECTORY_CONTENT_TYPE,l.putObject(o.operation,n,r,i,a).then(function(){h.log("createFolder",1,e,{name:i}),o.resetOperationState()},function(t){h.log("createFolder",0,e,t),o.updateObject.errorMessage=c.instant("createfolder.input.errormessage.generic",{name:i})})}else h.log("createFolder",0,e,t),o.updateObject.errorMessage=c.instant("createfolder.input.errormessage.generic",{name:i})}))}function y(){o.updateObject.name=o.defaultValue||"",o.updateObject.errorMessage=""}function A(){var e=o.operation,n=o.updateObject.name;t.isEmpty(n)||(!e.selectedFolders||e.selectedFolders&&0===e.selectedFolders.length)&&(-1!==n.indexOf(m.DELIMITER)?o.updateObject.errorMessage=c.instant("renameobject.input.errormessage.includesSlash"):(p.startClipboardOperation(!0,{name:n}),e.defer.promise.then(function(){h.log("renameObject",1,e,{name:n,isFolder:!1}),u.evictBucketObjects(g.getCurrentBucket()),o.resetOperationState()},function(){h.log("renameObject",0,e,{name:n,isFolder:!1}),o.updateObject.errorMessage=c.instant("renameobject.input.errormessage.generic",{name:n})})))}function C(){o.updateObject.errorMessage=""}function _(){o.kmsKeys=[];var e=new d("GetKMSKeysForDefaultEncryption"),t=o.forCreateBucketModal?"":g.getCurrentBucket();return E.getKMSKeysById(e,t,m.OBJECT_SSE.CUSTOM_ARN).then(function(e){o.kmsKeys=e}).catch(function(e){o.KMSServiceError=e,o.sseError=e})}var w;o.encryptionConstants=m.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION,o.encryptionOptions=(w={},r(w,o.encryptionConstants.NONE,{apiValue:o.encryptionConstants.API_PARAMS.NONE,value:o.encryptionConstants.NONE,text:c.instant("sse.defaultencryption.none")}),r(w,o.encryptionConstants.AES256,{apiValue:o.encryptionConstants.API_PARAMS.AES256,value:o.encryptionConstants.AES256,description:c.instant("bucketproperties.defaultencryption.aes256description"),text:o.encryptionConstants.AES256}),r(w,o.encryptionConstants.AWSKMS,{apiValue:o.encryptionConstants.API_PARAMS.AWSKMS,value:o.encryptionConstants.AWSKMS,description:c.instant("bucketproperties.defaultencryption.kmsdescription"),text:o.encryptionConstants.AWSKMS}),w),v.isFeatureEnabled(m.FAC.KMS)||delete o.encryptionOptions[o.encryptionConstants.AWSKMS],o.showEncryptionModal=!1,"CreateFolder"===o.operation.name&&f.isRegionalFeatureEnabled(m.FAC.DEFAULT_ENCRYPTION).then(function(e){o.showEncryptionModal=e}),o.updateObject={errorMessage:void 0,name:o.defaultValue||""},o.shouldDisableSave=function(){if(o.defaultEncryption&&o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS){if(!o.defaultEncryption.kmsId)return!0;if(o.defaultEncryption.kmsId.value===m.OBJECT_SSE.CUSTOM_ARN)return 0===t.get(o.defaultEncryption,"customKMSARN.length")||0===o.updateObject.name.length}return 0===o.updateObject.name.length},o.previousName=o.defaultValue;var T=o.operation.name;o.triggerAction=function(e){switch(e.stopPropagation(),T){case"CreateFolder":S();break;case"Rename":A()}},o.defaultEncryption||(o.defaultEncryption={customKMSARN:"",encryption:o.encryptionConstants.NONE,kmsId:null}),s(function(){e.element(document).find(".new-folder-input input").focus()}),o.resetOperationState=function(e,t){switch(u.resetLocationAndMarkers(),o.fetchObjects(!1,!1),e&&e.stopPropagation(),o.showOperation=!1,T){case"CreateFolder":y();break;case"Rename":C(),o.resetSelection()}o.operation=null},o.triggerKeyboardEvt=function(e){e&&e.keyCode===m.KEY_CODES.ENTER&&o.triggerAction(e)},o.updateKMSKey=function(e){e===o.encryptionConstants.AWSKMS?_():(t.isEmpty(o.sseError)||o.sseError!==o.KMSServiceError||(o.sseError=null),o.KMSServiceError=null)}}e.module("s3").directive("updateObject",function(){return{restrict:"E",scope:{showOperation:"=",defaultEncryptionEnabled:"=",fetchObjects:"=",currentMarker:"@?",defaultValue:"@?",operation:"=",defaultPlaceholder:"@?",resetSelection:"="},template:n(729),controller:"UpdateObjectController"}}),e.module("s3").controller("UpdateObjectController",["$document","$filter","$q","$scope","$timeout","$translate","APIProxyService","CachingService","ConsoleOperation","CopyService","FACService","PathService","S3Constants","SCLogService","UtilService","FAC","KMSPropertiesService",i])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<awsui-textfield class="input-text new-folder-input" ng-model=updateObject.name ng-keypress=triggerKeyboardEvt($event) value={{defaultValue}} placeholder={{defaultPlaceholder}} ng-click=$event.stopPropagation(); ng-dblclick=$event.stopPropagation(); auto-focus=true> </awsui-textfield> <div ng-if=showEncryptionModal class=folder-encryption> <div class=create-folder-encryption-blurb>{{\'createfolder.defaultencryption.blurb\' | translate}}</div> <div> <awsui-radio-group value={{defaultEncryption.encryption}} ng-model=defaultEncryption.encryption ng-change=updateKMSKey(defaultEncryption.encryption)> <div ng-repeat="encryption in encryptionOptions"> <awsui-radio-button class=encryption-radio-btn value={{encryption.value}} label={{encryption.text}} ng-class="{ \'no-description\': !encryption.description }"></awsui-radio-button> <p class=default-encryption-description ng-if=encryption.description>{{encryption.description}}</p> <div ng-if="encryption.text === encryptionConstants.AWSKMS && defaultEncryption.encryption === encryptionConstants.AWSKMS" class=kms-arn-selector> <awsui-control-group validation-message="{{ KMSServiceError }}"> <dropdown items=kmsKeys placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled=KMSServiceError selected-item=defaultEncryption.kmsId filter=true dropdown-disabled=true> </dropdown> </awsui-control-group> <awsui-textfield class=custom-kms-arn ng-if="defaultEncryption.encryption===encryptionConstants.AWSKMS && defaultEncryption.kmsId.value===encryptionConstants.CUSTOM_ARN" ng-model=defaultEncryption.customKMSARN></awsui-textfield> </div> </div> </awsui-radio-group> </div> </div> <awsui-alert class=input-error type=error header="{{ \'error.header\' | translate}}" ng-show=updateObject.errorMessage>{{updateObject.errorMessage}}</awsui-alert> <div class=create-folder-btn ng-class="{ \'create-folder-default-encryption-btn\' : showFolderEncryption }"> <awsui-button text="{{ \'updateobject.button.save\' | translate}}" ng-click=triggerAction($event) ng-dblclick=$event.stopPropagation(); data-disabled=shouldDisableSave()></awsui-button> <awsui-button text="{{ \'updateobject.button.cancel\' | translate}}" ng-dblclick=$event.stopPropagation(); ng-click="resetOperationState($event, true)"></awsui-button> </div>'},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("storageManagement",[function(){return{restrict:"E",scope:{},template:n(731),controller:"StorageManagementController"}}]),e.module("s3").controller("StorageManagementController",["$scope","S3Constants","UtilService",function(e,n,r){e.S3Constants=n,e.viewId={value:n.MANAGEMENT.VIEWS.LIFECYCLE};var i=[n.MANAGEMENT.VIEWS.ANALYTICS,n.MANAGEMENT.VIEWS.CLOUDWATCH];e.showView=function(n){e.viewId.value=n;var r=t(".storage-management-container");i.indexOf(n)>-1?r.addClass("wideview"):r.removeClass("wideview")},e.viewEnabled=function(t){return e.viewId.value===t},e.displayCRRV2=r.CRRFACHandle().v2}])}()}).call(t,n(0),n(6))},function(e,t){e.exports="<div class=storage-management-container> <awsui-button-group class=si-category-buttons> <awsui-tooltip text=\"{{'management.view.tooltip.lifecycle'|translate}}\" position=top> <awsui-button id=lifecycle-tab class=si-action-button text=\"{{ 'management.view.lifecycle' | translate }}\" ng-click=showView(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE) variant=\"{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.LIFECYCLE ? 'primary' : '' }}\"> </awsui-button> </awsui-tooltip> <awsui-tooltip text=\"{{'management.view.tooltip.replication'|translate}}\" position=top> <awsui-button id=replication-tab class=si-action-button text=\"{{ 'management.view.replication' | translate }}\" ng-click=showView(S3Constants.MANAGEMENT.VIEWS.REPLICATION) variant=\"{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.REPLICATION ? 'primary' : '' }}\" fac-id=s3-crr-v2> </awsui-button> </awsui-tooltip> <awsui-tooltip text=\"{{'management.view.tooltip.analytics'|translate}}\" position=top> <awsui-button id=analytics-tab class=si-action-button text=\"{{ 'management.view.analytics' | translate }}\" ng-click=showView(S3Constants.MANAGEMENT.VIEWS.ANALYTICS) variant=\"{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.ANALYTICS ? 'primary' : '' }}\" fac-id=s3-an></awsui-button> </awsui-tooltip> <awsui-tooltip text=\"{{'management.view.tooltip.metrics'|translate}}\" position=top> <awsui-button id=cloudwatch-tab class=si-action-button text=\"{{ 'management.view.metrics' | translate }}\" variant=\"{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH ? 'primary' : '' }}\" ng-click=showView(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH) fac-id=s3-me></awsui-button> </awsui-tooltip> <awsui-tooltip text=\"{{'management.view.tooltip.inventory'|translate}}\" position=top> <awsui-button id=inventory-tab class=si-action-button text=\"{{ 'management.view.inventory' | translate }}\" variant=\"{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.INVENTORY ? 'primary' : '' }}\" ng-click=showView(S3Constants.MANAGEMENT.VIEWS.INVENTORY) fac-id=s3-oi></awsui-button> </awsui-tooltip> </awsui-button-group> <bucket-lifecycle ng-if=viewEnabled(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE)></bucket-lifecycle> <bucket-replication ng-if=viewEnabled(S3Constants.MANAGEMENT.VIEWS.REPLICATION)></bucket-replication> <analytics view-id=viewId ng-if=viewEnabled(S3Constants.MANAGEMENT.VIEWS.ANALYTICS)></analytics> <cloudwatch-metrics ng-if=viewEnabled(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH)></cloudwatch-metrics> <bucket-reports ng-if=viewEnabled(S3Constants.MANAGEMENT.VIEWS.INVENTORY)></bucket-reports> </div> "},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").controller("StorageMetricsController",["$scope","$translate","AwsUrlsService","Region","S3Constants","StorageMonitoringService","UtilService","FAC","$q",function(t,n,r,i,a,o,s,c,l){function u(t){var n="";return e.forEach(t,function(e){var t=e.Name,r=e.Value;n+="~'"+t+"~'"+r}),n}function d(t){var n="";return e.forEach(t,function(e,r){n+=e.Name,r!==t.length-1&&(n+=",")}),n}function p(e,t,n){var i=g(),a="#"+i+":graph=~(view~'timeSeries~stacked~false~start~'-P<start>~end~'P0D~region~'<region>~metrics~(~(~'AWS*2fS3~'<metric-name>",o=r.getConsoleServiceUrl("cloudwatch",e.region,"")+a,s="))~period~<period>~stat~'<statistic>);namespace=<namespace>;dimensions=";s+=d(e.Dimensions);var c=o+u(e.Dimensions)+s,l=c.replace(new RegExp("<region>","g"),e.region);return l=l.replace("<metric-name>",e.MetricName).replace("<namespace>",e.Namespace).replace("<period>",t).replace("<start>",S[n]).replace("<statistic>",e.statistic)}function f(t,n,i){var a=g(),o="#"+a+":graph=~(view~'timeSeries~stacked~true~start~'-P<start>~end~'P0D~region~'<region>~metrics~(",s=t[0],c="";e.forEach(t,function(e){var t="~(color~'"+e.color.replace("#","*23")+")",n="~(~'AWS*2fS3~'<metric-name>"+u(e.Dimensions)+t+")";c+=n.replace("<metric-name>",e.MetricName)});var l=r.getConsoleServiceUrl("cloudwatch",s.region,"")+o,p=")~period~<period>~stat~'<statistic>);namespace=<namespace>;dimensions=";p+=d(t[0].Dimensions);var f=l+c+p,m=f.replace(new RegExp("<region>","g"),s.region);return m=m.replace("<namespace>",s.Namespace).replace("<period>",n).replace("<start>",S[i]).replace("<statistic>",s.statistic)}function g(){var e=s.getCloudSystem();return e===i.DOMAINS.ISO.NAME||e===i.DOMAINS.GOV.NAME?"metrics":"metricsV2"}function m(e,t){var n=e.statistics.Datapoints[0],r="";switch(n.Unit){case a.METRICS.UNIT.COUNT:case a.METRICS.UNIT.BYTES:r+=v[n.Unit]+" / "+v[t];break;case a.METRICS.UNIT.MILLIS:r+=v[a.METRICS.UNIT.MILLIS];break;default:r+=n.Unit.toLowerCase()}return r}t.format={xtooltipDateTime:s.getShortDateTimeWithoutYearPattern(),xdateTime:s.getShortDateWithoutYearPattern()},t.deepLinks=[];var h={MINUTE:60,QUARTER_HOUR:900,HALF_HOUR:1800,HOUR:3600,QUARTER_DAY:21600,HALF_DAY:43200,DAY:86400},b={H1:36e5,H3:108e5,H12:432e5,H24:864e5,D3:2592e5,W1:6048e5,W2:12096e5},v={H1:n.instant("management.metrics.period.minute.one"),H3:n.instant("management.metrics.period.hour.quarter"),H12:n.instant("management.metrics.period.hour.half"),H24:n.instant("management.metrics.period.hour.one"),D3:n.instant("management.metrics.period.day.quarter"),W1:n.instant("management.metrics.period.day.half"),W2:n.instant("management.metrics.period.day.one"),Count:n.instant("management.metrics.unit.count"),Bytes:n.instant("management.metrics.unit.bytes"),Milliseconds:n.instant("management.metrics.unit.milliseconds")},E={H1:h.MINUTE,H3:h.QUARTER_HOUR,H12:h.HALF_HOUR,H24:h.HOUR,D3:h.QUARTER_DAY,W1:h.HALF_DAY,W2:h.DAY},S={H1:"1H",H3:"3H",H12:"12H",H24:"1D",D3:"3D",W1:"7D",W2:"14D"},y=[[{metricName:"StandardStorage",color:a.METRICS.COLOR.MAIN_AREA},{metricName:"GlacierS3ObjectOverhead",color:a.METRICS.COLOR.OVERHEAD_AREA}],[{metricName:"IntelligentTieringFAStorage",color:a.METRICS.COLOR.MAIN_AREA}],[{metricName:"IntelligentTieringIAStorage",color:a.METRICS.COLOR.MAIN_AREA}],[{metricName:"StandardIAStorage",color:a.METRICS.COLOR.MAIN_AREA},{metricName:"StandardIAOverhead",color:a.METRICS.COLOR.OVERHEAD_AREA}],[{metricName:"OneZoneIAStorage",color:a.METRICS.COLOR.MAIN_AREA},{metricName:"OneZoneIASizeOverhead",color:a.METRICS.COLOR.OVERHEAD_AREA}],[{metricName:"ReducedRedundancyStorage",color:a.METRICS.COLOR.MAIN_AREA}],[{metricName:"GlacierStorage",color:a.METRICS.COLOR.MAIN_AREA},{metricName:"GlacierObjectOverhead",color:a.METRICS.COLOR.OVERHEAD_AREA}],[{metricName:"GlacierStagingStorage",color:a.METRICS.COLOR.MAIN_AREA}]];c.isFeatureEnabled(a.FAC.DEEP_ARCHIVE)&&(y.splice(1,0,[{metricName:"DeepArchiveS3ObjectOverhead",color:a.METRICS.COLOR.MAIN_AREA}]),y.push([{metricName:"DeepArchiveStorage",color:a.METRICS.COLOR.MAIN_AREA},{metricName:"DeepArchiveObjectOverhead",color:a.METRICS.COLOR.OVERHEAD_AREA}],[{metricName:"DeepArchiveStagingStorage",color:a.METRICS.COLOR.MAIN_AREA}])),t.statistic=t.statistic?t.statistic:"Average",t.timestamp=t.timestamp?t.timestamp:"Timestamp",t.lineCharts=[],t.stackedAreaMetrics=[],t.bucketSizeCharts={},t.updatingMetrics=!1,t.getAllMetricData=function(r){if(!t.updatingMetrics){var i=b[r],u=E[r];t.deepLinks=[],t.lineCharts=[],t.stackedAreaMetrics=[],t.bucketSizeCharts={},t.updatingMetrics=!0,l.all(t.metricList.map(function(e){return o.requestMetricStatistics(e,i,e.statistic,u).then(function(n){if(e.error="",e.heading=e.MetricName,e.statistics&&e.statistics.Datapoints&&e.statistics.Datapoints.length>0&&(e.heading+=" ("+m(e,r)+")",e.statistics.Datapoints[0].Unit===a.METRICS.UNIT.BYTES&&(e.unitBase=a.BYTES.BASE)),"BucketSizeBytes"===e.MetricName&&c.isFeatureEnabled("glacier-storage-metrics")){var i=e.Dimensions.find(function(e){return"StorageType"===e.Name}).Value;t.bucketSizeCharts[i]=e}else t.lineCharts.push(e),t.deepLinks.push(p(e,u,r))}).catch(function(t){e.error=n.instant("management.metrics.data.error",{name:e.MetricName,message:s.handleErrors(t)})})})).then(function(){e.forEach(y,function(n){var i={chartId:"",data:[]};e.forEach(n,function(e){var n=e.metricName,r=e.color;if(t.bucketSizeCharts[n]){var a=t.bucketSizeCharts[n];a.color=r,i.heading=a.heading,i.chartId=a.chartId,i.startTime=a.startTime,i.endTime=a.endTime,i.data.push(a)}}),i.data.length>0&&(i.period=h.DAY,i.deepLink=f(i.data,i.period,r),t.stackedAreaMetrics.push(i))}),t.updatingMetrics=!1})}},t.getChartLabels=function(t){var n=[];return e.forEach(t.Dimensions,function(e){"BucketName"!==e.Name&&n.push(e.Value)}),n},t.$watch("zoom",function(e,n){e!==n&&t.getAllMetricData(e)}),t.$watch("metricList",function(e,n){e!==n&&t.getAllMetricData(t.zoom)}),t.getAllMetricData(t.zoom)}]),e.module("s3").directive("metricsMonitoring",[function(){return{scope:{metricList:"=",zoom:"=",statistic:"=?",timestamp:"=?"},template:n(733),controller:"StorageMetricsController"}}])}()}).call(t,n(0))},function(e,t){e.exports='<div> <div class=clearfix></div> <div class=metrics-table> <table> <tr ng-repeat="stackedMetric in stackedAreaMetrics" fac-id=glacier-storage-metrics> <td> <div> <div class=cloudwatch-link> <awsui-button target=_blank href={{stackedMetric.deepLink}} variant=link icon=external-link ng-click=cloudwatchLinkClicked()> <span translate=management.metrics.cloudwatch></span> </awsui-button> </div> <div class=svg-chart-container> <stacked-area-chart chart-id=stackedMetric.chartId cloudwatch-data=stackedMetric.data xid=timestamp yid=statistic xmin=stackedMetric.startTime xmax=stackedMetric.endTime period=stackedMetric.period heading=stackedMetric.heading totalwidth=960 totalheight=400> </stacked-area-chart> </div> <div class=dimensions ng-repeat="metric in stackedMetric.data"> <div class=square ng-style="{background: metric.color}"></div> <span class=dimension-labels ng-repeat="label in getChartLabels(metric)">{{ label }}</span> <div class=dimension-labels-stat> <span> (<span translate=management.metric.statistic.{{metric.statistic.toLowerCase()}}></span>) </span> </div> </div> <hr class=hr-props> </div> </td> </tr> <tr ng-repeat="metric in lineCharts"> <td> <div class=storage-management-error-box> <awsui-alert type=error header="{{\'error.header\'|translate}}" visible=metric.error> {{metric.error}} </awsui-alert> </div> <div ng-if=metric.statistics.Datapoints> <div class=cloudwatch-link> <awsui-button target=_blank href={{deepLinks[$index]}} variant=link icon=external-link ng-click=cloudwatchLinkClicked()> <span translate=management.metrics.cloudwatch></span> </awsui-button> </div> <div class=svg-chart-container> <storage-console-line-chart chartid=metric.chartId data=metric.statistics.Datapoints heading=metric.heading isxdate=true xid=timestamp xscaleby=1000 yid=metric.statistic xmin=metric.startTime xmax=metric.endTime totalwidth=940 totalheight=400 xtooltip-date-time-format={{format.xtooltipDateTime}} xdate-time-format={{format.xdateTime}} template-url=../partials/storageConsoleLineChartS3.html ybase=metric.unitBase> </storage-console-line-chart> </div> <div class=dimensions> <div class=square></div> <span class=dimension-labels ng-repeat="label in getChartLabels(metric)">{{ label }}</span> <div class=dimension-labels-stat> <span> (<span translate=management.metric.statistic.{{metric.statistic.toLowerCase()}}></span>) </span> </div> </div> <hr class=hr-props> </div> </td> </tr> </table> </div> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").service("StorageMonitoringService",["$q","$routeParams","CloudWatchService","BucketPropertiesService","S3Constants","SCLogService",function(n,r,i,a,o,s){function c(e){var t={};return e.forEach(function(e,n){t["Dimensions.member."+(n+1)+".Name"]=e.Name,t["Dimensions.member."+(n+1)+".Value"]=e.Value}),t}this.requestMetricsList=function(t){var c=r[o.PATH_SEGMENTS.BUCKET_NAME],l=[];return a.getBucketLocation(c).then(function(r){return e.forEach(t,function(t,a){var o={Namespace:"AWS/S3","Dimensions.member.1.Name":"BucketName","Dimensions.member.1.Value":c,"Dimensions.member.2.Name":t.Name};t.Value&&(o["Dimensions.member.2.Value"]=t.Value);var u=i.listMetrics({region:r,params:o});u.then(function(t){var n=t.response.ListMetricsResponse.ListMetricsResult.Metrics;return e.forEach(n,function(e){e.region=r}),s.log("ListMetrics",1),n}).catch(function(e){return s.log("ListMetrics",0,{err:e}),n.reject(e)}),l.push(u)}),n.all(l).then(function(t){var n=[];return e.forEach(t,function(e){var t=e.response.ListMetricsResponse.ListMetricsResult.Metrics;n=n.concat(t)}),n}).catch(function(e){return n.reject(e)})})},this.requestMetricStatistics=function(e,r,a,o){var l=new Date,u=new Date(l-r),d={MetricName:e.MetricName,Namespace:e.Namespace,StartTime:u.toISOString(),EndTime:l.toISOString(),Period:o,"Statistics.member.1":a},p=c(e.Dimensions);return d=t.extend(d,p),i.getMetricStatistics({region:e.region,params:d}).then(function(t){return e.statistics=t.response.GetMetricStatisticsResponse.GetMetricStatisticsResult,e.period=o,e.endTime=l.getTime(),e.startTime=u.getTime(),s.log("GetMetricStatistics",1),e}).catch(function(e){return s.log("GetMetricStatistics",0,e),n.reject(e)})}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t,r){!function(){e.module("s3").directive("cloudwatchMetrics",[function(){return{restrict:"E",scope:{},template:n(736),controller:"CloudwatchMetricsController"}}]),e.module("s3").controller("CloudwatchMetricsController",["$anchorScroll","$routeParams","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","PathService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser","FAC",function(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b){function v(e){return!r.has(e,"facId")||b.isFeatureEnabled(e.facId)}function E(){var t={prefixes:[],tags:[]};return e.forEach(a.filters.prefixFilters,function(e){t.prefixes.push({Prefix:e})}),e.forEach(a.filters.tagFilters,function(e){t.tags.push({Tag:{Key:e.tagKey,Value:e.tagVal}})}),t}function S(t){var n=t.Filter;n&&(n.And?e.forEach(n.And,function(t,n){n===M&&a.filters.prefixFilters.push(t),n===L&&(t=[].concat(t),e.forEach(t,function(e){a.filters.tagFilters.push({tagKey:e.Key,tagVal:e.Value})}))}):n.Prefix?a.filters.prefixFilters.push(n.Prefix):n.Tag&&a.filters.tagFilters.push({tagKey:n.Tag.Key,tagVal:n.Tag.Value}))}function y(){var t=a.metricTypes[a.selectedMetricType].dimension,n=[];return a.selectedMetricType===p.METRICS.TYPE.STORAGE?n.push({Name:t,Value:null}):(a.models.bucketChecked&&e.forEach(a.bucketFilterList,function(e){n.push({Name:t,Value:e.Id})}),e.forEach(a.filterList,function(e){e.checked&&n.push({Name:t,Value:e.Id})})),n}function A(e){return("s3_"+e.MetricName+"_"+r.map(e.Dimensions,"Value").join("_")).replace(/\./g,"_")}function C(e){var t=a.metricTypes[a.selectedMetricType],n=r.groupBy(e,"MetricName");a.metricsWithStats=[];var i=[];return t.metrics.filter(function(e){return n[e.name]}).forEach(function(e){var t=n[e.name].map(function(t){return r.assign({},t,{statistic:e.statistic,chartId:A(t)})});a.metricsWithStats.push({display:e.display,ref:t[0]}),i.push(t)}),r.flatten(i)}function _(e){a.models[e]=!0,R(),a.bucketFilterList=[],a.filterList=[],w(e)}function w(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i={};n&&e.extend(i,{params:{"continuation-token":n}}),c.getBucketProperty(j,a.bucketName,"metrics",i,!1).then(function(e){var n=e.response;f.log("getBucketMetrics",1,j);var i=h.convertXmlStringToJson(n),o=i.ListMetricsConfigurationsResult,s=o.MetricsConfiguration,c=[];s&&(c=m.transformObjectToArray(s)),a.bucketFilterList=a.bucketFilterList.concat(r.filter(c,function(e){return e.Id===D})),a.filterList=a.filterList.concat(r.filter(c,function(e){return!!(e.Id!==D||e.Id===D&&e.Filter)&&(e.checked=a.models.allFilters,!0)})),"true"===o.IsTruncated?w(t,o.NextContinuationToken):(T(),a.getCloudwatchMetrics(),O(t))}).catch(function(e){f.log("getBucketMetrics",0,j),O(t),P(t,e)})}function T(){a.models.editFilter=!1,a.metricTypes.requests.checked=a.bucketFilterList.length>0,a.metricTypes.requests.state=a.metricTypes.requests.checked,a.metricTypes.data.checked=a.metricTypes.requests.checked,a.metricTypes.data.state=a.metricTypes.data.checked}function R(){a.models.filterName="",a.filters.input="",a.filters.tagFilters=[],a.filters.prefixFilters=[]}function O(e){a.models[e]=!1,e!==x.SAVING_FILTER&&e!==x.DELETE_FILTER||(a.models.showAddFilter=!1,a.models.filterError=""),e===x.APPLYING_CONFIG&&(a.models.toggleMetricsConfig=!1),a.filters.input="",a.filters.tagFilters=[],a.filters.prefixFilters=[]}function k(e,t,n){var r=new u(p.OPERATION_NAME.METRICS_PUT_CONFIG);a.models[n]=!0,e=N(e),n===x.SAVING_FILTER&&(a.filterError=""),m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.SAVE_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),c.putBucketProperty(r,a.bucketName,"metrics",e,t).then(function(e){e.response,f.log("putBucketMetrics",1,r),_(n),a.models.addInfoMessage=!0}).catch(function(e){f.log("putBucketMetrics",0,r),P(n,e),a.models[n]=!1})}function I(e,t){var n=new u(p.OPERATION_NAME.METRICS_DELETE_CONFIG);t!==x.SAVING_FILTER&&t!==x.DELETE_FILTER||(a.models.filterError=""),m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.DELETE_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.models[t]=!0,c.deleteBucketProperty(n,a.bucketName,"metrics",e).then(function(e){e.response,f.log("deleteBucketMetrics",1,n),_(t)}).catch(function(e){f.log("deleteBucketMetrics",0,n),P(t,e),a.models[t]=!1})}function P(e,t){e===x.SAVING_FILTER?a.models.filterError=m.handleErrors(t):a.error=m.handleErrors(t)}function N(e){return e.replace("<MetricsConfiguration>",'<MetricsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}var M="Prefix",L="Tag",x=p.MANAGEMENT.ACTION,D="EntireBucket",j=new u(p.OPERATION_NAME.METRICS_GET_CONFIG);a.bucketName=i[p.PATH_SEGMENTS.BUCKET_NAME],a.metricsLoading=!0,a.metrics={},a.timestamp="Timestamp",a.xScaleBy=1e3,a.selectedTimeFrame="W2",a.selectedMetricGroup="",a.selectedMetricType=p.METRICS.TYPE.STORAGE,a.selectedMetricLink="",a.S3Constants=p,a.error="",n.yOffset=100,a.bucketRegion=d.getCurrentBucket(),a.validFilter=!1,a.filterList=[],a.bucketFilterList=[],a.models={filterName:null,filterValue:null,filterError:null,savingFilter:!1,applyingConfig:!1,showAddFilter:!1,editFilter:!1,configLoading:!0,toggleMetricsConfig:!1,searchText:"",bucketChecked:!0,allFilters:!1,updatedOn:null,addInfoMessage:!1,deleteFilter:!1},a.filters={input:"",prefixFilters:[],tagFilters:[]},a.metricTimeRangeList=[{id:"H1",translateKey:"management.metrics.timeframe.1h"},{id:"H3",translateKey:"management.metrics.timeframe.3h"},{id:"H12",translateKey:"management.metrics.timeframe.12h"},{id:"H24",translateKey:"management.metrics.timeframe.1d"},{id:"W1",translateKey:"management.metrics.timeframe.1w"},{id:"W2",translateKey:"management.metrics.timeframe.2w"}],a.metricTypes={storage:{id:p.METRICS.TYPE.STORAGE,group:s.instant("management.metric.type.storage"),title:s.instant("management.metric.type.title.storage"),disable:!0,checked:!0,state:!0,info:s.instant("management.metrics.cost.free"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:s.instant("management.metric.type.display.storage.size"),selected:!0,statistic:"Average"},{name:"NumberOfObjects",display:s.instant("management.metric.type.display.storage.count"),selected:!0,statistic:"Average"}]},requests:{id:p.METRICS.TYPE.REQUESTS,group:s.instant("management.metric.type.requests"),title:s.instant("management.metric.type.title.requests"),disable:!1,checked:!1,state:!1,info:s.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"GetRequests",display:"GET",selected:!0,statistic:"Sum"},{name:"PutRequests",display:"PUT",selected:!0,statistic:"Sum"},{name:"ListRequests",display:"LIST",selected:!0,statistic:"Sum"},{name:"AllRequests",display:"ALL",selected:!0,statistic:"Sum"},{name:"PostRequests",display:"POST",selected:!0,statistic:"Sum"},{name:"DeleteRequests",display:"DELETE",selected:!0,statistic:"Sum"},{name:"HeadRequests",display:"HEAD",selected:!0,statistic:"Sum"},{name:"4xxErrors",display:s.instant("management.metric.type.display.requests.errors4xx"),selected:!0,statistic:"Sum"},{name:"5xxErrors",display:s.instant("management.metric.type.display.requests.errors5xx"),selected:!0,statistic:"Sum"},{name:"SelectRequests",display:s.instant("management.metric.type.display.requests.select"),selected:!0,statistic:"Sum",facId:p.FAC.S3_SELECT_METRICS}].filter(v)},data:{id:p.METRICS.TYPE.DATA,group:s.instant("management.metric.type.data"),title:s.instant("management.metric.type.title.data"),disable:!1,checked:!1,state:!1,info:s.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"TotalRequestLatency",display:s.instant("management.metric.type.display.data.total"),selected:!0,statistic:"Average"},{name:"FirstByteLatency",display:s.instant("management.metric.type.display.data.first"),selected:!0,statistic:"Average"},{name:"BytesUploaded",display:s.instant("management.metric.type.display.data.uploaded"),selected:!0,statistic:"Sum"},{name:"BytesDownloaded",display:s.instant("management.metric.type.display.data.downloaded"),selected:!0,statistic:"Sum"},{name:"SelectBytesReturned",display:s.instant("management.metric.type.display.data.select.bytesreturned"),selected:!0,statistic:"Sum",facId:p.FAC.S3_SELECT_METRICS},{name:"SelectBytesScanned",display:s.instant("management.metric.type.display.data.select.bytesscanned"),selected:!0,statistic:"Sum",facId:p.FAC.S3_SELECT_METRICS}].filter(v)}},a.checkAllPaidMetrics=function(t){e.forEach(a.metricTypes,function(e){t.id!==p.METRICS.TYPE.STORAGE&&e.id!==p.METRICS.TYPE.STORAGE&&t.id!==e.id&&(e.checked=t.checked)})},a.viewAllFilters=function(){e.forEach(a.filterList,function(e){e.checked=a.models.allFilters}),a.getCloudwatchMetrics()},a.filterKeyDown=function(e){e&&e.keyCode===p.KEY_CODES.ESC&&(t(".input-field").blur(),a.models.searchText="")},a.getGroupTitle=function(e){return a.metricTypes[e].group},a.getLearnMoreLink=function(e){return l.getDocUrl(p.LEARN_MORE_LINKS["storage-management"][e])},a.configureMetrics=function(){a.models.toggleMetricsConfig?a.cancelMetricsConfig():a.models.toggleMetricsConfig=!a.models.toggleMetricsConfig},a.addFilter=function(t){a.models.showAddFilter||(a.models.filterNameError="",a.models.filterValueError="",t?(m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.EDIT_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.models.filterName=t.Id,a.models.editFilter=!0,S(t)):(m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.ADD_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.models.filterName="",a.models.filterValue=""),a.models.showAddFilter=!0,a.models.editFilter||o(function(){e.element("#cloudwatch-filterinput input").focus()}))},a.validateFilter=function(e){var t=!0;return e||(e=E()),a.models.filterNameError="",a.models.filterValueError="",!!a.models.filterName&&(a.models.filterName=a.models.filterName.trim(),p.MANAGEMENT.FILTER_NAME_REGEX.test(a.models.filterName)||(a.models.filterNameError=s.instant("management.config.filtername.error.format"),t=!1),a.filters.input&&(a.models.filterValueError=s.instant("management.config.filtervalue.error.format",{text:a.filters.input}),t=!1),a.models.editFilter||r.filter(a.filterList,function(e){return e.Id===a.models.filterName}).length>0&&(a.models.filterNameError=s.instant("management.metrics.side.filter.error.dup"),t=!1),t)},a.cancelFilter=function(){a.models.editFilter||m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.models.showAddFilter=!1,a.models.editFilter=!1,a.models.filterError=!1,R()},a.refresh=function(){a.getCloudwatchMetrics()},a.goToChart=function(e){a.selectedMetricLink=e,n(e)},a.setMetricGroup=function(e){a.selectedMetricGroup=e},a.setTimeRange=function(e){m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.METRICS.PERIOD[e],p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.selectedTimeFrame=e},a.setSelectedMetricType=function(e){m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.METRICS.TYPE[e],p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT),a.selectedMetricType=e,a.getCloudwatchMetrics()},a.filterChanged=function(e,t){t&&t.stopPropagation(),e.checked=!e.checked,e.checked||(a.models.allFilters=!1),a.getCloudwatchMetrics()},a.getCloudwatchMetrics=function(){var e=y();a.metricsLoading=!0,a.info="",a.error="",e.length>0?g.requestMetricsList(e).then(function(e){a.metrics[a.selectedMetricType]=C(e),0===e.length?a.info=s.instant("management.metrics.notavailable",{type:a.metricTypes[a.selectedMetricType].group}):(a.info="",a.error="")}).catch(function(e){a.error=s.instant("management.metrics.error",{message:m.handleErrors(e)})}).finally(function(){a.metricsLoading=!1,a.models.updatedOn=s.instant("management.metrics.updatedon",{time:m.formatDate(new Date,["shortDate","mediumTime"])})}):(a.models.bucketChecked&&!a.metricTypes.requests.state?a.info=s.instant("management.metrics.not.enabled"):a.info=s.instant("management.metrics.not.selected"),a.metrics[a.selectedMetricType]=C([]),a.metricsLoading=!1,a.models.updatedOn=s.instant("management.metrics.updatedon",{time:m.formatDate(new Date,["shortDate","mediumTime"])}))},a.deleteFilter=function(){a.models.deleteFilter&&a.models.savingFilter||I({params:{id:a.models.filterName}},x.DELETE_FILTER)},a.applyMetricsConfig=function(){if(a.metricTypes.requests.checked){var t={params:{id:D}},n={},r=void 0;n.MetricsConfiguration={},n.MetricsConfiguration.Id=D,r=h.jsonToXml(n),k(r,t,x.APPLYING_CONFIG)}else e.forEach(a.bucketFilterList,function(e){I({params:{id:e.Id}},x.APPLYING_CONFIG)})},a.cancelMetricsConfig=function(){a.metricTypes.requests.checked=a.metricTypes.requests.state,a.metricTypes.data.checked=a.metricTypes.requests.state,a.models.toggleMetricsConfig=!1},a.saveFilter=function(){if(!a.models.savingFilter&&!a.models.deleteFilter){var t=E();a.models.filterError="",a.validateFilter(t)&&function(){var n={params:{id:a.models.filterName}},r={},i=void 0;r.MetricsConfiguration={},r.MetricsConfiguration.Id=a.models.filterName,t.tags.length+t.prefixes.length&&(r.MetricsConfiguration.Filter={},t.tags.length>1||t.tags.length+t.prefixes.length>1?(r.MetricsConfiguration.Filter.And={},t.tags.length>0&&(r.MetricsConfiguration.Filter.And.Tag=[],e.forEach(t.tags,function(e){var t=e.Tag;return r.MetricsConfiguration.Filter.And.Tag.push(t)})),t.prefixes.length>0&&(r.MetricsConfiguration.Filter.And.Prefix=[],e.forEach(t.prefixes,function(e){var t=e.Prefix;return r.MetricsConfiguration.Filter.And.Prefix.push(t)}))):(t.prefixes.length>0&&(r.MetricsConfiguration.Filter=t.prefixes[0]),t.tags.length>0&&(r.MetricsConfiguration.Filter.Tag=t.tags[0].Tag))),i=h.jsonToXml(r),k(i,n,x.SAVING_FILTER)}()}},a.cloudwatchLinkClicked=function(){m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.METRICS.CLOUDWATCH_LINK,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT)},a.searchClicked=function(){m.analyticsTrackClick(p.ANALYTICS.MANAGEMENT.SEARCH_CONFIG,p.ANALYTICS.MANAGEMENT.METRICS.CONTEXT)},function(){_(x.CONFIG_LOADING)}()}])}()}).call(t,n(0),n(6),n(2))},function(e,t){e.exports='<div class="metrics-content-table h-container"> <div class="metrics-content-cell management-side-panel-color"> <div class=select-metrics-side-panel> <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if=models.configLoading></span> <table class=select-metrics-table ng-if=!models.configLoading> <tr> <td> <span class=metrics-header>Metrics</span> </td> </tr> <tr> <td> <table class="search-box prefix-search-box"> <tbody> <tr> <td class=search-icon><i class="awsui-icon search"></i></td> <td><input type=text class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model=models.searchText ng-keydown=filterKeyDown($event) ng-click=searchClicked() placeholder="{{ \'management.search.placeholder\' | translate }}"></td> </tr> </tbody> </table> </td> </tr> <tr> <td> <awsui-alert class=save-filter-info-alert header="{{\'management.metric.info\'|translate}}" dismissible=true visible=models.addInfoMessage ng-click="models.addInfoMessage=false">{{ \'management.metrics.statistics.delay\' | translate}}</awsui-alert> </td> </tr> <tr> <td class=side-panel-row ng-class="{\'row-highlight\': models.bucketChecked}"> <table border=0px> <tr> <td> <div class=row-checkbox> <awsui-checkbox checked=models.bucketChecked data-disabled=false ng-model=models.bucketChecked change=getCloudwatchMetrics()></awsui-checkbox> </div> </td> <td> <i class="awsui-icon bucket buckets-bucket-icon" ng-class="{\'awsui-icon-light\': models.bucketChecked}"></i> </td> <td> <div class=buckets-name ng-class="{\'bucket-selected\': models.bucketChecked}"> {{ bucketName }} </div> </td> <td> <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': models.bucketChecked}" ng-click=configureMetrics()></span> </td> </tr> </table> </td> </tr> <tr ng-if=models.toggleMetricsConfig> <td class="bucket-dropdown-config dark"> <div class=new-filter-params> <div class=select-metrics-row> <div class=select-metrics-text translate=management.metrics.side.select.select.info> </div> <div class="select-metrics-learn-more dark"> <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target=_blank class=ng-binding translate>learn.more</a> </div> </div> <div class=list-all-metrics> <div ng-repeat="metricType in metricTypes"> <div class=expandable-metrics-dropdown ng-model=collapsed ng-init="collapsed=true" data-disabled=models.applyingConfig ng-click="collapsed=!collapsed"> <awsui-checkbox class=checkbox checked=metricType.checked change=checkAllPaidMetrics(metricType) data-disabled=metricType.disable ng-model=metricType.checked></awsui-checkbox> <span ng-if=collapsed class="awsui-icon caret-right awsui-icon-light section"></span> <span ng-if=!collapsed class="awsui-icon caret-down awsui-icon-light section"></span> <div class="dropdown-text section"> {{metricType.title}} ({{metricType.metrics.length}}) </div> <div class=metric-charge-info>{{ metricType.info }}</div> <div class=specific-metrics ng-show=!collapsed> <div class=specific-metric ng-repeat="specificMetric in metricType.metrics"> <div class=specific-metric-text> <awsui-checkbox checked=true data-disabled=true> {{specificMetric.name}} </awsui-checkbox> </div> </div> </div> </div> </div> </div> <div class=select-metrics-buttons> <table> <tr> <td class=metric-button-spacing> <awsui-button variant=primary text="{{ \'button.save\'   | translate}}" class=normal-button ng-click=applyMetricsConfig() loading=models.applyingConfig></awsui-button> </td> <td> <awsui-button variant=normal text="{{ \'button.cancel\' | translate}}" class=normal-button ng-click=cancelMetricsConfig() data-disabled=models.applyingConfig></awsui-button> </td> </tr> </table> </div> </div> </td> </tr> <tr> <td class=filter-header> <table border=0px class=filters-table-header> <tr> <td> <div class=row-checkbox> <awsui-checkbox checked=false change=viewAllFilters() data-disabled="filterList.length === 0" ng-model=models.allFilters></awsui-checkbox> </div> </td> <td> <div class=filter-title translate=management.metrics.side.filter.header translate-values="{count: filterList.length}"></div> </td> <td> <div class=filter-add ng-click=addFilter()> <div class="awsui-icon awsui-icon-link plus" translate=management.metrics.side.filter.add></div> </div> </td> </tr> </table> </td> </tr> <tr ng-if=models.showAddFilter> <td class="bucket-dropdown-config dark"> <table> <tr> <td class=filter-title-cell> <div class=filter-add-title translate=management.metrics.side.filter.dropdown.add> </div> </td> </tr> <tr> <td> <div class=new-filter-params> <div class=new-filter-text translate=management.metrics.side.filter.name.title> </div> <div class=new-filter-input> <awsui-control-group> <span class=error-background-fix dom-region=validationMessage ng-if=models.filterNameError> {{models.filterNameError}} </span> <awsui-textfield id=cloudwatch-filterinput placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup=validateFilter() data-disabled="models.editFilter || models.savingFilter" ng-model=models.filterName></awsui-textfield> </awsui-control-group> </div> <div class=new-filter-text translate=management.metrics.side.filter.prefix.title> </div> <div class=new-filter-input ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }"> <search filters=filters no-backend-calls=true search-error=models.filterValueError></search> </div> <div class=select-metrics-buttons> <table> <tr> <td colspan=2> <div class=filter-delete> <awsui-button data-disabled="models.deleteFilter || models.savingFilter" loading=models.deleteFilter icon="" variant=link ng-click=deleteFilter() ng-if=models.editFilter text="{{ \'management.metrics.action.delete\' | translate }}"> </awsui-button> </div> </td> </tr> <tr> <td class=metric-button-spacing> <awsui-button variant=primary text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                      || !models.filterName || models.filterNameError" class=normal-button loading=models.savingFilter ng-click=saveFilter()></awsui-button> </td> <td> <awsui-button variant=normal text="{{ \'button.cancel\' | translate}}" class=normal-button data-disabled="models.savingFilter || models.deleteFilter" click=cancelFilter()></awsui-button> </td> </tr> </table> <div class=filter-error> <awsui-alert type=error header="{{\'error.header\'|translate}}" ng-if=models.filterError>{{models.filterError}} </awsui-alert> </div> </div> </div> </td> </tr> </table> </td> </tr> <tr ng-if="!models.showAddFilter && filterList.length > 0" class=filter-header> <td> <table class=filters-table> <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'row-selected\' : row.checked, \'row-hover\': hoverRule && !row.checked}" ng-click="filterChanged(row, $event)" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false"> <td> <div class=row-checkbox> <awsui-checkbox data-disabled=false checked=row.checked change=filterChanged(row) ng-click=$event.stopPropagation()></awsui-checkbox> </div> </td> <td class=filter-name-row> <div> {{row.Id}} </div> </td> <td> <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click=addFilter(row)></span> </td> </tr> </table> </td> </tr> <tr ng-if="!models.showAddFilter && filterList.length === 0"> <td> <div class=side-panel-metrics-help> <span translate=management.metrics.side.filter.help></span> <br> <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target=_blank class=ng-binding translate>learn.more</a> <br> <br> <awsui-button data-disabled=false loading=false icon=plus variant=primary ng-click=addFilter()> {{ \'management.metrics.side.filter.add\' | translate}} </awsui-button> </div> </td> </tr> </table> </div> </div> <div class="metrics-content-cell flex-expand"> <div> <div class=metrics-loading ng-if=metricsLoading> <span class="awsui-icon awsui-spinner awsui-spinner-large"/> </div> <nav ng-if=!metricsLoading> <div class=si-top-right-header> <div class=h-container> <div class="metric-type flex-expand h-container"> <div ng-repeat="(key, metricType) in S3Constants.METRICS.TYPE" class=metric-type__item ng-class="{\'type-selected\' : selectedMetricType === metricType}" ng-click=setSelectedMetricType(metricType)> <label class=metric-type-label>{{ getGroupTitle(metricType) }}</label> </div> </div> <div class="time-range h-container align-items-center"> <div class=time-range__item ng-repeat="timeRange in metricTimeRangeList"> <div ng-class="{\'timeframe-selected\': selectedTimeFrame === timeRange.id}" ng-click=setTimeRange(timeRange.id) translate>{{timeRange.translateKey}} </div> </div> <div class=time-range__item> <span class="awsui-icon refresh awsui-icon-light" ng-click=refresh()></span> </div> </div> </div> </div> <div class="si-metrics-list-header h-container align-items-center"> <div class="metrics-link-table h-container flex-expand"> <div ng-repeat="metric in metricsWithStats" ng-click=goToChart(metric.ref.chartId) class=metrics-link-table__item> <label class=metric-name ng-class="{\'timeframe-selected\': selectedMetricGroup === metric.display}" ng-click=setMetricGroup(metric.display)> {{ metric.display }} </label> </div> </div> <label class=metrics-update-time>{{ models.updatedOn }}</label> </div> <div class=metrics-error-main> <awsui-alert type=error header="{{\'error.header\'|translate}}" visible=error>{{error}} </awsui-alert> <awsui-alert header="{{\'management.metric.info\'|translate}}" visible=info>{{info}} </awsui-alert> </div> <div class=inner-tab-container ng-if=metrics[selectedMetricType]> <metrics-monitoring metric-list=metrics[selectedMetricType] zoom=selectedTimeFrame></metrics-monitoring> </div> </nav> </div> </div> </div> '},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){n(738),e.module("s3").directive("bucketReports",[function(){return{restrict:"E",scope:{},template:n(739),controller:"ReportsController"}}]),e.module("s3").controller("ReportsController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPolicyService","BucketPropertiesUtilService","BucketPropertiesService","ConsoleOperation","FAC","InventoryConstants","ManagementDataProcessor","PathService","Region","S3Constants","SCLogService","UtilService","XMLParser","KMSPropertiesService","$location",function(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A){function C(){var e=n.reportsTable.length>0,t=n.selectedRowIndex>=0,r=n.reportsTable[n.selectedRowIndex];n.actionsDisabled()||e&&t&&G(r)&&n.isStatusEnabled(r)?(n.moreOptions[0].items[0].disabled=!0,n.moreOptions[0].items[1].disabled=!0):(n.moreOptions[0].items[0].disabled=!(e&&t&&!n.isStatusEnabled(r)),n.moreOptions[0].items[1].disabled=e&&t&&!n.isStatusEnabled(r))}function _(){n.kmsKeys=[];var e=new d("GetKMSKeysForInventoryReport");return y.getKMSKeysByArn(e,W,b.OBJECT_SSE.CUSTOM_ARN).then(function(e){n.kmsKeys=e}).catch(function(e){throw n.KMSServiceError=e,e})}function w(){return{name:"",type:f.TYPE.OBJECT,filter:"",bucket:"",format:f.REPORT_FORMAT.CSV,prefix:"",freq:f.FREQUENCY.DAILY,versioning:f.VERSIONING.CURRENT,status:H,isEditing:!0,state:z.CREATE,optional:U(),accountId:null,bucketError:!1,nameError:!1,encryption:{type:b.OBJECT_SSE.NONE}}}function T(e){if(!e)return{type:b.OBJECT_SSE.NONE};if(e[f.SSE_S3])return{type:b.OBJECT_SSE.AES256};if(e[f.SSE_KMS]){var t=e[f.SSE_KMS].KeyId;return t?{type:b.OBJECT_SSE.KMS_ENCRYPTION,kmsOption:{kmsId:{value:t,text:E.getKMSAliasForArn(t,n.kmsKeys)}}}:{type:b.OBJECT_SSE.NONE}}}function R(e){var t=w();return t.name=e.Id,t.freq=e.Schedule.Frequency.toUpperCase(),t.bucket=l.stripBucketARN(e.Destination.S3BucketDestination.Bucket),t.encryption=T(e.Destination.S3BucketDestination.Encryption),e.Filter&&(t.filter=e.Filter.Prefix),e.Destination.S3BucketDestination.Prefix&&(t.prefix=e.Destination.S3BucketDestination.Prefix),e.Destination.S3BucketDestination.Format&&(t.format=e.Destination.S3BucketDestination.Format),e.Destination.S3BucketDestination.AccountId&&(t.accountId=e.Destination.S3BucketDestination.AccountId),t.isEditing=!1,e.OptionalFields&&e.OptionalFields.Field&&[].concat(e.OptionalFields.Field).forEach(function(e){t.optional[e]=!0}),e.IncludedObjectVersions===f.VERSIONING.CURRENT?t.versioning=e.IncludedObjectVersions:t.versioning=f.VERSIONING.ALL,t.status="true"===e.IsEnabled?H:q,t}function O(e){var t=e.InventoryConfiguration;t&&[].concat(t).forEach(function(e){n.reportsTable.push(R(e))})}function k(e){var t=new d("getObjectInventory");v.log("getObjectInventoryReceived",1,t);var r={path:W};e&&(r.params={"continuation-token":e}),o.getObjectInventory(t,W,r).then(function(e){var r=e.response;if(v.logRequestComplete("getObjectInventory",t),r){var i=S.convertXmlStringToJson(r);O(i.ListInventoryConfigurationsResult),"true"===i.ListInventoryConfigurationsResult.IsTruncated?k(i.ListInventoryConfigurationsResult.NextContinuationToken):(n.reportsTable.length>0&&(n.radioValue.value=0,n.selectedRowIndex=0),V(W),n.finishedLoading=!0)}}).catch(function(e){e&&j(e)}).finally(function(){n.finishedLoading=!0})}function I(e){var t=new d("deleteObjectInventoryConfig");return o.deleteObjectInventoryConfig(t,W,{path:W,params:{id:e.name}}).then(function(e){v.logRequestComplete("deleteObjectInventoryConfig",t),n.isEditingRow=!1,n.showAdvancedSettingsDropdown=!1}).catch(function(n){return j(n),v.log("deleteObjectInventoryConfig",0,t,{objectName:e,error:n}),!1}),!0}function P(e){return 0===e.length?void 0:1===e.length?e.charAt(0).toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function N(e){var n=b.OBJECT_SSE.NONE;switch(e.encryption.type){case b.OBJECT_SSE.AES256:n=r({},f.SSE_S3,"");break;case b.OBJECT_SSE.KMS_ENCRYPTION:var i=t.get(e,"encryption.kmsOption.kmsId.value");i===b.OBJECT_SSE.CUSTOM_ARN&&(i=t.get(e,"encryption.kmsOption.kmsARN")),n=r({},f.SSE_KMS,{KeyId:i})}return n}function M(e){var t={};return t.Format=e.format||f.REPORT_FORMAT.CSV,e.accountId&&(t.AccountId=e.accountId),t.Bucket=E.getBucketARN(e.bucket),e.prefix.length>0&&(t.Prefix=e.prefix),N(e)!==b.OBJECT_SSE.NONE&&(t.Encryption=N(e)),{S3BucketDestination:t}}function L(e){return t.keys(t.pick(e.optional,function(e){return e}))}function x(e){var t={};return t.Id=e.name,t.IsEnabled=K(e.status),e.filter.length>0&&(t.Filter={Prefix:e.filter}),t.Destination=M(e),t.Schedule={Frequency:P(e.freq)},t.IncludedObjectVersions=e.versioning,t.OptionalFields={Field:L(e)},t}function D(e){return'<?xml version="1.0" encoding="UTF-8"?><InventoryConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">'+e+"</InventoryConfiguration>"}function j(e){n.showError=!0,n.errorMessage=E.handleErrors(e),n.isSaving=!1}function B(){n.showError=!1}function F(e){e&&(e.nameError=!1,e.bucketError=!1)}function U(){return{Size:null,LastModifiedDate:null,StorageClass:null,ETag:null,ReplicationStatus:null,IsMultipartUploaded:null,EncryptionStatus:null,IntelligentTieringAccessTier:null,ObjectLockMode:null,ObjectLockRetainUntilDate:null,ObjectLockLegalHoldStatus:null}}function K(e){switch(e){case H:return"true";case q:return"false"}}function V(e){g.retrieveInventoryStatus(e,n.reportsTable).then(function(e){t.each(e,function(e){e.status===b.S3_SHARED_DATA.FAILED?n.lastExports[e.name]={displayText:a.instant("management.inventory.data.exporterror."+e.errorCode.toLowerCase()),status:e.status,tooltipMessage:a.instant("management.inventory.data.exportstatus."+e.errorCode.toLowerCase(),{date:e.lastExportDate})}:e.status===b.S3_SHARED_DATA.SUCCESS&&(n.lastExports[e.name]={displayText:e.lastExportDate,status:e.status,manifestPath:e.manifestPath})})})}function G(e){return!!e&&e.freq===f.FREQUENCY.ONETIME}var Y,W,z=b.ENTRY_STATE,$=b.LEARN_MORE_LINKS;n.outputFormatDocLink=s.getDocUrl($.INVENTORY_OUTPUT_FORMAT),n.finishedLoading=!1,n.selectingBucket={selected:!1},n.exampleEmptyReport=w(),n.flags={displayDelayWarning:!1},n.customARN=b.OBJECT_SSE.CUSTOM_ARN,n.awsKMS=b.OBJECT_SSE.KMS_ENCRYPTION;var H=b.MANAGEMENT.INVENTORY.ENABLED,q=b.MANAGEMENT.INVENTORY.DISABLED;n.reportFormat=[{value:f.REPORT_FORMAT.CSV,name:f.REPORT_FORMAT.CSV,description:a.instant("report.csv.info")},{value:f.REPORT_FORMAT.ORC,name:"Apache ORC"}],p.isFeatureEnabled(b.FAC.INVENTORY_PARQUET)&&n.reportFormat.push({value:f.REPORT_FORMAT.PARQUET,name:"Apache Parquet"}),n.batchOpsIntegrationEnabled=p.isFeatureEnabled(b.FAC.BATCH_OPERATIONS_INVENTORY),n.policyStatus={policyMessage:"",policyHeader:"",policyType:"info",policyDefinition:""},n.kmsPolicyStatus={policyMessage:"",policyHeader:"",policyDefinition:""},n.triggerActionsDropdown=function(){C()},n.getLearnMoreLink=function(e){return s.getDocUrl($["storage-management"][e])},n.toggleAdvancedSettingsDropdown=function(){n.showAdvancedSettingsDropdown=!n.showAdvancedSettingsDropdown},n.validatePrefix=function(){var e=n.rowBeingEdited;n.filterInfo="",n.prefixInfo="",e.filter&&0===e.filter.indexOf(b.DELIMITER)&&(n.filterInfo=e.filter,n.bucketName=W),e.prefix&&0===e.prefix.indexOf(b.DELIMITER)&&(n.prefixInfo=e.prefix,n.bucketNamePre=e.bucket)},n.validateName=function(e){var r=t.countBy(n.reportsTable,function(t){return t.name===e.name?"dups":"unique"});e.invalidNameMessage="",r.dups>1?e.invalidNameMessage=a.instant("report.name.error.duplicate"):e.name.length<1||e.name.length>64?e.invalidNameMessage=a.instant("report.name.error.length"):n.configPattern.test(e.name)||(e.invalidNameMessage=a.instant("report.name.error.characters")),e.invalidNameMessage?e.nameError=!0:e.nameError=!1},n.validateForm=function(e){return n.validateName(e),e.bucket?e.bucketError=!1:e.bucketError=!0,e.hasErrors=e.nameError||e.bucketError,!e.hasErrors},n.selectRow=function(e){n.isEditingRow?n.radioValue.value=n.selectedRowIndex:n.completeEdit()&&(n.selectedRowIndex=e,n.radioValue.value=e),n.flags.displayDelayWarning=!1},n.closeAddReport=function(e){B(),e&&n.rowBeingEdited.state===z.CREATE&&(n.rowBeingEdited.state=z.ADDED),n.isExpanded=!1,n.rowBeingEdited=null},n.deletePressed=function(){if(0!==n.radioValue.value.length){var e=n.reportsTable[n.selectedRowIndex],r=t.findIndex(n.reportsTable,function(t){return t.name===e.name});-1!==r&&I(n.reportsTable[r])&&(n.reportsTable.splice(r,1),n.radioValue.value="",n.selectedRowIndex=-1),E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.DELETE_CONFIG,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),n.flags.displayDelayWarning=!1,n.resetPolicyStatus()}},n.cancelPressed=function(e){e.stopPropagation(),E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),F(n.reportsTable[n.selectedRowIndex]),n.isAdding?(n.selectedRowIndex--,n.isAdding=!1,n.reportsTable.shift()):(n.reportsTable[n.selectedRowIndex]=n.tempRow,n.tempRow=null),n.radioValue.value=n.selectedRowIndex,n.completeEdit(!1),n.isEditingRow=!1,n.rowBeingEdited.isEditing=!1,n.showAdvancedSettingsDropdown=!1,n.closeAddReport(!1),n.radioValue.value=n.selectedRowIndex},n.successAddHandler=function(){n.isAdding&&(n.selectedRowIndex=0,n.radioValue.value=n.selectedRowIndex,n.isAdding=!1)},n.successSaveHandler=function(){n.isEditingRow=!1,n.showAdvancedSettingsDropdown=!1},n.reportFormatSelected=function(e,t){e.format=t.value},n.encryptionSelected=function(e,t){e.encryption.type=t},n.statusSelected=function(e,t){e.status=t},n.saveRow=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];t.isEmpty(e)||e.stopPropagation(),n.isSaving=!0,E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.SAVE_CONFIG,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);var r=null;if(r=n.isAdding?n.reportsTable[0]:n.reportsTable[n.selectedRowIndex],n.validateForm(r),r.hasErrors||r.bucketUnknown)return void(n.isSaving=!1);var i=!1;n.isAdding&&(i=!0),n.saveReport(r,i),n.radioValue.value=n.selectedRowIndex},n.saveReport=function(e,t){var r=new d("putObjectInventoryConfig"),i=x(e),a=D(S.jsonToXml(i));return v.log("putObjectInventoryConfigReceived",1,r),o.putObjectInventoryConfig(r,W,{path:W,params:{id:e.name},content:a}).then(function(i){return v.log("putObjectInventoryConfig",1,r,{data:a}),n.isSaving=!1,n.rowBeingEdited.isEditing=!1,n.flags.displayDelayWarning=n.isStatusEnabled(n.rowBeingEdited),t||e.name===n.tempRow.name?(n.successAddHandler(),n.closeAddReport(!0),n.successSaveHandler()):I(n.tempRow),c.createBucketPolicy(W,e.bucket,n.policyStatus),!0}).catch(function(t){return v.log("putObjectInventoryConfig",0,r,{objectName:e,error:t}),j(t),!1}),!0},n.completeEdit=function(e){var t=n.rowBeingEdited;return!t||(F(t),""!==t.name&&!t.invalidNameMessage&&""!==t.bucket||t.state===z.CREATE&&""===t.name&&""===t.bucket&&""===t.filter&&""===t.prefix||(!e||t.state!==z.CREATE)&&(""===t.name&&(t.nameError=!0),""===t.bucket&&(t.bucketError=!0),!1))},n.addRow=function(t){if(t.stopPropagation(),n.completeEdit()){E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.ADD_CONFIG,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),n.isAdding=!0,n.isExpanded=!0;var r=w();n.reportsTable.unshift(r),n.rowBeingEdited=r,n.selectedRowIndex++,n.radioValue.value=!1,n.isEditingRow=!0,n.showAdvancedSettingsDropdown=!0,n.prefixInfo="",n.filterInfo="",n.resetPolicyStatus(),i(function(){e.element("#report-name-input input").focus()})}n.flags.displayDelayWarning=!1},n.editRow=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=arguments.length<=1||void 0===arguments[1]||arguments[1],i=arguments.length<=2||void 0===arguments[2]||arguments[2];t.isEmpty(e)||e.stopPropagation(),n.showAdvancedSettingsDropdown=r;var a=n.selectedRowIndex,o=n.reportsTable[a];E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.EDIT_CONFIG,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),o&&(n.tempRow=JSON.parse(JSON.stringify(o))),n.completeEdit()&&(o.isEditing=i,n.rowBeingEdited=n.reportsTable[n.selectedRowIndex],n.isEditingRow=i),n.flags.displayDelayWarning=!1,n.radioValue.value=!1,n.resetPolicyStatus()},n.getPrefixValue=function(e){return 0===e.length?"-":e},n.getFrequencyTranslationValue=function(e){switch(e){case f.TYPE.OBJECT:return a.instant("report.type.object");case f.FREQUENCY.DAILY:return a.instant("report.freq.daily");case f.FREQUENCY.WEEKLY:return a.instant("report.freq.weekly");case f.FREQUENCY.ONETIME:return a.instant("report.freq.onetime")}},n.getStatusTraslationValue=function(e){switch(e){case H:return a.instant("report.statusreport.enabled");case q:return a.instant("report.statusreport.disabled")}},n.getLastExportTooltipMessage=function(e){return e in n.lastExports?n.lastExports[e].tooltipMessage:""},n.getLastExportInfo=function(e){return e in n.lastExports?n.lastExports[e].displayText:""},n.getLastExportManifestPath=function(e){return e in n.lastExports?n.lastExports[e].manifestPath:""},n.hasLastExportFailed=function(e){return e in n.lastExports&&n.lastExports[e].status===b.S3_SHARED_DATA.FAILED},n.getFilterValue=function(e){return e||a.instant("report.filter.bucket")},n.resetDelayWarning=function(){n.flags.displayDelayWarning=!1},n.resetPolicyStatus=function(){n.policyStatus={policyMessage:"",policyHeader:"",policyDefinition:"",policyType:"info"},n.kmsPolicyStatus={policyMessage:"",policyHeader:"",policyDefinition:""}},n.shouldDisableSave=function(e){var r=e.encryption.type===b.OBJECT_SSE.KMS_ENCRYPTION,i=void 0;r&&(i=!t.isEmpty(t.get(e,"encryption.kmsOption.kmsId")),t.get(e,"encryption.kmsOption.kmsId.value")===b.OBJECT_SSE.CUSTOM_ARN&&(i=!t.isEmpty(t.get(e,"encryption.kmsOption.kmsARN"))));var a=!r||i;return e.nameError||!e.bucket||e.bucketError||n.selectingBucket.selected||e.bucketUnknown||!a},n.encryptionStatusClicked=function(e,t){e.stopPropagation(),t.encryption.type=b.OBJECT_SSE.AES256},n.actionsDisabled=function(){return 0===n.reportsTable.length||n.isAdding||n.isEditingRow||n.selectedRowIndex<0},n.editButtonDisabled=function(){if(n.actionsDisabled())return!0;if(p.isFeatureEnabled(b.FAC.ONE_TIME_INVENTORY)){var e=n.reportsTable[n.selectedRowIndex];return G(e)&&n.isStatusEnabled(e)}return!1},n.isStatusEnabled=function(e){return!!e&&e.status===H},n.getSelectedReport=function(){return n.reportsTable[n.selectedRowIndex]},n.canCreateJob=function(){var e=n.getSelectedReport().name;return!n.hasLastExportFailed(e)&&n.getLastExportManifestPath(e)},n.createJob=function(){n.createJobWorking=!0;var e=n.getSelectedReport().bucket;u.getBucketLocation(e).then(function(e){J(e)}).catch(function(){J(h.getCurrentRegion())}).finally(function(){n.createJobWorking=!1})};var J=function(e){A.search(b.JOB_MANIFEST_PARAM,X()),A.search("region",e),A.path("/"+b.PATH_SEGMENTS.JOBS+"/"+b.PATH_SEGMENTS.JOB_CREATE)},X=function(){var e=n.getSelectedReport();return"s3://"+e.bucket+"/"+n.getLastExportManifestPath(e.name)};n.getObjectLockGroupHeader=function(e){var t=[e.optional.ObjectLockMode,e.optional.ObjectLockRetainUntilDate,e.optional.ObjectLockLegalHoldStatus].filter(Boolean).length;return n.allObjectLockGroupLabel+(t>0?a.instant("report.groupselection.selected",{count:t}):"")},n.onAllObjectLockStatusClick=function(e,t){var r=!n.isAllObjectLockStatusSelected(e);e.optional.ObjectLockMode=r,e.optional.ObjectLockRetainUntilDate=r,e.optional.ObjectLockLegalHoldStatus=r},n.isAllObjectLockStatusSelected=function(e){return e.optional.ObjectLockMode&&e.optional.ObjectLockRetainUntilDate&&e.optional.ObjectLockLegalHoldStatus},n.onAllObjectLockStatusClick=function(e,t){var r=!n.isAllObjectLockStatusSelected(e);e.optional.ObjectLockMode=r,e.optional.ObjectLockRetainUntilDate=r,e.optional.ObjectLockLegalHoldStatus=r},n.isAllObjectLockStatusSelected=function(e){return e.optional.ObjectLockMode&&e.optional.ObjectLockRetainUntilDate&&e.optional.ObjectLockLegalHoldStatus},n.getObjectLockGroupHeader=function(e){var t=[e.optional.ObjectLockMode,e.optional.ObjectLockRetainUntilDate,e.optional.ObjectLockLegalHoldStatus].filter(Boolean).length;return n.allObjectLockGroupLabel+(t>0?a.instant("report.groupselection.selected",{count:t}):"")},n.onAllObjectLockStatusClick=function(e,t){var r=!n.isAllObjectLockStatusSelected(e);e.optional.ObjectLockMode=r,e.optional.ObjectLockRetainUntilDate=r,e.optional.ObjectLockLegalHoldStatus=r},n.isAllObjectLockStatusSelected=function(e){return e.optional.ObjectLockMode&&e.optional.ObjectLockRetainUntilDate&&e.optional.ObjectLockLegalHoldStatus},function(){if(W=m.getCurrentBucket(),Y=new d("GetBuckets"),n.showAdvancedSettingsDropdown=!0,n.rowBeingEdited=null,n.headerTitle=a.instant("report.label.new"),n.isAdding=!1,n.isSaving=!1,n.radioValue={value:0},n.selectedRowIndex=-1,n.selectedRow=null,n.showError=!1,n.isEditingRow=!1,n.regions=h.regionMapping,n.reportsTable=[],n.lastExports={},n.bucketList||(n.bucketList=[]),n.configPattern=new RegExp("^[a-zA-Z0-9-_.]+$"),n.freqTypes=[{value:f.FREQUENCY.DAILY,text:a.instant("report.freq.daily")},{value:f.FREQUENCY.WEEKLY,text:a.instant("report.freq.weekly")}],n.versionTypes=[{value:f.VERSIONING.ALL,text:a.instant("report.versions.all")},{value:f.VERSIONING.CURRENT,text:a.instant("report.versions.current")}],n.encryption=[[b.OBJECT_SSE.AES256,a.instant("sse.aes256")]],p.isFeatureEnabled(b.FAC.NO_ENC)){var e=[b.OBJECT_SSE.NONE,a.instant("sse.none")];n.encryption.unshift(e)}if(p.isFeatureEnabled(b.FAC.KMS)){var t=[b.OBJECT_SSE.KMS_ENCRYPTION,a.instant("sse.aws.kms")];n.encryption.push(t),_().finally(function(){return k()})}else k();if(p.isFeatureEnabled(b.FAC.ONE_TIME_INVENTORY)){var r={value:f.FREQUENCY.ONETIME,text:a.instant("report.freq.onetime")};n.freqTypes.push(r)}n.statusOptions=[[H,a.instant("report.statusreport.enabled")],[q,a.instant("report.statusreport.disabled")]],n.inventoryEncryptionLink=s.getDocUrl($.INVENTORY_ENCRYPTION),n.allObjectLockGroupLabel=a.instant("report.optional.allobjectlock");var i={id:f.ACTION.ENABLE,text:a.instant("report.dropdown.enable"),action:function(){E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.EDIT_ACTIONS_DROPDOWN,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),n.editRow({},!1,!1),n.statusSelected(n.getSelectedReport(),H),n.saveRow()},disabled:!0},o={id:f.ACTION.DISABLE,text:a.instant("report.dropdown.disable"),action:function(){E.analyticsTrackClick(b.ANALYTICS.MANAGEMENT.EDIT_ACTIONS_DROPDOWN,b.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT),n.editRow({},!1,!1),n.statusSelected(n.getSelectedReport(),q),n.saveRow()},disabled:!0};n.moreOptions=[{items:[i,o]}]}()}])}()}).call(t,n(0),n(2))},function(e,t,n){e.exports=n.p+"img/no-inventory-reports.png"},function(e,t){e.exports='<div class=inventory-reports> <div ng-if="!finishedLoading && !showError" class="awsui-spinner awsui-spinner-large" style="margin:10% 50%"> </div> <div ng-if="showError && reportsTable.length === 0"> <awsui-alert type=error visible=showError>{{ errorMessage }}</awsui-alert> </div> <div ng-if=flags.displayDelayWarning> <awsui-alert id=inventory-delay-alert dismissible=true ng-click=resetDelayWarning() visible=flags.displayDelayWarning header="{{\'report.warning.header\' | translate}}"> <span translate>report.warning.text</span> </awsui-alert> </div> <div ng-if=policyStatus.policyMessage> <awsui-alert id=inventory-policy-message dismiss=resetPolicyStatus() type={{policyStatus.policyType}} dismissible=true visible=policyStatus.policyMessage header={{policyStatus.policyHeader}}> <div>{{policyStatus.policyMessage}} <span> <a href="{{getLearnMoreLink(\'configure-inventory\')}}" target=_blank translate>learn.more</a> </span> </div> <div class=policy-definition ng-if=policyStatus.policyDefinition> <pre>{{policyStatus.policyDefinition}}</pre> </div> </awsui-alert> </div> <div class=empty-object-inventory ng-if="reportsTable.length === 0 && finishedLoading && !showError"> <span class=no-reports-enabled translate>report.emptymessage</span> <div class=no-inventory-reports-icon><img src=/s3/img/no-inventory-reports.png></div> <div class=inventory-header translate>report.inventory</div> <div class=inventory-additional-information translate>report.additionalInformation</div> <awsui-button id=add-new-report variant=link icon=plus text="{{ \'report.button.add\' | translate }}" click=addRow($event)></awsui-button> </div> <div ng-if="reportsTable.length > 0 && finishedLoading"> <awsui-button id=create-new-report disabled="isAdding || isEditingRow" variant=primary icon=plus text="{{ \'report.button.add\' | translate }}" click=addRow($event)></awsui-button> <awsui-button id=edit-report disabled=editButtonDisabled() variant=normal text="{{ \'report.button.edit\' | translate }}" click=editRow($event)> </awsui-button> <awsui-button id=create-job disabled="editButtonDisabled() || !canCreateJob()" variant=normal ng-if=batchOpsIntegrationEnabled loading=createJobLoading text="{{ \'report.button.createjob\' | translate }}" click=createJob()> </awsui-button> <awsui-button id=delete-report disabled=editButtonDisabled() variant=normal text="{{ \'events.button.delete\' | translate }}" click=deletePressed() loading=isDeleting> </awsui-button> <action-dropdown id=report-actions-dropdown fac-id=s3-one-time-inventory class=bucket-more-dropdown text="{{ \'report.button.actions\' | translate }}" ng-click="triggerActionsDropdown(); $event.stopPropagation();" items=moreOptions disable-take-action=true></action-dropdown> <div class=events-table> <div class=events-table> <awsui-radio-group ng-model=radioValue.value> <table class="table table-condense reports-table"> <thead> <tr> <td class=report-radio></td> <td translate>report.label.name</td> <td translate>report.label.filter</td> <td> {{\'report.label.bucket\' | translate}} <awsui-tooltip text="{{ \'report.bucketPolicy.tooltip\' | translate }}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </td> <td translate>report.label.prefix</td> <td translate>report.label.freq</td> <td translate>report.label.lastexport</td> <td fac-id=s3-one-time-inventory translate>report.statusreport.name</td> </tr> </thead> <tbody> <tr ng-if=row.isEditing ng-repeat-start="row in reportsTable" class=no-top-border> <td></td> <td class="report-input input-td"> <awsui-control-group class=label-text validation-message={{row.invalidNameMessage}}> <awsui-textfield id=report-name-input ng-class="{\'inventory-input-text\' : !row.nameError, \'verification-error\': row.nameError}" placeholder="{{\'report.placeholder.name\' | translate}}" ng-keyup=validateName(row) ng-model=row.name></awsui-textfield> </awsui-control-group> </td> <td class=input-td> <awsui-control-group class=label-text> <span dom-region=validationMessage ng-if=filterInfo> <span translate translate-values="{ bucket1 : bucketName + \'/\' + filterInfo, bucket2: bucketName + filterInfo }">prefixsearch.validation.slash.start.warning</span> </span> <span dom-region=control> <awsui-textfield id=report-filter-input class=inventory-input-text placeholder="{{\'report.placeholder.filter\' | translate}}" ng-keyup=validatePrefix() ng-model=row.filter></awsui-textfield> </span> </awsui-control-group> </td> <td class=input-td> <awsui-control-group id=bucket-options-dropdown class=label-text validation-message={{row.bucketUnknown}}> <bucket-selector class=bucket-selector-object-inventory selected-report=row show-bucket-name-only=true choose-accounts=true editable=true same-region=true is-open=selectingBucket.selected /> </awsui-control-group> </td> <td class=input-td> <awsui-control-group class=label-text> <span dom-region=validationMessage ng-if=prefixInfo> <span translate translate-values="{ bucket1 : bucketNamePre + \'/\' + prefixInfo, bucket2: bucketNamePre + prefixInfo }">prefixsearch.validation.slash.start.warning</span> </span> <span dom-region=control> <awsui-textfield id=report-dest-prefix-input class=inventory-input-text placeholder="{{\'report.placeholder.prefix\' | translate}}" ng-keyup=validatePrefix() ng-model=row.prefix data-disabled=!row.bucket> </awsui-textfield> </span> </awsui-control-group> </td> <td class="frequency-input input-td"> <awsui-control-group class=label-text> <awsui-select id=report-frequency-dropdown items=freqTypes class=select-type-dropdown ng-model=row.freq ng-click=$event.stopPropagation()></awsui-select> </awsui-control-group> </td> </tr> <tr fac-id=s3-one-time-inventory ng-if="row.freq === \'ONE-TIME\' && row.isEditing" class=no-top-border> <td></td> <td colspan=5> <awsui-alert id=inventory-one-time-alert visible=true> <span translate>report.info.onetime</span> </awsui-alert> </td> </tr> <tr ng-if=row.isEditing class=no-top-border> <td></td> <td colspan=5 ng-if=!showAdvancedSettingsDropdown> <awsui-button icon=plus text="{{ \'bucketproperties.title.advancedsettings\' | translate }}" variant=link ng-click=toggleAdvancedSettingsDropdown()></awsui-button> </td> <td colspan=5 ng-if=showAdvancedSettingsDropdown> <awsui-button text="- {{ \'bucketproperties.title.advancedsettings\' | translate }}" variant=link ng-click=toggleAdvancedSettingsDropdown()></awsui-button> <table> <tbody> <tr> <div class=inventory-description-label></div> </tr> <tr id=report-format fac-id=s3-report-format> <th class=advanced-header> <div class=advanced-header-label> <div translate>report.label.outputformat</div> </div> </th> <td> <div class=inventory-description-label> <span translate=report.description.outputformat></span> <learn-more-link href={{outputFormatDocLink}}> </learn-more-link> </div> <div class=inventory-group> <div ng-repeat="format in reportFormat"> <div class=inventory-radio-option> <div class=inventory-radio-button ng-class="{\'radio-checked\': row.format === format.value}" ng-click="reportFormatSelected(row, format)"></div> <span>{{format.name}}</span> </div> <div class=inventory-radio-description ng-if=format.description>{{format.description}}</div> </div> </div> </td> </tr> <tr> <th class=advanced-header> <div class="advanced-header-label advanced-header-label__dropdown" translate>report.label.versions</div> </th> <td> <div class=inventory-group> <awsui-control-group class=inventory-dropdown--no-label> <awsui-select items=versionTypes class=select-type-dropdown ng-model=row.versioning ng-click=$event.stopPropagation()></awsui-select> </awsui-control-group> </div> </td> </tr> <tr> <th class=advanced-header> <div class="advanced-header-label advanced-header-label__checkbox" translate>report.label.optional</div> </th> <td class=inventory-optional-fields> <div class=inventory-group> <awsui-control-group class=label-text> <awsui-checkbox id=report-size ng-model=row.optional.Size checked=row.optional.Size> {{\'report.optional.size\' | translate}}</awsui-checkbox> <awsui-checkbox id=last-modified-date ng-model=row.optional.LastModifiedDate checked=row.optional.LastModifiedDate> {{\'report.optional.modified\' | translate}} </awsui-checkbox> <awsui-checkbox id=storage-class ng-model=row.optional.StorageClass checked=row.optional.StorageClass> {{\'report.optional.storageclass\' | translate}} </awsui-checkbox> <awsui-checkbox id=etag ng-model=row.optional.ETag checked=row.optional.ETag> {{\'report.optional.ETag\' | translate}}</awsui-checkbox> <awsui-checkbox id=multi-part ng-model=row.optional.IsMultipartUploaded checked=row.optional.IsMultipartUploaded> {{\'report.optional.multipart\' | translate}} </awsui-checkbox> <awsui-checkbox id=replication-status ng-model=row.optional.ReplicationStatus checked=row.optional.ReplicationStatus> {{\'report.optional.replicationstatus\' | translate}} </awsui-checkbox> <awsui-checkbox id=encryption-status ng-click="encryptionStatusClicked($event, row)" ng-model=row.optional.EncryptionStatus checked=row.optional.EncryptionStatus fac-id=s3-inventory-encryption> {{\'report.optional.encryptionstatus\' | translate}} </awsui-checkbox> <awsui-checkbox id=int-access-tier-status ng-model=row.optional.IntelligentTieringAccessTier checked=row.optional.IntelligentTieringAccessTier fac-id=s3-inventory-int-access> {{\'report.optional.intelligenttieringaccesstier\' | translate}} </awsui-checkbox> <div fac-id=s3-inventory-int-access class=option-intelligent-tier-margain-left ng-if="row.optional.IntelligentTieringAccessTier === true"> <awsui-alert id=inventory-IntelligentTieringAccessTier-alert visible=true> <span translate>report.info.intelligenttiering</span> </awsui-alert> </div> <div fac-id=s3-oi-ol> <awsui-checkbox id=all-object-lock-status class=inventory-grouped-checkbox ng-submit="console.log(\'submit\')" change=onAllObjectLockStatusClick(row) checked=isAllObjectLockStatusSelected(row)> </awsui-checkbox> <awsui-expandable-section class=inventory-grouped-checkbox header={{getObjectLockGroupHeader(row)}} expanded=true> <awsui-checkbox id=retention-mode ng-model=row.optional.ObjectLockMode checked=row.optional.ObjectLockMode> {{\'report.optional.retentionmode\' | translate}} </awsui-checkbox> <awsui-checkbox id=retain-until-data ng-model=row.optional.ObjectLockRetainUntilDate checked=row.optional.ObjectLockRetainUntilDate> {{\'report.optional.retainuntildate\' | translate}} </awsui-checkbox> <awsui-checkbox id=legal-hold-status ng-model=row.optional.ObjectLockLegalHoldStatus checked=row.optional.ObjectLockLegalHoldStatus> {{\'report.optional.legalholdstatus\' | translate}} </awsui-checkbox> </awsui-expandable-section> </div> </awsui-control-group> </div> </td> </tr> <tr id=encryption-type fac-id=s3-inventory-encryption> <th class=advanced-header> <div class="advanced-header-label advanced-header-label__radio" translate>report.encryptreport</div> </th> <td> <div class=inventory-group> <div ng-repeat="value in encryption"> <div class=inventory-radio-option> <div class=inventory-radio-button ng-class="{\'radio-checked\': row.encryption.type === value[0]}" ng-click="encryptionSelected(row, value[0])"></div> <span>{{value[1]}}</span> </div> </div> <awsui-control-group class=encryption-keys> <dropdown ng-if="row.encryption.type === awsKMS" items=kmsKeys items=kmsKeys placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled=KMSServiceError selected-item=row.encryption.kmsOption.kmsId filter=true> </dropdown> </awsui-control-group> <div fac-id=s3-kms ng-if="row.encryption.type === awsKMS" class=configure-kms-key> <awsui-control-group validation-message="{{ KMSServiceError }}"> </awsui-control-group> <awsui-textfield ng-if="row.encryption.type === awsKMS && row.encryption.kmsOption.kmsId.value === customARN" ng-model=row.encryption.kmsOption.kmsARN> </awsui-textfield> <awsui-alert type=warning dismissible=false visible=true header="{{\'report.encryption.kms.header\' | translate}}"> {{\'report.encryption.kms.content\' | translate}} <a ng-href={{inventoryEncryptionLink}} target=_blank translate>learn.more</a> </awsui-alert> </div> </div> </td> </tr> <tr id=inventory-status-type fac-id=s3-one-time-inventory> <th class=advanced-header> <div class="advanced-header-label advanced-header-label__radio" translate>report.statusreport.name</div> </th> <td> <div class=inventory-group> <div ng-repeat="value in statusOptions"> <div class=inventory-radio-option> <div class=inventory-radio-button ng-class="{\'radio-checked\': row.status === value[0]}" ng-click="statusSelected(row, value[0])"> </div> <span>{{value[1]}}</span> </div> </div> </div> </td> </tr> <tr fac-id=s3-one-time-inventory ng-if="row.freq === \'ONE-TIME\' && row.isEditing && isStatusEnabled(row)"> <td colspan=1></td> <td colspan=4> <awsui-alert id=inventory-status-type-alert type=warning dismissible=false visible=true class=awsui-alert__header--hidden header=Warning> <div translate>report.warning.onetime</div> </awsui-alert> </td> </tr> </tbody> </table> </td> <td colspan=4></td> </tr> <tr ng-if=row.isEditing class="bucket-properties-buttons no-top-border"> <td></td> <td colspan=5 class=save-cancel-row> <awsui-button id=cancel-report text="{{ \'events.button.cancel\' | translate }}" variant=normal ng-click="!isSaving && cancelPressed($event)" data-disabled=isSaving class=cancel-button></awsui-button> <awsui-button id=save-report text="{{ \'events.button.save\' | translate }}" variant=primary data-disabled=shouldDisableSave(row) ng-click=saveRow($event) loading=isSaving></awsui-button> </td> </tr> <tr ng-if="row.isEditing && showError"> <td colspan=6> <awsui-alert type=error visible=showError>{{ errorMessage }}</awsui-alert> </td> </tr> <tr ng-class="{\'row-hover\': hoverRule && ($index !== selectedRowIndex), \'row-selected\': $index === selectedRowIndex}" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false" ng-if=!row.isEditing ng-click=selectRow($index) class=inventory-row ng-repeat-end> <td class=report-radio> <awsui-radio-button value={{$index}} disabled=isEditingRow> <td class=report-row>{{ row.name }}</td> <td class=report-row>{{ getFilterValue(row.filter) }}</td> <td class="awsui-icon bucket report-row" ng-class="{\'awsui-icon-light\': $index === selectedRowIndex}" class=report-row> {{ row.bucket }}</td> <td class=report-row>{{ getPrefixValue(row.prefix) }}</td> <td data-e2e-id=inventory-freq>{{ getFrequencyTranslationValue(row.freq) }}</td> <td> <awsui-tooltip text={{getLastExportTooltipMessage(row.name)}} position=bottom size=small> <span class="alert-exclamation-triangle awsui-icon warning-triangle-icon" ng-if=hasLastExportFailed(row.name) ng-class="{\'awsui-icon-light\': $index === selectedRowIndex}"></span> </awsui-tooltip> {{ getLastExportInfo(row.name) }} </td> <td class=report-row data-e2e-id=inventory-status-value fac-id=s3-one-time-inventory> {{ getStatusTraslationValue(row.status) }}</td> </awsui-radio-button> </td> </tr> </tbody> </table> </awsui-radio-group> </div> </div> </div> </div>'},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("barChartCard",[function(){return{restrict:"E",controller:"BarChartController",scope:{width:"=?",height:"=?",chartTitle:"=",data:"=",labels:"=?",colors:"=?",maxValue:"=?",footer:"=?"},link:function(e){e.$watch("data",function(t){t&&e.generateChart()})},template:n(741)}}]),e.module("s3").controller("BarChartController",["$scope","$window","$element","UtilService",function(e,t,n,r){function i(){o=e.maxValue,o/=.75}var a=t.d3;e.width=e.width||270,e.height=e.height||205;var o=e.maxValue;e.generateChart=function(){var t,s=25*e.data.length;i();for(var c=[],l=0;l<e.data.length;l++){var u=l%e.colors.bars.length,d=e.colors.bars[u];c.push({id:l,color:d,value:e.data[l]})}a.select(n[0].children[0].children[1])&&a.select(n[0].children[0].children[1]).select("svg").remove(),t=a.select(n[0].children[0].children[1]).append("svg").attr("class","chart").attr("width",.94*e.width).attr("height",s);var p=a.scale.linear().domain([0,o]).range([0,.94*e.width]),f=a.scale.ordinal().domain(c.map(function(e){return e.id})).rangeBands([0,s]);t.selectAll("rect").data(c).enter().append("svg:rect").attr("y",function(e){return f(e.id)}).attr("width",function(e){return p(e.value)}).attr("height",15).attr("fill",function(e){return e.color}),t.selectAll("text").data(c).enter().append("svg:text").attr("x",function(e){return p(e.value)}).attr("y",function(e){return f(e.id)+f.rangeBand()/2}).attr("dx",3).attr("text-anchor","start").text(function(e){return r.formatWithUnits(e.value)}).attr("fill",function(e){return e.color})},function(){o||(o=a.max(e.data)),e.units||(e.units=""),e.colors||(e.colors.bars||(e.colors.bars=["blue"]),e.colors.row||(e.colors.row="green")),e.row||(e.row={},e.row.color||(e.row.color="blue")),o/=.75}()}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=bar-chart-card ng-style=\"{width: width + 'px', height: height + 'px'}\"> <div class=card-header-text>{{chartTitle}}</div> <div id=chart></div> <hr ng-style=\"{'background-color': colors.row || 'gray'}\" class=line> <div id=footer-layout> <table> <tr ng-if=footer.title> <td class=footer-title> {{footer.title}} </td> </tr> <tr ng-if=footer.text> <td class=footer-text> {{footer.text}} </td> </tr> </table> </div> </div> "},function(e,t,n){"use strict";(function(e){function t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){e.module("s3").directive("objectFrequencyAnalytics",[function(){return{restrict:"E",scope:{data:"=",storageClass:"="},controller:"ObjectFrequencyAnalyticsController",template:n(743),link:function(e){e.$watch("storageClass.value",function(t,n){t!==n&&e.processData()})}}}]),e.module("s3").controller("ObjectFrequencyAnalyticsController",["$scope","$translate","APIProxyService","ConsoleOperation","ManagementDataProcessor","S3Constants","UtilService",function(n,r,i,a,o,s,c){function l(){n.data&&n.data.rows&&(n.objectTypes=c.getStorageClassOptions(n.data.classes),n.daysAnalyzed=n.data.rows.length,n.processData())}function u(){e.forEach(v,function(t,n){e.forEach(t,function(e){E[e]=n})})}function d(e){var t=parseInt(e,10);if(isNaN(t))throw"Passed in date range is not a number";return-1===t?-1:t<15?0:t<30?1:t<45?2:t<60?3:t<75?4:t<90?5:t<120?6:t<150?7:t<180?8:t<365?9:t<730?10:11}function p(){for(var e=[],t=0;t<v.length;t++){var n={sum:0,count:0};e.push(n)}return e}function f(t,r,i){e.forEach(t.stats,function(e){var t=e.storageClass.toUpperCase()===n.storageClass.value,a=e.objectAge in E;if(t&&a){var o=E[e.objectAge];r[o].sum+=e[i],r[o].count+=1}})}function g(t){var n=[];return e.forEach(t,function(e){e.count>0?n.push(e.sum/e.count):n.push(0)}),n}function m(){var r,i,a=n.data.rows,o=p(),s=p();e.forEach(a,function(e){f(e,o,"storage"),f(e,s,"dataRetrieved")}),n.storage=g(o),n.dataRetrieved=g(s),n.maxValue=Math.max((r=Math).max.apply(r,t(n.storage)),(i=Math).max.apply(i,t(n.dataRetrieved)))}function h(e){return n.data&&n.data.all?n.data.all.filter(function(t){return t.storageClassName===e}):null}function b(){var e=h(n.storageClass.value);if(n.frequencyTypes=[],e&&e.length>0&&e[0].dataArray){var t=e[0].dataArray,r=t[t.length-1].row,i="";r.recommendedAgeTransition.length>0&&(i=d(r.recommendedAgeTransition));for(var a=0;a<v.length;a++)if(n.storageClass.value===S){var o=y,s=n.frequentColor,c="";""===i?(o=_,s=n.emptyColor):a>=i&&i>=0&&(o=A,c=C,s=n.infrequentColor),n.frequencyTypes.push({title:o,text:c,color:s})}else n.frequencyTypes.push({title:"",text:"",color:n.emptyColor})}}var v=[["0-14","000-014"],["15-29","015-029"],["30-44","030-044"],["45-59","045-059"],["60-74","060-074"],["75-89","075-089"],["90-119","090-119"],["120-149"],["150-179"],["180-364"],["365-729"],["730+"]],E={},S=s.ANALYTICS.STORAGE_CLASS.STANDARD;n.objectTypes=[],n.barColors=["#7394CB","#9066A7"],n.frequentColor="green",n.infrequentColor="orange",n.emptyColor="gray";var y=r.instant("storageanalysis.footer.text.frequent"),A=r.instant("storageanalysis.footer.text.infrequent"),C=r.instant("storageanalysis.footer.text.move"),_=r.instant("storageanalysis.footer.text.empty");n.width=310,n.height=210,n.labels=[r.instant("storageanalysis.label.storage"),r.instant("storageanalysis.label.dataRetrieved")],n.processData=function(){b(),m()},function(){n.data&&(u(),n.titles=[],n.titles.push(r.instant("storageanalysis.title.15")),n.titles.push(r.instant("storageanalysis.title.30")),n.titles.push(r.instant("storageanalysis.title.45")),n.titles.push(r.instant("storageanalysis.title.60")),n.titles.push(r.instant("storageanalysis.title.75")),n.titles.push(r.instant("storageanalysis.title.90")),n.titles.push(r.instant("storageanalysis.title.120")),n.titles.push(r.instant("storageanalysis.title.150")),n.titles.push(r.instant("storageanalysis.title.180")),n.titles.push(r.instant("storageanalysis.title.365")),n.titles.push(r.instant("storageanalysis.title.730")),n.titles.push(r.instant("storageanalysis.title.730plus")),l())}()}])}()}).call(t,n(0))},function(e,t){e.exports='<div class=object-freq> <table ng-if="storage && dataRetrieved && frequencyTypes" class=info-table> <tbody> <tr> <td> <span class="enabled-lightbulb-blue-image lightbulb-icon"></span> </td> <td> <table> <tbody> <tr> <td> <span class="header-text header" translate=storageanalysis.label.accession></span> </td> </tr> <tr> <td> <span class="secondary-text header" translate=storageanalysis.label.analyzed translate-values="{ days : daysAnalyzed}"></span> </td> </tr> </tbody> </table> </td> <td> <awsui-select items=objectTypes class=select-object-types ng-model=storageClass.value change=processData() placeholder="{{\'storageanalysis.label.standard\' | translate}}"></awsui-select> </td> <td> <div class=info-legend-group> <div class=info-legend> <div class="info-color-box storage-back"></div> <span class=storage-color translate=storageanalysis.label.storage></span> </div> <div class=info-legend> <div class="info-color-box data-back"></div> <span class=data-color translate=storageanalysis.label.dataRetrieved></span> </div> </div> </td> </tr> </tbody> </table> <table ng-if="storage && dataRetrieved && frequencyTypes" class=object-freq-table> <tbody> <tr> <td class=cards data-ng-repeat="i in [0, 1, 2]"> <bar-chart-card chart-title=titles[i] data="[storage[i], dataRetrieved[i]]" labels=labels colors="{row: frequencyTypes[i].color, bars: barColors}" max-value=maxValue width=width height=height footer=frequencyTypes[i]> </bar-chart-card> </td> </tr> <tr> <td class=cards data-ng-repeat="i in [3, 4, 5]"> <bar-chart-card chart-title=titles[i] data="[storage[i], dataRetrieved[i]]" labels=labels colors="{row: frequencyTypes[i].color, bars: barColors}" max-value=maxValue width=width height=height footer=frequencyTypes[i]> </bar-chart-card> </td> </tr> <tr> <td class=cards data-ng-repeat="i in [6, 7, 8]"> <bar-chart-card chart-title=titles[i] data="[storage[i], dataRetrieved[i]]" labels=labels colors="{row: frequencyTypes[i].color, bars: barColors}" max-value=maxValue width=width height=height footer=frequencyTypes[i]> </bar-chart-card> </td> </tr> <tr> <td class=cards data-ng-repeat="i in [9, 10, 11]"> <bar-chart-card chart-title=titles[i] data="[storage[i], dataRetrieved[i]]" labels=labels colors="{row: frequencyTypes[i].color, bars: barColors}" max-value=maxValue width=width height=height footer=frequencyTypes[i]> </bar-chart-card> </td> </tr> </tbody> </table> <div ng-if="storage && dataRetrieved && frequencyTypes" class=object-freq-note> <hr class=hr-props> <span class=secondary-text translate=storageanalysis.footer.text.note></span> </div> </div> '},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C){function _(){var t={prefixes:[],tags:[]};return e.forEach(o.filters.prefixFilters,function(e){t.prefixes.push({Prefix:e})}),e.forEach(o.filters.tagFilters,function(e){t.tags.push({Tag:{Key:e.tagKey,Value:e.tagVal}})}),t}function w(t){var n="";return t?t.And?(e.forEach(t.And,function(t,r){r===q&&(n+=t+" | "),r===J&&(t=[].concat(t),e.forEach(t,function(e,r){n+=e.Key+"="+e.Value,r!==t.length-1&&(n+=" | ")}))}),n=n.replace(/\|$/,"")):t.Prefix?n+=t.Prefix:t.Tag&&(n+=t.Tag.Key+" | "+t.Tag.Value):n=" ",n}function T(){o.cancelFilter(),o.cancelMetricsConfig(),o.allData.data={},o.graphData.area=[],o.graphData.percentage=[],o.stdSize=c.instant("storage.size.zero.default"),o.stdRet=c.instant("storage.size.zero.default"),o.stdiaSize=c.instant("storage.size.zero.default"),o.stdiaRet=c.instant("storage.size.zero.default"),o.stdDate="",o.stdiaDate="",o.startedOn=K(new Date),o.updatedOn=K(new Date),o.numDays=0,o.recommendation=null,o.selectedStorageClass={value:Z.STANDARD},o.percentageGraphId="percentageGraphId",o.percentageGraphHeading="",o.percentageXMin=(new Date).getTime()-Q,o.percentageXMax=(new Date).getTime(),o.percentageGraphXValue="timestamp",o.percentageGraphYValue="percentage",o.storageOptions=null,o.xmax=(new Date).getTime(),o.xmin=o.xmax-30*Q,o.exportFailed=!1}function R(e){return o.models[e]=!0,P(),o.startedOn=K(new Date),o.updatedOn=K(new Date),o.filterList=[],e===X.DELETE_FILTER&&(o.selectedFilterTmp===o.selectedFilter?(o.selectedFilterTmp=null,o.selectedFilter=null):o.selectedFilterTmp=null),p.getBucketLocation(o.bucketName).then(function(t){o.bucketRegion=t,O(e)}).catch(function(t){N(e),W(e,t)})}function O(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=new g(E.OPERATION_NAME.ANALYTICS_GET_CONFIG),i={};n&&e.extend(i,{params:{"continuation-token":n}}),l.getBucketProperty(r,o.bucketName,"analytics",i,!1).then(function(n){var i=n.response;S.log(E.OPERATION_NAME.ANALYTICS_GET_CONFIG,1,r);var a=C.convertXmlStringToJson(i),s=a.ListBucketAnalyticsConfigurationsResult,c=[];s&&s.AnalyticsConfiguration&&(c=A.transformObjectToArray(s.AnalyticsConfiguration)),e.forEach(c,function(e){o.selectedFilterTmp&&o.selectedFilterTmp.Id===e.Id?(o.selectedFilterTmp=e,e.checked=!0):e.checked=!1,o.selectedFilter&&o.selectedFilter.Id===e.Id&&(o.selectedFilter=e,e.checked=!0),e.filterText=w(e.Filter)}),o.filterList=o.filterList.concat(c),"true"===s.IsTruncated?O(t,s.NextContinuationToken):(k(),N(t))}).catch(function(e){S.log(E.OPERATION_NAME.ANALYTICS_GET_CONFIG,0,r),N(t),W(t,e)})}function k(){o.selectedFilter||o.selectedFilterTmp?o.selectedFilter===o.selectedFilterTmp&&(o.selectedFilter=null):o.filterList.length>0&&(o.filterList[0].checked=!0,o.selectedFilterTmp=o.filterList[0]),o.models.editFilter=!1,o.filterChanged(o.selectedFilterTmp)}function I(e){var t=o.exportFilterInfo;if(e.StorageClassAnalysis&&e.StorageClassAnalysis.DataExport&&e.StorageClassAnalysis.DataExport.Destination&&e.StorageClassAnalysis.DataExport.Destination.S3BucketDestination){var n=e.StorageClassAnalysis.DataExport.Destination.S3BucketDestination;n.Prefix&&(t.prefix=n.Prefix),n.BucketAccountId&&(t.bucket.accountId=n.BucketAccountId),n.Bucket&&(t.bucket.bucket=f.stripBucketARN(n.Bucket))}o.models.filterName=e.Id,o.models.filterValue=e.filterText}function P(){o.models.filterName="",o.filters.input="",o.filters.tagFilters=[],o.filters.prefixFilters=[],o.exportFilterInfo={bucket:{},prefix:""}}function N(e){o.models[e]=!1,e!==X.SAVING_FILTER&&e!==X.DELETE_FILTER||(o.models.showAddFilter=!1,o.models.filterError=""),e===X.APPLYING_CONFIG&&(o.models.toggleAnalyticsConfig=!1),o.filters.tagFilters=[],o.filters.prefixFilters=[]}function M(){var e=new g(E.OPERATION_NAME.ANALYTICS_GET_DATA),t=new g(E.OPERATION_NAME.ANALYTICS_GET_STATUS);o.quicksightLink="",o.selectedFilter?function(){o.models[X.DATA_LOADING]=!0;var n=o.selectedFilter.Id;h.retrieveAnalyticsData(o.bucketName,n,E.S3_SHARED_DATA.DATA).then(function(r){S.log(E.OPERATION_NAME.ANALYTICS_GET_DATA,1,e),x(r),H(),h.retrieveAnalyticsData(o.bucketName,n,E.S3_SHARED_DATA.STATUS).then(function(e){S.log(E.OPERATION_NAME.ANALYTICS_GET_STATUS,1,t),te={RunDate:e[0],JobType:e[1],ConfigId:e[2],ExportLocation:e[3],Status:e[4],ErrorCode:e[5]},o.exportFailed=te.Status===E.S3_SHARED_DATA.FAILED,o.selectedFilter.exportFailed=o.exportFailed}).catch(function(e){S.log(E.OPERATION_NAME.ANALYTICS_GET_STATUS,0,t)})}).catch(function(t){S.log(E.OPERATION_NAME.ANALYTICS_GET_DATA,0,e),t===E.ANALYTICS.ERROR.USER_INFO_MISSING&&(o.models.error=c.instant("management.analytics.data.error.userinfo.missing"))}).finally(function(e){o.models[X.DATA_LOADING]=!1})}():o.models[X.DATA_LOADING]=!1}function L(){o.allData.data.classes?r.filter(o.allData.data.classes,function(e){return e===Z.STANDARD}).length>0?o.selectedStorageClass.value=Z.STANDARD:o.selectedStorageClass.value=o.allData.data.classes[0]:o.selectedStorageClass.value=Z.STANDARD}function x(e){if(e&&(o.allData.data=e,L()),o.allData.data.all&&o.allData.data.rows){var t=D(Z.STANDARD),n=t&&t.length>0?t[0].dataArray:null;if(n&&n.length>0){var r=n[n.length-1];r.row.recommendation>=0&&(o.recommendation=r.row.recommendation,o.selectedFilter.recommendation=o.recommendation)}o.allData.data.rows.length>0&&(o.numDays=U(o.allData.data.rows[0].date),o.startedOn=K(o.allData.data.rows[0].date),o.updatedOn=K(o.allData.data.rows[o.allData.data.rows.length-1].date)),B(),j(),F()}}function D(e){return r.get(o.allData,"data.all",[]).filter(function(t){return t.storageClassName===e})}function j(){var e=D(o.selectedStorageClass.value);if(o.allData.data&&e&&e.length>0&&e[0].dataArray){var t=e[0].dataArray,n=[],r=t.length;if(r>30){for(var i=r-31,a=r-1;a>i;a--)n.push(t[a]);t=n,o.xmax=n[0].timestamp,o.xmin=n[n.length-1].timestamp}else r>0?(o.xmax=t[r-1].timestamp,o.xmin=t[0].timestamp):(o.xmax=(new Date).getTime(),o.xmin=o.xmax-30*Q);o.graphData.area=t}else o.graphData.area=[]}function B(){o.storageOptions=A.getStorageClassOptions(o.allData.data.classes)}function F(){var e=D(o.selectedStorageClass.value);if(o.percentageGraphId="percentageGraphId",o.percentageGraphHeading="%",o.percentageXMin=(new Date).getTime()-30*Q,o.percentageXMax=(new Date).getTime(),e&&e.length>0&&e[0].dataArray){var t=e[0].dataArray,n=[],r=t.length;if(r>30){for(var i=t.length-31,a=r-1;a>i;a--)n.push(t[a]);t=n}o.graphData.percentage=t}else o.graphData.percentage=[]}function U(e){var t=new Date(e),n=new Date;return Math.round(Math.abs((n.getTime()-t.getTime())/864e5))}function K(e){return A.formatDate(new Date(e),"shortDate")}function V(e){var t=U(e[e.length-1].date),n=U(o.allData.data.rows[o.allData.data.rows.length-1].date);return t>n||n>ee}function G(e,t,n){var r=new g(E.OPERATION_NAME.ANALYTICS_PUT_CONFIG);o.models[n]=!0,e=$(e),n===X.SAVING_FILTER&&(o.filterError=""),l.putBucketProperty(r,o.bucketName,"analytics",e,t).then(function(e){e.response,S.log(E.OPERATION_NAME.ANALYTICS_PUT_CONFIG,1,r),A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.SAVE_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),R(n)}).catch(function(e){S.log(E.OPERATION_NAME.ANALYTICS_PUT_CONFIG,0,r),W(n,e),o.models[n]=!1})}function Y(e,t){var n=new g(E.OPERATION_NAME.ANALYTICS_DELETE_CONFIG);t!==X.SAVING_FILTER&&t!==X.DELETE_FILTER||(o.models.filterError=""),A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.DELETE_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),o.models[t]=!0,l.deleteBucketProperty(n,o.bucketName,"analytics",e).then(function(e){e.response,S.log(E.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,1,n),o.selectedFilterTmp===o.selectedFilter?(o.selectedFilterTmp=null,o.selectedFilter=null):o.selectedFilterTmp=null,R(t)}).catch(function(e){S.log(E.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,0,n),W(t,e),o.models[t]=!1})}function W(e,t){e===X.SAVING_FILTER||e===X.DELETE_FILTER?o.models.filterError=A.handleErrors(t):o.models.error=A.handleErrors(t)}function z(e){e.AnalyticsConfiguration.StorageClassAnalysis="";var t=o.exportFilterInfo;if(t.bucket.bucket){var n=t.bucket.bucket;e.AnalyticsConfiguration.StorageClassAnalysis={},e.AnalyticsConfiguration.StorageClassAnalysis.DataExport={OutputSchemaVersion:"V_1",Destination:{S3BucketDestination:{Format:"CSV",Bucket:A.getBucketARN(n)}}},t.prefix&&(e.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.Prefix=t.prefix),t.bucket.accountId&&(e.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.BucketAccountId=t.bucket.accountId),d.createBucketPolicy(o.bucketName,n,o.policyStatus)}}function $(e){return e.replace("<AnalyticsConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AnalyticsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}function H(){m.isFeatureEnabled(E.FAC.QUICKSIGHT_LINK)&&(o.quicksightLink=v.generateQuicksightLink(o.bucketName,o.selectedFilter,o.bucketRegion))}var q="Prefix",J="Tag",X=E.MANAGEMENT.ACTION,Z=E.ANALYTICS.STORAGE_CLASS,Q=864e5,ee=2,te=void 0;o.format={xtooltipDateTime:A.getShortDateTimeWithoutYearPattern(),xdateTime:A.getShortDateWithoutYearPattern()},o.bucketName=b.getCurrentBucket(),o.allData={},o.metrics={},o.selectedMetricType=E.METRICS.TYPE.STORAGE,o.S3Constants=E,o.selectedFilter=null,o.selectedFilterTmp=null,o.quicksightLink=null,o.validFilter=!1,o.filterList=[],o.stdSize=c.instant("storage.size.zero.default"),o.stdRet=c.instant("storage.size.zero.default"),o.stdiaSize=c.instant("storage.size.zero.default"),o.stdiaRet=c.instant("storage.size.zero.default"),o.stdDate="",o.stdiaDate="",o.startedOn=K(new Date),o.updatedOn=K(new Date),o.recommendation=null,o.numDays=0,o.selectedStorageClass={value:Z.STANDARD},o.percentageGraphId="percentageGraphId",o.percentageGraphHeading="",o.percentageXMin=(new Date).getTime()-Q,o.percentageXMax=(new Date).getTime(),o.percentageGraphXValue="timestamp",o.percentageGraphYValue="percentage",o.storageAreaChartId="storageVsDataTransferId",o.xmin=null,o.xmax=null,o.graphData={area:[],percentage:[]},o.storageOptions=null,o.exportFilterInfo={bucket:{},prefix:""},o.exportFailed=!1,o.policyStatus={policyMessage:"",policyHeader:"",policyType:"info",policyDefinition:""},o.models={filterName:null,filterValue:null,filterError:null,savingFilter:!1,applyingConfig:!1,showAddFilter:!1,editFilter:!1,configLoading:!0,toggleAnalyticsConfig:!1,searchText:"",bucketChecked:!1,allFilters:!1,updatedOn:null,analyzingData:!1,dataLoading:!0,error:"",deleteFilter:!1},o.filters={input:"",prefixFilters:[],tagFilters:[]},o.metricTypes={storage:{id:E.METRICS.TYPE.STORAGE,group:c.instant("management.analytics.type.analysis"),title:c.instant("management.analytics.type.analysis"),disable:!1,checked:!1,state:!1,recommendation:-1,info:c.instant("management.metrics.cost.paid"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:c.instant("management.metric.type.display.storage.size"),selected:!0},{name:"NumberOfObjects",display:c.instant("management.metric.type.display.storage.count"),selected:!0}]}},o.filterKeyDown=function(e){e&&e.keyCode===E.KEY_CODES.ESC&&(t(".input-field").blur(),o.models.searchText="")},o.getGroupTitle=function(e){return o.metricTypes[e].group},o.addFilter=function(t){o.models.showAddFilter||(P(),o.models.filterNameError="",o.models.filterValueError="",t?(A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.EDIT_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),o.models.editFilter=!0,I(t),o.selectedFilterTmp=t,o.selectedFilter=t):(A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.ADD_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),o.models.filterName="",o.models.filterValue=""),o.models.showAddFilter=!0,o.resetPolicyStatus(),o.models.editFilter||s(function(){e.element("#get-filter-name input").focus()}))},o.validateFilter=function(){var e=!0;return o.models.filterNameError="",o.models.filterValueError="",!!o.models.filterName&&(o.models.filterName=o.models.filterName.trim(),E.MANAGEMENT.FILTER_NAME_REGEX.test(o.models.filterName)||(o.models.filterNameError=c.instant("management.config.filtername.error.format"),e=!1),o.filters.input&&(o.models.filterValueError=c.instant("management.config.filtervalue.error.format",{text:o.filters.input}),e=!1),o.models.editFilter||r.filter(o.filterList,function(e){return e.Id===o.models.filterName}).length>0&&(o.models.filterNameError=c.instant("management.metrics.side.filter.error.dup"),e=!1),e)},o.goToLifecycleTab=function(){o.viewId.value=E.MANAGEMENT.VIEWS.LIFECYCLE},o.cancelFilter=function(){o.models.editFilter||A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),o.models.showAddFilter=!1,o.models.editFilter=!1,o.models.filterError=!1,o.selectedFilterTmp=null},o.filterChanged=function(e,t){o.selectedFilter!==e&&(t&&t.stopPropagation(),e&&(T(),o.selectedFilter?(o.selectedFilter.checked=!1,o.selectedFilter=e,o.selectedFilter.checked=!0):(o.selectedFilter=e,o.selectedFilter.checked=!0),M()))},o.getLearnMoreLink=function(e){return u.getDocUrl(E.LEARN_MORE_LINKS["storage-management"][e])},o.setSelectedMetricType=function(e){o.selectedMetricType=e},o.deleteFilter=function(){o.models.deleteFilter||o.models.savingFilter||Y({params:{id:o.models.filterName}},X.DELETE_FILTER)},o.cancelMetricsConfig=function(){o.metricTypes.storage.checked=o.metricTypes.storage.state,o.models.toggleAnalyticsConfig=!1},o.$watch("selectedStorageClass.value",function(e,t){e!==t&&o.setSelectedStorageClass()}),o.setSelectedStorageClass=function(){A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.ANALYTICS.CHANGE_STORAGE_CLASS,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT),x()},o.saveFilter=function(){var t=o.exportFilterInfo;if(!o.models.deleteFilter&&!o.models.savingFilter&&(t.bucket.bucket||!t.prefix)){var n=_();o.models.filterError="",o.validateFilter(n)&&function(){var t={params:{id:o.models.filterName}},r={},i=void 0;r.AnalyticsConfiguration={},r.AnalyticsConfiguration.Id=o.models.filterName,o.models.editFilter?r.AnalyticsConfiguration.Filter=o.selectedFilter.Filter:n.tags.length+n.prefixes.length>0&&(r.AnalyticsConfiguration.Filter={},n.tags.length>1||n.tags.length+n.prefixes.length>1?(r.AnalyticsConfiguration.Filter.And={},n.tags.length>0&&(r.AnalyticsConfiguration.Filter.And.Tag=[],e.forEach(n.tags,function(e){var t=e.Tag;return r.AnalyticsConfiguration.Filter.And.Tag.push(t)})),n.prefixes.length>0&&(r.AnalyticsConfiguration.Filter.And.Prefix=[],e.forEach(n.prefixes,function(e){var t=e.Prefix;return r.AnalyticsConfiguration.Filter.And.Prefix.push(t)}))):(n.prefixes.length>0&&(r.AnalyticsConfiguration.Filter=n.prefixes[0]),n.tags.length>0&&(r.AnalyticsConfiguration.Filter.Tag=n.tags[0].Tag))),z(r),i=C.jsonToXml(r),G(i,t,X.SAVING_FILTER)}()}},o.getClassNameTranslation=function(e){var t=A.getStorageClassTranslations()[e];return t||(t=e.charAt(0)+e.substring(1).toLowerCase()),t},o.getMostRecentTotalSize=function(e){var t=V(e)?0:e[e.length-1].row.storage;return A.formatWithUnits(t)},o.getMostRecentDataRetrieved=function(e){var t=V(e)?0:e[e.length-1].row.dataRetrieved;return A.formatWithUnits(t)},o.getExportFailedStatusText=function(e){if(te){var t=te.ErrorCode.toLowerCase(),n=te.RunDate,r=c.instant("management.analytics.data.exportstatus."+t,{date:n});return e?r.slice(0,52)+"...":r}},o.resetPolicyStatus=function(){o.policyStatus.policyMessage="",o.policyStatus.policyHeader="",o.policyDefinition="",o.policyType="info"},o.quicksightLinkClicked=function(){A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.ANALYTICS.QUICKSIGHT_LINK,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT)},o.searchClicked=function(){A.analyticsTrackClick(E.ANALYTICS.MANAGEMENT.SEARCH_CONFIG,E.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT)},function(){R(X.CONFIG_LOADING)}()}e.module("s3").directive("analytics",[function(){return{restrict:"E",scope:{viewId:"="},template:n(745),controller:"AnalyticsController"}}]),e.module("s3").controller("AnalyticsController",["$anchorScroll","$route","$routeParams","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPolicyService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","ManagementDataProcessor","PathService","QuicksightService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser",i])}()}).call(t,n(0),n(6),n(2))},function(e,t){e.exports='<div class="metrics-content-table h-container"> <div class="metrics-content-cell management-side-panel-color"> <div class=select-metrics-side-panel> <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if=models.configLoading></span> <table border=0px class=select-metrics-table ng-if=!models.configLoading> <tr> <td> <span class=metrics-header>{{ \'management.view.analytics\' | translate }}</span> </td> </tr> <tr> <td> <table class="search-box prefix-search-box"> <tbody> <tr> <td class=search-icon><i class="awsui-icon search"></i></td> <td><input type=text class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model=models.searchText ng-keydown=filterKeyDown($event) ng-click=searchClicked() placeholder="{{ \'management.search.placeholder\' | translate }}"></td> </tr> </tbody> </table> </td> </tr> <tr> <td class=filter-header> <table class=filters-table-header> <tr> <td> <div class=filter-title-analytics translate=management.metrics.side.filter.header translate-values="{count: filterList.length}"></div> </td> <td> <div class=filter-add id=add-filter ng-click=addFilter()> <div class="awsui-icon awsui-icon-link plus"> {{\'management.metrics.side.filter.add\'|translate}} </div> </div> </td> </tr> </table> </td> </tr> <tr ng-if=models.showAddFilter> <td class="bucket-dropdown-config dark"> <table> <tr> <td class=filter-title-cell> <div class=filter-add-title> {{ models.editFilter ? \'management.metrics.side.filter.dropdown.edit\' : \'management.metrics.side.filter.dropdown.add\' | translate}} </div> </td> </tr> <tr> <td> <div class=new-filter-params> <div class=new-filter-text> {{ \'management.metrics.side.filter.name.title\' | translate }} </div> <div class=new-filter-input> <awsui-control-group validation-message={{models.filterNameError}}> <awsui-textfield id=get-filter-name placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup=validateFilter() data-disabled="models.editFilter || models.savingFilter" ng-model=models.filterName></awsui-textfield> </awsui-control-group> </div> <div class=new-filter-text> {{ \'management.metrics.side.filter.prefix.optional.title\' | translate }} </div> <div class=new-filter-input ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }"> <awsui-textarea ng-if=models.editFilter id=filter-value placeholder="{{ \'management.metrics.side.filter.prefix.placeholder\' | translate}}" ng-keyup=validateFilter() data-disabled=true rows=1 ng-model=models.filterValue></awsui-textarea> <search empty=true filters=filters no-backend-calls=true ng-if=!models.editFilter search-error=models.filterValueError></search> </div> <div> <analytics-export data=exportFilterInfo saving=models.savingFilter edit-filter=models.editFilter> </analytics-export> </div> <div class=select-analytics-buttons> <table> <tr> <td colspan=2> <div class=filter-delete> <awsui-button data-disabled="models.deleteFilter || models.savingFilter" id=delete-filter variant=link ng-click=deleteFilter() loading=models.deleteFilter ng-if=models.editFilter text="{{ \'management.metrics.action.delete\' | translate }}"> </awsui-button> </div> </td> </tr> <tr> <td class=analytics-button-spacing> <awsui-button id=save-filter-button variant=primary text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                      || (!models.filterName || models.filterNameError)\n                                                                      || (exportFilterInfo.prefix.length > 0 && !exportFilterInfo.bucket.bucket)" class=normal-button loading=models.savingFilter ng-click=saveFilter()></awsui-button> </td> <td> <awsui-button variant=normal text="{{ \'button.cancel\' | translate}}" class=normal-button data-disabled="models.savingFilter || models.deleteFilter" click=cancelFilter()></awsui-button> </td> </tr> </table> <div class=filter-error> <awsui-alert type=error header="{{\'error.header\'|translate}}" ng-if=models.filterError>{{models.filterError}} </awsui-alert> </div> </div> </div> </td> </tr> </table> </td> </tr> <tr ng-if="!models.showAddFilter && filterList.length > 0" class=filter-header> <td> <table class=filters-table> <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'row-selected\' : row.checked, \'row-hover\': hoverRule && !row.checked}" ng-click="filterChanged(row, $event)" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false"> <td> <div class=row-checkbox> <span class="alert-exclamation-triangle awsui-icon warning-triangle-icon" ng-class="{\'awsui-icon-light\':row.checked}" ng-if=row.exportFailed></span> <span class="orange-lightbulb lightbulb-icon" ng-if=!row.recommendation></span> <span class=lightbulb-icon ng-class="{\'enabled-lightbulb-blue-image\' : !row.checked,\n                                                        \'enabled-lightbulb-white-image\':row.checked}" ng-if=row.recommendation></span> </div> </td> <td class=filter-name-row> <div> {{row.Id}} </div> </td> <td> <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click=addFilter(row)></span> </td> </tr> </table> </td> </tr> <tr ng-if="!models.showAddFilter && filterList.length === 0"> <td> <div class=side-panel-metrics-help> <span> {{ \'storageanalysis.empty.additionalInformation\' | translate }}{{ \'management.metrics.cost.paid\' | translate}} </span> <br> <a href="{{ getLearnMoreLink(\'analytics-storage-class\') }}" target=_blank class=ng-binding translate>learn.more</a> <br> <br> <awsui-button data-disabled=false loading=false icon=plus variant=primary ng-click=addFilter()> {{ \'management.metrics.side.filter.add\' | translate }} </awsui-button> </div> </td> </tr> </table> </div> </div> <div class="metrics-content-cell flex-expand"> <div class=analytics-content> <div> <div class="si-top-right-header analytics-padding"> <div class="title labels"> {{ getGroupTitle(S3Constants.METRICS.TYPE.STORAGE) }} </div> <div ng-if=quicksightLink> <a href={{quicksightLink}} id=quicksightLink target=_blank class="quicksight awsui-icon external-link awsui-icon-light" ng-click=quicksightLinkClicked() translate>management.analytics.link.quicksight</a> </div> </div> <div class=empty-storage-class-analysis ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length === 0"> <span class="no-storage-class-analysis storage-class-analysis-icon"></span> <div class=empty-header translate>storageanalysis.empty.header</div> <div class=empty-additional-information translate> storageanalysis.empty.additionalInformation </div> <table class=empty-buttons> <tbody> <tr> <td> <awsui-button variant=link text="{{ \'storageanalysis.empty.addfilter\' | translate }}" ng-click=addFilter()></awsui-button> </td> </tr> </tbody> </table> </div> <div class=storage-management-error-box> <awsui-alert type=error header="{{\'error.header\'|translate}}" ng-if=models.error>{{models.error}} </awsui-alert> </div> <div class=storage-management-error-box ng-if=policyStatus.policyMessage> <awsui-alert id=inventory-policy-message dismiss=resetPolicyStatus() type={{policyStatus.policyType}} dismissible=true visible=policyStatus.policyMessage header={{policyStatus.policyHeader}}> <div>{{policyStatus.policyMessage}} <span> <a href="{{getLearnMoreLink(\'analytics-storage-class\')}}" target=_blank translate>learn.more</a> </span> </div> <div class=policy-definition ng-if=policyStatus.policyDefinition> <pre>{{policyStatus.policyDefinition}}</pre> </div> </awsui-alert> </div> <div ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length > 0"> <div class=metrics-loading ng-if=models.dataLoading> <span class="awsui-icon awsui-spinner awsui-spinner-large"></span> </div> <div class=analyzing-data ng-if="!models.dataLoading && !recommendation"> <div class=info-box> <table class=info-table> <tr> <td><span class="info-icon orange-lightbulb lightbulb-icon"></span></td> <td class=info-text-cell> <div class=info-text translate=management.analytics.analyzing.title></div> <div class=info-text translate=management.analytics.analyzing.date translate-values="{ date: startedOn }" ng-if="allData.data && allData.data.rows && allData.data.rows.length > 0"></div> </td> <td> <div class=info-desc translate=management.analytics.analyzing.desc></div> </td> </tr> </table> </div> <div class=analyzing-data-no-data ng-if="!allData.data.rows || allData.data.rows.length == 0 "> <span class="no-graph-image no-graph-image-class"></span> <div class=no-data-available translate>management.analytics.data.not.available</div> </div> </div> <div class=analytics-data-analysis ng-if="!models.dataLoading && allData.data && allData.data.rows && allData.data.rows.length > 0 "> <div class=info-box ng-if=recommendation> <table class=info-lifecycle-table> <tr> <td> <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon lightbulb-adj"></span> </td> <td> <span class=info-lifecycle-text-title translate=management.analytics.data.info.recommendation.title></span> </td> <td> <span class=info-lifecycle-text-date translate=management.analytics.data.info.updated.date translate-values="{ date: updatedOn }"></span> </td> </tr> </table> <div class=info-lifecycle-desc translate=management.analytics.data.info.recommendation.desc translate-values="{ range: numDays, rec: recommendation }"></div> <awsui-button class=view-lifecycle-rules id=view-lifecycle-rules ng-click=goToLifecycleTab() text="{{ \'management.analytics.data.info.viewlifecyclerules\' | translate }}"> </awsui-button> </div> <div class=info-box-storage-container> <div class=info-box-storage ng-repeat="(key, value) in allData.data.all"> <h3 translate={{getClassNameTranslation(value.storageClassName)}}></h3> <table class=info-table-storage> <tr> <td translate=management.analytics.data.size></td> <td>{{getMostRecentTotalSize(value.dataArray)}}</td> </tr> <tr class=info-data> <td translate=management.analytics.data.retrieved></td> <td>{{getMostRecentDataRetrieved(value.dataArray)}}</td> </tr> </table> </div> <awsui-tooltip text={{getExportFailedStatusText(false)}} position=bottom size=small> <div class="info-box-storage awsui-alert-type-warning" ng-if=exportFailed> <h3>Export failed</h3> <span>{{getExportFailedStatusText(true)}}</span> </div> </awsui-tooltip> </div> <div class=info-question> <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span> <div class=info-question-text translate=management.analytics.data.info.retrieved.question> </div> <div class=info-storage-select ng-if=storageOptions> <awsui-select items=storageOptions ng-model=selectedStorageClass.value ng-change=setSelectedStorageClass()></awsui-select> </div> <div class=info-legend-group> <div class=info-legend> <div class="info-color-box storage-back"></div> <span class=storage-color translate=storageanalysis.label.storage></span> </div> <div class=info-legend> <div class="info-color-box data-back"></div> <span class=data-color translate=storageanalysis.label.dataRetrieved></span> </div> </div> </div> <div class=info-area-chart> <analytics-area-chart chart-id=storageAreaChartId data=graphData.area height=360 xmin=xmin xmax=xmax></analytics-area-chart> </div> <div class=info-question> <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span> <div class=info-question-text translate=management.analytics.data.info.percentage.question> </div> <div class=info-per-legend> <div class=info-dotted-line></div> <div class=info-per-text translate=management.analytics.data.info.retrieved.label></div> </div> </div> <div class=info-percentage-graph> <storage-console-line-chart chartid=percentageGraphId data=graphData.percentage heading=percentageGraphHeading isxdate=true xticks=8 xid=percentageGraphXValue yid=percentageGraphYValue xmin=xmin xmax=xmax totalwidth=940 totalheight=300 dotted="\'3px\'" color="\'#9066A7\'" pattern="\'3, 3\'" xtooltip-date-time-format={{format.xtooltipDateTime}} xdate-time-format={{format.xdateTime}} template-url=../partials/storageConsoleLineChartAnalytics.html> </storage-console-line-chart> <hr class=hr-props> </div> <div class=info-age-tiers> <object-frequency-analytics data=allData.data storage-class=selectedStorageClass></object-frequency-analytics> </div> </div> </div> </div> </div> </div> </div> '},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("analyticsExport",[function(){return{restrict:"E",controller:"AnalyticsExportController",scope:{data:"=",saving:"=",editFilter:"="},template:n(747)}}]),e.module("s3").controller("AnalyticsExportController",["$scope","AwsUrlsService","BucketPropertiesService","FACService","PathService","S3Constants","UtilService",function(e,t,n,r,i,a,o){r.isRegionalFeatureEnabled(a.FAC.QUICKSIGHT).then(function(t){e.showQuicksight=t}),e.getLearnMoreLink=function(e){return t.getDocUrl(a.LEARN_MORE_LINKS["storage-management"][e])},e.getQuicksightLink=function(){return a.LEARN_MORE_LINKS["storage-management"].quicksight},e.validatePrefix=function(){e.data.prefix&&0===e.data.prefix.indexOf(a.DELIMITER)&&e.data.bucket.bucket?e.prefixInfo=e.data.prefix:e.prefixInfo=""}}])}()}).call(t,n(0))},function(e,t){e.exports='<div class=analysis-export-form> <awsui-expandable-section class=export-form-dropdown header="{{\'management.analytics.export.title\' | translate}}" expanded=editFilter> <div class=export-form-hr></div> <div class="dropdown-text section"> <div class=export-form-labels translate=report.label.bucket></div> <bucket-selector class=export-form-bucket ng-class="{ \'bucket-missing\': data.prefix && !data.bucket.bucket}" selected-report=data.bucket show-bucket-name-only=true choose-accounts=true same-region=true editable=true disabled=saving></bucket-selector> <div class=export-form-labels translate=report.label.prefix></div> <awsui-textfield class=export-form-prefix id=export-prefix placeholder="{{ \'management.analytics.export.prefix.placeholder\' | translate}}" ng-keyup=validatePrefix() data-disabled="saving || !data.bucket.bucket" ng-model=data.prefix></awsui-textfield> <div class=search-prefix-info ng-if=prefixInfo translate translate-values="{ bucket1 : data.bucket.bucket + \'/\' + prefixInfo, bucket2: data.bucket.bucket + prefixInfo }">prefixsearch.validation.slash.start.warning</div> <div class=export-quicksight translate=management.analytics.quicksight.export translate-values="{quicksightLink : getQuicksightLink()}" ng-if=showQuicksight> </div> </div> </awsui-expandable-section> </div> '},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("analyticsAreaChart",[function(){return{restrict:"E",scope:{data:"=",width:"=?",height:"=?",bcolor:"=?",tcolor:"=?",chartId:"=",xmin:"=?",xmax:"=?"},controller:"AnalyticsAreaChartController",template:n(749),link:function(e){e.$watch("data",function(t){t&&e.draw()})}}}]),e.module("s3").controller("AnalyticsAreaChartController",["$scope","$translate","$window","UtilService",function(e,t,n,r){e.labels=[t.instant("storageanalysis.label.storage"),t.instant("storageanalysis.label.dataRetrieved")];var i=n.d3;e.draw=function(){var t=e.data,n=r.formatShortDateWithoutYear.bind(r),o=9,s={top:10,right:20,bottom:30,left:80},c=(e.width||960)-s.left-s.right,l=(e.height||500)-s.top-s.bottom;t.sort(function(e,t){return i.ascending(e.timestamp,t.timestamp)});var u=i.time.scale().range([0,c]),d=i.scale.linear().range([l,0]),p=i.svg.axis().scale(u).orient("bottom").ticks(5).tickFormat(n),f=i.svg.axis().scale(d).orient("left").ticks(o).tickFormat(a),g=i.svg.area().x(function(e){return u(e.timestamp)}).y0(l).y1(function(e){return d(e.row.storage)}),m=i.svg.area().x(function(e){return u(e.timestamp)}).y0(l).y1(function(e){return d(e.row.storage+e.row.dataRetrieved)});i.select("#"+e.chartId).selectAll("svg").remove();var h=i.select("#"+e.chartId).append("svg").attr("width",c+s.left+s.right).attr("height",l+s.top+s.bottom).append("g").attr("transform","translate("+s.left+","+s.top+")");if(e.xmin&&e.xmax?u.domain([e.xmin,e.xmax]).nice():u.domain(i.extent(t,function(e){return e.timestamp})).nice(),t.length>0){var b=i.extent(t,function(e){return e.row.storage+e.row.dataRetrieved}),v=b[1],E=.3*v;0===E&&(0!==v?E=.1*v:(E=1,o=2,f.ticks(o))),v+=E,d.domain([0,v]),d.nice([0,v])}else d.domain([0,5]),d.nice([0,5]);h.append("path").datum(t).attr("class","data-fill").attr("d",m),h.append("path").datum(t).attr("class","storage-fill").attr("d",g),h.append("g").attr("class","x axis").attr("transform","translate(0,"+l+")").call(p),h.append("g").attr("class","y axis").call(f)};var a=function(e){var t=i.format(".1f");return e<1024?t(e):e<1048576?t(e/1024)+" KB":e<1073741824?t(e/1024/1024)+" MB":e<1099511627776?t(e/1024/1024/1024)+" GB":e<0x4000000000000?t(e/1024/1024/1024/1024)+" TB":t(e/1024/1024/1024/1024/1024)+" PB"}}])}()}).call(t,n(0))},function(e,t){e.exports='<div id="{{ chartId }}"></div>'},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("targetmbox",["TargetMediatorScripts",function(e){return{restrict:"E",template:n(751),scope:{},controller:"TargetMboxController",link:function(n,r,i){n.$watch(function(){return t(r).find(".js-mbox").css("visibility")},function(t){"visible"===t&&e.setMBoxContent()})}}}]),e.module("s3").controller("TargetMboxController",["$scope","TargetMediatorScripts","InvokeTargetMediator",function(e,t,n){if(e.scriptsInvoked=n.getScriptCount(),e.scriptsInvoked>0){var r=t.getMBoxContent();e.mBoxContent=void 0!==r?r:"",e.showDefault=!1}else e.showDefault=!0}]).filter("trusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}])}()}).call(t,n(0),n(6))},function(e,t){e.exports=" <div ng-if=\"mBoxContent.length === 0\"> <div class=js-mbox data-mbox=en_s3_ed_1> <div>{{ 'notification.text' | translate }}</div> </div> </div> <div ng-if=\"mBoxContent.length > 0\"> <div class=js-mbox data-mbox=en_s3_ed_1 ng-bind-html=\"mBoxContent | trusted\" ng-style=\"{'visibility': 'visible'}\"></div> </div> <div ng-if=showDefault class=mbox-default> <div>{{ 'notification.text' | translate }}</div> </div>"},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").factory("TargetMediatorScripts",["$document","$window","S3Constants",function(e,n,r){function i(e){var t=void 0!==e?e.toLowerCase():"en";return r.TARGET_MEDIATOR.LANGUAGE_MAP[t]||"en"}function a(){return{pageLanguage:i(t('meta[property="requestLocale"]').attr("content")),supportedLanguages:r.TARGET_MEDIATOR.SUPPORTED_LANGUAGES,isLoadedAtPageEnd:!0}}function o(){var e=document.createElement("noscript");e.innerHTML="<style>.js-mbox { visibility: visible; }</style>",document.body.appendChild(e);var t="var AWS = {};";t+="AWS.TargetMediator = ",t+=JSON.stringify(a())+";";var n=document.createElement("script");n.innerHTML=t,document.body.appendChild(n);var r=document.createElement("script");r.type="text/javascript",r.defer=!0,r.src="/s3/target/aws-target-mediator.js",document.body.appendChild(r)}function s(){var e=t("targetmbox").find(".js-mbox");l=e.length?e.get(0).innerHTML:""}function c(){return l}var l;return{addScripts:o,getLanguage:i,getMediatorObject:a,getMBoxContent:c,setMBoxContent:s}}]),e.module("s3").factory("InvokeTargetMediator",["$document","TargetMediatorScripts",function(e,n){function r(){var n=t('script[src="/s3/target/aws-target-mediator.js"]');return e.find(n).length}return n.addScripts(),{getScriptCount:r}}])}()}).call(t,n(0),n(6))},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l,u){function d(){n.accelerate.selectedValue===n.accelerateStates.enabled?(n.cardSummaryObj.isActive=!0,n.cardSummaryObj.isMultiValue=!0,n.cardSummaryObj.activeSummary.value=n.accelerate.endpoint):(n.cardSummaryObj.isActive=!1,n.cardSummaryObj.isMultiValue=!1)}function p(){var t=c.getCurrentBucket(),r=new s(l.ANALYTICS.GET_BUCKET_ACCELERATE);n.cardSummaryObj.isLoading=!0,n.error=void 0,o.getBucketLocation(t).then(function(e){n.comparisonEndpoint=l.ACCELERATE.COMPARISON_ENDPOINT+"region="+e+"&origBucketName="+t}),o.getBucketAccelerate(t,r).then(function(e){e===n.accelerateStates.enabled&&(n.accelerate.selectedValue=n.accelerateStates.enabled)}).catch(function(e){n.error=u.handleErrors(e)}).finally(function(){n.cachedAccelerate=e.copy(n.accelerate),d(),n.cardSummaryObj.isLoading=!1})}n.accelerateStates={enabled:"Enabled",suspended:"Suspended"},n.accelerate={},n.accelerate.selectedValue=n.accelerateStates.suspended,n.learnMoreLink=a.getDocUrl(l.LEARN_MORE_LINKS.ACCELERATE),n.accelerate.endpoint=""+c.getCurrentBucket()+l.ACCELERATE.ENDPOINT.PUBLIC,n.scrollCardId="#"+n.id,n.cardSummaryObj=t.cloneDeep(l.CARD_SUMMARY_INIT),n.cardSummaryObj.activeSummary.text=i.instant("bucketproperty.acceleration.endpoint"),n.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperty.suspended"),d(),n.cancelBucketAccelerate=function(t){u.analyticsTrackClick(l.ANALYTICS.CANCEL_ACCELERATE,l.ANALYTICS.DETAILS),t.stopPropagation(),n.accelerate=e.copy(n.cachedAccelerate),n.cardSummaryObj.isActive=n.accelerate.selectedValue===n.accelerateStates.enabled,n.error=void 0,n.cardOpen=!1},n.saveBucketAccelerate=function(t){u.analyticsTrackClick(l.ANALYTICS.SAVE_ACCELERATE,l.ANALYTICS.DETAILS),t.stopPropagation(),n.error=void 0,n.saving=!0,o.putBucketAccelerate(c.getCurrentBucket(),new s(l.ANALYTICS.PUT_BUCKET_ACCELERATE),n.accelerate.selectedValue).then(function(){n.cachedAccelerate.selectedValue=e.copy(n.accelerate.selectedValue),n.cardOpen=!1}).catch(function(e){n.error=e}).finally(function(){n.saving=!1,d()})},function(){p()}()}e.module("s3").directive("bucketAccelerate",[function(){return{restrict:"E",scope:{cardOpen:"=",id:"@?"},template:n(754),controller:"BucketAccelerateController"}}]),e.module("s3").controller("BucketAccelerateController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-id=scrollCardId card-summary-obj=cardSummaryObj is-open=cardOpen ng-class="{ \'card-disable-bolt-water-mark\': !cardOpen, \'card-enable-bolt-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.label.accelerate></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelBucketAccelerate($event)></div> </card-header> <card-content> <p ng-if=!cardOpen class=bucketproperties-summary translate=bucketproperties.summary.accelerate></p> <p class=accelerate-endpoint ng-if=cardOpen translate=bucketproperties.acceleration.endpoint translate-values="{ endpoint: \'{{accelerate.endpoint}}\' }"></p> <p class=accelerate-description ng-if=cardOpen translate=bucketproperties.description.accelerate></p> <a class=accelerate-compare ng-if=cardOpen target=_blank href={{comparisonEndpoint}} translate=bucketproperties.compare.accelerate></a> <div ng-if=cardOpen class=padding-bottom-20></div> <div class=awsui-container ng-if=cardOpen> <awsui-radio-group ng-model=accelerate.selectedValue> <div class="awsui-row card-content-row"> <awsui-radio-button class=enableAccelerate value=Enabled ng-model=accelerate.selectedValue label="{{ \'bucketproperty.enabled\' | translate }}"></awsui-radio-button> </div> <div class="awsui-row card-content-row"> <awsui-radio-button class=suspendAccelerate value=Suspended ng-model=accelerate.selectedValue label="{{ \'bucketproperty.suspended\' | translate }}"> </awsui-radio-button> </div> </awsui-radio-group> </div> <awsui-alert type=error class=error-alert ng-if="error && cardOpen"> {{ error }}</awsui-alert> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{learnMoreLink}} translate>learn.more</a> <div ng-if=cardOpen class=padding-bottom-20></div> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button id=cancel-bucket-accelerate ng-click=cancelBucketAccelerate($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-accelerate ng-click=saveBucketAccelerate($event) text="{{ \'button.save\' | translate }}" variant=primary loading=saving></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e){!function(){function t(e,t,n,r){this.isRegionalFeatureEnabled=function(i,a){return a?e.resolve(n.isFeatureEnabled(i+"-"+a)):t.getBucketLocation(r.getCurrentBucket()).then(function(e){return n.isFeatureEnabled(i+"-"+e)})}}e.module("s3").service("FACService",["$q","BucketPropertiesService","FAC","PathService",t])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("keepFocus",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){var i=void 0;n.on("keydown",function(t){var a=n.closest(r.keepFocus);a&&(i&&(e.cancel(i),i=null),i=e(function(){a.find("[keep-focus] input").focus()}))})}}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function r(e,r,i,a,o,s,c,l,u){function d(e){return a.listAllMyBuckets(A,!0).then(function(t){return l.log(c.OPERATION_NAME.LAMB,1,A),t.response.ListAllMyBucketsResult.Buckets.Bucket.some(function(t){return t.Name===e})})}function p(e,t){var n=JSON.stringify(t,null,"    ");return n=n.replace(/ACCOUNT_ID/g,u.getUserAccountId()),n=n.replace(/DESTINATION_BUCKET/g,e)}function f(e,t,n){var r=JSON.stringify(n,null,"    ");return t&&(r=r.replace(/IAM_ARN/g,t)),e&&(r=r.replace(/DESTINATION_BUCKET_ARN/g,e)),r}function g(t,i,a){var s=u.getUserAccountId(),p=c.MANAGEMENT.POLICY.STATUS.FAILED,f="";return d(t).then(function(u){return u?o.getBucketPolicy(i,S,!1).then(function(u){l.log(c.OPERATION_NAME.GET_BUCKET_POLICY,1,S);var d=v(s,u,t,i),g=b(s,t,i);if(d.deny)return p=c.MANAGEMENT.POLICY.STATUS.DENY,f=e("json")(g.Statement[0],c.MANAGEMENT.POLICY.SPACING),E(p,a,f),p;if(d.needsPolicy){var m=function(){if(d.warn)return p=c.MANAGEMENT.POLICY.STATUS.WARN,f=e("json")(g.Statement[0],c.MANAGEMENT.POLICY.SPACING),E(p,a,f),{v:p};var n=!1;u&&u.Statement&&(d.existingStatement?(h(s,t,d.existingStatement),f=e("json")(d.existingStatement,c.MANAGEMENT.POLICY.SPACING)):(u.Statement.push(g.Statement[0]),f=e("json")(g.Statement[0],c.MANAGEMENT.POLICY.SPACING)),g=u,n=!0);var m=e("json")(g,c.MANAGEMENT.POLICY.SPACING);return{v:o.putBucketPolicy(i,m,y).then(function(e){return l.log(c.OPERATION_NAME.PUT_BUCKET_POLICY,1,y),n?(p=c.MANAGEMENT.POLICY.STATUS.MODIFIED,E(p,a,f)):(p=c.MANAGEMENT.POLICY.STATUS.CREATED,E(p,a,m)),p}).catch(function(e){return l.log(c.OPERATION_NAME.PUT_BUCKET_POLICY,0,y),E(p,a,f),r.reject(p)})}}();if("object"===(void 0===m?"undefined":n(m)))return m.v}else p=c.MANAGEMENT.POLICY.STATUS.FOUND;return E(p,a),p}).catch(function(e){return l.log(c.OPERATION_NAME.GET_BUCKET_POLICY,0,S),m(s,t,i,p,a),p}):(m(null,t,i,p,a),p)}).catch(function(){return l.log(c.OPERATION_NAME.LAMB,0,A),m(null,t,i,p,a),p})}function m(t,n,r,i,a){var o=b(t,n,r);E(i,a,e("json")(o,c.MANAGEMENT.POLICY.SPACING))}function h(e,t,n){var r=u.getBucketARN(t),i=u.transformObjectToArray(n.Condition.StringEquals[c.MANAGEMENT.POLICY.ACCOUNT_KEY]);-1===i.indexOf(e)&&(i.push(e),n.Condition.StringEquals[c.MANAGEMENT.POLICY.ACCOUNT_KEY]=i);var a=u.transformObjectToArray(n.Condition.ArnLike[c.MANAGEMENT.POLICY.SOURCE_ARN]);-1===a.indexOf(r)&&(a.push(r),n.Condition.ArnLike[c.MANAGEMENT.POLICY.SOURCE_ARN]=a)}function b(e,t,n){var r=u.getBucketARN(t),a=u.getBucketARN(n),o={Id:c.MANAGEMENT.POLICY.ID+"-"+(new Date).getTime(),Version:"2012-10-17",Statement:[{Sid:c.MANAGEMENT.POLICY.SID+"-"+(new Date).getTime(),Effect:"Allow",Principal:{Service:"s3.amazonaws.com"},Action:["s3:PutObject"],Resource:[],Condition:{ArnLike:{"aws:SourceArn":[]},StringEquals:{"aws:SourceAccount":[],"s3:x-amz-acl":"bucket-owner-full-control"}}}]};return o.Statement[0].Resource.push(a+"/*"),o.Statement[0].Condition.ArnLike["aws:SourceArn"].push(r),e?o.Statement[0].Condition.StringEquals["aws:SourceAccount"].push(e):o.Statement[0].Condition.StringEquals["aws:SourceAccount"].push(i.instant("bucketproperties.policy.auto.create.account.replace")),o}function v(e,n,r,i){var a={deny:!1,existingStatement:null,needsPolicy:!0,warn:!1},o=u.getBucketARN(r),s=u.getBucketARN(i);return e?(n&&t.forEach(n.Statement,function(t){t.Principal&&u.checkValue(t.Principal.Service,c.MANAGEMENT.POLICY.SERVICE_VAL)&&u.checkValue(t.Action,c.MANAGEMENT.POLICY.ACTION)&&u.checkValue(t.Resource,s+"/*")&&(t.Condition?t.Condition.ArnLike&&t.Condition.StringEquals&&t.Condition.ArnLike[c.MANAGEMENT.POLICY.SOURCE_ARN]&&t.Condition.StringEquals[c.MANAGEMENT.POLICY.ACCOUNT_KEY]&&u.checkValue(t.Condition.StringEquals[c.MANAGEMENT.POLICY.X_AMZ_ACL_KEY],c.MANAGEMENT.POLICY.X_AMZ_ACL_VAL)&&(u.checkValue(t.Condition.ArnLike[c.MANAGEMENT.POLICY.SOURCE_ARN],o)&&u.checkValue(t.Condition.StringEquals[c.MANAGEMENT.POLICY.ACCOUNT_KEY],e)?t.Effect===c.MANAGEMENT.POLICY.DENY?a.deny=!0:-1!==t.Sid.indexOf(c.MANAGEMENT.POLICY.SID)?a.needsPolicy=!1:a.warn=!0:"Deny"===t.Effect?a.deny=!0:a.existingStatement||-1===t.Sid.indexOf(c.MANAGEMENT.POLICY.SID)||(a.existingStatement=t)):t.Effect===c.MANAGEMENT.POLICY.DENY?a.deny=!0:a.warn=!0)}),a):(a.needsPolicy=!1,a)}function E(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];switch(t.policyType="info",t.policyHeader=i.instant("bucketproperties.policy.auto.create.success.header"),t.policyDefinition=n,e){case c.MANAGEMENT.POLICY.STATUS.CREATED:t.policyMessage=i.instant("bucketproperties.policy.auto.create.success.info");break;case c.MANAGEMENT.POLICY.STATUS.MODIFIED:t.policyHeader=i.instant("bucketproperties.policy.auto.modify.success.header"),t.policyMessage=i.instant("bucketproperties.policy.auto.modify.success.info");break;case c.MANAGEMENT.POLICY.STATUS.FOUND:t.policyMessage="",t.policyHeader="";break;case c.MANAGEMENT.POLICY.STATUS.FAILED:t.policyHeader=i.instant("bucketproperties.policy.auto.create.error.header"),t.policyMessage=i.instant("bucketproperties.policy.account.error.message"),t.policyType="warning";break;case c.MANAGEMENT.POLICY.STATUS.WARN:t.policyHeader=i.instant("bucketproperties.policy.auto.create.warn.header"),t.policyMessage=i.instant("bucketproperties.policy.auto.create.warn.message"),t.policyType="warning";break;case c.MANAGEMENT.POLICY.STATUS.DENY:t.policyHeader=i.instant("bucketproperties.policy.auto.create.deny.header"),t.policyMessage=i.instant("bucketproperties.policy.auto.create.deny.message"),t.policyType="warning"}}var S=new s(c.OPERATION_NAME.GET_BUCKET_POLICY),y=new s(c.OPERATION_NAME.PUT_BUCKET_POLICY),A=new s(c.OPERATION_NAME.LAMB);return{createBucketPolicy:g,generateBucketPolicy:p,generateBucketPolicyWithArn:f}}e.module("s3").service("BucketPolicyService",["$filter","$q","$translate","APIProxyService","BucketPropertiesService","ConsoleOperation","S3Constants","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("initiateRestoreModal",function(){return{scope:{isOpen:"=",selectedRestoreObjects:"=?",objectHeaders:"<"},template:n(759),controller:"InitiateRestoreController"}}),e.module("s3").controller("InitiateRestoreController",["$scope","$translate","APIProxyService","PathService","OperationDispatcherService","CountService","S3Constants","SCLogService","UtilService","BulkOperationService","FAC",function(n,r,i,a,o,s,c,l,u,d,p){function f(e){var n=t.filter(A,{StorageClass:e}),i=d.createBulkOperation(c.OPERATION_NAME.INITIATE_RESTORE,n,[],0,null),a=r.instant("initiaterestoremodal.header.title.glacier");e===c.STORAGE_CLASSES.DEEP_ARCHIVE&&(a=r.instant("initiaterestoremodal.header.title.glacierdeeparchive"));var o=t.cloneDeep(R),l={flag:!1},u={currFolderPathPrefix:i.initialPath,folders:[],objects:n};return s.countAllFiles(u,o,i,l),{storageClass:e,title:a,countInfo:o,params:{retrievalOption:E,numOfDays:null},operation:i,numOfDaysError:[],showBuyConfirmation:!1,capacityUnitsAvailable:0,capacityUnits:null,isPurchaseSuccessful:!1,capacityCost:null,showCapacityInfo:!1,isLoading:!0,operationAdded:!1}}function g(e){if(e.storageClass!==c.STORAGE_CLASSES.DEEP_ARCHIVE||p.isFeatureEnabled(c.FAC.DEEP_ARCHIVE)){var t=n.objectHeaders?n.objectHeaders[c.HEADERS.X_AMZ_RESTORE_TIER]:void 0,r=e.storageClass===c.STORAGE_CLASSES.GLACIER?y:S;if(e.isTierUpgrade=p.isFeatureEnabled(c.FAC.RESTORE_SPEED_PROMOTION)&&t&&t!==r,e.isTierUpgrade){var i=n.objectHeaders[c.HEADERS.X_AMZ_RESTORE_EXPIRY_DAYS];e.currentRestore={days:i,daysText:u.getDaysString(i),tier:n.objectHeaders[c.HEADERS.X_AMZ_RESTORE_TIER]},e.params.numOfDays=e.currentRestore.days,b(e)}}}function m(e,t){var n=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];p.isFeatureEnabled(c.FAC.DEEP_ARCHIVE)&&t===c.STORAGE_CLASSES.DEEP_ARCHIVE&&(e.pop(),h(e),h(n))}function h(t){t&&e.forEach(t,function(e,t){e.value===E?e.detail=r.instant("initiaterestoremodal.radio.detail.bulkRetrieval.deeparchive"):e.value===S&&(e.detail=r.instant("initiaterestoremodal.radio.detail.standardRetrieval.deeparchive"))})}function b(e){e.availableApproximatelyValues={availableDate:v(e)}}function v(e){var t=new Date,n=new Date;return n.setDate(t.getDate()+parseInt(e.params.numOfDays)),u.formatDate(n,"yyyy-MM-dd")}var E=c.INITIATE_RESTORE.BULK_RETRIEVAL,S=c.INITIATE_RESTORE.STANDARD_RETRIEVAL,y=c.INITIATE_RESTORE.EXPEDITED_RETRIEVAL,A=n.selectedRestoreObjects,C=t.filter(A,{StorageClass:c.STORAGE_CLASSES.GLACIER}),_=t.filter(A,{StorageClass:c.STORAGE_CLASSES.DEEP_ARCHIVE}),w=C.length===A.length,T=_.length===A.length;n.selected={objectsPerStorageClass:[]};var R={flag:!1,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};w?(n.selected.objectsPerStorageClass.push(f(c.STORAGE_CLASSES.GLACIER)),g(n.selected.objectsPerStorageClass[0])):T&&p.isFeatureEnabled(c.FAC.DEEP_ARCHIVE)?(n.selected.objectsPerStorageClass.push(f(c.STORAGE_CLASSES.DEEP_ARCHIVE)),g(n.selected.objectsPerStorageClass[0])):(n.selected.objectsPerStorageClass.push(f(c.STORAGE_CLASSES.GLACIER)),p.isFeatureEnabled(c.FAC.DEEP_ARCHIVE)&&n.selected.objectsPerStorageClass.push(f(c.STORAGE_CLASSES.DEEP_ARCHIVE))),n.headerTitle=r.instant("initiaterestoremodal.header.title.restore"),n.restoreCharges=r.instant("initiaterestoremodal.label.restoreCharges.glacierdeeparchive"),n.pricingUrl=u.getPricingUrl("glacier"),n.learnMoreDataRetrievalUrl=u.getDataRetrievalUrl();var O={value:E,title:r.instant("initiaterestoremodal.radio.title.bulkRetrieval"),detail:r.instant("initiaterestoremodal.radio.detail.bulkRetrieval.glacier")},k={value:S,title:r.instant("initiaterestoremodal.radio.title.standardRetrieval"),detail:r.instant("initiaterestoremodal.radio.detail.standardRetrieval.glacier")},I={value:S,title:r.instant("initiaterestoremodal.radio.title.upgradeToStandardRetrieval"),detail:r.instant("initiaterestoremodal.radio.detail.standardRetrieval.glacier")},P={value:y,title:r.instant("initiaterestoremodal.radio.title.ExpeditedRetrieval"),detail:r.instant("initiaterestoremodal.radio.detail.ExpeditedRetrieval")},N={value:y,title:r.instant("initiaterestoremodal.radio.title.upgradeToExpeditedRetrieval"),detail:r.instant("initiaterestoremodal.radio.detail.ExpeditedRetrieval")},M=function(e){if(e.isTierUpgrade)switch(e.retrievalOptions=[],e.currentRestore.tier){case E:e.currentRestore.Details=O,e.params.retrievalOption=S,e.retrievalOptions=[t.cloneDeep(I),t.cloneDeep(N)],m(e.retrievalOptions,e.storageClass,[e.currentRestore.Details]);break;case S:e.currentRestore.Details=k,e.retrievalOptions=[t.cloneDeep(N)],m(e.retrievalOptionslOptions,e.storageClass,[e.currentRestore.Details])}else e.retrievalOptions=[t.cloneDeep(O),t.cloneDeep(k),t.cloneDeep(P)],m(e.retrievalOptions,e.storageClass)},L=function(e){var t={};return i.getBucketLocation(e.operation,a.getCurrentBucket(),t).then(function(t){e.params.region=t.region,l.log("GetBucketLocation",1,e.operation),e.capacityCost=c.INITIATE_RESTORE.EXPEDITED_RETRIEVAL_COST[t.region]}).catch(function(t){l.log("GetBucketLocation",0,e.operation,t)})};n.closeModal=function(){n.isOpen.flag=!1,n.selected.objectsPerStorageClass=[],n.selectedRestoreObjects=null},n.disableRestoreButton=function(){var t=!1;return e.forEach(n.selected.objectsPerStorageClass,function(e){t|=!e.params.numOfDays||!e.params.retrievalOption||e.numOfDaysError.length>0||0===e.retrievalOptions.length}),t},n.restore=function(){var t=!0;e.forEach(n.selected.objectsPerStorageClass,function(e){e.params.numOfDays?e.params.retrievalOption?(e.operation.additionalInfo={expirationDays:e.params.numOfDays,numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,tier:e.params.retrievalOption},e.operation.totalObjectCount=e.countInfo.objects,l.log(e.operation.name.replace(/\s/g,"")+"ttlObj",e.operation.totalObjectCount,e.operation),l.log(e.operation.name.replace(/\s/g,"")+"ttlSize",e.countInfo.size,e.operation),o.addOperation(e.operation),e.operationAdded=!0):(t=!1,e.retrievalError=r.instant("initiaterestoremodal.dropboxselectwarning")):(t=!1,e.numOfDaysError=[r.instant("initiaterestoremodal.emptywarning")])}),t&&n.closeModal()},e.forEach(n.selected.objectsPerStorageClass,function(e){L(e).then(M(e)).finally(function(){e.isLoading=!1})})}])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=initiate-restore-modal ng-show=isOpen.flag> <dialog-modal is-open=isOpen close-callback=closeModal() header-title=headerTitle> <dialog-modal-content> <span class=restore-header translate=initiaterestoremodal.detail.numOfDays></span><external-link href={{pricingUrl}} text="{{\'initiaterestoremodal.msg.S3Pricing\' | translate }}"></external-link><br> <restore-details-panel ng-if=selected.objectsPerStorageClass[0] objects-per-storage-class=selected.objectsPerStorageClass[0]></restore-details-panel> <a id=bottom-of-content></a> <restore-details-panel ng-if=selected.objectsPerStorageClass[1] objects-per-storage-class=selected.objectsPerStorageClass[1]></restore-details-panel> </dialog-modal-content> <dialog-modal-footer> <div class=upload-modal-footer> <awsui-button id=cancel text="{{ \'button.cancel\' | translate }}" variant=normal click=closeModal()></awsui-button> <awsui-button id=restore class="awsui-util-f-r primary-button" text="{{ \'initiaterestoremodal.footer.restore\' | translate }}" variant=primary click=restore() data-disabled=disableRestoreButton()></awsui-button> </div> </dialog-modal-footer> </dialog-modal> </div>'},function(e,t,n){"use strict";(function(e,t){function r(e,n,r,i,a,o,s,c){e.titles=[{txt:n.instant("initiaterestoremodal.titles.capacityId"),info:n.instant("initiaterestoremodal.capacityid.tooltip"),pos:"right"},{txt:n.instant("initiaterestoremodal.titles.purchaseDate"),info:n.instant("initiaterestoremodal.purchaseDate.tooltip"),pos:"right"},{txt:n.instant("initiaterestoremodal.titles.expirationDate"),info:n.instant("initiaterestoremodal.expirationDate.tooltip"),pos:"left"}],e.pricingUrl=s.getPricingUrl("glacier"),e.buyCapacity=function(){e.objectsPerStorageClass.showBuyConfirmation=!1,e.purchaseCapacity()},e.purchaseCapacity=function(){e.objectsPerStorageClass.isPurchasingCapacity=!0,e.objectsPerStorageClass.isPurchaseSuccessful=!1,r.purchaseProvisionedCapacity(e.objectsPerStorageClass.operation,i.getCurrentBucket(),e.objectsPerStorageClass.params.region).then(function(t){o.log("PurchaseProvisionedCapacity",1,e.objectsPerStorageClass.operation),e.objectsPerStorageClass.isPurchaseSuccessful=!0,e.objectsPerStorageClass.showBuyConfirmation=!1,e.getCapacity()}).catch(function(t){e.objectsPerStorageClass.retrievalError=s.handleErrors(t),o.log("PurchaseProvisionedCapacity",0,e.objectsPerStorageClass.operation,t)}).finally(function(){e.objectsPerStorageClass.isPurchasingCapacity=!1})},e.getCapacity=function(){return r.listProvisionedCapacity(e.objectsPerStorageClass.operation,i.getCurrentBucket(),e.objectsPerStorageClass.params.region).then(function(n){o.log("ListProvisionedCapacity",1,e.objectsPerStorageClass.operation),e.objectsPerStorageClass.capacityUnits=t.map(n,function(e){return{id:e.CapacityId,purchaseDate:s.formatDate(e.StartDate,a.DATE_FORMAT),expirationDate:s.formatDate(e.ExpirationDate,a.DATE_FORMAT)}}),e.objectsPerStorageClass.capacityUnitsAvailable=e.objectsPerStorageClass.capacityUnits.length}).catch(function(t){e.objectsPerStorageClass.retrievalError=s.handleErrors(t),o.log("ListProvisionedCapacity",0,e.objectsPerStorageClass.operation,t)})},e.$watch("objectsPerStorageClass.params.retrievalOption",function(t){e.objectsPerStorageClass.retrievalError=null,e.objectsPerStorageClass.showCapacityInfo=t===a.INITIATE_RESTORE.EXPEDITED_RETRIEVAL&&!e.objectsPerStorageClass.isTierUpgrade,e.objectsPerStorageClass.showCapacityInfo&&e.getCapacity().then(function(){return s.scrollTo("bottom-of-content")})}),e.addCapacity=function(){e.objectsPerStorageClass.showBuyConfirmation=!0,e.objectsPerStorageClass.isPurchaseSuccessful=!1},e.buyConfirmationDismissed=function(){e.objectsPerStorageClass.showBuyConfirmation=!1},e.validateNumOfDays=function(t){isNaN(t)||parseInt(t)<1?e.objectsPerStorageClass.numOfDaysError=[n.instant("initiaterestoremodal.numofdaysinvalidwarning")]:t>2147483647?e.objectsPerStorageClass.numOfDaysError=[n.instant("initiaterestoremodal.highernumbererror")]:(e.objectsPerStorageClass.numOfDaysError=[],e.setAvailableUntilText())},e.setAvailableUntilText=function(){e.objectsPerStorageClass.availableApproximatelyValues={availableDate:e.getAvailableUntilText()}},e.getAvailableUntilText=function(){var t=new Date,n=new Date;return n.setDate(t.getDate()+parseInt(e.objectsPerStorageClass.params.numOfDays)),s.formatDate(n,"yyyy-MM-dd")}}e.module("s3").directive("restoreDetailsPanel",[function(){return{restrict:"E",scope:{objectsPerStorageClass:"="},template:n(761),controller:"RestoreDetailsPanelController"}}]),e.module("s3").controller("RestoreDetailsPanelController",["$scope","$translate","APIProxyService","PathService","S3Constants","SCLogService","UtilService","FAC",r])}).call(t,n(0),n(2))},function(e,t){e.exports='<div class=restore-detail data-e2e-id=restore-detail> <div class=num-of-days-section> <div class=restore-subheader>{{objectsPerStorageClass.title}}</div> <div class=total-objects-details> <strong> <span translate=confirmationmodal.countinfo.totalobjects></span> </strong> <span>{{objectsPerStorageClass.countInfo.objects}}</span> </div> <div class="total-objects-details number-of-days-margin"> <strong> <span translate=confirmationmodal.countinfo.totalsize></span> </strong> <awsui-tooltip ng-if=objectsPerStorageClass.countInfo.sizeDataMissing text="{{\'confirmationmodal.info.sizedatamissing\' | translate}}" position=bottom size=small> <span> {{objectsPerStorageClass.countInfo.size | humanReadableBytes}} <span>*</span> </span> </awsui-tooltip> <span ng-if=!objectsPerStorageClass.countInfo.sizeDataMissing> {{objectsPerStorageClass.countInfo.size | humanReadableBytes}} </span> </div> <div class=label translate=initiaterestoremodal.title.numOfDays></div> <awsui-control-group ng-if=!objectsPerStorageClass.isTierUpgrade> <span dom-region=validationMessage ng-if="objectsPerStorageClass.numOfDaysError.length > 0"> <label ng-repeat="message in objectsPerStorageClass.numOfDaysError">{{message}}</label><br> </span> <span dom-region=control> <awsui-textfield id=num-of-days class=num-of-days ng-model=objectsPerStorageClass.params.numOfDays ng-keyup=validateNumOfDays(objectsPerStorageClass.params.numOfDays)> </awsui-textfield> <span class=days-text translate=initiaterestoremodal.placeholder.numOfDays></span> </span></awsui-control-group> <div ng-if=objectsPerStorageClass.isTierUpgrade class=currentrestore-days> <span data-e2e-id=num-of-days-label>{{ objectsPerStorageClass.currentRestore.days }}</span><span class=days-text>{{objectsPerStorageClass.currentRestore.daysText}}</span> </div> <p ng-if="objectsPerStorageClass.availableApproximatelyValues.availableDate.length === 10" class=available-approximately translate=initiaterestoremodal.availableapproximately translate-values=objectsPerStorageClass.availableApproximatelyValues></p> </div> <div class=retrieval-option-section> <div class=retrieval-option-text> <p class=label translate=initiaterestoremodal.label.restoreTier></p> </div> <div class=current-restore ng-if=objectsPerStorageClass.isTierUpgrade> <span class=current-restore-title>{{ objectsPerStorageClass.currentRestore.Details.title }}</span> <p class=current-restore-detail>{{ objectsPerStorageClass.currentRestore.Details.detail }}</p> </div> <div ng-if=objectsPerStorageClass.isLoading class=replication-loading><span class="awsui-spinner awsui-spinner-large"></span></div> <awsui-radio-group ng-model=objectsPerStorageClass.params.retrievalOption id=retrieval-options-radio-group> <awsui-radio-button class=radio-button--small ng-repeat="option in objectsPerStorageClass.retrievalOptions" value={{option.value}} disabled={{option.isDisabled}}> <span data-e2e-id=title_{{option.value}} class=retrieval-option-title>{{ option.title }}</span> <p data-e2e-id=detail_{{option.value}} class=retrieval-option-detail>{{ option.detail }}</p> </awsui-radio-button> </awsui-radio-group> </div> <div ng-if=objectsPerStorageClass.showCapacityInfo class=provisioned-capacity-info> <span class=provisioned-capacity-availability> <p class="label provisioned-capacity-available-text" translate=initiaterestoremodal.label.purchasedCapacity></p> <p class="label provisioned-capacity-units-available">{{ objectsPerStorageClass.capacityUnitsAvailable }} </p> </span> <div> <awsui-button class=add-capacity disabled=objectsPerStorageClass.showBuyConfirmation text="{{ \'initiaterestoremodal.button.addOneCapacityUnit\' | translate }}" variant=normal click=addCapacity() loading=objectsPerStorageClass.isPurchasingCapacity></awsui-button> <awsui-alert ng-if=objectsPerStorageClass.showBuyConfirmation type=info dismissible=true dismiss=buyConfirmationDismissed() header="{{ \'initiaterestoremodal.msg.provisionedCapacityConfirmationTitle\' | translate }}"> <p class=alert-text> <span translate=initiaterestoremodal.msg.provisionedCapacityConfirmationDetail1></span> <external-link href={{pricingUrl}} text="{{ \'initiaterestoremodal.msg.S3Pricing\' | translate}}"></external-link> </p> <p class=alert-text translate=initiaterestoremodal.msg.provisionedCapacityConfirmationDetail2></p> <p class=alert-text translate=initiaterestoremodal.msg.provisionedCapacityConfirmationDetail3></p> <awsui-button class=buy-capacity text="{{ \'initiaterestoremodal.button.purchase\' | translate }}" variant=normal click=buyCapacity() loading=objectsPerStorageClass.isPurchasingCapacity> </awsui-button> </awsui-alert> <awsui-alert ng-if=objectsPerStorageClass.isPurchaseSuccessful type=success dismissible=false header="{{ \'initiaterestoremodal.purchasedetails.succeedText\' | translate }}"> <p class=info-text translate=initiaterestoremodal.purchasedetails.priceText translate-values="{ val: capacityCost }"></p> </awsui-alert> <awsui-alert class=retrieval-error type=error ng-if=objectsPerStorageClass.retrievalError dismissible=false> {{objectsPerStorageClass.retrievalError }} </awsui-alert> <div ng-if="!objectsPerStorageClass.showBuyConfirmation && !objectsPerStorageClass.isPurchaseSuccessful"> <p class=info-text translate=initiaterestoremodal.purchaseinfo.section1></p> <span class=info-text translate=initiaterestoremodal.purchaseinfo.section2></span> <external-link href={{pricingUrl}} text="{{ \'initiaterestoremodal.msg.S3Pricing\' | translate}}"></external-link> <br><br> </div> </div> <div ng-if="objectsPerStorageClass.showCapacityInfo && objectsPerStorageClass.capacityUnitsAvailable > 0"> <table class=expandsectable> <tr class=subsectitle-row> <td ng-repeat="title in titles"> {{title.txt}} <awsui-tooltip text={{title.info}} position={{title.pos}} size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </td> </tr> <tr class=subseccontent-row ng-repeat="unit in objectsPerStorageClass.capacityUnits"> <td>{{unit.id}}</td> <td>{{unit.purchaseDate}}</td> <td>{{unit.expirationDate}}</td> </tr> </table> </div> </div> </div>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(n,r,i,a,o,s,c,l){function u(){n.cardSummaryObj.isActive=n.requesterPays.selectedValue===n.requesterPaysStates.enabled}function d(){var t=s.getCurrentBucket();n.cardSummaryObj.isLoading=!0,n.error=null,a.isRequesterPaysEnabled(t).then(function(e){n.requesterPays.selectedValue=!0===e?n.requesterPaysStates.enabled:n.requesterPaysStates.disabled}).catch(function(e){n.requesterPays.selectedValue=null,n.error=l.handleErrors(e)}).finally(function(){n.cachedRequesterPays=e.copy(n.requesterPays),u(),n.cardSummaryObj.isLoading=!1})}n.docLink=i.getDocUrl(c.LEARN_MORE_LINKS.REQUESTER_PAYS),n.requesterPaysStates={enabled:"Requester",disabled:"BucketOwner"},n.error=null,n.requesterPays={},n.requesterPays.selectedValue=n.requesterPaysStates.disabled,n.scrollCardId="#"+n.id,n.cardSummaryObj=t.cloneDeep(c.CARD_SUMMARY_INIT),n.cardSummaryObj.activeSummary.text=r.instant("bucketproperties.requesterpays.cardsummary.enabled"),n.cardSummaryObj.inactiveSummary.text=r.instant("bucketproperties.requesterpays.cardsummary.disabled"),u(),n.cancelBucketRequesterPays=function(t){l.analyticsTrackClick(c.ANALYTICS.CANCEL_REQUESTER_PAYS,c.ANALYTICS.DETAILS),t.stopPropagation(),n.requesterPays=e.copy(n.cachedRequesterPays),u(),n.error=null,n.cardOpen=!1},n.saveBucketRequesterPays=function(t){l.analyticsTrackClick(c.ANALYTICS.SAVE_REQUESTER_PAYS,c.ANALYTICS.DETAILS),t.stopPropagation(),n.error=null,n.saving=!0;var r=void 0,i=null,d=s.getCurrentBucket();n.requesterPays.selectedValue===n.requesterPaysStates.enabled?(r=a.enableBucketRequestPayment,i=new o("enableBucketVersioning")):(r=a.disableBucketRequestPayment,i=new o("disableBucketVersioning")),r(d,i).then(function(){n.cachedRequesterPays.selectedValue=e.copy(n.requesterPays.selectedValue),n.cardOpen=!1,n.error=null,u()}).catch(function(e){n.error=e}).finally(function(){n.saving=!1,u()})},function(){d()}()}e.module("s3").directive("bucketRequesterPays",[function(){return{restrict:"E",scope:{cardOpen:"=",id:"@?"},template:n(763),controller:"BucketRequesterPaysController"}}]),e.module("s3").controller("BucketRequesterPaysController",["$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-requesterpays-water-mark\': !cardOpen, \'card-enable-requesterpays-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.requesterpays.label.requesterpays></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelBucketRequesterPays($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.requesterpays.summary></p> <div class=awsui-container ng-if=cardOpen> <awsui-radio-group ng-model=requesterPays.selectedValue> <div class="awsui-row card-content-row"> <awsui-radio-button class=enableRequesterPays value=Requester ng-model=requesterPays.selectedValue label="{{ \'bucketproperties.requesterpays.label.enablerequesterpays\' | translate }}"></awsui-radio-button> <p class=requesterpays-description translate=bucketproperties.requesterpays.description.enablerequesterpays></p> </div> <div class="awsui-row card-content-row"> <awsui-radio-button class=disableRequesterPays value=BucketOwner ng-model=requesterPays.selectedValue label="{{ \'bucketproperties.requesterpays.label.disablerequesterpays\' | translate }}"> </awsui-radio-button> <p class=requesterpays-description translate=bucketproperties.requesterpays.description.disablerequesterpays></p> </div> </awsui-radio-group> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert type=error class=error-alert ng-if="error && cardOpen"> {{ error }}</awsui-alert> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button id=cancel-bucket-requesterpays ng-click=cancelBucketRequesterPays($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-requesterpays ng-click=saveBucketRequesterPays($event) text="{{ \'button.save\' | translate }}" variant=primary loading=saving></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").constant("QuicksightConstants",{PARAM:{PARTNER_TYPE:"partner_type=",ACCOUNT_ID:"account_id=",USER_ID:"user_id=",BUCKET_NAME:"bucket_name=",CONFIG_TYPE:"config_type=",FILTER_ID:"filter_id=",FILE_PATH:"file_path=",PREFIX:"prefix=",TAG:"tag="},PARTNER_TYPE_VALUES:{S3_ANALYTICS:"s3_analytics"},CONFIG_TYPES:{STORAGE_CLASS_ANALYSIS:"Storage class analysis"},SN_INTEGRATION:"sn/partner-analytics",S3_PREFIX:"s3://"})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){function t(t,n,r,i){function a(e,a,s){var c=null,l=r.SN_INTEGRATION,u=r.PARTNER_TYPE_VALUES.S3_ANALYTICS,d=i.getUserAccountId(),p=i.getUserNameARN(),f=r.CONFIG_TYPES.STORAGE_CLASS_ANALYSIS,g=n.getAnalyticsSharedDataFilePath(e,a.Id,s),m=o(a.Filter);if(g){var h=[];h.push(l+"?"+r.PARAM.PARTNER_TYPE+encodeURIComponent(u),""+r.PARAM.ACCOUNT_ID+encodeURIComponent(d),""+r.PARAM.USER_ID+encodeURIComponent(p),""+r.PARAM.BUCKET_NAME+encodeURIComponent(e),""+r.PARAM.CONFIG_TYPE+encodeURIComponent(f),""+r.PARAM.FILTER_ID+encodeURIComponent(a.Id),""+r.PARAM.FILE_PATH+encodeURIComponent(r.S3_PREFIX+g.fullDataPath)),m.prefixes&&h.push("prefix="+m.prefixes),m.tagKeys&&h.push("tagKeys="+m.tagKeys),m.tagVals&&h.push("tagVals="+m.tagVals),c=t.getQuicksightUrl(h.join("&"))}return c}function o(t){var n={},r=[],i=[],a=[];return t&&(t.And?e.forEach(t.And,function(t,n){n===s&&r.push(t),n===c&&(t=[].concat(t),e.forEach(t,function(e,t){i.push(e.Key),a.push(e.Value)}))}):t.Prefix?r.push(t.Prefix):t.Tag&&(i.push(t.Tag.Key),a.push(t.Tag.Value)),r.length>0&&(n.prefixes=encodeURIComponent(r.join())),i.length>0&&(n.tagKeys=encodeURIComponent(i.join()),n.tagVals=encodeURIComponent(a.join()))),n}var s="Prefix",c="Tag";return{generateQuicksightLink:a}}e.module("s3").service("QuicksightService",["AwsUrlsService","ManagementUtilService","QuicksightConstants","UtilService",t])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(){function i(e,n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C){function _(){var n=e.hasRules(),r=n&&e.selectedRule&&e.selectedRule.flag,i=e.selectedRule.ruleObj,a=i&&i.Status===b.REPLICATION.ENABLED,o=n&&-1!==t.findIndex(e.replicationObj.ruleSettings.Rule,{Status:b.REPLICATION.ENABLED}),s=n&&-1!==t.findIndex(e.replicationObj.ruleSettings.Rule,{Status:b.REPLICATION.DISABLED});V.disabled=!(r&&!a)||e.isEditingPriority,G.disabled=!(r&&a)||e.isEditingPriority,Y.disabled=!s||e.isEditingPriority,W.disabled=!o||e.isEditingPriority,z.disabled=!n||e.isEditingPriority,$.disabled=e.isV2Schema()||e.isEditingPriority}function w(n){var r=t.findIndex(e.replicationObj.ruleSettings.Rule,{ID:n.ID});return m.getUpdateReplicationObj(!1,e.replicationObj.globalSettings.Role,e.replicationObj.ruleSettings.Rule,e.replicationObj.ruleSettings.Rule[r],r)}function T(n,r){var i=t.findIndex(e.replicationObj.ruleSettings.Rule,{ID:n}),a=t.cloneDeep(e.replicationObj.ruleSettings.Rule[i]);return a.Status=r,m.getUpdateReplicationObj(!1,e.replicationObj.globalSettings.Role,e.replicationObj.ruleSettings.Rule,a)}function R(n){var r={};return r.destinationBucket=e.replicationObj.globalSettings.destinationBucket.name,r.destAccountId=e.replicationObj.globalSettings.destAccountId,r.role=e.replicationObj.globalSettings.Role.value,r.rules=t.cloneDeep(e.replicationObj.ruleSettings.Rule),t.forEach(r.rules,function(e){e.Status=n}),r}function O(){e.confirmationModalObj.isOpen.flag=!1,e.confirmationModalObj.contentTitle=null,e.confirmationModalObj.contentText=null,e.confirmationModalObj.translateValues=null,e.confirmationModalObj.saveValue=null,e.confirmationModalObj.title=null,e.selectedRule.flag=!1,e.selectedRule.ruleObj={}}function k(t,n){l.deleteBucketReplication(t,n).then(function(){E.log("CRR_deleteBucketReplication",1,n),e.replicationObj=B(),e.closeConfirmationModal()}).catch(function(t){E.log("CRR_deleteBucketReplication",0,n),e.confirmationModalError=S.handleErrors(t)}).finally(function(){e.isConfirming=!1})}function I(t,r,i,a){return l.putBucketReplication(t,r,i,void 0,a).then(function(){E.log("CRR_putBucketReplication",1,r),m.updateReplicationTable(e.replicationObj,e.confirmationModalObj.saveValue,e.replicationModalInfo.storageTextMapping),e.closeConfirmationModal()}).catch(function(t){return E.log("CRR_putBucketReplication",0,r),e.confirmationModalError=S.handleErrors(t),n.reject(t)}).finally(function(){e.isConfirming=!1})}function P(e){return e.Destination&&e.Destination.isAccessControlTranslation?"Dst":"Src"}function N(e){if(e.ID)return P(e.rules.find(function(t){return t.ID===e.ID}));var n=e.rules.map(function(e){return P(e)}),r=t.uniq(n);return 1===r.length?r[0]:"Mixed"}function M(e,t,n,r){var i="CRR_";switch(e){case b.REPLICATION.ENABLED:i+="enableRule";break;case b.REPLICATION.DISABLED:i+="disableRule";break;case b.REPLICATION.ENABLED_ALL:i+="enableAllRules";break;case b.REPLICATION.DISABLED_ALL:i+="disableAllRules"}i+="_"+N(r),E.log(i,n,t)}function L(n){return l.getBucketReplication(n,F).then(function(n){var r=n.response;E.log("CRR_getBucketReplication",1,F);var i=y.convertXmlStringToJson(r).ReplicationConfiguration;e.replicationObj.globalSettings.Role=t.isEmpty(i.Role)?"":{text:t.last(i.Role.split("/")),value:i.Role},e.replicationObj.ruleSettings.Rule=[].concat(i.Rule),e.isV2Schema()&&m.sortRulesByPriority(e.replicationObj.ruleSettings.Rule),t.forEach(e.replicationObj.ruleSettings.Rule,function(n){var r=m.extractDestinationBucket(n.Destination.Bucket);n.Destination.Bucket={name:r,region:null},e.replicationObj.globalSettings.destinationBucket.name=r,l.getBucketRegion(r).then(function(t){n.Destination.Bucket.region=t.text,e.replicationObj.globalSettings.destinationBucket.region=t.text}).catch(function(t){t.status===v.HTTP_STATUS_CODES.NOT_FOUND?e.replicationObj.errorMessage=o.instant("crr.error.destinationbucketdoesnotexist"):e.replicationObj.errorMessage=S.handleErrors(t)}),t.get(n,"Destination.Account")&&(e.replicationObj.globalSettings.destAccountId=n.Destination.Account),"Destination"===t.get(n,"Destination.AccessControlTranslation.Owner","")&&(n.Destination.isAccessControlTranslation=!0,e.replicationObj.globalSettings.accessControlTranslationIds.push(n.ID));var i=t.get(n,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");"Enabled"!==t.get(n,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")||t.isEmpty(i)||(n.Destination.isKmsEncryption=!0,n.Destination.replicaKmsKeyId=i,e.replicationObj.globalSettings.kmsEncryptionIds[n.ID]=i),n.Destination.changeDefaultStorageClass=!t.isEmpty(n.Destination.StorageClass),n.Destination.StorageClass={value:n.Destination.StorageClass,text:t.isEmpty(n.Destination.StorageClass)?K[v.STORAGE_CLASSES.DEFAULT]:K[n.Destination.StorageClass]},n.Prefix=t.isEmpty(n.Prefix)?"":n.Prefix,n.isEntireBucket=t.isEmpty(n.Prefix).toString(),n.sourceKMSKeys=[],e.globalConfigInfo.prefixOrWholeBucket="true"===n.isEntireBucket?{text:o.instant("crr.globalconfig.source.entirebucket"),value:e.globalConfigInfo.ENTIRE_BUCKET}:{text:o.instant("crr.globalconfig.source.prefix"),value:e.globalConfigInfo.PREFIX}}),e.globalConfigInfo.flag=e.replicationObj.ruleSettings.Rule&&e.replicationObj.ruleSettings.Rule.length>0,e.globalConfigInfo.isEntireBucket=t.findIndex(e.replicationObj.ruleSettings.Rule,function(e){return t.isEmpty(e.Prefix)})>-1,e.replicationObj.globalSettings.isEntireBucket=e.globalConfigInfo.isEntireBucket,t.values(e.replicationObj.globalSettings.kmsEncryptionIds).length>0&&m.getSourceSelectedKMSKeys(!0,{initialized:!1,optionList:[]},e.replicationObj,{}).then(function(){},function(t){e.globalConfigInfo.modalError.getKmsKeyError=t})}).catch(function(t){t!==b.REPLICATION.CONFIGNOTFOUND?(E.log("CRR_getBucketReplication",0,F),e.replicationObj.errorMessage=S.handleErrors(t)):E.log("CRR_getBucketReplication",1,F)}).finally(function(){e.isLoadingReplication=!1})}function x(){e.priorityEditPending=!0,e.updateRuleStatus(b.REPLICATION.UPGRADE_SCHEMA)}function D(){if(t.isEmpty(e.tmpReplicationObj)){e.tmpReplicationObj={Destination:{Bucket:t.cloneDeep(e.replicationObj.globalSettings.destinationBucket),StorageClass:{value:null,text:K[v.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:!1},Role:{text:e.replicationObj.globalSettings.Role.text,value:e.replicationObj.globalSettings.Role.value}};var n=e.replicationObj.globalSettings.destAccountId;n&&(e.tmpReplicationObj.Destination.Account=n)}}var j,B=function(){return{globalSettings:{sourceBucket:e.replicationObj&&e.replicationObj.globalSettings&&e.replicationObj.globalSettings.sourceBucket||{name:null,region:null},destinationBucket:{name:null,region:null},Role:null,accessControlTranslationIds:[],kmsEncryptionIds:{},selectedSourceKmsKeys:[],sourceKmsKeysObj:{initialized:!1},destAccountId:null},ruleSettings:{}}};e.headerTitle=o.instant("crr.upgradeconfirmation.title"),e.isLoadingBucketRetention=!1,e.bucketObjectRetentionEnabled=!1,e.showEmptyScreen=!0,e.oneIntroImage=!0,e.replicationObj=B(),e.isConfirmationModalOpen={flag:!1};var F=new u("getBucketReplication"),U=void 0,K=(j={},r(j,v.STORAGE_CLASSES.STANDARD,o.instant("replication.storageclasses.standard")),r(j,v.STORAGE_CLASSES.INTELLIGENT_TIERING,o.instant("storageclass.intelligent_tiering")),r(j,v.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,o.instant("replication.storageclasses.standardia")),r(j,v.STORAGE_CLASSES.ONEZONE_IA,o.instant("storageclass.zia")),r(j,v.STORAGE_CLASSES.GLACIER,o.instant("storageclass.glacier")),r(j,v.STORAGE_CLASSES.REDUCED_REDUNDANCY,o.instant("replication.storageclasses.reducedredundancy")),r(j,v.STORAGE_CLASSES.DEFAULT,o.instant("replication.storageclass.sameassource")),r(j,v.STORAGE_CLASSES.DEEP_ARCHIVE,o.instant("storageclass.selector.deeparchive.name")),j);e.state={isDeleting:!1,isAdding:!1,isEditing:!1},e.supportLink=C.getMarketingUrl(v.CUSTOMER_SUPPORT),e.REPLICATION=b.REPLICATION,e.isLoadingReplication=!0,e.isEditingPriority=!1,e.regionPostfix=d.isFeatureEnabled(v.FAC.CRR_CHINA_REGION_CUSTOM_TEXT)?".cn":"",e.crrWithObjectLockFACEnabled=d.isFeatureEnabled(v.FAC.CRR_WITH_OBJECT_LOCK),e.selectedRule={flag:!1,ruleObj:{}},e.wholeBucketOrPrefix=[{text:o.instant("crr.globalconfig.source.prefix"),value:b.REPLICATION.PREFIX},{text:o.instant("crr.globalconfig.source.entirebucket"),value:b.REPLICATION.ENTIRE_BUCKET}],e.confirmationModalObj={title:null,saveValue:null,contentText:null,isOpen:{flag:!1}},e.receiveObjectsModalObj={title:o.instant("crr.receiveobjectmodal.title"),isOpen:{flag:!1}},e.replicationModalInfo={isOpen:{flag:!1},isAdd:!1,selectedRule:null,storageTextMapping:K,showChangeDestinationBtn:!1,showChangeRoleBtn:!1,modalError:{}},e.globalConfigInfo={flag:!1,isEditing:!1,prefixOrWholeBucket:{text:null,value:null},storageTextMapping:K,modalError:{},showChangeDestinationBtn:!1,showChangeRoleBtn:!1,ENTIRE_BUCKET:b.REPLICATION.ENTIRE_BUCKET,PREFIX:b.REPLICATION.PREFIX};var V={id:b.REPLICATION.ENABLED,text:o.instant("crr.dropdown.enablerule"),action:function(){e.updateRuleStatus(b.REPLICATION.ENABLED)},disabled:!0},G={id:b.REPLICATION.DISABLED,text:o.instant("crr.dropdown.disablerule"),action:function(){e.updateRuleStatus(b.REPLICATION.DISABLED)},disabled:!0},Y={id:b.REPLICATION.ENABLED_ALL,text:o.instant("crr.dropdown.enableallrules"),action:function(){e.updateRuleStatus(b.REPLICATION.ENABLED_ALL)},disabled:!0},W={id:b.REPLICATION.DISABLED_ALL,text:o.instant("crr.dropdown.disableallrules"),action:function(){e.updateRuleStatus(b.REPLICATION.DISABLED_ALL)},disabled:!1},z={id:b.REPLICATION.DELETE_ALL,text:o.instant("crr.dropdown.deleteallrules"),action:function(){e.updateRuleStatus(b.REPLICATION.DELETE_ALL)},disabled:!1},$={id:b.REPLICATION.UPGRADE_SCHEMA,text:o.instant("crr.dropdown.upgradeschema"),action:function(){e.updateRuleStatus(b.REPLICATION.UPGRADE_SCHEMA)},disabled:!1};e.hasRules=function(){var t=e.replicationObj.ruleSettings.Rule;return t&&t.length>0},e.getSchemaVersion=function(){return m.getSchemaVersion(e.replicationObj)},e.isV1Schema=function(){return 1===e.getSchemaVersion()},e.isV2Schema=function(){return 2===e.getSchemaVersion()},e.isSliceEnabled=function(){return d.isFeatureEnabled(v.FAC.CRR_SLICE)},d.isFeatureEnabled(v.FAC.OBJECT_RETENTION)?(e.isLoadingBucketRetention=!0,function(){var t=g.getCurrentBucket();l.isObjectRetentionEnabled(t,F).catch(function(){return!1}).then(function(t){return e.bucketObjectRetentionEnabled=t,e.isLoadingBucketRetention=!1,t})}()):e.bucketObjectRetentionEnabled=!1,e.canAddRules=function(){return!!(!e.bucketObjectRetentionEnabled||e.crrWithObjectLockFACEnabled&&e.hasRules())&&(e.isSliceEnabled()?!e.isEditingPriority:!e.checkPrefix())},e.moreOptions=[{items:[V,G]},{items:[Y,W]},{items:[z]}],e.pageIndex=0,e.pageLength=100,function(){d.isFeatureEnabled(v.FAC.CRR_V2)&&(e.moreOptions[2].items.push({id:b.REPLICATION.RECEIVE_OBJECTS,text:o.instant("crr.dropdown.receiveobjects"),action:function(){e.toggleReceiveObjectsModal()},disabled:!1}),U=g.getCurrentBucket(),e.replicationObj.globalSettings.sourceBucket.name=U,l.getBucketLocation(U).then(function(t){e.replicationObj.globalSettings.sourceBucket.region=h.twoWayMapping[t]}).catch(function(){e.replicationObj.globalSettings.sourceBucket.region=null}),L(U).then(function(){e.isV1Schema()&&e.isSliceEnabled()&&e.moreOptions[1].items.unshift($)}))}(),e.pageBack=function(){e.pageIndex=Math.max(0,e.pageIndex-1)},e.pageFw=function(){e.pageIndex=Math.min(H(),e.pageIndex+1)},e.pageFirst=function(){e.pageIndex=0},e.pageLast=function(){e.pageIndex=H()},e.isInPage=function(t){return t>=e.getPageStart()&&t<=e.getPageEnd()},e.getPageStart=function(){return e.pageIndex*e.pageLength+1},e.getPageEnd=function(){return Math.min((e.pageIndex+1)*e.pageLength,e.getListLength())},e.getListLength=function(){return e.replicationObj.ruleSettings.Rule.length};var H=function(){var t=e.getListLength();return t<=0||e.pageLength<=0?0:Math.floor((t-1)/e.pageLength)};e.closeConfirmationModal=function(){O(),S.bodyFreezeScroll(!1)},e.cancelConfirmationModal=function(){e.isEditingPriority=!1,e.closeConfirmationModal()},e.toggleReceiveObjectsModal=function(){e.receiveObjectsModalObj.isOpen={flag:!0},e.selectedRule.flag=!1,e.selectedRule.ruleObj={},S.bodyFreezeScroll(!0)},e.updateRuleStatus=function(t){switch(e.currentOperation=t,S.bodyFreezeScroll(!0),e.confirmationModalObj.isOpen.flag=!0,t){case b.REPLICATION.ENABLED:e.selectedRule.ruleObj&&(e.confirmationModalObj.title="crr.confirmationmodal.enablerule",e.confirmationModalObj.saveValue=T(e.selectedRule.ruleObj.ID,t),e.confirmationModalObj.contentText="crr.enablesingleruletext");break;case b.REPLICATION.DISABLED:e.selectedRule.ruleObj&&(e.confirmationModalObj.title="crr.confirmationmodal.disablerule",e.confirmationModalObj.saveValue=T(e.selectedRule.ruleObj.ID,t),e.confirmationModalObj.contentText="crr.disablesingleruletext");break;case b.REPLICATION.ENABLED_ALL:e.confirmationModalObj.title="crr.confirmationmodal.enableallrules",e.confirmationModalObj.saveValue=R(b.REPLICATION.ENABLED),e.confirmationModalObj.contentText="crr.enableallrulestext";break;case b.REPLICATION.DISABLED_ALL:e.confirmationModalObj.title="crr.confirmationmodal.disableallrules",e.confirmationModalObj.saveValue=R(b.REPLICATION.DISABLED),e.confirmationModalObj.contentText="crr.disableallrulestext";break;case b.REPLICATION.DELETE_ALL:e.confirmationModalObj.title="crr.confirmationmodal.deleteallrules",e.confirmationModalObj.contentText="crr.deleteallrulestext";break;case b.REPLICATION.UPGRADE_SCHEMA:e.confirmationModalObj.title="crr.confirmationmodal.upgradeschema",e.confirmationModalObj.contentTitle="crr.upgradeschematitle",e.confirmationModalObj.contentText="crr.msg.detail.newschema",e.confirmationModalObj.translateValues={learnMoreLink:C.getDocUrl(v.LEARN_MORE_LINKS.CRR_IAM_ROLE_SETUP),learnMore:o.instant("learn.more")},e.confirmationModalObj.saveValue=e.getUpgradedSchema();break;default:O()}},e.deleteRule=function(){e.selectedRule.ruleObj&&(e.confirmationModalObj.title="crr.confirmationmodal.deleteruletitle",e.confirmationModalObj.isOpen.flag=!0,e.confirmationModalObj.contentText="crr.confirmationmodal.deleterulecontent")},e.saveConfirmation=function(){var t=new u("putBucketReplication","putBucketReplication"),n=new u("deleteBucketReplication","deleteBucketReplication"),r=new u("upgradeReplicationSchema","upgradeReplicationSchema");if(e.isConfirming=!0,e.operation===b.REPLICATION.UPGRADE_SCHEMA)return I(e.replicationObj.globalSettings.sourceBucket.name,t,e.confirmationModalObj.saveValue,!0).then(function(){E.log("CRR_upgradeSchema",1,r),e.replicationObj.errorMessage="",e.replicationObj.successMessage={title:"crr.msg.title.schemaupgradesuccessful"},!0===e.priorityEditPending&&(e.priorityEditPending=void 0,e.isEditingPriority=!0)}).catch(function(t){e.replicationObj.errorMessage=t,r.errorDetails=t,e.replicationObj.successMessage=null,E.log("CRR_upgradeSchema",0,r)});"crr.confirmationmodal.deleteallrules"===e.confirmationModalObj.title?k(e.replicationObj.globalSettings.sourceBucket.name,n):"crr.confirmationmodal.deleteruletitle"===e.confirmationModalObj.title?function(){var r=w(e.selectedRule.ruleObj);r.rules.length<=0?k(e.replicationObj.globalSettings.sourceBucket.name,n):l.putBucketReplication(e.replicationObj.globalSettings.sourceBucket.name,t,r,void 0,e.isV2Schema()).then(function(){m.updateIAMPolicyForDeletingRule(r,e.replicationObj),E.log("CRR_putBucketReplication",1,t),m.updateReplicationTable(e.replicationObj,r,e.replicationModalInfo.storageTextMapping),e.replicationObj.errorMessage="",e.closeConfirmationModal()}).catch(function(n){E.log("CRR_putBucketReplication",0,t),e.confirmationModalError=S.handleErrors(n)}).finally(function(){e.isConfirming=!1})}():function(){var n=e.confirmationModalObj.saveValue;I(e.replicationObj.globalSettings.sourceBucket.name,t,e.confirmationModalObj.saveValue,e.isV2Schema()).then(function(){M(e.currentOperation,t,1,n)}).catch(function(){M(e.currentOperation,t,0,n)})}()},e.$watch("replicationObj.ruleSettings.Rule",function(t){_(),e.hasRules()?(e.globalConfigInfo.flag=!0,e.globalConfigInfo.prefixOrWholeBucket=e.replicationObj.globalSettings.isEntireBucket?{text:o.instant("crr.globalconfig.source.entirebucket"),value:e.globalConfigInfo.ENTIRE_BUCKET}:{text:o.instant("crr.globalconfig.source.prefix"),value:e.globalConfigInfo.PREFIX}):(e.globalConfigInfo.flag=!1,e.globalConfigInfo.prefixOrWholeBucket={text:null,value:null})}),e.$watch("replicationModalInfo.isEntireBucket",function(t){e.globalConfigInfo.isEntireBucket=t}),e.triggerMoreDropdown=function(){_()},e.selectRule=function(t){e.selectedRule.flag=!0,e.selectedRule.ruleObj=t,_()},e.cannotSavePriority=function(){return t.find(e.replicationObj.ruleSettings.Rule,function(e){return e.priorityError})},e.getUpgradedSchema=function(){var n={destinationBucket:e.replicationObj.globalSettings.destinationBucket.name,role:e.replicationObj.globalSettings.Role.value,rules:t.cloneDeep(e.replicationObj.ruleSettings.Rule)},r=1;return t.forEach(n.rules,function(e){e.Filter={Prefix:e.Prefix},e.Priority=r++}),n},e.validatePriorities=function(){var n=e.replicationObj.ruleSettings.Rule.map(function(e){return e.Priority}),r=n.reduce(function(e,t){return e[t]=(e[t]||0)+1,e},{}),i=!0;return e.replicationObj.ruleSettings.Rule.forEach(function(e){e.Priority?t.inRange(e.Priority,Number.MAX_SAFE_INTEGER)&&/^[0-9]+$/.test(e.Priority)?r[e.Priority]>1?(e.priorityError="crr.tooltips.ruleprioritynotunique",i=!1):e.priorityError=null:(e.priorityError="crr.tooltips.ruleprioritynotinrange",i=!1):(e.priorityError="crr.tooltips.rulepriorityundefined",i=!1)}),i},e.checkPrefix=function(){return t.findIndex(e.replicationObj.ruleSettings.Rule,{isEntireBucket:"true"})>-1},e.showReplicationModal=function(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0],n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=arguments.length<=2||void 0===arguments[2]||arguments[2];n||(e.globalConfigInfo.isEditing=!1,S.bodyFreezeScroll(!0),t||r?(e.replicationModalInfo.isOpen={flag:!0},e.replicationModalInfo.isAdd=!0):(e.replicationModalInfo.isOpen={flag:!0},e.replicationModalInfo.isAdd=!1))};var q=function(e){return o.instant("tagsearch.identifier")+": "+e.Key+" | "+(t.isObject(e.Value)?"":e.Value)},J=function(e){return o.instant("prefixsearch.identifier")+": "+e};e.getFilterString=function(e){if(e&&e.Filter){var n=e.Filter.Tag;if(n)return t.isArray(n)&&(n=n[0]),q(n);var r=e.Filter.Prefix;if(r&&!t.isObject(r))return J(r);if(e.Filter.And){var i=[];return e.Filter.And.Prefix&&!t.isObject(e.Filter.And.Prefix)&&i.push(J(e.Filter.And.Prefix)),e.Filter.And.Tag&&(t.isArray(e.Filter.And.Tag)?i=i.concat(e.Filter.And.Tag.map(function(e){return q(e)})):i.push(q(e.Filter.And.Tag))),i.join(", ")}return o.instant("bucketreplication.entirebucket")}},e.signout=function(){var e=i.absUrl().split("/s3/"),t=void 0;e&&e.length>0&&(t=e[0]+"/s3/logout!doLogout",s.location.href=t)},e.closeSignOutWarning=function(){e.replicationObj.showSignoutWarning=!1},e.savePriority=function(){e.validatePriorities()&&(e.isEditingPriority=!1,e.replicationObj.ruleSettings.Rule.forEach(function(e){e.originalPriority=void 0}),m.sortRulesByPriority(e.replicationObj.ruleSettings.Rule),e.savePressed())},e.adjustPrioritiesClick=function(){e.isV1Schema()?x():e.startEditPriority()},e.startEditPriority=function(){e.isEditingPriority=!0,e.replicationObj.ruleSettings.Rule.forEach(function(e){e.originalPriority=e.Priority,e.priorityError=null})},e.stopEditPriority=function(){e.isEditingPriority=!1,e.replicationObj.ruleSettings.Rule.forEach(function(e){e.Priority=e.originalPriority||e.Priority})},e.showUpgradeConfirmation=function(){return e.upgradeConfirmationOpen={flag:!0},e.upgradeConfirmationObj.deferred=n.defer(),e.upgradeConfirmationObj.deferred.promise},e.upgradeConfirmationOk=function(){e.upgradeConfirmationObj.deferred.resolve()},e.upgradeConfirmationCancel=function(){e.$scope.upgradeConfirmationObj.deferred.reject()},e.upgradeConfirmationObj={showDialog:e.showUpgradeConfirmation,deferred:n.defer()},e.savePressed=function(){var t=new u("CRR_saveReplication");e.isSaving={flag:!0},D(),m.saveReplication(e.isSaving,e.tmpReplicationObj,null,{},e.replicationObj,function(n){m.updateCRRTableAfterPut(e.replicationModalInfo,e.replicationObj,e.tmpReplicationObj,n,t).then(function(){e.replicationObj.errorMessage="",e.replicationObj.successMessage={title:"crr.msg.title.priorityupdatesuccessful"}}).catch(function(t){e.replicationObj.errorMessage=t,e.replicationObj.successMessage=null}).finally(function(){e.bucketSelectorObj.destinationBucket.Errors={},e.modalInfo.isEditing=!1,e.closeReplicationModal()})},function(t){e.replicationObj.errorMessage=t,e.replicationObj.successMessage=null})}}e.module("s3").directive("bucketReplication",[function(){return{restrict:"E",scope:{},template:n(767),controller:"BucketReplicationController"}}]),e.module("s3").controller("BucketReplicationController",["$scope","$q","$location","$filter","$translate","$window","$timeout","BucketPropertiesService","ConsoleOperation","FAC","IAMPropertiesService","KMSPropertiesService","PathService","ReplicationUtilService","Region","ReplicationConstants","S3Constants","SCLogService","UtilService","XMLParser","SharpieAPI","AwsUrlsService",i])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div ng-if="isLoadingReplication || isLoadingBucketRetention" class=replication-loading><span class="awsui-spinner awsui-spinner-large"></span></div> <div ng-if="!isLoadingReplication && !isLoadingBucketRetention" class=replication-page> <awsui-alert type=error visible=replicationObj.errorMessage> {{replicationObj.errorMessage}} </awsui-alert> <awsui-alert type=warning visible="bucketObjectRetentionEnabled && crrWithObjectLockFACEnabled && !hasRules()"> <span dom-region=header>{{ \'crr.objectretention.incompatibility.setup.alert.title\' | translate }}</span> <span dom-region=content translate=crr.objectretention.incompatibility.setup.alert.text translate-values="{ supportLink: supportLink }" translate-compile></span> </awsui-alert> <awsui-alert type=warning visible="bucketObjectRetentionEnabled && !crrWithObjectLockFACEnabled" header="{{ \'crr.objectretention.incompatibility.alert.title\' | translate }}"> {{ \'crr.objectretention.incompatibility.alert.text\' | translate }} </awsui-alert> <awsui-alert type=warning dismissible=true class=crr-warning visible="replicationObj && replicationObj.warningMessage" header="{{\'crr.warningmsg.title.iamcreatepolicyfailed\' | translate}}"> <span translate=crr.warningmsg.detail.iamcreatepolicyfailed translate-values={{replicationObj.warningMessage.params}}></span><br> <span translate=crr.warningmsg.learnmore.iamcreatepolicyfailed translate-values={{replicationObj.warningMessage.params}}></span> </awsui-alert> <awsui-alert type=success ng-if=isSliceEnabled() dismissible=true class=crr-warning visible="replicationObj && replicationObj.successMessage" header="{{(replicationObj.successMessage.title || \'crr.msg.title.updatesuccessful\') | translate}}"> <span translate={{replicationObj.successMessage.detail}} translate-values=""></span> </awsui-alert> <div ng-if=replicationObj.showSignoutWarning class=signout-warning-section> <span icon=times class="awsui-alert-dismiss-control awsui-alert-times-warning awsui-button-as-link awsui-icon signout-close" ng-click=closeSignOutWarning($event)></span> <span class="alert-exclamation-triangle awsui-alert-icon awsui-icon awsui-icon-big"></span> <h3 class=warning-title translate=bucketreplication.signoutmessage></h3> <p class=warning-message translate=bucketreplication.signouttitle></p> <awsui-button class=signout-button text="{{ \'bucketreplication.signout\' | translate }}" click=signout()></awsui-button> </div> <crr-global-settings-wrapper disabled=isEditingPriority ng-if="globalConfigInfo && globalConfigInfo.flag" modal-info=globalConfigInfo replication-obj=replicationObj selected-rule=selectedRule current-bucket-retention=bucketObjectRetentionEnabled></crr-global-settings-wrapper> <div class=action-strip> <div class=inline-alert ng-if=isEditingPriority> <awsui-alert type=info><span translate=crr.infomsg.detail.priority></span></awsui-alert> </div> <awsui-tooltip id=replication-table-disableadd-tooltip ng-if="!isSliceEnabled() && !canAddRules()" text="{{\'crr.prefixtooltip\' | translate}}" position=bottom> <awsui-button id=add-rule class=action-button-spacing data-disabled=!canAddRules() text="{{\'bucketreplication.addnew\' | translate}}" icon=plus ng-click="canAddRules() && showReplicationModal(true, isEditingPriority, false)" variant=primary></awsui-button> </awsui-tooltip> <awsui-button id=add-rule class=action-button-spacing ng-if="isSliceEnabled() || canAddRules()" data-disabled=!canAddRules() text="{{\'bucketreplication.addnew\' | translate}}" icon=plus ng-click="canAddRules() && showReplicationModal(true, isEditingPriority, false)" variant=primary></awsui-button> <awsui-button id=adjust-priority fac-id=s3-crr-slice data-disabled="!hasRules() || isEditingPriority" class=action-button-spacing text="{{\'bucketreplication.adjustpriority\' | translate}}" ng-click=adjustPrioritiesClick()></awsui-button> <awsui-button id=edit-rule class=action-button-spacing text="{{ \'bucketreplication.edit\' | translate }}" data-disabled="!selectedRule.flag || isEditingPriority" ng-click="showReplicationModal(false, false, false)"></awsui-button> <awsui-button id=delete-rule class=action-button-spacing text="{{ \'bucketreplication.delete\' | translate }}" data-disabled="!selectedRule.flag || isEditingPriority" click=deleteRule()></awsui-button> <action-dropdown class=bucket-more-dropdown text="{{ \'bucketlifecycle.label.more\' | translate }}" ng-click="triggerMoreDropdown(); $event.stopPropagation();" items=moreOptions disable-take-action=true></action-dropdown> <awsui-button ng-if=isEditingPriority id=save-priority class="float-right action-button-spacing" text="{{ \'crr.globalsettings.save\' | translate }}" variant=primary data-disabled=cannotSavePriority() ng-click=savePriority()></awsui-button> <awsui-button ng-if=isEditingPriority id=cancel-priority class="float-right action-button-spacing" text="{{ \'crr.globalsettings.cancel\' | translate }}" ng-click=stopEditPriority()></awsui-button> </div> <empty-state ng-if="!(replicationObj.ruleSettings.Rule && replicationObj.ruleSettings.Rule.length > 0)" open-modal=showReplicationModal type="\'replication\'" one-intro-image=oneIntroImage region-postfix=regionPostfix></empty-state> <awsui-radio-group class=permission-radio-group ng-model=selectedRule.ruleObj.ID> <table class="table table-condense crr-rule-table" ng-if="replicationObj.ruleSettings.Rule && replicationObj.ruleSettings.Rule.length > 0"> <thead class=table-header> <tr ng-if=isV2Schema() class=paginator-row class=pages-row-top> <td colspan=100%> <div class=pages class="pages-row pages-row-top" witdh=100%> <awsui-button id=fetchPreviousPageBtn icon=angle-left variant=standalone-icon click=pageBack() data-disabled=isFetchPreviousPageDisabled() ng-if="getPageStart() > 1"></awsui-button> <span id=paginationNumbering>{{\'objects.pagination.viewing\' | translate}} {{ getPageStart() }} {{\'objects.pagination.to\' | translate}} {{ getPageEnd() }} {{ \'objects.pagination.of\' | translate }} {{ getListLength() }}</span> <awsui-button id=fetchNextPageBtn icon=angle-right variant=standalone-icon click=pageFw() data-disabled=isFetchNextPageDisabled() ng-if="getPageEnd() < getListLength()"></awsui-button> </div> </td> </tr> <tr> <th></th> <th ng-if=isV2Schema()> {{\'bucketreplication.rulename\' | translate}} </th> <th> {{\'bucketreplication.scope\' | translate}} <awsui-tooltip text="{{ \'crr.tooltips.crrsource\' | translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th> {{\'bucketreplication.storageclass\' | translate}} <awsui-tooltip text="{{ \'crr.tooltips.rulestorageclass\'| translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th fac-id=s3-crr-v2> {{\'bucketreplication.accesscontroltranslation\' | translate}} <awsui-tooltip text="{{ \'crr.tooltips.accesscontroltranslation\'| translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th fac-id=s3-crr-kms> {{\'bucketreplication.replicatekmsencrypt\' | translate}} <awsui-tooltip text="{{ \'crr.tooltips.replicatekmsencrypt\'| translate }}" position=top size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th> {{\'bucketreplication.status\' | translate}} <awsui-tooltip text="{{ \'crr.tooltips.rulestatus\'| translate }}" position=top size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> <th fac-id=s3-crr-slice> {{\'bucketreplication.priority\' | translate}} <awsui-tooltip ng-if=isV1Schema() text="{{ \'crr.tooltips.rulepriorityv1\'| translate }}" position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-tooltip ng-if=isV2Schema() text="{{ \'crr.tooltips.rulepriority\'| translate }}" position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </th> </tr> </thead> <tbody class=table-body> <tr ng-repeat="rule in replicationObj.ruleSettings.Rule" class=grantee-row ng-click="selectRule(rule); $event.stopPropagation();" ng-class="{\'row-selected\' : selectedRule.flag && selectedRule.ruleObj.ID===rule.ID, \'row-hover\': hoverReplicationRule && !(selectedRule.flag && selectedRule.ruleObj.ID===rule.ID)}" ng-mouseenter="hoverReplicationRule = true" ng-mouseleave="hoverReplicationRule = false" ng-if="isInPage($index + 1)"> <td ng-click="selectRule(rule); $event.stopPropagation();"> <awsui-radio-button value={{rule.ID}}> <td ng-if=isV2Schema() class=crr-table-rolename-column> {{ rule.ID || \'-\' }} </td> <td class=crr-table-scope-column ng-if="isV1Schema() && rule.isEntireBucket === \'true\'"><span translate=bucketreplication.entirebucket></span></td> <td class=crr-table-scope-column ng-if="isV1Schema() && rule.isEntireBucket === \'false\'"><span translate=bucketreplication.prefix translate-values="{ prefix: \'{{rule.Prefix}}\' }"></span></td> <td class=crr-table-scope-column ng-if=isV2Schema()> {{ getFilterString(rule) }} </td> <td class=crr-table-storageclass-column> {{ rule.Destination.StorageClass.text }} </td> <td fac-id=s3-crr-v2 class=crr-table-accesscontroltranslation-column ng-if=rule.Destination.isAccessControlTranslation translate=bucketreplicationtable.accesscontroltranslation></td> <td fac-id=s3-crr-v2 class=crr-table-accesscontroltranslation-column ng-if=!rule.Destination.isAccessControlTranslation translate=bucketreplicationtable.noaccesscontroltranslation></td> <td fac-id=s3-crr-kms class=crr-table-replicatekmsencrypt-column ng-if=rule.Destination.isKmsEncryption translate=bucketreplicationtable.replicatekmsencrypt></td> <td fac-id=s3-crr-kms class=crr-table-replicatekmsencrypt-column ng-if=!rule.Destination.isKmsEncryption translate=bucketreplicationtable.noreplicatekmsencrypt></td> <td class=crr-table-status-column ng-if="rule.Status === REPLICATION.ENABLED " translate=replicationmodal.sourcestep.enabled></td> <td class=crr-table-status-column ng-if="rule.Status === REPLICATION.DISABLED " translate=replicationmodal.sourcestep.disabled></td> <td fac-id=s3-crr-slice ng-if=!isEditingPriority class=crr-table-priority-column> {{ rule.Priority || \'-\' }} </td> <td fac-id=s3-crr-slice ng-if=isEditingPriority class=crr-table-priority-column> <awsui-tooltip text="{{ rule.priorityError | translate }}" position=bottom size=small initialized=true class=error-style> <awsui-textfield id=priority class=input-priority ng-class="{ \'highlight-error\': rule.priorityError }" keep-focus=awsui-tooltip ng-change=validatePriorities() placeholder="{{ \'bucketreplication.placeholder.priority\' | translate }}" ng-model=rule.Priority class=create-bucket-modal-input></awsui-textfield> </awsui-tooltip> </td> </awsui-radio-button> </td></tr> </tbody> </table> </awsui-radio-group> <replication-modal ng-if="replicationModalInfo && replicationModalInfo.isOpen.flag" modal-info=replicationModalInfo replication-obj=replicationObj upgrade-confirmation-obj=upgradeConfirmationObj selected-rule=selectedRule current-bucket-retention=bucketObjectRetentionEnabled></replication-modal> <dialog-modal class=rule-confirmation-modal is-open=confirmationModalObj.isOpen close-callback=closeConfirmationModal header-title="confirmationModalObj.title | translate"> <dialog-modal-content> <awsui-alert type=warning header="{{confirmationModalObj.contentTitle | translate}}"> <span translate={{confirmationModalObj.contentText}} translate-values={{confirmationModalObj.translateValues}}></span> </awsui-alert> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=crr-confirmation-cancel text="{{ \'bucketreplication.cancel\' | translate }}" variant=normal click=cancelConfirmationModal()></awsui-button> <awsui-button id=crr-confirmation-save click=saveConfirmation() variant=primary text="{{ \'bucketreplication.confirm\' | translate }}" loading=isConfirming class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal> <crr-upgrade-confirmation-modal header-title=headerTitle confirm-callback=upgradeConfirmationOk() cancel-callback=upgradeConfirmationCancel() warning-message="\'crr.msg.detail.newschema\' | translate" is-open=upgradeConfirmationOpen></crr-upgrade-confirmation-modal> <crr-receive-object-modal ng-if=receiveObjectsModalObj.isOpen.flag modal-info=receiveObjectsModalObj replication-obj=replicationObj></crr-receive-object-modal> </div> '},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A,C){function _(e){return e.hasRules()?"Highest"===e.tmpReplicationObj.prioritySelection?e.calculateHighestPriority():"Lowest"===e.tmpReplicationObj.prioritySelection?e.calculateLowestPriority():"Current"===e.tmpReplicationObj.prioritySelection?e.tmpReplicationObj.Priority:void 0:1}function w(){if(n.isSliceEnabled()){var e=[],r=[];if(n.isV1Schema())e.push(n.tmpReplicationObj.Prefix);else{var i=n.tmpReplicationObj.Filter;if(!i)return;e.push(i.Prefix),r.push(i.Tag),i.And&&(e.push(i.And.Prefix),r.push(i.And.Tag))}e=t.compact(t.flatten(e)),e=t.reject(e,t.isObject),r=t.compact(t.flatten(r)),r.forEach(function(e){t.isObject(e.Value)&&(e.Value="")}),n.filters.prefixFilters=e,n.filters.tagFilters=r.map(function(e){return{tagKey:e.Key,tagVal:e.Value}}),n.tmpReplicationObj.isEntireBucketSlice=e.length+r.length>0?"false":"true"}}function T(){n.tmpReplicationObj.Destination.Bucket.name=n.bucketSelectorObj.destinationBucket.name,t.isEmpty(t.get(n.bucketSelectorObj,"destinationBucket.accountId"))&&(n.bucketSelectorObj.destinationBucket.accountId=n.accountIdForRogueActor.text),n.tmpReplicationObj.Destination.Account=n.bucketSelectorObj.destinationBucket.accountId,t.isEmpty(t.get(n.selectedKmsKeyObj,"content.value"))||n.bucketSelectorObj.isCrossAccount||(n.tmpReplicationObj.Destination.replicaKmsKeyId=n.selectedKmsKeyObj.content.value),t.isEmpty(n.bucketSelectorObj.destinationBucket.region)?l.getBucketRegion(n.tmpReplicationObj.Destination.Bucket.name).then(function(e){n.tmpReplicationObj.Destination.Bucket.region=e.text}):t.isObject(n.bucketSelectorObj.destinationBucket.region)?n.tmpReplicationObj.Destination.Bucket.region=n.bucketSelectorObj.destinationBucket.region.text:n.tmpReplicationObj.Destination.Bucket.region=n.bucketSelectorObj.destinationBucket.region}function R(e){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1];n.isListingKmsKeys=!0;var i=new d("CRR-getDestinationKmsOperation"),a={};r&&(a.region=r),g.getKMSKeysByArn(i,e,null,a).then(function(e){if(n.KMSServiceError=null,n.kmsKeys=t.isEmpty(e)?[]:[].concat(e),n.selectedKmsKeyObj.content&&-1===t.findIndex(n.kmsKeys,{value:n.selectedKmsKeyObj.content.value})&&(n.selectedKmsKeyObj.content=null),t.get(n.tmpReplicationObj,"Destination.replicaKmsKeyId",null)){var r=t.find(e,{value:n.tmpReplicationObj.Destination.replicaKmsKeyId});t.isEmpty(r)||(n.selectedKmsKeyObj.content=r)}}).catch(function(e){n.KMSServiceError=e}).finally(function(){n.isListingKmsKeys=!1})}function O(){var e=t.get(n.tmpReplicationObj,"Destination.isAccessControlTranslation",!1),r=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1),i=t.get(n.replicationObj,"globalSettings.accessControlTranslationIds",[]).length>0,a=Object.keys(t.get(n.replicationObj,"globalSettings.kmsEncryptionIds",{})).length>0;n.replicationObj.showSignoutWarning=e&&!i||r&&!a?n.bucketSelectorObj.isCrossAccount:!(!r||!a)&&n.bucketSelectorObj.isCrossAccount&&-1===t.values(n.replicationObj.globalSettings.kmsEncryptionIds).indexOf(n.tmpReplicationObj.Destination.replicaKmsKeyId)}function k(e){var t=[],n=[],r=[];e.tagFilters&&e.tagFilters.length>0&&(n=n.concat(e.tagFilters.map(function(e){return{Key:e.tagKey,Value:e.tagVal}}))),e.prefixFilters&&e.prefixFilters.length>0&&(r=r.concat(e.prefixFilters)),n.length>0&&t.push({Tag:n}),r.length>0&&t.push({Prefix:r});var i=n.length+r.length;return 0===i?"":1===i?t[0]:{And:{Tag:n,Prefix:r}}}function I(){n.replicationObj.ruleSettings.Rule.forEach(function(e){e.Priority=parseInt(e.Priority,10)+1})}function P(){n.priorityExistsAndIsNotTheOriginalOne()&&0===n.tmpReplicationObj.Priority&&I(),n.shouldSaveV2()?n.tmpReplicationObj.Filter=k(n.filters):(delete n.tmpReplicationObj.Priority,n.filters.prefixFilters.length>0&&(n.tmpReplicationObj.Prefix=n.filters.prefixFilters[0])),n.shouldUpgrade()&&n.replicationObj.ruleSettings.Rule.forEach(function(e){void 0===e.Priority&&void 0!==e.newPriority&&(e.Priority=e.newPriority),e.Prefix?e.filters={prefixFilters:[e.Prefix]}:e.filters={prefixFilters:[]},e.Filter=k(e.filters)});var e=new d("CRR_saveReplication");n.isSaving={flag:!0},m.saveReplication(n.isSaving,n.tmpReplicationObj,n.bucketSelectorObj,n.modalInfo,n.replicationObj,function(t){O(),m.updateCRRTableAfterPut(n.modalInfo,n.replicationObj,n.tmpReplicationObj,t,e).then(function(){n.replicationObj.errorMessage="",n.replicationObj.successMessage={detail:n.modalInfo.isAdd?a.instant(""):""}}).catch(function(e){n.replicationObj.errorMessage=e,n.replicationObj.successMessage=null}).finally(function(){n.bucketSelectorObj.destinationBucket.Errors={},n.modalInfo.isEditing=!1,n.closeReplicationModal()})},function(e){n.modalInfo.modalError.saveError=e;var t=r(".replication-modal .modal-body");o(function(){t.animate({scrollTop:r(".crr-save-error").offset().top-t.offset().top+t.scrollTop()})},50)},n.crrWithObjectLockEnabled())}function N(e,r,a,o,c){c=c||1,o=o||i.defer(),a=a||[];var l={MaxItems:v.API_MAX_ITEMS.IAM_LIST_ROLES};return r&&(l.Marker=r),s.makeProxyRequest(p.listRoles,{region:S.getDefaultRegion(),params:l},v.PROXY_API_NAMES.IAM.LIST_ROLES,e).then(function(r){var i=r.response.ListRolesResponse.ListRolesResult,s=i.IsTruncated,l=i.Marker,u=i.Roles;E.log("CRR_ListRolesRecursive_step_"+c,1,e),u.forEach(function(e){-1===t.findIndex(n.modalInfo.iamRoles,{value:e.Arn})&&a.push({text:e.RoleName,value:e.Arn})}),s&&c<v.API_MAX_ITEMS.IAM_LIST_ROLES_RECURSIVE_LIMIT?(E.log("CRR_ListRolesRecursive_truncated",1,e),N(e,l,a,o,c+1)):(1===c&&E.log("CRR_ListRolesRecursive_truncated",0,e),o.resolve(a))}).catch(function(e){o.reject(e)}),o.promise}function M(){var e=new d("listRoles");n.modalInfo.modalError.listRoleError=null,E.log("CRR_ListRolesRequestReceived",1,e),N(e).then(function(t){E.log("CRR_ListRoles",1,e),n.modalInfo.iamRoles=n.modalInfo.iamRoles.concat(t)}).catch(function(t){E.log("CRR_ListRoles",0,e),n.modalInfo.iamRoles=[n.modalInfo.iamRoles[0]],n.modalInfo.modalError.listRoleError=S.handleErrors(t)})}function L(){var e=new d("getVersioning");l.getBucketVersioning(n.replicationObj.globalSettings.sourceBucket.name,e).then(function(t){E.log("CRR_getVersioning",1,e),n.modalInfo.modalError.sourceVersioning=null,n.modalState.showSourceVersioningWarning=t!==b.REPLICATION.ENABLED,n.modalState.showNext=t===b.REPLICATION.ENABLED}).catch(function(t){E.log("CRR_getVersioning",0,e),n.modalState.showSourceVersioningWarning=!0,n.modalInfo.modalError.sourceVersioning=t,n.modalState.showNext=!1})}function x(e){return!t.isEmpty(n.replicationObj.globalSettings.destinationBucket.name)&&(!!(e||n.replicationObj.ruleSettings.Rule&&n.replicationObj.ruleSettings.Rule.length>1)||void 0)}function D(e){return!t.isEmpty(n.replicationObj.globalSettings.Role)&&!t.isEmpty(n.replicationObj.globalSettings.Role.text)&&(!!(e||n.replicationObj.ruleSettings.Rule&&n.replicationObj.ruleSettings.Rule.length>1)||void 0)}function j(){t.isEmpty(n.tmpReplicationObj)&&(n.tmpReplicationObj={}),m.initializeTmpReplicationObj(n.replicationObj,n.tmpReplicationObj,n.modalInfo.storageTextMapping)}n.docsUrls={storageClassIntro:c.getDocUrl(v.LEARN_MORE_LINKS.STORAGE_CLASS_INTRO),pricing:c.getMarketingUrl(v.PRICING_LINKS.S3)},n.STEP={SOURCE:{name:"SOURCE",value:a.instant("replicationmodal.label.source")},DESTINATION:{name:"DESTINATION",value:a.instant("replicationmodal.label.destination")},PERMISSIONS:{name:"PERMISSIONS",value:a.instant("replicationmodal.label.permissions")},REVIEW:{name:"REVIEW",value:a.instant("replicationmodal.label.review")}},n.isEnglish="en"===C,n.s3PricingLink=S.getPricingUrl("s3"),n.transitionsLearnMoreLink=c.getDocUrl(v.LEARN_MORE_LINKS.LIFECYCLE_TRANSITIONS),n.REPLICATION=b.REPLICATION,n.showBucketPolicyTemplate=!1,n.showKMSPolicyTemplate=!1,n.modalState={showNext:!0,showSourceVersioningWarning:!1,destinationVersioningWarning:null},n.headerTitle=a.instant("replicationmodal.modaltitle"),n.state=n.STEP.SOURCE,n.modalInfo.prefixList=t.pluck(n.replicationObj.ruleSettings.Rule,"Prefix").filter(function(e){return""!==e}),n.modalInfo.prefixOrWholeBucketOptions=[{text:a.instant("crr.globalconfig.source.prefix"),value:b.REPLICATION.PREFIX},{text:a.instant("crr.globalconfig.source.entirebucket"),value:b.REPLICATION.ENTIRE_BUCKET}],n.bucketSelectorObj={},n.multiSelectorObj={searchPlaceholder:a.instant("crr.multiselector.searchboxplaceholder"),isLoadingData:!1,isDropDownOpen:!1,errorMsg:null,initialized:!1,noSearchResult:{text:a.instant("crr.multiselector.noresultfound"),addInputText:a.instant("crr.multiselector.addcustomarn")},optionList:[],emptyDisplayPlaceholder:a.instant("crr.multiselector.emptydisplayplaceholder"),nonEmptyDisplayPlaceholder:a.instant("crr.multiselector.displayplacehodersuffix"),totalSelectedCount:0},n.modalInfo.regions=[],n.showOverrideDestWarning=!1,n.storageClasses=[],n.storageClasses.push({value:v.STORAGE_CLASSES.STANDARD,text:a.instant("replication.storageclasses.standard")}),y.isFeatureEnabled(v.FAC.ISIDORE)&&n.storageClasses.push({value:v.STORAGE_CLASSES.INTELLIGENT_TIERING,text:a.instant("storageclass.selector.isidore.name")}),n.storageClasses.push({value:v.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:a.instant("replication.storageclasses.standardia")}),n.storageClasses.push({value:v.STORAGE_CLASSES.ONEZONE_IA,text:a.instant("storageclass.zia")}),y.isFeatureEnabled(v.FAC.GLACIER)&&n.storageClasses.push({value:v.STORAGE_CLASSES.GLACIER,text:a.instant("storageclass.selector.glacier.name")}),y.isFeatureEnabled(v.FAC.DEEP_ARCHIVE)&&n.storageClasses.push({value:v.STORAGE_CLASSES.DEEP_ARCHIVE,text:a.instant("storageclass.selector.deeparchive.name")}),y.isFeatureEnabled(v.FAC.S3_RRS)&&n.storageClasses.push({value:v.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:a.instant("replication.storageclasses.reducedredundancy")}),n.copyKmsKeyPolicyFinished={flag:null},n.copyBucketPolicyFinished={flag:null},n.modalInfo.iamRoles=[],n.modalInfo.iamRoles.push({text:a.instant("replication.roles.createnew"),value:b.REPLICATION.NEWROLE,pinnedTop:!0}),S.getFACRegions(h.regionMapping,n.modalInfo.regions),n.modalInfo.regions=t.filter(n.modalInfo.regions,function(e){return e.text!==n.replicationObj.globalSettings.sourceBucket.region}),n.isEnablingDestinationVersioning={flag:!1},n.accountIdForRogueActor={text:null},n.selectedKmsKeyObj={content:null},n.kmsCustomInput={isEnabled:!0,text:a.instant("crr.multiselector.addcustomarn"),customPlaceHolderText:"crr.multiselector.searchboxplaceholder"},n.docLink=c.getDocUrl(v.LEARN_MORE_LINKS.CRR_KMS),n.markers=[],n.tag={error:""},n.tagSearchSelected=!1,n.showTag=!1,n.tagContinuationTokens=[],n.filters={tagFilters:[],input:"",prefixFilters:[]},n.crrWithObjectLockEnabled=function(){return!(!y.isFeatureEnabled(v.FAC.CRR_WITH_OBJECT_LOCK)||!n.currentBucketRetention)},n.sourceStepDisableNextNutton=function(){return n.isSliceEnabled()?n.tmpReplicationObj.Destination&&n.tmpReplicationObj.Destination.isKmsEncryption&&!n.multiSelectorObj.totalSelectedCount:"false"===n.tmpReplicationObj.isEntireBucket&&(!n.tmpReplicationObj.Prefix||n.modalInfo.modalError.inputPrefixError)||n.tmpReplicationObj.Destination&&n.tmpReplicationObj.Destination.isKmsEncryption&&!n.multiSelectorObj.totalSelectedCount},n.destinationStepDisableNextButton=function(){return n.bucketSelectorObj.destinationBucket.Errors.bucketNotExistError||n.bucketSelectorObj.destinationBucket.Errors.generalErrors||n.bucketSelectorObj.destinationBucket.Errors.disabledRegion||n.bucketSelectorObj.destinationBucket.createNewDestBucket&&n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length>0||!n.bucketSelectorObj.destinationBucket.name||n.bucketSelectorObj.destinationBucket.createNewDestBucket&&!n.bucketSelectorObj.destinationBucket.region||!n.tmpReplicationObj.Destination.StorageClass.value&&n.tmpReplicationObj.Destination.changeDefaultStorageClass||!1===n.bucketSelectorObj.destinationBucket.versioningEnabled&&!n.bucketSelectorObj.destinationBucket.Errors.getVersioningError&&!n.bucketSelectorObj.destinationBucket.Errors.enabledVersioningError||n.tmpReplicationObj.Destination.isKmsEncryption&&(!n.bucketSelectorObj.isCrossAccount&&!n.selectedKmsKeyObj.content||n.bucketSelectorObj.isCrossAccount&&!n.tmpReplicationObj.Destination.replicaKmsKeyId)||n.tmpReplicationObj.Destination.isAccessControlTranslation&&(!n.bucketSelectorObj.destinationBucket.accountId&&!n.accountIdForRogueActor.text||n.accountIdError)||n.crrWithObjectLockEnabled()&&n.bucketSelectorObj.destinationBucket.Errors.getBucketObjectLockEnabledError||n.crrWithObjectLockEnabled()&&!1===n.bucketSelectorObj.destinationBucket.bucketObjectLockEnabled},n.optionsStepDisableNextButton=function(){return!(!n.isSliceEnabled()||!n.shouldSaveV2()||n.tmpReplicationObj.ID)||!n.tmpReplicationObj.Role},n.calculateHighestPriority=function(){var e=function(e,t){return Math.max(e,t.Priority||t.newPriority||1)},t=n.replicationObj.ruleSettings.Rule.reduce(e,0)+1;return Math.min(t,Number.MAX_SAFE_INTEGER)},n.calculateLowestPriority=function(){var e=function(e,t){return Math.min(e,t.Priority||t.newPriority||1)},t=n.replicationObj.ruleSettings.Rule.reduce(e,Number.MAX_SAFE_INTEGER)-1;return Math.max(t,0)},n.priorityExists=function(e){return t.find(n.replicationObj.ruleSettings.Rule,function(t){return parseInt(t.Priority,10)===e})},n.priorityExistsAndIsNotTheOriginalOne=function(){if(n.isV1Schema())return!1;var e=n.tmpReplicationObj.Priority;return e!==n.tmpReplicationObj.originalPriority&&n.priorityExists(e)},n.setPriority=function(){n.tmpReplicationObj.Priority=_(n)},n.getFilterString=function(){return n.hasPrefixOrTag()?n.filters.prefixFilters.map(function(e){return a.instant("prefixsearch.identifier")+": "+e}).join(", ")+" "+n.filters.tagFilters.map(function(e){return a.instant("tagsearch.identifier")+": "+e.tagKey+" | "+e.tagVal}).join(", "):a.instant("bucketreplication.entirebucket")},n.hasRules=function(){var e=n.replicationObj.ruleSettings.Rule;return e&&e.length>0},n.hasPrefixOrTag=function(){return n.filters||(n.filters={tagFilters:[],input:"",prefixFilters:[]}),n.filters.prefixFilters.length+n.filters.tagFilters.length>0},n.getSchemaVersion=function(){return m.getSchemaVersion(n.replicationObj)},n.isV1Schema=function(){return 1===n.getSchemaVersion()},n.isV2Schema=function(){return 2===n.getSchemaVersion()},n.isSliceEnabled=function(){return y.isFeatureEnabled(v.FAC.CRR_SLICE)},function(){m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.showChangeDestinationBtn=x(n.modalInfo.isAdd),n.modalInfo.showChangeRoleBtn=D(n.modalInfo.isAdd),n.showOverrideDestWarning=n.modalInfo.showChangeDestinationBtn,n.showChangeRoleWarning=n.modalInfo.showChangeRoleBtn,n.modalInfo.isOpen&&n.modalInfo.isOpen.flag&&(n.modalInfo.isAdd?(n.tmpReplicationObj={Destination:{Bucket:{name:null,region:null},StorageClass:{value:null,text:n.modalInfo.storageTextMapping[v.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:!1,isAccessControlTranslation:!1,isKmsEncryption:!1,Account:null,replicaKmsKeyId:null},prioritySelection:"Highest",originalPriority:1,ID:null,Prefix:null,Status:b.REPLICATION.ENABLED,isEntireBucket:(!n.replicationObj.ruleSettings.Rule||n.replicationObj.ruleSettings.Rule.length<1).toString(),isEntireBucketSlice:"true",Role:null,name:null,sourceKMSKeys:[]},n.selectedRule.flag=!1,n.selectedRule.ruleObj={},n.modalInfo.isEntireBucket||o(function(){e.element(".replication-modal-input input").focus()})):(n.tmpReplicationObj=t.cloneDeep(n.selectedRule.ruleObj),n.tmpReplicationObj.originalPriority=n.tmpReplicationObj.Priority,n.tmpReplicationObj.prioritySelection="Current",n.tmpReplicationObj.isEntireBucketSlice="true",n.tmpReplicationObj.originalID=n.tmpReplicationObj.ID,w()),n.tmpReplicationObj.sourceKMSKeys=[],n.replicationObj.globalSettings.selectedSourceKmsKeys.length>0&&t.forEach(n.replicationObj.globalSettings.selectedSourceKmsKeys,function(e){n.tmpReplicationObj.sourceKMSKeys.push(e)}),n.tmpReplicationObj.Destination.Bucket=t.clone(n.replicationObj.globalSettings.destinationBucket),n.bucketSelectorObj.destinationBucket.name=t.get(n.tmpReplicationObj,"Destination.Bucket.name",""),n.tmpReplicationObj.Role=t.clone(n.replicationObj.globalSettings.Role),L(),n.tmpReplicationObj.Destination.isKmsEncryption&&(Object.keys(n.replicationObj.globalSettings.kmsEncryptionIds).length>0?m.getSourceSelectedKMSKeys(!0,n.multiSelectorObj,n.replicationObj,n.tmpReplicationObj).then(function(){}).finally(function(){m.initMultiSelector(n.replicationObj,n.multiSelectorObj),n.multiSelectorObj.isLoadingData=!1}):n.multiSelectorObj.selectAllByDefault=!0)),y.isFeatureEnabled(v.FAC.ONEZONE_IA)||(n.storageClasses=t.reject(n.storageClasses,function(e){return e.value===v.STORAGE_CLASSES.ONEZONE_IA})),n.modalInfo.flag&&j(),M(),n.setPriority()}(),n.validateBucketName=function(){S.validateBucketName(n.bucketSelectorObj.destinationBucket.name,n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors,n.bucketSelectorObj.bucketListCurrAccount)},n.hideChangeDestinationBtn=function(){n.modalInfo.showChangeDestinationBtn=!1},n.hideChangeRoleBtn=function(){n.modalInfo.showChangeRoleBtn=!1},n.getListKMS=function(){var e=new d("getListKMSForCRRModal"),t=A.getCurrentBucket();return g.getKMSKeysByArn(e,t)},n.fetchSourceSelectedKMSKeys=function(e){Object.keys(n.replicationObj.globalSettings.kmsEncryptionIds).length>0?m.getSourceSelectedKMSKeys(e,n.multiSelectorObj,n.replicationObj,n.tmpReplicationObj).then(function(){}).finally(function(){m.initMultiSelector(n.replicationObj,n.multiSelectorObj)}):n.multiSelectorObj.selectAllByDefault=!0,t.isEmpty(t.get(n.bucketSelectorObj,"destinationBucket.name"))||R(n.bucketSelectorObj.destinationBucket.name)},n.upgradeMessageParams={learnMoreLink:c.getDocUrl(v.LEARN_MORE_LINKS.CRR_IAM_ROLE_SETUP),learnMore:a.instant("learn.more")};var B=function(){return n.filters.tagFilters.length>0},F=function(){var e=n.filters.prefixFilters,t=n.modalInfo.prefixList.filter(function(e){return e!==n.selectedRule.ruleObj.Prefix});return 1===e.length&&(t.indexOf(e[0])>-1||t.filter(function(t){return e[0].indexOf(t)>-1}).length>0||t.filter(function(t){return t.indexOf(e[0])>-1}).length>0)&&e[0]!==n.selectedRule.ruleObj.Prefix},U=function(){return t.find(n.replicationObj.ruleSettings.Rule,function(e){return"true"===e.isEntireBucket})&&n.modalInfo.isAdd},K=function(){return"true"===n.tmpReplicationObj.isEntireBucketSlice&&(n.replicationObj.ruleSettings.Rule.length>0&&n.modalInfo.isAdd||n.replicationObj.ruleSettings.Rule.length>1&&"true"===n.tmpReplicationObj.isEntireBucketSlice)};n.shouldSaveV2=function(){var e=n.isV2Schema(),t=n.shouldUpgrade();return e||t};var V=function(){if(void 0!==n.replicationObj.ruleSettings.Rule){var e=1;n.replicationObj.ruleSettings.Rule.forEach(function(t){t.newPriority=e++})}},G=function(){return!(!n.isSliceEnabled()||n.isV2Schema()||!B()&&!F()&&!U()&&!K())};n.shouldUpgrade=function(){var e=G();return e&&V(),e},n.nextCRRStep=function(){n.copyFinished={flag:null},n.state===n.STEP.SOURCE?("true"===n.tmpReplicationObj.isEntireBucket&&(n.tmpReplicationObj.Prefix=null),n.tmpReplicationObj.Destination.isKmsEncryption&&(n.tmpReplicationObj.sourceKMSKeys=[],t.forEach(n.multiSelectorObj.optionList,function(e){e.selected&&n.tmpReplicationObj.sourceKMSKeys.push(e.value)})),n.nextState()):n.state===n.STEP.DESTINATION?(t.isEmpty(t.get(n.tmpReplicationObj,"Destination.replicaKmsKeyId"))||(n.tmpReplicationObj.Destination.replicaKmsKeyId=n.tmpReplicationObj.Destination.replicaKmsKeyId.trim()),T(),n.bucketSelectorObj.destinationBucket.createNewDestBucket?(s.headBucket(new d("checkBucketAvailability"),n.tmpReplicationObj.Destination.Bucket.name).then(function(){n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.exists.error")]}).catch(function(e){e.status===v.HTTP_STATUS_CODES.NOT_FOUND?n.nextState():n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.exists.error")]}),n.showBucketPolicyTemplate=!1,n.showKMSPolicyTemplate=!1):(n.showBucketPolicyTemplate=n.bucketSelectorObj.isCrossAccount,n.showKMSPolicyTemplate=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&n.bucketSelectorObj.isCrossAccount,n.nextState())):n.state===n.STEP.PERMISSIONS?(n.modalInfo.modalError.saveError=null,n.copyKmsKeyPolicyFinished={flag:null},n.copyBucketPolicyFinished={flag:null},n.nextState()):n.nextState()},n.checkInputPrefix=function(e){e!==n.selectedRule.ruleObj.Prefix&&(n.modalInfo.prefixList.indexOf(e)>-1?n.modalInfo.modalError.inputPrefixError=a.instant("replicationmodal.existprefixwarning"):n.modalInfo.modalError.inputPrefixError=null)},n.resetInputPrefixError=function(){n.modalInfo.modalError.inputPrefixError=null},n.closeReplicationModal=function(){n.selectedRule.flag=!1,n.selectedRule.ruleObj={},n.modalInfo.isOpen={flag:!1},n.modalInfo.isEntireBucket=n.replicationObj.globalSettings.isEntireBucket,n.modalInfo.modalError.saveError=null,n.modalInfo.modalError.inputPrefixError=null,n.modalInfo.modalError.sourceVersioning=null,n.modalInfo.modalError.listRoleError=null,S.bodyFreezeScroll(!1),n.modalInfo.prefixOrWholeBucket=n.replicationObj.globalSettings.isEntireBucket?t.find(n.modalInfo.prefixOrWholeBucketOptions,{value:b.REPLICATION.ENTIRE_BUCKET}):t.find(n.modalInfo.prefixOrWholeBucketOptions,{value:b.REPLICATION.PREFIX}),n.modalInfo.isOverride&&(j(),m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.isEditing=!1,n.modalInfo.isOverride=!1,n.modalInfo.isAdd=!1),n.state=n.STEP.SOURCE},n.enableSourceVersioning=function(){n.modalInfo.modalError.sourceVersioning=null,n.isEnablingSourceVersioning=!0;var e=new d("enableBucketVersioning");l.enableBucketVersioning(n.replicationObj.globalSettings.sourceBucket.name,e).then(function(){E.log("CRR_enableBucketVersioning",1,e),n.modalState.showSourceVersioningWarning=!1,n.modalState.showNext=!0}).catch(function(t){E.log("CRR_enableBucketVersioning",0,e),n.modalState.showSourceVersioningWarning=!0,n.modalInfo.modalError.sourceVersioning=t}).finally(function(){n.isEnablingSourceVersioning=!1})},n.enableDestinationVersioning=function(){m.enableDestinationVersioning(n.isEnablingDestinationVersioning,n.bucketSelectorObj,n.modalState)},n.$watch("bucketSelectorObj.destinationBucket.name",function(e,r){n.modalInfo.isEditing&&e!==r?(n.bucketSelectorObj.destinationBucket.Errors={},n.modalInfo.modalError.saveError=null,n.showBucketPolicyTemplate=n.bucketSelectorObj.isCrossAccount,n.showKMSPolicyTemplate=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&n.bucketSelectorObj.isCrossAccount):y.isFeatureEnabled(v.FAC.CRR_KMS)&&!n.modalInfo.isEditing&&e&&!n.bucketSelectorObj.isCrossAccount&&t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&!t.get(n.bucketSelectorObj,"destinationBucket.createNewDestBucket",!1)&&R(e)}),n.$watch("bucketSelectorObj.destinationBucket.region",function(e){y.isFeatureEnabled(v.FAC.CRR_KMS)&&t.get(n.bucketSelectorObj,"destinationBucket.createNewDestBucket")&&!t.isEmpty(e)&&R(null,e.value)}),n.$watch("selectedRule.flag",function(e){!0===e&&(m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.modalError.saveError=null)}),n.$watch("bucketSelectorObj.isCrossAccount",function(e,t){e===t||e||(n.tmpReplicationObj.Destination.isAccessControlTranslation=!1)}),n.$watch("bucketSelectorObj.destinationBucket.accountId",function(e){n.showAccountIdTextField=t.isEmpty(e)}),n.resetAccountIdError=function(){n.accountIdError=null},n.checkAccountId=function(e){e.text=e.text.trim(),t.isEmpty(e.text)||null===e.text.match(/^[0-9]+$/)?n.accountIdError=a.instant("bucketselector.invalidaccountid"):n.accountIdError=null},n.resetStorageClassValue=function(){n.tmpReplicationObj.Destination.StorageClass={value:null,text:n.modalInfo.storageTextMapping[v.STORAGE_CLASSES.DEFAULT]}},n.updateStorageClassText=function(e){n.modalInfo.storageTextMapping&&e&&(n.tmpReplicationObj.Destination.StorageClass.text=n.modalInfo.storageTextMapping[e])},n.copyPolicyToClipboard=function(e,t){S.copyDataToClipboard(e,t)},n.scrollIntoView=function(e){S.scrollCardToView(e)},n.savePressed=function(){n.shouldUpgrade()?n.upgradeConfirmationObj.showDialog().then(P):P()},n.policyEditorLoaded=function(e){var t=S.getBucketARN(n.tmpReplicationObj.Destination.Bucket.name),r=""+S.getIamARNPrefix()+S.getUserAccountId()+":root";n.tmpReplicationObj.Destination.isAccessControlTranslation||"false"===n.tmpReplicationObj.isEntireBucket&&(n.replicationObj.globalSettings.accessControlTranslationIds.length>1||1===n.replicationObj.globalSettings.accessControlTranslationIds.length&&-1===n.replicationObj.globalSettings.accessControlTranslationIds.indexOf(n.tmpReplicationObj.ID))?n.crrBucketPolicy=u.generateBucketPolicyWithArn(t,r,b.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):n.crrBucketPolicy=u.generateBucketPolicyWithArn(t,r,b.CRR_BUCKET_POLICY_TEMPLATE),e.getSession().getDocument().setValue(n.crrBucketPolicy)},n.kmsKeyPolicyEditorLoaded=function(e){n.crrKmsKeyPolicy=JSON.stringify(b.KMS_KEY_POLICY,null,"    ").replace(/SOURCE_ACCOUNT_ID/g,S.getUserAccountId()),e.getSession().getDocument().setValue(n.crrKmsKeyPolicy)},n.clearFilters=function(){n.filters.tagFilters=[],n.filters.prefixFilters=[]}}e.module("s3").directive("replicationModal",[function(){return{restrict:"E",scope:{modalInfo:"=",replicationObj:"=",selectedRule:"=",disabled:"=",upgradeConfirmationObj:"=",currentBucketRetention:"="},template:n(769),controller:"ReplicationModalController"}}]),e.module("s3").controller("ReplicationModalController",["$scope","$q","$translate","$timeout","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPolicyService","ConsoleOperation","IAMService","IAMPropertiesService","KMSPropertiesService","ReplicationUtilService","Region","ReplicationConstants","S3Constants","SCLogService","UtilService","FAC","PathService","CurrentLocale",i])}()}).call(t,n(0),n(2),n(6))},function(e,t){e.exports='<modal class=replication-modal is-open=modalInfo.isOpen steps=STEP state=state close-callback=closeReplicationModal header-title=headerTitle next-state=nextState previous-state=previousState set-state=setState> <modal-content> <div class=replication-modal-content> <div class=body-content ng-if="state === STEP.SOURCE"> <div ng-if=!modalState.showSourceVersioningWarning> <p class=subheader translate=replicationmodal.label.source></p> <div class=modal-content-divider></div> <div class=upper-section ng-if=!isSliceEnabled()> <awsui-radio-group ng-model=tmpReplicationObj.isEntireBucket> <awsui-tooltip class=replication-modal-disabledradio-tooltip ng-if="replicationObj.ruleSettings.Rule && (!replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.PREFIX)" text="{{\'crr.prefixtooltip\' | translate}}" position=bottom> <awsui-radio-button value=true disabled=true id=crr-modal-disabled-entirebucket-button> <span translate=replicationmodal.sourcestep.entirebucketradiobutton.disabled translate-values="{ sourceBucket: replicationObj.globalSettings.sourceBucket.name }"></span> </awsui-radio-button> </awsui-tooltip> <awsui-radio-button id=entirebucket-radiobtn ng-if="!replicationObj.ruleSettings.Rule || !(!replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.PREFIX)" value=true disabled=false> <span translate=replicationmodal.sourcestep.entirebucketradiobutton.enabled translate-values="{ sourceBucket: replicationObj.globalSettings.sourceBucket.name }"></span> </awsui-radio-button> <awsui-tooltip class=replication-modal-disabledradio-tooltip id=crr-modal-disabled-prefix-tooltip ng-if="replicationObj.ruleSettings.Rule && (replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.ENTIRE_BUCKET)" text="{{\'crr.prefixtooltip\' | translate}}" position=bottom> <awsui-radio-button value=false disabled=true> <span class=text-disabled translate=replicationmodal.sourcestep.prefixinbucket></span> </awsui-radio-button> </awsui-tooltip> <awsui-radio-button id=prefix-radiobtn ng-if="!replicationObj.ruleSettings.Rule || !(replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.ENTIRE_BUCKET)" value=false disabled=false><span translate=replicationmodal.sourcestep.prefixinbucket></span></awsui-radio-button> <awsui-control-group validation-message="{{ modalInfo.modalError.inputPrefixError }}" class=prefix-input> <awsui-textfield ng-if="tmpReplicationObj.isEntireBucket === \'false\'" class=replication-modal-input ng-keydown=resetInputPrefixError() ng-keyup=checkInputPrefix(tmpReplicationObj.Prefix) placeholder="{{\'replicationmodal.placeholder.prefix\' | translate}}" ng-model=tmpReplicationObj.Prefix></awsui-textfield> </awsui-control-group> </awsui-radio-group> </div> <div class=upper-section ng-if=isSliceEnabled()> <awsui-radio-group ng-model=tmpReplicationObj.isEntireBucketSlice> <awsui-radio-button id=entirebucket-radiobtn value=true disabled=false ng-click=clearFilters()> <span translate=replicationmodal.sourcestep.entirebucketradiobutton.enabled translate-values="{ sourceBucket: replicationObj.globalSettings.sourceBucket.name }"></span> </awsui-radio-button> <awsui-radio-button id=prefix-radiobtn value=false> <span translate=replicationmodal.sourcestep.prefixortag></span> <awsui-tooltip class=crr-modal-accesscontroltranslation-tooltip text="{{ \'lifecyclemodal.prefixtag.tooltip\' | translate }}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </awsui-radio-button> </awsui-radio-group> <div class=tag-search> <search ng-if="tmpReplicationObj.isEntireBucketSlice === \'false\'" fac-id=s3-ot filters=filters markers=markers tag-continuation-tokens=tagContinuationTokens no-backend-calls=true enforce-selection=updateNextButtonDisabled() search-error=tag.error tag-search-selected=tagSearchSelected show-tag=showTag> </search> </div> </div> <awsui-alert ng-if=shouldUpgrade() class=modal-warning-message data-e2e-id=replicationmodal-warningmsg-upgradeschema visible=true header="{{\'crr.warningmsg.title.crrschemawouldbeupdated\' | translate}}" type=warning> <span translate=crr.msg.detail.newschema translate-values={{upgradeMessageParams}}></span> </awsui-alert> <div fac-id=s3-crr-kms> <p class="subheader soruce-criteria-title" translate=replicationmodal.sourcestep.replicationcriteria></p> <div class=modal-content-divider></div> <awsui-checkbox id=crr-modal-kmskey ng-model=tmpReplicationObj.Destination.isKmsEncryption checked=tmpReplicationObj.Destination.isKmsEncryption ng-change=fetchSourceSelectedKMSKeys(tmpReplicationObj.Destination.isKmsEncryption)> <span translate=replicationmodal.sourcestep.kmskeytext></span> </awsui-checkbox> <awsui-tooltip class=crr-modal-accesscontroltranslation-tooltip text="{{ \'crr.tooltips.replicatekmsencrypt\'| translate }}" position=right size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <p ng-if=tmpReplicationObj.Destination.isKmsEncryption class=choose-sourcekmskey translate=crr.choosesourcekmskeytext></p> <awsui-control-group class=source-kmskey ng-if=tmpReplicationObj.Destination.isKmsEncryption validation-message="{{ tmpReplicationObj.getSourceKMSKeyError.text || tmpReplicationObj.getSourceKMSKeyError }}"> <multi-selector multi-selector-obj=multiSelectorObj api-call=getListKMS></multi-selector> </awsui-control-group> <awsui-alert type=warning class=replicationmoal-kmswarning ng-if=tmpReplicationObj.Destination.isKmsEncryption>{{\'replicationmodal.sourcestep.kmskeywarningmessage\' | translate}} </awsui-alert> </div> </div> <div ng-if=modalState.showSourceVersioningWarning> <awsui-alert header="{{ \'crr.warningmsg.content.notenabled\' | translate}}" type=warning visible="modalInfo.modalError.sourceVersioning === null"> <span translate="crr.warningmsg.detail.notenabled "></span> </awsui-alert> <awsui-button id=crr-modal-enablesourceversioning-button variant=primary text="{{ \'replicationmodal.destinationstep.enableversioningbutton\' | translate }}" class=primary-button click=enableSourceVersioning() loading=isEnablingSourceVersioning></awsui-button> <awsui-alert header="{{\'error.header\' | translate}}" type=error visible="modalInfo.modalError.sourceVersioning !== null">{{modalInfo.modalError.sourceVersioning}}</awsui-alert> </div> <awsui-alert ng-if="!hasRules() && isSliceEnabled()" class=modal-warning-message data-e2e-id=replicationmodal-infomsg-newschema visible=true header="{{\'crr.infomsg.title.createrulewithnewschema\' | translate}}" type=info> <span translate=crr.msg.detail.newschema translate-values={{upgradeMessageParams}}></span> </awsui-alert> </div> <div class=body-content ng-if="state === STEP.DESTINATION"> <div ng-if=isEnglish class=replication-destination-header> <h1 class=configure-label translate=replicationmodal.destinationstep.storageclasstransition></h1> <span translate=replicationmodal.destinationstep.transiton.desc></span> <span translate=replicationmodal.destinationstep.transiton.desc_2 translate-compile translate-values="{ learnMoreLink: transitionsLearnMoreLink, pricingLink: s3PricingLink }"></span> </div> <div class=upper-section> <p class=subheader translate=replicationmodal.destinationstep.bucket></p> <awsui-button ng-show=modalInfo.showChangeDestinationBtn variant=link class="dark change-bucket-button" ng-click=hideChangeDestinationBtn() text="{{ \'replicationmodal.destinationstep.changebutton\' | translate}}"></awsui-button> <div class=modal-content-divider></div> <div class=upper-section ng-show=modalInfo.showChangeDestinationBtn> <div class=truncate><span class=text-color-light>{{ tmpReplicationObj.Destination.Bucket.name}}</span></div> </div> <div ng-show=!modalInfo.showChangeDestinationBtn> <bucket-selector class=replication-modal-bucketselector id=crr-modal-dstbucket-selector show-bucket-name-only=true choose-accounts=true editable=true bucket-replication=bucketSelectorObj is-open=bucketSelectorObj.isOpen> </bucket-selector> <awsui-alert type=warning visible=showOverrideDestWarning><span translate=replicationmodal.destinationstep.overridemsg></span></awsui-alert> <awsui-alert header="{{ \'crr.warningmsg.content.notenabled\' | translate }}" type=warning visible="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.versioningEnabled === false"><span translate=crr.warningmsg.detail.notenabled></span></awsui-alert> <awsui-alert header="{{ \'crr.warningmsg.content.cannotdetectversioning\' | translate }}" type=warning visible="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.Errors.getVersioningError"><span translate=crr.warningmsg.detail.cannotdetectversioning></span></awsui-alert> <awsui-alert header="{{ \'crr.warningmsg.content.cannotdetectobjectlockenabled\' | translate }}" type=warning visible="crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.Errors.getBucketObjectLockEnabledError"><span translate=crr.warningmsg.detail.cannotdetectobjectlockenabled></span></awsui-alert> <awsui-alert header="{{ \'crr.warningmsg.content.objectlocknotenabled\' | translate }}" type=warning visible="crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.bucketObjectLockEnabled === false"><span translate=crr.warningmsg.detail.objectlocknotenabled></span></awsui-alert> <awsui-button ng-if="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.versioningEnabled === false" id=crr-modal-enable-dstbucketversioning-button variant=primary text="{{\'replicationmodal.destinationstep.enableversioningbutton\' | translate}}" class=primary-button click=enableDestinationVersioning() loading=isEnablingDestinationVersioning.flag></awsui-button> <awsui-alert header="{{\'crr.warningmsg.content.cannotenableversioning\' | translate}}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.enabledVersioningError><span translate=crr.warningmsg.detail.cannotenableversioning></span></awsui-alert> <awsui-alert header="{{ \'crr.warningmsg.content.bucketnotexsit\' | translate}}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.bucketNotExistError><span translate=crr.warningmsg.content.bucketnotexist></span></awsui-alert> <awsui-alert header="{{ bucketSelectorObj.destinationBucket.Errors.generalErrors.header }}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.generalErrors>{{bucketSelectorObj.destinationBucket.Errors.generalErrors.content}}</awsui-alert> <awsui-alert type=warning visible=bucketSelectorObj.destinationBucket.Errors.disabledRegion><span translate=bucket.in_invalid_region translate-values={{bucketSelectorObj.destinationBucket.Errors.disabledRegion}}></span></awsui-alert> </div> <div class=createbucketbodycontent ng-if=bucketSelectorObj.destinationBucket.createNewDestBucket> <p class=label translate=createbucketmodal.label.name></p> <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle info-circle"></i> </awsui-tooltip> <div class=bucketname-and-region><awsui-control-group> <span dom-region=validationMessage ng-if="bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length > 0"> <label ng-repeat="message in bucketSelectorObj.destinationBucket.bucketNameValidationErrors">{{message}}</label><br> </span> <span dom-region=control> <awsui-textfield id=bucket-name class=create-bucket-modal-input ng-keyup=validateBucketName() placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model=bucketSelectorObj.destinationBucket.name></awsui-textfield> </span></awsui-control-group> </div> <p class=label translate=createbucketmodal.label.region></p> <dropdown items=modalInfo.regions class=crr-modal-region-dropdown selected-item=bucketSelectorObj.destinationBucket.region placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter=true></dropdown> </div> </div> <div fac-id=s3-crr-kms class=lower-section ng-if=tmpReplicationObj.Destination.isKmsEncryption> <p class=subheader translate=replicationmodal.destinationstep.kmskeytitle></p> <div class=modal-content-divider></div> <p class=choose-destinationkmskey translate=replicationmodal.destinationstep.kmskeytext></p> <awsui-textfield ng-if="!bucketSelectorObj.destinationBucket.createNewDestBucket && !bucketSelectorObj.destinationBucket.name || bucketSelectorObj.destinationBucket.createNewDestBucket && (KMSServiceError || !kmsKeys || kmsKeys.length === 0) || bucketSelectorObj.isCrossAccount || KMSServiceError || kmsKeys.length === 0" class=crr-modal-destinationkmskey-input ng-model=tmpReplicationObj.Destination.replicaKmsKeyId placeholder="{{ \'replicationmodal.typecustomarnplaceholderforcrossaccount\' | translate }}"></awsui-textfield> <awsui-control-group ng-if="!bucketSelectorObj.isCrossAccount && (!bucketSelectorObj.destinationBucket.createNewDestBucket && bucketSelectorObj.destinationBucket.name || bucketSelectorObj.destinationBucket.createNewDestBucket) && !KMSServiceError && kmsKeys.length > 0" validation-message="{{ KMSServiceError }}"> <dropdown class=destination-kmskey-dropdown items=kmsKeys placeholder="{{ \'replicationmodal.selectarnplaceholder\' | translate }}" disabled=KMSServiceError selected-item=selectedKmsKeyObj.content custom-input=kmsCustomInput filter=true> </dropdown> </awsui-control-group> </div> <div class=lower-section> <p class=subheader translate=replicationmodal.destinationstep.options></p> <div class=modal-content-divider></div> <awsui-checkbox id=crr-modal-changestorageclass ng-model=tmpReplicationObj.Destination.changeDefaultStorageClass checked=tmpReplicationObj.Destination.changeDefaultStorageClass ng-change=resetStorageClassValue()> <span translate=replicationmodal.destinationstep.storageclasstext></span> </awsui-checkbox> <div ng-if=tmpReplicationObj.Destination.changeDefaultStorageClass> <div class=storage-class-selector> <h1>{{\'objects.column.storageclass\' | translate }}</h1> <div> {{\'storageclass.selector.description\' | translate}} <external-link href={{docsUrls.storageClassIntro}} text="{{\'storageclass.selector.description_learnmore\' | translate}}" light=true></external-link> {{\'storageclass.selector.description_orsee\' | translate}} <external-link text="{{\'storageclass.selector.description_s3pricing\' | translate}}" href={{docsUrls.pricing}} light=true></external-link> </div> </div> <awsui-select id=crr-modal-storageclass-selector placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-model=tmpReplicationObj.Destination.StorageClass.value ng-change=updateStorageClassText(tmpReplicationObj.Destination.StorageClass.value) items=storageClasses></awsui-select> <awsui-alert style=margin-top:15px class="modal-warning-space modal-warning" visible="tmpReplicationObj.Destination.StorageClass.value === \'REDUCED_REDUNDANCY\'" type=warning> <span class="alert-exclamation-triangle awsui-alert-icon awsui-icon awsui-icon-big"></span> <h3 class=warning-title style=color:#eb6b09;font-size:18px;line-height:20px;padding-left:40px translate=storageclass.selector.reduced_redundancy.warning.header></h3> <p class=warning-message style=color:#000;font-size:13px;padding-left:40px translate=storageclass.selector.reduced_redundancy.warning.msg></p> </awsui-alert> </div> <div fac-id=s3-crr-v2> <awsui-checkbox id=crr-modal-accesscontroltranslate ng-model=tmpReplicationObj.Destination.isAccessControlTranslation checked=tmpReplicationObj.Destination.isAccessControlTranslation> <span translate=replicationmodal.destinationstep.accesscontroltranslationtext></span> </awsui-checkbox> <awsui-tooltip class=crr-modal-accesscontroltranslation-tooltip text="{{ \'crr.tooltips.accesscontroltranslation\'| translate }}" position=left size=small initialized=true> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-control-group ng-if="tmpReplicationObj.Destination.isAccessControlTranslation && showAccountIdTextField" validation-message={{accountIdError}}> <awsui-textfield class=crr-modal-destinationkmskey-input ng-model=accountIdForRogueActor.text placeholder="{{ \'replicationmodal.accountidplaceholder\' | translate}}" ng-change=resetAccountIdError() blur=checkAccountId(accountIdForRogueActor)></awsui-textfield> </awsui-control-group> </div> </div> </div> <div class=body-content ng-if="state === STEP.PERMISSIONS"> <div class=upper-section> <p class=subheader translate=replicationmodal.permissionstep.role></p> <awsui-button ng-if=modalInfo.showChangeRoleBtn variant=link class="dark change-role-button" ng-click=hideChangeRoleBtn() text="{{\'replicationmodal.permissionstep.changebutton\' | translate}}"></awsui-button> <div class=modal-content-divider></div> <div class=upper-section ng-if=modalInfo.showChangeRoleBtn> <div class=truncate><span class=text-color-light>{{tmpReplicationObj.Role.text}}</span></div> </div> <div ng-if=!modalInfo.showChangeRoleBtn> <dropdown class=iamrole-dropdown items=modalInfo.iamRoles selected-item=tmpReplicationObj.Role placeholder="{{ \'replicationmodal.permissionstep.roleplaceholder\' | translate }}" filter=true></dropdown> <awsui-alert type=warning visible=showOverrideDestWarning><span translate=replicationmodal.permissionstep.overriderolewarning></span></awsui-alert> </div> <awsui-alert type=error visible=modalInfo.modalError.listRoleError> <error-message error=modalInfo.modalError.listRoleError></error-message> </awsui-alert> </div> <div class=lower-section ng-if=shouldSaveV2()> <p class=subheader translate=replicationmodal.permissionstep.setrulename></p> <awsui-button ng-if=modalInfo.showChangeRoleBtn variant=link class="dark change-role-button" ng-click=hideChangeRoleBtn() text="{{\'replicationmodal.permissionstep.changebutton\' | translate}}"></awsui-button> <div class=modal-content-divider></div> <awsui-tooltip text="{{ (tmpReplicationObj.ID ? \'\' : \'crr.tooltips.rulenameundefined\') | translate }}" position=bottom class="replication-modal-tooltip error-style error-style-replication-modal" initialized=true> <awsui-textfield class="replication-modal-input replication-modal-rulename-input" ng-class="{ \'highlight-error\': !tmpReplicationObj.ID }" placeholder="{{\'replicationmodal.placeholder.rulename\' | translate}}" keep-focus=awsui-tooltip ng-model=tmpReplicationObj.ID></awsui-textfield> </awsui-tooltip> </div> <div class=lower-section ng-if="shouldSaveV2() && hasRules() && modalInfo.isAdd"> <p class=subheader translate=replicationmodal.permissionstep.setpriority></p> <awsui-button ng-if=modalInfo.showChangeRoleBtn variant=link class="dark change-role-button" ng-click=hideChangeRoleBtn() text="{{\'replicationmodal.permissionstep.changebutton\' | translate}}"></awsui-button> <div class=modal-content-divider></div> <div style="margin:-10px 0 10px" class=text-color-light translate=replicationmodal.permissionstep.prioritydescription></div> <awsui-radio-group ng-model=tmpReplicationObj.prioritySelection ng-change=setPriority()> <awsui-radio-button id=crr-priority-highest value=Highest label="{{\'replicationmodal.permissionstep.priority.highest\' | translate}} ({{calculateHighestPriority()}})"></awsui-radio-button> <awsui-radio-button id=crr-priority-lowest value=Lowest label="{{\'replicationmodal.permissionstep.priority.lowest\' | translate}} ({{calculateLowestPriority()}})"></awsui-radio-button> </awsui-radio-group> <awsui-alert class=modal-warning-message ng-if=priorityExistsAndIsNotTheOriginalOne() header="{{\'crr.warningmsg.title.prioritywouldbeupdated\' | translate}}" type=warning> <span translate=crr.warningmsg.detail.prioritywouldbeupdated translate-values={{upgradeWarningParams}}></span> </awsui-alert> </div> <div class=lower-section> <p class=subheader translate=replicationmodal.sourcestep.rulestatus></p> <div class=modal-content-divider></div> <awsui-radio-group ng-model=tmpReplicationObj.Status> <awsui-radio-button id=crr-status-enabled value=Enabled label="{{\'replicationmodal.sourcestep.enabled\' | translate}}"></awsui-radio-button> <awsui-radio-button id=crr-status-disabled value=Disabled label="{{\'replicationmodal.sourcestep.disabled\' | translate}}"></awsui-radio-button> </awsui-radio-group> </div> <div ng-if=showBucketPolicyTemplate class=lower-section> <p class=subheader translate=replicationmodal.permissionstep.bucketpolicyheader></p> <div class=modal-content-divider></div> <p translate=replicationmodal.permissionstep.bucketpolicytext></p> <span class=text-color-light translate=replicationmodal.permissionstep.bucketpolicyheader></span> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrBucketPolicy, copyBucketPolicyFinished); $event.stopPropagation();"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-msg\' : copyBucketPolicyFinished.flag === null}" translate=replicataionmodal.copiedtoclipboard></span> </div> <div class=crr-modal-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class=code readonly=true></div> </div> <div fac-id=s3-crr-kms ng-if=showKMSPolicyTemplate class=lower-section> <p class=subheader translate=replicationmodal.permissionstep.kmskeypolicyheader></p> <div class=modal-content-divider></div> <p><span translate=replicationmodal.permissionstep.kmskeypolicytext></span> <a class=learnmoreinmodal target=_blank href={{docLink}} translate>learn.more</a></p> <span class=text-color-light translate=replicationmodal.permissionstep.kmskeypolicyheader></span> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrKmsKeyPolicy, copyKmsKeyPolicyFinished); $event.stopPropagation();"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyKmsKeyPolicyFinished.flag === true, \'fade-out\' : copyKmsKeyPolicyFinished.flag === false, \'hide-msg\' : copyKmsKeyPolicyFinished.flag === null}" translate=replicataionmodal.copiedtoclipboard></span> </div> <div class=crr-kms-modal-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsKeyPolicyEditorLoaded}" class=code readonly=true></div> </div> </div> <div class=body-content ng-if="state === STEP.REVIEW"> <table class=review-table> <tr> <td class=review-subheader translate=replicationmodal.reviewstep.sourcetitle></td> <td class=edit-button> <awsui-button class=button-in-darkbg class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link ng-click=setState(STEP.SOURCE)></awsui-button></td> </tr> </table> <table class=crr-modal-review-table> <tr> <td class=review-title translate=replicationmodal.reviewstep.sourcepart.bucket></td> <td id=crr-modal-review-sourcebucket class=review-value>{{ replicationObj.globalSettings.sourceBucket.name}}</td> </tr> <tr> <td class=review-title translate=replicationmodal.reviewstep.sourcepart.scope></td> <td data-e2e-id=crr-modal-review-scope class=review-value> <span ng-if="!isSliceEnabled() && tmpReplicationObj.isEntireBucket===\'true\'" translate=replicationmodal.reviewstep.entirebucket></span> <span ng-if="!isSliceEnabled() && tmpReplicationObj.isEntireBucket === \'false\'" translate=replicationmodal.reviewstep.prefix translate-values="{prefix: tmpReplicationObj.Prefix}"></span> <span ng-if=isSliceEnabled()>{{getFilterString()}}</span> </td> </tr> <tr> <td class=review-title translate=replicationmodal.reviewstep.sourcepart.region></td> <td id=crr-modal-review-sourcebucket-region class=review-value>{{ replicationObj.globalSettings.sourceBucket.region}}</td> </tr> </table> <table class=review-table> <tr> <td class=review-subheader translate=replicationmodal.reviewstep.destinationtitle></td> <td class=edit-button> <awsui-button class=button-in-darkbg class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link ng-click=setState(STEP.DESTINATION)></awsui-button></td> </tr> </table> <table class=crr-modal-review-table> <tr> <td class=review-title translate=replicationmodal.reviewstep.destpart.bucket></td> <td id=crr-modal-review-dstbucket class=review-value>{{ tmpReplicationObj.Destination.Bucket.name }}</td> </tr> <tr> <td class=review-title translate=replicationmodal.reviewstep.destpart.region></td> <td id=crr-modal-review-dstbucket-region class=review-value>{{ tmpReplicationObj.Destination.Bucket.region }}</td> </tr> <tr> <td class=review-title translate=replicationmodal.reviewstep.destpart.storageclass></td> <td id=crr-modal-review-dststorageclass class=review-value>{{tmpReplicationObj.Destination.StorageClass.text}}</td> </tr> <tr fac-id=s3-crr-v2 ng-if=tmpReplicationObj.Destination.isAccessControlTranslation> <td class=review-title translate=replicationmodal.reviewstep.destpart.accesscontroltranslation colspan=2></td> </tr> <tr fac-id=s3-crr-kms ng-if=tmpReplicationObj.Destination.isKmsEncryption> <td class=review-title translate=replicationmodal.reviewstep.destpart.kmsencryption colspan=2></td> </tr> </table> <table class=review-table> <tr> <td class=review-subheader translate=replicationmodal.reviewstep.optionstitle></td> <td class=edit-button> <awsui-button class=button-in-darkbg class=button-in-darkbg text="{{ \'createbucketmodal.button.edit\' | translate }}" variant=link ng-click=setState(STEP.PERMISSIONS)></awsui-button></td> </tr> </table> <table class="crr-modal-review-table crr-modal-review-iamrole-table"> <tr> <td class=review-title translate=replicationmodal.reviewstep.iamrole></td> <td id=crr-modal-review-iamrole class=review-value>{{tmpReplicationObj.Role.text}}</td> </tr> <tr ng-if=shouldSaveV2()> <td class=review-title translate=replicationmodal.reviewstep.rulename></td> <td id=crr-modal-review-rulename class=review-value>{{tmpReplicationObj.ID || \'-\'}}</td> </tr> <tr ng-if=shouldSaveV2()> <td class=review-title translate=replicationmodal.reviewstep.priority></td> <td id=crr-modal-review-priority class=review-value>{{tmpReplicationObj.Priority}}</td> </tr> <tr> <td class=review-title translate=replicationmodal.reviewstep.status></td> <td id=crr-modal-review-status class=review-value> <span ng-if="tmpReplicationObj.Status === REPLICATION.ENABLED" class=review-value translate="{{\'replicationmodal.sourcestep.enabled\' | translate}}"></span> <span ng-if="tmpReplicationObj.Status === REPLICATION.DISABLED" class=review-value translate="{{\'replicationmodal.sourcestep.disabled\' | translate}}"></span> </td> </tr> </table> <div class=review-policy ng-if=showBucketPolicyTemplate> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrBucketPolicy, copyBucketPolicyFinished)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-msg\' : copyBucketPolicyFinished.flag === null}" translate=copytoclipboard.path></span> </div> <awsui-expandable-section id=expand-bucket-policy class=dark header="{{ \'receiveobjectsmodal.bucketpolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-bucket-policy\')"> <div class=crr-modal-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class=code readonly=true></div> </awsui-expandable-section> </div> <div fac-id=s3-crr-kms class="kms-policy review-policy" ng-if=showKMSPolicyTemplate> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrKmsKeyPolicy, copyKmsKeyPolicyFinished)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyKmsKeyPolicyFinished.flag === true, \'fade-out\' : copyKmsKeyPolicyFinished.flag === false, \'hide-msg\' : copyKmsKeyPolicyFinished.flag === null}" translate=copytoclipboard.path></span> </div> <awsui-expandable-section id=expand-kms-policy class=dark header="{{ \'replicationmodal.permissionstep.kmskeypolicyheader\' | translate }}" ng-click="scrollIntoView(\'expand-kms-policy\')"> <div class=crr-kms-modal-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsKeyPolicyEditorLoaded}" class=code readonly=true></div> </awsui-expandable-section> </div> <awsui-alert visible=modalInfo.modalError.saveError class="block small-top-margin crr-save-error" type=error dismissible=false header="{{ \'error.header\' | translate }}"> {{ modalInfo.modalError.saveError }} </awsui-alert> </div> </div> </modal-content> <modal-footer> <div class=replication-modal-footer transclude-name=footer> <awsui-button id=next-step ng-if="state !== STEP.REVIEW" data-disabled="!modalState.showNext || tmpReplicationObj.isEntireBucket===null \n                          || state === STEP.SOURCE && sourceStepDisableNextNutton()\n                          || state === STEP.DESTINATION && destinationStepDisableNextButton()\n                          || state === STEP.PERMISSIONS && optionsStepDisableNextButton()" variant=primary text="{{ \'replicationmodal.reviewstep.next\' | translate }}" loading="bucketSelectorObj.isLoading || multiSelectorObj.isLoadingData || isListingKmsKeys" class="awsui-util-f-r primary-button" click=nextCRRStep()> </awsui-button> <awsui-button id=save-rule ng-if="state === STEP.REVIEW" click=savePressed() loading=isSaving.flag variant=primary text="{{ \'replicationmodal.reviewstep.save\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> <awsui-button id=cancel-rule text="{{ \'replicationmodal.reviewstep.cancel\' | translate }}" variant=normal ng-if="state === STEP.SOURCE" class=awsui-util-f-r click=closeReplicationModal()> </awsui-button> <awsui-button id=previous-step text="{{ \'replicationmodal.reviewstep.previous\' | translate }}" variant=normal ng-if="state !== STEP.SOURCE" data-disabled=isSaving.flag class=awsui-util-f-r click="previousState(); copyFinished.flag=null"> </awsui-button> </div> </modal-footer> </modal>'},function(e,t,n){"use strict";(function(e){!function(){function t(e,t,n,r,i,a){e.copyFinished={flag:null},e.errorModal={},e.isEnablingVersioning={flag:!1},function(){switch(a.bodyFreezeScroll(!0),e.errorType){case"disabled":e.errorModal.title=t.instant("crr.warningmsg.title.notenabled"),e.errorModal.header=t.instant("crr.warningmsg.content.notenabled"),e.errorModal.contentText=t.instant("crr.warningmsg.detail.notenabled"),e.bucket.name=e.bucketSelectorObj.destinationBucket.name;break;case"getFailure":e.errorModal.title=t.instant("crr.warningmsg.title.accessdenied"),e.errorModal.contentText=t.instant("crr.warningmsg.detail.cannotdetectversioning"),e.errorModal.header=t.instant("crr.warningmsg.content.cannotdetectversioning"),e.bucket.name=e.bucketSelectorObj.destinationBucket.name;break;case"saveFailure":e.errorModal.title=t.instant("crr.warningmsg.title.accessdenied"),e.errorModal.contentText=t.instant("crr.warningmsg.detail.cannotenableversioning"),e.errorModal.header=t.instant("crr.warningmsg.content.cannotenableversioning"),e.bucket.name=e.bucketSelectorObj.destinationBucket.name}}(),e.policyEditorLoaded=function(t){var r=a.getBucketARN(e.bucket.name),o=""+a.getIamARNPrefix()+a.getUserAccountId()+":root";e.accessControlTranslationIds&&e.accessControlTranslationIds.length>0?e.crrBucketPolicy=n.generateBucketPolicyWithArn(r,o,i.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):e.crrBucketPolicy=n.generateBucketPolicyWithArn(r,o,i.CRR_BUCKET_POLICY_TEMPLATE),t.getSession().getDocument().setValue(e.crrBucketPolicy)},e.closeErrorModal=function(){e.errorModal.title=null,e.errorModal.header=null,e.modalOpen={flag:!1},e.errorModal.contentText=null,a.bodyFreezeScroll(!1)},e.enableDestinationVersioning=function(){r.enableDestinationVersioning(e.isEnablingVersioning,e.bucketSelectorObj,null,!0,e.closeErrorModal)}}e.module("s3").directive("crrErrorModal",[function(){return{restrict:"E",scope:{modalOpen:"=",errorType:"=",bucketSelectorObj:"=",bucket:"=",copyPolicyToClipboard:"=",accessControlTranslationIds:"=?"},template:n(771),controller:"CrrErrorModalController"}}]),e.module("s3").controller("CrrErrorModalController",["$scope","$translate","BucketPolicyService","ReplicationUtilService","ReplicationConstants","UtilService",t])}()}).call(t,n(0))},function(e,t){e.exports='<dialog-modal class=replication-confirmation-modal is-open=modalOpen close-callback=closeErrorModal header-title=errorModal.title> <dialog-modal-content> <awsui-alert header={{errorModal.header}} type=warning visible="bucketSelectorObj.destinationBucket.versioningEnabled === false"> {{errorModal.contentText}} </awsui-alert> <awsui-button ng-if="bucketSelectorObj.destinationBucket.versioningEnabled === false" variant=primary text="{{ \'crr.errormodal.enableversioning\' | translate }}" class=primary-button click=enableDestinationVersioning() loading=isEnablingVersioning.flag></awsui-button> <awsui-alert header="{{\'crr.warningmsg.content.cannotenableversioning\' | translate}}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.enabledVersioningError><span translate=crr.warningmsg.detail.cannotenableversioning></span></awsui-alert> <awsui-alert header="{{\'crr.warningmsg.content.bucketnotexist\' | translate}}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.bucketNotExistError></awsui-alert> <awsui-alert header="{{\'crr.warningmsg.content.sameregion\' | translate }}" type=warning visible=bucketSelectorObj.destinationBucket.Errors.generalErrors></awsui-alert> <div ng-if="bucketSelectorObj.destinationBucket.Errors.enabledVersioningError || bucketSelectorObj.destinationBucket.Errors.getVersioningError"> <span class=text-color-light translate=crr.confirmationmodal.bucketpolicytitle></span> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyPolicyToClipboard(bucket.name, copyFinished, true, true)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyFinished.flag === true, \'fade-out\' : copyFinished.flag === false, \'hide-msg\' : copyFinished.flag === null}" translate=copytoclipboard.path></span> </div> <div class=crr-modal-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class=code readonly=true></div> </div> </dialog-modal-content> <dialog-modal-footer> <awsui-button click=closeErrorModal() variant=normal text="{{ \'crr.errormodal.close\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal> '},function(e,t,n){"use strict";(function(e){function t(e){var t=this,n=e.instant("crr.upgradeconfirmation.word"),r=function(){t.isOpen.flag=!1,t.confirmationInfo.input=""};t.confirmationInfo={word:n,label:e.instant("crr.upgradeconfirmation.type",{word:n}),input:""},t.checkConfirmationWord=function(){return n===t.confirmationInfo.input},t.confirm=function(){r(),t.confirmCallback&&t.confirmCallback()},t.cancel=function(){r(),t.cancelCallback&&t.cancelCallback()}}e.module("s3").directive("crrUpgradeConfirmationModal",[function(){return{restrict:"E",scope:{},bindToController:{headerTitle:"<",isOpen:"=",warningMessage:"<",cancelCallback:"&?",confirmCallback:"&"},template:n(773),controller:"CrrUpgradeConfirmationModalController",controllerAs:"vm"}}]),e.module("s3").controller("CrrUpgradeConfirmationModalController",["$translate",t])}).call(t,n(0))},function(e,t){e.exports='<dialog-modal class=crr-upgrade-confirmation-modal is-open=vm.isOpen close-callback=cancel() header-title=vm.headerTitle> <dialog-modal-content> <div class=crr-upgrade-modal__content> <awsui-alert type=warning header="{{\'crr.warningmsg.title.crrschemawouldbeupdated\' | translate}}"> <span ng-bind-html="vm.warningMessage | trusted"></span> </awsui-alert> <p class=crr-upgrade-confirmation-modal__label ng-bind-html="vm.confirmationInfo.label | trusted"></p> <awsui-textfield id=publicAccessConfirmationInput autocomplete=off ng-model=vm.confirmationInfo.input placeholder={{vm.confirmationInfo.word}}></awsui-textfield> </div> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=publicAccessConfirmationCancelButton class=crr-upgrade-confirmation-modal__cancel-button text="{{ \'button.cancel\' | translate }}" variant=normal click=vm.cancel()></awsui-button> <awsui-button id=publicAccessConfirmationConfirmButton click=vm.confirm() variant=primary data-disabled=!vm.checkConfirmationWord() text="{{ \'confirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal> '},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c){function l(n){e.modalInfo.isOpen={flag:!0},e.modalInfo.isOverride=!0,e.modalInfo.isAdd=!0,e.modalInfo.isEditing=!1,e.modalInfo.showChangeDestinationBtn=!1,e.modalInfo.showChangeRoleBtn=!1,e.tmpReplicationObj.Destination.Bucket=t.clone(e.bucketSelectorObj.destinationBucket),e.tmpReplicationObj.isEntireBucket=n.toString(),t.get(e.replicationObj,"ruleSettings.Rule",[]).length>0&&(e.tmpReplicationObj.ID=e.replicationObj.ruleSettings.Rule[0].ID),o.bodyFreezeScroll(!0)}e.copyFinished={flag:!1},e.errorModal={isOpen:null},e.$watch("modalInfo.prefixOrWholeBucket.value",function(t,n){e.modalInfo.isEditing&&n!==t&&(t===a.REPLICATION.PREFIX&&e.modalInfo.isEntireBucket?l(!1):t!==a.REPLICATION.ENTIRE_BUCKET||e.modalInfo.isEntireBucket?(e.modalInfo.isOverride=!1,e.modalInfo.isAdd=!1,e.modalInfo.showChangeDestinationBtn=!1,e.modalInfo.showChangeRoleBtn=!1):l(!0))}),e.crrWithObjectLockEnabled=function(){return!(!c.isFeatureEnabled(s.FAC.CRR_WITH_OBJECT_LOCK)||!e.currentBucketRetention)},e.disableSaveButton=function(){return e.crrWithObjectLockEnabled()&&(!1===e.bucketSelectorObj.destinationBucket.bucketObjectLockEnabled||e.bucketSelectorObj.destinationBucket.Errors.getBucketObjectLockEnabledError)},e.validateBucketName=function(){o.validateBucketName(e.bucketSelectorObj.destinationBucket.name,e.bucketSelectorObj.destinationBucket.bucketNameValidationErrors,e.bucketSelectorObj.bucketListCurrAccount)},e.enableEditGlobalConfig=function(){e.selectedRule.flag=!1,e.selectedRule.ruleObj={},i.initializeTmpReplicationObj(e.replicationObj,e.tmpReplicationObj,e.modalInfo.storageTextMapping),i.initBucketSelector(e.bucketSelectorObj,e.replicationObj),e.modalInfo.isEditing=!0,e.replicationObj.globalSettings.sourceKmsKeysObj.initialized||i.getSourceSelectedKMSKeys(!0,e.multiSelectorObj,e.replicationObj,e.tmpReplicationObj).then(function(){}).finally(function(){e.multiSelectorObj.isLoadingData=!1})},e.copyPolicyToClipboard=function(r,i){r=t.isEmpty(e.bucketSelectorObj.destinationBucket.name)?r:e.bucketSelectorObj.destinationBucket.name;var s=o.getBucketARN(r),c=""+o.getIamARNPrefix()+o.getUserAccountId()+":root";t.get(e.replicationObj,"globalSettings.accessControlTranslationIds",[]).length>0?o.copyDataToClipboard(n.generateBucketPolicyWithArn(s,c,a.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR),i):o.copyDataToClipboard(n.generateBucketPolicyWithArn(s,c,a.CRR_BUCKET_POLICY_TEMPLATE),i)},e.cancelModifyGlobalConfig=function(){e.modalInfo.isEditing=!1,i.initializeTmpReplicationObj(e.replicationObj,e.tmpReplicationObj,e.modalInfo.storageTextMapping),i.initBucketSelector(e.bucketSelectorObj,e.replicationObj),e.modalInfo.modalError.saveError=null},e.showGlobalConfigErrorModal=function(t){e.errorType=t,e.errorModal.isOpen={flag:!0}},e.savePressed=function(){var t=new r("saveCRROperation");e.tmpReplicationObj.Destination.Account=e.bucketSelectorObj.destinationBucket.accountId,e.isSaving={flag:!0},e.tmpReplicationObj.Destination.Bucket.name=e.bucketSelectorObj.destinationBucket.name,e.tmpReplicationObj.Destination.Bucket.region=e.bucketSelectorObj.destinationBucket.region,i.saveReplication(e.isSaving,e.tmpReplicationObj,e.bucketSelectorObj,e.modalInfo,e.replicationObj,function(n){i.updateCRRTableAfterPut(e.modalInfo,e.replicationObj,e.tmpReplicationObj,n,t).then(function(){e.modalInfo.isEditing=!1,e.bucketSelectorObj.destinationBucket.Errors={},e.replicationObj.errorMessage="",e.selectedRule.flag=!1,e.selectedRule.ruleObj={},e.cancelModifyGlobalConfig()}).catch(function(t){e.replicationObj.errorMessage=t})},function(t){e.modalInfo.modalError.saveError=t},e.crrWithObjectLockEnabled())}}e.module("s3").directive("crrGlobalSettings",[function(){return{restrict:"E",scope:{modalInfo:"=",bucketSelectorObj:"=",multiSelectorObj:"=",replicationObj:"=",tmpReplicationObj:"=",selectedRule:"=",disabled:"=",currentBucketRetention:"="},template:n(775),controller:"CrrGlobalSettingsController"}}]),e.module("s3").controller("CrrGlobalSettingsController",["$scope","BucketPolicyService","ConsoleOperation","ReplicationUtilService","ReplicationConstants","UtilService","S3Constants","FAC",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<div ng-if=modalInfo.isEditing class=global-settings-background></div> <div class="global-settings wrapper"> <div ng-if=disabled class=cover-overlay></div> <table class=global-setting-table> <thead> <th> <p class=section-title translate=crr.globalconfig.source.title></p> <div class=divider></div> </th> <th> <p class=section-title translate=crr.globalconfig.destination.title></p> <div class=divider></div> </th> <th> <p class=section-title translate=crr.globalconfig.permissions.title></p> <div class=divider></div> </th> </thead> <tbody> <tr class=global-setting-title> <td translate=crr.globalconfig.bucket> </td> <td translate=crr.globalconfig.bucket> </td> <td translate=crr.globalconfig.iamroletitle> </td> </tr> <tr> <td id=crr-global-display-srcBucket class="value-display bold-text"> {{replicationObj.globalSettings.sourceBucket.name}} </td> <td ng-if=!modalInfo.isEditing id=crr-global-display-destBucket class="value-display bold-text"> {{replicationObj.globalSettings.destinationBucket.name}} </td> <td class=value-display ng-if=modalInfo.isEditing> <div> <bucket-selector class=replication-modal-bucketselector show-bucket-name-only=true choose-accounts=true editable=true bucket-replication=bucketSelectorObj></bucket-selector> <div class=createbucketbodycontent ng-if=bucketSelectorObj.destinationBucket.createNewDestBucket> <div class=name-title> <span translate=createbucketmodal.label.name></span> <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle info-circle"></i> </awsui-tooltip> </div> <div class=bucketname-and-region> <awsui-control-group> <span dom-region=validationMessage ng-if="bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length > 0"> <label ng-repeat="message in bucketSelectorObj.destinationBucket.bucketNameValidationErrors">{{message}}</label><br> </span> <span dom-region=control> <awsui-textfield class=create-bucket-modal-input autocomplete=true ng-keyup=validateBucketName() placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model=bucketSelectorObj.destinationBucket.name> </awsui-textfield> </span> </awsui-control-group> </div> <div class=region-title> <span translate=createbucketmodal.label.region></span> </div> <dropdown items=modalInfo.regions selected-item=bucketSelectorObj.destinationBucket.region placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter=true></dropdown> </div> </div> </td> <td id=crr-global-display-iamrole class="value-display bold-text" ng-if=!modalInfo.isEditing> {{replicationObj.globalSettings.Role.text}} </td> <td class=value-display ng-if=modalInfo.isEditing> <div> <dropdown id=crr-global-iamrole-selector items=modalInfo.iamRoles selected-item=tmpReplicationObj.Role placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter=true></dropdown> </div> </td> </tr> <tr class=global-setting-title ng-class="{ \'global-title-editing\': modalInfo.isEditing }"> <td translate=crr.globalconfig.sourceregion></td> <td><span ng-if=!modalInfo.isEditing translate=crr.globalconfig.sourceregion></span></td> <td translate=crr.globalconfig.bucketpolicytitle></td> </tr> <tr> <td class="value-display bold-text">{{replicationObj.globalSettings.sourceBucket.region}}</td> <td class="value-display bold-text"><span ng-if=!modalInfo.isEditing>{{replicationObj.globalSettings.destinationBucket.region}} <span ng-if=replicationObj.globalSettings.destinationBucket.disabled> - {{ \'disabled.region\' | translate }}</span></span></td> <td class="value-display bold-text"> <div class=global-config-copybutton> <awsui-button variant=link text="{{ \'crr.globalconfig.copypolicy\' | translate }}" ng-click="copyPolicyToClipboard(tmpReplicationObj.Destination.Bucket.name, copyFinished, true, true)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyFinished.flag === true, \'fade-out\' : copyFinished.flag === false, \'hide-msg\' : copyFinished.flag === null}" translate=copytoclipboard.path></span> </div> </td> </tr> <tr> <td></td> <td class=error-display> <table class=global-config-warning ng-if="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.versioningEnabled === false && !bucketSelectorObj.destinationBucket.Errors.getVersioningError && !bucketSelectorObj.destinationBucket.Errors.enabledVersioningError" ng-click="showGlobalConfigErrorModal(\'disabled\')"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.notenabled></td> </tr> </table> <table class=global-config-warning ng-if="crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.bucketObjectLockEnabled === false"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.objectlocknotenabled></td> </tr> </table> <table class=global-config-warning ng-if="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.Errors.getVersioningError" ng-click="showGlobalConfigErrorModal(\'getFailure\')"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.cannotdetectversioning></td> </tr> </table> <table class=global-config-warning ng-if="crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.Errors.getBucketObjectLockEnabledError"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.cannotdetectobjectlockenabled></td> </tr> </table> <table class=global-config-warning ng-if="!crrWithObjectLockEnabled() && bucketSelectorObj.destinationBucket.Errors.enabledVersioningError" ng-click="showGlobalConfigErrorModal(\'saveFailure\')"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.cannotenableversioning></td> </tr> </table> <table class="global-config-warning non-clickable" ng-if=bucketSelectorObj.destinationBucket.Errors.bucketNotExistError> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text translate=crr.warningmsg.content.bucketnotexist></td> </tr> </table> <table class="global-config-warning non-clickable" ng-if="bucketSelectorObj.destinationBucket.Errors.generalErrors && bucketSelectorObj.destinationBucket.Errors.generalErrors.header"> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text>{{bucketSelectorObj.destinationBucket.Errors.generalErrors.header}}</td> </tr> </table> <table class="global-config-warning non-clickable" ng-if=tmpReplicationObj.getSourceKMSKeyError> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text> <error-message error=tmpReplicationObj.getSourceKMSKeyError></error-message> </td> </tr> </table> </td> <td class=error-display> <div ng-if=modalInfo.modalError.listRoleError class="alert-exclamation-triangle awsui-icon awsui-icon-big global-config-errors"> <error-message error=modalInfo.modalError.listRoleError></error-message> </div> </td> </tr> </tbody> </table> <div class="config-sections global-config-buttons"> <div class=global-setting-buttons> <div class=config-buttons> <awsui-button id=crr-global-enable-editing-button ng-if=!modalInfo.isEditing variant=link ng-click=enableEditGlobalConfig()> <span translate=crr.globalconfig.editglobalsettings></span> </awsui-button> <awsui-button id=crr-global-cancel ng-if=modalInfo.isEditing text="{{ \'crr.globalsettings.cancel\' | translate }}" variant=normal click=cancelModifyGlobalConfig()></awsui-button> <awsui-button ng-if=modalInfo.isEditing click=savePressed() data-disabled=disableSaveButton() variant=primary text="{{ \'crr.globalsettings.save\' | translate }}" loading="isSaving.flag || bucketSelectorObj.isLoading || multiSelectorObj.isLoadingData" class=primary-button id=crr-global-save> </awsui-button> </div> <table class=global-config-errors ng-if=modalInfo.modalError.saveError> <tr> <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td> <td class=warning-text>{{modalInfo.modalError.saveError}}</td> </tr> </table> </div> </div> </div> <crr-error-modal ng-if=errorModal.isOpen.flag bucket-selector-obj=bucketSelectorObj modal-open=errorModal.isOpen bucket=tmpReplicationObj.Destination.Bucket error-type=errorType access-control-translation-ids=replicationObj.globalSettings.accessControlTranslationIds copy-policy-to-clipboard=copyPolicyToClipboard> </crr-error-modal>'},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(n,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E,S,y,A){function C(){n.tmpReplicationObj.Destination.Bucket.name=n.bucketSelectorObj.destinationBucket.name,t.isEmpty(t.get(n.bucketSelectorObj,"destinationBucket.accountId"))&&(n.bucketSelectorObj.destinationBucket.accountId=n.accountIdForRogueActor.text),n.tmpReplicationObj.Destination.Account=n.bucketSelectorObj.destinationBucket.accountId,t.isEmpty(t.get(n.selectedKmsKeyObj,"content.value"))||n.bucketSelectorObj.isCrossAccount||(n.tmpReplicationObj.Destination.replicaKmsKeyId=n.selectedKmsKeyObj.content.value),t.isEmpty(n.bucketSelectorObj.destinationBucket.region)?l.getBucketRegion(n.tmpReplicationObj.Destination.Bucket.name).then(function(e){n.tmpReplicationObj.Destination.Bucket.region=e.text}):t.isObject(n.bucketSelectorObj.destinationBucket.region)?n.tmpReplicationObj.Destination.Bucket.region=n.bucketSelectorObj.destinationBucket.region.text:n.tmpReplicationObj.Destination.Bucket.region=n.bucketSelectorObj.destinationBucket.region}function _(e){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1];n.isListingKmsKeys=!0;var i=new d("CRR-getDestinationKmsOperation"),a={};r&&(a.region=r),g.getKMSKeysByArn(i,e,null,a).then(function(e){if(n.KMSServiceError=null,n.kmsKeys=t.isEmpty(e)?[]:[].concat(e),n.selectedKmsKeyObj.content&&-1===t.findIndex(n.kmsKeys,{value:n.selectedKmsKeyObj.content.value})&&(n.selectedKmsKeyObj.content=null),t.get(n.tmpReplicationObj,"Destination.replicaKmsKeyId",null)){var r=t.find(e,{value:n.tmpReplicationObj.Destination.replicaKmsKeyId});t.isEmpty(r)||(n.selectedKmsKeyObj.content=r)}}).catch(function(e){n.KMSServiceError=e}).finally(function(){n.isListingKmsKeys=!1})}function w(){var e=t.get(n.tmpReplicationObj,"Destination.isAccessControlTranslation",!1),r=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1),i=t.get(n.replicationObj,"globalSettings.accessControlTranslationIds",[]).length>0,a=Object.keys(t.get(n.replicationObj,"globalSettings.kmsEncryptionIds",{})).length>0;n.replicationObj.showSignoutWarning=e&&!i||r&&!a?n.bucketSelectorObj.isCrossAccount:!(!r||!a)&&n.bucketSelectorObj.isCrossAccount&&-1===t.values(n.replicationObj.globalSettings.kmsEncryptionIds).indexOf(n.tmpReplicationObj.Destination.replicaKmsKeyId)}function T(){var e=new d("listRoles");n.modalInfo.modalError.listRoleError=null,E.log("CRR_ListRolesRequestReceived",1,e),s.makeProxyRequest(p.listRoles,{region:S.getDefaultRegion(),params:{MaxItems:v.API_MAX_ITEMS.IAM_LIST_ROLES}},v.PROXY_API_NAMES.IAM.LIST_ROLES,e).then(function(r){var i=r.response.ListRolesResponse.ListRolesResult.Roles;E.log("CRR_ListRoles",1,e),i.forEach(function(e){-1===t.findIndex(n.modalInfo.iamRoles,{value:e.Arn})&&n.modalInfo.iamRoles.push({text:e.RoleName,value:e.Arn})})}).catch(function(t){E.log("CRR_ListRoles",0,e),n.modalInfo.modalError.listRoleError=S.handleErrors(t)})}function R(){var e=new d("getVersioning");l.getBucketVersioning(n.replicationObj.globalSettings.sourceBucket.name,e).then(function(t){E.log("CRR_getVersioning",1,e),n.modalInfo.modalError.sourceVersioning=null,n.modalState.showSourceVersioningWarning=t!==b.REPLICATION.ENABLED,n.modalState.showNext=t===b.REPLICATION.ENABLED}).catch(function(t){E.log("CRR_getVersioning",0,e),n.modalState.showSourceVersioningWarning=!0,n.modalInfo.modalError.sourceVersioning=t,n.modalState.showNext=!1})}function O(e){return!t.isEmpty(n.replicationObj.globalSettings.destinationBucket.name)&&(!!(e||n.replicationObj.ruleSettings.Rule&&n.replicationObj.ruleSettings.Rule.length>1)||void 0)}function k(e){return!t.isEmpty(n.replicationObj.globalSettings.Role)&&!t.isEmpty(n.replicationObj.globalSettings.Role.text)&&(!!(e||n.replicationObj.ruleSettings.Rule&&n.replicationObj.ruleSettings.Rule.length>1)||void 0)}function I(){t.isEmpty(n.tmpReplicationObj)&&(n.tmpReplicationObj={}),m.initializeTmpReplicationObj(n.replicationObj,n.tmpReplicationObj,n.modalInfo.storageTextMapping)}n.STEP={SOURCE:{name:"SOURCE",value:a.instant("replicationmodal.label.source")},DESTINATION:{name:"DESTINATION",value:a.instant("replicationmodal.label.destination")},PERMISSIONS:{name:"PERMISSIONS",value:a.instant("replicationmodal.label.permissions")},REVIEW:{name:"REVIEW",value:a.instant("replicationmodal.label.review")}},n.REPLICATION=b.REPLICATION,n.showBucketPolicyTemplate=!1,n.showKMSPolicyTemplate=!1,n.modalState={showNext:!0,showSourceVersioningWarning:!1,destinationVersioningWarning:null},n.headerTitle=a.instant("replicationmodal.modaltitle"),n.state=n.STEP.SOURCE,n.modalInfo.prefixList=t.pluck(n.replicationObj.ruleSettings.Rule,"Prefix").filter(function(e){return""!==e}),n.modalInfo.prefixOrWholeBucketOptions=[{text:a.instant("crr.globalconfig.source.prefix"),value:b.REPLICATION.PREFIX},{text:a.instant("crr.globalconfig.source.entirebucket"),value:b.REPLICATION.ENTIRE_BUCKET}],n.bucketSelectorObj={},n.multiSelectorObj={searchPlaceholder:a.instant("crr.multiselector.searchboxplaceholder"),isLoadingData:!1,isDropDownOpen:!1,errorMsg:null,initialized:!1,noSearchResult:{text:a.instant("crr.multiselector.noresultfound"),addInputText:a.instant("crr.multiselector.addcustomarn")},optionList:[],emptyDisplayPlaceholder:a.instant("crr.multiselector.emptydisplayplaceholder"),nonEmptyDisplayPlaceholder:a.instant("crr.multiselector.displayplacehodersuffix"),totalSelectedCount:0},n.modalInfo.regions=[],n.showOverrideDestWarning=!1,n.storageClasses=[{value:v.STORAGE_CLASSES.STANDARD,text:a.instant("replication.storageclasses.standard")},{value:v.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:a.instant("replication.storageclasses.standardia")},{value:v.STORAGE_CLASSES.ONEZONE_IA,text:a.instant("storageclass.zia")},{value:v.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:a.instant("replication.storageclasses.reducedredundancy")}],n.copyKmsKeyPolicyFinished={flag:null},n.copyBucketPolicyFinished={flag:null},n.modalInfo.iamRoles=[],n.modalInfo.iamRoles.push({text:a.instant("replication.roles.createnew"),value:b.REPLICATION.NEWROLE,pinnedTop:!0}),S.getFACRegions(h.regionMapping,n.modalInfo.regions),n.modalInfo.regions=t.filter(n.modalInfo.regions,function(e){return e.text!==n.replicationObj.globalSettings.sourceBucket.region}),n.isEnablingDestinationVersioning={flag:!1},n.accountIdForRogueActor={text:null},n.selectedKmsKeyObj={content:null},n.kmsCustomInput={isEnabled:!0,text:a.instant("crr.multiselector.addcustomarn"),customPlaceHolderText:"crr.multiselector.searchboxplaceholder"},n.docLink=c.getDocUrl(v.LEARN_MORE_LINKS.CRR_KMS),n.markers=[],n.tag={error:""},n.tagSearchSelected=!1,n.showTag=!1,n.tagContinuationTokens=[],function(){m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.showChangeDestinationBtn=O(n.modalInfo.isAdd),n.modalInfo.showChangeRoleBtn=k(n.modalInfo.isAdd),n.showOverrideDestWarning=n.modalInfo.showChangeDestinationBtn,n.showChangeRoleWarning=n.modalInfo.showChangeRoleBtn,n.modalInfo.isOpen&&n.modalInfo.isOpen.flag&&(n.modalInfo.isAdd?(n.tmpReplicationObj={Destination:{Bucket:{name:null,region:null},StorageClass:{value:null,text:n.modalInfo.storageTextMapping[v.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:!1,isAccessControlTranslation:!1,isKmsEncryption:!1,Account:null,replicaKmsKeyId:null},prioritySelection:"Highest",originalPriority:1,ID:null,Prefix:null,Status:b.REPLICATION.ENABLED,isEntireBucket:(!n.replicationObj.ruleSettings.Rule||n.replicationObj.ruleSettings.Rule.length<1).toString(),isEntireBucketSlice:"true",Role:null,name:null,sourceKMSKeys:[]},n.selectedRule.flag=!1,n.selectedRule.ruleObj={},n.modalInfo.isEntireBucket||o(function(){e.element(".replication-modal-input input").focus()})):(n.tmpReplicationObj=t.cloneDeep(n.selectedRule.ruleObj),n.tmpReplicationObj.originalPriority=n.tmpReplicationObj.Priority,n.tmpReplicationObj.prioritySelection="Current",n.tmpReplicationObj.isEntireBucketSlice="true",n.tmpReplicationObj.originalID=n.tmpReplicationObj.ID),n.tmpReplicationObj.sourceKMSKeys=[],n.replicationObj.globalSettings.selectedSourceKmsKeys.length>0&&t.forEach(n.replicationObj.globalSettings.selectedSourceKmsKeys,function(e){n.tmpReplicationObj.sourceKMSKeys.push(e)}),n.tmpReplicationObj.Destination.Bucket=t.clone(n.replicationObj.globalSettings.destinationBucket),n.bucketSelectorObj.destinationBucket.name=t.get(n.tmpReplicationObj,"Destination.Bucket.name",""),n.tmpReplicationObj.Role=t.clone(n.replicationObj.globalSettings.Role),R(),n.tmpReplicationObj.Destination.isKmsEncryption&&(Object.keys(n.replicationObj.globalSettings.kmsEncryptionIds).length>0?m.getSourceSelectedKMSKeys(!0,n.multiSelectorObj,n.replicationObj,n.tmpReplicationObj).then(function(){}).finally(function(){m.initMultiSelector(n.replicationObj,n.multiSelectorObj),n.multiSelectorObj.isLoadingData=!1}):n.multiSelectorObj.selectAllByDefault=!0)),y.isFeatureEnabled(v.FAC.ONEZONE_IA)||(n.storageClasses=t.reject(n.storageClasses,function(e){return e.value===v.STORAGE_CLASSES.ONEZONE_IA})),y.isFeatureEnabled(v.FAC.S3_RRS)||(n.storageClasses=t.reject(n.storageClasses,function(e){return e.value===v.STORAGE_CLASSES.REDUCED_REDUNDANCY})),n.modalInfo.flag&&I(),T()}(),n.validateBucketName=function(){S.validateBucketName(n.bucketSelectorObj.destinationBucket.name,n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors,n.bucketSelectorObj.bucketListCurrAccount)},n.hideChangeDestinationBtn=function(){n.modalInfo.showChangeDestinationBtn=!1},n.hideChangeRoleBtn=function(){n.modalInfo.showChangeRoleBtn=!1},n.getListKMS=function(){var e=new d("getListKMSForCRRModal"),t=A.getCurrentBucket();return g.getKMSKeysByArn(e,t)},n.fetchSourceSelectedKMSKeys=function(e){Object.keys(n.replicationObj.globalSettings.kmsEncryptionIds).length>0?m.getSourceSelectedKMSKeys(e,n.multiSelectorObj,n.replicationObj,n.tmpReplicationObj).then(function(){}).finally(function(){m.initMultiSelector(n.replicationObj,n.multiSelectorObj)}):n.multiSelectorObj.selectAllByDefault=!0,t.isEmpty(t.get(n.bucketSelectorObj,"destinationBucket.name"))||_(n.bucketSelectorObj.destinationBucket.name)},n.nextCRRStep=function(){n.copyFinished={flag:null},n.state===n.STEP.SOURCE?("true"===n.tmpReplicationObj.isEntireBucket&&(n.tmpReplicationObj.Prefix=null),n.tmpReplicationObj.Destination.isKmsEncryption&&(n.tmpReplicationObj.sourceKMSKeys=[],t.forEach(n.multiSelectorObj.optionList,function(e){e.selected&&n.tmpReplicationObj.sourceKMSKeys.push(e.value)})),n.nextState()):n.state===n.STEP.DESTINATION?(t.isEmpty(t.get(n.tmpReplicationObj,"Destination.replicaKmsKeyId"))||(n.tmpReplicationObj.Destination.replicaKmsKeyId=n.tmpReplicationObj.Destination.replicaKmsKeyId.trim()),C(),n.bucketSelectorObj.destinationBucket.createNewDestBucket?(s.headBucket(new d("checkBucketAvailability"),n.tmpReplicationObj.Destination.Bucket.name).then(function(){n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.exists.error")]}).catch(function(e){e.status===v.HTTP_STATUS_CODES.NOT_FOUND?n.nextState():n.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[a.instant("createbucketmodal.bucketname.exists.error")]}),n.showBucketPolicyTemplate=!1,n.showKMSPolicyTemplate=!1):(n.showBucketPolicyTemplate=n.bucketSelectorObj.isCrossAccount,n.showKMSPolicyTemplate=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&n.bucketSelectorObj.isCrossAccount,n.nextState())):n.state===n.STEP.PERMISSIONS?(n.modalInfo.modalError.saveError=null,n.copyKmsKeyPolicyFinished={flag:null},n.copyBucketPolicyFinished={flag:null},n.nextState()):n.nextState()},n.checkInputPrefix=function(e){e!==n.selectedRule.ruleObj.Prefix&&(n.modalInfo.prefixList.indexOf(e)>-1?n.modalInfo.modalError.inputPrefixError=a.instant("replicationmodal.existprefixwarning"):n.modalInfo.modalError.inputPrefixError=null)},n.resetInputPrefixError=function(){n.modalInfo.modalError.inputPrefixError=null},n.closeReplicationModal=function(){n.selectedRule.flag=!1,n.selectedRule.ruleObj={},n.modalInfo.isOpen={flag:!1},n.modalInfo.isEntireBucket=n.replicationObj.globalSettings.isEntireBucket,n.modalInfo.modalError.saveError=null,n.modalInfo.modalError.inputPrefixError=null,n.modalInfo.modalError.sourceVersioning=null,n.modalInfo.modalError.listRoleError=null,S.bodyFreezeScroll(!1),n.modalInfo.prefixOrWholeBucket=n.replicationObj.globalSettings.isEntireBucket?t.find(n.modalInfo.prefixOrWholeBucketOptions,{value:b.REPLICATION.ENTIRE_BUCKET}):t.find(n.modalInfo.prefixOrWholeBucketOptions,{value:b.REPLICATION.PREFIX}),n.modalInfo.isOverride&&(I(),m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.isEditing=!1,n.modalInfo.isOverride=!1,n.modalInfo.isAdd=!1),n.state=n.STEP.SOURCE},n.enableSourceVersioning=function(){n.modalInfo.modalError.sourceVersioning=null,n.isEnablingSourceVersioning=!0;var e=new d("enableBucketVersioning");l.enableBucketVersioning(n.replicationObj.globalSettings.sourceBucket.name,e).then(function(){E.log("CRR_enableBucketVersioning",1,e),n.modalState.showSourceVersioningWarning=!1,n.modalState.showNext=!0}).catch(function(t){E.log("CRR_enableBucketVersioning",0,e),n.modalState.showSourceVersioningWarning=!0,n.modalInfo.modalError.sourceVersioning=t}).finally(function(){n.isEnablingSourceVersioning=!1})},n.enableDestinationVersioning=function(){m.enableDestinationVersioning(n.isEnablingDestinationVersioning,n.bucketSelectorObj,n.modalState)},n.$watch("bucketSelectorObj.destinationBucket.name",function(e,r){n.modalInfo.isEditing&&e!==r?(n.bucketSelectorObj.destinationBucket.Errors={},n.modalInfo.modalError.saveError=null,n.showBucketPolicyTemplate=n.bucketSelectorObj.isCrossAccount,n.showKMSPolicyTemplate=t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&n.bucketSelectorObj.isCrossAccount):y.isFeatureEnabled(v.FAC.CRR_KMS)&&!n.modalInfo.isEditing&&e&&!n.bucketSelectorObj.isCrossAccount&&t.get(n.tmpReplicationObj,"Destination.isKmsEncryption",!1)&&!t.get(n.bucketSelectorObj,"destinationBucket.createNewDestBucket",!1)&&_(e)}),n.$watch("bucketSelectorObj.destinationBucket.region",function(e){y.isFeatureEnabled(v.FAC.CRR_KMS)&&t.get(n.bucketSelectorObj,"destinationBucket.createNewDestBucket")&&!t.isEmpty(e)&&_(null,e.value)}),n.$watch("selectedRule.flag",function(e){!0===e&&(m.initBucketSelector(n.bucketSelectorObj,n.replicationObj),n.modalInfo.modalError.saveError=null)}),n.$watch("bucketSelectorObj.isCrossAccount",function(e,t){e===t||e||(n.tmpReplicationObj.Destination.isAccessControlTranslation=!1)}),n.$watch("bucketSelectorObj.destinationBucket.accountId",function(e){n.showAccountIdTextField=t.isEmpty(e)}),n.resetAccountIdError=function(){n.accountIdError=null},n.checkAccountId=function(e){e.text=e.text.trim(),t.isEmpty(e.text)||null===e.text.match(/^[0-9]+$/)?n.accountIdError=a.instant("bucketselector.invalidaccountid"):n.accountIdError=null},n.resetStorageClassValue=function(){n.tmpReplicationObj.Destination.StorageClass={value:null,text:n.modalInfo.storageTextMapping[v.STORAGE_CLASSES.DEFAULT]}},n.updateStorageClassText=function(e){n.modalInfo.storageTextMapping&&e&&(n.tmpReplicationObj.Destination.StorageClass.text=n.modalInfo.storageTextMapping[e])},n.copyPolicyToClipboard=function(e,t){S.copyDataToClipboard(e,t)},n.scrollIntoView=function(e){S.scrollCardToView(e)},n.savePressed=function(){var e=new d("CRR_saveReplication");n.isSaving={flag:!0},m.saveReplication(n.isSaving,n.tmpReplicationObj,n.bucketSelectorObj,n.modalInfo,n.replicationObj,function(t){w(),m.updateCRRTableAfterPut(n.modalInfo,n.replicationObj,n.tmpReplicationObj,t,e).then(function(){n.replicationObj.errorMessage="",n.replicationObj.successMessage={detail:n.modalInfo.isAdd?a.instant(""):""}}).catch(function(e){n.replicationObj.errorMessage=e,n.replicationObj.successMessage=null}).finally(function(){n.bucketSelectorObj.destinationBucket.Errors={},n.modalInfo.isEditing=!1,n.closeReplicationModal()})},function(e){n.modalInfo.modalError.saveError=e;var t=r(".replication-modal .modal-body");o(function(){t.animate({scrollTop:r(".crr-save-error").offset().top-t.offset().top+t.scrollTop()})},50)},n.crrWithObjectLockEnabled())},n.crrWithObjectLockEnabled=function(){return!(!y.isFeatureEnabled(v.FAC.CRR_WITH_OBJECT_LOCK)||!n.currentBucketRetention)},n.policyEditorLoaded=function(e){var t=S.getBucketARN(n.tmpReplicationObj.Destination.Bucket.name),r=""+S.getIamARNPrefix()+S.getUserAccountId()+":root";n.tmpReplicationObj.Destination.isAccessControlTranslation||"false"===n.tmpReplicationObj.isEntireBucket&&(n.replicationObj.globalSettings.accessControlTranslationIds.length>1||1===n.replicationObj.globalSettings.accessControlTranslationIds.length&&-1===n.replicationObj.globalSettings.accessControlTranslationIds.indexOf(n.tmpReplicationObj.ID))?n.crrBucketPolicy=u.generateBucketPolicyWithArn(t,r,b.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):n.crrBucketPolicy=u.generateBucketPolicyWithArn(t,r,b.CRR_BUCKET_POLICY_TEMPLATE),e.getSession().getDocument().setValue(n.crrBucketPolicy)},n.kmsKeyPolicyEditorLoaded=function(e){n.crrKmsKeyPolicy=JSON.stringify(b.KMS_KEY_POLICY,null,"    ").replace(/SOURCE_ACCOUNT_ID/g,S.getUserAccountId()),e.getSession().getDocument().setValue(n.crrKmsKeyPolicy)}}e.module("s3").directive("crrGlobalSettingsWrapper",[function(){return{restrict:"E",scope:{modalInfo:"=",replicationObj:"=",selectedRule:"=",disabled:"=",currentBucketRetention:"="},template:n(777),controller:"CrrGlobalSettingsWrapperController"}}]),e.module("s3").controller("CrrGlobalSettingsWrapperController",["$scope","$q","$translate","$timeout","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPolicyService","ConsoleOperation","IAMService","IAMPropertiesService","KMSPropertiesService","ReplicationUtilService","Region","ReplicationConstants","S3Constants","SCLogService","UtilService","FAC","PathService",i])}()}).call(t,n(0),n(2),n(6))},function(e,t){e.exports="<crr-global-settings ng-if=modalInfo.flag bucket-selector-obj=bucketSelectorObj replication-obj=replicationObj tmp-replication-obj=tmpReplicationObj modal-info=modalInfo selected-rule=selectedRule multi-selector-obj=multiSelectorObj disabled=disabled current-bucket-retention=currentBucketRetention></crr-global-settings>"},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").constant("InventoryConstants",{CREATE_BUCKET_CARD:"create-bucket-reports-card",FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",ONETIME:"ONE-TIME"},ACTION:{ENABLE:"ENABLE",DISABLE:"DISABLE"},VERSIONING:{ALL:"All",CURRENT:"Current"},TYPE:{OBJECT:"OBJECT"},REPORT_FORMAT:{CSV:"CSV",ORC:"ORC",PARQUET:"Parquet"},SSE_S3:"SSE-S3",SSE_KMS:"SSE-KMS"})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l){function u(){e.modalInfo.sourceAccountId=null,e.modalInfo.bucketPolicyError=null,e.modalInfo.versioningError=null,e.modalInfo.isRogueActorEnabled=!0,e.modalInfo.isVersioningEnabled=!1,e.modalInfo.crrBucketPolicy=null,e.modalInfo.crrKmsKeyPolicy=null,e.copyBucketPolicyFinished={flag:null},e.modalInfo.isLoading={versioning:!1,bucketPolicy:!1,getVersioning:!1}}function d(){return!e.modalInfo.sourceAccountId||(e.modalInfo.sourceAccountId=e.modalInfo.sourceAccountId.trim(),t.isEmpty(e.modalInfo.sourceAccountId)||null!==e.modalInfo.sourceAccountId.match(/^[0-9]+$/))}e.copyBucketPolicyFinished={flag:null},e.copyKmsPolicyFinished={flag:null},e.docLink=e.docLink=r.getDocUrl(c.LEARN_MORE_LINKS.CRR_KMS),function(){u(),e.modalInfo.isLoading.getVersioning=!0,i.getBucketVersioning(e.replicationObj.globalSettings.sourceBucket.name,new a("CRR_ReceiveObjectModal_VersioningOperation"),!1).then(function(t){e.modalInfo.isVersioningEnabled=t===c.BUCKET_PROPERTIES.VERSIONING.ENABLED,e.modalInfo.versioningError=null}).catch(function(t){e.modalInfo.versioningError=l.handleErrors(t)}).finally(function(){e.modalInfo.isLoading.getVersioning=!1})}(),e.copyBucketPolicyToClipboard=function(t){l.copyDataToClipboard(e.modalInfo.crrBucketPolicy,t)},e.copyKMSPolicyToClipboard=function(t){l.copyDataToClipboard(e.modalInfo.crrKmsKeyPolicy,t)},e.bucketPolicyEditorLoaded=function(t){e.modalInfo.bucketEditor=t,e.modalInfo.crrBucketPolicy=o.generateBucketPolicyForCRR(e.replicationObj.globalSettings.sourceBucket.name,e.modalInfo.isRogueActorEnabled,e.modalInfo.sourceAccountId),t.getSession().getDocument().setValue(e.modalInfo.crrBucketPolicy)},e.updateEditor=function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];e.modalInfo.sourceAccountId&&(e.modalInfo.sourceAccountId=e.modalInfo.sourceAccountId.trim()),e.modalInfo.bucketEditor&&e.bucketPolicyEditorLoaded(e.modalInfo.bucketEditor),e.modalInfo.kmsEditor&&!t&&e.kmsPolicyEditorLoaded(e.modalInfo.kmsEditor),d()||(e.accountIdError=n.instant("bucketselector.invalidaccountid"))},e.kmsPolicyEditorLoaded=function(t){e.modalInfo.kmsEditor=t,e.modalInfo.crrKmsKeyPolicy=JSON.stringify(s.KMS_KEY_POLICY,null,"    "),e.modalInfo.sourceAccountId&&(e.modalInfo.crrKmsKeyPolicy=e.modalInfo.crrKmsKeyPolicy.replace(/SOURCE_ACCOUNT_ID/g,e.modalInfo.sourceAccountId)),t.getSession().getDocument().setValue(e.modalInfo.crrKmsKeyPolicy)},e.enableBucketVersion=function(){if(!e.modalInfo.isVersioningEnabled){e.modalInfo.isLoading.versioning=!0;var t=new a("CRR_receiveObjectModalOperation");i.enableBucketVersioning(e.replicationObj.globalSettings.sourceBucket.name,t).then(function(){e.modalInfo.isVersioningEnabled=!0,e.modalInfo.versioningError=null}).catch(function(t){e.modalInfo.isVersioningEnabled=!1,e.modalInfo.versioningError=l.handleErrors(t)}).finally(function(){e.modalInfo.isLoading.versioning=!1})}},e.scrollIntoView=function(e){l.scrollCardToView(e)},e.updateBucketPolicy=function(){if(d()){e.modalInfo.isLoading.bucketPolicy=!0;var t=new a("CRR_receiveObjectModalOperation");o.updateBucketPolicyForCRR(e.replicationObj.globalSettings.sourceBucket.name,e.modalInfo,t).then(function(){e.modalInfo.bucketPolicyError=null}).catch(function(t){e.modalInfo.bucketPolicyError=l.handleErrors(t)}).finally(function(){e.modalInfo.isLoading.bucketPolicy=!1})}},e.resetAccountIdError=function(){e.accountIdError=null},e.closeReceiveObjectsModal=function(){e.modalInfo.isOpen={flag:!1},u()}}e.module("s3").directive("crrReceiveObjectModal",[function(){return{restrict:"E",scope:{modalInfo:"=",replicationObj:"="},template:n(780),controller:"CrrReceiveObjectModalController"}}]),e.module("s3").controller("CrrReceiveObjectModalController",["$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","ReplicationUtilService","ReplicationConstants","S3Constants","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<dialog-modal class=receive-object-modal is-open=modalInfo.isOpen close-callback=closeReceiveObjectsModal header-title=modalInfo.title> <dialog-modal-content> <div class=modal-section> <p class=section-text translate=receiveobjectsmodal.sourceaccountid></p> <awsui-control-group validation-message={{accountIdError}}> <awsui-textfield ng-model=modalInfo.sourceAccountId ng-keydown=resetAccountIdError() placeholder="{{ \'receiveobjectsmodal.sourceaccountidplaceholder\' | translate}}" class=accountid-input blur=updateEditor()></awsui-textfield> </awsui-control-group> </div> <div class=modal-content-divider></div> <div class=modal-section> <div class=section-title translate=receiveobjectsmodal.bucketversioningtitle></div> <awsui-button ng-if="!modalInfo.isVersioningEnabled &&  !modalInfo.isLoading.versioning && !modalInfo.isLoading.getVersioning" click=enableBucketVersion() variant=primary loading=modalInfo.isLoading.versioning text="{{ \'receiveobjectsmodal.enableversioning\' | translate }}" class="awsui-util-f-r primary-button dark enable-versioning-button"> </awsui-button> <span ng-if="modalInfo.isVersioningEnabled && !modalInfo.isLoading.versioning" class="awsui-icon alert-check-circle float-to-right"></span> <span ng-if=modalInfo.isLoading.getVersioning class="awsui-spinner awsui-spinner-light float-to-right"></span> <p class=section-text translate=receiveobjectsmodal.bucketversioningtext></p> <awsui-alert type=warning header="{{\'error.header\'|translate}}" ng-if=modalInfo.versioningError>{{modalInfo.versioningError}} </awsui-alert> </div> <div class=modal-content-divider></div> <div class=modal-section> <awsui-button data-disabled="!modalInfo.sourceAccountId || accountIdError" click=updateBucketPolicy() variant=primary loading=modalInfo.isLoading.bucketPolicy text="{{ \'receiveobjectsmodal.applysettings\' | translate }}" class="awsui-util-f-r primary-button dark"> </awsui-button> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class=dark ng-click="copyBucketPolicyToClipboard( copyBucketPolicyFinished)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-copied-msg\' : copyBucketPolicyFinished.flag === null}" translate=copytoclipboard.path></span> </div> <awsui-expandable-section id=expand-bucket-policy class="dark content-section expand-section" header="{{ \'receiveobjectsmodal.bucketpolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-bucket-policy\')"> <awsui-checkbox class=rogueactor-checkboxtext checked=modalInfo.isRogueActorEnabled ng-model=modalInfo.isRogueActorEnabled ng-change=updateEditor(true)> <span translate=receiveobjectsmodal.enablerogueactortext></span> </awsui-checkbox> <div class=crr-modal-bucketpolicy-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: bucketPolicyEditorLoaded}" class=code readonly=true></div> <div class=section-text translate=receiveobjectsmodal.bucketpolicy></div> </awsui-expandable-section> <awsui-alert type=warning header="{{\'error.header\'|translate}}" ng-if=modalInfo.bucketPolicyError>{{modalInfo.bucketPolicyError}} </awsui-alert> </div> <div class=modal-content-divider fac-id=s3-crr-kms></div> <div class=modal-section fac-id=s3-crr-kms> <div class=copy-message> <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant=link class="dark crr-copy-button" ng-click="copyKMSPolicyToClipboard( copyKmsPolicyFinished)"></awsui-button> <span class=copied-msg ng-class="{ \'fade-in\' : copyKmsPolicyFinished.flag === true, \'fade-out\' : copyKmsPolicyFinished.flag === false, \'hide-copied-msg\' : copyKmsPolicyFinished.flag === null}" translate=copytoclipboard.path></span> </div> <awsui-expandable-section id=expand-kms-policy class="dark content-section expand-section" header="{{ \'receiveobjectsmodal.kmskeypolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-kms-policy\')"> <div class=crr-modal-kmskey-editor ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsPolicyEditorLoaded}" class=code readonly=true></div> <p class=section-text><span translate=replicationmodal.permissionstep.kmskeypolicytext></span><a target=_blank href={{docLink}} translate>learn.more</a></p> </awsui-expandable-section> </div> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=crr-confirmation-cancel text="{{ \'receiveobjectsmodal.cancel\' | translate }}" variant=normal click=closeReceiveObjectsModal()></awsui-button> </dialog-modal-footer> </dialog-modal>'},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").constant("ReplicationConstants",{CRR_BUCKET_POLICY_TEMPLATE:{Version:"2008-10-17",Id:"S3-Console-Replication-Policy",Statement:[{Sid:"S3ReplicationPolicyStmt1",Effect:"Allow",Principal:{AWS:"IAM_ARN"},Action:["s3:GetBucketVersioning","s3:PutBucketVersioning","s3:ReplicateObject","s3:ReplicateDelete"],Resource:["DESTINATION_BUCKET_ARN","DESTINATION_BUCKET_ARN/*"]}]},CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR:{Version:"2008-10-17",Id:"S3-Console-Replication-Policy",Statement:[{Sid:"S3ReplicationPolicyStmt1",Effect:"Allow",Principal:{AWS:"IAM_ARN"},Action:["s3:GetBucketVersioning","s3:PutBucketVersioning","s3:ReplicateObject","s3:ReplicateDelete","s3:ObjectOwnerOverrideToBucketOwner"],Resource:["DESTINATION_BUCKET_ARN","DESTINATION_BUCKET_ARN/*"]}]},IAM_TEMPLATE_TYPE:{BASIC:"basic",ROGUE_ACTOR:"rogue_actor",KMS:"kms",ROGUE_ACTOR_KMS:"rogue_actor_kms"},IAM_POLICY_TEMPLATE_PREFIX:{PUBLIC:"",CN:"cn_",GOV:"gov_"},IAM_POLICY_TEMPLATE:{basic:{type:"basic",name:"s3console_crr_iam_template",versionNum:"2"},rogue_actor:{type:"rogue_actor",name:"s3console_crr_iam_template",versionNum:"4"},kms:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"2"},kms_v3:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"3"},rogue_actor_kms:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"2"},rogue_actor_kms_v3:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"3"},cn_basic:{type:"basic",name:"s3console_crr_iam_template_v1",versionNum:"1"},cn_rogue_actor:{type:"rogue_actor",name:"s3console_crr_iam_template_v2",versionNum:"1"},cn_kms:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"2"},cn_kms_v3:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"3"},cn_rogue_actor_kms:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"2"},cn_rogue_actor_kms_v3:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"3"},gov_basic:{type:"basic",name:"s3console_crr_iam_template_v1",versionNum:"1"},gov_rogue_actor:{type:"rogue_actor",name:"s3console_crr_iam_template_v2",versionNum:"1"},gov_kms:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"1"},gov_kms_v3:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"2"},gov_rogue_actor_kms:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"1"},gov_rogue_actor_kms_v3:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"2"}},REPLICATION:{ENABLED:"Enabled",DISABLED:"Disabled",ENABLED_ALL:"enabledAll",DISABLED_ALL:"disabledAll",DELETE_ALL:"deleteAll",DELETE_RULE:"deleteRule",UPGRADE_SCHEMA:"upgradeSchema",CONFIGNOTFOUND:"The replication configuration was not found",NEWROLE:"newrole",ENTIRE_BUCKET:"entireBucket",PREFIX:"prefix",RECEIVE_OBJECTS:"receiveObjects"},ERROR_CODE:{ENTITY_EXIST:"EntityAlreadyExists",ACCESS_DENIED:"AccessDenied",LIMIT_EXCEED:"LimitExceeded",VALIDATION_ERROR:"validation error"},KMS_KEY_POLICY:{Sid:"Enable cross account encrypt access for S3 Cross Region Replication",Effect:"Allow",Principal:{AWS:"SOURCE_ACCOUNT_ID"},Action:["kms:Encrypt"],Resource:"*"}})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){e.module("s3").service("ReplicationUtilService",["$q","$translate","$timeout","APIProxyService","IAMPropertiesService","KMSPropertiesService","XMLParser","BucketPropertiesService","BucketPolicyService","CachingService","ConsoleOperation","Region","ReplicationConstants","S3Constants","SCLogService","UtilService","AwsUrlsService","FAC",function(e,r,i,a,o,s,c,l,u,d,p,f,g,m,h,b,v,E){function S(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n={Destination:{Bucket:{name:e.Destination.Bucket.name}},sourceKMSKeys:[]};return y(n,e,t),n}function y(e,n){var r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];e.Status=n.Status,e.Prefix=n.Prefix,e.name=n.name,e.Priority=n.Priority,e.Filter=n.Filter,e.filters=n.filters,e.ID=n.ID,t.isEmpty(t.get(n,"Destination.StorageClass.value"))?(delete e.Destination.StorageClass,e.Destination.changeDefaultStorageClass=!1):(e.Destination.StorageClass={value:n.Destination.StorageClass.value},e.Destination.changeDefaultStorageClass=!0),t.get(n,"Destination.isAccessControlTranslation",!1)&&!t.isEmpty(r)?(e.Destination.AccessControlTranslation={Owner:"Destination"},e.Destination.Account=r):(e.Destination.isAccessControlTranslation=!1,delete e.Destination.AccessControlTranslation);var i=t.get(n,"Destination.replicaKmsKeyId");t.get(n,"Destination.isKmsEncryption",!1)&&!t.isEmpty(i)?(e.Destination.EncryptionConfiguration={ReplicaKmsKeyID:i},e.SourceSelectionCriteria={SseKmsEncryptedObjects:{Status:"Enabled"}}):(delete e.SourceSelectionCriteria,e.Destination.isKmsEncryption=!1,e.Destination.replicaKmsKeyId=null,delete e.Destination.EncryptionConfiguration),n.sourceKMSKeys&&n.sourceKMSKeys.length>0&&(e.sourceKMSKeys=[],t.forEach(n.sourceKMSKeys,function(t){e.sourceKMSKeys.push(t)})),t.isEmpty(r)&&(e.Destination.Account=null)}function A(e,n,r,i){var a=arguments.length<=4||void 0===arguments[4]?-1:arguments[4],o={},s=t.get(i,"Destination.Account");if(o.destinationBucket=i.Destination.Bucket.name,o.destAccountId=s,o.role=n.value,o.name=i.name,o.Priority=i.Priority,o.ID=i.ID,o.rules=t.cloneDeep(r),e)o.rules.push(S(i,o.destAccountId)),X(o)&&Q(o.rules);else if(a<=-1){var c=t.findIndex(o.rules,{ID:i.originalID||i.ID});if(c>-1){var l=o.rules[c];y(l,i,o.destAccountId)}}else a>-1&&o.rules.splice(a,1);return o}function C(e,n,r){e.globalSettings.Role={text:t.last(n.role.split("/")),value:n.role},e.ruleSettings.Rule=[].concat(n.rules),e.globalSettings.destinationBucket={name:n.destinationBucket,region:null},e.globalSettings.destAccountId=n.destAccountId,e.globalSettings.accessControlTranslationIds.length=0,e.globalSettings.kmsEncryptionIds={},t.forEach(e.ruleSettings.Rule,function(n){if(n.Destination.Bucket={name:e.globalSettings.destinationBucket.name,region:null},l.getBucketRegion(e.globalSettings.destinationBucket.name).then(function(t){e.globalSettings.destinationBucket.region=t.text,n.Destination.Bucket.region=t.text}),n.Destination.changeDefaultStorageClass?n.Destination.StorageClass={value:n.Destination.StorageClass.value,text:r[n.Destination.StorageClass.value]}:n.Destination.StorageClass={value:null,text:r[m.STORAGE_CLASSES.DEFAULT]},e.globalSettings.destAccountId&&(n.Destination.Account=e.globalSettings.destAccountId),"Destination"===t.get(n,"Destination.AccessControlTranslation.Owner","")&&(n.Destination.isAccessControlTranslation=!t.isEmpty(e.globalSettings.destAccountId),e.globalSettings.accessControlTranslationIds.push(n.ID)),"Enabled"===t.get(n,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")){n.Destination.isKmsEncryption=!0;var i=t.get(n,"Destination.EncryptionConfiguration.ReplicaKmsKeyID");n.Destination.replicaKmsKeyId=i,e.globalSettings.kmsEncryptionIds[n.ID]=i}else n.Destination.isKmsEncryption=!1,n.Destination.replicaKmsKeyId=null,delete e.globalSettings.kmsEncryptionIds[n.ID];n.Prefix=t.isEmpty(n.Prefix)?"":n.Prefix,n.isEntireBucket=t.isEmpty(n.Prefix).toString()})}function _(e,n){e.isCrossAccount=!1,e.bucketListCurrAccount=[],e.sourceBucket=n.globalSettings.sourceBucket.name,e.sourceRegion=n.globalSettings.sourceBucket.region,e.destinationBucket={name:null,region:null,versioningEnabled:null,createNewDestBucket:!1,bucketNameValidationErrors:[]},e.destinationBucket.Errors={},t.isEmpty(n.globalSettings.destinationBucket.name)||(e.destinationBucket.name=n.globalSettings.destinationBucket.name,e.destinationBucket.region=n.globalSettings.destinationBucket.region),t.isEmpty(n.globalSettings.destAccountId)||(e.destinationBucket.accountId=n.globalSettings.destAccountId)}function w(e,t){e.globalSettings.sourceKmsKeysObj.initialized?W(e.globalSettings.selectedSourceKmsKeys,e,t):(t.isLoadingData=!1,t.errorMsg=null,t.initialized=!1,t.optionList.length=0,t.totalSelectedCount=0)}function T(e,n,r){n.Destination={Bucket:t.cloneDeep(e.globalSettings.destinationBucket),StorageClass:{value:null,text:r[m.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:!1},n.ID=null,n.Prefix=null,n.name=null,n.priority=null,n.Status=g.REPLICATION.ENABLED,n.isEntireBucket=e.globalSettings.isEntireBucket.toString(),n.Role={text:e.globalSettings.Role.text,value:e.globalSettings.Role.value}}function R(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=arguments.length<=4||void 0===arguments[4]?null:arguments[4];e.flag=!0;var a=new p("enableBucketVersioning");t&&t.destinationBucket&&l.enableBucketVersioning(t.destinationBucket.name,a).then(function(){h.log("CRR_enableBucketVersioning",1,a),t.destinationBucket.versioningEnabled=!0,t.destinationBucket.Errors.getVersioningError=null,t.destinationBucket.Errors.enabledVersioningError=null,r?i():n&&(n.showNext=!0)}).catch(function(e){h.log("CRR_enableBucketVersioning",0,a),t.destinationBucket.versioningEnabled=null,t.destinationBucket.Errors.getVersioningError=null,t.destinationBucket.Errors.enabledVersioningError=e}).finally(function(){e.flag=!1})}function O(e,t,n,r){var i={};if(i.sourceBucket=e,i.destinationBucket=t,i.isExistingRole=n.value!==g.REPLICATION.NEWROLE,i.isExistingRole)i.roleName=n.text;else{var a="s3crr_role_for_"+i.sourceBucket+"_to_"+i.destinationBucket;i.roleName=a.length>m.ENTITY_MAX_LENGTH.ROLE?a.substr(0,m.ENTITY_MAX_LENGTH.ROLE):a}var o=void 0;o=r===g.IAM_TEMPLATE_TYPE.BASIC||r===g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR?"s3crr_for_"+i.sourceBucket+"_to_"+i.destinationBucket:"s3crr_"+r+"_for_"+i.sourceBucket+"_to_"+i.destinationBucket,i.rolePolicy=o.length>m.ENTITY_MAX_LENGTH.POLICY?o.substr(0,m.ENTITY_MAX_LENGTH.POLICY):o;var s=b.getCloudSystem();return i.templateObj=g.IAM_POLICY_TEMPLATE[g.IAM_POLICY_TEMPLATE_PREFIX[s]+r],i}function k(e){return e.substring(e.lastIndexOf(":")+1)}function I(t,n,r){return t.currTimes=t.currTimes+1,l.enableBucketVersioning(n,r).then(function(){return e.when()}).catch(function(a){var o=b.handleErrors(a);return t.currTimes<=t.maxTimes&&o===m.STATUS_CODE_MAP[m.HTTP_STATUS_CODES.NOT_FOUND]?i(function(){return I(t,n,r)},t.timeInterval):e.reject(o)})}function P(t,n,r,i,o,s,c,l){var u=new p("createBucketEnablingVersioning");return a.createBucket(u,t,n,l).then(function(){return h.log("CRR_createBucket",1,u,{bucketName:t,region:n}),d.evictLamb(),s.destinationBucket.createNewDestBucket=!1,I({currTimes:0,maxTimes:3,timeInterval:6e3},t,new p("enableBucketVersioning"))}).then(function(){return h.log("CRR_enableBucketVersioning",1,u,{bucketName:t,region:n}),c?c(t,i,o,r):e.when()}).catch(function(r){return h.log("CRR_createBucketAndEnableVersioningVersioning",0,u,{bucketName:t,region:n}),e.reject(r)})}function N(e){var n=[];return e&&t.forEach(e,function(e){if(e&&t.isString(e)){var r=e.split(""+b.getKmsARNPrefix());2===r.length&&n.push(r[1])}}),n}function M(n,i,a,o,s,c){var l=arguments.length<=6||void 0===arguments[6]?null:arguments[6],u=arguments.length<=7||void 0===arguments[7]?null:arguments[7],d=new p("createIAMRole"),E={};if(n.templateObj.type===g.IAM_TEMPLATE_TYPE.KMS||n.templateObj.type===g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS)if(E.SrcBucketName=n.sourceBucket,E.DstBucketName=n.destinationBucket,E.SrcRegion=f.twoWayMapping[o.globalSettings.sourceBucket.region],E.DstRegion=f.twoWayMapping[s.Destination.Bucket.region],a.isEditing)E.ListOfSourceKMSKeys=N(o.globalSettings.selectedSourceKmsKeys),E.ListOfDestinationKMSKeys=t.unique(t.values(o.globalSettings.kmsEncryptionIds));else{if(E.ListOfSourceKMSKeys=N(s.sourceKMSKeys),u)E.ListOfDestinationKMSKeys=N(u);else{var S=t.clone(o.globalSettings.kmsEncryptionIds);S[s.ID]=s.Destination.replicaKmsKeyId,E.ListOfDestinationKMSKeys=N(t.unique(t.values(S)))}if(0===t.get(E,"ListOfSourceKMSKeys",[]).length||0===t.get(E,"ListOfDestinationKMSKeys",[]).length)return e.when()}else E.srcbucket=n.sourceBucket,E.dstbucket=n.destinationBucket;return b.createOrUpdateRoleForReplication(n.roleName,n.rolePolicy,E,n.isExistingRole,n.templateObj).then(function(e){var t=void 0;return c&&(t=c(e,!0)),h.log("CRR_createOrUpdateRole",1,d),t}).catch(function(i){var a=void 0;if(c&&(a=c(null,!1)),h.log("CRR_createOrUpdateRole",0,d),t.includes(["AccessDenied","MalformedInput"],t.get(i,"response.Error.Code"))){var s=n.roleName,l=m.IAM_ENDPOINT_MAPPING[b.getCloudSystem()],u=v.getConsoleServiceUrl("iam",l,"#/roles/"+s),p=v.getDocUrl(m.LEARN_MORE_LINKS.CRR_IAM_ROLE_SETUP);return o.warningMessage={params:{roleName:s,roleLink:u,learnMore:r.instant("learn.more"),learnMoreLink:p}},a}return o.warningMessage=void 0,e.reject(b.handleErrors(i))}).then(function(t){return i?i(t,a,o,s):l?e.when(l):e.when(t)})}function L(e,n,r,i,a){var o=arguments.length<=5||void 0===arguments[5]?null:arguments[5],s=void 0;return s=r.isEditing?O(a.globalSettings.sourceBucket.name,i,n.Role,D(a)):O(a.globalSettings.sourceBucket.name,i,n.Role,x(n,a)),M(s,e,r,a,n,function(e,i){if(i){var a=void 0;return!s.isExistingRole&&e?(a={text:t.last(e.split("/")),value:e},n.Role.text=a.text,n.Role.value=a.value,-1===t.findIndex(r.iamRoles,{value:a.value})&&r.iamRoles.push(a)):a=n.Role,a}return t.clone(n.Role)},o)}function x(e,t){var n=void 0,r=void 0;return"true"!==e.isEntireBucket?(n=e.Destination.isAccessControlTranslation||t.globalSettings.accessControlTranslationIds.length>1||1===t.globalSettings.accessControlTranslationIds.length&&-1===t.globalSettings.accessControlTranslationIds.indexOf(e.ID),r=e.Destination.isKmsEncryption||Object.keys(t.globalSettings.kmsEncryptionIds).length>1||1===Object.keys(t.globalSettings.kmsEncryptionIds).length&&-1===Object.keys(t.globalSettings.kmsEncryptionIds).indexOf(e.ID)):(n=e.Destination.isAccessControlTranslation,r=e.Destination.isKmsEncryption),j(r,n)}function D(e){var n=t.get(e,"globalSettings.accessControlTranslationIds",[]).length>0;return j(t.values(t.get(e,"globalSettings.kmsEncryptionIds",{})).length>0,n)}function j(e,t){if(e){var n=t?g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS:g.IAM_TEMPLATE_TYPE.KMS;return E.isFeatureEnabled(m.FAC.CRR_KMS_TEMPLATE_V3)&&(n+="_v3"),n}return t?g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR:g.IAM_TEMPLATE_TYPE.BASIC}function B(n,r,i,a,o){var s=arguments.length<=5||void 0===arguments[5]?null:arguments[5],c=new p("putBucketReplication"),u=t.isEmpty(i.ruleSettings.Rule)?[]:t.cloneDeep(i.ruleSettings.Rule),d=r.isOverride?t.isEmpty(a.ID):r.isAdd,f=void 0;return r.isEditing?(f={},f.destAccountId=a.Destination.Account,f.destinationBucket=a.Destination.Bucket.name,f.role=n.value,f.rules=[].concat(i.ruleSettings.Rule),a.sourceKMSKeys=t.get(i,"globalSettings.selectedSourceKmsKeys",[])):f=A(d,n,u,a),l.putBucketReplication(i.globalSettings.sourceBucket.name,c,f,void 0,X(i)||X(f)).then(function(){return h.log("CRR_putBucketReplication",1,c),s?s(null,a,r,o,i,f):e.when(f)}).catch(function(t){return h.log("CRR_putBucketReplication",0,c),e.reject(b.handleErrors(t))})}function F(n,i,a,o,s){return a.Destination.isKmsEncryption?(i.globalSettings.selectedSourceKmsKeys.length=0,t.forEach(a.sourceKMSKeys,function(e){i.globalSettings.selectedSourceKmsKeys.push(e)})):n.isOverride&&(i.globalSettings.selectedSourceKmsKeys.length=0),l.getBucketReplication(i.globalSettings.sourceBucket.name,s).then(function(a){var o=a.response;h.log("CRR_getBucketReplication",1,s);var u=c.convertXmlStringToJson(o).ReplicationConfiguration;return i.globalSettings.Role=t.isEmpty(u.Role)?"":{text:t.last(u.Role.split("/")),value:u.Role},i.ruleSettings.Rule=[].concat(u.Rule),i.globalSettings.accessControlTranslationIds.length=0,i.globalSettings.kmsEncryptionIds={},t.forEach(i.ruleSettings.Rule,function(e){var a=k(e.Destination.Bucket);e.Destination.Bucket={name:a,region:null},i.globalSettings.destinationBucket.name=a,l.getBucketRegion(a).then(function(t){e.Destination.Bucket.region=t.text,i.globalSettings.destinationBucket.region=t.text}).catch(function(t){e.Destination.Bucket.region=null,i.globalSettings.destinationBucket.region=null,t.status===m.HTTP_STATUS_CODES.NOT_FOUND?i.errorMessage=r.instant("crr.error.destinationbucketdoesnotexist"):i.errorMessage=b.handleErrors(t)}),t.get(e,"Destination.Account")&&(i.globalSettings.destAccountId=e.Destination.Account),"Destination"===t.get(e,"Destination.AccessControlTranslation.Owner","")&&(e.Destination.isAccessControlTranslation=!0,i.globalSettings.accessControlTranslationIds.push(e.ID));var o=t.get(e,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");"Enabled"!==t.get(e,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")||t.isEmpty(o)||(e.Destination.isKmsEncryption=!0,e.Destination.replicaKmsKeyId=o,i.globalSettings.kmsEncryptionIds[e.ID]=o),e.Destination.changeDefaultStorageClass=!t.isEmpty(e.Destination.StorageClass),e.Destination.StorageClass={value:e.Destination.StorageClass,text:t.isEmpty(e.Destination.StorageClass)?n.storageTextMapping[m.STORAGE_CLASSES.DEFAULT]:n.storageTextMapping[e.Destination.StorageClass]},e.Prefix=t.isEmpty(e.Prefix)?"":e.Prefix,e.isEntireBucket=t.isEmpty(e.Prefix).toString()}),n.isEntireBucket=t.findIndex(i.ruleSettings.Rule,function(e){return t.isEmpty(e.Prefix)})>-1,i.globalSettings.isEntireBucket=n.isEntireBucket,n.prefixList=t.pluck(i.ruleSettings.Rule,"Prefix").filter(function(e){return""!==e}),e.when()}).catch(function(t){return e.reject(b.handleErrors(t))})}function U(e,n,r,i,a,o,s){var c=!(arguments.length<=7||void 0===arguments[7])&&arguments[7];e.flag=!0;var l=n.Destination.Bucket.name,u=t.isObject(n.Destination.Bucket.region)?f.twoWayMapping[n.Destination.Bucket.region.text]:f.twoWayMapping[n.Destination.Bucket.region];r&&r.destinationBucket&&r.destinationBucket.createNewDestBucket?P(l,u,n,i,a,r,K,c).then(function(e){o(e)}).catch(function(e){s(e)}).finally(function(){e.flag=!1}):V(l,a,n)?K(l,i,a,n,!0).then(function(e){o(e)}).catch(function(e){s(e)}).finally(function(){e.flag=!1}):K(l,i,a,n).then(function(e){o(e)}).catch(function(e){s(e)}).finally(function(){e.flag=!1})}function K(e,t,n,r){var i=!(arguments.length<=4||void 0===arguments[4])&&arguments[4];return r.Role.value===g.REPLICATION.NEWROLE?L(B,r,t,e,n):i?B(r.Role,t,n,r,e):B(r.Role,t,n,r,e,L)}function V(e,t,n){return e===t.globalSettings.destinationBucket.name&&n.Role.value===t.globalSettings.Role.value&&G(t,n)&&Y(t,n)}function G(e,n){var r=t.get(n,"Destination.isAccessControlTranslation",!1)&&!t.isEmpty(t.get(n,"Destination.Account"));return r&&e.globalSettings.accessControlTranslationIds.length>0||!r&&(0===e.globalSettings.accessControlTranslationIds.length||e.globalSettings.accessControlTranslationIds.filter(function(e){return e!==n.ID}).length>0)}function Y(e,n){var r=t.clone(e.globalSettings.kmsEncryptionIds),i=t.get(n,"Destination.isKmsEncryption",!1)&&!t.isEmpty(t.get(n,"Destination.replicaKmsKeyId",""));i||t.isEmpty(r[n.ID])||delete r[n.ID];var a=t.isEqual(t.unique(t.values(e.globalSettings.kmsEncryptionIds)),t.unique(t.values(r)));return(t.isEqual(n.sourceKMSKeys,e.globalSettings.selectedSourceKmsKeys)||n.sourceKMSKeys&&0===n.sourceKMSKeys.length)&&(i&&t.values(e.globalSettings.kmsEncryptionIds).indexOf(n.Destination.replicaKmsKeyId)>-1||!i&&a)}function W(e,n,r){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];i&&(n.globalSettings.selectedSourceKmsKeys.length=0),t.forEach(e,function(e){i&&n.globalSettings.selectedSourceKmsKeys.push(e);var a=t.findIndex(r.optionList,{value:e});a>-1?r.optionList[a].selected=!0:r.optionList.push({value:e,selected:!0})})}function z(r,i,a,s){if(s.getSourceKMSKeyError=null,r&&!i.initialized&&!a.globalSettings.sourceKmsKeysObj.initialized){var c=function(){var n=new p("listAttachedRolePolicies"),r=[],c=[];return i.isLoadingData=!0,t.isEmpty(t.get(a,"globalSettings.Role.text",""))?{v:e.when()}:{v:o.listAttachedRolePolicies(a.globalSettings.Role.text,n).then(function(i){var a=[];return i&&t.forEach(i,function(e){var i=e.PolicyArn,s=o.listPolicyVersions(i,n).then(function(e){var n=t.find(e,{IsDefaultVersion:!0});n&&r.push({CreateDate:n.CreateDate,PolicyArn:i,VersionId:n.VersionId})});a.push(s)}),e.all(a)}).then(function(){var i=[];return t.forEach(r,function(e){var r=o.getPolicyVersion(e.PolicyArn,e.VersionId,n).then(function(n){var r=JSON.parse(decodeURIComponent(n)),i=t.find(r.Statement,{Action:["kms:Decrypt"]}),o=t.find(r.Statement,{Action:["kms:Encrypt"]}),s=t.get(i,"Condition.StringLike",{})["kms:EncryptionContext:"+b.getPartition()+"s3:arn"],l=t.get(o,"Condition.StringLike",{})["kms:EncryptionContext:"+b.getPartition()+"s3:arn"],u=s&&s.indexOf(b.getBucketARN(a.globalSettings.sourceBucket.name)+"/*")>-1;l&&l.indexOf(b.getBucketARN(a.globalSettings.destinationBucket.name)+"/*")>-1&&u&&i&&i.Resource&&c.push({Resource:i.Resource,Arn:e.PolicyArn,VersionId:e.VersionId})});i.push(r)}),e.all(i)}).then(function(){var t=void 0;return c.length>0&&(a.globalSettings.sourceKmsKeysObj.policyDocuments=c,t=b.getKmsKeysFromIamPolicy(c),W(t,a,i,!0)),a.globalSettings.sourceKmsKeysObj.initialized=!0,e.when()}).catch(function(t){return s.getSourceKMSKeyError=t,i.isDropDownOpen=!1,e.reject(t)})}}();if("object"===(void 0===c?"undefined":n(c)))return c.v}return e.when()}function $(e,n,r){var i=void 0,a={actionsNeedToUpdate:[],resourcesNeedToUpdate:[],hasNoRequiredStatement:!0,indexOfStatement:null,effectNeedToUpdate:!1},o=""+b.getIamARNPrefix()+r.sourceAccountId+":root",s=""+b.getBucketARN(n);if(e&&e.Statement)if(i=e,t.forEach(e.Statement,function(e,n){if(a.hasNoRequiredStatement){var i=t.get(e,"Principal.AWS"),c=t.get(e,"Resource");if(c&&(t.isString(i)&&i===o||t.isArray(i)&&i.indexOf(o)>-1)){var l=c?[].concat(c):[],u=l.indexOf("*")>-1,d=l.indexOf(s)>-1,p=l.indexOf(s+"/*")>-1;(u||d||p)&&(d||u||a.resourcesNeedToUpdate.push(s),p||u||a.resourcesNeedToUpdate.push(s+"/*"),"Allow"!==e.Effect&&(a.effectNeedToUpdate=!0),e.Action=e.Action?[].concat(e.Action):[],-1===e.Action.indexOf("s3:*")&&(e.Action=[].concat(e.Action),-1===e.Action.indexOf("s3:GetBucketVersioning")&&-1===e.Action.indexOf("s3:Get*")&&a.actionsNeedToUpdate.push("s3:GetBucketVersioning"),-1===e.Action.indexOf("s3:PutBucketVersioning")&&-1===e.Action.indexOf("s3:Put*")&&a.actionsNeedToUpdate.push("s3:PutBucketVersioning"),-1===e.Action.indexOf("s3:ReplicateObject")&&a.actionsNeedToUpdate.push("s3:ReplicateObject"),-1===e.Action.indexOf("s3:ReplicateDelete")&&a.actionsNeedToUpdate.push("s3:ReplicateDelete"),r.isRogueActorEnabled&&-1===e.Action.indexOf("s3:ObjectOwnerOverrideToBucketOwner")&&a.actionsNeedToUpdate.push("s3:ObjectOwnerOverrideToBucketOwner")),a.hasNoRequiredStatement=!1,a.indexOfStatement=n)}}}),a.hasNoRequiredStatement||0!==a.actionsNeedToUpdate.length||0!==a.resourcesNeedToUpdate.length||a.effectNeedToUpdate)if(a.hasNoRequiredStatement){var c=r.isRogueActorEnabled?u.generateBucketPolicyWithArn(s,o,g.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR.Statement[0]):u.generateBucketPolicyWithArn(s,o,g.CRR_BUCKET_POLICY_TEMPLATE.Statement[0]);i.Statement.push(JSON.parse(c))}else a.effectNeedToUpdate&&(i.Statement[a.indexOfStatement].Effect="Allow"),null!==a.indexOfStatement&&a.actionsNeedToUpdate.length>0&&(i.Statement[a.indexOfStatement].Action=[].concat(i.Statement[a.indexOfStatement].Action),t.forEach(a.actionsNeedToUpdate,function(e){i.Statement[a.indexOfStatement].Action.push(e)})),null!==a.indexOfStatement&&a.resourcesNeedToUpdate.length>0&&(i.Statement[a.indexOfStatement].Resource=[].concat(i.Statement[a.indexOfStatement].Resource),t.forEach(a.resourcesNeedToUpdate,function(e){i.Statement[a.indexOfStatement].Resource.push(e)}));else i=null;else{var l=r.isRogueActorEnabled?u.generateBucketPolicyWithArn(s,o,g.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):u.generateBucketPolicyWithArn(s,o,g.CRR_BUCKET_POLICY_TEMPLATE);i=JSON.parse(l)}return i}function H(t,n,r){return l.getBucketPolicy(t,r,!1).then(function(i){var a=$(i,t,n);return a?l.putBucketPolicy(t,JSON.stringify(a),r).then(function(){return e.when()}).catch(function(t){return e.reject(b.handleErrors(t))}):e.when()}).catch(function(t){return e.reject(b.handleErrors(t))})}function q(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],r=e?b.getBucketARN(e):null,i=n?""+b.getIamARNPrefix()+n+":root":null;return t?u.generateBucketPolicyWithArn(r,i,g.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):u.generateBucketPolicyWithArn(r,i,g.CRR_BUCKET_POLICY_TEMPLATE)}function J(e,n){var r=void 0,i=void 0,a=0===Object.keys(n.globalSettings.kmsEncryptionIds).length,o=n.globalSettings.accessControlTranslationIds.length>0,s=e.rules.reduce(function(e,t,n){return t.Destination.isKmsEncryption&&(e[t.ID]=t.Destination.replicaKmsKeyId),e},{}),c=e.rules.reduce(function(e,t,n){return t.Destination.isAccessControlTranslation&&e.push(t.ID),e},[]);t.isEqual(t.unique(t.values(n.globalSettings.kmsEncryptionIds)),t.unique(t.values(s)))||(r=!0,a=0===Object.keys(s).length),t.isEqual(n.globalSettings.accessControlTranslationIds,c)||0!==c.length||(i=!0,o=!1);var l=void 0;(i||r)&&(a?l=o?g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR:g.IAM_TEMPLATE_TYPE.BASIC:(l=o?g.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS:g.IAM_TEMPLATE_TYPE.KMS,E.isFeatureEnabled(m.FAC.CRR_KMS_TEMPLATE_V3)&&(l+="_v3"))),t.isEmpty(l)||M(O(n.globalSettings.sourceBucket.name,n.globalSettings.destinationBucket.name,n.globalSettings.Role,l),null,{},n,{Destination:{Bucket:{region:n.globalSettings.destinationBucket.region}},sourceKMSKeys:n.globalSettings.selectedSourceKmsKeys},null,null,t.unique(t.values(s)))}function X(e){return!!E.isFeatureEnabled(m.FAC.CRR_SLICE)&&(void 0!==e.Priority||2===Z(e))}function Z(e){if(!E.isFeatureEnabled(m.FAC.CRR_SLICE))return 1;var n=e.ruleSettings?e.ruleSettings.Rule:e.rules;return void 0===n?2:t.find(n,function(e){return void 0===e.Priority})?1:2}function Q(e){Array.isArray(e)&&0!==e.length&&(e=e.sort(function(e,t){return parseInt(t.Priority,10)-parseInt(e.Priority,10)}))}return{getSchemaVersion:Z,sortRulesByPriority:Q,extractDestinationBucket:k,getUpdateReplicationObj:A,updateReplicationTable:C,handleIAMRole:O,initBucketSelector:_,initializeTmpReplicationObj:T,enableDestinationVersioning:R,createNewDestBucketRequest:P,postIAMRoleRequest:M,postCRRIAMRoleRequest:L,putCRRRequest:B,saveReplication:U,updateSourceKmsKey:W,initMultiSelector:w,updateCRRTableAfterPut:F,getSourceSelectedKMSKeys:z,generateBucketPolicyForCRR:q,updateBucketPolicyForCRR:H,updateIAMPolicyForDeletingRule:J}}])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t,r){!function(){function i(e,n,i,a,o,s,c,l,u,d,p,f,g,m,h,b){function v(){d.isFeatureEnabled(m.FAC.CRR)&&(n.cardState={ruleBeingEdited:null,isExpanded:!1,isSaving:!1},n.forCreateBucketModal||(n.replicationObj={role:"",destinationBucket:null,storageClass:"",rulesArray:[],replicationType:"",isEnabled:m.REPLICATION.DISABLED}),n.errorMessage="",n.bucketList=[],n.allMyBuckets=[],n.S3Constants=m,w=new u("getBucketReplication","getBucketReplication"),n.iamRoles=[],n.iamRoles.push({text:a.instant("replication.roles.createnew"),value:m.REPLICATION.NEWROLE}),n.scrollCardId="#"+n.id,n.cardSummaryObj=t.cloneDeep(m.CARD_SUMMARY_INIT),n.forCreateBucketModal&&n.$watch("cardOpen",function(e,t){i(function(){b.scrollCardToView(m.BUCKET_PROPERTIES.REPLICATION.CREATE_BUCKET_CARD)},1)}),n.forCreateBucketModal?(C=n.modalInfo.name,_=n.modalInfo.region,n.regionMapping=[],g.regionMapping.forEach(function(e){e.value!==_&&n.regionMapping.push(e)}),n.sourceRegion=g.twoWayMapping[_]+" ("+_+")"):(C=f.getCurrentBucket(),c.getBucketLocation(C).then(function(e){_=e,n.regionMapping=[];var t=[];b.getFACRegions(g.regionMapping,t),t.forEach(function(e){e.value!==_&&n.regionMapping.push(e)}),n.sourceRegion=g.twoWayMapping[e]+" ("+e+")"}).catch(function(e){n.errorMessage=b.handleErrors(e)})),n.sources=[{value:"bucket",text:a.instant("replication.label.bucket")},{value:"prefix",text:a.instant("replication.label.prefix")}],n.storageClasses=[{value:m.STORAGE_CLASSES.DEFAULT,text:a.instant("replication.storageclasses.default")},{value:m.STORAGE_CLASSES.STANDARD,text:a.instant("replication.storageclasses.standard")},{value:m.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:a.instant("replication.storageclasses.standardia")},{value:m.STORAGE_CLASSES.ONEZONE_IA,text:a.instant("storageclass.zia")},{value:m.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:a.instant("replication.storageclasses.reducedredundancy")}],d.isFeatureEnabled(m.FAC.S3_RRS)||(n.storageClasses=t.reject(n.storageClasses,function(e){return e.value===m.STORAGE_CLASSES.REDUCED_REDUNDANCY})),d.isFeatureEnabled(m.FAC.ONEZONE_IA)||(n.storageClasses=t.reject(n.storageClasses,function(e){return e.value===m.STORAGE_CLASSES.ONEZONE_IA})),n.storageClassesMap={},n.storageClasses.forEach(function(e){n.storageClassesMap[e.value]=e.text,n.storageClassesMap[e.text]=e.value}),h.log("ListAllMyBucketsRequestReceived",1,w),o.listAllMyBuckets(w).then(function(e){var t=e.response.ListAllMyBucketsResult.Buckets.Bucket;h.log("ListAllMyBucketsSuccess",1,w),n.allMyBuckets=t,n.updateBucketList(!1)}).catch(function(e){h.log("ListAllMyBucketsSuccess",0,w),n.errorMessage=b.handleErrors(e)}),E(),n.cardSummaryObj.isLoading=!0,S(C,!1))}function E(){var e=b.getDefaultRegion();h.log("ListRolesRequestReceived",1,w),o.makeProxyRequest(p.listRoles,{region:e,params:{MaxItems:m.API_MAX_ITEMS.IAM_LIST_ROLES}},m.PROXY_API_NAMES.IAM.LIST_ROLES,w).then(function(e){var r=e.response.ListRolesResponse.ListRolesResult.Roles;h.log("ListRolesSuccess",1,w),r.forEach(function(e){-1===t.findIndex(n.iamRoles,{value:e.Arn})&&n.iamRoles.push({text:e.RoleName,value:e.Arn})}),n.listRoleError=null}).catch(function(e){h.log("ListRolesSuccess",0,w);var t=b.handleErrors(e);n.listRoleError=t})}function S(e,r,i){n.forCreateBucketModal?n.replicationObj&&void 0!==n.replicationObj.response&&l.populateReplicationObj(n.replicationObj.response,e,n.replicationObj).then(function(){n.updateBucketList(r)}):c.getBucketReplication(e,w).then(function(t){var i=t.response;n.replicationObj.resetDestinationBucket=r,l.populateReplicationObj(i,e,n.replicationObj,n.regionMapping,!r).then(function(){n.updateBucketList(r),A()}),n.replicationObj.configExists=!0}).catch(function(e){e===m.REPLICATION.CONFIGNOTFOUND?n.replicationObj.configExists=!1:n.errorMessage=b.handleErrors(e),A()}).finally(function(){if(n.replicationObj&&n.replicationObj.role&&!i){var e=t.clone(n.replicationObj.role);-1===t.findIndex(n.iamRoles,{value:e})&&n.iamRoles.push({text:t.last(e.split("/")),value:e})}})}function y(e,t){var r=new u("putBucketReplication","putBucketReplication");n.forCreateBucketModal?(n.replicationObj.response=c.parseBucketReplicationObject_v1(n.replicationObj),n.closeCard(e)):(n.cardState.isSaving=!0,c.putBucketReplication(C,r,n.replicationObj,!0).then(function(){S(C,!0,t),n.closeCard(e)}).catch(function(e){n.errorMessage=b.handleErrors(e)}).finally(function(){n.cardState.isSaving=!1,n.replicationObj.role=""}))}function A(){n.replicationObj.isEnabled===m.REPLICATION.ENABLED?(n.cardSummaryObj.isActive=!0,n.cardSummaryObj.activeSummary.text=a.instant("bucketproperties.crossregionreplication.destinationbucket"),n.cardSummaryObj.isMultiValue=!0,n.cardSummaryObj.activeSummary.value=n.replicationObj.destinationBucket.value||n.replicationObj.destinationBucket):(n.cardSummaryObj.isActive=!1,n.cardSummaryObj.isMultiValue=!1,n.cardSummaryObj.inactiveSummary.text=a.instant("bucketproperty.disabled")),n.cardSummaryObj.isLoading=!1}var C,_,w;n.resetError=function(){n.errorMessage=null},n.$watchCollection("replicationObj.destinationRegion",function(e,r){t.isEmpty(e)||t.isEqual(e,r)||(n.replicationObj.resetDestinationBucket&&(n.replicationObj.destinationBucket=null),n.updateBucketList(),n.resetError(),n.replicationObj.resetDestinationBucket=!0)}),n.displayListRoleError=function(){return!t.isEmpty(n.listRoleError)&&r(".crr-listrole span.awsui-select-target.awsui-select-open.awsui-select-target-focused").length>0},n.removeRule=function(e,r,i){i&&r.stopPropagation(),n.replicationObj.rulesArray.splice(t.findIndex(n.replicationObj.rulesArray,function(t){return e===t}),1),e.storageClass="",e.prefix="",e.markedForDelete=!0},n.updateBucketList=function(e){var t=[];n.allMyBuckets.forEach(function(r){c.getBucketLocation(r.Name).then(function(i){n.replicationObj&&n.replicationObj.destinationRegion&&(i===n.replicationObj.destinationRegion||i===n.replicationObj.destinationRegion.value)&&t.push(r.Name),e&&(n.errorMessage=""),n.bucketList=b.transformListOfOptionsToDropdown(t)})})},n.allRulesEmpty=function(){return t.every(n.replicationObj.rulesArray,function(e){return""===e.prefix&&""===e.storageClass})},n.addRule=function(e){if(e.stopPropagation(),n.completeEdit()){n.cardState.isExpanded=!0;var t={prefix:"",status:m.REPLICATION.ENABLED,storageClass:"",isEditing:!0};n.replicationObj.rulesArray.push(t),n.cardState.ruleBeingEdited=t}},n.completeEdit=function(){var e=n.cardState.ruleBeingEdited;return!(e&&(""!==e.prefix&&""!==e.storageClass||e.markedForDelete?(e.prefixError=!1,e.storageError=!1,e.isEditing=!1,n.cardState.ruleBeingEdited=null,0):""===e.prefix&&""===e.storageClass?(e.storageError=!1,e.prefixError=!1,n.removeRule(e,"",!1),0):(""===e.prefix?(e.prefixError=!0,e.storageError=!1):(e.storageError=!0,e.prefixError=!1),1)))},n.editRule=function(e,t){t.stopPropagation(),n.completeEdit()&&(e.isEditing=!0,n.cardState.ruleBeingEdited=e)},n.isDisable=function(){return n.replicationObj.isEnabled===m.REPLICATION.ENABLED&&(null===n.replicationObj.destinationBucket||""===n.replicationObj.role||"bucket"===n.replicationObj.replicationType&&""===n.replicationObj.storageClass||"prefix"===n.replicationObj.replicationType&&(0===n.replicationObj.rulesArray.length||n.allRulesEmpty()))},n.savePressed=function(e){if(!n.isDisable(n.replicationObj)&&(b.analyticsTrackClick(m.ANALYTICS.SAVE_REPLICATION,m.ANALYTICS.DETAILS),n.completeEdit())){n.replicationObj.rules=[],l.handleRules(C,n.replicationObj);var t=n.replicationObj.destinationBucket.value||n.replicationObj.destinationBucket,r="",i=!1;if(n.replicationObj.role===m.REPLICATION.NEWROLE)r="replication_role_for_"+C+"_to_"+t;else{i=!0;var a=n.replicationObj.role.split("/");r=a[a.length-1]}var o="replication_policy_for_"+C+"_to_"+t;r.length>m.ENTITY_MAX_LENGTH.ROLE&&(r=r.substr(0,m.ENTITY_MAX_LENGTH.ROLE)),o.length>m.ENTITY_MAX_LENGTH.POLICY&&(o=o.substr(0,m.ENTITY_MAX_LENGTH.POLICY)),b.createOrUpdateRoleForReplication_v1(r,o,C,t,i).then(function(t){i||(n.replicationObj.role=t),h.log("createOrUpdateRoleSuccess",1,w),y(e,i)}).catch(function(e){n.errorMessage=b.handleErrors(e),h.log("createOrUpdateRoleSuccess",0,w)})}},n.toggleRuleStatus=function(e,t){t.stopPropagation(),e.markedForDelete?e.markedForDelete=!1:e.status===m.REPLICATION.DISABLED?e.status=m.REPLICATION.ENABLED:e.status===m.REPLICATION.ENABLED&&(e.status=m.REPLICATION.DISABLED)},n.cancelPressed=function(e){b.analyticsTrackClick(m.ANALYTICS.CANCEL_REPLICATION,m.ANALYTICS.DETAILS),n.closeCard(e),v()},n.deletePressed=function(){var e=new u("deleteReplicationConfiguration","deleteReplicationConfiguration");n.deleting=!0,c.deleteBucketReplication(C,e).then(function(e){return n.replicationObj.isEnabled=m.REPLICATION.DISABLED,n.replicationObj.configExists=!1,n.closeCard(),e}).catch(function(e){n.errorMessage=b.handleErrors(e)}).finally(function(){n.deleting=!1})},n.closeCard=function(e){e&&e.stopPropagation(),n.cardOpen=!1},n.docLink=s.getDocUrl(m.LEARN_MORE_LINKS.REPLICATION),v()}e.module("s3").directive("bucketReplicationV1",function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",replicationObj:"=?",modalInfo:"=?",versioningStatus:"=",id:"@?"},template:n(784),controller:"BucketReplicationV1Controller"}}),e.module("s3").controller("BucketReplicationV1Controller",["$filter","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","IAMService","PathService","Region","S3Constants","SCLogService","UtilService",i])}()}).call(t,n(0),n(2),n(6))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-CRR-water-mark\': !cardOpen, \'card-enable-CRR-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.crossregionreplication.label.crossregionreplication></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelPressed($event)></div> </card-header> <card-content> <p ng-if=!cardOpen class=bucketproperties-summary translate=bucketproperties.crossregionreplication.summary></p> <div class="awsui-row card-content-row"> <awsui-radio-group ng-if=cardOpen ng-model=replicationObj.isEnabled> <awsui-radio-button style=display:inline value=Enabled label="{{ \'replication.label.enable\' | translate }}" disabled="versioningStatus === S3Constants.BUCKET_PROPERTIES.DISABLE"></awsui-radio-button> <awsui-tooltip text="{{\'replication.enable.tooltip\' | translate}}" position=right size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-alert ng-if="replicationObj.isEnabled == S3Constants.REPLICATION.DISABLED" class=warning-box type=warning dismissable=false>{{ \'replication.enablewarning\' | translate }}</awsui-alert> <div class=enabled-replication-content ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" ng-click="$event.stopPropagation(); completeEdit()"> <div class=source-section> <div class=section-header> <span translate>replication.sectionheader.source</span> <div></div> </div> <div class=region-text> <span id=region-title translate>replication.label.region</span> <span>{{sourceRegion}}</span> </div> <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED"> <awsui-select ng-change=resetError() placeholder="{{ \'replication.placeholder.source\' | translate }}" ng-model=replicationObj.replicationType items=sources> </awsui-select> </awsui-control-group> </div> <div class=destination-section> <div class=section-header> <span>{{ \'replication.sectionheader.destination\' | translate }}</span> <div></div> </div> <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED"> <dropdown items=regionMapping selected-item=replicationObj.destinationRegion placeholder="{{ \'replication.placeholder.region\' | translate }}" filter=true></dropdown> </awsui-control-group> <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED"> <dropdown disabled="bucketList.length === 0" items=bucketList selected-item=replicationObj.destinationBucket placeholder="{{ \'replication.placeholder.destinationbucket\' | translate }}" filter=true></dropdown> </awsui-control-group> </div> <div class=bottom-section> <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED && replicationObj.replicationType === \'bucket\'" label="{{ \'replication.label.storageclass\' | translate }}"> <awsui-select ng-change=resetError() placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-model=replicationObj.storageClass items=storageClasses></awsui-select> </awsui-control-group> <awsui-expandable-section class=collapsable-section header="{{ \'replication.label.currentprefixes\' | translate }}" ng-if="cardOpen && replicationObj.replicationType === \'prefix\' && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED"> <div class=replication-table-v1> <table class="table table-condensed"> <thead> <tr> <td></td> <td translate>replication.table.prefix</td> <td translate>replication.table.storageclass</td> <td></td> </tr> </thead> <tbody> <tr class=add-rule> <td colspan=2 ng-click=addRule($event)>{{ \'replication.table.add\' | translate }}</td> <td></td> <td></td> </tr> <tr ng-repeat="rule in replicationObj.rulesArray" ng-click="editRule(rule, $event)"> <td> <div ng-if="rule.status === S3Constants.REPLICATION.ENABLED && !rule.markedForDelete" class="card-enabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div> <div ng-if="rule.status === S3Constants.REPLICATION.DISABLED && !rule.markedForDelete" class="card-disabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div> <span ng-if=rule.markedForDelete class="awsui-icon awsui-icon-bigger times-circle" ng-click="toggleRuleStatus(rule, $event)"></span> </td> <td ng-if="rule.isEditing && !rule.prefixError"> <awsui-textfield placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-model=rule.prefix ng-change=resetError() ng-click=$event.stopPropagation()></awsui-textfield> </td> <td ng-if="rule.isEditing && rule.prefixError"> <awsui-textfield class=verification-error-v1 placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-change=resetError() ng-model=rule.prefix ng-click=$event.stopPropagation()></awsui-textfield> </td> <td ng-if="rule.isEditing && !rule.storageError"> <awsui-select ng-change=resetError() placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click=$event.stopPropagation() ng-model=rule.storageClass items=storageClasses></awsui-select> </td> <td ng-if="rule.isEditing && rule.storageError"> <awsui-select ng-change=resetError() class=verification-error-v1 placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click=$event.stopPropagation() ng-model=rule.storageClass items=storageClasses></awsui-select> </td> <td ng-if=!rule.isEditing> {{ rule.prefix }} </td> <td ng-if=!rule.isEditing> {{ storageClassesMap[rule.storageClass] }} </td> <td> <awsui-button icon=times-circle variant=standalone-icon ng-click="removeRule(rule, $event, true)"></awsui-button> </td> </tr> </tbody> </table> </div> </awsui-expandable-section> <div class=section-header> <div></div> </div> <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" label="{{ \'replication.label.selectrole\' | translate }}" class=crr-listrole> <awsui-select placeholder="{{ \'replication.placeholder.selectrole\' | translate }}" ng-model=replicationObj.role items=iamRoles></awsui-select> </awsui-control-group> <awsui-alert class=crr-listrole-error header=Error dismissible=false type=error ng-if=displayListRoleError()>{{listRoleError}}</awsui-alert> </div> </div> </awsui-radio-group> </div> <div class="awsui-row card-content-row"> <awsui-radio-group ng-if=cardOpen ng-model=replicationObj.isEnabled> <awsui-radio-button value=Disabled label="{{ \'replication.label.disable\' | translate }}"></awsui-radio-button> <div class=disabled-replication-content> <div> <awsui-button ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.DISABLED && !forCreateBucketModal" text="{{ \'replication.label.delete\' | translate }}" click=deletePressed() variant=danger disabled=!replicationObj.configExists loading=deleting> </awsui-button> </div> </div> </awsui-radio-group> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> <awsui-alert class=warning-box ng-if="errorMessage &&  cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" type=error>{{ errorMessage }}</awsui-alert> </card-content> <card-footer> <div class=bucket-properties-buttons ng-if=cardOpen> <awsui-button ng-if=cardOpen text="{{ \'replication.label.cancel\' | translate }}" ng-click=cancelPressed($event)> </awsui-button> <awsui-button ng-if=cardOpen text="{{ \'replication.label.save\' | translate }}" ng-click=savePressed($event) variant=primary loading=cardState.isSaving data-disabled=isDisable()> </awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t){!function(){function r(e,n,r,i,a,o,s,c,l,u,d,p){function f(){p.scrollCardToView(u.BUCKET_PROPERTIES.EVENT_SELECTORS.CREATE_BUCKET_CARD)}function g(r){var i=l.getCurrentBucket(),a=i+"/",s=n.defer(),f=new c("GetEventSelectors");return o.getEventSelectors(r,f,e.eventSelectors.trailRegionMapping[r]).then(function(n){for(var r=n.response.EventSelectors,o=0;o<r.length;o++){var c=r[o].DataResources;if(!t.isEmpty(c))for(var l=c[0].Values,g=0;g<l.length;g++){var m=l[g],h=t.endsWith(m,":::");if(t.contains(m,"s3:::")&&!h){var b=m.split("s3:::");if(t.startsWith(b[1],a)){e.cardSummaryObj.isActive=!0;break}}else{var v=p.getARNPrefix(u.AWS_SERVICE.S3);if(h||(v=v.slice(0,-3)),t.isEqual(v,m)){e.cardSummaryObj.isActive=!0;break}}}}d.log("GetEventSelectors",1,f,{bucketName:i}),s.resolve()}).catch(function(t){var n=p.handleErrors(t);e.eventSelectorsErrorMessage=n,d.log("GetEventSelectors",0,f,{bucketName:i,error:n}),s.reject(t)}),s.promise}if(e.saving=!1,e.cardSummaryObj=t.cloneDeep(u.CARD_SUMMARY_INIT),e.cardSummaryObj.activeSummary.text=i.instant("bucketproperty.enabled"),e.cardSummaryObj.inactiveSummary.text=i.instant("bucketproperty.disabled"),e.docLink=a.getDocUrl(u.LEARN_MORE_LINKS.CLOUDTRAIL),e.cancelEventSelectors=function(t){p.analyticsTrackClick(u.ANALYTICS.CANCEL_EVENT_SELECTORS,u.ANALYTICS.DETAILS),t.stopPropagation(),e.cardSummaryObj.isActive||(e.eventSelectors.access={read:!1,write:!1},e.eventSelectors.targetTrail="",e.forCreateBucketModal&&(e.eventSelectors.enabled=!1)),e.cardOpen=!1,e.eventSelectorsErrorMessage=""},e.refreshTrails=function(){e.isRefreshing=!0;var t=new c("RefreshTrails");o.describeTrails(t,e.region).then(function(n){e.eventSelectors.trailNames.length=0,e.eventSelectors.trailRegionMapping={},s.populateTrailNames(n,e.eventSelectors.trailNames,e.eventSelectors.trailRegionMapping),d.log("DescribeTrails",1,t),e.isRefreshing=!1}).catch(function(n){var r=p.handleErrors(n);d.log("DescribeTrails",0,t,{error:r}),e.eventSelectorsErrorMessage=r,e.isRefreshing=!1})},e.getEventSelectors=function(){e.forCreateBucketModal||function(){var r=new c("GetEventSelectors"),i=[];o.describeTrails(r,e.region).then(function(a){d.log("DescribeTrails",1,r);var o=a.response.trailList;e.eventSelectors.trailRegionMapping={},t.each(o,function(t){var n=p.getTrailName(t.TrailARN),r=p.getTrailRegionFromARN(t.TrailARN);e.eventSelectors.trailNames.push({value:t.TrailARN,text:n}),e.eventSelectors.trailRegionMapping[t.TrailARN]=r,i.push(g(t.TrailARN))}),n.all(i).then(function(){e.cardSummaryObj.isLoading=!1},function(t){e.cardSummaryObj.isLoading=!1,e.eventSelectorsErrorMessage=p.handleErrors(t)})}).catch(function(t){e.cardSummaryObj.isLoading=!1;var n=p.handleErrors(t);d.log("DescribeTrails",0,r,{error:n}),e.eventSelectorsErrorMessage=n})}()},e.forCreateBucketModal)e.$watch("cardOpen",function(e,t){e&&r(f,1)}),!t.isEmpty(e.eventSelectors)&&e.eventSelectors.errorMessage&&(e.eventSelectorsErrorMessage=e.eventSelectors.errorMessage),e.cloudTrailLink=a.getConsoleServiceUrl("cloudtrail",e.region,"#/configuration"),e.cardSummaryObj.isActive=""!==e.eventSelectors.targetTrail&&(e.eventSelectors.access.read||e.eventSelectors.access.write);else{e.scrollCardId="#"+e.id;var m=l.getCurrentBucket();e.cardSummaryObj.isLoading=!0,o.getBucketLocation(m).then(function(t){e.region=t,e.getEventSelectors(),e.cloudTrailLink=a.getConsoleServiceUrl("cloudtrail",t,"#/configuration")}).catch(function(t){e.eventSelectorsErrorMessage=p.handleErrors(t)})}e.saveEventSelectors=function(n){p.analyticsTrackClick(u.ANALYTICS.SAVE_EVENT_SELECTORS,u.ANALYTICS.DETAILS),n.stopPropagation(),e.eventSelectorsErrorMessage="",e.forCreateBucketModal?(e.cardOpen=!1,e.eventSelectors.enabled=!0,e.cardSummaryObj.isActive=!0):function(){e.saving=!0;var n=l.getCurrentBucket(),r=new c("SaveEventSelectors");o.getEventSelectors(e.eventSelectors.targetTrail,r,e.eventSelectors.trailRegionMapping[e.eventSelectors.targetTrail]).then(function(i){var a=t.get(i,"response.EventSelectors");if(a){var c=s.generateEventSelectorsConfig(a,e.eventSelectors.targetTrail,e.eventSelectors.access,n);d.log("GetEventSelectors",1,r,{bucketName:n}),o.putEventSelectors(c,r,e.eventSelectors.trailRegionMapping[e.eventSelectors.targetTrail]).then(function(){e.saving=!1,e.cardSummaryObj.isActive=!0,e.cardOpen=!1,d.log("PutEventSelectors",1,r,{bucketName:n})}).catch(function(t){var i=p.handleErrors(t);e.eventSelectorsErrorMessage=p.handleErrors(t),d.log("PutEventSelectors",0,r,{bucketName:n,error:i}),e.cardSummaryObj.isActive=!1,e.saving=!1})}}).catch(function(t){var i=p.handleErrors(t);e.eventSelectorsErrorMessage=i,d.log("GetEventSelectors",0,r,{bucketName:n,error:i}),e.saving=!1})}()}}e.module("s3").directive("cloudTrail",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",createBucketValues:"=?",eventSelectors:"=",id:"@?",region:"=?"},template:n(786),controller:"CloudTrailController"}}]),e.module("s3").controller("CloudTrailController",["$scope","$q","$timeout","$translate","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",r])}()}).call(t,n(0),n(2))},function(e,t){e.exports='<card card-summary-obj=cardSummaryObj card-id=scrollCardId is-open=cardOpen ng-class="{ \'card-disable-cloudtrail-water-mark\': !cardOpen, \'card-enable-cloudtrail-water-mark\': cardOpen }"> <card-header> <span translate=bucketproperties.dataevents.label.dataevents></span> <div class=card-close-icon ng-if=cardOpen ng-click=cancelEventSelectors($event)></div> </card-header> <card-content> <p class=bucketproperties-summary ng-if=!cardOpen translate=bucketproperties.dataevents.summary></p> <div class=awsui-container ng-if=cardOpen> <div ng-if=!cardSummaryObj.isActive> <div class="awsui-row card-content-row bucket-status-display single-line"> <div class="icon card-disabled-icon"></div> <label class="card-status-text-gray manage-trail-description" translate=bucketproperty.disabled></label> <div class=enabled-data-events> <label class=trail-for-recording translate=bucketproperties.dataevents.label.trailforrecording></label> <awsui-tooltip text="{{\'bucketproperties.dataevents.label.tooltip.trail\' | translate}}" position=top size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> <awsui-button id=refresh-trail-button class=trail-refresh icon=refresh variant=standalone-icon loading=isRefreshing click=refreshTrails()></awsui-button> <awsui-select id=trail-dropdown class=event-selectors-dropdown items=eventSelectors.trailNames placeholder="{{ \'bucketproperties.dataevents.placeholder.choosetrail\' | translate }}" ng-model=eventSelectors.targetTrail></awsui-select> </div> <div class=event-selectors-text> <span> <label class=manage-trail-description translate=bucketproperties.dataevents.label.visit></label> <label class=manage-trail-description translate=bucketproperties.dataevents.label.goto></label> <awsui-button id=cloudtrail-console-link class=cloudtrail-link target=_blank variant=link icon=external-link href={{cloudTrailLink}} text="{{ \'bucketproperties.dataevents.label.cloudtrailconsole\' | translate }}"></awsui-button> </span> </div> <div class=enabled-data-events> <label class=trail-for-recording translate=bucketproperties.dataevents.label.events></label> <awsui-tooltip text="{{\'bucketproperties.dataevents.label.tooltip.readwrite\' | translate}}" position=top size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </div> <table class=access-table> <tr> <td> <awsui-checkbox id=trail-read-access ng-model=eventSelectors.access.read> <span class=access-text translate=objects.details.READ></span> </awsui-checkbox> </td> <td class=trail-access-row> <awsui-checkbox id=trail-write-access ng-model=eventSelectors.access.write> <span class=access-text translate=objects.details.WRITE></span> </awsui-checkbox> </td> </tr> </table> </div> </div> <awsui-alert type=error class=error-alert readonly=readonly ng-if="eventSelectorsErrorMessage && cardOpen">{{eventSelectorsErrorMessage}}</awsui-alert> <div ng-if=cardSummaryObj.isActive> <div class="awsui-row card-content-row bucket-status-display single-line"> <div class="icon card-enabled-icon"></div> <label id=trail-enabled-text class="card-status-text enabled-trail-status" translate=bucketproperty.enabled></label> <div class=enabled-data-events> <label class=manage-trail-description translate=bucketproperties.dataevents.label.trailsetup></label> </div> <div class=enabled-data-events> <span class=manage-trail-description> <label class=manage-trail-description translate=bucketproperties.dataevents.label.paidfeature></label> <a target=_blank href={{docLink}} translate>learn.more</a> </span> </div> <awsui-button id=visit-cloudtrail-button class=visit-cloudtrail target=_blank href={{cloudTrailLink}} text="{{ \'bucketproperties.dataevents.label.visitcloudtrail\' | translate }}"></awsui-button> </div> </div> </div> <a class=learn-more-card-closed-link ng-if=!cardOpen target=_blank href={{docLink}} translate>learn.more</a> </card-content> <card-footer ng-if=!cardSummaryObj.isActive> <div ng-if="!cardSummaryObj.isActive && cardOpen" id=event-selectors-properties-buttons class=bucket-properties-buttons> <awsui-button id=cancel-bucket-event-selectors ng-click=cancelEventSelectors($event) text="{{ \'button.cancel\' | translate }}"></awsui-button> <awsui-button id=save-bucket-event-selectors data-disabled="(eventSelectors.targetTrail === \'\' || (!eventSelectors.access.read && !eventSelectors.access.write))" ng-click=saveEventSelectors($event) text="{{ \'bucketproperties.dataevents.label.create\' | translate }}" variant=primary loading=saving></awsui-button> </div> </card-footer> </card>'},function(e,t,n){"use strict";(function(e,t,r){e.module("s3").directive("multiSelector",[function(){return{restrict:"E",controller:"MultiSelectorController",scope:{multiSelectorObj:"=",apiCall:"=?",operation:"=?"},template:n(788)}}]),e.module("s3").controller("MultiSelectorController",["$scope","$filter","$translate","S3Constants",function(e,n,i,a){function o(){e.multiSelectorObj.isLoadingData=!0,e.apiCall().then(function(n){t.forEach(n,function(n){if(e.multiSelectorObj.selectAllByDefault)n.selected=!0,e.multiSelectorObj.optionList.push(n);else{var r=t.findIndex(e.multiSelectorObj.optionList,{value:n.value});-1===r?(n.selected=!1,e.multiSelectorObj.optionList.push(n)):t.isEmpty(e.multiSelectorObj.optionList[r].text)&&(e.multiSelectorObj.optionList[r].text=n.text)}}),e.multiSelectorObj.totalSelectedCount=0,e.multiSelectorObj.isLoadingData=!1}).catch(function(t){e.multiSelectorObj.errorMsg=t,e.multiSelectorObj.isLoadingData=!1,e.multiSelectorObj.isDropDownOpen=!1})}function s(){var n=0;return t.forEach(e.multiSelectorObj.optionList,function(e){e.selected&&(n+=1)}),n}!function(){e.customerInputList=[],e.tableFilter={filter:""},e.apiCall&&!e.multiSelectorObj.initialized?o():e.multiSelectorObj.totalSelectedCount=s(),e.multiSelectorObj.initialized=!0}(),e.$watch("multiSelectorObj.optionList",function(t,n){t!==n&&(e.multiSelectorObj.totalSelectedCount=s())},!0),e.filterKeyDown=function(t,n,i){t&&t.keyCode===a.KEY_CODES.ESC&&(e.clearFilter(),r(".input-field").blur()),t&&t.keyCode===a.KEY_CODES.ENTER&&0===i.length&&(r(".input-field").focus(),e.addCustomerInput(n))},e.selectAll=function(){t.forEach(e.multiSelectorObj.optionList,function(e){e.selected=!0})},e.clearFilter=function(){e.tableFilter={filter:""}},e.unSelectAll=function(){t.forEach(e.multiSelectorObj.optionList,function(e){e.selected=!1})},e.selectRow=function(e,t){e.stopPropagation(),t.selected=!t.selected},e.selectCheckBox=function(e,t){e.stopPropagation(),t.selected=!t.selected},e.closeDropDown=function(){e.multiSelectorObj.isDropDownOpen=!1},e.toggleDropDown=function(){e.multiSelectorObj.isDropDownOpen=!e.multiSelectorObj.isDropDownOpen},e.addCustomerInput=function(n){t.isEmpty(n)||(n=n.trim(),e.customerInputList.push({text:n,value:n,selected:!0}),t.forEach(e.customerInputList,function(n){-1===t.findIndex(e.multiSelectorObj.optionList,{text:n.text})&&e.multiSelectorObj.optionList.splice(0,0,n)}),e.tableFilter={filter:""})}}])}).call(t,n(0),n(2),n(6))},function(e,t){e.exports='<div id=multi-selector class=multi-selector clickoutside on-click-outside=closeDropDown> <div class=awsui-select-target ng-click=toggleDropDown()> <div class=current-displayed-item><span>{{ multiSelectorObj.totalSelectedCount > 0 ? multiSelectorObj.totalSelectedCount + multiSelectorObj.nonEmptyDisplayPlaceholder : multiSelectorObj.emptyDisplayPlaceholder }}</span></div> </div> <div ng-if=multiSelectorObj.isDropDownOpen class=multiselector-dropdown> <div class=search-box> <input type=text class=input-field ng-model=tableFilter.filter ng-keydown="filterKeyDown($event, tableFilter.filter, filteredItems)" placeholder="{{ multiSelectorObj.searchPlaceholder }}"/><i class="awsui-icon search"></i> </div> <div class=multiselector-divider></div> <div class=select-option-button ng-if="filteredItems.length > 0 && !multiSelectorObj.isLoadingData"> <div class=select-all-button translate=multiselector.selectall ng-click=selectAll()></div> <div class=unselect-all-button translate=multiselector.unselectall ng-click=unSelectAll()></div> </div> <div ng-if=multiSelectorObj.isLoadingData class="awsui-spinner awsui-spinner-bigger awsui-spinner-light multiselector-spinner"></div> <span ng-if=multiSelectorObj.isLoadingData class=loading-data-text translate=loading></span> <table class=list-items-table> <tr class=list-item ng-repeat="option in (filteredItems = (multiSelectorObj.optionList | filter: {text: tableFilter.filter} | orderBy: text))" ng-click="selectRow($event, option)"> <td class=checkbox> <awsui-checkbox ng-click="$event.stopPropagation(); $event.preventDefault(); selectCheckBox($event, option)" checked=option.selected></awsui-checkbox> </td> <td class=item-text>{{option.text}}</td> </tr> <tr class=noresult-text ng-if="filteredItems.length === 0 && !multiSelectorObj.isLoadingData"> <td colspan=2>{{multiSelectorObj.noSearchResult.text}}</td> </tr> <tr class=noresult-addinput ng-if="filteredItems.length === 0 && !multiSelectorObj.isLoadingData" ng-click=$event.stopPropagation();addCustomerInput(tableFilter.filter)> <td colspan=2>{{multiSelectorObj.noSearchResult.addInputText}}</td> </tr> </table> </div> <awsui-alert type=error ng-if="multiSelectorObj && multiSelectorObj.errorMsg">{{ multiSelectorObj.errorMsg }}</awsui-alert> </div>'},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").constant("S3SelectConstants",{FILE_FORMATS:{JSON:"JSON",CSV:"CSV",PARQUET:"Parquet"},COMPRESSIONS:{GZIP:"GZIP",BZIP2:"BZIP2",NONE:"NONE"},DELIMITERS:{COMMA:"Comma",TAB:"Tab",CUSTOM:"Custom"},JSON_TYPES:{JSON_LINES:"LINES",JSON_RECORD:"DOCUMENT"},S3_SELECT_DOC_LINK:"https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectSELECTContent.html",S3_SELECT_SQL_REF_LINK:"https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-glacier-select-sql-reference-select.html",S3_SELECT_COST_RATES:{"us-east-1":{scanCost:"0.002",returnCost:"0.0007"},"us-east-2":{scanCost:"0.002",returnCost:"0.0007"},"us-west-2":{scanCost:"0.002",returnCost:"0.0007"},"us-west-1":{scanCost:"0.00225",returnCost:"0.0008"},"ca-central-1":{scanCost:"0.00225",returnCost:"0.0008"},"eu-west-1":{scanCost:"0.002",returnCost:"0.0007"},"eu-west-2":{scanCost:"0.00225",returnCost:"0.0008"},"eu-west-3":{scanCost:"0.00225",returnCost:"0.0008"},"eu-central-1":{scanCost:"0.00225",returnCost:"0.0008"},"eu-north-1":{scanCost:"0.002",returnCost:"0.0007"},"ap-south-1":{scanCost:"0.0025",returnCost:"0.0009"},"ap-southeast-1":{scanCost:"0.0025",returnCost:"0.0009"},"ap-northeast-1":{scanCost:"0.00225",returnCost:"0.0008"},"ap-southeast-2":{scanCost:"0.00225",returnCost:"0.0008"},"ap-northeast-2":{scanCost:"0.00225",returnCost:"0.0008"},"ap-northeast-3":{scanCost:"0.00225",returnCost:"0.0008"},"sa-east-1":{scanCost:"0.004",returnCost:"0.0014"},"cn-north-1":{scanCost:"0.0025",returnCost:"0.0009"},"cn-northwest-1":{scanCost:"0.00225",returnCost:"0.0008"},"us-gov-west-1":{scanCost:"0.003",returnCost:"0.001"}},MAX_OBJECT_SIZE:134217728})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("s3Select",[function(){return{restrict:"E",scope:{object:"=",bucket:"="},template:n(791),controllerAs:"vm",bindToController:!0,controller:"S3SelectController"}}]),e.module("s3").controller("S3SelectController",["ConsoleOperation","S3SelectService","S3Constants","S3SelectConstants","APIProxyService","AwsUrlsService","$translate","$filter",function(e,t,n,r,i,a,o,s){var c=this,l=c.object;c.objectKey=l.Key,c.configuringFileParameters=!0,c.isObjectSizeWithinLimit=c.object.Size<r.MAX_OBJECT_SIZE,c.translateStringParams={size:s("humanReadableBytes")(c.object.Size)},c.fileParams={fileType:t.determineFileType(c.objectKey),compressionType:t.determineCompressionType(c.objectKey)},c.learnMoreUrl=r.S3_SELECT_DOC_LINK,i.getBucketLocation(new e,c.bucket,{}).then(function(e){var t=e.region;c.region=t,c.athenaUrl=a.getConsoleServiceUrl("athena",t,"")}),c.moveStep=function(e){c.configuringFileParameters="forward"!==e},c.runSelectQuery=function(r){c.queryInProgress=!0,c.result=null;var i=new e(n.OPERATION_NAME.SELECT_WITHIN_OBJECT);return t.selectWithinObject(i,c.bucket,c.object,r,c.fileParams).then(function(e){var n=e.data,r=e.isTimeTruncated,i=e.isSizeTruncated;c.result=t.getResultProcessFunc(c.fileParams.outputFileType)(n),c.error=r||i?{errorMessage:i?o.instant("objects.select.result.sizetruncated"):o.instant("objects.select.result.timetruncated"),errorType:"warning"}:null}).catch(function(e){var n=t.getLocalizedErrorMessage(e,c.fileParams);c.error={errorMessage:n,errorType:"error"},c.previewContent=null,c.showingPreview=!1}).finally(function(){return c.queryInProgress=!1})}}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=s3-select-container> <awsui-alert ng-if=!vm.isObjectSizeWithinLimit type=warning>{{ 'objects.select.fileoversize' | translate: vm.translateStringParams }}</awsui-alert> <section class=s3-select-section> <p class=s3-select-intro><span translate=objects.select.intro></span><awsui-button target=_blank href={{vm.learnMoreUrl}} variant=link icon=external-link> <span>{{'learn.more' | translate}}</span> </awsui-button> </p> <p class=s3-select-intro><span translate=objects.select.gotoathena></span><awsui-button target=_blank href={{vm.athenaUrl}} variant=link icon=external-link>{{ 'awsservice.athena' | translate }}</awsui-button></p> </section> <section class=s3-select-section> <s3-select-params disabled=!vm.isObjectSizeWithinLimit object=vm.object file-params=vm.fileParams></s3-select-params> </section> <section class=s3-select-section ng-if=vm.isObjectSizeWithinLimit data-e2e-id=s3SelectPreviewSection> <s3-select-preview object=vm.object bucket=vm.bucket file-params=vm.fileParams></s3-select-preview> <div class=\"s3-select-button-container buttons-on-right\" ng-if=vm.configuringFileParameters> <awsui-button id=s3-select-next text=\"{{'objects.select.next' | translate}}\" variant=primary click=\"vm.moveStep('forward')\"></awsui-button> </div> </section> <section class=s3-select-section ng-if=!vm.configuringFileParameters ng-if=vm.isObjectSizeWithinLimit> <s3-select-editor region=vm.region expression=vm.expression error=vm.error on-run-query=\"vm.runSelectQuery(expression, fileParams)\"> </s3-select-editor> </section> <section class=s3-select-section ng-if=!vm.configuringFileParameters ng-if=vm.isObjectSizeWithinLimit data-e2e-id=s3SelectResultSection> <h3>{{'objects.select.result.header' | translate}}</h3> <s3-select-result result-loading=vm.queryInProgress expression=vm.expression object-key=vm.objectKey tab-details=vm.resultTab error=vm.error result=vm.result show-download-button=true intro-text=\"{{'objects.select.result.introduction' | translate}}\"></s3-select-result> </section> </div> "},function(e,t,n){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){e.module("s3").directive("s3SelectResult",[function(){return{restrict:"E",scope:{error:"=",result:"=",resultLoading:"=",expression:"=",tabDetails:"=",objectKey:"=",showDownloadButton:"=",introText:"@"},template:n(793),controller:"S3SelectResultController",controllerAs:"vm",bindToController:!0}}]),e.module("s3").controller("S3SelectResultController",["$window","$document",function(n,r){var i=this,a=n.Blob,o=r.get(0);i.blobSupported=a&&("function"==typeof a||"object"===(void 0===a?"undefined":t(a))),i.downloadResult=function(){if(i.blobSupported){var t=new a([i.result],{type:"text/plain"}),r=e.element("<a/>");r.css({display:"none"}),e.element(o.body).append(r);var s=n.URL.createObjectURL(t);r.attr("href",s),r.attr("download","select_result_"+i.objectKey.replace(".","_")+"_"+Date.now());var c=r.get(0);c&&"function"==typeof c.click&&r.get(0).click(),window.URL.revokeObjectURL(s),r.remove()}}}])}()}).call(t,n(0))},function(e,t){e.exports='<div> <div ng-if=vm.error> <awsui-alert type={{vm.error.errorType}}><span ng-if=vm.error.errorCode>[{{vm.error.errorCode}}]</span> <span ng-bind-html="vm.error.errorMessage | trusted"></span></awsui-alert> </div> <div class=s3-select-result-container> <div ng-if="!vm.resultLoading && !vm.result"> <p class=s3-select-result-msg><em ng-bind-html="vm.introText | trusted"></em></p> </div> <div ng-if=vm.result> <pre class=s3-select-result-display ng-bind-html=vm.result></pre> </div> <div ng-if=vm.resultLoading class=s3-select-result-loading> <p>{{\'objects.select.expression.inprogress\' | translate}}: <strong>{{vm.expression}}</strong></p> <span class="awsui-spinner awsui-spinner-biggest"></span> </div> </div> <div ng-if="vm.showDownloadButton && vm.blobSupported" class="s3-select-button-container buttons-on-right"> <awsui-button id=select-download-result disabled=!vm.result text="{{\'objects.select.result.download\' | translate}}" variant=normal click=vm.downloadResult()></awsui-button> </div> </div> '},function(e,t,n){"use strict";(function(e,t){!function(){e.module("s3").directive("s3SelectPreview",[function(){return{restrict:"E",scope:{object:"<",bucket:"<",fileParams:"<"},template:n(795),controllerAs:"vm",bindToController:!0,controller:"S3SelectPreviewController"}}]),e.module("s3").controller("S3SelectPreviewController",["$scope","$translate","ConsoleOperation","S3SelectService","UtilService","S3Constants",function(e,n,r,i,a,o){function s(e,t){var r=e.data,a=e.isTimeTruncated,o=e.isSizeTruncated;l.previewContent=i.getResultProcessFunc(t.outputFileType)(r),l.error=a||o?{errorMessage:o?n.instant("objects.select.result.sizetruncated"):n.instant("objects.select.result.timetruncated"),errorType:"warning"}:null}function c(e){var t=i.getLocalizedErrorMessage(e,l.fileParams);l.error={errorMessage:t,errorType:"error"},l.previewContent=null,l.showingPreview=!1}var l=this;l.diffs=[],l.showingPreview=!1;var u={fileType:n.instant("objects.select.params.fileformat"),delimiterType:n.instant("objects.select.params.delimiter"),customDelimiter:n.instant("objects.select.params.delimiter"),useHeader:n.instant("objects.select.params.header"),jsonType:n.instant("objects.select.params.jsontype"),compressionType:n.instant("objects.select.params.compression")};e.$watch("vm.fileParams",function(e,t){for(var r in e)if(e[r]!==t[r]){var i=u[r];i&&-1===l.diffs.indexOf(i)&&l.diffs.push(i)}l.previewContent&&(l.error={errorType:"warning",errorMessage:n.instant("objects.select.preview.modified",{fields:l.diffs.join(", ")})})},!0),l.loadSelectPreview=function(){var e=10,n=t.assign({},l.fileParams);l.showingPreview=!0,l.resultLoading=!0,l.previewContent=null,l.diffs=[],n.useHeader&&(n.useHeader=!1,e+=1),l.expression="select * from s3object limit "+e;var a=new r(o.OPERATION_NAME.SELECT_WITHIN_OBJECT);return i.selectWithinObject(a,l.bucket,l.object,l.expression,n).then(function(e){s(e,n)}).catch(c).finally(function(){return l.resultLoading=!1})}}])}()}).call(t,n(0),n(2))},function(e,t){e.exports="<div class=s3-select-file-preview> <h3>{{'objects.select.preview.header' | translate}}</h3> <p class=s3-select-pricing-text> <span translate=objects.select.preview.costwarning></span> </p> <div class=s3-select-button-container> <awsui-button id=show-select-preview text=\"{{'objects.select.preview.show' | translate}}\" variant=normal click=vm.loadSelectPreview()></awsui-button> </div> <s3-select-result result-loading=vm.resultLoading expression=vm.expression object-key=vm.objectKey error=vm.error result=vm.previewContent intro-text=\"{{'objects.select.preview.introduction' | translate}}\" show-download-button=false></s3-select-result> </div>"},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("s3SelectParams",[function(){return{restrict:"E",scope:{fileParams:"=",object:"<",disabled:"<"},template:n(797),controllerAs:"vm",bindToController:!0,controller:"S3SelectParamsController"}}]),e.module("s3").controller("S3SelectParamsController",["$scope","$timeout","$window","$translate","UtilService","S3Constants","S3SelectConstants",function(e,t,n,r,i,a,o){function s(e){var t=e.fileType;t===o.FILE_FORMATS.CSV&&(c.fileParams.delimiterType=o.DELIMITERS.COMMA),t===o.FILE_FORMATS.JSON&&(c.fileParams.jsonType=o.JSON_TYPES.JSON_LINES),c.fileParams.outputFileType=c.fileParams.fileType,t===o.FILE_FORMATS.PARQUET&&(c.fileParams.outputFileType=o.FILE_FORMATS.JSON,c.fileParams.compressionType=o.COMPRESSIONS.NONE)}var c=this;c.JSON_TYPES=[{label:r.instant("objects.select.params.jsonlines"),value:o.JSON_TYPES.JSON_LINES},{label:r.instant("objects.select.params.jsonrecord"),value:o.JSON_TYPES.JSON_RECORD}],c.FILE_TYPES=[{label:o.FILE_FORMATS.CSV,value:o.FILE_FORMATS.CSV},{label:o.FILE_FORMATS.JSON,value:o.FILE_FORMATS.JSON},{label:o.FILE_FORMATS.PARQUET,value:o.FILE_FORMATS.PARQUET}],c.COMPRESSION_TYPES=[{label:r.instant("objects.select.params.nocompression"),value:o.COMPRESSIONS.NONE},{label:o.COMPRESSIONS.GZIP,value:o.COMPRESSIONS.GZIP},{label:o.COMPRESSIONS.BZIP2,value:o.COMPRESSIONS.BZIP2}],c.DELIMETERS=[{label:r.instant("objects.select.delimiter.comma"),value:o.DELIMITERS.COMMA},{label:r.instant("objects.select.delimiter.tab"),value:o.DELIMITERS.TAB},{label:r.instant("objects.select.delimiter.custom"),value:o.DELIMITERS.CUSTOM}],s(c.fileParams),e.$watch("vm.fileParams",function(e,n){c.error=null,e.fileType!==n.fileType&&s(e);var r=e.customDelimiter;r!==n.customDelimiter&&r&&r.length>1&&(c.fileParams.customDelimiter=n.customDelimiter),e.delimiterType!==n.delimiterType&&e.delimiterType===o.DELIMITERS.CUSTOM&&t(function(){return c.focusInput()})},!0),c.getEncryptionTranslation=function(){return i.getEncryptionTranslations()[c.object.Encryption]},c.onBlurDelimiter=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.currentTarget;if(c.fileParams.delimiterType===o.DELIMITERS.CUSTOM&&t){var n=t.querySelector("input[type=text]"),i=n.value;c.error=i&&""!==i?null:{errorMessage:r.instant("objects.select.params.emptydelimiter"),errorType:"warning"}}}}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=s3-select-params> <section class=\"s3-select-params-section s3-select-file-format\"> <div class=s3-select-params-radio-button-group> <h4 class=s3-select-params-header>{{'objects.select.params.fileformat' | translate}} <awsui-tooltip text=\"{{ 'objects.select.tooltip.fileformat' | translate }}\" position=right size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip></h4> <awsui-radio-group ng-if=!vm.disabled value={{vm.fileParams.fileType}} ng-model=vm.fileParams.fileType> <div ng-repeat=\"fileType in vm.FILE_TYPES\"> <awsui-radio-button class=awsui-radio-button-container value={{fileType.value}} label={{fileType.label}}> </awsui-radio-button> </div> </awsui-radio-group> <div ng-if=vm.disabled>{{vm.fileParams.fileType}}</div> </div> <div class=s3-select-params-radio-button-group ng-if=\"!vm.disabled && vm.fileParams.fileType === 'CSV'\"> <section class=s3-select-params-section> <h4 class=s3-select-params-header>{{'objects.select.params.delimiter' | translate}}</h4> <awsui-radio-group ng-model=vm.fileParams.delimiterType change=vm.onChangeFileType()> <div ng-repeat=\"delimiter in vm.DELIMETERS\"> <awsui-radio-button class=awsui-radio-button-container value={{delimiter.value}} label={{delimiter.label}}></awsui-radio-button> <awsui-textfield class=awsui-textfield-container focus-fn=vm.focusInput id=customDelimiterTextfield ng-if=\"delimiter.value === 'Custom'\" blur=vm.onBlurDelimiter($event) ng-model=vm.fileParams.customDelimiter data-disabled=\"vm.fileParams.delimiterType!== 'Custom'\"></awsui-textfield> </div> </awsui-radio-group> <div ng-if=vm.error> <awsui-alert type={{vm.error.errorType}}>{{vm.error.errorMessage}}</awsui-alert> </div> </section> <section class=s3-select-params-section> <h4 class=s3-select-params-header>{{'objects.select.params.header' | translate}} <awsui-tooltip text=\"{{ 'objects.select.tooltip.header' | translate }}\" position=right size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip></h4> <awsui-checkbox class=s3-select-checkbox ng-model=vm.fileParams.useHeader> {{'objects.select.params.hasheader' | translate}} </awsui-checkbox> </section> </div> <div class=s3-select-params-radio-button-group ng-if=\"!vm.disabled && vm.fileParams.fileType === 'JSON'\"> <section class=s3-select-params-section> <h4 class=s3-select-params-header>{{'objects.select.params.jsontype' | translate}}</h4> <awsui-radio-group ng-model=vm.fileParams.jsonType> <div ng-repeat=\"jsonType in vm.JSON_TYPES\"> <awsui-radio-button class=awsui-radio-button-container value={{jsonType.value}} label={{jsonType.label}}></awsui-radio-button> </div> </awsui-radio-group> </section> </div> </section> <section class=s3-select-params-section> <h4 class=s3-select-params-header>{{'objects.select.params.encryption' | translate}} <awsui-tooltip text=\"{{ 'objects.select.tooltip.encryption' | translate }}\" position=right size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip> </h4> <div>{{vm.getEncryptionTranslation()}}</div> </section> <section class=s3-select-params-section> <h4 class=s3-select-params-header>{{'objects.select.params.size' | translate}}</h4> <div>{{vm.object.Size | humanReadableBytes}}</div> </section> <section class=s3-select-params-section> <div class=s3-select-params-radio-button-group> <h4 class=s3-select-params-header>{{'objects.select.params.compression' | translate}} <awsui-tooltip text=\"{{ 'objects.select.tooltip.compression' | translate }}\" position=right size=small> <i class=\"awsui-icon alert-info-circle\"></i> </awsui-tooltip></h4> <awsui-radio-group ng-if=\"!vm.disabled && vm.fileParams.fileType !== 'Parquet'\" value={{vm.fileParams.compressionType}} ng-model=vm.fileParams.compressionType> <div ng-repeat=\"compressionType in vm.COMPRESSION_TYPES\"> <awsui-radio-button class=awsui-radio-button-container value={{compressionType.value}} label={{compressionType.label}}> </awsui-radio-button> </div> </awsui-radio-group> <div ng-if=\"!vm.disabled && vm.fileParams.fileType === 'Parquet'\">{{'objects.select.params.nocompression' | translate}}</div> </div> <div ng-if=vm.disabled>{{ vm.fileParams.compressionType === 'NONE' ? 'objects.select.params.not.compressed' : 'objects.select.params.compressed' | translate:{compressionType: vm.fileParams.compressionType} }}</div> </section> </div>"},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("s3SelectEditor",[function(){return{restrict:"E",scope:{expression:"=",error:"=",onRunQuery:"&",region:"<"},template:n(799),transclude:!0,controllerAs:"vm",bindToController:!0,controller:"S3SelectEditorController"}}]),e.module("s3").controller("S3SelectEditorController",["$scope","$translate","$document","S3SelectConstants",function(e,t,n,r){function i(){var e=a.editorSession.getDocument(),t=a.editorSession.getSelection(),n=t.getCursor().row,r=e.getAllLines();if(t.isEmpty()){if(r[n]&&""!==r[n])return[r[n]];var i=r.filter(function(e){return e&&""!==e.trim()});return i.length>1?[i[0]]:i}return[e.getTextRange(t.getRange()).trim()]}var a=this;a.sampleQueries=["select * from s3object s","select s._1, s._2 from s3object s","select * from s3object s where s._N = 'xyz'","select * from s3object s where s._N like '%xyz%'","select * from s3object s where CAST(s._N as INTEGER) = 1234","select * from s3object s where CAST(s._N as FLOAT) > 12.34","select count(*) from s3object s","select s.key1 from S3Object s","select s.array1[0].key1 from S3Object s"],a.editorTab={selectedTab:"sqlEditor",tabs:[{label:t.instant("objects.select.editor.title"),id:"sqlEditor"},{label:t.instant("objects.select.sample.title"),id:"sqlSamples"}]},a.learnMoreUrl=r.S3_SELECT_SQL_REF_LINK,a.selectCostDisplay=r.S3_SELECT_COST_RATES[a.region],a.editorHeight=200,a.sampleTabStyles={height:200},e.$on("angular-resizable.resizeEnd",function(e,t){t.height&&(a.editorHeight=t.height,a.sampleTabStyles.height=t.height)}),a.runQuery=function(){var e=i();a.expression=e.length?e[0]:"",a.error=null,a.onRunQuery({expression:a.expression})},a.sqlEditorLoaded=function(e){a.editor=e,a.editorSession=e.getSession(),a.editorSession.getDocument().setValue("select * from s3object s limit 5")},a.sqlEditorChanged=function(){var e=a.editorSession.getValue().trim();a.runButtonDisabled=!e||0===e.length},a.insertQuery=function(e){var t=a.editorSession.getDocument(),n=t.getAllLines().length;t.insertLines(n,[e]),a.editorTab.selectedTab="sqlEditor"},a.copyExpression=function(){a.editor.focus();var e=a.editorSession.getSelection();e.selectAll(),n.get(0).execCommand("copy"),e.clearSelection()}}])}()}).call(t,n(0))},function(e,t){e.exports="<div class=s3-select-editor-container> <h3 translate=objects.select.editor.header></h3> <p class=s3-select-pricing-text> <span translate=objects.select.pricing></span><br/> <span>{{ 'objects.select.editor.costwarning' | translate:vm.selectCostDisplay }}</span> </p> <awsui-tabs class=s3-select-tabs tabs=vm.editorTab.tabs ng-model=vm.editorTab.selectedTab> <awsui-button class=s3-select-editor-help-link target=_blank href={{vm.learnMoreUrl}} variant=link icon=external-link> <span translate>learn.more</span> </awsui-button> <div ng-show=\"vm.editorTab.selectedTab === 'sqlEditor'\" class=s3-select-editor-tab resizable r-directions=\"['bottom']\" r-height=vm.editorHeight> <div class=s3-select-editor ui-ace=\"{\n                        autoScrollEditorIntoView: true,\n                        maxLines: 10,\n                        minLines: 5,\n                        blockScrolling: 'Infinity',\n                        useWrapMode : true,\n                        showGutter: true,\n                        mode: 'sql',\n                        firstLineNumber: 1,\n                        onLoad: vm.sqlEditorLoaded,\n                        onChange: vm.sqlEditorChanged\n                    }\"> </div> </div> <div ng-show=\"vm.editorTab.selectedTab === 'sqlSamples'\" class=s3-select-editor-tab ng-style=vm.sampleTabStyles> <table class=s3-select-sample-table> <tr ng-repeat=\"query in vm.sampleQueries\"> <td>{{query}}</td> <td class=action><awsui-button text=\"{{'objects.select.expression.insert' | translate}}\" variant=normal click=vm.insertQuery(query)></awsui-button></td> </tr> </table> </div> </awsui-tabs> <div class=\"s3-select-button-container buttons-on-right\"> <awsui-button id=select-copy-sql text=\"{{'objects.select.expression.copy' | translate}}\" variant=normal disabled=\"vm.editorTab.selectedTab === 'sqlSamples'\" click=vm.copyExpression()></awsui-button> <awsui-button id=select-run text=\"{{'objects.select.expression.run' | translate}}\" variant=primary disabled=\"vm.runButtonDisabled || vm.editorTab.selectedTab === 'sqlSamples' || queryInProgress\" click=vm.runQuery()></awsui-button> </div> </div>"},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i,a,o){function s(o,s,c){return void 0===c&&(c={}),i.isFeatureEnabled(a.FAC.KMS)?t.getKmsKeys(o,s,c).then(function(e){var t=e.response,i=t.Keys;return n.log("GetKMSKeys",1,o),i.map(function(e){return{arn:e.KeyArn,id:e.KeyId,text:r.getKmsKeyAlias(e)}})}).catch(function(t){return n.log("GetKMSKeys",0,o,t),e.reject(r.handleErrors(t))}):(n.log(a.LOGGING.FAC_MISMATCH_PREFIX+"GetKMSKeys",1,o),e.reject("KMS unavailable"))}function c(e,t){if(t){var n={value:t,text:o.instant("objectproperties.kms.customarn")};e=e.concat([n])}return e}function l(e,t,n,r){return s(e,t,r).then(function(e){return c(e.map(function(e){return{value:e.arn,text:e.text}}),n)})}function u(e,t,n,r){return s(e,t,r).then(function(e){return c(e.map(function(e){return{value:e.id,text:e.text}}),n)})}return{getKMSKeysByArn:l,getKMSKeysById:u}}e.module("s3").factory("KMSPropertiesService",["$q","APIProxyService","SCLogService","UtilService","FAC","S3Constants","$translate",t])}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").service("IAMPropertiesService",["$window","$q","APIProxyService","IAMService","PathService","S3Constants","SCLogService","UtilService",function(e,t,n,r,i,a,o,s){function c(e){var i=a.IAM_ENDPOINT_MAPPING[s.getCloudSystem()];return n.makeProxyRequest(r.listRoles,{region:i,params:{MaxItems:a.API_MAX_ITEMS.IAM_LIST_ROLES}},a.PROXY_API_NAMES.IAM.LIST_ROLES,e).then(function(t){var n=t.response.ListRolesResponse.ListRolesResult.Roles;return o.logRequestComplete("listRoles",e),n}).catch(function(n){return o.log("listRoles",0,e,n),t.reject(s.handleErrors(n))})}function l(e,i){var c=a.IAM_ENDPOINT_MAPPING[s.getCloudSystem()];return n.makeProxyRequest(r.listAttachedRolePolicies,{region:c,params:{RoleName:e,MaxItems:a.API_MAX_ITEMS.IAM_ATTACHED_POLICIES}},a.PROXY_API_NAMES.IAM.LIST_ATTACHED_ROLE_POLICIES,i).then(function(e){var t=e.response.ListAttachedRolePoliciesResponse.ListAttachedRolePoliciesResult.AttachedPolicies;return o.logRequestComplete("listAttachedRolePolicies",i),t}).catch(function(e){return o.log("listAttachedRolePolicies",0,i,e),t.reject(s.handleErrors(e))})}function u(e,i){var c=a.IAM_ENDPOINT_MAPPING[s.getCloudSystem()];return n.makeProxyRequest(r.listPolicyVersions,{region:c,params:{PolicyArn:e,MaxItems:a.API_MAX_ITEMS.IAM_ATTACHED_POLICIES_VERSIONS}},a.PROXY_API_NAMES.IAM.LIST_POLICY_VERSIONS,i).then(function(e){var t=e.response.ListPolicyVersionsResponse.ListPolicyVersionsResult.Versions;return o.logRequestComplete("listPolicyVersions",i),t}).catch(function(e){return o.log("listPolicyVersions",0,i,e),t.reject(s.handleErrors(e))})}function d(e,i,c){var l=a.IAM_ENDPOINT_MAPPING[s.getCloudSystem()];return n.makeProxyRequest(r.getPolicyVersion,{region:l,params:{PolicyArn:e,VersionId:i}},a.PROXY_API_NAMES.IAM.GET_POLICY_VERSIONS,c).then(function(e){var t=e.response.GetPolicyVersionResponse.GetPolicyVersionResult.PolicyVersion.Document;return o.logRequestComplete("listPolicyVersions",c),t}).catch(function(e){return o.log("listPolicyVersions",0,c,e),t.reject(s.handleErrors(e))})}return{listRoles:c,listAttachedRolePolicies:l,listPolicyVersions:u,getPolicyVersion:d}}])}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").constant("AnalyzeAccessConstants",{BUCKET_NAME:"bucket_name",ACCESS:"access",WORLD_WRITE:"s3_world_writability",WORLD_READ:"s3_world_readability",ACL_WRITE:"acl_write",ACL_READ:"acl_read",POLICY_WRITE:"policy_write",POLICY_READ:"policy_read",VALUES:{TRUE:"true",FALSE:"false",UNKNOWN:"unknown"},LABELS:{EVERYONE:"modal.permission.allusers",NOT_EVERYONE:"lamb.column.value.not.everyone",PUBLIC:"world.access.public.label",NOT_PUBLIC:"world.access.not.public.label",ACL:"ACL",POLICY:"bucketproperties.sideconfigpanel.bucketPolicy",UNKNOWN:"world.access.public.undetermined.label",NOT_SUPPORTED:"world.access.not.supported.label",ERROR:"error.header"},MAX_CALLS:16,SLEEP_TIME:100})}()}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){function n(n,r,i,a,o,s,c,l){function u(a,u){void 0===u&&(u=!0);var d=n.defer(),p={},f=Promise.resolve(),g=function(e,t){p[e.Name]=t,d.notify({bucket:e,AccessType:t})};return a=a.filter(function(e){if(u){var t=l.getAccessAnalysis(e.Name);if(t)return f=f.then(function(){return g(e,t.access_type)}),!1}return r.isFeatureEnabled(i.FAC.ACCESS)&&r.isFeatureEnabled(i.FAC.PUBLIC_ACCESS_BLOCK)?(e.Region||(f=f.then(function(){return g(e,null)})),e.Region):(f=f.then(function(){return g(e,null)}),!1)}),t.chain(a).groupBy("Region").map(function(e,t){return{buckets:e,region:t}}).sort(function(e){return e.buckets.length}).value().forEach(function(n){for(var r=n.buckets,a=n.region,u=new c(i.OPERATION_NAME.ANALYZE_ACCESS),d=0;d<r.length/i.BATCH_OPS_MAX_KEYS_PER_OP;d++)!function(n){var c=n*i.BATCH_OPS_MAX_KEYS_PER_OP,d=r.slice(c,c+i.BATCH_OPS_MAX_KEYS_PER_OP),p={accountId:o.getUserAccountId(),bucketsPayload:d.map(function(e){return{bucket:e.Name,region:e.Region}})};f=f.then(function(){return s.makeS3ConsoleCommandRequest(p,i.CWS_OPERATION_NAME.ANALYZE_PUBLIC_ACCESS,{},u,a).then(function(n){var r=t.indexBy(d,"Name");n.data.statusPerBucket.forEach(function(n){var a=null;if(n.bucket in r&&n.result.status===i.OPERATION_PER_KEY_STATUS.DONE){var o=e.fromJson(t.get(n,"result.additionalInfoWhenSuccess"));l.putAccessAnalysis(n.bucket,o),a=o.access_type}g(r[n.bucket],a)})},function(e){d.forEach(function(e){return g(e,null)})})})}(d)}),f.then(function(){d.resolve(p)}),d.promise}return{analyzeAccess:u}}e.module("s3").factory("AnalyzeAccessService",["$q","FAC","S3Constants","AnalyzeAccessConstants","UtilService","S3CWSAPIService","ConsoleOperation","CachingService",n])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){!function(){function n(e,n){function r(e){var t={};return t.bucketReadPublic=l(e,n.WORLD_READ),t.bucketWritePublic=l(e,n.WORLD_WRITE),t.bucketNotPublic=o(e),t.bucketPublic=a(e),t.aclPublic=s(e),t.policyPublic=c(e),t}function i(t,i){var a={};i||(i=r(t));var o=d(t,n.WORLD_READ);o===p.TRUE?a.bucketReadPublic=e.instant(f.EVERYONE):o===p.FALSE?a.bucketReadPublic=e.instant(f.NOT_EVERYONE):o===p.UNKNOWN?a.bucketReadPublic=e.instant(f.UNKNOWN):a.bucketReadPublic=e.instant(f.ERROR);var s=d(t,n.WORLD_WRITE);s===p.TRUE?a.bucketWritePublic=e.instant(f.EVERYONE):s===p.FALSE?a.bucketWritePublic=e.instant(f.NOT_EVERYONE):s===p.UNKNOWN?a.bucketWritePublic=e.instant(f.UNKNOWN):a.bucketWritePublic=e.instant(f.ERROR),i.bucketPublic?a.bucketPublic=e.instant(f.PUBLIC):i.bucketNotPublic?a.bucketPublic=e.instant(f.NOT_PUBLIC):o===p.UNKNOWN&&s===p.UNKNOWN?a.bucketPublic=e.instant(f.UNKNOWN):a.bucketPublic=e.instant(f.ERROR);var c="";if(i.aclPublic&&(a.source=f.ACL,c=", "),i.policyPublic){var l=e.instant(f.POLICY);c?a.source+=c+l:a.source=l}return a}function a(e){return u(e,n.WORLD_READ,n.WORLD_WRITE)===p.TRUE}function o(e){return u(e,n.WORLD_READ,n.WORLD_WRITE)===p.FALSE}function s(e){return u(e,n.ACL_READ,n.ACL_WRITE)===p.TRUE}function c(e){return u(e,n.POLICY_READ,n.POLICY_WRITE)===p.TRUE}function l(e,t){return d(e,t)===p.TRUE}function u(e,t,n){var r=d(e,t),i=d(e,n);return r===p.TRUE||i===p.TRUE?p.TRUE:r===p.FALSE&&i===p.FALSE?p.FALSE:p.UNKNOWN}function d(e,r){return t.get(e,n.ACCESS+"."+r)}var p=n.VALUES,f=n.LABELS;return{getAccessStatus:r,getAccessLabels:i}}e.module("s3").service("AnalyzeAccessUtilService",["$translate","AnalyzeAccessConstants",n])}()}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}e.module("s3").directive("sidebarNavigation",[function(){return{restrict:"E",scope:{},bindToController:{open:"<?"},transclude:!0,template:n(806),controller:"SidebarNavigationController",controllerAs:"vm"}}]),e.module("s3").controller("SidebarNavigationController",["$scope","$location","$window","Region","FAC","S3Constants","SpotlightDataService",function(n,i,a,o,s,c,l){var u=l.get(),d=this;d.sidebarItems=[[{translationId:"lamb.label.buckets",targetPath:"home",subPaths:["buckets","object"]},{translationId:"job_management.sidebar.title",targetPath:"jobs",subPaths:[],fac:c.FAC.BATCH_OPERATIONS}],[{translationId:"lockdown.sidebar.title",targetPath:"settings",subPaths:[],fac:c.FAC.PUBLIC_ACCESS_BLOCK}],[{translationId:"spotlight.sidebar.title",targetPath:"spotlight",subPaths:[],fac:c.FAC.FEATURE_SPOTLIGHT,badge:u.features.length}]],d.sidebarItems=d.sidebarItems.map(function(e){return e.filter(function(e){return!e.fac||s.isFeatureEnabled(e.fac)})}).filter(function(e){return e.length>0}),d.getPath=function(e){return"/s3/"+e.targetPath+"?region="+o.getCurrentRegion()},d.isItemSelected=function(e){return t.some([e.targetPath].concat(r(e.subPaths)),function(e){return 0===i.path().indexOf("/"+e)})},d.currentRegion=o.getCurrentRegion(),d.isAccountSettingsSelected="/settings"===i.path();var p=a.localStorage.getItem(c.SPOTLIGHT_STORAGE_KEY);d.showSpotlightBadge=!p||p<Number(u.version),n.$watch("vm.open",function(t){d.sidebarOpen=!e.isDefined(t)||t}),d.toggleSidebar=function(){d.sidebarOpen=!d.sidebarOpen};var f=function(){var e=t.get(a,"innerHeight",0),n=t.get(document.getElementById("h"),"offsetHeight",0),r=t.get(document.getElementById("f"),"offsetHeight",0),i=e-n-r;document.getElementById("sidebarNavDiv").style.height=i>0?i+"px":null};a.addEventListener("resize",f),f(),n.$on("$destroy",function(){a.removeEventListener("resize",f)})}])}).call(t,n(0),n(2))},function(e,t){e.exports='<div id=sidebarNavDiv class=sidebar-navigation-container> <div class=sidebar-nav-bar> <nav class="awsui sidebar-nav-menu" ng-show=vm.sidebarOpen> <div class=sidebar-logo> <span translate>breadcrumbs.amazons3</span> </div> <ul class=sidebar-nav-menu__group ng-class="{ \'sidebar-nav-menu__group--single\': itemGroup.length === 1 }" ng-repeat="itemGroup in vm.sidebarItems"> <li ng-repeat="item in itemGroup" class=sidebar-nav-menu__option ng-class="{\'sidebar-nav-menu__option--active\': vm.isItemSelected(item) }"> <a class=sidebar-nav-menu__link ng-href="{{ vm.getPath(item) }}" translate>{{ item.translationId }}</a><awsui-badge ng-if="item.badge && vm.showSpotlightBadge" value={{item.badge}}></awsui-badge> </li> </ul> </nav> <div class=sidebar-nav-divider ng-class="{\'sidebar-nav-divider--closed\': !vm.sidebarOpen }"> <span class="sidebar-nav-divider__toggle awsui-icon caret-left" ng-class="vm.sidebarOpen ? \'caret-left\' : \'caret-right\' " ng-click=vm.toggleSidebar()></span> </div> </div> <div class=sidebar-nav-main-content ng-class="{\'sidebar-nav-main-content--closed\': !vm.sidebarOpen }" ng-transclude> </div> </div>'},function(e,t,n){"use strict";(function(e){function t(t,n){function r(){var t={useWrapMode:!0,showGutter:!0,firstLineNumber:1};s.editorOptions=e.extend({},t,s.editorOverrideOptions||{},{mode:s.mode,onLoad:i,onChange:a})}function i(e){s.editorInstance=e,s.editorInstance.on("input",o),s.editorInstance.on("change",o),o(),s.onLoad&&s.onLoad({editor:s.editorInstance})}function a(){s.onChange&&s.onChange({editor:s.editorInstance})}function o(){var e=s.editorInstance;if(e){var t=s.placeholder&&!e.session.getValue().length,n=e.renderer.emptyMessageNode;!t&&n?(e.renderer.scroller.removeChild(e.renderer.emptyMessageNode),e.renderer.emptyMessageNode=null):t&&!n&&(n=e.renderer.emptyMessageNode=document.createElement("pre"),n.textContent=s.placeholder,n.className="code-editor__placeholder ace_invisible ace_emptyMessage",e.renderer.scroller.appendChild(n))}}var s=this;s.$onInit=function(){s.editorInstance=null,s.editorOptions=null,n(function(){r(),t.$watch("vm.mode",r),t.$watch("vm.editorOverrideOptions",r,!0),t.$watch("vm.placeholder",function(e){s.editorInstance&&o()})})}}e.module("s3").directive("codeEditor",function(){return{restrict:"E",scope:{},bindToController:{mode:"@",editorOverrideOptions:"<?editorOptions",onLoad:"&?",onChange:"&?",placeholder:"@?"},template:'<div class="code-editor" ui-ace="vm.editorOptions" />',controller:"CodeEditorController",controllerAs:"vm"}}),e.module("s3").controller("CodeEditorController",["$scope","$timeout",t])}).call(t,n(0))},function(e,t,n){"use strict";(function(e,t){var n;!function(t){var n=function(){function e(){}return e.prototype.get=function(e,n,r){return void 0===r&&(r=[]),new t.TableSelection(e,n,r)},e}();t.TableSelectionService=n;var r=function(){function t(e,t,n){void 0===n&&(n=[]),this.multipleSelection=e,this.onSelectionUpdate=t,this.availableItems=n,this.allItemsSelected=!1,this.updateSelectedItems()}return t.prototype.updateAvailableItems=function(e){this.deselectRemovedItems(this.availableItems||[],e||[]),this.availableItems=e||[],this.updateSelectedItems(),this.checkIfAllKeysAreSelected()},t.prototype.getSelectedItems=function(){return this.selectedItems},t.prototype.selectOneItem=function(e){this.resetSelection(),this.setItemValue(e,!0),this.updateShiftSelectAxis(e),this.triggerUpdate()},t.prototype.toggleItem=function(e){if(this.multipleSelection){var t=this.isSelected(e);this.setItemValue(e,!t),this.updateShiftSelectAxis(e),this.triggerUpdate()}else this.selectOneItem(e)},t.prototype.updateAllItemsSelection=function(){var e=this,t=this.allItemsSelected;!this.multipleSelection&&t||(this.availableItems.forEach(function(n){return e.setItemValue(n,t)}),this.triggerUpdate())},t.prototype.resetSelection=function(e){var t=this;void 0===e&&(e=!0),this.allItemsSelected=!1,this.availableItems.forEach(function(e){return t.setItemValue(e,!1)}),e&&this.triggerUpdate()},t.prototype.checkIfAllKeysAreSelected=function(){this.availableItems.length>0?this.allItemsSelected=e.every(this.availableItems,this.isSelected):this.allItemsSelected=!1},t.prototype.shiftSelect=function(e){if(this.multipleSelection){this.resetSelection();var t=this.availableItems;if(t&&t.length>0&&!this.shiftSelectAxis&&(this.shiftSelectAxis=t[0]),e===this.shiftSelectAxis)return void this.toggleItem(e);var n=!1;if(t)for(var r=0,i=t;r<i.length;r++){var a=i[r];if(n&&this.setItemValue(a,!0),a===e||a===this.shiftSelectAxis){if(n)break;n=!0,this.setItemValue(a,!0)}}this.triggerUpdate()}},t.prototype.deselectRemovedItems=function(t,n){var r=this;e.filter(t,function(t){return t.selected&&!e.includes(n,t)}).forEach(function(e){return r.setItemValue(e,!1)})},t.prototype.updateSelectedItems=function(){this.selectedItems=e.filter(this.availableItems,function(e){return e.selected})},t.prototype.isSelected=function(t){return e.has(t,"selected")&&t.selected},t.prototype.setItemValue=function(e,t){e.selected=t},t.prototype.updateShiftSelectAxis=function(e){this.shiftSelectAxis=e},t.prototype.triggerUpdate=function(){this.updateSelectedItems(),this.checkIfAllKeysAreSelected(),this.onSelectionUpdate&&this.onSelectionUpdate()},t}();t.TableSelection=r}(n||(n={})),t.module("s3").service("TableSelectionService",[n.TableSelectionService]).factory("TableSelectionClass",function(){return n.TableSelection})}).call(t,n(2),n(0))},function(e,t,n){"use strict";(function(e){function t(e,t){var n=this;n.isOpen=!1;var r=function(e){return e[0].items?e:[{items:e}]};e.$watch("vm.items",function(e){n.groups=r(e)}),n.toggle=function(){n.disabled||(n.isOpen=!n.isOpen)},n.close=function(){n.isOpen=!1},n.select=function(e){e.disabled||(n.selectedItem!==e&&(n.selectedItem=e,n.change&&t(function(){n.change({item:e})})),n.close())}}e.module("s3").directive("dropdownSimple",function(){return{restrict:"E",scope:{},bindToController:{items:"<",selectedItem:"=",placeholder:"@",disabled:"<?",fillHeight:"<?",label:"@?",altStyle:"@?",change:"&?"},template:n(810),controller:"DropdownSimpleController",controllerAs:"vm"}}),e.module("s3").controller("DropdownSimpleController",["$scope","$timeout",t])}).call(t,n(0))},function(e,t){e.exports="<div class=dropdown-simple ng-class=\"{ 'dropdown-simple--open': vm.isOpen, 'dropdown-simple--fill-height': vm.fillHeight, 'dropdown-simple--alt': vm.altStyle }\" clickoutside on-click-outside=vm.close> <div class=\"dropdown-simple__value awsui-select-target\" ng-click=vm.toggle()> <span class=dropdown-simple__label ng-if=vm.label>{{ vm.label }}:</span> {{ vm.selectedItem ? vm.selectedItem.text : vm.placeholder }} </div> <div class=dropdown-simple__list> <div class=dropdown-simple__group ng-repeat=\"group in vm.groups\"> <div class=dropdown-simple__item ng-repeat=\"item in group.items\" ng-click=vm.select(item) ng-class=\"{ 'dropdown-simple__item--selected': item === vm.selectedItem, 'dropdown-simple__item--disabled': item.disabled }\"> <div class=dropdown-simple__item-content> <div class=dropdown-simple__item-label>{{ item.text }}</div> <div class=dropdown-simple__item-description ng-if=item.description>{{ item.description }}</div> </div> <div class=dropdown-simple__item-count ng-if=item.count>{{ item.count }}</div> </div> </div> </div> </div>"},function(e,t,n){"use strict";(function(e){function t(){}e.module("s3").controller("AccountSettingsController",[t])}).call(t,n(0))},function(e,t,n){"use strict";(function(e){function t(e){var t=this,n=e.instant("lockdown.modal.confirmation.word"),r=function(){t.isOpen.flag=!1,t.confirmationInfo.input=""};t.confirmationInfo={word:n,label:e.instant("lockdown.modal.confirmation.type",{word:n}),input:""},t.checkConfirmationWord=function(){t.wordChecked=n===t.confirmationInfo.input},t.confirm=function(){r(),t.confirmCallback&&t.confirmCallback()},t.cancel=function(){r(),t.cancelCallback&&t.cancelCallback()}}e.module("s3").directive("publicAccessConfirmationModal",[function(){return{restrict:"E",scope:{},bindToController:{headerTitle:"<",isOpen:"=",warningMessage:"<",cancelCallback:"&?",confirmCallback:"&"},template:n(813),controller:"PublicAccessConfirmationModalController",controllerAs:"vm"}}]),e.module("s3").controller("PublicAccessConfirmationModalController",["$translate",t])}).call(t,n(0))},function(e,t){e.exports='<dialog-modal class=public-access-confirmation-modal is-open=vm.isOpen close-callback=cancel() header-title=vm.headerTitle> <dialog-modal-content> <div class=public-access-confirmation-modal__content> <awsui-alert type=warning> <span ng-bind-html="vm.warningMessage | trusted"></span> </awsui-alert> <p class=public-access-confirmation-modal__label ng-bind-html="vm.confirmationInfo.label | trusted"></p> <awsui-textfield id=publicAccessConfirmationInput ng-keyup=vm.checkConfirmationWord($event) autocomplete=off ng-model=vm.confirmationInfo.input placeholder={{vm.confirmationInfo.word}}></awsui-textfield> </div> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=publicAccessConfirmationCancelButton class=public-access-confirmation-modal__cancel-button text="{{ \'button.cancel\' | translate }}" variant=normal click=vm.cancel()></awsui-button> <awsui-button id=publicAccessConfirmationConfirmButton click=vm.confirm() variant=primary data-disabled=!vm.wordChecked text="{{ \'confirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal> '},function(e,t,n){"use strict";(function(e,t){function r(e,n,r,i,a,o,s,c){var l=this;l.isPublicAccessBlockAvailable=r.isFeatureEnabled(n.FAC.PUBLIC_ACCESS_BLOCK),l.docLink=s.getDocUrl(n.LEARN_MORE_LINKS.PUBLIC_ACCESS_BLOCK),l.isLoadingInitialSettings=!1,l.isEditing=!1,l.mode=t.isEmpty(l.bucket)?n.PUBLIC_ACCESS_BLOCK.MODE.ACCOUNT:n.PUBLIC_ACCESS_BLOCK.MODE.BUCKET,l.showSuccessMessage=!1,l.showAccountWarning=!1,l.hasViewPermission=!0,l.hasEditPermission=!0,l.confirmationModal={isOpen:{flag:!1},title:e.instant("lockdown.modal.title."+l.mode)},l.showConfirmationModal={flag:!1},l.currentSettings={blockPublicAcls:void 0,ignorePublicAcls:void 0,blockPublicPolicy:void 0,restrictPublicBuckets:void 0},l.settingsDetailOptions=i.getSettingsDetailOptions(),l.enableEditSettings=function(){l.hasEditPermission&&(l.previousSettings=t.clone(l.currentSettings),l.isEditing=!0,l.showSuccessMessage=!1)},l.refresh=function(){return l.errorMessage=void 0,l.isRefreshing=!0,(l.mode===n.PUBLIC_ACCESS_BLOCK.MODE.ACCOUNT?p:f)().then(function(e){l.currentSettings=t.clone(e),l.previousSettings=t.clone(e)}).catch(function(n){"AccessDenied"===t.get(n,"errorCode")?l.errorMessage=e.instant("lockdown.error.noviewpermission"):l.errorMessage=e.instant("utilities.unknown.error"),l.hasViewPermission=!1}).finally(function(){c.customerReady("BlockPublicAccess"),l.isRefreshing=!1})},l.cancel=function(){l.isEditing=!1,l.currentSettings=l.previousSettings},l.save=function(){l.isSaving=!0,t.defaults(l.currentSettings,{blockPublicAcls:!1,ignorePublicAcls:!1,blockPublicPolicy:!1,restrictPublicBuckets:!1}),(l.mode===n.PUBLIC_ACCESS_BLOCK.MODE.ACCOUNT?u:d)().then(function(){if(l.onSettingsChange)return l.onSettingsChange()}).then(function(){l.isEditing=!1,l.showSuccessMessage=!0,l.errorMessage=void 0}).catch(function(n){"AccessDenied"===t.get(n,"errorCode")?(l.errorMessage=e.instant("lockdown.error.noeditpermission"),l.hasEditPermission=!1):l.errorMessage=e.instant("utilities.unknown.error")}).finally(function(){l.isSaving=!1})},l.openConfirmationDialog=function(){if(l.confirmationModal.isOpen.flag=!0,l.mode===n.PUBLIC_ACCESS_BLOCK.MODE.ACCOUNT){l.confirmationModal.warningMessage=e.instant("lockdown.warning.affects.all");var t=new o("CountLAMBcall","StartLAMBcall");a.listAllMyBuckets(t,!0).then(function(t){var n=t.response.ListAllMyBucketsResult.Buckets.Bucket.length;l.confirmationModal.warningMessage+=e.instant("lockdown.warning.affects.total",{countBuckets:n})}).catch(function(e){})}else l.confirmationModal.warningMessage=e.instant("lockdown.warning.affects.current")};var u=function(){return i.putAccountSettings(l.currentSettings)},d=function(){return i.putSingleBucketSettings(l.currentSettings,l.bucket)},p=function(){return i.getAccountSettings()},f=function(){return i.getBucketSettings(l.bucket)};!function(){l.isLoadingInitialSettings=!0,l.refresh().finally(function(){l.isLoadingInitialSettings=!1}),l.mode===n.PUBLIC_ACCESS_BLOCK.MODE.BUCKET&&p().then(function(e){l.showAccountWarning=e.blockPublicAcls||e.ignorePublicAcls||e.blockPublicPolicy||e.restrictPublicBuckets}).catch(function(){l.showAccountWarning=!1})}()}e.module("s3").directive("publicAccessSettingsPanel",[function(){return{restrict:"E",scope:{},bindToController:{bucket:"<?",onSettingsChange:"&?"},template:n(815),controller:"PublicAccessSettingsPanelController",controllerAs:"vm"}}]),e.module("s3").controller("PublicAccessSettingsPanelController",["$translate","S3Constants","FAC","PublicAccessService","APIProxyService","ConsoleOperation","AwsUrlsService","PerformanceUtilsService",r])}).call(t,n(0),n(2))},function(e,t){e.exports='<div ng-if=vm.isPublicAccessBlockAvailable> <div class=public-access-settings__panel-header> <span translate=lockdown.settings.title.{{vm.mode}}></span> </div> <div class=public-access-settings__panel-description> <span translate=lockdown.settings.description.{{vm.mode}}></span> <learn-more-link href={{vm.docLink}}></learn-more-link> </div> <awsui-alert ng-if=vm.showAccountWarning type=info id=publicAccessAccountWarning content="{{ \'lockdown.warning.accountsettings\' | translate }}"></awsui-alert> <awsui-alert class=awsui-alert__header--hidden ng-if=vm.errorMessage content={{vm.errorMessage}} type=error id=publicAccessSavingError header="{{ \'error.header\' | translate }}"></awsui-alert> <awsui-alert type=success dismissible=true visible=vm.showSuccessMessage id=publicAccessSuccessUpdated header="{{ \'lockdown.success.updated\' | translate }}"></awsui-alert> <div ng-if=vm.isLoadingInitialSettings class=public-access-settings__loading><span class="awsui-spinner awsui-spinner-large"></span></div> <div ng-if="!vm.isLoadingInitialSettings && vm.hasViewPermission" class=public-access-settings> <div class=public-access-settings__buttons> <awsui-tooltip ng-if=!vm.isEditing text="{{ vm.hasEditPermission ? \'\' : \'lockdown.error.noeditpermission\' | translate }}" position=left size=small> <awsui-button id=publicAccessSettingsEditButton data-disabled=!vm.hasEditPermission variant=normal ng-click=vm.enableEditSettings()> <span translate=button.edit></span> </awsui-button> </awsui-tooltip> <div ng-if=vm.isEditing> <awsui-button id=publicAccessSettingsCancelButton text="{{ \'button.cancel\' | translate }}" variant=normal data-disabled="vm.isSaving || vm.isRefreshing" click=vm.cancel()> </awsui-button> <awsui-button id=publicAccessSettingsSaveButton text="{{ \'button.save\' | translate }}" variant=primary data-disabled="vm.isRefreshing || !vm.hasEditPermission" click=vm.openConfirmationDialog() loading=vm.isSaving class=primary-button> </awsui-button> </div> </div> <checkbox-tree is-editing=vm.isEditing checkbox-config=vm.settingsDetailOptions settings-data=vm.currentSettings></checkbox-tree> </div> <public-access-confirmation-modal header-title=vm.confirmationModal.title confirm-callback=vm.save() warning-message=vm.confirmationModal.warningMessage is-open=vm.confirmationModal.isOpen></public-access-confirmation-modal> </div> '},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i,a){var o=this;o.headerTitle=t.instant("lockdown.modal.title.selected"),o.editModal={isOpen:{flag:o.isOpen.flag}},o.confirmationModal={isOpen:{flag:!1},warningMessage:t.instant("lockdown.warning.affects.selected")},o.currentSettings={blockPublicAcls:!1,ignorePublicAcls:!1,blockPublicPolicy:!1,restrictPublicBuckets:!1},o.confirm=function(){o.editModal.isOpen.flag=!1,o.confirmationModal.isOpen.flag=!0},o.cancel=function(){o.isOpen.flag=!1},o.save=function(){var e=i.createBulkOperation(n.OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS_BATCH,o.selectedBuckets,null,null,o.currentSettings);e.finishCallBack=function(){o.bucketChangedCallback&&o.selectedBuckets.forEach(function(e){return o.bucketChangedCallback(e)}),a.operationDoneCallBack(e.id)},a.addOperation(e),o.isOpen.flag=!1}}e.module("s3").directive("editPublicAccessModal",[function(){return{restrict:"E",scope:{},bindToController:{isOpen:"=",selectedBuckets:"<",publicBucketsCount:"<",bucketChangedCallback:"<"},template:n(817),controller:"EditPublicAccessModalController",controllerAs:"vm"}}]),e.module("s3").controller("EditPublicAccessModalController",["$scope","$translate","S3Constants","PublicAccessService","BulkOperationService","OperationDispatcherService",t])}).call(t,n(0))},function(e,t){e.exports='<dialog-modal class="edit-public-access-modal large-modal" is-open=vm.editModal.isOpen close-callback=vm.cancel() header-title=vm.headerTitle> <dialog-modal-content> <div class=edit-public-access-modal__subheader> <span translate=lockdown.modal.bucketCount translate-values="{ totalCount: vm.selectedBuckets.length, publicCount: vm.publicBucketsCount }"></span> </div> <div class=edit-public-access-modal__content> <bucket-public-access-section mode=selected public-access-settings=vm.currentSettings></bucket-public-access-section> </div> </dialog-modal-content> <dialog-modal-footer> <awsui-button id=editPublicAccessCancelButton class=public-access-confirmation-modal__cancel-button text="{{ \'button.cancel\' | translate }}" variant=normal click=vm.cancel()></awsui-button> <awsui-button id=editPublicAccessSaveButton click=vm.confirm() variant=primary text="{{ \'button.save\' | translate }}" class="awsui-util-f-r primary-button"> </awsui-button> </dialog-modal-footer> </dialog-modal> <public-access-confirmation-modal header-title=vm.headerTitle confirm-callback=vm.save() cancel-callback=vm.cancel() warning-message=vm.confirmationModal.warningMessage is-open=vm.confirmationModal.isOpen></public-access-confirmation-modal> '},function(e,t,n){"use strict";(function(e){function t(e,t,n,r){var i=this;i.docLink=n.getDocUrl(t.LEARN_MORE_LINKS.PUBLIC_ACCESS_BLOCK),i.settingsDetailOptions=r.getSettingsDetailOptions(),i.showAccountWarning=!1,function(){r.getAccountSettings().then(function(e){i.showAccountWarning=e.blockPublicAcls||e.ignorePublicAcls||e.blockPublicPolicy||e.restrictPublicBuckets}).catch(function(){i.showAccountWarning=!1})}()}e.module("s3").directive("bucketPublicAccessSection",[function(){return{restrict:"E",scope:{},bindToController:{mode:"@",publicAccessSettings:"="},template:n(819),controller:"BucketPublicAccessSectionController",controllerAs:"vm"}}]),e.module("s3").controller("BucketPublicAccessSectionController",["$scope","S3Constants","AwsUrlsService","PublicAccessService",t])}).call(t,n(0))},function(e,t){e.exports="<div id=public-access-permissions-section class=public-access-permissions-section> <span class=public-access-permissions-section__header translate=lockdown.settings.title.bucket></span> <div class=public-access-permissions-section__divider></div> <div class=public-access-permissions-section__label> <span translate=lockdown.settings.description.{{vm.mode}}></span> <learn-more-link light=true href={{vm.docLink}}></learn-more-link> </div> <awsui-alert ng-if=vm.showAccountWarning type=info id=publicAccessAccountWarning content=\"{{ 'lockdown.warning.accountsettings' | translate }}\"></awsui-alert> <checkbox-tree dark-mode=true is-editing=true checkbox-config=vm.settingsDetailOptions settings-data=vm.publicAccessSettings></checkbox-tree> </div> "},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){this.$translate=e}return e.prototype.$onInit=function(){this.updateMasterSelectionFromChildren()},e.prototype.$onChanges=function(e){e.isEditing&&this.updateMasterSelectionFromChildren()},e.prototype.updateMasterSelectionFromChildren=function(){var e=this;this.masterOptionSelected=this.checkboxConfig.options.every(function(t){return e.settingsData[t.settingId]})},e.prototype.updateCheckboxesFromMaster=function(){var e=this;this.checkboxConfig.options.forEach(function(t){e.settingsData[t.settingId]=e.masterOptionSelected})},e.prototype.getSettingEnabledText=function(e){return this.$translate.instant(e?this.checkboxConfig.valueText.enabled:this.checkboxConfig.valueText.disabled)},e.$inject=["$translate"],e}();t.CheckboxTreeController=i,r.module("s3").controller("CheckboxTreeController",i),r.module("s3").directive("checkboxTree",function(){return{restrict:"E",scope:{},bindToController:{isEditing:"<",checkboxConfig:"<",settingsData:"=",darkMode:"<?"},template:n(821),controller:i,controllerAs:"vm"}})},function(e,t){e.exports='<div class="checkbox-tree checkbox-tree--lines" ng-class="{\'checkbox-tree--dark\': vm.darkMode, \'checkbox-tree--editing\': vm.isEditing}"> <div class=checkbox-tree__master ng-if=vm.isEditing> <awsui-checkbox ng-model=vm.masterOptionSelected ng-change=vm.updateCheckboxesFromMaster()> <div class=checkbox-tree__header> <span translate={{vm.checkboxConfig.masterTitle}}></span> </div> <div class=checkbox-tree__description> <span translate={{vm.checkboxConfig.masterDescription}}></span> </div> </awsui-checkbox> </div> <div class=checkbox-tree__master ng-if=!vm.isEditing> <div class=checkbox-tree__header> <span translate={{vm.checkboxConfig.masterTitle}}></span> </div> <div> {{ vm.getSettingEnabledText(vm.masterOptionSelected) }} </div> </div> <ul class=checkbox-tree__options> <li ng-repeat="option in vm.checkboxConfig.options"> <awsui-checkbox ng-if=vm.isEditing ng-model=vm.settingsData[option.settingId] data-e2e-id={{option.settingId}}Checkbox disabled=vm.masterOptionSelected ng-change=vm.updateMasterSelectionFromChildren()> <div class=checkbox-tree__header> <span translate={{option.title}}></span> </div> <div class=checkbox-tree__description> <span translate={{option.description}}></span> </div> </awsui-checkbox> <div ng-if=!vm.isEditing> <div class=checkbox-tree__header> <span translate={{option.title}}></span> </div> <div class=checkbox-tree__value> {{ vm.getSettingEnabledText(vm.settingsData[option.settingId]) }} </div> </div> </li> </ul> </div> '},function(e,t,n){"use strict";(function(e,t){e.module("s3").service("PublicAccessService",["$q","$translate","APIProxyService","S3Constants","SCLogService","S3CWSAPIService","ConsoleOperation","UtilService","CachingService",function(e,n,r,i,a,o,s,c,l){function u(){var t=new s(i.OPERATION_NAME.GET_ACCOUNT_PUBLIC_ACCESS),n={accountId:c.getUserAccountId()};return o.makeS3ConsoleCommandRequest(n,i.CWS_OPERATION_NAME.GET_ACCOUNT_PUBLIC_ACCESS,{},t).then(function(n){return a.log(i.OPERATION_NAME.GET_ACCOUNT_PUBLIC_ACCESS,1,t),n.data.result.status===i.OPERATION_PER_KEY_STATUS.ERROR?e.reject(n.data.result):n.data.result.additionalInfoWhenSuccess}).catch(function(n){return a.log(i.OPERATION_NAME.GET_ACCOUNT_PUBLIC_ACCESS,0,t),e.reject(n)})}function d(t){var n=t.blockPublicAcls,r=t.ignorePublicAcls,u=t.blockPublicPolicy,d=t.restrictPublicBuckets,p={publicAccessSettings:{blockPublicAcls:n,ignorePublicAcls:r,blockPublicPolicy:u,restrictPublicBuckets:d},accountId:c.getUserAccountId()},f=new s(i.OPERATION_NAME.PUT_ACCOUNT_PUBLIC_ACCESS);return o.makeS3ConsoleCommandRequest(p,i.CWS_OPERATION_NAME.PUT_ACCOUNT_PUBLIC_ACCESS,{},f).then(function(t){if(t.data.result.status===i.OPERATION_PER_KEY_STATUS.ERROR)return e.reject(t.data.result);a.log(i.OPERATION_NAME.PUT_ACCOUNT_PUBLIC_ACCESS,1,f),l.evictAllAccessAnalysis()}).catch(function(t){return a.log(i.OPERATION_NAME.PUT_ACCOUNT_PUBLIC_ACCESS,0,f),e.reject(t)})}function p(n){var c={bucketsPayload:[{bucket:n}]},l={},u=new s(i.OPERATION_NAME.GET_BUCKET_PUBLIC_ACCESS);return r.getBucketLocation(u,n,l).then(function(){return c.bucketsPayload[0].region=l.region,o.makeS3ConsoleCommandRequest(c,i.CWS_OPERATION_NAME.GET_BUCKET_PUBLIC_ACCESS,{},u,l.region)}).then(function(n){return a.log(i.CWS_OPERATION_NAME.GET_BUCKET_PUBLIC_ACCESS,1,u),n.data.statusPerBucket[0].result.status===i.OPERATION_PER_KEY_STATUS.ERROR?e.reject(n.data.statusPerBucket[0].result):t.get(n.data,"statusPerBucket[0].result.additionalInfoWhenSuccess")}).catch(function(t){return a.log(i.CWS_OPERATION_NAME.GET_BUCKET_PUBLIC_ACCESS,0,u),e.reject(t)})}function f(n,r,o){var c=new s(i.CWS_OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS);return g(c,[{Name:r,Region:o}],n).then(function(n){return t.has(n,r)?n[r].status!==i.OPERATION_PER_KEY_STATUS.DONE?e.reject(n[r]):n[r]:(a.log(i.CWS_OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS+"BcktNotFound",1,c,n),e.reject("No response received"))}).catch(function(t){return e.reject(t)})}function g(t,n,s){var u=e.defer(),d={},p={bucketsPayload:[],publicAccessSettings:s},f=0,g=function(e,t){p.bucketsPayload.push({bucket:e,region:t})},m=function(){if(f>=n.length){if(0===p.bucketsPayload.length)return void u.resolve(d);o.makeS3ConsoleCommandRequest(p,i.CWS_OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS,{},t,p.bucketsPayload[0].region).then(function(e){a.log(i.CWS_OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS,1,t),e.data.statusPerBucket.forEach(function(e){d[e.bucket]=e.result,l.evictAccessAnalysis(e.bucket)}),u.resolve(d)}).catch(function(e){a.log(i.CWS_OPERATION_NAME.PUT_BUCKET_PUBLIC_ACCESS,0,t),u.reject(e)})}};return n.forEach(function(e){var n={},a=e.Name;if(e.Region)return g(e.Name,e.Region),f++,void m();r.getBucketLocation(t,a,n).then(function(){g(a,n.region)}).catch(function(e){d[a]={status:i.OPERATION_PER_KEY_STATUS.ERROR,errorMessage:c.handleErrors(e)}}).finally(function(){f++,m()})}),u.promise}function m(){return{masterTitle:"lockdown.blockall.title",masterDescription:"lockdown.blockall.description",valueText:{enabled:"lockdown.settings.enabled",disabled:"lockdown.settings.disabled"},options:[{settingId:"blockPublicAcls",title:"lockdown.acls.rejectpublicacls.title",description:"lockdown.acls.rejectpublicacls.description"},{settingId:"ignorePublicAcls",title:"lockdown.acls.ignorepublicacls.title",description:"lockdown.acls.ignorepublicacls.description"},{settingId:"blockPublicPolicy",title:"lockdown.policies.blockpublicpolicy.title",description:"lockdown.policies.blockpublicpolicy.description"},{settingId:"restrictPublicBuckets",title:"lockdown.policies.lockdownpublicbucket.title",description:"lockdown.policies.lockdownpublicbucket.description"}]}}function h(t){var n=function(){return{blockPublicAcls:!1,ignorePublicAcls:!1,blockPublicPolicy:!1,restrictPublicBuckets:!1}};return e.all({accountSettings:u().catch(n),bucketSettings:p(t).catch(n)})}return{getAllSettings:h,getAccountSettings:u,putAccountSettings:d,getBucketSettings:p,putSingleBucketSettings:f,putBucketSettings:g,getSettingsDetailOptions:m}}])}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(e){!function(){e.module("s3").directive("retentionConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",modalTitle:"=",confirmLabel:"=",alert:"<",onCancel:"&",onConfirm:"&"},template:n(824),controller:"RetentionConfirmationModal"}}),e.module("s3").controller("RetentionConfirmationModal",["$scope","$translate","$routeParams","S3Constants","UtilService","AwsUrlsService","SCLogService",function(e,t,n,r,i,a,o){e.docLink=a.getDocUrl(r.LEARN_MORE_LINKS.OBJECT_RETENTION),e.showVersions=i.convertStringToBoolean(n[r.SHOW_VERSION_PARAM]),e.inputChange=function(){var t=e.modalProperties.input,n=t.value,r=t.placeholder;e.modalProperties.buttons.confirmDisabled=n!==r},e.cancel=function(){e.resetModalPropertiesTodefault(),e.onCancel()},e.confirm=function(){e.resetModalPropertiesTodefault(),e.onConfirm()},e.resetModalPropertiesTodefault=function(){e.modalProperties={input:{placeholder:t.instant("bucketproperties.objectretention.confirm.input.placeholder"),value:""},buttons:{cancelText:t.instant("createbucketmodal.footer.cancel"),confirmText:t.instant("confirmationmodal.footer.confirm"),confirmDisabled:!0}}},e.resetModalPropertiesTodefault()}])}()}).call(t,n(0))},function(e,t){e.exports='<modal id=retention-confirmation-modal class=contrast-modal is-open=isOpen close-callback=cancel header-title=modalTitle> <modal-content> <awsui-alert type=warning header="{{ alert.title | nbsp }}"> <span>{{ alert.text }}</span> <span> </span> <learn-more-link href={{docLink}}></learn-more-link> </awsui-alert> <div> <label translate={{confirmLabel}} translate-values="{ confirmWord: modalProperties.input.placeholder }"></label> <awsui-textfield ng-model=modalProperties.input.value ng-change=inputChange($event) placeholder="{{ modalProperties.input.placeholder }}"></awsui-textfield> </div> </modal-content> <modal-footer> <awsui-button id=cancel text="{{ modalProperties.buttons.cancelText }}" variant=normal click=cancel()></awsui-button> <awsui-button id=confirm class=ml-3 variant=primary text="{{ modalProperties.buttons.confirmText }}" click=confirm() data-disabled=modalProperties.buttons.confirmDisabled></awsui-button> </modal-footer> </modal>'},function(e,t,n){"use strict";function r(e){return{get:function(){return{version:2,features:[{subtitle:"spotlight.feature.optimize_performance.subtitle",body:"spotlight.feature.optimize_performance.body",learn:"spotlight.feature.optimize_performance.learn"},{subtitle:"spotlight.feature.versioning.subtitle",body:"spotlight.feature.versioning.body",learn:"spotlight.feature.versioning.learn"}]}}}}Object.defineProperty(t,"__esModule",{value:!0}),n(0).module("s3").factory("SpotlightDataService",["FAC",r])},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i,a,o,s){function c(){var e=Number(t.localStorage.getItem(o.SPOTLIGHT_STORAGE_KEY));return isNaN(e)||e<Number(l.version)}var l=n.get();e.features=l.features,s.customerReady("FeatureSpotlight");var u=t.localStorage;if(c()&&a.analyticsTrackView(o.ANALYTICS.SPOTLIGHT.ID,o.ANALYTICS.SPOTLIGHT.VIEW),!u.getItem(o.SPOTLIGHT_STORAGE_KEY)){a.analyticsTrackView(o.ANALYTICS.SPOTLIGHT.ID,o.ANALYTICS.SPOTLIGHT.NEW);var d=new i("S3-Spotlight");r.log("SpotlightUniqueViews",1,d)}a.analyticsTrackView(o.ANALYTICS.SPOTLIGHT.ID,o.ANALYTICS.SPOTLIGHT.ENTER),e.$on("$destroy",function(){c()&&u.setItem(o.SPOTLIGHT_STORAGE_KEY,l.version),a.analyticsTrackView(o.ANALYTICS.SPOTLIGHT.ID,o.ANALYTICS.SPOTLIGHT.EXIT)})}e.module("s3").controller("FeatureSpotlightController",["$scope","$window","SpotlightDataService","SCLogService","ConsoleOperation","UtilService","S3Constants","PerformanceUtilsService",t])}).call(t,n(0))},function(e,t,n){"use strict";(function(e){e.module("s3").directive("loggedLink",["ConsoleOperation","SCLogService","UtilService","S3Constants",function(e,t,r,i){return{scope:{href:"@",text:"@",metricname:"@"},transclude:!0,template:n(828),link:function(n){n.logClick=function(){var a=new e("LogClick");t.log(n.metricname,1,a),r.analyticsTrackClick(i.ANALYTICS.LOGGED_LINK_CLICK,n.metricname)}}}}])}).call(t,n(0))},function(e,t){e.exports="<external-link light=light ng-click=logClick() href={{href}}><span ng-transclude>{{text}}</span></external-link>"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),a=n(77),o=n(54),s=n(16),c=n(227),l=n(17),u=function(){function e(e,t,n,r,a,o,u,d,p,f,g,m){this.$filter=e,this.$translate=t,this.Region=n,this.$location=a,this.jobsApiService=o,this.jobDocLinksService=p,this.PerformanceUtilsService=m,this.actions=[s.JobConsoleAction.clone,s.JobConsoleAction.edit_priority,s.JobConsoleAction.confirm_and_run,s.JobConsoleAction.cancel_job],this.cloudWatchEventsLink=this.jobDocLinksService.links.cloudwatchEvents,this.learnMoreLink=this.jobDocLinksService.links.batchOps,this.filters={search:void 0,status:void 0,region:void 0},this.sortColumn=void 0,this.sortDescending=!1,this.resultsPerPage=100,this.paginationStart=0,this.maxJobs=1e3,this.isPreview=!g.isFeatureEnabled(l.S3Constants.FAC.BATCH_OPERATIONS_GA),this.columns=u.getColumnDefinition(),this.statusFilters=d.getStatusFilters(),this.filters.status=this.statusFilters[0].items[0];var h=[],b=l.S3Constants.FAC.BATCH_OPERATIONS;r.getFACRegions(n.regionMapping,h,b),f.getDisabledRegions().then(function(e){h.forEach(function(n){i.indexOf(e,n.value)>-1&&(n.disabled=!0,n.description=t.instant("disabled.region"))})}),this.regionFilters=h;var v=this.Region.getCurrentRegion();this.filters.region=h.find(function(e){return e.value===v}),this.filters.region||(this.filters.region=h[0],this.changeRegion(this.filters.region)),this.successAlert=c.jobSuccessAlert.get(this.$location,this.$translate,!0,v),this.sortColumn=this.columns.find(function(e){return"creation_date"===e.name}),this.sortDescending=!0,this.loadJobs()}return e.prototype.$onInit=function(){},e.prototype.isActionEnabled=function(e){return o.jobHelpers.isJobConsoleActionEnabled(e,this.selectedJob)},e.prototype.getActionPath=function(e){if(this.selectedJobId)return"/s3"+o.jobHelpers.getJobConsoleActionPath(e,this.selectedJobId)+"?region="+this.filters.region.value},e.prototype.getCreatePath=function(){return"/s3/"+l.S3Constants.PATH_SEGMENTS.JOBS+"/"+l.S3Constants.PATH_SEGMENTS.JOB_CREATE+"?region="+this.filters.region.value},e.prototype.loadJobs=function(){var e=this;this.isLoading=!0,this.error=null,this.filteredJobs=this.jobs=[],this.paginationStart=0,this.jobsApiService.listJobs(this.filters.region.value,this.filters.status.value,void 0,this.maxJobs).then(function(t){e.jobs=t.Jobs,e.jobs.forEach(function(e){return o.jobHelpers.processJob(e)}),e.filterJobs(),e.jobListTruncated=!!t.NextToken}).catch(function(t){e.error=a.jobErrorAlert.get(a.JobConsoleErrorAction.list,t,e.$translate)}).finally(function(){e.PerformanceUtilsService.customerReady("BOPs-List"),e.isLoading=!1})},e.prototype.sortBy=function(e){!this.clientSideFilteringDisabled()&&e.sortBy&&(this.sortColumn===e?this.sortDescending=!this.sortDescending:(this.sortColumn=e,this.sortDescending=!1),this.filterJobs())},e.prototype.getPaginationStart=function(){if(!this.isLoading)return Math.min(this.paginationStart+1,this.getPaginationTotal())},e.prototype.getPaginationEnd=function(){if(!this.isLoading)return Math.min(this.paginationStart+this.resultsPerPage,this.getPaginationTotal())},e.prototype.getPaginationTotal=function(){if(!this.isLoading)return this.filteredJobs.length},e.prototype.prevPage=function(){this.paginationStart=Math.max(this.paginationStart-this.resultsPerPage,0),this.selectJob(null)},e.prototype.nextPage=function(){this.paginationStart=this.paginationStart+this.resultsPerPage,this.selectJob(null)},e.prototype.prevDisabled=function(){return this.paginationStart<=0},e.prototype.nextDisabled=function(){return this.getPaginationTotal()<=this.paginationStart+this.resultsPerPage},e.prototype.filterJobs=function(){if(this.clientSideFilteringDisabled())this.filteredJobs=this.jobs;else{var e=this.filters.search&&this.filters.search.toLowerCase();this.filteredJobs=this.$filter("filter")(this.jobs,function(t){return!e||t.Description&&t.Description.toLowerCase().indexOf(e)>-1||t.JobId&&t.JobId.toLowerCase().indexOf(e)>-1}),this.sortColumn&&(this.filteredJobs=this.$filter("orderBy")(this.filteredJobs,this.sortColumn.sortBy,this.sortDescending))}var t=this.filteredJobs.length;this.paginationStart>=t&&(this.paginationStart=Math.floor(t/this.resultsPerPage)*this.resultsPerPage)},e.prototype.clientSideFilteringDisabled=function(){return this.jobListTruncated},e.prototype.selectJob=function(e){this.selectedJobId=e,this.selectedJob=e?this.jobs.find(function(t){return t.JobId===e}):null},e.prototype.isSelected=function(e){return e.JobId===this.selectedJobId},e.prototype.getCellClass=function(e){var t="job_management-list-column__"+e.name;return e.rightAlign&&(t+=" table-cell--right-align"),t},e.prototype.getHeaderClass=function(e){var t=this.getCellClass(e);return!this.clientSideFilteringDisabled()&&e.sortBy||(t+=" sort-disabled"),t},e.prototype.changeRegion=function(e){this.$location.search("region",e.value),this.loadJobs()},e.$inject=["$filter","$translate","Region","UtilService","$location","JobsApiService","JobListColumnDefinition","JobListStatusFilters","JobDocLinksService","RegionStatesService","FAC","PerformanceUtilsService"],e}();t.JobListController=u,r.module("s3").controller("JobListController",u)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(54),o=n(16),s=n(227),c=n(17),l=n(228),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actions=[o.JobConsoleAction.clone,o.JobConsoleAction.edit_priority,o.JobConsoleAction.confirm_and_run,o.JobConsoleAction.cancel_job],t}return r(t,e),t.prototype.isEnabled=function(e){return!(!this.job||this.error)&&a.jobHelpers.isJobConsoleActionEnabled(e,this.job)},t.prototype.getActionPath=function(e){return"/s3"+a.jobHelpers.getJobConsoleActionPath(e,this.jobId)+"?region="+this.currentRegion+"&"+c.S3Constants.SOURCE_PAGE_PARAM+"=detail"},t.prototype.initialize=function(){e.prototype.initialize.call(this),this.successAlert=s.jobSuccessAlert.get(this.$location,this.$translate)},t.prototype.clearData=function(){e.prototype.clearData.call(this),this.successAlert=null,this.infoMessage=null},t.prototype.setCustomerReady=function(){this.PerformanceUtilsService.customerReady("BOPs-Details")},t.prototype.afterLoadJob=function(e){this.infoMessage=this.getInfoMessage(e)},t.prototype.loadPropertiesDefinition=function(){this.propertiesDefinition=this.jobPropertiesService.getJobDetails(this.job,this.currentRegion,!0)},t.prototype.getInfoMessage=function(e){switch(e.Status){case o.JobStatus.SUSPENDED:return this.$translate.instant("job_management.details.info.awaiting_confirmation",{date:this.jobPropertiesService.getJobConfirmAndRunDate(e)});case o.JobStatus.CANCELLED:case o.JobStatus.COMPLETE:case o.JobStatus.FAILED:return this.$translate.instant("job_management.details.info.finished",{date:this.jobPropertiesService.getJobDeletionDate(e)})}},t}(l.JobDetailBaseController);t.JobDetailsController=u,i.module("s3").controller("JobDetailsController",u)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(16),o=n(148),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionType=a.JobConsoleAction.cancel_job,t}return r(t,e),t.prototype.actionApiCall=function(){return this.jobsApiService.updateJobStatus(this.currentRegion,this.jobId,a.JobStatus.CANCELLED,this.statusUpdateReason)},t.prototype.setCustomerReady=function(){this.PerformanceUtilsService.customerReady("BOPs-Cancel")},t}(o.JobActionController);t.JobCancelController=s,i.module("s3").controller("JobCancelController",s)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(16),o=n(148),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.s3PricingLink=t.UtilService.getPricingUrl("s3"),t.lambdaPricingLink=t.UtilService.getPricingUrl("lambda"),t.actionType=a.JobConsoleAction.confirm_and_run,t}return r(t,e),t.prototype.actionApiCall=function(){return this.jobsApiService.updateJobStatus(this.currentRegion,this.jobId,a.JobStatus.READY)},t.prototype.setCustomerReady=function(){this.PerformanceUtilsService.customerReady("BOPs-Confirm")},t}(o.JobActionController);t.JobConfirmAndRunController=s,i.module("s3").controller("JobConfirmAndRunController",s)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(16),o=n(148),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.docLink=t.jobDocLinksService.links.updatePriority,t.actionType=a.JobConsoleAction.edit_priority,t}return r(t,e),t.prototype.validatePriority=function(){this.newPriority&&!/^[0-9]+$/.test(this.newPriority)?this.validationMessage="input.positive_numbers":this.validationMessage=null},t.prototype.isValid=function(){return this.newPriority&&!this.validationMessage},t.prototype.actionApiCall=function(){return this.jobsApiService.updateJobPriority(this.currentRegion,this.jobId,parseInt(this.newPriority,10))},t.prototype.loadPropertiesDefinition=function(){this.propertiesDefinition=this.jobPropertiesService.getJobDetails(this.job,this.currentRegion),this.propertiesDefinition[0].properties=this.propertiesDefinition[0].properties.filter(function(e){return"job_management.properties.priority"!==e.title})},t.prototype.setCustomerReady=function(){this.PerformanceUtilsService.customerReady("BOPs-Edit")},t}(o.JobActionController);t.JobEditPriorityController=s,i.module("s3").controller("JobEditPriorityController",s)},function(e,t,n){"use strict";(function(e){e.module("s3").directive("jobManagementPagination",function(){return{restrict:"E",scope:{start:"<",end:"<",total:"<",incomplete:"<",prevDisabled:"<",nextDisabled:"<",prevPage:"&",nextPage:"&",disabled:"<"},template:n(835)}})}).call(t,n(0))},function(e,t){e.exports="<div class=pages> <awsui-button icon=angle-left variant=standalone-icon click=prevPage() data-disabled=\"disabled || prevDisabled\"></awsui-button> <span ng-if=!disabled> <span>{{ 'job_management.pagination.viewing' | translate:{ start: start, end: end } }}</span> <em ng-if=incomplete>{{ 'job_management.pagination.more_than' | translate }}</em> <span>{{ 'job_management.pagination.total' | translate:{ total: total } }}</span> </span> <awsui-button icon=angle-right variant=standalone-icon click=nextPage() data-disabled=\"disabled || nextDisabled\"></awsui-button> </div>"},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(2),o=n(17),s=n(837);t.JOB_API_PATH="/v20180820/jobs";var c=function(){function e(e,t,n,r,i,a){this.$timeout=e,this.UtilService=t,this.$location=n,this.$q=r,this.ConsoleOperation=i,this.S3CWSAPIService=a}return e.prototype.listJobs=function(e,n,r,i,a){void 0===n&&(n=[]),void 0===i&&(i=1e3);var o={method:"GET",path:t.JOB_API_PATH,content:{ListJobsRequest:{AccountId:this.getAccountId(),JobStatuses:n,NextToken:r,MaxResults:i}}};return this.callApi("ListJobs",e,o,a)},e.prototype.updateJobStatus=function(e,n,r,i,a){var o={path:t.JOB_API_PATH+"/"+n+"/status",method:"POST",content:{UpdateJobStatusRequest:{AccountId:this.getAccountId(),JobId:n,RequestedJobStatus:r,StatusUpdateReason:i}}};return this.callApi("UpdateJobStatus",e,o,a)},e.prototype.updateJobPriority=function(e,n,r,i){var a={path:t.JOB_API_PATH+"/"+n+"/priority",method:"POST",content:{UpdateJobPriorityRequest:{AccountId:this.getAccountId(),JobId:n,Priority:r}}};return this.callApi("UpdateJobPriority",e,a,i)},e.prototype.createJob=function(e,n,r,i,a,o,s,c,l){var u={CreateJobRequest:{ConfirmationRequired:!0,AccountId:this.getAccountId(),Description:n,Operation:r.toPlainObject(),Report:i,ClientRequestToken:a,Manifest:o,Priority:s,RoleArn:c}};this.convertS3uriToArn(u,["CreateJobRequest.Operation.S3PutObjectCopy.TargetResource","CreateJobRequest.Manifest.Location.ObjectArn"]);var d={path:t.JOB_API_PATH,method:"POST",content:u};return this.callApi("CreateJob",e,d,l)},e.prototype.describeJob=function(e,n,r){var i=this,a={path:t.JOB_API_PATH+"/"+n,method:"GET",content:{DescribeJobRequest:{AccountId:this.getAccountId(),JobId:n}}};return this.callApi("DescribeJob",e,a,r).then(function(e){return i.convertArnToS3uri(e,["Job.Operation.S3PutObjectCopy.TargetResource","Job.Manifest.Location.ObjectArn"]),e})},e.prototype.getAccountId=function(){return this.accountId=this.accountId||this.UtilService.getUserAccountId(),this.accountId},e.prototype.callApi=function(e,t,n,i){var o=this;i=i||new this.ConsoleOperation(e);var c=["usermetadata"],l=s.ConvertCaseHelper.convertDataToCamelCase(n.content,c);l.region=t;var u=r({},n);return delete u.content,this.S3CWSAPIService.makeS3ConsoleCommandRequest(l,e,u,i).then(function(e){var t=e.data;return"SUCCESS"===a.get(t,"result.status")?s.ConvertCaseHelper.convertDataToPascalCase(t.result.additionalInfoWhenSuccess,c):o.$q.reject(t.result||t)})},e.prototype.convertS3uriToArn=function(e,t){var n=this;t.forEach(function(t){var r=a.get(e,t);if(r){var i=r.replace("s3://",n.UtilService.getARNPrefix(o.S3Constants.AWS_SERVICE.S3));a.set(e,t,i)}})},e.prototype.convertArnToS3uri=function(e,t){var n=this;t.forEach(function(t){var r=a.get(e,t);if(r){var i=r.replace(n.UtilService.getARNPrefix(o.S3Constants.AWS_SERVICE.S3),"s3://");a.set(e,t,i)}})},e.$inject=["$timeout","UtilService","$location","$q","ConsoleOperation","S3CWSAPIService"],e}();t.JobsApiService=c,i.module("s3").service("JobsApiService",c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2);!function(e){e.camelCase="camelCase",e.PascalCase="PascalCase"}(r=t.CaseType||(t.CaseType={}));var a={ContentMD5:"contentMD5",SSEAwsKmsKeyId:"sseawsKmsKeyId"},o={id:"ID",sseawsKmsKeyId:"SSEAwsKmsKeyId"},s=function(){function e(){}return e.convertDataToPascalCase=function(e,t){return void 0===t&&(t=[]),this.convertKeyCaseForData(e,t,r.PascalCase)},e.convertDataToCamelCase=function(e,t){return void 0===t&&(t=[]),this.convertKeyCaseForData(e,t,r.camelCase)},e.convertKeyCaseForData=function(e,t,n){var r=this;return void 0===t&&(t=[]),t=t.map(function(e){return e.toLowerCase()}),i.isArray(e)?e.map(function(e){return r.convertKeyCaseForData(e,t,n)}):i.isObject(e)?this.convertObjectKeysCase(e,t,n):e},e.convertKeyCase=function(e,t){switch(t){case r.PascalCase:return o[e]?o[e]:""+e[0].toUpperCase()+e.substring(1);case r.camelCase:return a[e]?a[e]:i.camelCase(e);default:throw new Error("Unrecognized caseType")}},e.convertObjectKeysCase=function(e,t,n){var r=this;void 0===t&&(t=[]);var i={};return Object.getOwnPropertyNames(e).forEach(function(a){var o=e[a];i[r.convertKeyCase(a,n)]=r.shouldConvertKeyContents(a,t)?r.convertKeyCaseForData(o,t,n):o}),i},e.shouldConvertKeyContents=function(e,t){return void 0===t&&(t=[]),!i.includes(t,e.toLowerCase())},e}();t.ConvertCaseHelper=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(54),a=n(16),o=n(17),s=function(){function e(e,t,n){this.$translate=e,this.$filter=t,this.Region=n}return e.prototype.getColumnDefinition=function(){var e=this;return[{name:"id",getData:function(t){return'<a class="list-view-item-name-alt" href="/s3'+i.jobHelpers.getJobPath(t.JobId)+"?region="+e.Region.getCurrentRegion()+'">'+t.JobId+"</a>"}},{name:"description",sortBy:"Description",getData:function(e){return e.Description||"-"}},{name:"operation",sortBy:"Operation.type",getData:function(t){return t.Operation?e.$translate.instant("job_management.operation."+t.Operation.type.toLowerCase()):"-"}},{name:"creation_date",sortBy:"CreationTime",getData:function(t){return t.CreationTime?e.$filter("date")(t.CreationTime,o.S3Constants.DATE_FORMAT):"-"}},{name:"status",sortBy:"Status",getData:function(t){return t.Status?'<span class="job-status-'+t.Status.toLowerCase()+'">'+e.$translate.instant("job_management.status."+t.Status.toLowerCase())+"</span>":"-"}},{name:"total_objects",sortBy:"ProgressSummary.TotalNumberOfTasks",tooltip:"job_management.list.tooltips.total_objects_heading",rightAlign:!0,getData:function(t){return t.Status===a.JobStatus.NEW?'<span class="job-management__not-yet-available">'+e.$translate.instant("job_management.not_yet_available")+"</span>":i.jobHelpers.getFormattedTotalObjects(t)}},{name:"complete",sortBy:"PercentageComplete",rightAlign:!0,getData:function(e){return i.jobHelpers.getCompletePercent(e)}},{name:"failed",sortBy:"ProgressSummary.NumberOfTasksFailed",tooltip:"job_management.list.tooltips.failed_heading",rightAlign:!0,getData:function(e){return i.jobHelpers.getFailureData(e)}},{name:"priority",sortBy:"Priority",tooltip:"job_management.list.tooltips.priority_heading",tooltipPosition:"left",rightAlign:!0,getData:function(e){return e.Priority&&e.Priority.toString()||(0===e.Priority?"0":"-")}}]},e.$inject=["$translate","$filter","Region"],e}();t.JobListColumnDefinition=s,r.module("s3").service("JobListColumnDefinition",s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(16),a=function(){function e(e){this.$translate=e}return e.prototype.getStatusFilters=function(){var e=this,t=[{name:"all",includes:Object.keys(i.JobStatus).map(function(e){return i.JobStatus[e]})},{name:"not_started",includes:[i.JobStatus.NEW,i.JobStatus.PREPARING,i.JobStatus.SUSPENDED,i.JobStatus.READY]},{name:"in_progress",includes:[i.JobStatus.ACTIVE,i.JobStatus.PAUSING,i.JobStatus.CANCELLING,i.JobStatus.FAILING,i.JobStatus.PAUSED,i.JobStatus.COMPLETING]},{name:"all_finished",includes:[i.JobStatus.COMPLETE,i.JobStatus.CANCELLED,i.JobStatus.FAILED]}],n=[i.JobStatus.SUSPENDED,i.JobStatus.COMPLETE,i.JobStatus.CANCELLED,i.JobStatus.FAILED];return[{items:t.map(function(t){return e.mapCombinedStatus(t)})},{items:n.map(function(t){return{text:e.getStatusTranslation(t),value:[t]}})}]},e.prototype.mapCombinedStatus=function(e){var t=this,n={text:this.getStatusTranslation(e.name,!0),value:e.includes};return"all"!==e.name&&(n.description=e.includes.map(function(e){return t.getStatusTranslation(e)}).join(", "),n.description=this.$translate.instant("job_management.status.combined.description")+" "+n.description),n},e.prototype.getStatusTranslation=function(e,t){return void 0===t&&(t=!1),this.$translate.instant("job_management.status"+(t?".combined":"")+"."+e.toLowerCase())},e.$inject=["$translate"],e}();t.JobListStatusFilters=a,r.module("s3").service("JobListStatusFilters",a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),a=n(54),o=n(16),s=n(55),c=n(17),l=function(){function e(e,t,n,r){this.$filter=e,this.$translate=t,this.Region=n,this.UtilService=r,this.DATE_FORMAT="MMMM d, y"}return e.prototype.getJobDetails=function(e,t,n){return void 0===n&&(n=!1),[{title:n?void 0:"job_management.properties.groups.overview",properties:this.getOverviewPropertiesForJob(e,t)},{title:"job_management.properties.groups.status",properties:this.getStatusPropertiesForJob(e)},{title:"job_management.properties.groups.manifest",properties:this.getManifestPropertiesForJob(e)},{title:"job_management.properties.groups.operation",properties:this.getOperationProperties(e.Operation)},{title:"job_management.properties.groups.report",properties:this.getReportPropertiesForJob(e)}]},e.prototype.getOverviewPropertiesForJob=function(e,t){return this.getRegionProperties(t).concat([{title:"job_management.properties.description",value:this.getProperty(e,"Description")},{title:"job_management.properties.arn",value:this.getProperty(e,"JobArn")},{title:"job_management.properties.creation_date",value:this.formatDate(e.CreationTime)},{title:"job_management.properties.total_objects_full",tooltip:"job_management.list.tooltips.total_objects_heading",value:e.Status===o.JobStatus.NEW?'<span class="job-management__not-yet-available">'+this.$translate.instant("job_management.not_yet_available")+"</span>":a.jobHelpers.getFormattedTotalObjects(e)},{title:"job_management.properties.priority",tooltip:"job_management.list.tooltips.priority_heading",value:this.getProperty(e,"Priority")},{title:"job_management.properties.iam_role",value:this.getIamLink(e.RoleArn)}])},e.prototype.getStatusPropertiesForJob=function(e){var t=[];return e.Status===o.JobStatus.CANCELLED?t=[{title:"job_management.properties.reason_for_cancellation",value:e.StatusUpdateReason||"-"},{title:"job_management.properties.date_cancelled",value:this.formatDate(e.TerminationDate)}]:e.Status===o.JobStatus.FAILED?t=[{title:"job_management.properties.failure_reasons",value:e.FailureReasons&&e.FailureReasons.length>0?e.FailureReasons.map(function(e){return e.FailureReason}).join("<br />"):"-"},{title:"job_management.properties.date_failed",value:this.formatDate(e.TerminationDate)}]:e.Status===o.JobStatus.COMPLETE&&(t=[{title:"job_management.properties.date_completed",value:this.formatDate(e.TerminationDate)}]),[{title:"job_management.properties.status",value:e.Status?'<span class="job-status-'+e.Status.toLowerCase()+'">'+this.getTranslatedValue("status",e.Status)+"</span>":"-"}].concat(t,[{title:"job_management.properties.complete",value:a.jobHelpers.getCompletePercent(e)},{title:"job_management.properties.succeeded",value:a.jobHelpers.getSucceededData(e)},{title:"job_management.properties.failed",tooltip:"job_management.list.tooltips.failed_heading",value:a.jobHelpers.getFailureData(e)}])},e.prototype.getManifestPropertiesForJob=function(e){var t=i.get(e,"Manifest.Location.ObjectArn"),n=i.get(e,"Manifest.Location.ObjectVersionId"),r=i.get(e,"Manifest.Location.Etag"),a=i.get(e,"Manifest.Spec.Format"),s=i.get(e,"Manifest.Spec.Fields"),c=!!s&&i.includes(s,o.JobManifestField.VersionId);return this.getManifestProperties(t,n,r,a,c)},e.prototype.getManifestProperties=function(e,t,n,r,i){var a=[{title:"job_management.properties.path_to_manifest",value:e?this.getExternalLink(e,e.replace("s3://","/s3/object/")+"?region="+this.Region.getCurrentRegion(),!0):"-"},{title:"job_management.properties.manifest_version_id",value:t||"-"},{title:"job_management.properties.manifest_etag",value:n||"-"},{title:"job_management.properties.manifest_format",value:this.getTranslatedValue("manifest_format",r)||"-"}];return r===o.JobManifestFormat.S3BatchOperations_CSV_20180820&&a.push({title:"job_management.properties.manifest_versions_included",value:this.getBooleanPropertyText(i)}),a},e.prototype.getAdditionalOptionsProperties=function(e,t,n,r,i,a){return[{title:"job_management.properties.description",value:e||"-"},{title:"job_management.properties.priority",value:t?t.toString():"-",tooltip:"job_management.list.tooltips.priority_heading"}].concat(this.getReportProperties(n,r,i),[{title:"job_management.properties.iam_role",value:this.getIamLink(a)}])},e.prototype.getOperationProperties=function(e){return e?[{title:"job_management.properties.operation",value:this.getTranslatedValue("operation",e.type)}].concat(e.getProperties(this.$translate)):[]},e.prototype.getRegionProperties=function(e){var t=this.Region.regionMapping.find(function(t){return t.id===e});return t?[{title:"createbucketmodal.label.region",value:t.label}]:[]},e.prototype.getReportPropertiesForJob=function(e){var t,n=i.get(e,"Report.Bucket");if(n){n=n.replace(this.UtilService.getARNPrefix(c.S3Constants.AWS_SERVICE.S3),""),t="s3://"+n;var r=i.get(e,"Report.Prefix");r&&(t=t+"/"+r)}return this.getReportProperties(e.Report&&e.Report.Enabled,i.get(e,"Report.ReportScope"),t)},e.prototype.getReportProperties=function(e,t,n){var r=[{title:"job_management.properties.generate_report",value:this.getBooleanPropertyText(e)}];return e&&(r.push({title:"job_management.properties.report_scope",value:this.getTranslatedValue("report_scope",t)||"-"}),r.push({title:"job_management.properties.report_destination",value:n?this.getExternalLink(n,n.replace("s3://","/s3/buckets/")+"?region="+this.Region.getCurrentRegion(),!0):"-"})),r},e.prototype.getIamLink=function(e){var t=this.UtilService.getIamRoleNameFromArn(e),n=this.UtilService.getAccountIdFromARN(e),r=this.UtilService.getUserAccountId();if(t&&n===r){var i=this.UtilService.getIamRoleLink(t);return this.getExternalLink(t,i)}return e||"-"},e.prototype.getJobConfirmAndRunDate=function(e){if(e.CreationTime)return this.formatDate(this.addDaysToDate(e.CreationTime,14),this.DATE_FORMAT)},e.prototype.getJobDeletionDate=function(e){if(e.TerminationDate)return this.formatDate(this.addDaysToDate(e.TerminationDate,90),this.DATE_FORMAT)},e.prototype.getTranslatedValue=function(e,t){return s.jobPropertyHelpers.getTranslatedValue(this.$translate,"job_management."+e,t)},e.prototype.addDaysToDate=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n},e.prototype.getProperty=function(e,t,n,r){void 0===n&&(n=function(e){return e.toString()}),void 0===r&&(r="-");var a=i.get(e,t);return a?n(a):r},e.prototype.formatDate=function(e,t){return void 0===t&&(t=c.S3Constants.DATE_FORMAT),e?this.$filter("date")(e,t):"-"},e.prototype.getBooleanPropertyText=function(e){var t="bucketproperty."+(e?"yes":"no");return this.$translate.instant(t)},e.prototype.getExternalLink=function(e,t,n){return void 0===n&&(n=!1),'<a class="awsui-hover-child-icons external-link" href="'+t+'" target="_blank">\n            <span>'+e+"</span>&nbsp;"+(n?"":'<span class="awsui-icon awsui-icon-link external-link"></span>')+"\n        </a>"},e.$inject=["$filter","$translate","Region","UtilService"],e}();t.JobPropertiesService=l,r.module("s3").service("JobPropertiesService",l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i="AmazonS3/latest/dev";t.jobManagementLinkPaths={cloudwatchEvents:"AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html",batchOps:i+"/batch-ops.html",updatePriority:i+"/batch-ops-manage-jobs.html#priority",createJobManifest:i+"/batch-ops-create-job.html#create-job-manifest",createJobManifestFormat:i+"/batch-ops-create-job.html#manifest",inventory:i+"/storage-inventory.html",operations:i+"/batch-ops-operations.html",pathFormat:"AmazonS3/latest/user-guide/batch-ops-paths.html",storageClass:i+"/storage-class-intro.html",serverSideEncryption:i+"/serv-side-encryption.html",acl:i+"/acl-overview.html",tags:i+"/object-tagging.html",metadata:i+"/UsingMetadata.html#object-metadata",createPriority:i+"/batch-ops-create-job.html#create-job-priority",report:i+"/batch-ops-create-job.html#create-job-report",permissions:i+"/batch-ops-create-job.html#create-job-permissions",roles:"IAM/latest/UserGuide/id_roles.html",arn:"general/latest/gr/aws-arns-and-namespaces.html"};var a=function(){function e(e){var n=this;this.AwsUrlsService=e;var r={};Object.keys(t.jobManagementLinkPaths).forEach(function(e){r[e]=n.getDocUrl(t.jobManagementLinkPaths[e])}),this.links=r}return e.prototype.getDocUrl=function(e){return this.AwsUrlsService.getDocUrl(e)},e.$inject=["AwsUrlsService"],e}();t.JobDocLinksService=a,r.module("s3").service("JobDocLinksService",a)},function(e,t,n){"use strict";var r=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(2),o=n(77),s=n(16),c=n(147),l=n(55),u=n(17),d=n(229),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isClone=!0,t.jobMgmtTitle="job_management.clone.title",t.createBtnTitle="button.clone_job",t.actionName=s.JobConsoleAction.clone,t}return r(t,e),t.prototype.cloneJob=function(e){e&&(this.cloneManifestDetails(e),this.cloneBatchOperation(e),this.cloneConfigurations(e))},t.prototype.cloneManifestDetails=function(e){e&&(this.manifestPath=e.Manifest.Location.ObjectArn,this.manifestVersionId=e.Manifest.Location.ObjectVersionId,this.manifestETag=e.Manifest.Location.Etag,this.selectedManifestFormat=e.Manifest.Spec.Format,this.versionIDinManifest=a.includes(e.Manifest.Spec.Fields,s.JobManifestField.VersionId),this.processManifestETag())},t.prototype.cloneBatchOperation=function(e){if(e&&e.Operation){var t=e.Operation;for(var n in t)t.hasOwnProperty(n)&&null!==t[n]&&(this.operationType=n,this.operation=new c.jobOperationTypeClassMapping[this.operationType],a.assign(this.operation,t[n]),this.operationType===c.JobOperationType.S3PutObjectCopy&&this.cloneCopyOperation(this.operation))}},t.prototype.cloneCopyOperation=function(e){if(e){e.TaggingDirective=l.jobPropertyHelpers.getTaggingDirective(e.NewObjectTagging);var t=u.S3Constants.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION,n=a.get(e,"NewObjectMetadata.Ssealgorithm");switch(n&&delete e.NewObjectMetadata.Ssealgorithm,e.MetadataDirective===s.S3MetadataDirective.REPLACE&&a.every(e.NewObjectMetadata,function(e){return!e})?this.metadataDirective=s.REMOVE_DIRECTIVE:this.metadataDirective=e.MetadataDirective,n){case s.S3EncryptionAlgorithm.AES256:this.selectedEncryption={encryption:t.AES256};break;case s.S3EncryptionAlgorithm.KMS:this.selectedEncryption={encryption:t.AWSKMS,kmsId:{value:t.CUSTOM_ARN},customKMSARN:e.SSEAwsKmsKeyId};break;default:this.selectedEncryption={encryption:t.NONE}}}},t.prototype.cloneConfigurations=function(e){var t=this;if(e){if(this.jobDescription=e.Description,this.jobPriority=e.Priority,this.generateCompletionReport=e.Report&&e.Report.Enabled,this.generateCompletionReport){var n=this.UtilService.getARNPrefix(u.S3Constants.AWS_SERVICE.S3),r=e.Report.Bucket.replace(n,"");this.jobReportDestination="s3://"+r,e.Report.Prefix&&(this.jobReportDestination=this.jobReportDestination+"/"+e.Report.Prefix)}this.selectedIAMRoleAction=d.CUSTOM_ROLE_ARN,this.customIAMRoleArn=e.RoleArn,this.listRolesPromise.then(function(){var n=t.iamRoleList.find(function(t){return t.value===e.RoleArn});n&&(t.selectedIAMRole=n.value,t.selectedIAMRoleAction=s.JobIamRole.EXISTING_ROLE)})}},t.prototype.afterInitialize=function(){var e=this;this.jobId=this.$routeParams[u.S3Constants.PATH_SEGMENTS.JOB_ID],this.isLoadingJob=!0,this.jobsApiService.describeJob(this.currentRegion,this.jobId).then(function(t){e.cloneJob(t.Job)}).catch(function(t){e.error=o.jobErrorAlert.get(o.JobConsoleErrorAction.detail,t,e.$translate)}).finally(function(){e.PerformanceUtilsService.customerReady("BOPs-Clone"),e.isLoadingJob=!1})},t}(d.CreateJobController);t.CloneJobController=p,i.module("s3").controller("CloneJobController",p)},function(e,t,n){"use strict";(function(e,t){function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(){function t(e,n){var r=this;o(this,t),this.buildProps(this.get$scope(e,n)),this.buildServices(e,n),this.componentDidMount&&window.setTimeout(function(){r.componentDidMount()},0)}return s(t,[{key:"setState",value:function(t,n){t&&(this.state=e.assign({},this.state,t)),n&&n.call(this)}},{key:"get$scope",value:function(e,t){var n=(e||[]).indexOf("$scope");return-1===n?null:t[n]}},{key:"buildProps",value:function(t){var n=this;this.props={};var r=this;for(var i in this)!function(i){n.hasOwnProperty(i)&&"props"!==i&&(t&&t.$watch("bb."+i,function(t,r){n.componentDidUpdate&&n.componentDidUpdate(e.assign({},n.props,a({},i,r)))}),Object.defineProperty(n.props,i,{get:function(){return r[i]},set:function(e){r[i]=e}}))}(i)}},{key:"buildServices",value:function(t,n){var r=this;this.props=this.props||{},e.forEach(t,function(e,t){r.props[e]=n[t]})}}]),t}(),l=["$scope","$filter","$q","APIProxyService","BucketPropertiesService","ConsoleOperation","Region","S3Constants","UtilService","$translate"],u={pageSize:50,buckets:[],bucketFilterText:"",bucketsToDisplay:[],objects:[],objectFilterText:"",objsContMarkers:[],versionsPerKey:{},versions:[],versContMarkers:[],selectedPath:[],selectedPathObjs:[],selectedObject:null,isBuckets:!0,isObjects:!1,isVersions:!1,isLoading:!1,selected:null,cacheBuckets:!1,regions:[],versioningEnabled:!1},d=function(t){function n(){o(this,n);var t=r(this,Object.getPrototypeOf(n).call(this,l,arguments));return t.state=e.clone(u),t.props.UtilService.getFACRegions(t.props.Region.regionMapping,t.state.regions),t.getBuckets=e.debounce(function(){var n=new t.props.ConsoleOperation("RefreshLAMB","RefreshLAMB");t.props.APIProxyService.listAllMyBuckets(n,t.state.cacheBuckets).then(function(e){var n=e.response.ListAllMyBucketsResult.Buckets.Bucket,r=[];n.forEach(function(e){r.push(t.props.BucketPropertiesService.getBucketLocation(e.Name).then(function(n){t.state.regions.forEach(function(t){t.value===n&&(e.Location=t.text,e.Region=t.value)})}).catch(function(e){}))}),t.props.$q.all(r).then(function(){t.setState({isBuckets:!0,isObjects:!1,isVersions:!1,buckets:n,isLoading:!1,cacheBuckets:!0},function(){t.filterBuckets()})})}).catch(function(n){"AccessDenied"===e.get(n,"code")?t.setState({error:{header:t.props.$translate.instant("job_management.bucketbrowser.errors.permissions.buckets_title"),content:t.props.$translate.instant("job_management.bucketbrowser.errors.permissions.buckets_content")}}):t.setState({error:{header:t.props.$translate.instant("error.header"),content:t.props.$translate.instant("utilities.unknown.error")}})})},200),t}return i(n,t),s(n,[{key:"componentDidUpdate",value:function(t){t.isOpen!==this.props.isOpen&&(this.props.isOpen?this.fetchData():this.setState(e.clone(u)))}},{key:"fetchData",value:function(t){var n=this;this.setState({isLoading:!0,selected:null,error:null},function(){0===n.state.selectedPath.length?n.getBuckets():function(){var r=[].concat(n.state.selectedPath),i=new n.props.ConsoleOperation(n.props.S3Constants.OPERATION_NAME.GET_OBJECT_DETAILS),o=r.shift(),s=r.length?r.join("/")+"/":"",c={bucket:o,prefix:s+(n.state.objectFilterText||""),delimiter:"/",cacheAllowed:!1,maxKeys:n.props.isBucketSelector?1e3:n.state.pageSize,fetchOwner:!1};if(n.state.objsContMarkers.length){var l=n.state.objsContMarkers.length-1;t&&(l-=1),c.marker=n.state.objsContMarkers[l]}n.props.APIProxyService.listObjects(i,c).then(function(r){var i=[];e.forEach(r.response.ListBucketResult.CommonPrefixes,function(t){i.push(e.assign({},t,{iconClass:"folder",isFolder:!0,Name:t.Prefix.substr(0,t.Prefix.length-1).replace(s,""),ETag:t.ETag}))}),n.getVersioningEnabled(o).then(function(o){n.props.isBucketSelector||e.forEach(r.response.ListBucketResult.Contents,function(t){var r=e.assign({},t,{iconClass:n.props.UtilService.getIconClassFromFilename(t.Key),Name:t.Key.replace(s,""),ETag:t.ETag});o&&n.listObjectVersions(t.Key).then(function(r){n.setState({versionsPerKey:e.assign({},n.state.versionsPerKey,a({},t.Key,r))})}),r.Name&&i.push(r)});var c=[].concat(n.state.objsContMarkers);t||-1===c.indexOf(r.response.ListBucketResult.NextContinuationToken)&&c.push(r.response.ListBucketResult.NextContinuationToken),n.setState({isBuckets:!1,isObjects:!0,isVersions:!1,objects:i,objsContMarkers:c,isLoading:!1})})}).catch(function(t){"AccessDenied"===e.get(t,"code")?n.setState({error:{header:n.$translate.instant("job_management.bucketbrowser.errors.permissions.objects_title"),content:n.$translate.instant("job_management.bucketbrowser.errors.permissions.objects_content")}}):n.setState({error:{header:n.$translate.instant("error.header"),content:n.$translate.instant("utilities.unknown.error")}})})}()})}},{key:"getVersioningEnabled",value:function(e){return this.props.BucketPropertiesService.getBucketVersioning(e,new this.props.ConsoleOperation("GetBucketVersioning")).then(function(e){return"Enabled"===e}).catch(function(){return!1})}},{key:"listObjectVersions",value:function(t){var n=this.state.selectedPath[0],r={bucket:n,prefix:t,maxKeys:this.state.pageSize,delimiter:"/",cacheAllowed:!0};return this.props.APIProxyService.listVersions(new this.props.ConsoleOperation("listObjects"),r).then(function(n){return e.assign({},n.response.ListVersionsResult,{Version:e.filter(n.response.ListVersionsResult.Version,function(e){return e.Key===t})})}).catch(function(){return null})}},{key:"hasVersions",value:function(e){var t=this.state.versionsPerKey[e];return t&&t.Version&&t.Version.length>1}},{key:"pushPath",value:function(e,t){var n=this;if(!this.isRegionDisabled(e.Region)){if(this.state.isBuckets&&this.props.onlyBuckets)return void this.clickRow(e);if(this.state.isBuckets||e.isFolder)return t&&(t.preventDefault(),t.stopPropagation()),void this.setState({selectedPath:this.state.selectedPath.concat([e.Name]),selectedPathObjs:this.state.selectedPathObjs.concat([e]),objectETag:e.ETag,objsContMarkers:[]},function(){n.fetchData()});if(this.hasVersions(e.Key)){t&&(t.preventDefault(),t.stopPropagation());var r=this.state.versionsPerKey[e.Key];this.setState({selectedPath:this.state.selectedPath.concat([e.Name]),selectedPathObjs:this.state.selectedPathObjs.concat([e]),selected:null,isBuckets:!1,isObjects:!1,isVersions:!0,versions:r.Version,objectETag:r.ETag})}else this.setState({selected:e.Key})}}},{key:"isSelected",value:function(e){return this.state.isBuckets?this.state.selected===e.Name:this.state.isObjects?this.state.selected===(e.isFolder?e.Prefix:e.Key):this.state.isVersions?this.state.selected===e.VersionId:void 0}},{key:"clickRow",value:function(e){this.isRegionDisabled(e.Region)||(this.state.isBuckets?this.props.isBucketSelector?this.setState({selected:e.Name}):this.pushPath(e):this.state.isObjects?e.isFolder?this.props.isBucketSelector?this.setState({selected:e.Prefix}):this.pushPath(e):this.setState({selected:e.Key}):this.state.isVersions&&this.setState({selected:e.VersionId}))}},{key:"goTo",value:function(e){var t=this;e<this.state.selectedPath.length&&this.setState({selectedPath:this.state.selectedPath.slice(0,e),selectedPathObjs:this.state.selectedPathObjs.slice(0,e),objsContMarkers:[]},function(){t.fetchData()})}},{key:"goBack",value:function(){this.goTo(this.state.selectedPath.length-1)}},{key:"isRegionDisabled",value:function(e){var t=this.state.regions.find(function(t){return t.value===e});return!!t&&t.disabled}},{key:"changeObjectFilterText",value:function(){this.fetchData(!0)}},{key:"changeBucketFilterText",value:function(){this.filterBuckets()}},{key:"filterBuckets",value:function(){var e=this.props.$filter("filter")(this.state.buckets,{Name:this.state.bucketFilterText,Region:this.props.regionFilter});this.setState({bucketsToDisplay:e})}},{key:"isFetchPrevObjectPageDisabled",value:function(){return this.state.objsContMarkers.length<2}},{key:"fetchPrevObjectPage",value:function(){var e=this;this.setState({objsContMarkers:this.state.objsContMarkers.slice(0,this.state.objsContMarkers.length-2<0?0:this.state.objsContMarkers.length-2)},function(){e.fetchData()})}},{key:"isFetchNextObjectPageDisabled",value:function(){return!this.state.objsContMarkers[this.state.objsContMarkers.length-1]}},{key:"fetchNextObjectPage",value:function(){this.fetchData()}},{key:"close",value:function(){this.props.isOpen=!1}},{key:"isChooseActive",value:function(){return this.props.isBucketSelector?!(!this.state.selected&&!this.state.selectedPathObjs.length):!!this.state.selected}},{key:"choose",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(this.isChooseActive()){if(this.props.isBucketSelector&&!this.state.selected)return void this.chooseParentFolderOrBucket();if(this.state.isBuckets)e=this.state.selected;else if(this.state.isObjects){var i=void 0;i=this.props.isBucketSelector?this.props.$filter("filter")(this.state.objects,{Prefix:this.state.selected}).shift():this.props.$filter("filter")(this.state.objects,{Key:this.state.selected}).shift(),e=this.state.selectedPath[0],t=i.Key||i.Prefix,r=i.ETag}else if(this.state.isVersions){var a=this.props.$filter("filter")(this.state.versions,{VersionId:this.state.selected}).shift();t=this.state.selectedPath.slice(1).join("/"),e=this.state.selectedPath[0],n=a.VersionId,r=a.ETag}r&&(r=r.replace(/\"/g,"")),this.props.onSelected({Bucket:e,Key:t,VersionID:n,ETag:r}),this.props.isOpen=!1}}},{key:"chooseParentFolderOrBucket",value:function(){var e=void 0,t=void 0,n=void 0,r=this.state.selectedPathObjs[this.state.selectedPathObjs.length-1];if(this.state.isObjects){var i=r;e=this.state.selectedPath[0],t=i.Key||i.Prefix,n=i.ETag}n&&(n=n.replace(/\"/g,"")),this.props.onSelected({Bucket:e,Key:t,VersionID:void 0,ETag:n}),this.props.isOpen=!1}},{key:"getTitle",value:function(){return this.props.title}}]),n}(c);d.$inject=l,t.module("s3").controller("BucketBrowserController",d),t.module("s3").directive("bucketBrowser",[function(){return{restrict:"E",controller:"BucketBrowserController",scope:{},bindToController:{isOpen:"=",regionFilter:"=",onSelected:"=",title:"@",isBucketSelector:"@?",onlyBuckets:"@?"},controllerAs:"bb",template:n(844)}}])}).call(t,n(2),n(0))},function(e,t){e.exports='<div class=bucket-browser ng-class="{ isOpen: bb.props.isOpen }"> <div class=bucket-browser-content> <div class=bucket-browser-header> <h1>{{ bb.getTitle() }}</h1> <a class=bucket-browser-close ng-click=bb.close() href=""></a> </div> <div class=bucket-browser-body> <ul class=bucket-browser-breadcrumb ng-if=bb.state.selectedPath.length> <li ng-click=bb.goTo(0)>S3 <span class="awsui-icon angle-right"></span></li> <li ng-click="bb.goTo($index + 1)" ng-repeat="p in bb.state.selectedPath"> {{ p }} <span class="awsui-icon angle-right"></span> </li> </ul> <div class=bucket-browser-title> <h3> <span ng-if=bb.state.isBuckets translate=lamb.label.buckets></span> <span ng-if=bb.state.isObjects translate=details.tab.objects></span> <span ng-if=bb.state.isVersions translate=report.label.versions></span> <awsui-button ng-if=!bb.state.isVersions class=bucket-browser-refresh icon=refresh variant=standalone-icon loading=bb.state.isLoading click=bb.fetchData(true)></awsui-button> </h3> </div> <awsui-alert content="{{ bb.state.error.content }}" type=error header="{{ bb.state.error.header }}" ng-if=bb.state.error></awsui-alert> <div class=columbia-table ng-if=bb.state.isBuckets> <div class="pages-row pages-row-top"> <div class=search-box> <span class=search-icon><i class="awsui-icon search"></i></span> <input type=text class=input-field ng-model=bb.state.bucketFilterText ng-change=bb.changeBucketFilterText() placeholder="{{ \'job_management.bucketbrowser.bucket_search_placeholder\' | translate }}"/> </div> </div> <awsui-radio-group class=radio-group--unstyled ng-model=bb.state.selected> <table class="table table-condensed"> <thead> <tr> <th ng-if=bb.props.isBucketSelector class=checkbox-column></th> <th class=name-placeholder> <span translate=events.label.name></span> <span class="awsui-icon awsui-icon-disabled caret-down"></span> </th> <th translate=lamb.column.region></th> </tr> </thead> <tbody> <tr ng-if="bb.state.isLoading || !bb.state.bucketsToDisplay.length"> <td colspan="{{bb.props.isBucketSelector ? 3 : 2}}"> <div ng-if=bb.state.isLoading> <span class="awsui-icon awsui-spinner config-spinner"></span> </div> <div ng-if="!bb.state.isLoading && !bb.state.bucketsToDisplay.length && !bb.state.bucketFilterText" class=page-container__empty-message> <p translate=job_management.bucketbrowser.buckets_empty></p> </div> <div ng-if="!bb.state.isLoading && !bb.state.bucketsToDisplay.length && bb.state.bucketFilterText" class=page-container__empty-message> <h4 translate=job_management.bucketbrowser.buckets_search_empty_title></h4> <p translate=job_management.bucketbrowser.search_empty_content></p> </div> </td> </tr> <tr ng-if=!bb.state.isLoading ng-repeat="bck in bb.state.bucketsToDisplay" ng-class="{\'row-disabled\': bb.isRegionDisabled(bck.Region), \'row-selected\': !bb.isRegionDisabled(bck.Region) && bb.isSelected(bck), \'row-hover\': !bb.isRegionDisabled(bck.Region) && hoverBucketRow && !bb.isSelected(bck) }" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false" ng-click=bb.clickRow(bck)> <td class=checkbox-column ng-if=bb.props.isBucketSelector> <awsui-radio-button class=radio-button--small value={{bck.Name}}></awsui-radio-button> </td> <td> <span ng-click="bb.pushPath(bck, $event)" ng-class="{\'clickable\': !bb.isRegionDisabled(bck.Region)}">{{ bck.Name }}</span> </td> <td ng-if=bb.props.isBucketSelector> {{ bck.Location }} </td> <td ng-if=!bb.props.isBucketSelector> {{ bck.Location }} </td> </tr> </tbody> </table> </awsui-radio-group> </div> <div class=columbia-table ng-if=bb.state.isObjects> <div class="pages-row pages-row-top"> <div class=search-box> <span class=search-icon><i class="awsui-icon search"></i></span> <input type=text class=input-field ng-model=bb.state.objectFilterText ng-model-options="{ debounce: 500 }" ng-change=bb.changeObjectFilterText() placeholder="{{ \'job_management.bucketbrowser.object_search_placeholder\' | translate }}"/> </div> <div class=pages> <awsui-button id=fetchPreviousPageBtn icon=angle-left variant=standalone-icon click=bb.fetchPrevObjectPage() data-disabled=bb.isFetchPrevObjectPageDisabled()></awsui-button> <span ng-if=!bb.props.isBucketSelector>{{ "objects.pagination.viewing" | translate }} {{ bb.state.pageSize * ((bb.state.objsContMarkers.length || 1) - 1) + 1 }} {{ "objects.pagination.to" | translate }} {{ bb.state.pageSize * ((bb.state.objsContMarkers.length || 1) - 1) + bb.state.objects.length }} </span> <awsui-button id=fetchNextPageBtn icon=angle-right variant=standalone-icon click=bb.fetchNextObjectPage() data-disabled=bb.isFetchNextObjectPageDisabled()></awsui-button> </div> </div> <awsui-radio-group class=radio-group--unstyled ng-model=bb.state.selected> <table class="table table-condensed"> <thead> <tr> <th class=checkbox-column></th> <th translate=objects.column.key></th> </tr> </thead> <tbody> <tr ng-if="bb.state.isLoading || !bb.state.objects.length"> <td colspan=2> <div ng-if=bb.state.isLoading> <span class="awsui-icon awsui-spinner config-spinner"></span> </div> <div ng-if="!bb.state.isLoading && !bb.state.objects.length && !bb.state.objectFilterText" class=page-container__empty-message> <p translate=job_management.bucketbrowser.objects_empty></p> </div> <div ng-if="!bb.state.isLoading && !bb.state.objects.length && bb.state.objectFilterText" class=page-container__empty-message> <h4 translate=job_management.bucketbrowser.objects_search_empty_title></h4> <p translate=job_management.bucketbrowser.search_empty_content></p> </div> </td> </tr> <tr ng-if=!bb.state.isLoading ng-repeat="obj in bb.state.objects" ng-class="{\'row-selected\': bb.isSelected(obj), \'row-hover\': hoverBucketRow && !bb.isSelected(obj) }" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false" ng-click=bb.clickRow(obj)> <td class=checkbox-column> <awsui-radio-button class=radio-button--small value="{{obj.isFolder ? obj.Prefix : obj.Key}}" ng-if="!obj.isFolder || bb.props.isBucketSelector"></awsui-radio-button> <span class=disabled_radio ng-if="obj.isFolder && !bb.props.isBucketSelector"></span> </td> <td class="awsui-icon {{obj.iconClass}}" ng-class="{ \'awsui-icon-light\': bb.state.selected === (obj.isFolder ? obj.Prefix : obj.Key) }"> <span ng-class="{ \'clickable\': bb.hasVersions(obj.Key) || obj.isFolder }" ng-click="bb.pushPath(obj, $event)">{{ obj.Name }}</span> </td> </tr> </tbody> </table> </awsui-radio-group> </div> <div class=columbia-table ng-if=bb.state.isVersions> <div class="pages-row pages-row-top"> <div class=search-box style=visibility:hidden> <span class=search-icon><i class="awsui-icon search"></i></span> <input type=text class=input-field ng-model=bb.state.objectFilterText ng-model-options="{ debounce: 500 }" ng-change=bb.changeObjectFilterText() placeholder="{{ \'job_management.bucketbrowser.object_search_placeholder\' | translate }}"/> </div> </div> <awsui-radio-group class=radio-group--unstyled ng-model=bb.state.selected> <table class="table table-condensed"> <thead> <tr> <th class=checkbox-column></th> <th class=name-placeholder translate=last.modified></th> <th translate=objects.column.versionid></th> </tr> </thead> <tbody> <tr ng-if=bb.state.isLoading> <td colspan=2> <div ng-if=bb.state.isLoading> <span class="awsui-icon awsui-spinner config-spinner"></span> </div> </td> </tr> <tr ng-if=!bb.state.isLoading ng-repeat="ver in bb.state.versions" ng-class="{\'row-selected\': bb.isSelected(ver), \'row-hover\': hoverBucketRow && !bb.isSelected(ver) }" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false" ng-click=bb.clickRow(ver)> <td class=checkbox-column> <awsui-radio-button class=radio-button--small value={{ver.VersionId}}></awsui-radio-button> </td> <td>{{ ver.LastModified }}</td> <td>{{ ver.VersionId }}</td> </tr> </tbody> </table> </awsui-radio-group> </div> <div class=bucket-browser-footer> <awsui-button class=action-button-spacing text="{{ \'button.cancel\' | translate }}" variant=normal click=bb.close()></awsui-button> <awsui-button class=action-button-spacing ng-if=!bb.state.isBuckets text="{{ \'button.back\' | translate }}" variant=normal click=bb.goBack()></awsui-button> <awsui-button class=action-button-spacing text="{{ \'button.choose\' | translate}}" variant=primary disabled=!bb.isChooseActive() click=bb.choose() loading=bb.isLoading></awsui-button> </div> </div> </div> </div> '},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),a=n(223);r.module("s3").component("accessControlList",{require:{ngModel:"ngModel"},bindings:{ownerId:"=",ownerEditable:"<?",ownerLabelTranslation:"@",ownerDescTranslation:"@?"},template:n(846),controllerAs:"vm",controller:"AccessControlListEditorController"});var o=function(){function e(e,t,n){this.$translate=e,this.UtilService=t,this.$timeout=n,this.headers=["job_management.properties.operation_acl_table.grantee","job_management.properties.operation_acl_table.object","job_management.properties.operation_acl_table.object_acl",void 0]}return e.prototype.$onInit=function(){this.initialize()},e.prototype.updateModel=function(){this.ngModel.$setViewValue(this.aclList.slice())},e.prototype.addACL=function(){this.aclList.push(this.createACLRow()),this.updateModel()},e.prototype.remove=function(e){var t=this;i.remove(this.aclList,function(t){return e===t}),this.$timeout(function(){t.updateModel()})},e.prototype.showValidation=function(e){if(e)return e.$invalid&&e.$touched},e.prototype.updateOwner=function(e){this.ownerId=e,this.updateModel()},e.prototype.createACLRow=function(e,t){return void 0===e&&(e=a.S3GranteeTypeIdentifier.CANONICAL),void 0===t&&(t=a.aclHelpers.getPermissionSet()),{Grantee:{TypeIdentifier:e,Identifier:""},Permissions:t}},e.prototype.initialize=function(){var e=this;this.ngModel.$render=function(){e.aclList=e.ngModel.$viewValue},this.ngModel.$formatters.push(function(t){var n={};if(e.ownerId){var r={TypeIdentifier:a.S3GranteeTypeIdentifier.CANONICAL,Identifier:e.ownerId};n[r.Identifier]={Grantee:r,granteeType:"owner",Permissions:a.aclHelpers.getPermissionSet()}}var o={TypeIdentifier:a.S3GranteeTypeIdentifier.GROUP,Identifier:a.predefinedGranteeGroups.AllUsers.URI};return n[o.Identifier]={Grantee:o,displayName:a.aclHelpers.getGranteeName(o,e.$translate),granteeType:"everyone",Permissions:a.aclHelpers.getPermissionSet()},a.aclHelpers.grantsToMap(t,n),i.values(n)}),this.ngModel.$parsers.push(function(t){var n=t.map(function(t){var n={Identifier:t.Grantee.Identifier,TypeIdentifier:e.getGranteeType(t.Grantee)};return[a.S3Permission.READ,a.S3Permission.READ_ACP,a.S3Permission.WRITE_ACP].filter(function(e){return t.Permissions[e]}).map(function(e){return{Grantee:n,Permission:e}})});return i.flatten(n).filter(function(e){return e.Grantee})}),this.ngModel.$validators.emptyFields=function(){return e.form.$valid}},e.prototype.getGranteeType=function(e){return e.TypeIdentifier===a.S3GranteeTypeIdentifier.GROUP?a.S3GranteeTypeIdentifier.GROUP:this.UtilService.validateEmail(e.Identifier)?a.S3GranteeTypeIdentifier.EMAIL_ADDRESS:a.S3GranteeTypeIdentifier.CANONICAL},e.$inject=["$translate","UtilService","$timeout"],e}();t.AccessControlListEditorController=o,r.module("s3").controller("AccessControlListEditorController",o)},function(e,t){e.exports='<form name=vm.form class="acl-editor columbia-table columbia-table--small"> <table class="table table-border-bottom"> <thead> <tr class=header> <th ng-repeat="header in vm.headers"> <span ng-if=header translate="{{ header }}"></span> </th> </tr> </thead> <tr ng-repeat-start="aclEntry in vm.aclList" class=acl-editor__warning-row ng-if="aclEntry.granteeType === \'everyone\' && (aclEntry.Permissions.READ || aclEntry.Permissions.READ_ACP || aclEntry.Permissions.WRITE_ACP)"> <td colspan=4> <awsui-alert type=warning header="{{ \'job_management.create.public_access_warning.header\' | translate }}" content="{{ \'job_management.create.public_access_warning.content\' | translate }}"></awsui-alert> </td> </tr> <tr class=acl-editor__warning-row ng-if="aclEntry.granteeType === \'owner\' && !vm.ownerEditable && !(aclEntry.Permissions.READ && aclEntry.Permissions.READ_ACP && aclEntry.Permissions.WRITE_ACP)"> <td colspan=4> <awsui-alert type=warning header="{{ \'job_management.create.owner_access_warning\' | translate }}"></awsui-alert> </td> </tr> <tr class=acl-editor__permission-row ng-repeat-end> <td ng-switch=aclEntry.granteeType> <div ng-switch-when=owner> <div ng-if=vm.ownerEditable> <p class="mb-3 acl-editor__row-label" translate="{{ vm.ownerLabelTranslation }}"></p> <awsui-control-group class=acl-editor__owner-input validation-message="{{ vm.showValidation(vm.form[\'grantee\' + $index]) && \'input.required_validation_generic\' | translate }}"> <awsui-textfield name=grantee{{$index}} ng-model=aclEntry.Grantee.Identifier required ng-change=vm.updateOwner(aclEntry.Grantee.Identifier) placeholder="{{ \'permissions.addnewgratee.placeholder_canonical_id\' | translate }}"></awsui-textfield> </awsui-control-group> <p class=acl-editor__description translate="{{ vm.ownerDescTranslation }}" ng-if=vm.ownerDescTranslation translate-compile></p> </div> <div ng-if=!vm.ownerEditable> <p class="mb-2 acl-editor__row-label" translate="{{ vm.ownerLabelTranslation }}"></p> <p class=acl-editor__description>{{\'acl_editor.canonical_id\' | translate }}: {{ aclEntry.Grantee.Identifier }}</p> </div> </div> <div ng-switch-when=everyone> <p class=acl-editor__row-label>{{ aclEntry.displayName }}</p> </div> <div ng-switch-default> <awsui-control-group class=acl-editor__grantee-input validation-message="{{ vm.showValidation(vm.form[\'grantee\' + $index]) && \'input.required_validation_generic\' | translate }}"> <awsui-textfield name=grantee{{$index}} ng-model=aclEntry.Grantee.Identifier required ng-change=vm.updateModel() placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}"></awsui-textfield> </awsui-control-group> </div> </td> <td class=acl-editor__checkbox-cell> <awsui-checkbox class=acl-editor__checkbox-read ng-model=aclEntry.Permissions.READ ng-change=vm.updateModel()>{{ \'job_management.properties.operation_acl_table.read\' | translate }}</awsui-checkbox> </td> <td class=acl-editor__checkbox-cell> <awsui-checkbox class=acl-editor__checkbox-read_acp ng-model=aclEntry.Permissions.READ_ACP ng-change=vm.updateModel()>{{ \'job_management.properties.operation_acl_table.read\' | translate }}</awsui-checkbox> <awsui-checkbox class=acl-editor__checkbox-write_acp ng-model=aclEntry.Permissions.WRITE_ACP ng-change=vm.updateModel()>{{ \'job_management.properties.operation_acl_table.write\' | translate }}</awsui-checkbox> </td> <td><awsui-button ng-if=!aclEntry.granteeType class=action-button-spacing text="{{ \'button.remove\' | translate }}" variant=normal click=vm.remove(aclEntry)></awsui-button></td> </tr> </table> <div> <awsui-button class="action-button-spacing acl-editor__add-button" text="{{ \'permissions.acl.addgrantee\' | translate }}" variant=normal click=vm.addACL()></awsui-button> </div> </form> '},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).module("s3").directive("awsuiMaxlength",function(){return{restrict:"A",priority:1e3,link:function(e,t,n){function r(){t.find("input[type=text]").attr("maxlength",n.awsuiMaxlength)}r();var i=t[0].component,a=i.__update;i.__update=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.apply(i,e),r()}}}})},function(e,t,n){"use strict";(function(e){function t(e,t,n,r,i,a){function o(e){try{var t=s.getSelecteLambdaFunction();if(t&&t[e])return t[e]}catch(e){}return"-"}var s=this;s.lambdaFunctions=[],s.lambdaFunctionVersions=[],s.selectedFunction,s.lambdaFunctionMap,s.selectedFunctionVersion,s.lambdaFunctionVersionsMap,s.lambdaFunctionDesc="-",s.lambdaFunctionRuntime="-",s.clear=function(){s.selectedFunction=null,s.selectedFunctionVersion=null,s.lambdaFunctionDesc="-",s.lambdaFunctionRuntime="-",s.lambdaFunctionArn=null,s.updateModel()},s.listLambdaFunction=function(){s.lambdaFunctions=[],s.lambdaFunctionMap={};var a=new n("ListLambdaFunctions");return s.isLoadingLambdaFunction=!0,t.makeProxyRequest(i.listFunctions,{region:r.getCurrentRegion(),params:{MaxItems:e.API_MAX_ITEMS.LAMBDA_LIST_FUNCTIONS,FunctionVersion:"ALL"}},e.PROXY_API_NAMES.LAMBDA.LIST_FUNCTIONS,a).then(function(e){var t=e.response.Functions;if(t){t.forEach(function(e){s.processLambdaFunction(e)});for(var n in s.lambdaFunctionMap)s.lambdaFunctionMap.hasOwnProperty(n)&&s.lambdaFunctions.push({text:n,value:n});var r=t.find(function(e){return e.FunctionArn===s.lambdaFunctionArn});r&&(s.selectedFunction=r.FunctionName,s.onSelectLambdaFunction())}}).finally(function(){s.isLoadingLambdaFunction=!1})},s.onSelectLambdaFunction=function(){s.lambdaFunctionVersions=[],s.lambdaFunctionVersionsMap={},s.getLambdaFuctionVersions(s.selectedFunction).forEach(function(e){s.lambdaFunctionVersions.push({text:e.Version,value:e.FunctionArn}),s.lambdaFunctionVersionsMap[e.FunctionArn]=e}),s.lambdaFunctionVersionsMap[s.lambdaFunctionArn]?s.selectedFunctionVersion=s.lambdaFunctionArn:s.selectedFunctionVersion=s.lambdaFunctionVersions[0].value,s.onSelectLambdaVersion()},s.getLambdaFunctionPath=function(){return a.getLambdaFunctionLink(r.getCurrentRegion(),s.selectedFunction)},s.onSelectLambdaVersion=function(){s.lambdaFunctionDesc=s.getFunctionDesc(),s.lambdaFunctionRuntime=s.getFunctionRuntime(),s.lambdaFunctionArn=s.selectedFunctionVersion,s.updateModel()},s.processLambdaFunction=function(e){var t=s.getLambdaFuctionVersions(e.FunctionName);t.push(e),s.lambdaFunctionMap[e.FunctionName]=t},s.getLambdaFuctionVersions=function(e){var t=[];return s.lambdaFunctionMap.hasOwnProperty(e)&&(t=s.lambdaFunctionMap[e]),t},s.getSelecteLambdaFunction=function(){if(s.lambdaFunctionVersionsMap)return s.lambdaFunctionVersionsMap[s.selectedFunctionVersion]},s.getFunctionDesc=function(){return o("Description")},s.getFunctionRuntime=function(){return o("Runtime")},s.updateModel=function(){s.ngModel.$setViewValue(s.lambdaFunctionArn)},s.$onInit=function(){var e=s.ngModel;e.$render=function(){s.lambdaFunctionArn=e.$viewValue},s.listLambdaFunction()},s.refresh=function(){s.clear(),s.listLambdaFunction()}}e.module("s3").component("lambdaSelector",{require:{ngModel:"ngModel"},bindings:{},template:n(849),controllerAs:"vm",controller:"LambdaSelectorController"}),e.module("s3").controller("LambdaSelectorController",["S3Constants","APIProxyService","ConsoleOperation","Region","LambdaService","UtilService",t])}).call(t,n(0))},function(e,t){e.exports='<div class=lambda-selector> <awsui-control-group label="{{ \'job_management.create.operation.lambda_function\' | translate }}"> <div class=input-with-buttons> <awsui-select class="input-with-buttons__input awsui-select--alt" disabled=vm.isLoadingLambdaFunction data-e2e-id=lambdaFunctions-id items=vm.lambdaFunctions ng-model=vm.selectedFunction change=vm.onSelectLambdaFunction() placeholder="{{ \'job_management.create.operation.lambda_function_placeholder\' | translate }}"></awsui-select> <awsui-button class=action-button-spacing icon=refresh variant=standalone-icon loading=vm.isLoadingLambdaFunction click=vm.refresh()></awsui-button> <awsui-button class=action-button-spacing disabled=!vm.selectedFunction text="{{ \'button.view\' | translate }}" icon=external-link icon-align=right variant=normal href="{{ vm.getLambdaFunctionPath() }}" target=_blank></awsui-button> </div> </awsui-control-group> <awsui-control-group label="{{ \'job_management.create.operation.lambda_function_version\' | translate }}"> <div class=page-container__fixed-width-container> <awsui-select data-e2e-id=lambdaFunctionsVersion-id disabled=!vm.selectedFunction items=vm.lambdaFunctionVersions ng-model=vm.selectedFunctionVersion change=vm.onSelectLambdaVersion() placeholder="{{ \'job_management.create.operation.lambda_function_version_placeholder\' | translate }}"></awsui-select> </div> </awsui-control-group> <awsui-control-group label="{{ \'job_management.create.operation.lambda_function_description\' | translate }}"> <p class=awsui-control-group__description>{{vm.lambdaFunctionDesc}}</p> </awsui-control-group> <awsui-control-group label="{{ \'job_management.create.operation.lambda_function_runtime\' | translate }}"> <p class=awsui-control-group__description>{{vm.lambdaFunctionRuntime}}</p> </awsui-control-group> </div> '},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(2),o=n(16),s=n(17);i.module("s3").component("objectMetadataEditor",{require:{ngModel:"ngModel"},bindings:{},template:n(851),controllerAs:"vm",controller:"ObjectMetadataEditorController"});var c=function(){function e(e,t,n){this.$timeout=t,this.$filter=n,this.predefinedMetadata=e.getPredefinedMetadata().filter(function(e){return!a.includes(["x-amz-website-redirect-location"],e.value)})}return e.prototype.updateModel=function(){var e=this;this.$timeout(function(){e.ngModel.$setViewValue(e.metadata.slice()),e.updateAllAvailableItems()})},e.prototype.addMetadata=function(){this.metadata.push(this.createRow()),this.updateModel()},e.prototype.remove=function(e){a.remove(this.metadata,function(t){return e===t}),this.updateModel()},e.prototype.keyChanged=function(e){this.updateModel(),a.get(e,"key.value")?e.validationMessage=void 0:e.validationMessage="object_tag_control.validation.key_required"},e.prototype.showValidation=function(e){if(e)return e.$invalid&&e.$touched},e.prototype.$onInit=function(){var e=this;this.ngModel.$render=function(){e.metadata=e.ngModel.$viewValue},this.ngModel.$formatters.push(function(t){if(t){var n=Object.keys(t).map(function(n){return e.mapMetadataItem(n,t[n])});e.metadata=a.flatten(n)}return e.metadata&&0!==e.metadata.length||(e.metadata=[e.createRow()]),e.updateAllAvailableItems(),e.metadata}),this.ngModel.$parsers.push(function(e){if(1===e.length&&!e[0].key&&!e[0].value)return{};var t={},n=!1;return e.forEach(function(e){var r=a.get(e,"key.value"),i=a.invert(o.metadataKeyMap)[r];if(i&&e.value.text)if("UserMetadata"===i){t.UserMetadata=t.UserMetadata||{};var c=e.key.inputValue.replace(s.S3Constants.USER_DEFINED_METADATA_PREFIX,"");t.UserMetadata[c]=e.value.text}else t[i]=e.value.text;else n=!0}),n?void 0:t})},e.prototype.mapMetadataItem=function(e,t){var n=this;if(!t)return[];if("UserMetadata"===e)return Object.keys(t).map(function(e){return n.createUserDefinedRow(e,t[e])});var r=o.metadataKeyMap[e];return r?[this.createRow(r,t)]:[]},e.prototype.updateAvailableItems=function(e){var t=this.metadata||[],n=t.map(function(e){return a.get(e,"key.value")}),r=a.get(e,"key.value");return e.items=this.predefinedMetadata.filter(function(e){return e.value===r||e.value===s.S3Constants.USER_DEFINED_METADATA_PREFIX||!a.includes(n,e.value)}),e},e.prototype.updateAllAvailableItems=function(){var e=this;this.metadata.forEach(function(t){return e.updateAvailableItems(t)})},e.prototype.createUserDefinedRow=function(e,t){var n={key:r({},this.predefinedMetadata.find(function(e){return e.value===s.S3Constants.USER_DEFINED_METADATA_PREFIX}),{inputValue:""+s.S3Constants.USER_DEFINED_METADATA_PREFIX+e}),value:{text:t},items:[]};return this.updateAvailableItems(n)},e.prototype.createRow=function(e,t){var n={key:this.predefinedMetadata.find(function(t){return t.value===e})||void 0,value:{text:t?t.toString():void 0},items:[]};return this.updateAvailableItems(n)},e.$inject=["ObjectPropertiesService","$timeout","$filter"],e}();t.ObjectMetadataEditorController=c,i.module("s3").controller("ObjectMetadataEditorController",c)},function(e,t){e.exports="<form name=vm.form class=object-tags-editor> <table> <thead> <tr class=object-tags-editor__table-row> <th>{{ 'objectdetail.metadata.key' | translate }}</th> <th>{{ 'objectdetail.metadata.value' | translate }}</th> <th></th> </tr> </thead> <tbody> <tr class=object-tags-editor__table-row ng-repeat=\"md in vm.metadata\"> <td> <dropdown items=md.items selected-item=md.key filter=true placeholder=\"{{ 'objectdetail.metadata.key-placeholder' | translate }}\" change=vm.keyChanged(md)></dropdown> </td> <td> <awsui-control-group class=object-tags-editor__input> <dropdown ng-if=md.key.dropDownValue items=md.key.dropDownValue enable-input=true selected-item=md.value filter=\"md.key.dropDownValue.length > 2\" input-field=md.value placeholder=\"{{'objectdetail.metadata.value-placeholder' | translate}}\" change=vm.updateModel()></dropdown> <awsui-textfield name=value{{$index}} ng-model=md.value.text ng-if=!md.key.dropDownValue required ng-change=vm.updateModel()></awsui-textfield> </awsui-control-group> </td> <td> <awsui-button class=object-tags-editor__remove-button ng-if=!$first text=\"{{ 'object_metadata_control.remove_metadata' | translate }}\" variant=normal click=vm.remove(md)></awsui-button> </td> </tr> </tbody> </table> <div> <awsui-button class=object-tags-editor__add-button text=\"{{ 'object_metadata_control.add_metadata' | translate }}\" variant=normal click=vm.addMetadata()></awsui-button> </div> </form>"},function(e,t,n){"use strict";(function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){function n(e,t){return{Key:e||"",Value:t||""}}var i=this;i.updateModel=function(){i.ngModel.$setViewValue([].concat(r(i.tags)))},i.addTag=function(){i.tags.push(n()),i.updateModel()},i.remove=function(n){t.remove(i.tags,function(e){return n===e}),e(function(){i.updateModel()})},i.showValidation=function(e){if(e)return e.$invalid&&e.$touched},i.addTagDisabled=function(){return i.tags.length>=10},i.duplicateKey=function(e){return e&&i.tags.filter(function(t){return t.Key===e}).length>1},i.$onInit=function(){var e=i.ngModel;e.$render=function(){i.tags=e.$viewValue},e.$formatters.push(function(e){return e&&0!==e.length||(e=[n()]),e.map(function(e){return{Key:e.Key,Value:e.Value}})}),e.$parsers.push(function(e){var t={},n=!1;if(e.forEach(function(e){t[e.Key]?n=!0:t[e.Key]=!0}),!n)return e.map(function(e){return{Key:e.Key,Value:e.Value}})}),e.$validators.emptyFields=function(){return i.form.$valid}}}e.module("s3").component("objectTagsEditor",{require:{ngModel:"ngModel"},bindings:{},template:n(853),controllerAs:"vm",controller:"ObjectTagsEditorController"}),e.module("s3").controller("ObjectTagsEditorController",["$timeout",i])}).call(t,n(0),n(2))},function(e,t){e.exports="<form name=vm.form class=object-tags-editor> <table> <thead> <tr class=object-tags-editor__table-row> <th>{{ 'objectproperties.tags.key' | translate }}</th> <th>{{ 'objectproperties.tags.value' | translate }} - {{ 'input.optional' | translate }}</th> <th></th> </tr> </thead> <tbody> <tr class=object-tags-editor__table-row ng-repeat=\"tag in vm.tags\"> <td> <awsui-control-group class=object-tags-editor__input> <span dom-region=control> <awsui-textfield class=object-tags-editor__key-input name=key{{$index}} ng-model=tag.Key required ng-change=vm.updateModel() placeholder=\"{{ 'object_tag_control.enter_key' | translate }}\" awsui-maxlength=128></awsui-textfield> </span> <span dom-region=validationMessage ng-if=vm.duplicateKey(tag.Key) translate=object_tag_control.validation.duplicate_key></span> <span dom-region=validationMessage ng-if=\"!vm.duplicateKey(tag.Key) && vm.showValidation(vm.form['key' + $index])\" translate=object_tag_control.validation.key_required></span> </awsui-control-group> </td> <td> <awsui-control-group class=object-tags-editor__input validation-message=\"{{ vm.showValidation(vm.form['value' + $index]) && 'object_tag_control.validation.value_required_checkbox' | translate }}\"> <awsui-textfield class=object-tags-editor__value-input name=value{{$index}} ng-model=tag.Value ng-change=vm.updateModel() placeholder=\"{{ 'object_tag_control.enter_value' | translate }}\" awsui-maxlength=256></awsui-textfield> </awsui-control-group> </td> <td> <awsui-button ng-if=!$first class=object-tags-editor__remove-button text=\"{{ 'object_tag_control.remove_tag' | translate }}\" variant=normal click=vm.remove(tag)></awsui-button> </td> </tr> </tbody> </table> <div> <awsui-button class=object-tags-editor__add-button text=\"{{ 'object_tag_control.add_tag' | translate }}\" variant=normal click=vm.addTag() disabled=vm.addTagDisabled()></awsui-button> </div> </form>"},function(e,t,n){"use strict";(function(e){function t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){function r(e,n,r,i,a,o,s,c){function l(e){var t=new a("getBucketLocation");return s.getBucketLocation(t,e,{}).then(function(e){return e.region})}var u=this;u.encryptionConstants=r.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION,u.encryptionOptions=[{value:u.encryptionConstants.NONE,description:n.instant("sse_editor.option_description.none"),text:n.instant("sse_editor.option.none")},{value:u.encryptionConstants.AES256,text:n.instant("sse_editor.option.aes256")}],i.isFeatureEnabled(r.FAC.KMS)&&u.encryptionOptions.push({value:u.encryptionConstants.AWSKMS,text:n.instant("sse_editor.option.awskms")}),u.selectedEncryption||(u.selectedEncryption={encryption:u.encryptionConstants.NONE}),u.encryptionChanged=function(){u.selectedEncryption.encryption!==u.encryptionConstants.AWSKMS&&(u.selectedEncryption.kmsId=null,u.selectedEncryption.customKMSARN=null)},u.kmsKeys=[],i.isFeatureEnabled(r.FAC.KMS)&&function(){u.kmsKeys=[];var i=u.bucketName,s=new a(r.OPERATION_NAME.GET_KMS_DEFAULT_ENCRYPTION),d={region:i?l(u.bucketName):c.getCurrentRegion()};o.getKMSKeysByArn(s,i,null,d).then(function(e){var i={value:r.OBJECT_SSE.CUSTOM_ARN,text:n.instant("objectproperties.kms.customarn")};u.kmsKeys=[].concat(t(e),[i]),u.selectedEncryption.kmsId===i.value&&(u.selectedEncryption.kmsId=i)}).catch(function(t){e.KMSServiceError=!0})}()}e.module("s3").directive("serverSideEncryption",function(){return{restrict:"E",scope:{bucketName:"=",selectedEncryption:"="},template:n(855),controllerAs:"sse",transclude:!0,bindToController:!0,controller:"ServerSideEncryptionController"}}),e.module("s3").controller("ServerSideEncryptionController",["$scope","$translate","S3Constants","FAC","ConsoleOperation","KMSPropertiesService","APIProxyService","Region",r])}()}).call(t,n(0))},function(e,t){e.exports='<awsui-radio-group class=radio-group--unstyled ng-model=sse.selectedEncryption.encryption ng-change=sse.encryptionChanged()> <div ng-repeat="encryption in sse.encryptionOptions"> <awsui-radio-button class=radio-button--small value={{encryption.value}}> <div class=radio-button__label-main>{{encryption.text}}</div> <div class=radio-button__label-desc ng-if=encryption.description>{{encryption.description}}</div> </awsui-radio-button> </div> </awsui-radio-group> <div class="mt-3 page-container__fixed-width-container" ng-if="sse.selectedEncryption.encryption === sse.encryptionConstants.AWSKMS"> <dropdown id=default-encryption-kms-dropdown items=sse.kmsKeys placeholder="{{ \'sse_editor.kms_placeholder\' | translate }}" disabled=sse.KMSServiceError selected-item=sse.selectedEncryption.kmsId dropdown-disabled=true> </dropdown> <awsui-textfield class=mt-4 ng-if="sse.selectedEncryption.kmsId.value===sse.encryptionConstants.CUSTOM_ARN" ng-model=sse.selectedEncryption.customKMSARN></awsui-textfield> </div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){}return e.prototype.$onInit=function(){},e.prototype.getSortingClass=function(){return this.disabled?"awsui-icon-disabled caret-down":this.active?"awsui-icon-link "+(this.descending?"caret-down":"caret-up"):"caret-down"},e}();t.TableSortIconController=i,r.module("s3").component("tableSortIcon",{bindings:{disabled:"<?",active:"<",descending:"<"},template:'<span class="awsui-icon" ng-class="vm.getSortingClass()"></span>',controllerAs:"vm",controller:i})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){this.currentRegion=e.getCurrentRegion(),this.currentPath=t.url().replace(/^\//,"")}return e.prototype.$onInit=function(){},e.$inject=["Region","$location"],e}();t.JobManagementBreadcrumbsController=i,r.module("s3").directive("jobManagementBreadcrumbs",function(){return{restrict:"E",scope:{},bindToController:{item:"@"},template:n(858),controller:i,controllerAs:"vm"}})},function(e,t){e.exports='<div class=breadcrumbs-standard> <div class=breadcrumbs-container> <awsui-breadcrumb-group class=breadcrumbs ng-if=!condenseBreadcrumbs> <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="home?region={{vm.currentRegion}}"></awsui-breadcrumb-item> <awsui-breadcrumb-item text="{{ \'job_management.sidebar.title\' | translate }}" href="jobs?region={{vm.currentRegion}}"></awsui-breadcrumb-item> <awsui-breadcrumb-item class=breadcrumb-last text="{{ vm.item }}" href={{vm.currentPath}}></awsui-breadcrumb-item> </awsui-breadcrumb-group> </div> </div>'},function(e,t){e.exports='<div class=properties-display ng-repeat="section in definition"> <h3 class=properties-display__section-title ng-if=section.title translate="{{ section.title }}"></h3> <div class=properties-display__property ng-repeat="property in section.properties"> <h4 class=properties-display__property-title> <span translate="{{ property.title }}"></span> <awsui-tooltip ng-if=property.tooltip text="{{property.tooltip | translate}}" position=bottom size=small> <i class="awsui-icon alert-info-circle"></i> </awsui-tooltip> </h4> <div class=properties-display__property-value ng-if=property.value> <span ng-bind-html=property.value></span> </div> <div class=properties-display__property-table ng-if="!property.value && property.table"> <div class="columbia-table columbia-table--small"> <table class="table table-border-bottom"> <thead> <tr> <th ng-repeat="header in property.table.headers">{{ header | translate }}</th> </tr> </thead> <tbody> <tr ng-repeat="row in property.table.rows"> <td ng-repeat="cell in row track by $index">{{ cell }}</td> </tr> </tbody> </table> </div> </div> </div> </div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2);t.nbspFilter=function(){return function(e){return i.isString(e)?e.replace(/&nbsp;/g," "):e}},r.module("s3").filter("nbsp",t.nbspFilter)},function(e,t,n){"use strict";function r(e){return e.length>c?e.substring(0,c):e}function i(e){var n=o.get(e,"controller");return n?n.replace("Controller",""):t.UNKNOWN_LANDING_PAGE}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=n(2),s=n(17);t.UNKNOWN_LANDING_PAGE="Unknown",t.LANDING_PAGE_PREFIX="LandPg",t.ROUTE_CHANGE_PREFIX="RouteCh";var c=32;a.module("s3").factory("PageLoadOperation",["ConsoleOperation",function(e){return new e("PageLoad")}]).run(["$rootScope","SCLogService","PageLoadOperation","$location","PerformanceUtilsService",function(e,n,a,o,c){var l=!1;c.mark(s.S3Constants.PERFORMANCE_TRACKING.BOOTSTRAP_FINISHED),e.$on("$routeChangeStart",function(e,s){if(!s.redirectTo){var c=i(s),u=l?t.ROUTE_CHANGE_PREFIX:t.LANDING_PAGE_PREFIX,d=r(u+"-"+c),p={controller:s.controller,path:o.path(),pathParams:o.search()};n.logWithSimplifiedOperation(d,1,a,p),l=!0}})}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(0).module("s3").directive("errorMessage",function(){return{restrict:"E",scope:{error:"<"},template:n(863)}})},function(e,t){e.exports="<span ng-if=error.isSecurityError>{{ error.text }} <a href={{error.link}} translate=button.reload_console target=_self></a></span> <span ng-if=!error.isSecurityError>{{ error }}</span>"}],[232]);